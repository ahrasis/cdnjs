!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Tp){"use strict";try{(function(){var u,t,e=(t=Tp)&&"object"==typeof t&&"default"in t?t:{default:t},r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(ge=u=u||{})[ge.DEBUG=0]="DEBUG",ge[ge.VERBOSE=1]="VERBOSE",ge[ge.INFO=2]="INFO",ge[ge.WARN=3]="WARN",ge[ge.ERROR=4]="ERROR",ge[ge.SILENT=5]="SILENT";var a={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},h=u.INFO,c=((me={})[u.DEBUG]="log",me[u.VERBOSE]="log",me[u.INFO]="info",me[u.WARN]="warn",me[u.ERROR]="error",me),l=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?a[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},f);function f(t){this.name=t,this._logLevel=h,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e,n){return(e=d.call(this,e)||this).code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=(t=this.errors[t])?(r=i,t.replace(T,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var T=/\{\$([^}]+)}/g,I=function(t,e){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},O=N||self;function k(){}function D(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function R(t){var e=D(t);return"array"==e||"object"==e&&"number"==typeof t.length}function L(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var S="closure_uid_"+(1e9*Math.random()>>>0),P=0;function _(t,e,n){return t.call.apply(t.bind,arguments)}function C(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function U(t,e,n){return(U=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?_:C).apply(null,arguments)}function V(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var x=Date.now;function j(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t}function M(){this.j=this.j,this.i=this.i}M.prototype.j=!1,M.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,S)&&this[S]||(this[S]=++P))},M.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var F=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},q=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function G(){return Array.prototype.concat.apply([],arguments)}function B(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function z(t){return/^[\s\xa0]*$/.test(t)}var Y=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function X(t,e){return-1!=t.indexOf(e)}function H(t,e){return t<e?-1:e<t?1:0}var W=O.navigator;function J(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Q(t){var e,n={};for(e in t)n[e]=t[e];return n}at=(W=W&&W.userAgent)?W:"";var K="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function $(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<K.length;i++)e=K[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function Z(t){return Z[" "](t),t}Z[" "]=k;var tt,et=X(at,"Opera"),nt=X(at,"Trident")||X(at,"MSIE"),rt=X(at,"Edge"),it=rt||nt,ot=X(at,"Gecko")&&!(X(at.toLowerCase(),"webkit")&&!X(at,"Edge"))&&!(X(at,"Trident")||X(at,"MSIE"))&&!X(at,"Edge"),st=X(at.toLowerCase(),"webkit")&&!X(at,"Edge");function ut(){var t=O.document;return t?t.documentMode:void 0}var W="",at=(at=at,ot?/rv:([^\);]+)(\)|;)/.exec(at):rt?/Edge\/([\d\.]+)/.exec(at):nt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(at):st?/WebKit\/(\S+)/.exec(at):et?/(?:Version)[ \/]?(\S+)/.exec(at):void 0);at&&(W=at?at[1]:""),tt=nt&&null!=(at=ut())&&at>parseFloat(W)?String(at):W;var ht={};function ct(u){return t=u,e=function(){for(var t=0,e=Y(String(tt)).split("."),n=Y(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++)for(var o=e[i]||"",s=n[i]||"";o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],(0!=o[0].length||0!=s[0].length)&&(t=H(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||H(0==o[2].length,0==s[2].length)||H(o[2],s[2]),o=o[3],s=s[3],0==t););return 0<=t},n=ht,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var lt=O.document&&nt&&(ut()||parseInt(tt,10))||void 0,ft=!nt||9<=Number(lt),pt=nt&&!ct("9"),dt=function(){if(!O.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{O.addEventListener("test",k,e),O.removeEventListener("test",k,e)}catch(t){}return t}();function yt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function vt(t,e){if(yt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ot){t:{try{Z(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:gt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}yt.prototype.b=function(){this.defaultPrevented=!0},j(vt,yt);var gt={2:"touch",3:"pen",4:"mouse"};vt.prototype.b=function(){vt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,pt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var mt="closure_listenable_"+(1e6*Math.random()|0),wt=0;function bt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++wt,this.Y=this.Z=!1}function Et(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Tt(t){this.src=t,this.a={},this.b=0}function It(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=F(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Et(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function At(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Tt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=At(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new bt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Nt="closure_lm_"+(1e6*Math.random()|0),Ot={};function kt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Ut(r),e&&e[mt]?e.wa(n,r,L(i)?!!i.capture:!!i,o):Dt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)kt(t,e[o],n,r,i);return null}return n=Ut(n),t&&t[mt]?t.va(e,n,L(r)?!!r.capture:!!r,i):Dt(t,e,n,!1,r,i)}function Dt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=L(i)?!!i.capture:!!i;if(s&&!ft)return null;var u,a,h=_t(t);if(h||(t[Nt]=h=new Tt(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=Pt,r=a=ft?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)dt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Lt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Rt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[mt]?It(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Lt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=_t(e))?(It(n,t),0==n.b&&(n.src=null,e[Nt]=null)):Et(t)))}function Lt(t){return t in Ot?Ot[t]:Ot[t]="on"+t}function St(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Rt(t),n.call(r,e)}function Pt(t,e){if(t.Y)return!0;if(ft)return St(t,new vt(e,this));if(!e)t:{e=["window","event"];for(var n=O,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return St(t,e=new vt(e,this))}function _t(t){return(t=t[Nt])instanceof Tt?t:null}var Ct="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ut(e){return"function"==D(e)?e:(e[Ct]||(e[Ct]=function(t){return e.handleEvent(t)}),e[Ct])}function Vt(){M.call(this),this.c=new Tt(this),(this.J=this).C=null}function xt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new yt(e,t):e instanceof yt?e.target=e.target||t:(s=e,$(e=new yt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=jt(o,r,!0,e)&&s;if(s=jt(o=e.a=t,r,!0,e)&&s,s=jt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=jt(o=e.a=n[i],r,!1,e)&&s}function jt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&It(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}j(Vt,M),Vt.prototype[mt]=!0,(at=Vt.prototype).addEventListener=function(t,e,n,r){kt(this,t,e,n,r)},at.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=L(i)?!!i.capture:!!i,r=Ut(r),e&&e[mt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=At(s=e.a[n],r,i,o))&&(Et(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&_t(e))&&(n=e.a[n.toString()],e=-1,n&&(e=At(n,r,i,o)),(r=-1<e?n[e]:null)&&Rt(r))}(this,t,e,n,r)},at.G=function(){if(Vt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Et(n[r]);delete e.a[t],e.b--}}this.C=null},at.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},at.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Mt=O.JSON.stringify;function Ft(){this.b=this.a=null}var qt,Gt=(Bt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Bt(function(){return new zt},function(t){t.reset()},100));function Bt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function zt(){this.next=this.b=this.a=null}function Yt(t,e){var n;qt||(n=O.Promise.resolve(void 0),qt=function(){n.then(Wt)}),Xt||(qt(),Xt=!0),Ht.add(t,e)}Ft.prototype.add=function(t,e){var n=Gt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},zt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Xt=!(zt.prototype.reset=function(){this.next=this.b=this.a=null}),Ht=new Ft;function Wt(){for(var t,e;n=e=void 0,n=null,(e=Ht).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){O.setTimeout(function(){throw t},0)}(t)}var n=Gt;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Xt=!1}function Jt(t,e){Vt.call(this),this.b=t||1,this.a=e||O,this.f=U(this.Xa,this),this.g=x()}function Qt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Kt(t,e,n){if("function"==D(t))n&&(t=U(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=U(t.handleEvent,t)}return 2147483647<Number(e)?-1:O.setTimeout(t,e||0)}j(Jt,Vt),(at=Jt.prototype).aa=!1,at.M=null,at.Xa=function(){var t;this.aa&&(0<(t=x()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),xt(this,"tick"),this.aa&&(Qt(this),this.start())))},at.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=x())},at.G=function(){Jt.X.G.call(this),Qt(this),delete this.a};var $t,Zt,te=(I(Zt=ne,W=$t=M),Zt.prototype=null===W?Object.create(W):(ee.prototype=W.prototype,new ee),ne.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=Kt(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ne.prototype.G=function(){$t.prototype.G.call(this),this.a&&(O.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ne);function ee(){this.constructor=Zt}function ne(t,e,n){var r=$t.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function re(t){M.call(this),this.b=t,this.a={}}j(re,M);var ie=[];function oe(t,e,n,r){Array.isArray(n)||(n&&(ie[0]=n.toString()),n=ie);for(var i=0;i<n.length;i++){var o=kt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function se(t){J(t.a,function(t,e){this.a.hasOwnProperty(e)&&Rt(t)},t),t.a={}}function ue(){this.a=!0}function ae(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return Mt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}re.prototype.G=function(){re.X.G.call(this),se(this)},re.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ue.prototype.info=function(){};var he=null;function ce(){return he=he||new Vt}function le(t){yt.call(this,"serverreachability",t)}function fe(){var t=ce();xt(t,new le(t))}function pe(t){yt.call(this,"statevent",t)}function de(){var t=ce();xt(t,new pe(t))}function ye(t){yt.call(this,"timingevent",t)}function ve(t,e){if("function"!=D(t))throw Error("Fn must not be null and must be a function");return O.setTimeout(function(){t()},e)}j(le,yt),j(pe,yt),j(ye,yt);var ge={NO_ERROR:0,Ya:1,fb:2,eb:3,ab:4,cb:5,gb:6,Da:7,TIMEOUT:8,jb:9},me={$a:"complete",nb:"success",Ea:"error",Da:"abort",lb:"ready",mb:"readystatechange",TIMEOUT:"timeout",hb:"incrementaldata",kb:"progress",bb:"downloadprogress",ob:"uploadprogress"};function we(){}function be(t){var e;return(e=t.a)||(e=t.a={}),e}function Ee(){}we.prototype.a=null;var Te,N={OPEN:"a",Za:"b",Ea:"c",ib:"d"};function Ie(){yt.call(this,"d")}function Ae(){yt.call(this,"c")}function Ne(){}function Oe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new re(this),this.P=ke,t=it?125:void 0,this.R=new Jt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}j(Ie,yt),j(Ae,yt),j(Ne,we),Te=new Ne;var ke=45e3,De={},Re={};function Le(t,e,n){t.H=1,t.i=Ke(Ye(e)),t.j=n,t.I=!0,Se(t,null)}function Se(t,e){t.u=x(),_e(t),t.l=Ye(t.i);var s,u,a,h,c,l,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),ln(n.b,"t",r),t.D=0,t.a=ir(t.g,t.g.C?e:null),0<t.O&&(t.F=new te(U(t.Ca,t,t.a),t.O)),oe(t.J,t.a,"readystatechange",t.Va),e=t.B?Q(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),fe(),s=t.c,u=t.m,a=t.l,h=t.f,c=t.S,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function Pe(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Re:(i=Number(u.substring(i,o)),isNaN(i)?De:(o+=1)+i>u.length?Re:(u=u.substr(o,i),r.D=o+i,u)));if(u==Re){4==e&&(t.h=4,de(),s=!1),ae(t.c,t.f,null,"[Incomplete Response]");break}if(u==De){t.h=4,de(),ae(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}ae(t.c,t.f,u,null),je(t,u)}4==e&&0==n.length&&(t.h=1,de(),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Qn(e),e.F=!0,de())):(ae(t.c,t.f,n,"[Invalid Chunked Response]"),xe(t),Ve(t))}function _e(t){t.T=x()+t.P,Ce(t,t.P)}function Ce(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=ve(U(t.Ta,t),e)}function Ue(t){t.o&&(O.clearTimeout(t.o),t.o=null)}function Ve(t){0==t.g.v||t.A||Zn(t.g,t)}function xe(t){Ue(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Qt(t.R),se(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function je(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||mn(u.b,t)))if(u.I=t.N,!t.C&&mn(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var h=a;if(0==h[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;$n(u),qn(u)}Jn(u),de()}}else u.oa=h[1],0<u.oa-u.P&&h[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=ve(U(u.Qa,u),6e3));if(gn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else er(u,11)}else if(!t.C&&u.a!=t||$n(u),!z(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)h=e[a],u.P=h[0],h=h[1],2==u.v?"c"==h[0]?(u.J=h[1],u.ga=h[2],null!=(r=h[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=h[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=h[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(X(r,"spdy")||X(r,"quic")||X(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(wn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,Qe(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=x()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=rr(n,n.C?n.ga:null,n.fa),i.C?(bn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Ue(o),_e(o)),n.a=i):Wn(n),0<u.g.length&&zn(u)):"stop"!=h[0]&&"close"!=h[0]||er(u,7):3==u.v&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?er(u,7):Fn(u):"noop"!=h[0]&&u.f&&u.f.sa(h),u.o=0);fe()}catch(t){}}function Me(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(R(t)||"string"==typeof t)q(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(R(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(R(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Fe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Fe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function qe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ge(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Ge(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Ge(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(at=Oe.prototype).setTimeout=function(t){this.P=t},at.Va=function(t){t=t.target;var e=this.F;e&&3==Vn(t)?e.f():this.Ca(t)},at.Ca=function(t){try{if(t==this.a)t:{var e=Vn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!it&&!this.a.$())){this.A||4!=e||7==n||fe(),Ue(this);var i=this.a.W();if(this.N=i,n=this.a.$(),this.b=200==i,r=this.c,u=this.m,a=this.l,h=this.f,c=this.S,l=e,f=i,r.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+c+"]: "+u+"\n"+a+"\n"+l+" "+f}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,de(),xe(this),Ve(this);break t}ae(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,je(this,s)}this.I?(Pe(this,e,n),it&&this.b&&3==e&&(oe(this.J,this.R,"tick",this.Ua),this.R.start())):(ae(this.c,this.f,n,null),je(this,n)),4==e&&xe(this),this.b&&!this.A&&(4==e?Zn(this.g,this):(this.b=!1,_e(this)))}else 400==i&&0<n.indexOf("Unknown SID")?this.h=3:this.h=0,de(),xe(this),Ve(this)}}}catch(t){}var u,a,h,c,l,f},at.Ua=function(){var t,e;this.a&&(t=Vn(this.a),e=this.a.$(),this.D<e.length&&(Ue(this),Pe(this,t,e),this.b&&4!=t&&_e(this)))},at.cancel=function(){this.A=!0,xe(this)},at.Ta=function(){this.o=null;var t,e,n=x();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(fe(),de()),xe(this),this.h=2,Ve(this)):Ce(this,this.T-n)},(at=Fe.prototype).K=function(){qe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},at.L=function(){return qe(this),this.a.concat()},at.get=function(t,e){return Ge(this.b,t)?this.b[t]:e},at.set=function(t,e){Ge(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},at.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Be=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function ze(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof ze?(this.a=void 0!==e?e:t.a,Xe(this,t.f),this.j=t.j,He(this,t.c),We(this,t.h),this.g=t.g,e=t.b,(n=new un).c=e.c,e.a&&(n.a=new Fe(e.a),n.b=e.b),Je(this,n),this.i=t.i):t&&(n=String(t).match(Be))?(this.a=!!e,Xe(this,n[1]||"",!0),this.j=$e(n[2]||""),He(this,n[3]||"",!0),We(this,n[4]),this.g=$e(n[5]||"",!0),Je(this,n[6]||"",!0),this.i=$e(n[7]||"")):(this.a=!!e,this.b=new un(null,this.a))}function Ye(t){return new ze(t)}function Xe(t,e,n){t.f=n?$e(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function He(t,e,n){t.c=n?$e(e,!0):e}function We(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Je(t,e,n){var r,i;e instanceof un?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(an(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(hn(this,e),ln(this,n,t))},r)),r.f=i):(n||(e=Ze(e,on)),t.b=new un(e,t.a))}function Qe(t,e,n){t.b.set(e,n)}function Ke(t){return Qe(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^x()).toString(36)),t}function $e(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ze(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,tn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function tn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}ze.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Ze(e,en,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(Ze(e,en,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Ze(n,"/"==n.charAt(0)?rn:nn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Ze(n,sn)),t.join("")};var en=/[#\/\?@]/g,nn=/[#\?:]/g,rn=/[#\?]/g,on=/[#\?@]/g,sn=/#/g;function un(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function an(o){o.a||(o.a=new Fe,o.b=0,o.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],r=n,i=i?decodeURIComponent(i.replace(/\+/g," ")):"",o.add(decodeURIComponent(r.replace(/\+/g," ")),i)}}}(o.c))}function hn(t,e){an(t),e=fn(t,e),Ge(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ge((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&qe(t)))}function cn(t,e){return an(t),e=fn(t,e),Ge(t.a.b,e)}function ln(t,e,n){hn(t,e),0<n.length&&(t.c=null,t.a.set(fn(t,e),B(n)),t.b+=n.length)}function fn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function pn(t,e){this.b=t,this.a=e}function dn(t){this.g=t||yn,t=O.PerformanceNavigationTiming?0<(t=O.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(O.ia&&O.ia.ya&&O.ia.ya()&&O.ia.ya().pb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(at=un.prototype).add=function(t,e){an(this),this.c=null,t=fn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},at.forEach=function(n,r){an(this),this.a.forEach(function(t,e){q(t,function(t){n.call(r,t,e,this)},this)},this)},at.L=function(){an(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},at.K=function(t){an(this);var e=[];if("string"==typeof t)cn(this,t)&&(e=G(e,this.a.get(fn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=G(e,t[n])}return e},at.set=function(t,e){return an(this),this.c=null,cn(this,t=fn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},at.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},at.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var yn=10;function vn(t){return t.b||t.a&&t.a.size>=t.f}function gn(t){return t.b?1:t.a?t.a.size:0}function mn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function wn(t,e){t.a?t.a.add(e):t.b=e}function bn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function En(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return B(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Tn(){}function In(){this.a=new Tn}function An(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}dn.prototype.cancel=function(){var t,e;if(this.c=En(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Tn.prototype.stringify=function(t){return O.JSON.stringify(t,void 0)},Tn.prototype.parse=function(t){return O.JSON.parse(t,void 0)};var Nn=O.JSON.parse;function On(t){Vt.call(this),this.headers=new Fe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=kn,this.D=this.F=!1}j(On,Vt);var kn="",Dn=/^https?$/i,Rn=["POST","PUT"];function Ln(t){return"content-type"==t.toLowerCase()}function Sn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Pn(t),Cn(t)}function Pn(t){t.u||(t.u=!0,xt(t,"complete"),xt(t,"error"))}function _n(t){if(t.b&&(!t.s[1]||4!=Vn(t)||2!=t.W()))if(t.l&&4==Vn(t))Kt(t.za,0,t);else if(xt(t,"readystatechange"),4==Vn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Be)[1]||null)&&O.self&&O.self.location&&(i=(r=O.self.location.protocol).substr(0,r.length-1)),n=!Dn.test(i?i.toLowerCase():"")),e=n),e)xt(t,"complete"),xt(t,"success");else{t.h=6;try{var u=2<Vn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.W()+"]",Pn(t)}}finally{Cn(t)}}}function Cn(t,e){if(t.a){Un(t);var n=t.a,r=t.s[0]?k:null;t.a=null,t.s=null,e||xt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Un(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(O.clearTimeout(t.m),t.m=null)}function Vn(t){return t.a?t.a.readyState:0}function xn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",J(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Qe(t,e,n))}function jn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Mn(t){this.pa=0,this.g=[],this.c=new ue,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Ma=this.R=0,this.Ja=jn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Fa=jn("baseRetryDelayMs",5e3,t),this.Pa=jn("retryDelaySeedMs",1e4,t),this.Ka=jn("forwardChannelMaxRetries",2,t),this.ma=jn("forwardChannelRequestTimeoutMs",2e4,t),this.La=t&&t.h||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new dn(t&&t.concurrentRequestLimit),this.ka=new In,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.g&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ia=t&&t.f||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Fn(t){var e,n;Gn(t),3==t.v&&(e=t.R++,Qe(n=Ye(t.B),"SID",t.J),Qe(n,"RID",e),Qe(n,"TYPE","terminate"),Xn(t,n),(e=new Oe(t,t.c,e,void 0)).H=2,e.i=Ke(Ye(n)),n=!1,O.navigator&&O.navigator.sendBeacon&&(n=O.navigator.sendBeacon(e.i.toString(),"")),!n&&O.Image&&((new Image).src=e.i,n=!0),n||(e.a=ir(e.g,null),e.a.ba(e.i)),e.u=x(),_e(e)),nr(t)}function qn(t){t.a&&(Qn(t),t.a.cancel(),t.a=null)}function Gn(t){qn(t),t.j&&(O.clearTimeout(t.j),t.j=null),$n(t),t.b.cancel(),t.h&&("number"==typeof t.h&&O.clearTimeout(t.h),t.h=null)}function Bn(t,e){t.g.push(new pn(t.Ma++,e)),3==t.v&&zn(t)}function zn(t){vn(t.b)||t.h||(t.h=!0,Yt(t.Ba,t),t.u=0)}function Yn(t,e){var n=e?e.f:t.R++,r=Ye(t.B);Qe(r,"SID",t.J),Qe(r,"RID",n),Qe(r,"AID",t.P),Xn(t,r),t.i&&t.l&&xn(r,t.i,t.l),n=new Oe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Hn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),wn(t.b,n),Le(n,r,e)}function Xn(t,n){t.f&&Me({},function(t,e){Qe(n,e,t)})}function Hn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?U(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+h+"_"||"";try{Me(t,function(t,e){var n=t;L(t)&&(n=Mt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s)}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Wn(t){t.a||t.j||(t.T=1,Yt(t.Aa,t),t.o=0)}function Jn(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=ve(U(t.Aa,t),tr(t,t.o)),t.o++,1)}function Qn(t){null!=t.s&&(O.clearTimeout(t.s),t.s=null)}function Kn(t){t.a=new Oe(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ye(t.la);Qe(e,"RID","rpc"),Qe(e,"SID",t.J),Qe(e,"CI",t.H?"0":"1"),Qe(e,"AID",t.P),Xn(t,e),Qe(e,"TYPE","xmlhttp"),t.i&&t.l&&xn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=Ke(Ye(e)),n.j=null,n.I=!0,Se(n,t)}function $n(t){null!=t.m&&(O.clearTimeout(t.m),t.m=null)}function Zn(t,e){var n,r,i,o=null;if(t.a==e){$n(t),Qn(t),t.a=null;var s=2}else{if(!mn(t.b,e))return;o=e.s,bn(t.b,e),s=1}if(t.I=e.N,0!=t.v)if(e.b)1==s?(o=e.j?e.j.length:0,e=x()-e.u,n=t.u,xt(s=ce(),new ye(s)),zn(t)):Wn(t);else if(3==(n=e.h)||0==n&&0<t.I||(1!=s||(i=e,gn((r=t).b)>=r.b.f-(r.h?1:0)||(r.h?(r.g=i.s.concat(r.g),0):1==r.v||2==r.v||r.u>=(r.Ja?0:r.Ka)||(r.h=ve(U(r.Ba,r,i),tr(r,r.u)),r.u++,0))))&&(2!=s||!Jn(t)))switch(o&&0<o.length&&(e=t.b,e.c=e.c.concat(o)),n){case 1:er(t,5);break;case 4:er(t,10);break;case 3:er(t,6);break;default:er(t,2)}}function tr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Pa);return t.f||(n*=2),n*e}function er(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=U(t.Wa,t),r||(r=new ze("//www.google.com/images/cleardot.gif"),O.location&&"http"==O.location.protocol||Xe(r,"https"),Ke(r)),n=r.toString(),r=o,o=new ue,O.Image?((i=new Image).onload=V(An,o,i,"TestLoadImage: loaded",!0,r),i.onerror=V(An,o,i,"TestLoadImage: error",!1,r),i.onabort=V(An,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=V(An,o,i,"TestLoadImage: timeout",!1,r),O.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):de(),t.v=0,t.f&&t.f.ra(e),nr(t),Gn(t)}function nr(t){t.v=0,t.I=-1,t.f&&(0==En(t.b).length&&0==t.g.length||(t.b.c.length=0,B(t.g),t.g.length=0),t.f.qa())}function rr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof ze?Ye(s):new ze(s,void 0);return""!=a.c?(e&&He(a,e+"."+a.c),We(a,a.h)):(r=(u=O.location).protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new ze(null,void 0),r&&Xe(u,r),i&&He(u,i),o&&We(u,o),s&&(u.g=s),a=u),t.V&&J(t.V,function(t,e){Qe(a,e,t)}),e=t.A,n=t.na,e&&n&&Qe(a,e,n),Qe(a,"VER",t.ha),Xn(t,a),a}function ir(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new On(t.La)).F=t.C,e}function or(){}function sr(){if(nt&&!(10<=Number(lt)))throw Error("Environmental error: no available transport.")}function ur(t,e){Vt.call(this),this.a=new Mn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!z(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!z(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new cr(this)}function ar(t){Ie.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function hr(){Ae.call(this),this.status=1}function cr(t){this.a=t}(at=On.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?be(this.H):be(Te),this.a.onreadystatechange=U(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Sn(this,t)}t=n||"";var i,o=new Fe(this.headers);r&&Me(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Ln,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=O.FormData&&t instanceof O.FormData,0<=F(Rn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Un(this),0<this.o&&((this.D=(i=this.a,nt&&ct(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=U(this.xa,this)):this.m=Kt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Sn(this,t)}},at.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,xt(this,"timeout"),this.abort(8))},at.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,xt(this,"complete"),xt(this,"abort"),Cn(this))},at.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Cn(this,!0)),On.X.G.call(this)},at.za=function(){this.j||(this.A||this.l||this.g?_n(this):this.Sa())},at.Sa=function(){_n(this)},at.W=function(){try{return 2<Vn(this)?this.a.status:-1}catch(t){return-1}},at.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},at.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Nn(e)}},at.ua=function(){return this.h},at.Oa=function(){return"string"==typeof this.f?this.f:String(this.f)},(at=Mn.prototype).ha=8,at.v=1,at.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Oe(this,this.c,t,void 0),r=this.l;if(this.O&&(r?$(r=Q(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Hn(this,n,e),Qe(i=Ye(this.B),"RID",t),Qe(i,"CVER",22),this.A&&Qe(i,"X-HTTP-Session-Id",this.A),Xn(this,i),this.i&&r&&xn(i,this.i,r),wn(this.b,n),this.Ga&&Qe(i,"TYPE","init"),this.da?(Qe(i,"$req",e),Qe(i,"SID","null"),n.U=!0,Le(n,i,null)):Le(n,i,e),this.v=2}}else 3==this.v&&(t?Yn(this,t):0==this.g.length||vn(this.b)||Yn(this))},at.Aa=function(){var t;this.j=null,Kn(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=ve(U(this.Ra,this),t))},at.Ra=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,de(),qn(this),Kn(this))},at.Qa=function(){null!=this.m&&(this.m=null,qn(this),Jn(this),de())},at.Wa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),de()},(at=or.prototype).ta=function(){},at.sa=function(){},at.ra=function(){},at.qa=function(){},at.Ha=function(){},sr.prototype.a=function(t,e){return new ur(t,e)},j(ur,Vt),ur.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;de(),t.fa=e,t.V=n||{},t.H=t.S,t.B=rr(t,null,t.fa),zn(t)},ur.prototype.close=function(){Fn(this.a)},ur.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Bn(this.a,e)):this.l?((e={}).__data__=Mt(t),Bn(this.a,e)):Bn(this.a,t)},ur.prototype.G=function(){this.a.f=null,delete this.f,Fn(this.a),delete this.a,ur.X.G.call(this)},j(ar,Ie),j(hr,Ae),j(cr,or),cr.prototype.ta=function(){xt(this.a,"a")},cr.prototype.sa=function(t){xt(this.a,new ar(t))},cr.prototype.ra=function(t){xt(this.a,new hr)},cr.prototype.qa=function(){xt(this.a,"b")},sr.prototype.createWebChannel=sr.prototype.a,ur.prototype.send=ur.prototype.h,ur.prototype.open=ur.prototype.g,ge.NO_ERROR=0,ge.TIMEOUT=8,ge.HTTP_ERROR=6,me.COMPLETE="complete",(Ee.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",Vt.prototype.listen=Vt.prototype.va,On.prototype.listenOnce=On.prototype.wa,On.prototype.getLastError=On.prototype.Oa,On.prototype.getLastErrorCode=On.prototype.ua,On.prototype.getStatus=On.prototype.W,On.prototype.getResponseJson=On.prototype.Na,On.prototype.getResponseText=On.prototype.$,On.prototype.send=On.prototype.ba;var lr=ge,fr=me,pr=Ee,dr=On,ge=(yr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},yr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},yr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},yr);function yr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var vr=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},gr=(Object.defineProperty(wr.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),wr.prototype.isEqual=function(t){return t instanceof wr&&t.projectId===this.projectId&&t.database===this.database},wr),mr=new l("@firebase/firestore");function wr(t,e){this.projectId=t,this.database=e||"(default)"}function br(){return mr.logLevel}function Er(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];mr.logLevel<=u.DEBUG&&(e=n.map(Ar),mr.debug.apply(mr,i(["Firestore (8.0.2): "+t],e)))}function Tr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];mr.logLevel<=u.ERROR&&(e=n.map(Ar),mr.error.apply(mr,i(["Firestore (8.0.2): "+t],e)))}function Ir(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];mr.logLevel<=u.WARN&&(e=n.map(Ar),mr.warn.apply(mr,i(["Firestore (8.0.2): "+t],e)))}function Ar(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Nr(t){throw void 0===t&&(t="Unexpected state"),Tr(t="FIRESTORE (8.0.2) INTERNAL ASSERTION FAILED: "+t),new Error(t)}function Or(t){t||Nr()}var kr=(Dr.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Dr);function Dr(){}function Rr(t,e){return t<e?-1:e<t?1:0}function Lr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Sr(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Pr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function _r(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Cr,Ur,Vr,xr=(Zr.prototype.get=function(t){var e=this.h(t);if(void 0!==(e=this._[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.l(i,t))return o}},Zr.prototype.has=function(t){return void 0!==this.get(t)},Zr.prototype.set=function(t,e){var n=this.h(t),r=this._[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.l(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this._[n]=[[t,e]]},Zr.prototype.delete=function(t){var e=this.h(t),n=this._[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.l(n[r][0],t))return 1===n.length?delete this._[e]:n.splice(r,1),!0;return!1},Zr.prototype.forEach=function(s){Pr(this._,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];s(i,o)}})},Zr.prototype.T=function(){return _r(this._)},Zr),jr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Mr=(n($r,Vr=Error),$r),Fr=(Kr.now=function(){return Kr.fromMillis(Date.now())},Kr.fromDate=function(t){return Kr.fromMillis(t.getTime())},Kr.fromMillis=function(t){var e=Math.floor(t/1e3);return new Kr(e,1e6*(t-1e3*e))},Kr.prototype.toDate=function(){return new Date(this.toMillis())},Kr.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Kr.prototype.m=function(t){return this.seconds===t.seconds?Rr(this.nanoseconds,t.nanoseconds):Rr(this.seconds,t.seconds)},Kr.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Kr.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Kr.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},Kr.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Kr),qr=(Qr.I=function(t){return new Qr(t)},Qr.min=function(){return new Qr(new Fr(0,0))},Qr.prototype.A=function(t){return this.timestamp.m(t.timestamp)},Qr.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Qr.prototype.R=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Qr.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Qr.prototype.P=function(){return this.timestamp},Qr),me=(Object.defineProperty(Jr.prototype,"length",{get:function(){return this.V},enumerable:!1,configurable:!0}),Jr.prototype.isEqual=function(t){return 0===Jr.g(this,t)},Jr.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Jr?t.forEach(function(t){e.push(t)}):e.push(t),this.p(e)},Jr.prototype.limit=function(){return this.offset+this.length},Jr.prototype.v=function(t){return t=void 0===t?1:t,this.p(this.segments,this.offset+t,this.length-t)},Jr.prototype.C=function(){return this.p(this.segments,this.offset,this.length-1)},Jr.prototype.S=function(){return this.segments[this.offset]},Jr.prototype.D=function(){return this.get(this.length-1)},Jr.prototype.get=function(t){return this.segments[this.offset+t]},Jr.prototype.T=function(){return 0===this.length},Jr.prototype.N=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Jr.prototype.F=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Jr.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Jr.prototype.O=function(){return this.segments.slice(this.offset,this.limit())},Jr.g=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Jr),Gr=(n(Wr,Ur=me),Wr.prototype.p=function(t,e,n){return new Wr(t,e,n)},Wr.prototype.k=function(){return this.O().join("/")},Wr.prototype.toString=function(){return this.k()},Wr.L=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Mr(jr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new Wr(n)},Wr.$=function(){return new Wr([])},Wr),Br=/^[_a-zA-Z][_a-zA-Z0-9]*$/,zr=(n(Hr,Cr=me),Hr.prototype.p=function(t,e,n){return new Hr(t,e,n)},Hr.M=function(t){return Br.test(t)},Hr.prototype.k=function(){return this.O().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),Hr.M(t)||(t="`"+t+"`"),t}).join(".")},Hr.prototype.toString=function(){return this.k()},Hr.prototype.U=function(){return 1===this.length&&"__name__"===this.get(0)},Hr.q=function(){return new Hr(["__name__"])},Hr.B=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Mr(jr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Mr(jr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Mr(jr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Mr(jr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Hr(e)},Hr.$=function(){return new Hr([])},Hr),Yr=(Xr.j=function(t){return new Xr(Gr.L(t))},Xr.W=function(t){return new Xr(Gr.L(t).v(5))},Xr.prototype.K=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Xr.prototype.isEqual=function(t){return null!==t&&0===Gr.g(this.path,t.path)},Xr.prototype.toString=function(){return this.path.toString()},Xr.g=function(t,e){return Gr.g(t.path,e.path)},Xr.G=function(t){return t.length%2==0},Xr.H=function(t){return new Xr(new Gr(t.slice()))},Xr);function Xr(t){this.path=t}function Hr(){return null!==Cr&&Cr.apply(this,arguments)||this}function Wr(){return null!==Ur&&Ur.apply(this,arguments)||this}function Jr(t,e,n){void 0===e?e=0:e>t.length&&Nr(),void 0===n?n=t.length-e:n>t.length-e&&Nr(),this.segments=t,this.offset=e,this.V=n}function Qr(t){this.timestamp=t}function Kr(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Mr(jr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Mr(jr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Mr(jr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Mr(jr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function $r(t,e){var n=this;return(n=Vr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Zr(t,e){this.h=t,this.l=e,this._={}}function ti(t){return null==t}function ei(t){return 0===t&&1/t==-1/0}var ni=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Y=null};function ri(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new ni(t,e,n,r,i,o,s)}function ii(t){var e=t;return null===e.Y&&(t=e.path.k(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return t.field.k()+t.op.toString()+oo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return t.field.k()+t.dir}).join(","),ti(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=Pu(e.startAt)),e.endAt&&(t+="|ub:",t+=Pu(e.endAt)),e.Y=t),e.Y}function oi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!eo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Cu(t.startAt,e.startAt)&&Cu(t.endAt,e.endAt)}function si(t){return Yr.G(t.path)&&null===t.collectionGroup&&0===t.filters.length}var ui=(ai.fromBase64String=function(t){return new ai(atob(t))},ai.fromUint8Array=function(t){return new ai(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},ai.prototype.toBase64=function(){return t=this.J,btoa(t);var t},ai.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.J)},ai.prototype.X=function(){return 2*this.J.length},ai.prototype.A=function(t){return Rr(this.J,t.J)},ai.prototype.isEqual=function(t){return this.J===t.J},ai);function ai(t){this.J=t}function hi(t){this.count=t}ui.Z=new ui("");var ci,li=(fi.prototype.et=function(t){return new fi(this.target,this.targetId,this.tt,t,this.nt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},fi.prototype.st=function(t,e){return new fi(this.target,this.targetId,this.tt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},fi.prototype.it=function(t){return new fi(this.target,this.targetId,this.tt,this.sequenceNumber,this.nt,t,this.resumeToken)},fi);function fi(t,e,n,r,i,o,s){void 0===i&&(i=qr.min()),void 0===o&&(o=qr.min()),void 0===s&&(s=ui.Z),this.target=t,this.targetId=e,this.tt=n,this.sequenceNumber=r,this.nt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function pi(t){switch(t){case jr.OK:return Nr(),0;case jr.CANCELLED:case jr.UNKNOWN:case jr.DEADLINE_EXCEEDED:case jr.RESOURCE_EXHAUSTED:case jr.INTERNAL:case jr.UNAVAILABLE:case jr.UNAUTHENTICATED:return;case jr.INVALID_ARGUMENT:case jr.NOT_FOUND:case jr.ALREADY_EXISTS:case jr.PERMISSION_DENIED:case jr.FAILED_PRECONDITION:case jr.ABORTED:case jr.OUT_OF_RANGE:case jr.UNIMPLEMENTED:case jr.DATA_LOSS:return 1;default:return Nr(),0}}function di(t){if(void 0===t)return Tr("GRPC error has no .code"),jr.UNKNOWN;switch(t){case ci.OK:return jr.OK;case ci.CANCELLED:return jr.CANCELLED;case ci.UNKNOWN:return jr.UNKNOWN;case ci.DEADLINE_EXCEEDED:return jr.DEADLINE_EXCEEDED;case ci.RESOURCE_EXHAUSTED:return jr.RESOURCE_EXHAUSTED;case ci.INTERNAL:return jr.INTERNAL;case ci.UNAVAILABLE:return jr.UNAVAILABLE;case ci.UNAUTHENTICATED:return jr.UNAUTHENTICATED;case ci.INVALID_ARGUMENT:return jr.INVALID_ARGUMENT;case ci.NOT_FOUND:return jr.NOT_FOUND;case ci.ALREADY_EXISTS:return jr.ALREADY_EXISTS;case ci.PERMISSION_DENIED:return jr.PERMISSION_DENIED;case ci.FAILED_PRECONDITION:return jr.FAILED_PRECONDITION;case ci.ABORTED:return jr.ABORTED;case ci.OUT_OF_RANGE:return jr.OUT_OF_RANGE;case ci.UNIMPLEMENTED:return jr.UNIMPLEMENTED;case ci.DATA_LOSS:return jr.DATA_LOSS;default:return Nr()}}(l=ci={})[l.OK=0]="OK",l[l.CANCELLED=1]="CANCELLED",l[l.UNKNOWN=2]="UNKNOWN",l[l.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",l[l.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",l[l.NOT_FOUND=5]="NOT_FOUND",l[l.ALREADY_EXISTS=6]="ALREADY_EXISTS",l[l.PERMISSION_DENIED=7]="PERMISSION_DENIED",l[l.UNAUTHENTICATED=16]="UNAUTHENTICATED",l[l.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",l[l.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",l[l.ABORTED=10]="ABORTED",l[l.OUT_OF_RANGE=11]="OUT_OF_RANGE",l[l.UNIMPLEMENTED=12]="UNIMPLEMENTED",l[l.INTERNAL=13]="INTERNAL",l[l.UNAVAILABLE=14]="UNAVAILABLE",l[l.DATA_LOSS=15]="DATA_LOSS";var yi=(bi.prototype.rt=function(t,e){return new bi(this.g,this.root.rt(t,e,this.g).copy(null,null,gi.ot,null,null))},bi.prototype.remove=function(t){return new bi(this.g,this.root.remove(t,this.g).copy(null,null,gi.ot,null,null))},bi.prototype.get=function(t){for(var e=this.root;!e.T();){var n=this.g(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},bi.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.T();){var r=this.g(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},bi.prototype.T=function(){return this.root.T()},Object.defineProperty(bi.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),bi.prototype.ut=function(){return this.root.ut()},bi.prototype.ct=function(){return this.root.ct()},bi.prototype.at=function(t){return this.root.at(t)},bi.prototype.forEach=function(n){this.at(function(t,e){return n(t,e),!1})},bi.prototype.toString=function(){var n=[];return this.at(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},bi.prototype.ht=function(t){return this.root.ht(t)},bi.prototype.lt=function(){return new vi(this.root,null,this.g,!1)},bi.prototype._t=function(t){return new vi(this.root,t,this.g,!1)},bi.prototype.ft=function(){return new vi(this.root,null,this.g,!0)},bi.prototype.dt=function(t){return new vi(this.root,t,this.g,!0)},bi),vi=(wi.prototype.Tt=function(){var t=this.Et.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.T();)this.Et.push(t),t=t.right;else for(t=t.right;!t.T();)this.Et.push(t),t=t.left;return e},wi.prototype.It=function(){return 0<this.Et.length},wi.prototype.At=function(){if(0===this.Et.length)return null;var t=this.Et[this.Et.length-1];return{key:t.key,value:t.value}},wi),gi=(mi.prototype.copy=function(t,e,n,r,i){return new mi(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},mi.prototype.T=function(){return!1},mi.prototype.at=function(t){return this.left.at(t)||t(this.key,this.value)||this.right.at(t)},mi.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},mi.prototype.min=function(){return this.left.T()?this:this.left.min()},mi.prototype.ut=function(){return this.min().key},mi.prototype.ct=function(){return this.right.T()?this.key:this.right.ct()},mi.prototype.rt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.rt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.rt(t,e,n))).Rt()},mi.prototype.Pt=function(){if(this.left.T())return mi.EMPTY;var t=this;return t.left.Vt()||t.left.left.Vt()||(t=t.yt()),(t=t.copy(null,null,null,t.left.Pt(),null)).Rt()},mi.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.T()||r.left.Vt()||r.left.left.Vt()||(r=r.yt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Vt()&&(r=r.gt()),r.right.T()||r.right.Vt()||r.right.left.Vt()||(r=r.vt()),0===e(t,r.key)){if(r.right.T())return mi.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Pt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Rt()},mi.prototype.Vt=function(){return this.color},mi.prototype.Rt=function(){var t=this;return t.right.Vt()&&!t.left.Vt()&&(t=t.bt()),t.left.Vt()&&t.left.left.Vt()&&(t=t.gt()),t.left.Vt()&&t.right.Vt()&&(t=t.Ct()),t},mi.prototype.yt=function(){var t=this.Ct();return t.right.left.Vt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.gt())).bt()).Ct()),t},mi.prototype.vt=function(){var t=this.Ct();return t.left.left.Vt()&&(t=(t=t.gt()).Ct()),t},mi.prototype.bt=function(){var t=this.copy(null,null,mi.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},mi.prototype.gt=function(){var t=this.copy(null,null,mi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},mi.prototype.Ct=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},mi.prototype.St=function(){var t=this.Dt();return Math.pow(2,t)<=this.size+1},mi.prototype.Dt=function(){if(this.Vt()&&this.left.Vt())throw Nr();if(this.right.Vt())throw Nr();var t=this.left.Dt();if(t!==this.right.Dt())throw Nr();return t+(this.Vt()?0:1)},mi);function mi(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:mi.RED,this.left=null!=r?r:mi.EMPTY,this.right=null!=i?i:mi.EMPTY,this.size=this.left.size+1+this.right.size}function wi(t,e,n,r){this.wt=r,this.Et=[];for(var i=1;!t.T();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.wt?t.left:t.right;else{if(0===i){this.Et.push(t);break}this.Et.push(t),t=this.wt?t.right:t.left}}function bi(t,e){this.g=t,this.root=e||gi.EMPTY}function Ei(){this.size=0}gi.EMPTY=null,gi.RED=!0,gi.ot=!1,gi.EMPTY=(Object.defineProperty(Ei.prototype,"key",{get:function(){throw Nr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ei.prototype,"value",{get:function(){throw Nr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ei.prototype,"color",{get:function(){throw Nr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ei.prototype,"left",{get:function(){throw Nr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ei.prototype,"right",{get:function(){throw Nr()},enumerable:!1,configurable:!0}),Ei.prototype.copy=function(t,e,n,r,i){return this},Ei.prototype.rt=function(t,e,n){return new gi(t,e)},Ei.prototype.remove=function(t,e){return this},Ei.prototype.T=function(){return!0},Ei.prototype.at=function(t){return!1},Ei.prototype.ht=function(t){return!1},Ei.prototype.ut=function(){return null},Ei.prototype.ct=function(){return null},Ei.prototype.Vt=function(){return!1},Ei.prototype.St=function(){return!0},Ei.prototype.Dt=function(){return 0},new Ei);var Ti=(Oi.prototype.has=function(t){return null!==this.data.get(t)},Oi.prototype.first=function(){return this.data.ut()},Oi.prototype.last=function(){return this.data.ct()},Object.defineProperty(Oi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Oi.prototype.indexOf=function(t){return this.data.indexOf(t)},Oi.prototype.forEach=function(n){this.data.at(function(t,e){return n(t),!1})},Oi.prototype.Nt=function(t,e){for(var n=this.data._t(t[0]);n.It();){var r=n.Tt();if(0<=this.g(r.key,t[1]))return;e(r.key)}},Oi.prototype.Ft=function(t,e){for(var n=void 0!==e?this.data._t(e):this.data.lt();n.It();)if(!t(n.Tt().key))return},Oi.prototype.xt=function(t){return(t=this.data._t(t)).It()?t.Tt().key:null},Oi.prototype.lt=function(){return new Ii(this.data.lt())},Oi.prototype._t=function(t){return new Ii(this.data._t(t))},Oi.prototype.add=function(t){return this.copy(this.data.remove(t).rt(t,!0))},Oi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Oi.prototype.T=function(){return this.data.T()},Oi.prototype.Ot=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Oi.prototype.isEqual=function(t){if(!(t instanceof Oi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.lt(),n=t.data.lt();e.It();){var r=e.Tt().key,i=n.Tt().key;if(0!==this.g(r,i))return!1}return!0},Oi.prototype.O=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Oi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Oi.prototype.copy=function(t){var e=new Oi(this.g);return e.data=t,e},Oi),Ii=(Ni.prototype.Tt=function(){return this.kt.Tt().key},Ni.prototype.It=function(){return this.kt.It()},Ni),Ai=new yi(Yr.g);function Ni(t){this.kt=t}function Oi(t){this.g=t,this.data=new yi(this.g)}var ki=new yi(Yr.g),Di=new yi(Yr.g),Ri=new Ti(Yr.g);function Li(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Ri,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Si=new Ti(Rr),Pi=(Wi.Mt=function(t){return new Wi(t.g)},Wi.prototype.has=function(t){return null!=this.Lt.get(t)},Wi.prototype.get=function(t){return this.Lt.get(t)},Wi.prototype.first=function(){return this.$t.ut()},Wi.prototype.last=function(){return this.$t.ct()},Wi.prototype.T=function(){return this.$t.T()},Wi.prototype.indexOf=function(t){return(t=this.Lt.get(t))?this.$t.indexOf(t):-1},Object.defineProperty(Wi.prototype,"size",{get:function(){return this.$t.size},enumerable:!1,configurable:!0}),Wi.prototype.forEach=function(n){this.$t.at(function(t,e){return n(t),!1})},Wi.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Lt.rt(t.key,t),e.$t.rt(t,null))},Wi.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Lt.remove(t),this.$t.remove(e)):this},Wi.prototype.isEqual=function(t){if(!(t instanceof Wi))return!1;if(this.size!==t.size)return!1;for(var e=this.$t.lt(),n=t.$t.lt();e.It();){var r=e.Tt().key,i=n.Tt().key;if(!r.isEqual(i))return!1}return!0},Wi.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Wi.prototype.copy=function(t,e){var n=new Wi;return n.g=this.g,n.Lt=t,n.$t=e,n},Wi),_i=(Hi.prototype.track=function(t){var e=t.doc.key,n=this.Ut.get(e);!n||0!==t.type&&3===n.type?this.Ut=this.Ut.rt(e,t):3===t.type&&1!==n.type?this.Ut=this.Ut.rt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Ut=this.Ut.rt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Ut=this.Ut.rt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Ut=this.Ut.remove(e):1===t.type&&2===n.type?this.Ut=this.Ut.rt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Ut=this.Ut.rt(e,{type:2,doc:t.doc}):Nr()},Hi.prototype.qt=function(){var n=[];return this.Ut.at(function(t,e){n.push(e)}),n},Hi),Ci=(Xi.Kt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Xi(t,e,Pi.Mt(e),i,n,r,!0,!1)},Object.defineProperty(Xi.prototype,"hasPendingWrites",{get:function(){return!this.Qt.T()},enumerable:!1,configurable:!0}),Xi.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.jt===t.jt&&this.Qt.isEqual(t.Qt)&&eu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Bt.isEqual(t.Bt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Xi),Ui=(Yi.Jt=function(t,e){var n=new Map;return n.set(t,Vi.Xt(t,e)),new Yi(qr.min(),n,Si,Ai,Li())},Yi),Vi=(zi.Xt=function(t,e){return new zi(ui.Z,e,Li(),Li(),Li())},zi),xi=function(t,e,n,r){this.sn=t,this.removedTargetIds=e,this.key=n,this.rn=r},ji=function(t,e){this.targetId=t,this.on=e},Mi=function(t,e,n,r){void 0===n&&(n=ui.Z),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Fi=(Object.defineProperty(Bi.prototype,"Zt",{get:function(){return this.hn},enumerable:!1,configurable:!0}),Object.defineProperty(Bi.prototype,"resumeToken",{get:function(){return this.an},enumerable:!1,configurable:!0}),Object.defineProperty(Bi.prototype,"_n",{get:function(){return 0!==this.un},enumerable:!1,configurable:!0}),Object.defineProperty(Bi.prototype,"fn",{get:function(){return this.ln},enumerable:!1,configurable:!0}),Bi.prototype.dn=function(t){0<t.X()&&(this.ln=!0,this.an=t)},Bi.prototype.wn=function(){var n=Li(),r=Li(),i=Li();return this.cn.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Nr()}}),new Vi(this.an,this.hn,n,r,i)},Bi.prototype.En=function(){this.ln=!1,this.cn=Qi()},Bi.prototype.Tn=function(t,e){this.ln=!0,this.cn=this.cn.rt(t,e)},Bi.prototype.mn=function(t){this.ln=!0,this.cn=this.cn.remove(t)},Bi.prototype.In=function(){this.un+=1},Bi.prototype.An=function(){--this.un},Bi.prototype.Rn=function(){this.ln=!0,this.hn=!0},Bi),qi=(Gi.prototype.vn=function(t){for(var e=0,n=t.sn;e<n.length;e++){var r=n[e];t.rn instanceof xs?this.bn(r,t.rn):t.rn instanceof js&&this.Cn(r,t.key,t.rn)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Cn(s,t.key,t.rn)}},Gi.prototype.Sn=function(n){var r=this;this.Dn(n,function(t){var e=r.Nn(t);switch(n.state){case 0:r.Fn(t)&&e.dn(n.resumeToken);break;case 1:e.An(),e._n||e.En(),e.dn(n.resumeToken);break;case 2:e.An(),e._n||r.removeTarget(t);break;case 3:r.Fn(t)&&(e.Rn(),e.dn(n.resumeToken));break;case 4:r.Fn(t)&&(r.xn(t),e.dn(n.resumeToken));break;default:Nr()}})},Gi.prototype.Dn=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Vn.forEach(function(t,e){r.Fn(e)&&n(e)})},Gi.prototype.On=function(t){var e=t.targetId,n=t.on.count;(t=this.kn(e))&&(si(t=t.target)?0===n?(t=new Yr(t.path),this.Cn(e,t,new js(t,qr.min()))):Or(1===n):this.Ln(e)!==n&&(this.xn(e),this.pn=this.pn.add(e)))},Gi.prototype.$n=function(r){var i=this,o=new Map;this.Vn.forEach(function(t,e){var n=i.kn(e);n&&(t.Zt&&si(n.target)&&(n=new Yr(n.target.path),null!==i.yn.get(n)||i.Mn(e,n)||i.Cn(e,n,new js(n,r))),t.fn&&(o.set(e,t.wn()),t.En()))});var s=Li();this.gn.forEach(function(t,e){var n=!0;e.Ft(function(t){return!(t=i.kn(t))||2===t.tt||(n=!1)}),n&&(s=s.add(t))});var t=new Ui(r,o,this.pn,this.yn,s);return this.yn=Ai,this.gn=Ji(),this.pn=new Ti(Rr),t},Gi.prototype.bn=function(t,e){var n;this.Fn(t)&&(n=this.Mn(t,e.key)?2:0,this.Nn(t).Tn(e.key,n),this.yn=this.yn.rt(e.key,e),this.gn=this.gn.rt(e.key,this.Un(e.key).add(t)))},Gi.prototype.Cn=function(t,e,n){var r;this.Fn(t)&&(r=this.Nn(t),this.Mn(t,e)?r.Tn(e,1):r.mn(e),this.gn=this.gn.rt(e,this.Un(e).delete(t)),n&&(this.yn=this.yn.rt(e,n)))},Gi.prototype.removeTarget=function(t){this.Vn.delete(t)},Gi.prototype.Ln=function(t){var e=this.Nn(t).wn();return this.Pn.qn(t).size+e.tn.size-e.en.size},Gi.prototype.In=function(t){this.Nn(t).In()},Gi.prototype.Nn=function(t){var e=this.Vn.get(t);return e||(e=new Fi,this.Vn.set(t,e)),e},Gi.prototype.Un=function(t){var e=this.gn.get(t);return e||(e=new Ti(Rr),this.gn=this.gn.rt(t,e)),e},Gi.prototype.Fn=function(t){var e=null!==this.kn(t);return e||Er("WatchChangeAggregator","Detected inactive target",t),e},Gi.prototype.kn=function(t){var e=this.Vn.get(t);return e&&e._n?null:this.Pn.Bn(t)},Gi.prototype.xn=function(e){var n=this;this.Vn.set(e,new Fi),this.Pn.qn(e).forEach(function(t){n.Cn(e,t,null)})},Gi.prototype.Mn=function(t,e){return this.Pn.qn(t).has(e)},Gi);function Gi(t){this.Pn=t,this.Vn=new Map,this.yn=Ai,this.gn=Ji(),this.pn=new Ti(Rr)}function Bi(){this.un=0,this.cn=Qi(),this.an=ui.Z,this.hn=!1,this.ln=!0}function zi(t,e,n,r,i){this.resumeToken=t,this.Zt=e,this.tn=n,this.nn=r,this.en=i}function Yi(t,e,n,r,i){this.nt=t,this.Gt=e,this.zt=n,this.Ht=r,this.Yt=i}function Xi(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Bt=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.jt=s,this.Wt=u}function Hi(){this.Ut=new yi(Yr.g)}function Wi(n){this.g=n?function(t,e){return n(t,e)||Yr.g(t.key,e.key)}:function(t,e){return Yr.g(t.key,e.key)},this.Lt=ki,this.$t=new yi(this.g)}function Ji(){return new yi(Yr.g)}function Qi(){return new yi(Yr.g)}function Ki(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function $i(t){return t=so(t.mapValue.fields.__local_write_time__.timestampValue),new Fr(t.seconds,t.nanos)}var Zi=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function to(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Ki(t)?4:10:Nr()}function eo(r,i){var t,e=to(r);if(e!==to(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return $i(r).isEqual($i(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=so(r.timestampValue),t=so(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,ao(r.bytesValue).isEqual(ao(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,uo((t=r).geoPointValue.latitude)===uo(e.geoPointValue.latitude)&&uo(t.geoPointValue.longitude)===uo(e.geoPointValue.longitude);case 2:return t=i,"integerValue"in(e=r)&&"integerValue"in t?uo(e.integerValue)===uo(t.integerValue):"doubleValue"in e&&"doubleValue"in t&&((e=uo(e.doubleValue))===(t=uo(t.doubleValue))?ei(e)===ei(t):isNaN(e)&&isNaN(t));case 9:return Lr(r.arrayValue.values||[],i.arrayValue.values||[],eo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Sr(e)!==Sr(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!eo(e[t],n[t])))return!1;return!0}();default:return Nr()}}function no(t,e){return void 0!==(t.values||[]).find(function(t){return eo(t,e)})}function ro(t,e){var n,r,i,o=to(t),s=to(e);if(o!==s)return Rr(o,s);switch(o){case 0:return 0;case 1:return Rr(t.booleanValue,e.booleanValue);case 2:return n=e,(r=uo(t.integerValue||t.doubleValue))<(n=uo(n.integerValue||n.doubleValue))?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return io(t.timestampValue,e.timestampValue);case 4:return io($i(t),$i(e));case 5:return Rr(t.stringValue,e.stringValue);case 6:return i=t.bytesValue,s=e.bytesValue,i=ao(i),s=ao(s),i.A(s);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Rr(n[i],r[i]);if(0!==o)return o}return Rr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return o=t.geoPointValue,r=e.geoPointValue,0!==(n=Rr(uo(o.latitude),uo(r.latitude)))?n:Rr(uo(o.longitude),uo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=ro(n[i],r[i]);if(o)return o}return Rr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Rr(r[s],o[s]);if(0!==u)return u;if(0!==(u=ro(n[r[s]],i[o[s]])))return u}return Rr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Nr()}}function io(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Rr(t,e);var n=so(t),t=so(e);return 0!==(e=Rr(n.seconds,t.seconds))?e:Rr(n.nanos,t.nanos)}function oo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=so(t=i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?ao(i.bytesValue).toBase64():"referenceValue"in i?(e=i.referenceValue,Yr.W(e).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Nr();var t,e}(t)}function so(t){if(Or(!!t),"string"!=typeof t)return{seconds:uo(t.seconds),nanos:uo(t.nanos)};var e=0,n=Zi.exec(t);return Or(!!n),n[1]&&(n=(n[1]+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function uo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function ao(t){return"string"==typeof t?ui.fromBase64String(t):ui.fromUint8Array(t)}function ho(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.k()}}function co(t){return t&&"integerValue"in t}function lo(t){return!!t&&"arrayValue"in t}function fo(t){return t&&"nullValue"in t}function po(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function yo(t){return t&&"mapValue"in t}var vo={asc:"ASCENDING",desc:"DESCENDING"},go={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},mo=function(t,e){this.t=t,this.Qn=e};function wo(t){return{integerValue:""+t}}function bo(t,e){if(t.Qn){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ei(e)?"-0":e}}function Eo(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!ei(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?wo(e):bo(t,e);var n}function To(t,e){return t.Qn?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Io(t,e){return t.Qn?e.toBase64():e.toUint8Array()}function Ao(t){return Or(!!t),qr.I((t=so(t),new Fr(t.seconds,t.nanos)))}function No(t,e){return new Gr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).k()}function Oo(t){return Or(Mo(t=Gr.L(t))),t}function ko(t,e){return No(t.t,e.path)}function Do(t,e){if((e=Oo(e)).get(1)!==t.t.projectId)throw new Mr(jr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.t.projectId);if(e.get(3)!==t.t.database)throw new Mr(jr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.t.database);return new Yr(So(e))}function Ro(t,e){return No(t.t,e)}function Lo(t){return new Gr(["projects",t.t.projectId,"databases",t.t.database]).k()}function So(t){return Or(4<t.length&&"documents"===t.get(4)),t.v(5)}function Po(t,e,n){return{name:ko(t,e),fields:n.proto.mapValue.fields}}function _o(t,e){var n,r,i;if(e instanceof ys)n={update:Po(t,e.key,e.value)};else if(e instanceof Os)n={delete:ko(t,e.key)};else if(e instanceof vs)n={update:Po(t,e.key,e.data),updateMask:(i=e.jn,r=[],i.fields.forEach(function(t){return r.push(t.k())}),{fieldPaths:r})};else if(e instanceof Es)n={transform:{document:ko(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Bo)return{fieldPath:t.field.k(),setToServerValue:"REQUEST_TIME"};if(e instanceof zo)return{fieldPath:t.field.k(),appendMissingElements:{values:e.elements}};if(e instanceof Jo)return{fieldPath:t.field.k(),removeAllFromArray:{values:e.elements}};if(e instanceof Zo)return{fieldPath:t.field.k(),increment:e.Wn};throw Nr()})}};else{if(!(e instanceof ks))return Nr();n={verify:ko(t,e.key)}}return e.Gn.Kn||(n.currentDocument=void 0!==(i=e.Gn).updateTime?{updateTime:To(e=t,(t=i.updateTime).P())}:void 0!==i.exists?{exists:i.exists}:Nr()),n}function Co(t){var e=4===(o=Oo(t.parent)).length?Gr.$():So(o),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Or(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=jo(t.unaryFilter.field);return uu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=jo(t.unaryFilter.field);return uu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":return n=jo(t.unaryFilter.field),uu.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":return t=jo(t.unaryFilter.field),uu.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Nr()}}(e)]:void 0!==e.fieldFilter?[(n=e,uu.create(jo(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Nr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):Nr():[];var n}(n.where)),t=[],n.orderBy&&(t=n.orderBy.map(function(t){return new Uu(jo((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e})),r=null,n.limit&&(r=ti(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=Vo(n.startAt));var u=null;return n.endAt&&(u=Vo(n.endAt)),new Fs(e,i,t,o,r,"F",s,u)}function Uo(t){return{before:t.before,values:t.position}}function Vo(t){var e=!!t.before,t=t.values||[];return new ku(t,e)}function xo(t){return{fieldPath:t.k()}}function jo(t){return zr.B(t.fieldPath)}function Mo(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function Fo(t,e){return t instanceof Zo?co(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var qo,Go,Bo=(n(Xo,Go=me=function(){this.zn=void 0}),Xo),zo=(n(Yo,qo=me),Yo);function Yo(t){var e=this;return(e=qo.call(this)||this).elements=t,e}function Xo(){return null!==Go&&Go.apply(this,arguments)||this}function Ho(t,e){for(var n=ns(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return eo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var Wo,Jo=(n(Qo,Wo=me),Qo);function Qo(t){var e=this;return(e=Wo.call(this)||this).elements=t,e}function Ko(t,e){for(var n=ns(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!eo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var $o,Zo=(n(ts,$o=me),ts);function ts(t,e){var n=this;return(n=$o.call(this)||this).serializer=t,n.Wn=e,n}function es(t){return uo(t.integerValue||t.doubleValue)}function ns(t){return lo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function rs(t,e){this.field=t,this.transform=e}var is=(os.prototype.Hn=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].N(t))return!0;return!1},os.prototype.isEqual=function(t){return Lr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},os);function os(t){(this.fields=t).sort(zr.g)}function ss(t,e){this.version=t,this.transformResults=e}var us=(as.Yn=function(){return new as},as.exists=function(t){return new as(void 0,t)},as.updateTime=function(t){return new as(t)},Object.defineProperty(as.prototype,"Kn",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),as.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},as);function as(t,e){this.updateTime=t,this.exists=e}function hs(t,e){return void 0!==t.updateTime?e instanceof xs&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof xs}function cs(t,e,n,r){return t instanceof ys?(o=e,hs((i=t).Gn,o)?(o=fs(o),new xs(i.key,o,i.value,{Jn:!0})):o):t instanceof vs?function(t,e){if(!hs(t.Gn,e))return e;var n=fs(e),e=ws(t,e);return new xs(t.key,n,e,{Jn:!0})}(t,e):t instanceof Es?function(t,e,n,r){if(!hs(t.Gn,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],h=a.transform,c=null;n instanceof xs&&(c=n.field(a.field)),null===c&&r instanceof xs&&(c=r.field(a.field)),o.push((i=c,a=e,c=void 0,h instanceof Bo?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(c.fields.__previous_value__=i),{mapValue:c}):h instanceof zo?Ho(h,i):h instanceof Jo?Ko(h,i):(i=es(h=Fo(c=h,i))+es(c.Wn),co(h)&&co(c.Wn)?wo(i):bo(c.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=Is(t,i.data(),r);return new xs(t.key,i.version,r,{Jn:!0})}(t,e,r,n):hs(t.Gn,e)?new js(t.key,qr.min()):e;var i,o}function ls(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Gn.isEqual(e.Gn)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.jn.isEqual(e.jn):2!==t.type||Lr(t.fieldTransforms,t.fieldTransforms,function(t,e){return t.field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof zo&&e instanceof zo||t instanceof Jo&&e instanceof Jo?Lr(t.elements,e.elements,eo):t instanceof Zo&&e instanceof Zo?eo(t.Wn,e.Wn):t instanceof Bo&&e instanceof Bo)}))}function fs(t){return t instanceof xs?t.version:qr.min()}var ps,ds,ys=(n(ms,ds=l=function(){}),ms),vs=(n(gs,ps=l),gs);function gs(t,e,n,r){var i=this;return(i=ps.call(this)||this).key=t,i.data=e,i.jn=n,i.Gn=r,i.type=1,i}function ms(t,e,n){var r=this;return(r=ds.call(this)||this).key=t,r.value=e,r.Gn=n,r.type=0,r}function ws(t,e){return n=t,e=e instanceof xs?e.data():Ds.empty(),r=new Rs(e),n.jn.fields.forEach(function(t){var e;t.T()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Xn();var n,r}var bs,Es=(n(Ts,bs=l),Ts);function Ts(t,e){var n=this;return(n=bs.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Gn=us.exists(!0),n}function Is(t,e,n){for(var r=new Rs(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Xn()}var As,Ns,Os=(n(_s,Ns=l),_s),ks=(n(Ps,As=l),Ps),Ds=(Ss.empty=function(){return new Ss({mapValue:{}})},Ss.prototype.field=function(t){if(t.T())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!yo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.D()])||null},Ss.prototype.isEqual=function(t){return eo(this.proto,t.proto)},Ss),Rs=(Ls.prototype.set=function(t,e){return this.ne(t,e),this},Ls.prototype.delete=function(t){return this.ne(t,null),this},Ls.prototype.ne=function(t,e){for(var n=this.te,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===to(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.D(),e)},Ls.prototype.Xn=function(){var t=this.ee(zr.$(),this.te);return null!=t?new Ds(t):this.Zn},Ls.prototype.ee=function(r,t){var i=this,o=!1,e=this.Zn.field(r),s=yo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.ee(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Ls);function Ls(t){void 0===t&&(t=Ds.empty()),this.Zn=t,this.te=new Map}function Ss(t){this.proto=t}function Ps(t,e){var n=this;return(n=As.call(this)||this).key=t,n.Gn=e,n.type=4,n}function _s(t,e){var n=this;return(n=Ns.call(this)||this).key=t,n.Gn=e,n.type=3,n}var Cs,Us,Vs,xs=(n(Bs,Vs=me=function(t,e){this.key=t,this.version=e}),Bs.prototype.field=function(t){return this.se.field(t)},Bs.prototype.data=function(){return this.se},Bs.prototype.ie=function(){return this.se.proto},Bs.prototype.isEqual=function(t){return t instanceof Bs&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Jn===t.Jn&&this.hasCommittedMutations===t.hasCommittedMutations&&this.se.isEqual(t.se)},Bs.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.se.toString()+", {hasLocalMutations: "+this.Jn+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Bs.prototype,"hasPendingWrites",{get:function(){return this.Jn||this.hasCommittedMutations},enumerable:!1,configurable:!0}),Bs),js=(n(Gs,Us=me),Gs.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Gs.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Gs.prototype.isEqual=function(t){return t instanceof Gs&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Gs),Ms=(n(qs,Cs=me),qs.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(qs.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),qs.prototype.isEqual=function(t){return t instanceof qs&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},qs),Fs=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.re=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.oe=null,this.ue=null,this.startAt,this.endAt};function qs(){return null!==Cs&&Cs.apply(this,arguments)||this}function Gs(t,e,n){var r=this;return(r=Us.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function Bs(t,e,n,r){var i=this;return(i=Vs.call(this,t,e)||this).se=n,i.Jn=!!r.Jn,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function zs(t){return new Fs(t)}function Ys(t){return!ti(t.limit)&&"F"===t.limitType}function Xs(t){return!ti(t.limit)&&"L"===t.limitType}function Hs(t){return 0<t.re.length?t.re[0].field:null}function Ws(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.ce())return r.field}return null}function Js(t){return null!==t.collectionGroup}function Qs(t){var e=t;if(null===e.oe){e.oe=[];var n=Ws(e),t=Hs(e);if(null!==n&&null===t)n.U()||e.oe.push(new Uu(n)),e.oe.push(new Uu(zr.q(),"asc"));else{for(var r=!1,i=0,o=e.re;i<o.length;i++){var s=o[i];e.oe.push(s),s.field.U()&&(r=!0)}r||(n=0<e.re.length?e.re[e.re.length-1].dir:"asc",e.oe.push(new Uu(zr.q(),n)))}}return e.oe}function Ks(t){var e=t;if(!e.ue)if("F"===e.limitType)e.ue=ri(e.path,e.collectionGroup,Qs(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Qs(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Uu(o.field,s))}var u=e.endAt?new ku(e.endAt.position,!e.endAt.before):null,t=e.startAt?new ku(e.startAt.position,!e.startAt.before):null;e.ue=ri(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.ue}function $s(t,e,n){return new Fs(t.path,t.collectionGroup,t.re.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Zs(t,e){return new Fs(t.path,t.collectionGroup,t.re.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}function tu(t,e){return new Fs(t.path,t.collectionGroup,t.re.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}function eu(t,e){return oi(Ks(t),Ks(e))&&t.limitType===e.limitType}function nu(t){return ii(Ks(t))+"|lt:"+t.limitType}function ru(t){return"Query(target="+(n=(e=Ks(t)).path.k(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return t.field.k()+" "+t.op+" "+oo(t.value)}).join(", ")+"]"),ti(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return t.field.k()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Pu(e.startAt)),e.endAt&&(n+=", endAt: "+Pu(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function iu(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.K(e.collectionGroup)&&e.path.N(n):Yr.G(e.path)?e.path.isEqual(n):e.path.F(n))&&function(t){for(var e=0,n=i.re;e<n.length;e++){var r=n[e];if(!r.field.U()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||_u(t.startAt,Qs(t),n))&&(!t.endAt||!_u(t.endAt,Qs(t),n)));var e,n}function ou(u){return function(t,e){for(var n=!1,r=0,i=Qs(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i;switch(n=t.field.U()?Yr.g(e.key,n.key):(r=t.field,i=n,e=e.field(r),r=i.field(r),null!==e&&null!==r?ro(e,r):Nr()),t.dir){case"asc":return n;case"desc":return-1*n;default:return Nr()}}(o,t,e);if(0!==s)return s;n=n||o.field.U()}return 0}}var su,uu=(n(au,su=function(){}),au.create=function(t,e,n){return t.U()?"in"===e||"not-in"===e?this.ae(t,e,n):new fu(t,e,n):"array-contains"===e?new Iu(t,n):"in"===e?new Au(t,n):"not-in"===e?new Nu(t,n):"array-contains-any"===e?new Ou(t,n):new au(t,e,n)},au.ae=function(t,e,n){return new("in"===e?pu:du)(t,n)},au.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this.he(ro(t,this.value)):null!==t&&to(this.value)===to(t)&&this.he(ro(t,this.value))},au.prototype.he=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Nr()}},au.prototype.ce=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},au);function au(t,e,n){var r=this;return(r=su.call(this)||this).field=t,r.op=e,r.value=n,r}var hu,cu,lu,fu=(n(gu,lu=uu),gu.prototype.matches=function(t){return t=Yr.g(t.key,this.key),this.he(t)},gu),pu=(n(vu,cu=uu),vu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},vu),du=(n(yu,hu=uu),yu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},yu);function yu(t,e){var n=this;return(n=hu.call(this,t,"not-in",e)||this).keys=mu(0,e),n}function vu(t,e){var n=this;return(n=cu.call(this,t,"in",e)||this).keys=mu(0,e),n}function gu(t,e,n){var r=this;return(r=lu.call(this,t,e,n)||this).key=Yr.W(n.referenceValue),r}function mu(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return Yr.W(t.referenceValue)})}var wu,bu,Eu,Tu,Iu=(n(Su,Tu=uu),Su.prototype.matches=function(t){return lo(t=t.field(this.field))&&no(t.arrayValue,this.value)},Su),Au=(n(Lu,Eu=uu),Lu.prototype.matches=function(t){return null!==(t=t.field(this.field))&&no(this.value.arrayValue,t)},Lu),Nu=(n(Ru,bu=uu),Ru.prototype.matches=function(t){return!no(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&(null!==(t=t.field(this.field))&&!no(this.value.arrayValue,t))},Ru),Ou=(n(Du,wu=uu),Du.prototype.matches=function(t){var e=this;return!(!lo(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return no(e.value.arrayValue,t)})},Du),ku=function(t,e){this.position=t,this.before=e};function Du(t,e){return wu.call(this,t,"array-contains-any",e)||this}function Ru(t,e){return bu.call(this,t,"not-in",e)||this}function Lu(t,e){return Eu.call(this,t,"in",e)||this}function Su(t,e){return Tu.call(this,t,"array-contains",e)||this}function Pu(t){return(t.before?"b":"a")+":"+t.position.map(oo).join(",")}function _u(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.U()?Yr.g(Yr.W(s.referenceValue),n.key):ro(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Cu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!eo(t.position[n],e.position[n]))return!1;return!0}var Uu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e},Vu=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})},xu=(Fu.prototype.reset=function(){this.Ee=0},Fu.prototype.Ie=function(){this.Ee=this.we},Fu.prototype.Ae=function(t){var e=this;this.cancel();var n=Math.floor(this.Ee+this.Re()),r=Math.max(0,Date.now()-this.me),i=Math.max(0,n-r);0<i&&Er("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Ee+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Te=this.le.Pe(this._e,i,function(){return e.me=Date.now(),t()}),this.Ee*=this.de,this.Ee<this.fe&&(this.Ee=this.fe),this.Ee>this.we&&(this.Ee=this.we)},Fu.prototype.Ve=function(){null!==this.Te&&(this.Te.ye(),this.Te=null)},Fu.prototype.cancel=function(){null!==this.Te&&(this.Te.cancel(),this.Te=null)},Fu.prototype.Re=function(){return(Math.random()-.5)*this.Ee},Fu),ju=(Mu.prototype.catch=function(t){return this.next(void 0,t)},Mu.prototype.next=function(r,i){var o=this;return this.be&&Nr(),this.be=!0,this.ve?this.error?this.Ce(i,this.error):this.Se(r,this.result):new Mu(function(e,n){o.ge=function(t){o.Se(r,t).next(e,n)},o.pe=function(t){o.Ce(i,t).next(e,n)}})},Mu.prototype.De=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Mu.prototype.Ne=function(t){try{var e=t();return e instanceof Mu?e:Mu.resolve(e)}catch(t){return Mu.reject(t)}},Mu.prototype.Se=function(t,e){return t?this.Ne(function(){return t(e)}):Mu.resolve(e)},Mu.prototype.Ce=function(t,e){return t?this.Ne(function(){return t(e)}):Mu.reject(e)},Mu.resolve=function(n){return new Mu(function(t,e){t(n)})},Mu.reject=function(n){return new Mu(function(t,e){e(n)})},Mu.Fe=function(t){return new Mu(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Mu.xe=function(t){for(var n=Mu.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Mu.resolve(t):e()})}(r[e]);return n},Mu.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Fe(i)},Mu);function Mu(t){var e=this;this.ge=null,this.pe=null,this.result=void 0,this.error=void 0,this.ve=!1,this.be=!1,t(function(t){e.ve=!0,e.result=t,e.ge&&e.ge(t)},function(t){e.ve=!0,e.error=t,e.pe&&e.pe(t)})}function Fu(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.le=t,this._e=e,this.fe=n,this.de=r,this.we=i,this.Ee=0,this.Te=null,this.me=Date.now(),this.reset()}function qu(t){return"IndexedDbTransactionError"===t.name}function Gu(){return"undefined"!=typeof document?document:null}var Bu=(Xu.Me=function(t,e,n,r,i){return(i=new Xu(t,e,Date.now()+n,r,i)).start(n),i},Xu.prototype.start=function(t){var e=this;this.Ue=setTimeout(function(){return e.qe()},t)},Xu.prototype.ye=function(){return this.qe()},Xu.prototype.cancel=function(t){null!==this.Ue&&(this.clearTimeout(),this.$e.reject(new Mr(jr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Xu.prototype.qe=function(){var e=this;this.Oe.Be(function(){return null!==e.Ue?(e.clearTimeout(),e.op().then(function(t){return e.$e.resolve(t)})):Promise.resolve()})},Xu.prototype.clearTimeout=function(){null!==this.Ue&&(this.Le(this),clearTimeout(this.Ue),this.Ue=null)},Xu),zu=(Object.defineProperty(Yu.prototype,"Xe",{get:function(){return this.We},enumerable:!1,configurable:!0}),Yu.prototype.Be=function(t){this.enqueue(t)},Yu.prototype.Ze=function(t){this.ts(),this.ns(t)},Yu.prototype.es=function(){var t;this.We||(this.We=!0,(t=Gu())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Je))},Yu.prototype.enqueue=function(t){return this.ts(),this.We?new Promise(function(t){}):this.ns(t)},Yu.prototype.ss=function(t){var e=this;this.Be(function(){return e.je.push(t),e.rs()})},Yu.prototype.rs=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.je.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.je[0]()];case 2:return t.sent(),this.je.shift(),this.Ye.reset(),[3,4];case 3:if(!qu(e=t.sent()))throw e;return Er("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.je.length&&this.Ye.Ae(function(){return n.rs()}),t.label=5;case 5:return[2]}})})},Yu.prototype.ns=function(t){var r=this,e=this.Qe.then(function(){return r.ze=!0,t().catch(function(t){throw r.Ge=t,r.ze=!1,Tr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.ze=!1,t})});return this.Qe=e},Yu.prototype.Pe=function(t,e,n){var r=this;return this.ts(),-1<this.He.indexOf(t)&&(e=0),n=Bu.Me(this,t,e,n,function(t){return r.os(t)}),this.Ke.push(n),n},Yu.prototype.ts=function(){this.Ge&&Nr()},Yu.prototype.us=function(){},Yu.prototype.cs=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Qe];case 1:t.sent(),t.label=2;case 2:if(e!==this.Qe)return[3,0];t.label=3;case 3:return[2]}})})},Yu.prototype.hs=function(t){for(var e=0,n=this.Ke;e<n.length;e++)if(n[e]._e===t)return!0;return!1},Yu.prototype.ls=function(r){var i=this;return this.cs().then(function(){i.Ke.sort(function(t,e){return t.ke-e.ke});for(var t=0,e=i.Ke;t<e.length;t++){var n=e[t];if(n.ye(),"all"!==r&&n._e===r)break}return i.cs()})},Yu.prototype._s=function(t){this.He.push(t)},Yu.prototype.os=function(t){t=this.Ke.indexOf(t),this.Ke.splice(t,1)},Yu);function Yu(){var e=this;this.Qe=Promise.resolve(),this.je=[],this.We=!1,this.Ke=[],this.Ge=null,this.ze=!1,this.He=[],this.Ye=new xu(this,"async_queue_retry"),this.Je=function(){var t=Gu();t&&Er("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Ye.Ve()};var t=Gu();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Je)}function Xu(t,e,n,r,i){this.Oe=t,this._e=e,this.ke=n,this.op=r,this.Le=i,this.$e=new Vu,this.then=this.$e.promise.then.bind(this.$e.promise),this.$e.promise.catch(function(t){})}function Hu(t,e){if(Tr("AsyncQueue",e+": "+t),qu(t))return new Mr(jr.UNAVAILABLE,e+": "+t);throw t}function Wu(){this.queries=new xr(nu,eu),this.onlineState="Unknown",this.ds=new Set}var Ju=function(){this.fs=void 0,this.listeners=[]};function Qu(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new Ju),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.ws(n)];case 2:return o.fs=t.sent(),[3,4];case 3:return o=Hu(o=t.sent(),"Initialization of query '"+ru(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.Es(e.onlineState),i.fs&&u.Ts(i.fs)&&$u(e),[2]}})})}function Ku(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.Is(n))]:[2]})})}function $u(t){t.ds.forEach(function(t){t.next()})}var Zu=(na.prototype.Ts=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Ci(t.query,t.docs,t.Bt,e,t.Qt,t.fromCache,t.jt,!0)}var o=!1;return this.Rs?this.Vs(t)&&(this.As.next(t),o=!0):this.ys(t,this.onlineState)&&(this.gs(t),o=!0),this.Ps=t,o},na.prototype.onError=function(t){this.As.error(t)},na.prototype.Es=function(t){this.onlineState=t;var e=!1;return this.Ps&&!this.Rs&&this.ys(this.Ps,t)&&(this.gs(this.Ps),e=!0),e},na.prototype.ys=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.ps&&n||t.docs.T()&&"Offline"!==e)},na.prototype.Vs=function(t){if(0<t.docChanges.length)return!0;var e=this.Ps&&this.Ps.hasPendingWrites!==t.hasPendingWrites;return!(!t.jt&&!e)&&!0===this.options.includeMetadataChanges},na.prototype.gs=function(t){t=Ci.Kt(t.query,t.docs,t.Qt,t.fromCache),this.Rs=!0,this.As.next(t)},na),ta=(ea.prototype.vs=function(){return null!=this.uid},ea.prototype.bs=function(){return this.vs()?"uid:"+this.uid:"anonymous-user"},ea.prototype.isEqual=function(t){return t.uid===this.uid},ea);function ea(t){this.uid=t}function na(t,e,n){this.query=t,this.As=e,this.Rs=!1,this.Ps=null,this.onlineState="Unknown",this.options=n||{}}function ra(t,e){this.user=e,this.type="OAuth",this.Ds={},this.Ds.Authorization="Bearer "+t}ta.UNAUTHENTICATED=new ta(null),ta.Cs=new ta("google-credentials-uid"),ta.Ss=new ta("first-party-uid");var ia=(ya.prototype.getToken=function(){return Promise.resolve(null)},ya.prototype.Fs=function(){},ya.prototype.xs=function(t){(this.Ns=t)(ta.UNAUTHENTICATED)},ya.prototype.Os=function(){this.Ns=null},ya),oa=(da.prototype.getToken=function(){var e=this,n=this.$s,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.$s!==n?(Er("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Or("string"==typeof t.accessToken),new ra(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},da.prototype.Fs=function(){this.forceRefresh=!0},da.prototype.xs=function(t){this.Ns=t,this.Ls&&t(this.currentUser)},da.prototype.Os=function(){this.auth&&this.auth.removeAuthTokenListener(this.ks),this.ks=null,this.Ns=null},da.prototype.Ms=function(){var t=this.auth&&this.auth.getUid();return Or(null===t||"string"==typeof t),new ta(t)},da),sa=(Object.defineProperty(pa.prototype,"Ds",{get:function(){var t={"X-Goog-AuthUser":this.qs},e=this.Us.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),pa),ua=(fa.prototype.getToken=function(){return Promise.resolve(new sa(this.Us,this.qs))},fa.prototype.xs=function(t){t(ta.Ss)},fa.prototype.Os=function(){},fa.prototype.Fs=function(){},fa),aa=(la.prototype.Qs=function(t,e,n){for(var r,i,o,s,u,a=n.js,h=0;h<this.mutations.length;h++){var c=this.mutations[h];c.key.isEqual(t)&&(r=c,i=e,o=a[h],c=u=s=void 0,e=r instanceof ys?new xs(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof vs?(u=i,c=o,hs((s=r).Gn,u)?(u=ws(s,u),new xs(s.key,c.version,u,{hasCommittedMutations:!0})):new Ms(s.key,c.version)):r instanceof Es?function(t,e,n){if(Or(null!=n.transformResults),!hs(t.Gn,e))return new Ms(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Or(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof xs&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof zo?Ho(o,s):o instanceof Jo?Ko(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=Is(t,r.data(),e);return new xs(t.key,n,e,{hasCommittedMutations:!0})}(r,i,o):new js(r.key,o.version,{hasCommittedMutations:!0}))}return e},la.prototype.Ws=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=cs(i,e,e,this.Bs))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=cs(a,e,o,this.Bs))}return e},la.prototype.Ks=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.Ws(t.key,n.get(t.key));e&&(i=i.rt(t.key,e))}),i},la.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Li())},la.prototype.isEqual=function(t){return this.batchId===t.batchId&&Lr(this.mutations,t.mutations,ls)&&Lr(this.baseMutations,t.baseMutations,ls)},la),ha=(ca.from=function(t,e,n){Or(t.mutations.length===n.length);for(var r=Di,i=t.mutations,o=0;o<i.length;o++)r=r.rt(i[o].key,n[o].version);return new ca(t,e,n,r)},ca);function ca(t,e,n,r){this.batch=t,this.Gs=e,this.js=n,this.zs=r}function la(t,e,n,r){this.batchId=t,this.Bs=e,this.baseMutations=n,this.mutations=r}function fa(t,e){this.Us=t,this.qs=e}function pa(t,e){this.Us=t,this.qs=e,this.type="FirstParty",this.user=ta.Ss}function da(t){var e=this;this.ks=null,this.currentUser=ta.UNAUTHENTICATED,this.Ls=!1,this.$s=0,this.Ns=null,this.forceRefresh=!1,this.ks=function(){e.$s++,e.currentUser=e.Ms(),e.Ls=!0,e.Ns&&e.Ns(e.currentUser)},this.$s=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.ks):(this.ks(null),t.get().then(function(t){e.auth=t,e.ks&&e.auth.addAuthTokenListener(e.ks)},function(){}))}function ya(){this.Ns=null}function va(t){return new mo(t,!0)}function ga(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var ma=(Ia.prototype.Xs=function(e,n){var r=this;return this.Ys.Zs(e,n).next(function(t){return r.ti(e,n,t)})},Ia.prototype.ti=function(t,r,i){return this.Hs.ni(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].Ws(r,t);return t})},Ia.prototype.ei=function(t,e,i){var o=Ai;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].Ws(t,e);o=o.rt(t,e)}),o},Ia.prototype.si=function(e,t){var n=this;return this.Hs.getEntries(e,t).next(function(t){return n.ii(e,t)})},Ia.prototype.ii=function(e,r){var i=this;return this.Ys.ri(e,r).next(function(t){var t=i.ei(e,r,t),n=Ai;return t.forEach(function(t,e){e=e||new js(t,qr.min()),n=n.rt(t,e)}),n})},Ia.prototype.oi=function(t,e,n){return r=e,Yr.G(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.ui(t,e.path):Js(e)?this.ci(t,e,n):this.ai(t,e,n);var r},Ia.prototype.ui=function(t,e){return this.Xs(t,new Yr(e)).next(function(t){var e=ki;return t instanceof xs&&(e=e.rt(t.key,t)),e})},Ia.prototype.ci=function(n,r,i){var o=this,s=r.collectionGroup,u=ki;return this.Js.hi(n,s).next(function(t){return ju.forEach(t,function(t){var e=(e=r,t=t.child(s),new Fs(t,null,e.re.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.ai(n,e,i).next(function(t){t.forEach(function(t,e){u=u.rt(t,e)})})}).next(function(){return u})})},Ia.prototype.ai=function(e,n,t){var a,h,r=this;return this.Hs.oi(e,n,t).next(function(t){return a=t,r.Ys.li(e,n)}).next(function(t){return h=t,r._i(e,h,a).next(function(t){a=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,s=cs(s,s=a.get(u),s,r.Bs);a=s instanceof xs?a.rt(u,s):a.remove(u)}})}).next(function(){return a.forEach(function(t,e){iu(n,e)||(a=a.remove(t))}),a})},Ia.prototype._i=function(t,e,n){for(var r=Li(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof vs&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.Hs.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof xs&&(h=h.rt(t,e))}),h})},Ia),wa=(Ta.wi=function(t,e){for(var n=Li(),r=Li(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Ta(t,e.fromCache,n,r)},Ta),ba=(Ea.prototype.Ti=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Ea.prototype.next=function(){var t=++this.previousValue;return this.mi&&this.mi(t),t},Ea);function Ea(t,e){var n=this;this.previousValue=t,e&&(e.Ei=function(t){return n.Ti(t)},this.mi=function(t){return e.Ii(t)})}function Ta(t,e,n,r){this.targetId=t,this.fromCache=e,this.fi=n,this.di=r}function Ia(t,e,n){this.Hs=t,this.Ys=e,this.Js=n}function Aa(t){this.Ri=t}ba.Ai=-1;var Na=(Pa.prototype.Vi=function(t,e){return this.Pi.add(e),ju.resolve()},Pa.prototype.hi=function(t,e){return ju.resolve(this.Pi.getEntries(e))},Pa),Oa=(Sa.prototype.add=function(t){var e=t.D(),n=t.C(),r=this.index[e]||new Ti(Gr.g),t=!r.has(n);return this.index[e]=r.add(n),t},Sa.prototype.has=function(t){var e=t.D(),t=t.C();return(e=this.index[e])&&e.has(t)},Sa.prototype.getEntries=function(t){return(this.index[t]||new Ti(Gr.g)).O()},Sa),ka=(La.prototype.next=function(){return this.yi+=2,this.yi},La.gi=function(){return new La(0)},La.pi=function(){return new La(-1)},La),Da=(Ra.prototype.qi=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Bi(t,n.bi)})},Ra);function Ra(t,e,n,r){this.persistence=t,this.vi=e,this.serializer=r,this.bi=new yi(Rr),this.Ci=new xr(ii,oi),this.Si=qr.min(),this.Ys=t.Di(n),this.Ni=t.Fi(),this.xi=t.Oi(),this.ki=new ma(this.Ni,this.Ys,this.persistence.Li()),this.$i=t.Mi(),this.vi.Ui(this.ki)}function La(t){this.yi=t}function Sa(){this.index={}}function Pa(){this.Pi=new Oa}function _a(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Ys,m=e.ki,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.Ys.Qi(v).next(function(t){return g=t,n=e.persistence.Di(o),m=new ma(e.Ni,n,e.persistence.Li()),n.Qi(v)}).next(function(t){for(var e=[],n=[],r=Li(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.si(v,r).next(function(t){return{ji:t,Wi:e,Ki:n}})})})];case 1:return r=t.sent(),[2,(e.Ys=n,e.ki=m,e.vi.Ui(e.ki),r)]}})})}function Ca(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.xi.Xi(t)})}function Ua(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).bi.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.ir.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!qu(r=t.sent()))throw r;return Er("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.bi=e.bi.remove(o),e.Ci.delete(n.target),[2]}})})}function Va(t,o,s){var u=t,a=qr.min(),h=Li();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=Ks(o),(void 0!==(t=(i=t).Ci.get(r))?ju.resolve(i.bi.get(t)):i.xi.ar(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.xi.hr(e,t.targetId).next(function(t){h=t})}).next(function(){return u.vi.oi(e,o,s?a:qr.min(),s?h:Li())}).next(function(t){return{documents:t,lr:h}});var t,n,r,i})}function xa(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==jr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Er("LocalStore","Unexpectedly lost primary lease"),[2]})})}function ja(t,e,n,r,i){var o=this;this.io=t,this.ro=e,this.Oe=n,this.oo={},this.uo=[],this.co=new Map,this.ao=new Set,this.ho=[],this.lo=i,this.lo._o(function(t){n.Be(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return oh(this)?(Er("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).ao.add(4),[4,$a(e)];case 1:return t.sent(),e.fo.set("Unknown"),e.ao.delete(4),[4,Ka(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.fo=new Ya(n,r)}var Ma,Fa,qa,l=(Qa.prototype.mr=function(){return 1===this.state||2===this.state||4===this.state},Qa.prototype.Ir=function(){return 2===this.state},Qa.prototype.start=function(){3!==this.state?this.auth():this.Ar()},Qa.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.mr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Qa.prototype.Rr=function(){this.state=0,this.Ye.reset()},Qa.prototype.Pr=function(){var t=this;this.Ir()&&null===this.Tr&&(this.Tr=this.le.Pe(this._r,6e4,function(){return t.Vr()}))},Qa.prototype.yr=function(t){this.gr(),this.stream.send(t)},Qa.prototype.Vr=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.Ir()?[2,this.close(0)]:[2]})})},Qa.prototype.gr=function(){this.Tr&&(this.Tr.cancel(),this.Tr=null)},Qa.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.gr(),this.Ye.cancel(),this.Er++,3!==e?this.Ye.reset():n&&n.code===jr.RESOURCE_EXHAUSTED?(Tr(n.toString()),Tr("Using maximum backoff delay to prevent overloading the backend."),this.Ye.Ie()):n&&n.code===jr.UNAUTHENTICATED&&this.wr.Fs(),null!==this.stream&&(this.pr(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.vr(n)];case 1:return t.sent(),[2]}})})},Qa.prototype.pr=function(){},Qa.prototype.auth=function(){var n=this;this.state=1;var t=this.br(this.Er),e=this.Er;this.wr.getToken().then(function(t){n.Er===e&&n.Cr(t)},function(e){t(function(){var t=new Mr(jr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Sr(t)})})},Qa.prototype.Cr=function(t){var e=this,n=this.br(this.Er);this.stream=this.Dr(t),this.stream.Nr(function(){n(function(){return e.state=2,e.listener.Nr()})}),this.stream.vr(function(t){n(function(){return e.Sr(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Qa.prototype.Ar=function(){var t=this;this.state=4,this.Ye.Ae(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},Qa.prototype.Sr=function(t){return Er("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Qa.prototype.br=function(e){var n=this;return function(t){n.le.Be(function(){return n.Er===e?t():(Er("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Qa),Ga=(n(Ja,qa=l),Ja.prototype.Dr=function(t){return this.dr.Fr("Listen",t)},Ja.prototype.onMessage=function(t){this.Ye.reset();var e,n=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:Nr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.Qn?(Or(void 0===o||"string"==typeof o),ui.fromBase64String(o||"")):(Or(void 0===o||o instanceof Uint8Array),ui.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?jr.UNKNOWN:di(s.code),new Mr(o,s.message||"")),r=new Mi(n,r,i,s||null)}else if("documentChange"in e){e.documentChange,(a=e.documentChange).document,a.document.name,a.document.updateTime;var i=Do(t,a.document.name),u=Ao(a.document.updateTime),s=new Ds({mapValue:{fields:a.document.fields}}),u=new xs(i,u,s,{}),s=a.targetIds||[],a=a.removedTargetIds||[];r=new xi(s,a,u.key,u)}else if("documentDelete"in e){e.documentDelete,(a=e.documentDelete).document;var u=Do(t,a.document),h=a.readTime?Ao(a.readTime):qr.min(),h=new js(u,h),a=a.removedTargetIds||[];r=new xi([],a,h.key,h)}else if("documentRemove"in e){e.documentRemove,(h=e.documentRemove).document;var c=Do(t,h.document),h=h.removedTargetIds||[];r=new xi([],h,c,null)}else{if(!("filter"in e))return Nr();e.filter,(c=e.filter).targetId,e=new hi(e=c.count||0),c=c.targetId,r=new ji(c,e)}return r}(this.serializer,t),t=!("targetChange"in(e=t))||(e=e.targetChange).targetIds&&e.targetIds.length||!e.readTime?qr.min():Ao(e.readTime);return this.listener.Or(n,t)},Ja.prototype.kr=function(t){var e,n,r,i,o,s,u,a,h={};h.database=Lo(this.serializer),h.addTarget=(e=this.serializer,(r=si(r=(n=t).target)?{documents:{documents:[Ro(e,r.path)]}}:{query:(i=e,s={structuredQuery:{}},u=(o=r).path,null!==o.collectionGroup?(s.parent=Ro(i,u),s.structuredQuery.from=[{collectionId:o.collectionGroup,allDescendants:!0}]):(s.parent=Ro(i,u.C()),s.structuredQuery.from=[{collectionId:u.D()}]),(u=function(t){if(0!==t.length)return 1===(t=t.map(function(t){if("=="===t.op){if(po(t.value))return{unaryFilter:{field:xo(t.field),op:"IS_NAN"}};if(fo(t.value))return{unaryFilter:{field:xo(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(po(t.value))return{unaryFilter:{field:xo(t.field),op:"IS_NOT_NAN"}};if(fo(t.value))return{unaryFilter:{field:xo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:xo(t.field),op:(e=t.op,go[e]),value:t.value}};var e})).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(o.filters))&&(s.structuredQuery.where=u),(u=function(t){if(0!==t.length)return t.map(function(t){return{field:xo(t.field),direction:(t=t.dir,vo[t])}})}(o.orderBy))&&(s.structuredQuery.orderBy=u),u=o.limit,null!==(u=i.Qn||ti(u)?u:{value:u})&&(s.structuredQuery.limit=u),o.startAt&&(s.structuredQuery.startAt=Uo(o.startAt)),o.endAt&&(s.structuredQuery.endAt=Uo(o.endAt)),s)}).targetId=n.targetId,0<n.resumeToken.X()?r.resumeToken=Io(e,n.resumeToken):0<n.nt.A(qr.min())&&(r.readTime=To(e,n.nt.P())),r),(t=(this.serializer,a=t,null==(t=function(){switch(a.tt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Nr()}}())?null:{"goog-listen-tags":t}))&&(h.labels=t),this.yr(h)},Ja.prototype.Lr=function(t){var e={};e.database=Lo(this.serializer),e.removeTarget=t,this.yr(e)},Ja),Ba=(n(Wa,Fa=l),Object.defineProperty(Wa.prototype,"Mr",{get:function(){return this.$r},enumerable:!1,configurable:!0}),Wa.prototype.start=function(){this.$r=!1,this.lastStreamToken=void 0,Fa.prototype.start.call(this)},Wa.prototype.pr=function(){this.$r&&this.Ur([])},Wa.prototype.Dr=function(t){return this.dr.Fr("Write",t)},Wa.prototype.onMessage=function(t){if(Or(!!t.streamToken),this.lastStreamToken=t.streamToken,this.$r){this.Ye.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Or(void 0!==r),n.map(function(t){return n=r,(t=(e=t).updateTime?Ao(e.updateTime):Ao(n)).isEqual(qr.min())&&(t=Ao(n)),n=null,e.transformResults&&0<e.transformResults.length&&(n=e.transformResults),new ss(t,n);var e,n})):[]),n=Ao(t.commitTime);return this.listener.qr(n,e)}var r;return Or(!t.writeResults||0===t.writeResults.length),this.$r=!0,this.listener.Br()},Wa.prototype.Qr=function(){var t={};t.database=Lo(this.serializer),this.yr(t)},Wa.prototype.Ur=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return _o(e.serializer,t)})};this.yr(t)},Wa),za=(n(Ha,Ma=function(){}),Ha.prototype.Wr=function(){if(this.jr)throw new Mr(jr.FAILED_PRECONDITION,"The client has already been terminated.")},Ha.prototype.Kr=function(e,n,r){var i=this;return this.Wr(),this.credentials.getToken().then(function(t){return i.dr.Kr(e,n,r,t)}).catch(function(t){throw t.code===jr.UNAUTHENTICATED&&i.credentials.Fs(),t})},Ha.prototype.Gr=function(e,n,r){var i=this;return this.Wr(),this.credentials.getToken().then(function(t){return i.dr.Gr(e,n,r,t)}).catch(function(t){throw t.code===jr.UNAUTHENTICATED&&i.credentials.Fs(),t})},Ha.prototype.terminate=function(){this.jr=!1},Ha),Ya=(Xa.prototype.Xr=function(){var t=this;0===this.Hr&&(this.Zr("Unknown"),this.Yr=this.Oe.Pe("online_state_timeout",1e4,function(){return t.Yr=null,t.no("Backend didn't respond within 10 seconds."),t.Zr("Offline"),Promise.resolve()}))},Xa.prototype.eo=function(t){"Online"===this.state?this.Zr("Unknown"):(this.Hr++,1<=this.Hr&&(this.so(),this.no("Connection failed 1 times. Most recent error: "+t.toString()),this.Zr("Offline")))},Xa.prototype.set=function(t){this.so(),this.Hr=0,"Online"===t&&(this.Jr=!1),this.Zr(t)},Xa.prototype.Zr=function(t){t!==this.state&&(this.state=t,this.zr(t))},Xa.prototype.no=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.Jr?(Tr(t),this.Jr=!1):Er("OnlineStateTracker",t)},Xa.prototype.so=function(){null!==this.Yr&&(this.Yr.cancel(),this.Yr=null)},Xa);function Xa(t,e){this.Oe=t,this.zr=e,this.state="Unknown",this.Hr=0,this.Yr=null,this.Jr=!0}function Ha(t,e,n){var r=this;return(r=Ma.call(this)||this).credentials=t,r.dr=e,r.serializer=n,r.jr=!1,r}function Wa(t,e,n,r,i){var o=this;return(o=Fa.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.$r=!1,o}function Ja(t,e,n,r,i){var o=this;return(o=qa.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Qa(t,e,n,r,i,o){this.le=t,this._r=n,this.dr=r,this.wr=i,this.listener=o,this.state=0,this.Er=0,this.Tr=null,this.stream=null,this.Ye=new xu(t,e)}function Ka(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!oh(r))return[3,4];e=0,n=r.ho,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function $a(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.ho,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Za(t,e){t.co.has(e.targetId)||(t.co.set(e.targetId,e),ih(t)?rh(t):fh(t).Ir()&&eh(t,e))}function th(t,e){var n=t,t=fh(n);n.co.delete(e),t.Ir()&&nh(n,e),0===n.co.size&&(t.Ir()?t.Pr():oh(n)&&n.fo.set("Unknown"))}function eh(t,e){t.wo.In(e.targetId),fh(t).kr(e)}function nh(t,e){t.wo.In(e),fh(t).Lr(e)}function rh(e){e.wo=new qi({qn:function(t){return e.oo.qn(t)},Bn:function(t){return e.co.get(t)||null}}),fh(e).start(),e.fo.Xr()}function ih(t){return oh(t)&&!fh(t).mr()&&0<t.co.size}function oh(t){return 0===t.ao.size}function sh(t){t.wo=void 0}function uh(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!qu(r))throw r;return n.ao.add(1),[4,$a(n)];case 1:return t.sent(),n.fo.set("Offline"),i=i||function(){return Ca(n.io)},n.Oe.ss(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Er("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.ao.delete(1),[4,Ka(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function ah(e,n){return n().catch(function(t){return uh(e,t,n)})}function hh(h){return y(this,void 0,void 0,function(){var o,s,u,a;return v(this,function(t){switch(t.label){case 0:s=ph(o=h),u=0<o.uo.length?o.uo[o.uo.length-1].batchId:-1,t.label=1;case 1:if(!(oh(o)&&o.uo.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(n=o.io,r=u,(i=n).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===r&&(r=-1),i.Ys.cr(t,r)}))];case 3:return null===(a=t.sent())?(0===o.uo.length&&s.Pr(),[3,7]):(u=a.batchId,e=a,(n=o).uo.push(e),(n=ph(n)).Ir()&&n.Mr&&n.Ur(e.mutations),[3,6]);case 4:return a=t.sent(),[4,uh(o,a)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return ch(o)&&lh(o),[2]}var e,n,r,i})})}function ch(t){return oh(t)&&!ph(t).mr()&&0<t.uo.length}function lh(t){ph(t).start()}function fh(n){var t,e,r,i=this;return n.Ao||(n.Ao=(t=n.ro,e=n.Oe,r={Nr:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.co.forEach(function(t,e){eh(n,t)}),[2]})})}.bind(null,n),vr:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return sh(e),ih(e)?(e.fo.eo(n),rh(e)):e.fo.set("Unknown"),[2]})})}.bind(null,n),Or:function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.fo.set("Online"),!(u instanceof Mi&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.co.has(i)?[4,o.oo.Eo(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.co.delete(i),o.wo.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Er("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,uh(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof xi?s.wo.vn(u):u instanceof ji?s.wo.On(u):s.wo.Sn(u),a.isEqual(qr.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Ca(s.io)];case 8:return o=t.sent(),0<=a.A(o)?[4,(i=a,(e=(r=s).wo.$n(i)).Gt.forEach(function(t,e){var n;0<t.resumeToken.X()&&(n=r.co.get(e))&&r.co.set(e,n.st(t.resumeToken,i))}),e.zt.forEach(function(t){var e=r.co.get(t);e&&(r.co.set(t,e.st(ui.Z,e.nt)),nh(r,t),e=new li(e.target,t,1,e.sequenceNumber),eh(r,e))}),r.oo.To(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Er("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,uh(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n)},t.Wr(),new Ga(e,t.dr,t.credentials,t.serializer,r)),n.ho.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Ao.Rr(),ih(n)?rh(n):n.fo.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.Ao.stop()];case 2:t.sent(),sh(n),t.label=3;case 3:return[2]}})})})),n.Ao}function ph(n){var t,e,r,i=this;return n.Ro||(n.Ro=(t=n.ro,e=n.Oe,r={Nr:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return ph(e).Qr(),[2]})})}.bind(null,n),vr:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&ph(e).Mr?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return pi(n=i.code)&&n!==jr.ABORTED?(e=r.uo.shift(),ph(r).Rr(),[4,ah(r,function(){return r.oo.Io(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,hh(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return ch(e)&&lh(e),[2]}})})}.bind(null,n),Br:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=ph(o),n=0,r=o.uo;n<r.length;n++)i=r[n],e.Ur(i.mutations);return[2]})})}.bind(null,n),qr:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.uo.shift(),n=ha.from(e,i,o),[4,ah(r,function(){return r.oo.mo(n)})];case 1:return t.sent(),[4,hh(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Wr(),new Ba(e,t.dr,t.credentials,t.serializer,r)),n.ho.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Ro.Rr(),[4,hh(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.Ro.stop()];case 3:t.sent(),0<n.uo.length&&(Er("RemoteStore","Stopping write stream with "+n.uo.length+" pending writes"),n.uo=[]),t.label=4;case 4:return[2]}})})})),n.Ro}var dh=(Rh.prototype.T=function(){return this.Po.T()},Rh.prototype.vo=function(t,e){e=new yh(t,e),this.Po=this.Po.add(e),this.yo=this.yo.add(e)},Rh.prototype.bo=function(t,e){var n=this;t.forEach(function(t){return n.vo(t,e)})},Rh.prototype.Co=function(t,e){this.So(new yh(t,e))},Rh.prototype.Do=function(t,e){var n=this;t.forEach(function(t){return n.Co(t,e)})},Rh.prototype.No=function(t){var e=this,n=new Yr(new Gr([])),r=new yh(n,t),t=new yh(n,t+1),i=[];return this.yo.Nt([r,t],function(t){e.So(t),i.push(t.key)}),i},Rh.prototype.Fo=function(){var e=this;this.Po.forEach(function(t){return e.So(t)})},Rh.prototype.So=function(t){this.Po=this.Po.delete(t),this.yo=this.yo.delete(t)},Rh.prototype.xo=function(t){var e=new Yr(new Gr([])),n=new yh(e,t),t=new yh(e,t+1),r=Li();return this.yo.Nt([n,t],function(t){r=r.add(t.key)}),r},Rh.prototype.Oo=function(t){var e=new yh(t,0);return null!==(e=this.Po.xt(e))&&t.isEqual(e.key)},Rh),yh=(Dh.Vo=function(t,e){return Yr.g(t.key,e.key)||Rr(t.ko,e.ko)},Dh.po=function(t,e){return Rr(t.ko,e.ko)||Yr.g(t.key,e.key)},Dh),vh=(kh.prototype.Lo=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},kh.prototype.$o=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},kh.prototype.Mo=function(){var t={activeTargetIds:this.activeTargetIds.O(),updateTimeMs:Date.now()};return JSON.stringify(t)},kh),gh=(Oh.prototype.Bo=function(t){},Oh.prototype.Qo=function(t,e,n){},Oh.prototype.jo=function(t){return this.Uo.Lo(t),this.qo[t]||"not-current"},Oh.prototype.Wo=function(t,e,n){this.qo[t]=e},Oh.prototype.Ko=function(t){this.Uo.$o(t)},Oh.prototype.Go=function(t){return this.Uo.activeTargetIds.has(t)},Oh.prototype.zo=function(t){delete this.qo[t]},Oh.prototype.Ho=function(){return this.Uo.activeTargetIds},Oh.prototype.Yo=function(t){return this.Uo.activeTargetIds.has(t)},Oh.prototype.start=function(){return this.Uo=new vh,Promise.resolve()},Oh.prototype.Jo=function(t,e,n){},Oh.prototype.Xo=function(t){},Oh.prototype.Zo=function(){},Oh.prototype.Ii=function(t){},Oh.prototype.tu=function(){},Oh),mh=function(t){this.key=t},wh=function(t){this.key=t},bh=(Object.defineProperty(Nh.prototype,"ou",{get:function(){return this.nu},enumerable:!1,configurable:!0}),Nh.prototype.uu=function(t,e){var s=this,u=e?e.cu:new _i,a=(e||this).ru,h=(e||this).Qt,c=a,l=!1,f=Ys(this.query)&&a.size===this.query.limit?a.last():null,p=Xs(this.query)&&a.size===this.query.limit?a.first():null;if(t.at(function(t,e){var n=a.get(t),r=(r=e instanceof xs?e:null)&&(iu(s.query,r)?r:null),i=!!n&&s.Qt.has(n.key),o=!!r&&(r.Jn||s.Qt.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.au(n,r)||(u.track({type:2,doc:r}),e=!0,(f&&0<s.iu(r,f)||p&&s.iu(r,p)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(h=r?(c=c.add(r),o?h.add(t):h.delete(t)):(c=c.delete(t),h.delete(t)))}),Ys(this.query)||Xs(this.query))for(;c.size>this.query.limit;){var n=Ys(this.query)?c.last():c.first(),c=c.delete(n.key),h=h.delete(n.key);u.track({type:1,doc:n})}return{ru:c,cu:u,hu:l,Qt:h}},Nh.prototype.au=function(t,e){return t.Jn&&e.hasCommittedMutations&&!e.Jn},Nh.prototype.lu=function(t,e,n){var o=this,r=this.ru;this.ru=t.ru,this.Qt=t.Qt;var i=t.cu.qt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.iu(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Nr()}}var r,i}),this._u(n);var s=e?this.fu():[],e=(n=0===this.su.size&&this.Zt?1:0)!==this.eu;return this.eu=n,0!==i.length||e?{snapshot:new Ci(this.query,t.ru,r,i,t.Qt,0==n,e,!1),du:s}:{du:s}},Nh.prototype.Es=function(t){return this.Zt&&"Offline"===t?(this.Zt=!1,this.lu({ru:this.ru,cu:new _i,Qt:this.Qt,hu:!1},!1)):{du:[]}},Nh.prototype.wu=function(t){return!this.nu.has(t)&&!!this.ru.has(t)&&!this.ru.get(t).Jn},Nh.prototype._u=function(t){var e=this;t&&(t.tn.forEach(function(t){return e.nu=e.nu.add(t)}),t.nn.forEach(function(t){}),t.en.forEach(function(t){return e.nu=e.nu.delete(t)}),this.Zt=t.Zt)},Nh.prototype.fu=function(){var e=this;if(!this.Zt)return[];var n=this.su;this.su=Li(),this.ru.forEach(function(t){e.wu(t.key)&&(e.su=e.su.add(t.key))});var r=[];return n.forEach(function(t){e.su.has(t)||r.push(new wh(t))}),this.su.forEach(function(t){n.has(t)||r.push(new mh(t))}),r},Nh.prototype.Eu=function(t){return this.nu=t.lr,this.su=Li(),t=this.uu(t.documents),this.lu(t,!0)},Nh.prototype.Tu=function(){return Ci.Kt(this.query,this.ru,this.Qt,0===this.eu)},Nh),Eh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Th=function(t){this.key=t,this.mu=!1},Ih=(Object.defineProperty(Ah.prototype,"xu",{get:function(){return!0===this.Fu},enumerable:!1,configurable:!0}),Ah);function Ah(t,e,n,r,i,o){this.io=t,this.Iu=e,this.Au=n,this.Ru=r,this.currentUser=i,this.Pu=o,this.Vu={},this.yu=new xr(nu,eu),this.gu=new Map,this.pu=[],this.vu=new yi(Yr.g),this.bu=new Map,this.Cu=new dh,this.Su={},this.Du=new Map,this.Nu=ka.pi(),this.onlineState="Unknown",this.Fu=void 0}function Nh(t,e){this.query=t,this.nu=e,this.eu=null,this.Zt=!1,this.su=Li(),this.Qt=Li(),this.iu=ou(t),this.ru=new Pi(this.iu)}function Oh(){this.Uo=new vh,this.qo={},this.zr=null,this.Ei=null}function kh(){this.activeTargetIds=Si}function Dh(t,e){this.key=t,this.ko=e}function Rh(){this.Po=new Ti(yh.Vo),this.yo=new Ti(yh.po)}function Lh(f,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:(o=f).Iu.oo.mo=function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.io,c=s,(l=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=c.batch.keys(),n=l.Ni.Gi({zi:!0}),i=l,o=t,s=n,u=(r=c).batch,a=u.keys(),h=ju.resolve();return a.forEach(function(n){h=h.next(function(){return s.ni(o,n)}).next(function(t){var e=t;Or(null!==(t=r.zs.get(n))),(!e||e.version.A(t)<0)&&(e=u.Qs(n,e,r))&&s.Hi(e,r.Gs)})}),h.next(function(){return i.Ys.Yi(o,u)}).next(function(){return n.apply(t)}).next(function(){return l.Ys.Ji(t)}).next(function(){return l.ki.si(t,e)})}))];case 2:return i=t.sent(),Uh(n,r,null),Ch(n,r),n.Ru.Qo(r,"acknowledged"),[4,Fh(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,xa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,c,l})})}.bind(null,o),o.Iu.oo.Io=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.io,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Ys.qu(e,r).next(function(t){return Or(null!==t),n=t.keys(),i.Ys.Yi(e,t)}).next(function(){return i.Ys.Ji(e)}).next(function(){return i.ki.si(e,n)})}))];case 2:return o=t.sent(),Uh(n,u,a),Ch(n,u),n.Ru.Qo(u,"rejected",a),[4,Fh(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,xa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.io,a=p,c=r,l=Fr.now(),i=a.reduce(function(t,e){return t.add(e.key)},Li()),c.persistence.runTransaction("Locally write mutations","readwrite",function(u){return c.ki.si(u,i).next(function(t){h=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=h.get(i.key),s instanceof Es?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof xs?t.field(i.field):void 0;null!=(o=Fo(i.transform,o||null))&&(e=(null==e?new Rs:e).set(i.field,o))}return e?e.Xn():null}(o):null);null!=o&&e.push(new vs(i.key,o,function s(t){var u=[];return Pr(t.fields||{},function(t,e){var n=new zr([t]);if(yo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new is(u)}(o.proto.mapValue),us.exists(!0)))}return c.Ys.Mu(u,l,e,a)})}).then(function(t){var e=t.Ks(h);return{batchId:t.batchId,Uu:e}}))];case 2:return s=t.sent(),u.Ru.Bo(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.Su[e.currentUser.bs()])||new yi(Rr)).rt(n,o),e.Su[e.currentUser.bs()]=r,[4,Fh(u,s.Uu)];case 3:return t.sent(),[4,hh(u.Iu)];case 4:return t.sent(),[3,6];case 5:return u=Hu(u=t.sent(),"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,h,c,l,i,o})})}function Sh(i,s){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:n=i,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.io,c=e,l=(o=s).nt,f=c.bi,c.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=c.Ni.Gi({zi:!0});f=c.bi;var u=[];o.Gt.forEach(function(t,e){var n,r,i,o=f.get(e);o&&(u.push(c.xi.Zi(s,t.en,e).next(function(){return c.xi.tr(s,t.tn,e)})),0<(i=t.resumeToken).X()&&(n=o.st(i,l).et(s.nr),f=f.rt(e,n),r=o,i=t,Or(0<(o=n).resumeToken.X()),(0===r.resumeToken.X()||3e8<=o.nt.R()-r.nt.R()||0<i.tn.size+i.nn.size+i.en.size)&&u.push(c.xi.er(s,n))))});var e,a,n,h,r,i=Ai;return o.Ht.forEach(function(t,e){o.Yt.has(t)&&u.push(c.persistence.ir.sr(s,t))}),u.push((e=s,a=t,n=o.Ht,h=l,r=Li(),n.forEach(function(t){return r=r.add(t)}),a.getEntries(e,r).next(function(i){var o=Ai;return n.forEach(function(t,e){var n=i.get(t),r=h;e instanceof js&&e.version.isEqual(qr.min())?(a.rr(t,r),o=o.rt(t,e)):null==n||0<e.version.A(n.version)||0===e.version.A(n.version)&&n.hasPendingWrites?(a.Hi(e,r),o=o.rt(t,e)):Er("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o}).next(function(t){i=t}))),l.isEqual(qr.min())||(e=c.xi.Xi(s).next(function(t){return c.xi.ur(s,s.nr,l)}),u.push(e)),ju.Fe(u).next(function(){return t.apply(s)}).next(function(){return c.ki.ii(s,i)})}).then(function(t){return c.bi=f,t}))];case 2:return r=t.sent(),s.Gt.forEach(function(t,e){(e=n.bu.get(e))&&(Or(t.tn.size+t.nn.size+t.en.size<=1),0<t.tn.size?e.mu=!0:0<t.nn.size?Or(e.mu):0<t.en.size&&(Or(e.mu),e.mu=!1))}),[4,Fh(n,r,s)];case 3:return t.sent(),[3,6];case 4:return[4,xa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,o,c,l,f})})}function Ph(t,n,e){var r;((t=t).xu&&0===e||!t.xu&&1===e)&&(r=[],t.yu.forEach(function(t,e){(e=e.view.Es(n)).snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Es(i)&&(o=!0)}),o&&$u(t)}(t.Au,n),r.length&&t.Vu.Or(r),t.onlineState=n,t.xu&&t.Ru.Xo(n))}function _h(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:oh((n=o).Iu)||Er("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.io).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Ys.Bu(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Du.get(r)||[]).push(s),n.Du.set(r,i),[3,4]);case 3:return i=Hu(i=t.sent(),"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function Ch(t,e){(t.Du.get(e)||[]).forEach(function(t){t.resolve()}),t.Du.delete(e)}function Uh(t,e,n){var r=t,i=r.Su[r.currentUser.bs()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.Su[r.currentUser.bs()]=i)}function Vh(e,t,n){void 0===n&&(n=null),e.Ru.Ko(t);for(var r=0,i=e.gu.get(t);r<i.length;r++){var o=i[r];e.yu.delete(o),n&&e.Vu.Ou(o,n)}e.gu.delete(t),e.xu&&e.Cu.No(t).forEach(function(t){e.Cu.Oo(t)||xh(e,t)})}function xh(t,e){var n=t.vu.get(e);null!==n&&(th(t.Iu,n),t.vu=t.vu.remove(e),t.bu.delete(n),Mh(t))}function jh(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var u=s[o];u instanceof mh?(t.Cu.vo(u.key,e),r=t,i=(i=u).key,r.vu.get(i)||(Er("SyncEngine","New document in limbo: "+i),r.pu.push(i),Mh(r))):u instanceof wh?(Er("SyncEngine","Document no longer in limbo: "+u.key),t.Cu.Co(u.key,e),t.Cu.Oo(u.key)||xh(t,u.key)):Nr()}}function Mh(t){for(;0<t.pu.length&&t.vu.size<t.Pu;){var e=t.pu.shift(),n=t.Nu.next();t.bu.set(n,new Th(e)),t.vu=t.vu.rt(e,n),Za(t.Iu,new li(Ks(zs(e.path)),n,2,ba.Ai))}}function Fh(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).yu.T()?[3,3]:(n.yu.forEach(function(t,e){o.push(n.$u(e,s,u).then(function(t){t&&(n.xu&&n.Ru.Wo(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=wa.wi(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.Vu.Or(r),[4,function(a,h){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return ju.forEach(h,function(e){return ju.forEach(e.fi,function(t){return r.persistence.ir.vo(n,e.targetId,t)}).next(function(){return ju.forEach(e.di,function(t){return r.persistence.ir.Co(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!qu(e=t.sent()))throw e;return Er("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=h;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.bi.get(o),u=s.nt,u=s.it(u),r.bi=r.bi.rt(o,u));return[2]}})})}(n.io,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}var qh,Gh,Bh,zh=(Oc.prototype.Ui=function(t){this.Qu=t},Oc.prototype.oi=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.re.length||1===r.re.length&&r.re[0].field.U())||i.isEqual(qr.min())?this.ju(e,r):this.Qu.si(e,o).next(function(t){var n=s.Wu(r,t);return(Ys(r)||Xs(r))&&s.hu(r.limitType,n,o,i)?s.ju(e,r):(br()<=u.DEBUG&&Er("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ru(r)),s.Qu.oi(e,r,i).next(function(e){return n.forEach(function(t){e=e.rt(t.key,t)}),e}))})},Oc.prototype.Wu=function(n,t){var r=new Ti(ou(n));return t.forEach(function(t,e){e instanceof xs&&iu(n,e)&&(r=r.add(e))}),r},Oc.prototype.hu=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version.A(r))},Oc.prototype.ju=function(t,e){return br()<=u.DEBUG&&Er("IndexFreeQueryEngine","Using full collection scan to execute query:",ru(e)),this.Qu.oi(t,e,qr.min())},Oc),Yh=(Nc.prototype.zu=function(t){return ju.resolve(0===this.Ys.length)},Nc.prototype.Mu=function(t,e,n,r){var i=this.Ku;this.Ku++,0<this.Ys.length&&this.Ys[this.Ys.length-1],n=new aa(i,e,n,r),this.Ys.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Gu=this.Gu.add(new yh(u.key,i)),this.Js.Vi(t,u.key.path.C())}return ju.resolve(n)},Nc.prototype.qu=function(t,e){return ju.resolve(this.Hu(e))},Nc.prototype.cr=function(t,e){return e+=1,e=(e=this.Yu(e))<0?0:e,ju.resolve(this.Ys.length>e?this.Ys[e]:null)},Nc.prototype.Bu=function(){return ju.resolve(0===this.Ys.length?-1:this.Ku-1)},Nc.prototype.Qi=function(t){return ju.resolve(this.Ys.slice())},Nc.prototype.Zs=function(t,e){var n=this,r=new yh(e,0),e=new yh(e,Number.POSITIVE_INFINITY),i=[];return this.Gu.Nt([r,e],function(t){t=n.Hu(t.ko),i.push(t)}),ju.resolve(i)},Nc.prototype.ri=function(t,e){var n=this,r=new Ti(Rr);return e.forEach(function(t){var e=new yh(t,0),t=new yh(t,Number.POSITIVE_INFINITY);n.Gu.Nt([e,t],function(t){r=r.add(t.ko)})}),ju.resolve(this.Ju(r))},Nc.prototype.li=function(t,e){var n=e.path,r=n.length+1,e=n;Yr.G(e)||(e=e.child(""));var e=new yh(new Yr(e),0),i=new Ti(Rr);return this.Gu.Ft(function(t){var e=t.key.path;return!!n.N(e)&&(e.length===r&&(i=i.add(t.ko)),!0)},e),ju.resolve(this.Ju(i))},Nc.prototype.Ju=function(t){var e=this,n=[];return t.forEach(function(t){null!==(t=e.Hu(t))&&n.push(t)}),n},Nc.prototype.Yi=function(n,r){var i=this;Or(0===this.Xu(r.batchId,"removed")),this.Ys.shift();var o=this.Gu;return ju.forEach(r.mutations,function(t){var e=new yh(t.key,r.batchId);return o=o.delete(e),i.ir.Zu(n,t.key)}).next(function(){i.Gu=o})},Nc.prototype.tc=function(t){},Nc.prototype.Oo=function(t,e){var n=new yh(e,0),n=this.Gu.xt(n);return ju.resolve(e.isEqual(n&&n.key))},Nc.prototype.Ji=function(t){return this.Ys.length,ju.resolve()},Nc.prototype.Xu=function(t,e){return this.Yu(t)},Nc.prototype.Yu=function(t){return 0===this.Ys.length?0:t-this.Ys[0].batchId},Nc.prototype.Hu=function(t){return(t=this.Yu(t))<0||t>=this.Ys.length?null:this.Ys[t]},Nc),Xh=(Ac.prototype.Hi=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this.nc(e);return this.docs=this.docs.rt(r,{ec:e,size:o,readTime:n}),this.size+=o-i,this.Js.Vi(t,r.path.C())},Ac.prototype.rr=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Ac.prototype.ni=function(t,e){return e=this.docs.get(e),ju.resolve(e?e.ec:null)},Ac.prototype.getEntries=function(t,e){var n=this,r=Ai;return e.forEach(function(t){var e=n.docs.get(t);r=r.rt(t,e?e.ec:null)}),ju.resolve(r)},Ac.prototype.oi=function(t,e,n){for(var r=ki,i=new Yr(e.path.child("")),o=this.docs._t(i);o.It();){var s=(u=o.Tt()).key,u=(a=u.value).ec,a=a.readTime;if(!e.path.N(s.path))break;a.A(n)<=0||u instanceof xs&&iu(e,u)&&(r=r.rt(u.key,u))}return ju.resolve(r)},Ac.prototype.sc=function(t,e){return ju.forEach(this.docs,function(t){return e(t)})},Ac.prototype.Gi=function(t){return new Hh(this)},Ac.prototype.ic=function(t){return ju.resolve(this.size)},Ac),Hh=(Ic.prototype.oc=function(t){return(t=this.Uu.get(t))?t.readTime:qr.min()},Ic.prototype.Hi=function(t,e){this.uc(),this.Uu.set(t.key,{ec:t,readTime:e})},Ic.prototype.rr=function(t,e){void 0===e&&(e=null),this.uc(),this.Uu.set(t,{ec:null,readTime:e})},Ic.prototype.ni=function(t,e){this.uc();var n=this.Uu.get(e);return void 0!==n?ju.resolve(n.ec):this.cc(t,e)},Ic.prototype.getEntries=function(t,e){return this.ac(t,e)},Ic.prototype.apply=function(t){return this.uc(),this.rc=!0,this.lu(t)},Ic.prototype.uc=function(){},n(Tc,Bh=Ic),Tc.prototype.lu=function(n){var r=this,i=[];return this.Uu.forEach(function(t,e){e&&e.ec?i.push(r.hc.Hi(n,e.ec,r.oc(t))):r.hc.rr(t)}),ju.Fe(i)},Tc.prototype.cc=function(t,e){return this.hc.ni(t,e)},Tc.prototype.ac=function(t,e){return this.hc.getEntries(t,e)},Tc),Wh=(Ec.prototype.Dn=function(t,n){return this.lc.forEach(function(t,e){return n(e)}),ju.resolve()},Ec.prototype.Xi=function(t){return ju.resolve(this.lastRemoteSnapshotVersion)},Ec.prototype.wc=function(t){return ju.resolve(this._c)},Ec.prototype.ku=function(t){return this.highestTargetId=this.dc.next(),ju.resolve(this.highestTargetId)},Ec.prototype.ur=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this._c&&(this._c=e),ju.resolve()},Ec.prototype.Ec=function(t){this.lc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.dc=new ka(e),this.highestTargetId=e),t.sequenceNumber>this._c&&(this._c=t.sequenceNumber)},Ec.prototype.Lu=function(t,e){return this.Ec(e),this.targetCount+=1,ju.resolve()},Ec.prototype.er=function(t,e){return this.Ec(e),ju.resolve()},Ec.prototype.Tc=function(t,e){return this.lc.delete(e.target),this.fc.No(e.targetId),--this.targetCount,ju.resolve()},Ec.prototype.mc=function(n,r,i){var o=this,s=0,u=[];return this.lc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.lc.delete(t),u.push(o.Ic(n,e.targetId)),s++)}),ju.Fe(u).next(function(){return s})},Ec.prototype.Ac=function(t){return ju.resolve(this.targetCount)},Ec.prototype.ar=function(t,e){return e=this.lc.get(e)||null,ju.resolve(e)},Ec.prototype.tr=function(t,e,n){return this.fc.bo(e,n),ju.resolve()},Ec.prototype.Zi=function(e,t,n){this.fc.Do(t,n);var r=this.persistence.ir,i=[];return r&&t.forEach(function(t){i.push(r.Zu(e,t))}),ju.Fe(i)},Ec.prototype.Ic=function(t,e){return this.fc.No(e),ju.resolve()},Ec.prototype.hr=function(t,e){return e=this.fc.xo(e),ju.resolve(e)},Ec.prototype.Oo=function(t,e){return ju.resolve(this.fc.Oo(e))},Ec),Jh=(bc.prototype.Vc=function(t,e){return ju.resolve(this.Rc.get(e))},bc.prototype.yc=function(t,e){return this.Rc.set(e.id,{id:e.id,version:e.version,createTime:Ao(e.createTime)}),ju.resolve()},bc.prototype.gc=function(t,e){return ju.resolve(this.Pc.get(e))},bc.prototype.vc=function(t,e){var n,r;return this.Pc.set(e.name,{name:(n=e).name,query:(e=Co({parent:(r=n.bundledQuery).parent,structuredQuery:r.structuredQuery}),"LAST"===r.limitType?$s(e,e.limit,"L"):e),readTime:Ao(n.readTime)}),ju.resolve()},bc),Qh=(wc.prototype.start=function(){return Promise.resolve()},wc.prototype.Zo=function(){return this.Sc=!1,Promise.resolve()},Object.defineProperty(wc.prototype,"Nc",{get:function(){return this.Sc},enumerable:!1,configurable:!0}),wc.prototype.Fc=function(){},wc.prototype.xc=function(){},wc.prototype.Li=function(){return this.Js},wc.prototype.Di=function(t){var e=this.bc[t.bs()];return e||(e=new Yh(this.Js,this.ir),this.bc[t.bs()]=e),e},wc.prototype.Oi=function(){return this.xi},wc.prototype.Fi=function(){return this.Hs},wc.prototype.Mi=function(){return this.$i},wc.prototype.runTransaction=function(t,e,n){var r=this;Er("MemoryPersistence","Starting transaction:",t);var i=new Kh(this.Cc.next());return this.ir.Oc(),n(i).next(function(t){return r.ir.kc(i).next(function(){return t})}).De().then(function(t){return i.Lc(),t})},wc.prototype.$c=function(e,n){return ju.xe(Object.values(this.bc).map(function(t){return function(){return t.Oo(e,n)}}))},wc),Kh=(mc.prototype.Uc=function(t){this.Mc.push(t)},mc.prototype.Lc=function(){this.Mc.forEach(function(t){return t()})},n(gc,Gh=mc),gc),$h=(vc.Qc=function(t){return new vc(t)},Object.defineProperty(vc.prototype,"jc",{get:function(){if(this.Bc)return this.Bc;throw Nr()},enumerable:!1,configurable:!0}),vc.prototype.vo=function(t,e,n){return this.qc.vo(n,e),this.jc.delete(n.toString()),ju.resolve()},vc.prototype.Co=function(t,e,n){return this.qc.Co(n,e),this.jc.add(n.toString()),ju.resolve()},vc.prototype.Zu=function(t,e){return this.jc.add(e.toString()),ju.resolve()},vc.prototype.removeTarget=function(t,e){var n=this;this.qc.No(e.targetId).forEach(function(t){return n.jc.add(t.toString())});var r=this.persistence.Oi();return r.hr(t,e.targetId).next(function(t){t.forEach(function(t){return n.jc.add(t.toString())})}).next(function(){return r.Tc(t,e)})},vc.prototype.Oc=function(){this.Bc=new Set},vc.prototype.kc=function(n){var r=this,i=this.persistence.Fi().Gi();return ju.forEach(this.jc,function(t){var e=Yr.j(t);return r.Wc(n,e).next(function(t){t||i.rr(e)})}).next(function(){return r.Bc=null,i.apply(n)})},vc.prototype.sr=function(t,e){var n=this;return this.Wc(t,e).next(function(t){t?n.jc.delete(e.toString()):n.jc.add(e.toString())})},vc.prototype.Dc=function(t){return 0},vc.prototype.Wc=function(t,e){var n=this;return ju.xe([function(){return ju.resolve(n.qc.Oo(e))},function(){return n.persistence.Oi().Oo(t,e)},function(){return n.persistence.$c(t,e)}])},vc),Zh=(yc.prototype.Nr=function(t){this.zc=t},yc.prototype.vr=function(t){this.Hc=t},yc.prototype.onMessage=function(t){this.Yc=t},yc.prototype.close=function(){this.Gc()},yc.prototype.send=function(t){this.Kc(t)},yc.prototype.Jc=function(){this.zc()},yc.prototype.Xc=function(t){this.Hc(t)},yc.prototype.Zc=function(t){this.Yc(t)},yc),tc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},ec=(dc.prototype.Kr=function(e,t,n,r){var i=this.sa(e,t);return Er("RestConnection","Sending: ",i,n),t={},this.ia(t,r),this.ra(e,i,t,n).then(function(t){return Er("RestConnection","Received: ",t),t},function(t){throw Ir("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},dc.prototype.Gr=function(t,e,n,r){return this.Kr(t,e,n,r)},dc.prototype.ia=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.0.2",t["Content-Type"]="text/plain",e)for(var n in e.Ds)e.Ds.hasOwnProperty(n)&&(t[n]=e.Ds[n])},dc.prototype.sa=function(t,e){return t=tc[t],this.na+"/v1/"+e+":"+t},n(pc,qh=dc),pc.prototype.ra=function(o,e,s,u){return new Promise(function(n,r){var i=new dr;i.listenOnce(fr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case lr.NO_ERROR:var t=i.getResponseJson();Er("Connection","XHR received:",JSON.stringify(t)),n(t);break;case lr.TIMEOUT:Er("Connection",'RPC "'+o+'" timed out'),r(new Mr(jr.DEADLINE_EXCEEDED,"Request time out"));break;case lr.HTTP_ERROR:var e=i.getStatus();Er("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(jr).indexOf(e)?e:jr.UNKNOWN,r(new Mr(e,t.message))):r(new Mr(jr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Mr(jr.UNAVAILABLE,"Connection failed."));break;default:Nr()}}finally{Er("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},pc.prototype.Fr=function(t,e){var n,r=[this.na,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new sr,t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.ia(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),Er("Connection","Creating WebChannel: "+(r=r.join("")),t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new Zh({Kc:function(t){u?Er("Connection","Not sending because WebChannel is closed:",t):(s||(Er("Connection","Opening WebChannel transport."),o.open(),s=!0),Er("Connection","WebChannel sending:",t),o.send(t))},Gc:function(){return o.close()}});return(t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})})(pr.EventType.OPEN,function(){u||Er("Connection","WebChannel transport opened.")}),t(pr.EventType.CLOSE,function(){u||(u=!0,Er("Connection","WebChannel transport closed"),a.Xc())}),t(pr.EventType.ERROR,function(t){u||(u=!0,Ir("Connection","WebChannel transport errored:",t),a.Xc(new Mr(jr.UNAVAILABLE,"The operation could not be completed")))}),t(pr.EventType.MESSAGE,function(t){var e,n,r,i;u||(Or(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Er("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=ci[r];if(void 0!==t)return di(t)}(),i=n.message,void 0===t&&(t=jr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.Xc(new Mr(t,i)),o.close()):(Er("Connection","WebChannel received:",e),a.Zc(e)))}),setTimeout(function(){a.Jc()},0),a},pc),nc=(fc.prototype._o=function(t){this.ha.push(t)},fc.prototype.Zo=function(){window.removeEventListener("online",this.oa),window.removeEventListener("offline",this.ca)},fc.prototype.la=function(){window.addEventListener("online",this.oa),window.addEventListener("offline",this.ca)},fc.prototype.ua=function(){Er("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.ha;t<e.length;t++)(0,e[t])(0)},fc.prototype.aa=function(){Er("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.ha;t<e.length;t++)(0,e[t])(1)},fc._a=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},fc),rc=(lc.prototype._o=function(t){},lc.prototype.Zo=function(){},lc),ic=(cc.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.serializer=va(e.ta.t),this.Ru=this.fa(e),this.persistence=this.da(e),[4,this.persistence.start()];case 1:return t.sent(),this.wa=this.Ea(e),this.io=this.Ta(e),[2]}})})},cc.prototype.Ea=function(t){return null},cc.prototype.Ta=function(t){return e=this.persistence,n=new zh,r=t.ma,t=this.serializer,new Da(e,n,r,t);var e,n,r},cc.prototype.da=function(t){return new Qh($h.Qc,this.serializer)},cc.prototype.fa=function(t){return new gh},cc.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.wa&&this.wa.stop(),[4,this.Ru.Zo()];case 1:return t.sent(),[4,this.persistence.Zo()];case 2:return t.sent(),[2]}})})},cc),oc=(hc.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.io?[3,2]:(this.io=n.io,this.Ru=n.Ru,this.ro=this.Ia(r),this.Iu=this.Aa(r),this.Au=this.Ra(r),this.Pa=this.Va(r,!n.synchronizeTabs),this.Ru.zr=function(t){return Ph(e.Pa,t,1)},this.Iu.oo.ya=function(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Er("SyncEngine","User change. New user:",o.bs()),[4,_a(n.io,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Du.forEach(function(t){t.forEach(function(t){t.reject(new Mr(jr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Du.clear(),n.Ru.Jo(o,r.Wi,r.Ki),[4,Fh(n,r.ji)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this.Pa),[4,function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.ao.delete(2),[4,Ka(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.ao.add(2),[4,$a(e)]);case 3:t.sent(),e.fo.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.Iu,this.Pa.xu)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},hc.prototype.Ra=function(t){return new Wu},hc.prototype.Ia=function(t){var e=va(t.ta.t),n=(n=t.ta,new ec(n));return t=t.credentials,new za(t,n,e)},hc.prototype.Aa=function(t){var e=this;return new ja(this.io,this.ro,t.Oe,function(t){return Ph(e.Pa,t,0)},t=new(nc._a()?nc:rc))},hc.prototype.Va=function(t,e){return n=this.io,r=this.Iu,i=this.Au,o=this.Ru,s=t.ma,t=t.Pu,e=e,t=new Ih(n,r,i,o,s,t),e&&(t.Fu=!0),t;var n,r,i,o,s},hc.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Er("RemoteStore","RemoteStore shutting down."),e.ao.add(5),[4,$a(e)];case 1:return t.sent(),e.lo.Zo(),e.fo.set("Unknown"),[2]}})})}(this.Iu)},hc),sc=(ac.prototype.next=function(t){this.observer.next&&this.ga(this.observer.next,t)},ac.prototype.error=function(t){this.observer.error?this.ga(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},ac.prototype.pa=function(){this.muted=!0},ac.prototype.ga=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},ac),uc=function(t){this.va=t};function ac(t){this.observer=t,this.muted=!1}function hc(){}function cc(){this.synchronizeTabs=!1}function lc(){}function fc(){var t=this;this.oa=function(){return t.ua()},this.ca=function(){return t.aa()},this.ha=[],this.la()}function pc(t){var e=this;return(e=qh.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.i=t.i,e}function dc(t){this.ta=t,this.t=t.t;var e=t.ssl?"https":"http";this.na=e+"://"+t.host,this.ea="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}function yc(t){this.Kc=t.Kc,this.Gc=t.Gc}function vc(t){this.persistence=t,this.qc=new dh,this.Bc=null}function gc(t){var e=this;return(e=Gh.call(this)||this).nr=t,e}function mc(){this.Mc=[]}function wc(t,e){var n=this;this.bc={},this.Cc=new ba(0),this.Sc=!1,this.Sc=!0,this.ir=t(this),this.xi=new Wh(this),this.Js=new Na,this.Hs=(t=this.Js,new Xh(t,function(t){return n.ir.Dc(t)})),this.serializer=new Aa(e),this.$i=new Jh(this.serializer)}function bc(t){this.serializer=t,this.Rc=new Map,this.Pc=new Map}function Ec(t){this.persistence=t,this.lc=new xr(ii,oi),this.lastRemoteSnapshotVersion=qr.min(),this.highestTargetId=0,this._c=0,this.fc=new dh,this.targetCount=0,this.dc=ka.gi()}function Tc(t){var e=this;return(e=Bh.call(this)||this).hc=t,e}function Ic(){this.Uu=new xr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.rc=!1}function Ac(t,e){this.Js=t,this.nc=e,this.docs=new yi(Yr.g),this.size=0}function Nc(t,e){this.Js=t,this.ir=e,this.Ys=[],this.Ku=1,this.Gu=new Ti(yh.Vo)}function Oc(){}function kc(t,e,n){if(!n)throw new Mr(jr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Dc(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Mr(jr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Rc(t,e,n,r){if(!0===e&&!0===r)throw new Mr(jr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Lc(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Nr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Sc(t,e){if(t instanceof uc&&(t=t.va),t instanceof e)return t;if(e.name===t.constructor.name)throw new Mr(jr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");throw t=Lc(t),new Mr(jr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function Pc(t,e){if(e<=0)throw new Mr(jr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var _c,Cc=function(t){this.ba=t},Uc=(n(Vc,_c=Cc),Vc.prototype.Ca=function(t){if(2!==t.Sa)throw 1===t.Sa?t.Da(this.ba+"() can only appear at the top level of your update data"):t.Da(this.ba+"() cannot be used with set() unless you pass {merge:true}");return t.jn.push(t.path),null},Vc.prototype.isEqual=function(t){return t instanceof Vc},Vc);function Vc(){return null!==_c&&_c.apply(this,arguments)||this}function xc(t,e,n){return new _l({Sa:3,Na:e.settings.Na,methodName:t.ba,Fa:n},e.t,e.serializer,e.ignoreUndefinedProperties)}var jc,Mc,Fc,qc,Gc=(n(nl,qc=Cc),nl.prototype.Ca=function(t){return new rs(t.path,new Bo)},nl.prototype.isEqual=function(t){return t instanceof nl},nl),Bc=(n(el,Fc=Cc),el.prototype.Ca=function(t){var e=xc(this,t,!0),n=this.xa.map(function(t){return ql(t,e)}),n=new zo(n);return new rs(t.path,n)},el.prototype.isEqual=function(t){return this===t},el),zc=(n(tl,Mc=Cc),tl.prototype.Ca=function(t){var e=xc(this,t,!0),n=this.xa.map(function(t){return ql(t,e)}),n=new Jo(n);return new rs(t.path,n)},tl.prototype.isEqual=function(t){return this===t},tl),Yc=(n(Zc,jc=Cc),Zc.prototype.Ca=function(t){var e=new Zo(t.serializer,Eo(t.serializer,this.Oa));return new rs(t.path,e)},Zc.prototype.isEqual=function(t){return this===t},Zc),Xc=(Object.defineProperty($c.prototype,"latitude",{get:function(){return this.ka},enumerable:!1,configurable:!0}),Object.defineProperty($c.prototype,"longitude",{get:function(){return this.La},enumerable:!1,configurable:!0}),$c.prototype.isEqual=function(t){return this.ka===t.ka&&this.La===t.La},$c.prototype.toJSON=function(){return{latitude:this.ka,longitude:this.La}},$c.prototype.m=function(t){return Rr(this.ka,t.ka)||Rr(this.La,t.La)},$c),Hc=(Kc.fromBase64String=function(t){try{return new Kc(ui.fromBase64String(t))}catch(t){throw new Mr(jr.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},Kc.fromUint8Array=function(t){return new Kc(ui.fromUint8Array(t))},Kc.prototype.toBase64=function(){return this.$a.toBase64()},Kc.prototype.toUint8Array=function(){return this.$a.toUint8Array()},Kc.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Kc.prototype.isEqual=function(t){return this.$a.isEqual(t.$a)},Kc),Wc=new Map,Jc=(Qc.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Qc);function Qc(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Mr(jr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Mr(jr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Rc("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function Kc(t){this.$a=t}function $c(t,e){if(!isFinite(t)||t<-90||90<t)throw new Mr(jr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Mr(jr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.ka=t,this.La=e}function Zc(t,e){var n=this;return(n=jc.call(this,t)||this).Oa=e,n}function tl(t,e){var n=this;return(n=Mc.call(this,t)||this).xa=e,n}function el(t,e){var n=this;return(n=Fc.call(this,t)||this).xa=e,n}function nl(){return null!==qc&&qc.apply(this,arguments)||this}function rl(){if("undefined"==typeof Uint8Array)throw new Mr(jr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function il(){if("undefined"==typeof atob)throw new Mr(jr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var ol,sl,ul,al=(n(yl,ul=Hc),yl.fromBase64String=function(t){il();try{return new yl(ui.fromBase64String(t))}catch(t){throw new Mr(jr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},yl.fromUint8Array=function(t){return rl(),new yl(ui.fromUint8Array(t))},yl.prototype.toBase64=function(){return il(),ul.prototype.toBase64.call(this)},yl.prototype.toUint8Array=function(){return rl(),ul.prototype.toUint8Array.call(this)},yl.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},yl),me=(dl.prototype.Ma=function(t,e){switch(void 0===e&&(e="none"),to(t)){case 0:return null;case 1:return t.booleanValue;case 2:return uo(t.integerValue||t.doubleValue);case 3:return this.Ua(t.timestampValue);case 4:return this.qa(t,e);case 5:return t.stringValue;case 6:return this.Ba(ao(t.bytesValue));case 7:return this.Qa(t.referenceValue);case 8:return this.ja(t.geoPointValue);case 9:return this.Wa(t.arrayValue,e);case 10:return this.Ka(t.mapValue,e);default:throw Nr()}},dl.prototype.Ka=function(t,n){var r=this,i={};return Pr(t.fields||{},function(t,e){i[t]=r.Ma(e,n)}),i},dl.prototype.ja=function(t){return new Xc(uo(t.latitude),uo(t.longitude))},dl.prototype.Wa=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.Ma(t,e)})},dl.prototype.qa=function(t,e){switch(e){case"previous":var n=function t(e){return Ki(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==n?null:this.Ma(n,e);case"estimate":return this.Ua($i(t));default:return null}},dl.prototype.Ua=function(t){return t=so(t),new Fr(t.seconds,t.nanos)},dl.prototype.Ga=function(t,e){var n=Gr.L(t);return Or(Mo(n)),t=new gr(n.get(1),n.get(3)),n=new Yr(n.v(5)),t.isEqual(e)||Tr("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},dl),hl=(n(pl,sl=me),pl.prototype.Ba=function(t){return new al(t)},pl.prototype.Qa=function(t){return t=this.Ga(t,this.firestore.za),Gf.Ha(t,this.firestore,null)},pl),l=(Object.defineProperty(fl.prototype,"id",{get:function(){return this.Xa.path.D()},enumerable:!1,configurable:!0}),Object.defineProperty(fl.prototype,"ref",{get:function(){return new wl(this.Ya,this.th,this.Xa)},enumerable:!1,configurable:!0}),fl.prototype.exists=function(){return null!==this.Za},fl.prototype.data=function(){if(this.Za){if(this.th){var t=new cl(this.Ya,this.Ja,this.Xa,this.Za,null);return this.th.fromFirestore(t)}return this.Ja.Ma(this.Za.ie())}},fl.prototype.get=function(t){if(this.Za&&null!==(t=this.Za.data().field(vl("DocumentSnapshot.get",t))))return this.Ja.Ma(t)},fl),cl=(n(ll,ol=l),ll.prototype.data=function(){return ol.prototype.data.call(this)},ll);function ll(){return null!==ol&&ol.apply(this,arguments)||this}function fl(t,e,n,r,i){this.Ya=t,this.Ja=e,this.Xa=n,this.Za=r,this.th=i}function pl(t){var e=this;return(e=sl.call(this)||this).firestore=t,e}function dl(){}function yl(){return null!==ul&&ul.apply(this,arguments)||this}function vl(t,e){return"string"==typeof e?Hl(t,e):(e instanceof uc?e.va:e).nh}var gl,ml=(Nl.prototype.isEqual=function(t){return this.nh.isEqual(t.nh)},Nl),wl=(Object.defineProperty(Al.prototype,"eh",{get:function(){return this.Xa.path},enumerable:!1,configurable:!0}),Object.defineProperty(Al.prototype,"id",{get:function(){return this.Xa.path.D()},enumerable:!1,configurable:!0}),Object.defineProperty(Al.prototype,"path",{get:function(){return this.Xa.path.k()},enumerable:!1,configurable:!0}),Object.defineProperty(Al.prototype,"parent",{get:function(){return new El(this.firestore,this.th,this.Xa.path.C())},enumerable:!1,configurable:!0}),Al.prototype.withConverter=function(t){return new Al(this.firestore,t,this.Xa)},Al),bl=(Il.prototype.withConverter=function(t){return new Il(this.firestore,t,this.sh)},Il),El=(n(Tl,gl=bl),Object.defineProperty(Tl.prototype,"id",{get:function(){return this.sh.path.D()},enumerable:!1,configurable:!0}),Object.defineProperty(Tl.prototype,"path",{get:function(){return this.sh.path.k()},enumerable:!1,configurable:!0}),Object.defineProperty(Tl.prototype,"parent",{get:function(){var t=this.eh.C();return t.T()?null:new wl(this.firestore,null,new Yr(t))},enumerable:!1,configurable:!0}),Tl.prototype.withConverter=function(t){return new Tl(this.firestore,t,this.eh)},Tl);function Tl(t,e,n){var r=this;return(r=gl.call(this,t,e,zs(n))||this).firestore=t,r.eh=n,r.type="collection",r}function Il(t,e,n){this.th=e,this.sh=n,this.type="query",this.firestore=t}function Al(t,e,n){this.th=e,this.Xa=n,this.type="document",this.firestore=t}function Nl(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Mr(jr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.nh=new zr(t)}function Ol(t){var e=t.ih(),n=va(t.za);return new Cl(t.za,!!e.ignoreUndefinedProperties,n)}var kl=/^__.*__$/,Dl=(Sl.prototype.rh=function(t,e){var n=[];return null!==this.jn?n.push(new vs(t,this.data,this.jn,e)):n.push(new ys(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Es(t,this.fieldTransforms)),n},Sl),Rl=(Ll.prototype.rh=function(t,e){return e=[new vs(t,this.data,this.jn,e)],0<this.fieldTransforms.length&&e.push(new Es(t,this.fieldTransforms)),e},Ll);function Ll(t,e,n){this.data=t,this.jn=e,this.fieldTransforms=n}function Sl(t,e,n){this.data=t,this.jn=e,this.fieldTransforms=n}function Pl(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Nr()}}var _l=(Object.defineProperty(Vl.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Vl.prototype,"Sa",{get:function(){return this.settings.Sa},enumerable:!1,configurable:!0}),Vl.prototype.uh=function(t){return new Vl(Object.assign(Object.assign({},this.settings),t),this.t,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.jn)},Vl.prototype.ah=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.uh({path:e,Fa:!1})).hh(t),e},Vl.prototype.lh=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t);return(t=this.uh({path:t,Fa:!1})).oh(),t},Vl.prototype._h=function(t){return this.uh({path:void 0,Fa:!0})},Vl.prototype.Da=function(t){return Wl(t,this.settings.methodName,this.settings.fh||!1,this.path,this.settings.Na)},Vl.prototype.contains=function(e){return void 0!==this.jn.find(function(t){return e.N(t)})||void 0!==this.fieldTransforms.find(function(t){return e.N(t.field)})},Vl.prototype.oh=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.hh(this.path.get(t))},Vl.prototype.hh=function(t){if(0===t.length)throw this.Da("Document fields must not be empty");if(Pl(this.Sa)&&kl.test(t))throw this.Da('Document fields cannot begin and end with "__"')},Vl),Cl=(Ul.prototype.dh=function(t,e,n,r){return void 0===r&&(r=!1),new _l({Sa:t,methodName:e,Na:n,path:zr.$(),Fa:!1,fh:r},this.t,this.serializer,this.ignoreUndefinedProperties)},Ul);function Ul(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.serializer=n||va(t)}function Vl(t,e,n,r,i,o){this.settings=t,this.t=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.oh(),this.fieldTransforms=i||[],this.jn=o||[]}function xl(t,e,n,r,i,o){void 0===o&&(o={});var s=t.dh(o.merge||o.mergeFields?2:0,e,n,i);zl("Data must be an object, but it was:",s,r);var u,a,r=Gl(r,s);if(o.merge)u=new is(s.jn),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],c=0,l=o.mergeFields;c<l.length;c++){var f=Yl(e,l[c],n);if(!s.contains(f))throw new Mr(jr.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");Jl(h,f)||h.push(f)}u=new is(h),a=s.fieldTransforms.filter(function(t){return u.Hn(t.field)})}else u=null,a=s.fieldTransforms;return new Dl(new Ds(r),u,a)}function jl(t,r,i,e){var o=t.dh(1,r,i);zl("Data must be an object, but it was:",o,e);var s=[],u=new Rs;return Pr(e,function(t,e){var n=Hl(r,t,i);e instanceof uc&&(e=e.va),t=o.lh(n),e instanceof Uc?s.push(n):null!=(t=ql(e,t))&&(s.push(n),u.set(n,t))}),e=new is(s),new Rl(u.Xn(),e,o.fieldTransforms)}function Ml(t,e,n,r,i,o){var s=t.dh(1,e,n),u=[Yl(e,r,n)],a=[i];if(o.length%2!=0)throw new Mr(jr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(Yl(e,o[h])),a.push(o[h+1]);for(var c,l,f,p=[],d=new Rs,y=u.length-1;0<=y;--y)Jl(p,u[y])||(c=u[y],(l=a[y])instanceof uc&&(l=l.va),f=s.lh(c),l instanceof Uc?p.push(c):null!=(f=ql(l,f))&&(p.push(c),d.set(c,f)));return i=new is(p),new Rl(d.Xn(),i,s.fieldTransforms)}function Fl(t,e,n,r){return void 0===r&&(r=!1),ql(n,t.dh(r?4:3,e))}function ql(s,t){if(s instanceof uc&&(s=s.va),Bl(s))return zl("Unsupported field value:",t,s),Gl(s,t);if(s instanceof Cc)return function(t,e){if(!Pl(e.Sa))throw e.Da(t.ba+"() can only be used with update() and set()");if(!e.path)throw e.Da(t.ba+"() is not currently supported inside arrays");(t=t.Ca(e))&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.jn.push(t.path),s instanceof Array){if(t.settings.Fa&&4!==t.Sa)throw t.Da("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=ql(i[r],t._h(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof uc&&(t=t.va),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Eo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Fr.fromDate(t);return{timestampValue:To(e.serializer,n)}}if(t instanceof Fr){var r=new Fr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:To(e.serializer,r)}}if(t instanceof Xc)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Hc)return{bytesValue:Io(e.serializer,t.$a)};if(t instanceof wl){if(n=e.t,!(r=t.firestore.za).isEqual(n))throw e.Da("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:No(t.firestore.za||e.t,t.Xa.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.Da("Unsupported field value: "+Lc(t))}(s,t)}function Gl(t,n){var r={};return _r(t)?n.path&&0<n.path.length&&n.jn.push(n.path):Pr(t,function(t,e){null!=(e=ql(e,n.ah(t)))&&(r[t]=e)}),{mapValue:{fields:r}}}function Bl(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Fr||t instanceof Xc||t instanceof Hc||t instanceof wl||t instanceof Cc)}function zl(t,e,n){if(!Bl(n)||"object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))throw"an object"===(n=Lc(n))?e.Da(t+" a custom object"):e.Da(t+" "+n);var r}function Yl(t,e,n){if(e instanceof uc&&(e=e.va),e instanceof ml)return e.nh;if("string"==typeof e)return Hl(t,e);throw Wl("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Xl=new RegExp("[~\\*/\\[\\]]");function Hl(e,n,r){if(0<=n.search(Xl))throw Wl("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(ml.bind.apply(ml,i([void 0],n.split("."))))).nh}catch(t){throw Wl("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function Wl(t,e,n,r,i){var o=r&&!r.T(),s=void 0!==i,e="Function "+e+"() called with invalid data";return n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Mr(jr.INVALID_ARGUMENT,(e+=". ")+t+n)}function Jl(t,e){return t.some(function(t){return t.isEqual(e)})}var Ql=(ef.prototype.Ih=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.Ah(),0<this.mutations.length)throw new Mr(jr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var r,e,n,i,o;return v(this,function(t){switch(t.label){case 0:return e=Lo((r=s).serializer)+"/documents",n={documents:u.map(function(t){return ko(r.serializer,t)})},[4,r.Gr("BatchGetDocuments",e,n)];case 1:return n=t.sent(),i=new Map,n.forEach(function(t){var e,n,t=(n=r.serializer,"found"in t?function(t,e){Or(!!e.found),e.found.name,e.found.updateTime;var n=Do(t,e.found.name),t=Ao(e.found.updateTime),e=new Ds({mapValue:{fields:e.found.fields}});return new xs(n,t,e,{})}(n,t):"missing"in t?(e=n,Or(!!(n=t).missing),Or(!!n.readTime),e=Do(e,n.missing),n=Ao(n.readTime),new js(e,n)):Nr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){Or(!!(t=i.get(t.toString()))),o.push(t)}),o)]}})})}(this.ro,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof js||t instanceof xs?n.Rh(t):Nr()}),e)]}})})},ef.prototype.set=function(t,e){this.write(e.rh(t,this.Gn(t))),this.mh.add(t.toString())},ef.prototype.update=function(t,e){try{this.write(e.rh(t,this.Ph(t)))}catch(t){this.Th=t}this.mh.add(t.toString())},ef.prototype.delete=function(t){this.write([new Os(t,this.Gn(t))]),this.mh.add(t.toString())},ef.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.Ah(),this.Th)throw this.Th;return e=this.wh,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=Yr.j(e),n.mutations.push(new ks(e,n.Gn(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=Lo((e=i).serializer)+"/documents",r={writes:o.map(function(t){return _o(e.serializer,t)})},[4,e.Kr("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.ro,this.mutations)];case 1:return t.sent(),this.Eh=!0,[2]}})})},ef.prototype.Rh=function(t){var e;if(t instanceof xs)e=t.version;else{if(!(t instanceof js))throw Nr();e=qr.min()}var n=this.wh.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Mr(jr.ABORTED,"Document version changed between two reads.")}else this.wh.set(t.key.toString(),e)},ef.prototype.Gn=function(t){var e=this.wh.get(t.toString());return!this.mh.has(t.toString())&&e?us.updateTime(e):us.Yn()},ef.prototype.Ph=function(t){var e=this.wh.get(t.toString());if(this.mh.has(t.toString())||!e)return us.exists(!0);if(e.isEqual(qr.min()))throw new Mr(jr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return us.updateTime(e)},ef.prototype.write=function(t){this.Ah(),this.mutations=this.mutations.concat(t)},ef.prototype.Ah=function(){},ef),Kl=(tf.prototype.run=function(){this.yh()},tf.prototype.yh=function(){var t=this;this.Ye.Ae(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new Ql(this.ro),(n=this.gh(e))&&n.then(function(t){r.Oe.Be(function(){return e.commit().then(function(){r.$e.resolve(t)}).catch(function(t){r.ph(t)})})}).catch(function(t){r.ph(t)}),[2]})})})},tf.prototype.gh=function(t){try{var e=this.updateFunction(t);return!ti(e)&&e.catch&&e.then?e:(this.$e.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.$e.reject(t),null}},tf.prototype.ph=function(t){var e=this;0<this.Vh&&this.bh(t)?(--this.Vh,this.Oe.Be(function(){return e.yh(),Promise.resolve()})):this.$e.reject(t)},tf.prototype.bh=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!pi(t))},tf),$l=(Zl.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.Ls.promise];case 1:return[2,(t.sent(),{Oe:this.Oe,ta:this.ta,clientId:this.clientId,credentials:this.credentials,ma:this.user,Pu:100})]}})})},Zl.prototype.Sh=function(t){var e=this;this.Ch=t,this.Ls.promise.then(function(){return e.Ch(e.user)})},Zl.prototype.Dh=function(){if(this.Oe.Xe)throw new Mr(jr.FAILED_PRECONDITION,"The client has already been terminated.")},Zl.prototype.terminate=function(){var t=this;this.Oe.es();var n=new Vu;return this.Oe.Ze(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.Nh?[4,this.Nh.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.Fh?[4,this.Fh.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.Os(),n.resolve(),[3,6];case 5:return e=Hu(t.sent(),"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},Zl);function Zl(t,e,n){var r=this;this.credentials=t,this.Oe=e,this.ta=n,this.user=ta.UNAUTHENTICATED,this.clientId=kr.u(),this.Ch=function(){},this.Ls=new Vu,this.credentials.xs(function(t){Er("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.Ch(t)),r.Ls.resolve()})}function tf(t,e,n,r){this.Oe=t,this.ro=e,this.updateFunction=n,this.$e=r,this.Vh=5,this.Ye=new xu(this.Oe,"transaction_retry")}function ef(t){this.ro=t,this.wh=new Map,this.mutations=[],this.Eh=!1,this.Th=null,this.mh=new Set}function nf(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.Fh?[3,2]:(Er("FirestoreClient","Using default OfflineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return r.Oe.us(),Er("FirestoreClient","Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return e=t.sent(),[4,i.initialize(e)];case 2:return t.sent(),r.Sh(function(e){return r.Oe.ss(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,_a(i.io,e)];case 1:return t.sent(),[2]}})})})}),i.persistence.Fc(function(){return r.terminate()}),r.Fh=i,[2]}})})}(e,new ic)]);case 1:t.sent(),t.label=2;case 2:return[2,e.Fh]}})})}function rf(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.Nh?[3,2]:(Er("FirestoreClient","Using default OnlineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.Oe.us(),[4,nf(r)];case 1:return e=t.sent(),Er("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.Sh(function(t){return r.Oe.ss(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).Oe.us(),Er("RemoteStore","RemoteStore received new credentials"),n=oh(e),e.ao.add(3),[4,$a(e)];case 1:return t.sent(),n&&e.fo.set("Unknown"),[4,e.oo.ya(i)];case 2:return t.sent(),e.ao.delete(3),[4,Ka(e)];case 3:return t.sent(),[2]}})})}(i.Iu,t)})}),r.Nh=i,[2]}})})}(e,new oc)]);case 1:t.sent(),t.label=2;case 2:return[2,e.Nh]}})})}function of(t){return nf(t).then(function(t){return t.persistence})}function sf(t){return nf(t).then(function(t){return t.io})}function uf(t){return rf(t).then(function(t){return t.Iu})}function af(t){return rf(t).then(function(t){return t.Pa})}function hf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,rf(r)];case 1:return e=t.sent(),[2,((n=e.Au).ws=function(h,c){return y(this,void 0,void 0,function(){var n,o,s,u,a;return v(this,function(t){switch(t.label){case 0:return(e=h).Iu.oo.To=Sh.bind(null,e),e.Iu.oo.qn=function(t,e){var n=t;if((t=n.bu.get(e))&&t.mu)return Li().add(t.key);var r=Li();if(!(e=n.gu.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.yu.get(s),r=r.Ot(s.view.ou);return r}.bind(null,e),e.Iu.oo.Eo=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Ru.Wo(s,"rejected",u),i=e.bu.get(s),(n=i&&i.key)?(r=(r=new yi(Yr.g)).rt(n,new js(n,qr.min())),i=Li().add(n),i=new Ui(qr.min(),new Map,new Ti(Rr),r,i),[4,Sh(e,i)]):[3,2];case 1:return t.sent(),e.vu=e.vu.remove(n),e.bu.delete(s),Mh(e),[3,4];case 2:return[4,Ua(e.io,s,!1).then(function(){return Vh(e,s,u)}).catch(xa)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.Vu.Or=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query;if(u=n.queries.get(u)){for(var a=0,h=u.listeners;a<h.length;a++)h[a].Ts(s)&&(r=!0);u.fs=s}}r&&$u(n)}.bind(null,e.Au),e.Vu.Ou=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,e.Au),(a=(n=e).yu.get(c))?(o=a.targetId,n.Ru.jo(o),s=a.view.Tu(),[3,4]):[3,1];case 1:return[4,(e=n.io,r=Ks(c),(i=e).persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.xi.ar(e,r).next(function(t){return t?(n=t,ju.resolve(n)):i.xi.ku(e).next(function(t){return n=new li(r,t,0,e.nr),i.xi.Lu(e,n).next(function(){return n})})})}).then(function(t){var e=i.bi.get(t.targetId);return(null===e||0<t.nt.A(e.nt))&&(i.bi=i.bi.rt(t.targetId,t),i.Ci.set(r,t.targetId)),t}))];case 2:return u=t.sent(),a=n.Ru.jo(u.targetId),o=u.targetId,[4,function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.$u=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.uu(o)).hu?[4,Va(r.io,i.query,!1).then(function(t){return t=t.documents,i.view.uu(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.Gt.get(i.targetId),n=i.view.lu(e,r.xu,n),[2,(jh(r,i.targetId,n.du),n.snapshot)]}})})}(i,t,e,n)},[4,Va(i.io,o,!0)];case 1:return n=t.sent(),r=new bh(o,n.lr),e=r.uu(n.documents),n=Vi.Xt(s,u&&"Offline"!==i.onlineState),n=r.lu(e,i.xu,n),jh(i,s,n.du),r=new Eh(o,s,r),i.yu.set(o,r),i.gu.has(s)?i.gu.get(s).push(o):i.gu.set(s,[o]),[2,n.snapshot]}})})}(n,c,o,"current"===a)];case 3:s=t.sent(),n.xu&&Za(n.Iu,u),t.label=4;case 4:return[2,s]}var r,i,e})})}.bind(null,e.Pa),n.Is=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).yu.get(o),1<(r=e.gu.get(n.targetId)).length?[2,(e.gu.set(n.targetId,r.filter(function(t){return!eu(t,o)})),void e.yu.delete(o))]:e.xu?(e.Ru.Ko(n.targetId),e.Ru.Yo(n.targetId)?[3,2]:[4,Ua(e.io,n.targetId,!1).then(function(){e.Ru.zo(n.targetId),th(e.Iu,n.targetId),Vh(e,n.targetId)}).catch(xa)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Vh(e,n.targetId),[4,Ua(e.io,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.Pa),n)]}})})}function cf(n,r){var t=this,i=new Vu;return n.Oe.Be(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Lh,[4,af(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}function lf(n,r,i,o,s){var t=new sc({next:function(t){r.Be(function(){return Ku(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Mr(jr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Mr(jr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Zu(zs(i.path),t,{includeMetadataChanges:!0,ps:!0});return Qu(n,u)}var ff,pf=(Object.defineProperty(yf.prototype,"app",{get:function(){if(!this.$h)throw new Mr(jr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.$h},enumerable:!1,configurable:!0}),Object.defineProperty(yf.prototype,"Mh",{get:function(){return this.kh},enumerable:!1,configurable:!0}),Object.defineProperty(yf.prototype,"Uh",{get:function(){return void 0!==this.qh},enumerable:!1,configurable:!0}),yf.prototype.Bh=function(t){if(this.kh)throw new Mr(jr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.Oh=new Jc(t),void 0!==t.credentials&&(this.Lh=function(t){if(!t)return new ia;switch(t.type){case"gapi":var e=t.client;return Or(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new ua(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Mr(jr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},yf.prototype.Qh=function(){return this.Oh},yf.prototype.ih=function(){return this.kh=!0,this.Oh},yf.prototype._delete=function(){return this.qh||(this.qh=this.jh()),this.qh},yf.prototype.jh=function(){return(t=Wc.get(this))&&(Er("ComponentProvider","Removing Datastore"),Wc.delete(this),t.terminate()),Promise.resolve();var t},n(df,ff=yf),df.prototype.jh=function(){return this.Kh||jf(this),this.Kh.terminate()},df);function df(t,e){var n=this;return(n=ff.call(this,t,e)||this).Wh=new zu,n.xh="name"in t?t.name:"[DEFAULT]",n}function yf(t,e){this.xh="(lite)",this.Oh=new Jc({}),this.kh=!1,t instanceof gr?(this.za=t,this.Lh=new ia):(this.$h=t,this.za=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Mr(jr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new gr(t.options.projectId)}(t),this.Lh=new oa(e))}var vf,gf,mf=(n(If,gf=l),If.prototype.exists=function(){return gf.prototype.exists.call(this)},If.prototype.data=function(t){if(void 0===t&&(t={}),this.Za){if(this.th){var e=new wf(this.Ya,this.Ja,this.Xa,this.Za,this.metadata,null);return this.th.fromFirestore(e,t)}return this.Ja.Ma(this.Za.ie(),t.serverTimestamps)}},If.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Za&&null!==(t=this.Za.data().field(vl("DocumentSnapshot.get",t))))return this.Ja.Ma(t,e.serverTimestamps)},If),wf=(n(Tf,vf=mf),Tf.prototype.data=function(t){return void 0===t&&(t={}),vf.prototype.data.call(this,t)},Tf),bf=(Object.defineProperty(Ef.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Ef.prototype,"size",{get:function(){return this.zh.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(Ef.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),Ef.prototype.forEach=function(e,n){var r=this;this.zh.docs.forEach(function(t){e.call(n,new wf(r.Ya,r.Ja,t.key,t,new Jf(r.zh.Qt.has(t.key),r.zh.fromCache),r.query.th))})},Ef.prototype.docChanges=function(t){if(void 0===t&&(t={}),(t=!!t.includeMetadataChanges)&&this.zh.Wt)throw new Mr(jr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Hh&&this.Yh===t||(this.Hh=function(i,e){if(i.zh.Bt.T()){var n=0;return i.zh.docChanges.map(function(t){var e=new wf(i.Ya,i.Ja,t.doc.key,t.doc,new Jf(i.zh.Qt.has(t.doc.key),i.zh.fromCache),i.query.th);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.zh.Bt;return i.zh.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new wf(i.Ya,i.Ja,t.doc.key,t.doc,new Jf(i.zh.Qt.has(t.doc.key),i.zh.fromCache),i.query.th),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Nr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.Yh=t),this.Hh},Ef);function Ef(t,e,n,r){this.Ya=t,this.Ja=e,this.zh=r,this.metadata=new Jf(r.hasPendingWrites,r.fromCache),this.query=n}function Tf(){return null!==vf&&vf.apply(this,arguments)||this}function If(t,e,n,r,i,o){var s=this;return(s=gf.call(this,t,e,n,r,o)||this).Ya=t,s.Gh=t,s.metadata=i,s}function Af(t,e){return t instanceof mf&&e instanceof mf?t.Ya===e.Ya&&t.Xa.isEqual(e.Xa)&&(null===t.Za?null===e.Za:t.Za.isEqual(e.Za))&&t.th===e.th:t instanceof bf&&e instanceof bf&&t.Ya===e.Ya&&(n=t.query,r=e.query,n instanceof bl&&r instanceof bl&&n.firestore===r.firestore&&eu(n.sh,r.sh)&&n.th===r.th)&&t.metadata.isEqual(e.metadata)&&t.zh.isEqual(e.zh);var n,r}var Nf,Of=(n(kf,Nf=me),kf.prototype.Ba=function(t){return new Hc(t)},kf.prototype.Qa=function(t){return t=this.Ga(t,this.firestore.za),new wl(this.firestore,null,t)},kf);function kf(t){var e=this;return(e=Nf.call(this)||this).firestore=t,e}function Df(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Sc(t.firestore,pf),s=Ol(o);return e instanceof uc&&(e=e.va),Rf(o,("string"==typeof e||e instanceof ml?Ml(s,"updateDoc",t.Xa,e,n,r):jl(s,"updateDoc",t.Xa,e)).rh(t.Xa,us.exists(!0)))}function Rf(t,e){return cf(xf(t),e)}function Lf(t,e,n){var r=n.docs.get(e.Xa),i=new Of(t);return new mf(t,i,e.Xa,r,new Jf(n.hasPendingWrites,n.fromCache),e.th)}var Sf,Pf="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",_f=(Vf.prototype.enableIndexedDbPersistence=function(t,e){throw new Mr(jr.FAILED_PRECONDITION,Pf)},Vf.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new Mr(jr.FAILED_PRECONDITION,Pf)},Vf.prototype.clearIndexedDbPersistence=function(t){throw new Mr(jr.FAILED_PRECONDITION,Pf)},Vf),Cf=(n(Uf,Sf=uc),Object.defineProperty(Uf.prototype,"za",{get:function(){return this.va.za},enumerable:!1,configurable:!0}),Uf.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.va.Qh()),t)).merge,this.va.Bh(t)},Uf.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.va.Qh().host&&Ir("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},Uf.prototype.enableNetwork=function(){return function(r){var t=this;return r.Oe.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,of(r)];case 1:return e=t.sent(),[4,uf(r)];case 2:return n=t.sent(),[2,(e.xc(!0),(t=n).ao.delete(0),Ka(t))]}})})})}(xf(this.va))},Uf.prototype.disableNetwork=function(){return function(r){var t=this;return r.Oe.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,of(r)];case 1:return e=t.sent(),[4,uf(r)];case 2:return n=t.sent(),[2,(e.xc(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).ao.add(0),[4,$a(e)];case 1:return t.sent(),e.fo.set("Offline"),[2]}})})}(n))]}})})})}(xf(this.va))},Uf.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Rc("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Jh.enableMultiTabIndexedDbPersistence(this):this.Jh.enableIndexedDbPersistence(this,n)},Uf.prototype.clearPersistence=function(){return this.Jh.clearIndexedDbPersistence(this)},Uf.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this.va._delete()},Uf.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new Vu;return n.Oe.Be(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=_h,[4,af(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(xf(this.va))},Uf.prototype.onSnapshotsInSync=function(t){return function(t,e){var n=this,r=xf(t),e=ga(e)?e:{next:e},i=new sc(e);return t.Wh.Be(function(){return y(n,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.ds.add(e),e.next()},[4,hf(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})}),function(){i.pa(),t.Wh.Be(function(){return y(n,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.ds.delete(e)},[4,hf(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})})}}(this.va,t)},Object.defineProperty(Uf.prototype,"app",{get:function(){if(!this.Xh)throw new Mr(jr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Xh},enumerable:!1,configurable:!0}),Uf.prototype.collection=function(t){return kc("Firestore.collection","path",t),xf(this.va),new lp(Gr.L(t),this,null)},Uf.prototype.doc=function(t){return kc("Firestore.doc","path",t),xf(this.va),Gf.Zh(Gr.L(t),this,null)},Uf.prototype.collectionGroup=function(t){if(kc("Firestore.collectionGroup","collectionId",t),0<=t.indexOf("/"))throw new Mr(jr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return xf(this.va),new ap(new Fs(Gr.$(),t),this,null)},Uf.prototype.runTransaction=function(e){var n=this;return function(n,r){var t=this,i=new Vu;return n.Oe.Be(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,rf(n).then(function(t){return t.ro})];case 1:return e=t.sent(),new Kl(n.Oe,e,r,i).run(),[2]}})})}),i.promise}(xf(this.va),function(t){return e(new Ff(n,t))})},Uf.prototype.batch=function(){return xf(this.va),new qf(this)},Uf);function Uf(t,e,n){var r=this;return(r=Sf.call(this,e)||this).Jh=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof gr||(r.Xh=t),r}function Vf(){}function xf(t){return t.Kh||jf(t),t.Kh.Dh(),t.Kh}function jf(t){var e,n,r=t.ih(),r=(e=t.za,n=t.xh,new vr(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.Kh=new $l(t.Lh,t.Wh,r)}var Mf,Ff=(Yf.prototype.get=function(t){var e=this,n=vp(0,t,this.Ya),r=new hl(this.Ya);return this.tl.Ih([n.Xa]).then(function(t){if(!t||1!==t.length)return Nr();if((t=t[0])instanceof js)return new Qf(e.Ya,new mf(e.Ya.va,r,n.Xa,null,new Jf(!1,!1),n.th));if(t instanceof xs)return new Qf(e.Ya,new mf(e.Ya.va,r,n.Xa,t,new Jf(!1,!1),n.th));throw Nr()})},Yf.prototype.set=function(t,e,n){return t=vp(0,t,this.Ya),n=Dc("Transaction.set",n),e=gp(t.th,e,n),n=xl(this.nl,"Transaction.set",t.Xa,e,null!==t.th,n),this.tl.set(t.Xa,n),this},Yf.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return t=vp(0,t,this.Ya),e instanceof uc&&(e=e.va),e="string"==typeof e||e instanceof ml?Ml(this.nl,"Transaction.update",t.Xa,e,n,r):jl(this.nl,"Transaction.update",t.Xa,e),this.tl.update(t.Xa,e),this},Yf.prototype.delete=function(t){return t=vp(0,t,this.Ya),this.tl.delete(t.Xa),this},Yf),qf=(zf.prototype.set=function(t,e,n){return this.il(),t=vp(0,t,this.Ya),n=Dc("WriteBatch.set",n),e=gp(t.th,e,n),n=xl(this.nl,"WriteBatch.set",t.Xa,e,null!==t.th,n),this.el=this.el.concat(n.rh(t.Xa,us.Yn())),this},zf.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return this.il(),t=vp(0,t,this.Ya),e instanceof uc&&(e=e.va),e="string"==typeof e||e instanceof ml?Ml(this.nl,"WriteBatch.update",t.Xa,e,n,r):jl(this.nl,"WriteBatch.update",t.Xa,e),this.el=this.el.concat(e.rh(t.Xa,us.exists(!0))),this},zf.prototype.delete=function(t){return this.il(),t=vp(0,t,this.Ya),this.el=this.el.concat(new Os(t.Xa,us.Yn())),this},zf.prototype.commit=function(){return this.il(),this.sl=!0,0<this.el.length?cf(xf(this.Ya.va),this.el):Promise.resolve()},zf.prototype.il=function(){if(this.sl)throw new Mr(jr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},zf),Gf=(n(Bf,Mf=uc),Bf.Zh=function(t,e,n){if(t.length%2!=0)throw new Mr(jr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.k()+" has "+t.length);return new Bf(e,new wl(e.va,n,new Yr(t)))},Bf.Ha=function(t,e,n){return new Bf(e,new wl(e.va,n,t))},Object.defineProperty(Bf.prototype,"id",{get:function(){return this.va.id},enumerable:!1,configurable:!0}),Object.defineProperty(Bf.prototype,"parent",{get:function(){return new lp(this.va.eh.C(),this.firestore,this.va.th)},enumerable:!1,configurable:!0}),Object.defineProperty(Bf.prototype,"path",{get:function(){return this.va.path},enumerable:!1,configurable:!0}),Bf.prototype.collection=function(t){if(kc("DocumentReference.collection","path",t),!t)throw new Mr(jr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");return t=Gr.L(t),new lp(this.va.eh.child(t),this.firestore,null)},Bf.prototype.isEqual=function(t){return t instanceof uc&&(t=t.va),t instanceof wl&&((e=this.va)instanceof wl||e instanceof El)&&(t instanceof wl||t instanceof El)&&e.firestore===t.firestore&&e.path===t.path&&e.th===t.th;var e},Bf.prototype.set=function(t,e){e=Dc("DocumentReference.set",e);try{return n=this.va,r=t,i=e,o=Sc(n.firestore,pf),r=gp(n.th,r,i),Rf(o,xl(Ol(o),"setDoc",n.Xa,r,null!==n.th,i).rh(n.Xa,us.Yn()))}catch(t){throw Xf(t,"setDoc","DocumentReference.set")}var n,r,i,o},Bf.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Df(this.va,t):Df.apply(void 0,i([this.va,t,e],n))}catch(t){throw Xf(t,"updateDoc","DocumentReference.update")}},Bf.prototype.delete=function(){return Rf(Sc((t=this.va).firestore,pf),[new Os(t.Xa,us.Yn())]);var t},Bf.prototype.onSnapshot=function(){for(var e=this,r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var n,i=function(){for(var t=0,e=r;t<e.length;t++){var n=e[t];if("object"==typeof n&&!ga(n))return n}return{}}(),o={next:function(t){n.next&&n.next(new Qf(e.firestore,new mf(e.firestore.va,e.Ja,t.Xa,t.Za,t.metadata,e.va.th)))},error:null===(o=(n=ga((o=r)[0])?o[0]:ga(o[1])?o[1]:"function"==typeof o[0]?{next:o[0],error:o[1],complete:o[2]}:{next:o[1],error:o[2],complete:o[3]}).error)||void 0===o?void 0:o.bind(n),complete:null===(o=n.complete)||void 0===o?void 0:o.bind(n)};return function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i={includeMetadataChanges:!1},o=0;"object"!=typeof n[o]||ga(n[o])||(i=n[o],o++);var s,u,a,h,c,l={includeMetadataChanges:i.includeMetadataChanges};ga(n[o])&&(a=n[o],n[o]=null===(i=a.next)||void 0===i?void 0:i.bind(a),n[o+1]=null===(i=a.error)||void 0===i?void 0:i.bind(a),n[o+2]=null===(i=a.complete)||void 0===i?void 0:i.bind(a)),e instanceof wl?(s=Sc(e.firestore,pf),u=zs(e.Xa.path),c={next:function(t){n[o]&&n[o](Lf(s,e,t))},error:n[o+1],complete:n[o+2]}):(s=Sc(e.firestore,pf),u=e.sh,h=new Of(s),c={next:function(t){n[o]&&n[o](new bf(s,h,e,t))},error:n[o+1],complete:n[o+2]},ip(e.sh));var f=xf(s),p=new sc(c),d=new Zu(u,p,l);return s.Wh.Be(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Qu,[4,hf(f)];case 1:return[2,e.apply(void 0,[t.sent(),d])]}})})}),function(){p.pa(),s.Wh.Be(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Ku,[4,hf(f)];case 1:return[2,e.apply(void 0,[t.sent(),d])]}})})})}}(this.va,i,o)},Bf.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){var t=this,n=Sc(e.firestore,pf),r=xf(n),i=new Of(n),o=new Vu;return n.Wh.Be(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,sf(r)];case 1:return[4,function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.ki.Xs(t,e)}))];case 1:return(r=t.sent())instanceof xs?s.resolve(r):r instanceof js?s.resolve(null):s.reject(new Mr(jr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=Hu(r=t.sent(),"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(t.sent(),e.Xa,o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new mf(n,i,e.Xa,t,new Jf(t instanceof xs&&t.Jn,!0),e.th)})}:"server"===(null==t?void 0:t.source)?function(e){var t=this,n=Sc(e.firestore,pf),r=xf(n),i=new Vu;return n.Wh.Be(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,hf(r)];case 1:return[4,lf(t.sent(),n.Wh,e.Xa,{source:"server"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return Lf(n,e,t)})}:function(e){var t=this,n=Sc(e.firestore,pf),r=xf(n),i=new Vu;return n.Wh.Be(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,hf(r)];case 1:return[4,lf(t.sent(),n.Wh,e.Xa,{source:"default"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return Lf(n,e,t)})})(this.va).then(function(t){return new Qf(e.firestore,new mf(e.firestore.va,e.Ja,t.Xa,t.Za,t.metadata,e.va.th))})},Bf.prototype.withConverter=function(t){return new Bf(this.firestore,this.va.withConverter(t))},Bf);function Bf(t,e){var n=this;return(n=Mf.call(this,e)||this).firestore=t,n.Ja=new hl(t),n}function zf(t){this.Ya=t,this.el=[],this.sl=!1,this.nl=Ol(this.Ya.va)}function Yf(t,e){this.Ya=t,this.tl=e,this.nl=Ol(this.Ya.va)}function Xf(t,e,n){return t.message=t.message.replace(e+"()",n+"()"),t}var Hf,Wf,Jf=(tp.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},tp),Qf=(n(Zf,Wf=uc),Object.defineProperty(Zf.prototype,"ref",{get:function(){return new Gf(this.Ya,this.va.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(Zf.prototype,"id",{get:function(){return this.va.id},enumerable:!1,configurable:!0}),Object.defineProperty(Zf.prototype,"metadata",{get:function(){return this.va.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Zf.prototype,"exists",{get:function(){return this.va.exists()},enumerable:!1,configurable:!0}),Zf.prototype.data=function(t){return this.va.data(t)},Zf.prototype.get=function(t,e){return this.va.get(t,e)},Zf.prototype.isEqual=function(t){return Af(this.va,t.va)},Zf),Kf=(n($f,Hf=Qf),$f.prototype.data=function(t){return this.va.data(t)},$f);function $f(){return null!==Hf&&Hf.apply(this,arguments)||this}function Zf(t,e){var n=this;return(n=Wf.call(this,e)||this).Ya=t,n}function tp(t,e){this.hasPendingWrites=t,this.fromCache=e}function ep(t,e,n){if(n instanceof uc&&(n=n.va),"string"==typeof n){if(""===n)throw new Mr(jr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Js(e)&&-1!==n.indexOf("/"))throw new Mr(jr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child(Gr.L(n)),!Yr.G(e))throw new Mr(jr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return ho(t,new Yr(e))}if(n instanceof wl)return ho(t,n.Xa);throw new Mr(jr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Lc(n)+".")}function np(t,e){if(!Array.isArray(t)||0===t.length)throw new Mr(jr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Mr(jr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function rp(t,e,n){if(!n.isEqual(e))throw new Mr(jr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function ip(t){if(Xs(t)&&0===t.re.length)throw new Mr(jr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var op,sp,up,ap=(yp.prototype.where=function(t,e,n){return t=Yl("Query.where",t),e=function(t,e,n,r,i,o){if(r.U()){if("array-contains"===i||"array-contains-any"===i)throw new Mr(jr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){np(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var h=a[u];s.push(ep(n,t,h))}c={arrayValue:{values:s}}}else c=ep(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||np(o,i),c=Fl(e,"Query.where",o,"in"===i||"not-in"===i);var c=uu.create(r,i,c);return function(t,e){if(e.ce()){var n=Ws(t);if(null!==n&&!n.isEqual(e.field))throw new Mr(jr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=Hs(t))&&rp(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new Mr(jr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Mr(jr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,c),c}(this.sh,this.rl,this.firestore.za,t,e,n),new yp((e=(n=this.sh).filters.concat([e]),new Fs(n.path,n.collectionGroup,n.re.slice(),e,n.limit,n.limitType,n.startAt,n.endAt)),this.firestore,this.th)},yp.prototype.orderBy=function(t,e){if(void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Mr(jr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var n,t=Yl("Query.orderBy",t),t=function(t,e,n){if(null!==t.startAt)throw new Mr(jr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Mr(jr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return n=e=new Uu(e,n),null!==Hs(t)||null!==(t=Ws(t))&&rp(0,t,n.field),e}(this.sh,t,n);return new yp((t=(n=this.sh).re.concat([t]),new Fs(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)),this.firestore,this.th)},yp.prototype.limit=function(t){return Pc("Query.limit",t),new yp($s(this.sh,t,"F"),this.firestore,this.th)},yp.prototype.limitToLast=function(t){return Pc("Query.limitToLast",t),new yp($s(this.sh,t,"L"),this.firestore,this.th)},yp.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t=this.ol("Query.startAt",t,e,!0),new yp(Zs(this.sh,t),this.firestore,this.th)},yp.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t=this.ol("Query.startAfter",t,e,!1),new yp(Zs(this.sh,t),this.firestore,this.th)},yp.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t=this.ol("Query.endBefore",t,e,!0),new yp(tu(this.sh,t),this.firestore,this.th)},yp.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t=this.ol("Query.endAt",t,e,!1),new yp(tu(this.sh,t),this.firestore,this.th)},yp.prototype.isEqual=function(t){return t instanceof yp&&this.firestore===t.firestore&&eu(this.sh,t.sh)&&this.th===t.th},yp.prototype.withConverter=function(t){return new yp(this.sh,this.firestore,t)},yp.prototype.ol=function(h,t,e,n){return t instanceof Qf?function(t,e,n,r){if(!n)throw new Mr(jr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+h+"().");for(var i=[],o=0,s=Qs(t);o<s.length;o++){var u=s[o];if(u.field.U())i.push(ho(e,n.key));else{var a=n.field(u.field);if(Ki(a))throw new Mr(jr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a)throw u=u.field.k(),new Mr(jr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.");i.push(a)}}return new ku(i,r)}(this.sh,this.firestore.za,t.va.Za,n):(e=[t].concat(e),function(t,e,n,r,i,o){var s=t.re;if(i.length>s.length)throw new Mr(jr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var h=i[a];if(s[a].field.U()){if("string"!=typeof h)throw new Mr(jr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!Js(t)&&-1!==h.indexOf("/"))throw new Mr(jr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(Gr.L(h));if(!Yr.G(c))throw new Mr(jr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");c=new Yr(c),u.push(ho(e,c))}else h=Fl(n,r,h),u.push(h)}return new ku(u,o)}(this.sh,this.firestore.za,this.rl,h,e,n))},yp.prototype.onSnapshot=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i,o={},s=0;"object"!=typeof n[s]||ga(n[s])||(o=n[s],s++),ga(n[s])&&(i=n[s],n[s]=null===(t=i.next)||void 0===t?void 0:t.bind(i),n[s+1]=null===(t=i.error)||void 0===t?void 0:t.bind(i),n[s+2]=null===(t=i.complete)||void 0===t?void 0:t.bind(i));var u={next:function(t){n[s]&&n[s](new cp(e.firestore,new bf(e.firestore.va,e.Ja,new bl(e.firestore.va,e.th,e.sh),t)))},error:n[s+1],complete:n[s+2]};return ip(this.sh),function(n,t,e){var r=this,i=new sc(u),o=new Zu(t,i,e);return n.Oe.Be(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Qu,[4,hf(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})}),function(){i.pa(),n.Oe.Be(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Ku,[4,hf(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})})}}(xf(this.firestore.va),this.sh,o)},yp.prototype.get=function(t){var e=this;ip(this.sh);var n=xf(this.firestore.va);return(t&&"cache"===t.source?function(n,r){var t=this,i=new Vu;return n.Oe.Be(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Va(r,i,!0)];case 1:return n=t.sent(),e=new bh(i,n.lr),n=e.uu(n.documents),n=e.lu(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=Hu(n=t.sent(),"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})},[4,sf(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(n,this.sh):function(n,r,i){var t=this;void 0===i&&(i={});var o=new Vu;return n.Oe.Be(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new sc({next:function(t){n.Be(function(){return Ku(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Mr(jr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Zu(t,o,{includeMetadataChanges:!0,ps:!0});return Qu(e,s)},[4,hf(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.Oe,r,i,o])]}})})}),o.promise}(n,this.sh,t)).then(function(t){return new cp(e.firestore,new bf(e.firestore.va,e.Ja,new bl(e.firestore.va,e.th,e.sh),t))})},yp),hp=(n(dp,up=uc),Object.defineProperty(dp.prototype,"type",{get:function(){return this.va.type},enumerable:!1,configurable:!0}),Object.defineProperty(dp.prototype,"doc",{get:function(){return new Kf(this.Ya,this.va.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(dp.prototype,"oldIndex",{get:function(){return this.va.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(dp.prototype,"newIndex",{get:function(){return this.va.oldIndex},enumerable:!1,configurable:!0}),dp),cp=(n(pp,sp=uc),Object.defineProperty(pp.prototype,"query",{get:function(){return new ap(this.va.query.sh,this.Ya,this.va.query.th)},enumerable:!1,configurable:!0}),Object.defineProperty(pp.prototype,"metadata",{get:function(){return this.va.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(pp.prototype,"size",{get:function(){return this.va.size},enumerable:!1,configurable:!0}),Object.defineProperty(pp.prototype,"empty",{get:function(){return this.va.empty},enumerable:!1,configurable:!0}),Object.defineProperty(pp.prototype,"docs",{get:function(){var e=this;return this.va.docs.map(function(t){return new Kf(e.Ya,t)})},enumerable:!1,configurable:!0}),pp.prototype.docChanges=function(t){var e=this;return this.va.docChanges(t).map(function(t){return new hp(e.Ya,t)})},pp.prototype.forEach=function(e,n){var r=this;this.va.forEach(function(t){e.call(n,new Kf(r.Ya,t))})},pp.prototype.isEqual=function(t){return Af(this.va,t.va)},pp),lp=(n(fp,op=ap),Object.defineProperty(fp.prototype,"id",{get:function(){return this.sh.path.D()},enumerable:!1,configurable:!0}),Object.defineProperty(fp.prototype,"parent",{get:function(){var t=this.sh.path.C();return t.T()?null:Gf.Zh(t,this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(fp.prototype,"path",{get:function(){return this.sh.path.k()},enumerable:!1,configurable:!0}),fp.prototype.doc=function(t){return 0===arguments.length&&(t=kr.u()),kc("CollectionReference.doc","path",t),t=Gr.L(t),Gf.Zh(this.sh.path.child(t),this.firestore,this.th)},fp.prototype.add=function(t){var t=this.th?this.th.toFirestore(t):t,e=this.doc();return Gf.Ha(e.va.Xa,this.firestore,null).set(t).then(function(){return e})},fp.prototype.withConverter=function(t){return new fp(this.eh,this.firestore,t)},fp);function fp(t,e,n){var r=this;if(((r=op.call(this,zs(t),e,n)||this).eh=t).length%2!=1)throw new Mr(jr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.k()+" has "+t.length);return r}function pp(t,e){var n=this;return(n=sp.call(this,e)||this).Ya=t,n}function dp(t,e){var n=this;return(n=up.call(this,e)||this).Ya=t,n}function yp(t,e,n){this.sh=t,this.firestore=e,this.th=n,this.rl=Ol(e.va),this.Ja=new hl(e)}function vp(t,e,n){if((e=Sc(e,wl)).firestore!==n.va)throw new Mr(jr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function gp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var mp,wp,l=(n(Ep,wp=uc),Ep.documentId=function(){return new Ep(zr.q().k())},Ep.prototype.isEqual=function(t){return t instanceof uc&&(t=t.va),t instanceof ml&&this.va.nh.isEqual(t.nh)},Ep),me=(n(bp,mp=uc),bp.serverTimestamp=function(){var t=new Gc("serverTimestamp");return t.ba="FieldValue.serverTimestamp",new bp(t)},bp.delete=function(){var t=new Uc("deleteField");return t.ba="FieldValue.delete",new bp(t)},bp.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Bc("arrayUnion",t)}.apply(void 0,t);return n.ba="FieldValue.arrayUnion",new bp(n)},bp.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new zc("arrayRemove",t)}.apply(void 0,t);return n.ba="FieldValue.arrayRemove",new bp(n)},bp.increment=function(t){return(t=new Yc("increment",t)).ba="FieldValue.increment",new bp(t)},bp.prototype.isEqual=function(t){return this.va.isEqual(t.va)},bp),me={Firestore:Cf,GeoPoint:Xc,Timestamp:Fr,Blob:al,Transaction:Ff,WriteBatch:qf,DocumentReference:Gf,DocumentSnapshot:Qf,Query:ap,QueryDocumentSnapshot:Kf,QuerySnapshot:cp,CollectionReference:lp,FieldPath:l,FieldValue:me,setLogLevel:function(t){mr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};function bp(){return null!==mp&&mp.apply(this,arguments)||this}function Ep(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return wp.call(this,new(ml.bind.apply(ml,i([void 0],t))))||this}(e=e.default).INTERNAL.registerComponent(new ge("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new Cf(e,new pf(e,t),new _f);var e},"PUBLIC").setServiceProps(Object.assign({},me))),e.registerVersion("@firebase/firestore","2.0.2")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});