!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(zy){"use strict";try{(function(){var t,e=(t=zy)&&"object"==typeof t&&"default"in t?t:{default:t},r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var f,i=function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function o(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function u(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=h[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(me=f=f||{})[me.DEBUG=0]="DEBUG",me[me.VERBOSE=1]="VERBOSE",me[me.INFO=2]="INFO",me[me.WARN=3]="WARN",me[me.ERROR=4]="ERROR",me[me.SILENT=5]="SILENT";var a={debug:f.DEBUG,verbose:f.VERBOSE,info:f.INFO,warn:f.WARN,error:f.ERROR,silent:f.SILENT},c=f.INFO,h=((we={})[f.DEBUG]="log",we[f.VERBOSE]="log",we[f.INFO]="info",we[f.WARN]="warn",we[f.ERROR]="error",we),l=(Object.defineProperty(p.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in f))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),p.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?a[t]:t},Object.defineProperty(p.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),p.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.DEBUG],t)),this._logHandler.apply(this,s([this,f.DEBUG],t))},p.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.VERBOSE],t)),this._logHandler.apply(this,s([this,f.VERBOSE],t))},p.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.INFO],t)),this._logHandler.apply(this,s([this,f.INFO],t))},p.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.WARN],t)),this._logHandler.apply(this,s([this,f.WARN],t))},p.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.ERROR],t)),this._logHandler.apply(this,s([this,f.ERROR],t))},p);function p(t){this.name=t,this._logLevel=c,this._logHandler=u,this._userLogHandler=null}function d(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var g,m="FirebaseError",w=(n(b,g=Error),b);function b(t,e,n){return(e=g.call(this,e)||this).code=t,e.customData=n,e.name=m,Object.setPrototypeOf(e,b.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,I.prototype.create),e}var I=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=(t=this.errors[t])?(r=i,t.replace(_,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new w(o,t,i)},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var _=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},D=N||self;function S(){}function O(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function x(t){var e=O(t);return"array"==e||"object"==e&&"number"==typeof t.length}function P(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var k="closure_uid_"+(1e9*Math.random()>>>0),L=0;function R(t,e,n){return t.call.apply(t.bind,arguments)}function V(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function C(t,e,n){return(C=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?R:V).apply(null,arguments)}function U(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var q=Date.now;function M(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t}function F(){this.j=this.j,this.i=this.i}F.prototype.j=!1,F.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,k)&&this[k]||(this[k]=++L))},F.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var j=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},B=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function G(){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function K(t){return/^[\s\xa0]*$/.test(t)}var H=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function W(t,e){return-1!=t.indexOf(e)}function J(t,e){return t<e?-1:e<t?1:0}var Q=D.navigator;function Y(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function X(t){var e,n={};for(e in t)n[e]=t[e];return n}ct=(Q=Q&&Q.userAgent)?Q:"";var $="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Z(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<$.length;i++)e=$[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function tt(t){return tt[" "](t),t}tt[" "]=S;var et,nt=W(ct,"Opera"),rt=W(ct,"Trident")||W(ct,"MSIE"),it=W(ct,"Edge"),ot=it||rt,st=W(ct,"Gecko")&&!(W(ct.toLowerCase(),"webkit")&&!W(ct,"Edge"))&&!(W(ct,"Trident")||W(ct,"MSIE"))&&!W(ct,"Edge"),ut=W(ct.toLowerCase(),"webkit")&&!W(ct,"Edge");function at(){var t=D.document;return t?t.documentMode:void 0}var Q="",ct=(ct=ct,st?/rv:([^\);]+)(\)|;)/.exec(ct):it?/Edge\/([\d\.]+)/.exec(ct):rt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ct):ut?/WebKit\/(\S+)/.exec(ct):nt?/(?:Version)[ \/]?(\S+)/.exec(ct):void 0);ct&&(Q=ct?ct[1]:""),et=rt&&null!=(ct=at())&&ct>parseFloat(Q)?String(ct):Q;var ht={};function lt(u){return t=u,e=function(){for(var t=0,e=H(String(et)).split("."),n=H(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++)for(var o=e[i]||"",s=n[i]||"";o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],(0!=o[0].length||0!=s[0].length)&&(t=J(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||J(0==o[2].length,0==s[2].length)||J(o[2],s[2]),o=o[3],s=s[3],0==t););return 0<=t},n=ht,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var ft=D.document&&rt&&(at()||parseInt(et,10))||void 0,pt=!rt||9<=Number(ft),dt=rt&&!lt("9"),yt=function(){if(!D.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{D.addEventListener("test",S,e),D.removeEventListener("test",S,e)}catch(t){}return t}();function vt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function gt(t,e){if(vt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(st){t:{try{tt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:mt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}vt.prototype.b=function(){this.defaultPrevented=!0},M(gt,vt);var mt={2:"touch",3:"pen",4:"mouse"};gt.prototype.b=function(){gt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,dt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var wt="closure_listenable_"+(1e6*Math.random()|0),bt=0;function It(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++bt,this.Y=this.Z=!1}function Et(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function _t(t){this.src=t,this.a={},this.b=0}function Tt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=j(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Et(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function At(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}_t.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=At(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new It(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Nt="closure_lm_"+(1e6*Math.random()|0),Dt={};function St(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Ct(r),e&&e[wt]?e.wa(n,r,P(i)?!!i.capture:!!i,o):Ot(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)St(t,e[o],n,r,i);return null}return n=Ct(n),t&&t[wt]?t.va(e,n,P(r)?!!r.capture:!!r,i):Ot(t,e,n,!1,r,i)}function Ot(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=P(i)?!!i.capture:!!i;if(s&&!pt)return null;var u,a,c=Rt(t);if(c||(t[Nt]=c=new _t(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Lt,r=a=pt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)yt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Pt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function xt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[wt]?Tt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Pt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Rt(e))?(Tt(n,t),0==n.b&&(n.src=null,e[Nt]=null)):Et(t)))}function Pt(t){return t in Dt?Dt[t]:Dt[t]="on"+t}function kt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&xt(t),n.call(r,e)}function Lt(t,e){if(t.Y)return!0;if(pt)return kt(t,new gt(e,this));if(!e)t:{e=["window","event"];for(var n=D,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return kt(t,e=new gt(e,this))}function Rt(t){return(t=t[Nt])instanceof _t?t:null}var Vt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ct(e){return"function"==O(e)?e:(e[Vt]||(e[Vt]=function(t){return e.handleEvent(t)}),e[Vt])}function Ut(){F.call(this),this.c=new _t(this),(this.J=this).C=null}function qt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new vt(e,t):e instanceof vt?e.target=e.target||t:(s=e,Z(e=new vt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Mt(o,r,!0,e)&&s;if(s=Mt(o=e.a=t,r,!0,e)&&s,s=Mt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Mt(o=e.a=n[i],r,!1,e)&&s}function Mt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Tt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}M(Ut,F),Ut.prototype[wt]=!0,(ct=Ut.prototype).addEventListener=function(t,e,n,r){St(this,t,e,n,r)},ct.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=P(i)?!!i.capture:!!i,r=Ct(r),e&&e[wt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=At(s=e.a[n],r,i,o))&&(Et(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Rt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=At(n,r,i,o)),(r=-1<e?n[e]:null)&&xt(r))}(this,t,e,n,r)},ct.G=function(){if(Ut.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Et(n[r]);delete e.a[t],e.b--}}this.C=null},ct.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},ct.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Ft=D.JSON.stringify;function jt(){this.b=this.a=null}var Bt,Gt=(zt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new zt(function(){return new Kt},function(t){t.reset()},100));function zt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Kt(){this.next=this.b=this.a=null}function Ht(t,e){var n;Bt||(n=D.Promise.resolve(void 0),Bt=function(){n.then(Qt)}),Wt||(Bt(),Wt=!0),Jt.add(t,e)}jt.prototype.add=function(t,e){var n=Gt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Kt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Wt=!(Kt.prototype.reset=function(){this.next=this.b=this.a=null}),Jt=new jt;function Qt(){for(var t,e;n=e=void 0,n=null,(e=Jt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){D.setTimeout(function(){throw t},0)}(t)}var n=Gt;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Wt=!1}function Yt(t,e){Ut.call(this),this.b=t||1,this.a=e||D,this.f=C(this.Xa,this),this.g=q()}function Xt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function $t(t,e,n){if("function"==O(t))n&&(t=C(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=C(t.handleEvent,t)}return 2147483647<Number(e)?-1:D.setTimeout(t,e||0)}M(Yt,Ut),(ct=Yt.prototype).aa=!1,ct.M=null,ct.Xa=function(){var t;this.aa&&(0<(t=q()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),qt(this,"tick"),this.aa&&(Xt(this),this.start())))},ct.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=q())},ct.G=function(){Yt.X.G.call(this),Xt(this),delete this.a};var Zt,te,ee=(T(te=re,Q=Zt=F),te.prototype=null===Q?Object.create(Q):(ne.prototype=Q.prototype,new ne),re.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=$t(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},re.prototype.G=function(){Zt.prototype.G.call(this),this.a&&(D.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},re);function ne(){this.constructor=te}function re(t,e,n){var r=Zt.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function ie(t){F.call(this),this.b=t,this.a={}}M(ie,F);var oe=[];function se(t,e,n,r){Array.isArray(n)||(n&&(oe[0]=n.toString()),n=oe);for(var i=0;i<n.length;i++){var o=St(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ue(t){Y(t.a,function(t,e){this.a.hasOwnProperty(e)&&xt(t)},t),t.a={}}function ae(){this.a=!0}function ce(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return Ft(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ie.prototype.G=function(){ie.X.G.call(this),ue(this)},ie.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ae.prototype.info=function(){};var he=null;function le(){return he=he||new Ut}function fe(t){vt.call(this,"serverreachability",t)}function pe(){var t=le();qt(t,new fe(t))}function de(t){vt.call(this,"statevent",t)}function ye(){var t=le();qt(t,new de(t))}function ve(t){vt.call(this,"timingevent",t)}function ge(t,e){if("function"!=O(t))throw Error("Fn must not be null and must be a function");return D.setTimeout(function(){t()},e)}M(fe,vt),M(de,vt),M(ve,vt);var me={NO_ERROR:0,Ya:1,fb:2,eb:3,ab:4,cb:5,gb:6,Da:7,TIMEOUT:8,jb:9},we={$a:"complete",nb:"success",Ea:"error",Da:"abort",lb:"ready",mb:"readystatechange",TIMEOUT:"timeout",hb:"incrementaldata",kb:"progress",bb:"downloadprogress",ob:"uploadprogress"};function be(){}function Ie(t){var e;return(e=t.a)||(e=t.a={}),e}function Ee(){}be.prototype.a=null;var _e,N={OPEN:"a",Za:"b",Ea:"c",ib:"d"};function Te(){vt.call(this,"d")}function Ae(){vt.call(this,"c")}function Ne(){}function De(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ie(this),this.P=Se,t=ot?125:void 0,this.R=new Yt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}M(Te,vt),M(Ae,vt),M(Ne,be),_e=new Ne;var Se=45e3,Oe={},xe={};function Pe(t,e,n){t.H=1,t.i=$e(He(e)),t.j=n,t.I=!0,ke(t,null)}function ke(t,e){t.u=q(),Re(t),t.l=He(t.i);var s,u,a,c,h,l,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),fn(n.b,"t",r),t.D=0,t.a=or(t.g,t.g.C?e:null),0<t.O&&(t.F=new ee(C(t.Ca,t,t.a),t.O)),se(t.J,t.a,"readystatechange",t.Va),e=t.B?X(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),pe(),s=t.c,u=t.m,a=t.l,c=t.f,h=t.S,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Le(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?xe:(i=Number(u.substring(i,o)),isNaN(i)?Oe:(o+=1)+i>u.length?xe:(u=u.substr(o,i),r.D=o+i,u)));if(u==xe){4==e&&(t.h=4,ye(),s=!1),ce(t.c,t.f,null,"[Incomplete Response]");break}if(u==Oe){t.h=4,ye(),ce(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}ce(t.c,t.f,u,null),Me(t,u)}4==e&&0==n.length&&(t.h=1,ye(),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Xn(e),e.F=!0,ye())):(ce(t.c,t.f,n,"[Invalid Chunked Response]"),qe(t),Ue(t))}function Re(t){t.T=q()+t.P,Ve(t,t.P)}function Ve(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=ge(C(t.Ta,t),e)}function Ce(t){t.o&&(D.clearTimeout(t.o),t.o=null)}function Ue(t){0==t.g.v||t.A||tr(t.g,t)}function qe(t){Ce(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Xt(t.R),ue(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Me(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||wn(u.b,t)))if(u.I=t.N,!t.C&&wn(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;Zn(u),Bn(u)}Yn(u),ye()}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=ge(C(u.Qa,u),6e3));if(mn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else nr(u,11)}else if(!t.C&&u.a!=t||Zn(u),!K(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(W(r,"spdy")||W(r,"quic")||W(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(bn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,Xe(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=q()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ir(n,n.C?n.ga:null,n.fa),i.C?(In(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Ce(o),Re(o)),n.a=i):Qn(n),0<u.g.length&&Kn(u)):"stop"!=c[0]&&"close"!=c[0]||nr(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?nr(u,7):jn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0);pe()}catch(t){}}function Fe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(x(t)||"string"==typeof t)B(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(x(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(x(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function je(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof je)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Be(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ge(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Ge(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Ge(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(ct=De.prototype).setTimeout=function(t){this.P=t},ct.Va=function(t){t=t.target;var e=this.F;e&&3==Un(t)?e.f():this.Ca(t)},ct.Ca=function(t){try{if(t==this.a)t:{var e=Un(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!ot&&!this.a.$())){this.A||4!=e||7==n||pe(),Ce(this);var i=this.a.W();if(this.N=i,n=this.a.$(),this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.S,l=e,f=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+l+" "+f}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!K(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,ye(),qe(this),Ue(this);break t}ce(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Me(this,s)}this.I?(Le(this,e,n),ot&&this.b&&3==e&&(se(this.J,this.R,"tick",this.Ua),this.R.start())):(ce(this.c,this.f,n,null),Me(this,n)),4==e&&qe(this),this.b&&!this.A&&(4==e?tr(this.g,this):(this.b=!1,Re(this)))}else 400==i&&0<n.indexOf("Unknown SID")?this.h=3:this.h=0,ye(),qe(this),Ue(this)}}}catch(t){}var u,a,c,h,l,f},ct.Ua=function(){var t,e;this.a&&(t=Un(this.a),e=this.a.$(),this.D<e.length&&(Ce(this),Le(this,t,e),this.b&&4!=t&&Re(this)))},ct.cancel=function(){this.A=!0,qe(this)},ct.Ta=function(){this.o=null;var t,e,n=q();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(pe(),ye()),qe(this),this.h=2,Ue(this)):Ve(this,this.T-n)},(ct=je.prototype).K=function(){Be(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},ct.L=function(){return Be(this),this.a.concat()},ct.get=function(t,e){return Ge(this.b,t)?this.b[t]:e},ct.set=function(t,e){Ge(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},ct.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var ze=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ke(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ke?(this.a=void 0!==e?e:t.a,We(this,t.f),this.j=t.j,Je(this,t.c),Qe(this,t.h),this.g=t.g,e=t.b,(n=new an).c=e.c,e.a&&(n.a=new je(e.a),n.b=e.b),Ye(this,n),this.i=t.i):t&&(n=String(t).match(ze))?(this.a=!!e,We(this,n[1]||"",!0),this.j=Ze(n[2]||""),Je(this,n[3]||"",!0),Qe(this,n[4]),this.g=Ze(n[5]||"",!0),Ye(this,n[6]||"",!0),this.i=Ze(n[7]||"")):(this.a=!!e,this.b=new an(null,this.a))}function He(t){return new Ke(t)}function We(t,e,n){t.f=n?Ze(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Je(t,e,n){t.c=n?Ze(e,!0):e}function Qe(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Ye(t,e,n){var r,i;e instanceof an?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(cn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(hn(this,e),fn(this,n,t))},r)),r.f=i):(n||(e=tn(e,sn)),t.b=new an(e,t.a))}function Xe(t,e,n){t.b.set(e,n)}function $e(t){return Xe(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^q()).toString(36)),t}function Ze(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function tn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,en),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function en(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ke.prototype.toString=function(){var t=[],e=this.f;e&&t.push(tn(e,nn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(tn(e,nn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(tn(n,"/"==n.charAt(0)?on:rn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",tn(n,un)),t.join("")};var nn=/[#\/\?@]/g,rn=/[#\?:]/g,on=/[#\?]/g,sn=/[#\?@]/g,un=/#/g;function an(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function cn(o){o.a||(o.a=new je,o.b=0,o.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],r=n,i=i?decodeURIComponent(i.replace(/\+/g," ")):"",o.add(decodeURIComponent(r.replace(/\+/g," ")),i)}}}(o.c))}function hn(t,e){cn(t),e=pn(t,e),Ge(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ge((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Be(t)))}function ln(t,e){return cn(t),e=pn(t,e),Ge(t.a.b,e)}function fn(t,e,n){hn(t,e),0<n.length&&(t.c=null,t.a.set(pn(t,e),z(n)),t.b+=n.length)}function pn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function dn(t,e){this.b=t,this.a=e}function yn(t){this.g=t||vn,t=D.PerformanceNavigationTiming?0<(t=D.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(D.ia&&D.ia.ya&&D.ia.ya()&&D.ia.ya().pb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(ct=an.prototype).add=function(t,e){cn(this),this.c=null,t=pn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},ct.forEach=function(n,r){cn(this),this.a.forEach(function(t,e){B(t,function(t){n.call(r,t,e,this)},this)},this)},ct.L=function(){cn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},ct.K=function(t){cn(this);var e=[];if("string"==typeof t)ln(this,t)&&(e=G(e,this.a.get(pn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=G(e,t[n])}return e},ct.set=function(t,e){return cn(this),this.c=null,ln(this,t=pn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},ct.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},ct.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var vn=10;function gn(t){return t.b||t.a&&t.a.size>=t.f}function mn(t){return t.b?1:t.a?t.a.size:0}function wn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function bn(t,e){t.a?t.a.add(e):t.b=e}function In(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function En(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return z(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function _n(){}function Tn(){this.a=new _n}function An(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}yn.prototype.cancel=function(){var t,e;if(this.c=En(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},_n.prototype.stringify=function(t){return D.JSON.stringify(t,void 0)},_n.prototype.parse=function(t){return D.JSON.parse(t,void 0)};var Nn=D.JSON.parse;function Dn(t){Ut.call(this),this.headers=new je,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Sn,this.D=this.F=!1}M(Dn,Ut);var Sn="",On=/^https?$/i,xn=["POST","PUT"];function Pn(t){return"content-type"==t.toLowerCase()}function kn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Ln(t),Vn(t)}function Ln(t){t.u||(t.u=!0,qt(t,"complete"),qt(t,"error"))}function Rn(t){if(t.b&&(!t.s[1]||4!=Un(t)||2!=t.W()))if(t.l&&4==Un(t))$t(t.za,0,t);else if(qt(t,"readystatechange"),4==Un(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(ze)[1]||null)&&D.self&&D.self.location&&(i=(r=D.self.location.protocol).substr(0,r.length-1)),n=!On.test(i?i.toLowerCase():"")),e=n),e)qt(t,"complete"),qt(t,"success");else{t.h=6;try{var u=2<Un(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.W()+"]",Ln(t)}}finally{Vn(t)}}}function Vn(t,e){if(t.a){Cn(t);var n=t.a,r=t.s[0]?S:null;t.a=null,t.s=null,e||qt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Cn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(D.clearTimeout(t.m),t.m=null)}function Un(t){return t.a?t.a.readyState:0}function qn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",Y(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Xe(t,e,n))}function Mn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Fn(t){this.pa=0,this.g=[],this.c=new ae,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Ma=this.R=0,this.Ja=Mn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Fa=Mn("baseRetryDelayMs",5e3,t),this.Pa=Mn("retryDelaySeedMs",1e4,t),this.Ka=Mn("forwardChannelMaxRetries",2,t),this.ma=Mn("forwardChannelRequestTimeoutMs",2e4,t),this.La=t&&t.h||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new yn(t&&t.concurrentRequestLimit),this.ka=new Tn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.g&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ia=t&&t.f||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function jn(t){var e,n;Gn(t),3==t.v&&(e=t.R++,Xe(n=He(t.B),"SID",t.J),Xe(n,"RID",e),Xe(n,"TYPE","terminate"),Wn(t,n),(e=new De(t,t.c,e,void 0)).H=2,e.i=$e(He(n)),n=!1,D.navigator&&D.navigator.sendBeacon&&(n=D.navigator.sendBeacon(e.i.toString(),"")),!n&&D.Image&&((new Image).src=e.i,n=!0),n||(e.a=or(e.g,null),e.a.ba(e.i)),e.u=q(),Re(e)),rr(t)}function Bn(t){t.a&&(Xn(t),t.a.cancel(),t.a=null)}function Gn(t){Bn(t),t.j&&(D.clearTimeout(t.j),t.j=null),Zn(t),t.b.cancel(),t.h&&("number"==typeof t.h&&D.clearTimeout(t.h),t.h=null)}function zn(t,e){t.g.push(new dn(t.Ma++,e)),3==t.v&&Kn(t)}function Kn(t){gn(t.b)||t.h||(t.h=!0,Ht(t.Ba,t),t.u=0)}function Hn(t,e){var n=e?e.f:t.R++,r=He(t.B);Xe(r,"SID",t.J),Xe(r,"RID",n),Xe(r,"AID",t.P),Wn(t,r),t.i&&t.l&&qn(r,t.i,t.l),n=new De(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Jn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),bn(t.b,n),Pe(n,r,e)}function Wn(t,n){t.f&&Fe({},function(t,e){Xe(n,e,t)})}function Jn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?C(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+c+"_"||"";try{Fe(t,function(t,e){var n=t;P(t)&&(n=Ft(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s)}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Qn(t){t.a||t.j||(t.T=1,Ht(t.Aa,t),t.o=0)}function Yn(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=ge(C(t.Aa,t),er(t,t.o)),t.o++,1)}function Xn(t){null!=t.s&&(D.clearTimeout(t.s),t.s=null)}function $n(t){t.a=new De(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=He(t.la);Xe(e,"RID","rpc"),Xe(e,"SID",t.J),Xe(e,"CI",t.H?"0":"1"),Xe(e,"AID",t.P),Wn(t,e),Xe(e,"TYPE","xmlhttp"),t.i&&t.l&&qn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=$e(He(e)),n.j=null,n.I=!0,ke(n,t)}function Zn(t){null!=t.m&&(D.clearTimeout(t.m),t.m=null)}function tr(t,e){var n,r,i,o=null;if(t.a==e){Zn(t),Xn(t),t.a=null;var s=2}else{if(!wn(t.b,e))return;o=e.s,In(t.b,e),s=1}if(t.I=e.N,0!=t.v)if(e.b)1==s?(o=e.j?e.j.length:0,e=q()-e.u,n=t.u,qt(s=le(),new ve(s)),Kn(t)):Qn(t);else if(3==(n=e.h)||0==n&&0<t.I||(1!=s||(i=e,mn((r=t).b)>=r.b.f-(r.h?1:0)||(r.h?(r.g=i.s.concat(r.g),0):1==r.v||2==r.v||r.u>=(r.Ja?0:r.Ka)||(r.h=ge(C(r.Ba,r,i),er(r,r.u)),r.u++,0))))&&(2!=s||!Yn(t)))switch(o&&0<o.length&&(e=t.b,e.c=e.c.concat(o)),n){case 1:nr(t,5);break;case 4:nr(t,10);break;case 3:nr(t,6);break;default:nr(t,2)}}function er(t,e){var n=t.Fa+Math.floor(Math.random()*t.Pa);return t.f||(n*=2),n*e}function nr(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=C(t.Wa,t),r||(r=new Ke("//www.google.com/images/cleardot.gif"),D.location&&"http"==D.location.protocol||We(r,"https"),$e(r)),n=r.toString(),r=o,o=new ae,D.Image?((i=new Image).onload=U(An,o,i,"TestLoadImage: loaded",!0,r),i.onerror=U(An,o,i,"TestLoadImage: error",!1,r),i.onabort=U(An,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=U(An,o,i,"TestLoadImage: timeout",!1,r),D.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):ye(),t.v=0,t.f&&t.f.ra(e),rr(t),Gn(t)}function rr(t){t.v=0,t.I=-1,t.f&&(0==En(t.b).length&&0==t.g.length||(t.b.c.length=0,z(t.g),t.g.length=0),t.f.qa())}function ir(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Ke?He(s):new Ke(s,void 0);return""!=a.c?(e&&Je(a,e+"."+a.c),Qe(a,a.h)):(r=(u=D.location).protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Ke(null,void 0),r&&We(u,r),i&&Je(u,i),o&&Qe(u,o),s&&(u.g=s),a=u),t.V&&Y(t.V,function(t,e){Xe(a,e,t)}),e=t.A,n=t.na,e&&n&&Xe(a,e,n),Xe(a,"VER",t.ha),Wn(t,a),a}function or(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Dn(t.La)).F=t.C,e}function sr(){}function ur(){if(rt&&!(10<=Number(ft)))throw Error("Environmental error: no available transport.")}function ar(t,e){Ut.call(this),this.a=new Fn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!K(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!K(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new lr(this)}function cr(t){Te.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function hr(){Ae.call(this),this.status=1}function lr(t){this.a=t}(ct=Dn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ie(this.H):Ie(_e),this.a.onreadystatechange=C(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void kn(this,t)}t=n||"";var i,o=new je(this.headers);r&&Fe(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Pn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=D.FormData&&t instanceof D.FormData,0<=j(xn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Cn(this),0<this.o&&((this.D=(i=this.a,rt&&lt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=C(this.xa,this)):this.m=$t(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){kn(this,t)}},ct.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,qt(this,"timeout"),this.abort(8))},ct.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,qt(this,"complete"),qt(this,"abort"),Vn(this))},ct.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Vn(this,!0)),Dn.X.G.call(this)},ct.za=function(){this.j||(this.A||this.l||this.g?Rn(this):this.Sa())},ct.Sa=function(){Rn(this)},ct.W=function(){try{return 2<Un(this)?this.a.status:-1}catch(t){return-1}},ct.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},ct.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Nn(e)}},ct.ua=function(){return this.h},ct.Oa=function(){return"string"==typeof this.f?this.f:String(this.f)},(ct=Fn.prototype).ha=8,ct.v=1,ct.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new De(this,this.c,t,void 0),r=this.l;if(this.O&&(r?Z(r=X(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Jn(this,n,e),Xe(i=He(this.B),"RID",t),Xe(i,"CVER",22),this.A&&Xe(i,"X-HTTP-Session-Id",this.A),Wn(this,i),this.i&&r&&qn(i,this.i,r),bn(this.b,n),this.Ga&&Xe(i,"TYPE","init"),this.da?(Xe(i,"$req",e),Xe(i,"SID","null"),n.U=!0,Pe(n,i,null)):Pe(n,i,e),this.v=2}}else 3==this.v&&(t?Hn(this,t):0==this.g.length||gn(this.b)||Hn(this))},ct.Aa=function(){var t;this.j=null,$n(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=ge(C(this.Ra,this),t))},ct.Ra=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,ye(),Bn(this),$n(this))},ct.Qa=function(){null!=this.m&&(this.m=null,Bn(this),Yn(this),ye())},ct.Wa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),ye()},(ct=sr.prototype).ta=function(){},ct.sa=function(){},ct.ra=function(){},ct.qa=function(){},ct.Ha=function(){},ur.prototype.a=function(t,e){return new ar(t,e)},M(ar,Ut),ar.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;ye(),t.fa=e,t.V=n||{},t.H=t.S,t.B=ir(t,null,t.fa),Kn(t)},ar.prototype.close=function(){jn(this.a)},ar.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,zn(this.a,e)):this.l?((e={}).__data__=Ft(t),zn(this.a,e)):zn(this.a,t)},ar.prototype.G=function(){this.a.f=null,delete this.f,jn(this.a),delete this.a,ar.X.G.call(this)},M(cr,Te),M(hr,Ae),M(lr,sr),lr.prototype.ta=function(){qt(this.a,"a")},lr.prototype.sa=function(t){qt(this.a,new cr(t))},lr.prototype.ra=function(t){qt(this.a,new hr)},lr.prototype.qa=function(){qt(this.a,"b")},ur.prototype.createWebChannel=ur.prototype.a,ar.prototype.send=ar.prototype.h,ar.prototype.open=ar.prototype.g,me.NO_ERROR=0,me.TIMEOUT=8,me.HTTP_ERROR=6,we.COMPLETE="complete",(Ee.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",Ut.prototype.listen=Ut.prototype.va,Dn.prototype.listenOnce=Dn.prototype.wa,Dn.prototype.getLastError=Dn.prototype.Oa,Dn.prototype.getLastErrorCode=Dn.prototype.ua,Dn.prototype.getStatus=Dn.prototype.W,Dn.prototype.getResponseJson=Dn.prototype.Na,Dn.prototype.getResponseText=Dn.prototype.$,Dn.prototype.send=Dn.prototype.ba;var fr=me,pr=we,dr=Ee,yr=Dn,vr=(gr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},gr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},gr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},gr);function gr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var mr=(wr.prototype.getPlatformInfoString=function(){return this.container.getProviders().map(function(t){return"VERSION"===(null==(e=(e=t).getComponent())?void 0:e.type)?(t=t.getImmediate()).library+"/"+t.version:null;var e}).filter(function(t){return t}).join(" ")},wr);function wr(t){this.container=t}var N="@firebase/app-exp",br=new l("@firebase/app"),Ir=((me={})[N]="fire-core",me["@firebase/app-compat"]="fire-core-compat",me["@firebase/analytics"]="fire-analytics",me["@firebase/auth"]="fire-auth",me["@firebase/database"]="fire-rtdb",me["@firebase/functions-exp"]="fire-fn",me["@firebase/functions-compat"]="fire-fn-compat",me["@firebase/installations"]="fire-iid",me["@firebase/messaging"]="fire-fcm",me["@firebase/performance"]="fire-perf",me["@firebase/remote-config"]="fire-rc",me["@firebase/storage"]="fire-gcs",me["@firebase/firestore"]="fire-fst",me["fire-js"]="fire-js",me["firebase-exp"]="fire-js-all",me),Er=new Map,_r=new Map;function Tr(t){var e,n,r=t.name;if(!_r.has(r)){_r.set(r,t);try{for(var i=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(Er.values()),o=i.next();!o.done;o=i.next())!function(e,n){try{e.container.addComponent(n)}catch(t){br.debug("Component "+n.name+" failed to register with FirebaseApp "+e.name,t)}}(o.value,t)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return 1}br.debug("There were multiple attempts to register component "+r+".")}var me=((we={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",we["bad-app-name"]="Illegal App name: '{$appName}",we["duplicate-app"]="Firebase App named '{$appName}' already exists",we["app-deleted"]="Firebase App named '{$appName}' already deleted",we["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",we["invalid-log-argument"]="First argument to `onLog` must be null or a function.",we),Ar=new I("app","Firebase",me);function Nr(t,e,n){var r=this;this.isDeleted=!1,this.options_=i({},t),this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled,this.container=n,this.container.addComponent(new vr("app-exp",function(){return r},"PUBLIC"))}function Dr(t,e,n){var r=null!==(i=Ir[t])&&void 0!==i?i:t;n&&(r+="-"+n);var i=r.match(/\s|\//),t=e.match(/\s|\//);if(i||t)return n=['Unable to register library "'+r+'" with version "'+e+'":'],i&&n.push('library name "'+r+'" contains illegal characters (whitespace or "/")'),i&&t&&n.push("and"),t&&n.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),br.warn(n.join(" ")),0;Tr(new vr(r+"-version",function(){return{library:r,version:e}},"VERSION"))}Object.defineProperty(Nr.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(Nr.prototype,"name",{get:function(){return this.checkDestroyed(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(Nr.prototype,"options",{get:function(){return this.checkDestroyed(),this.options_},enumerable:!1,configurable:!0}),Nr.prototype.checkDestroyed=function(){if(this.isDeleted)throw Ar.create("app-deleted",{appName:this.name_})},Tr(new vr("platform-logger",function(t){return new mr(t)},"PRIVATE")),Dr(N,"0.0.800",void 0),Dr("fire-js","");var Sr,Or={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},xr=(n(Lr,Sr=Error),Lr),Pr="8.0.2-20201010222127",kr=new l("@firebase/firestore");function Lr(t,e){var n=this;return(n=Sr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Rr(){return kr.logLevel}function Vr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];kr.logLevel<=f.DEBUG&&(e=n.map(qr),kr.debug.apply(kr,o(["Firestore ("+Pr+"): "+t],e)))}function Cr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];kr.logLevel<=f.ERROR&&(e=n.map(qr),kr.error.apply(kr,o(["Firestore ("+Pr+"): "+t],e)))}function Ur(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];kr.logLevel<=f.WARN&&(e=n.map(qr),kr.warn.apply(kr,o(["Firestore ("+Pr+"): "+t],e)))}function qr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Mr(t){throw void 0===t&&(t="Unexpected state"),Cr(t="FIRESTORE ("+Pr+") INTERNAL ASSERTION FAILED: "+t),new Error(t)}function Fr(t){t||Mr()}var jr=(Br.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Br);function Br(){}function Gr(t,e){return t<e?-1:e<t?1:0}function zr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Kr(t){return t+"\0"}var Hr=(Wr.fromBase64String=function(t){return new Wr(atob(t))},Wr.fromUint8Array=function(t){return new Wr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Wr.prototype.toBase64=function(){return t=this.i,btoa(t);var t},Wr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},Wr.prototype.o=function(){return 2*this.i.length},Wr.prototype.u=function(t){return Gr(this.i,t.i)},Wr.prototype.isEqual=function(t){return this.i===t.i},Wr);function Wr(t){this.i=t}Hr.h=new Hr("");var Jr=(Qr.fromBase64String=function(t){try{return new Qr(Hr.fromBase64String(t))}catch(t){throw new xr(Or.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},Qr.fromUint8Array=function(t){return new Qr(Hr.fromUint8Array(t))},Qr.prototype.toBase64=function(){return this.l.toBase64()},Qr.prototype.toUint8Array=function(){return this.l.toUint8Array()},Qr.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Qr.prototype.isEqual=function(t){return this.l.isEqual(t.l)},Qr);function Qr(t){this.l=t}function Yr(){if("undefined"==typeof Uint8Array)throw new xr(Or.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Xr(){if("undefined"==typeof atob)throw new xr(Or.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var $r,Zr=(n(ri,$r=Jr),ri.fromBase64String=function(t){Xr();try{return new ri(Hr.fromBase64String(t))}catch(t){throw new xr(Or.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},ri.fromUint8Array=function(t){return Yr(),new ri(Hr.fromUint8Array(t))},ri.prototype.toBase64=function(){return Xr(),$r.prototype.toBase64.call(this)},ri.prototype.toUint8Array=function(){return Yr(),$r.prototype.toUint8Array.call(this)},ri.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},ri),ti=function(t,e,n,r,i,o){this._=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.T=o},ei=(Object.defineProperty(ni.prototype,"I",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),ni.prototype.isEqual=function(t){return t instanceof ni&&t.projectId===this.projectId&&t.database===this.database},ni);function ni(t,e){this.projectId=t,this.database=e||"(default)"}function ri(){return null!==$r&&$r.apply(this,arguments)||this}function ii(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function oi(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function si(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var ui,ai,ci=(Ei.prototype.get=function(t){var e=this.m(t);if(void 0!==(e=this.R[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.A(i,t))return o}},Ei.prototype.has=function(t){return void 0!==this.get(t)},Ei.prototype.set=function(t,e){var n=this.m(t),r=this.R[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.A(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.R[n]=[[t,e]]},Ei.prototype.delete=function(t){var e=this.m(t),n=this.R[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.A(n[r][0],t))return 1===n.length?delete this.R[e]:n.splice(r,1),!0;return!1},Ei.prototype.forEach=function(s){oi(this.R,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];s(i,o)}})},Ei.prototype.P=function(){return si(this.R)},Ei),hi=(Ii.now=function(){return Ii.fromMillis(Date.now())},Ii.fromDate=function(t){return Ii.fromMillis(t.getTime())},Ii.fromMillis=function(t){var e=Math.floor(t/1e3);return new Ii(e,1e6*(t-1e3*e))},Ii.prototype.toDate=function(){return new Date(this.toMillis())},Ii.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Ii.prototype.g=function(t){return this.seconds===t.seconds?Gr(this.nanoseconds,t.nanoseconds):Gr(this.seconds,t.seconds)},Ii.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Ii.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Ii.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},Ii.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Ii),li=(bi.V=function(t){return new bi(t)},bi.min=function(){return new bi(new hi(0,0))},bi.prototype.u=function(t){return this.timestamp.g(t.timestamp)},bi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},bi.prototype.p=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},bi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},bi.prototype.v=function(){return this.timestamp},bi),we=(Object.defineProperty(wi.prototype,"length",{get:function(){return this.S},enumerable:!1,configurable:!0}),wi.prototype.isEqual=function(t){return 0===wi.D(this,t)},wi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof wi?t.forEach(function(t){e.push(t)}):e.push(t),this.C(e)},wi.prototype.limit=function(){return this.offset+this.length},wi.prototype.N=function(t){return t=void 0===t?1:t,this.C(this.segments,this.offset+t,this.length-t)},wi.prototype.F=function(){return this.C(this.segments,this.offset,this.length-1)},wi.prototype.O=function(){return this.segments[this.offset]},wi.prototype.k=function(){return this.get(this.length-1)},wi.prototype.get=function(t){return this.segments[this.offset+t]},wi.prototype.P=function(){return 0===this.length},wi.prototype.M=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},wi.prototype.$=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},wi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},wi.prototype.L=function(){return this.segments.slice(this.offset,this.limit())},wi.D=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},wi),fi=(n(mi,ai=we),mi.prototype.C=function(t,e,n){return new mi(t,e,n)},mi.prototype.B=function(){return this.L().join("/")},mi.prototype.toString=function(){return this.B()},mi.q=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new xr(Or.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new mi(n)},mi.U=function(){return new mi([])},mi),pi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,di=(n(gi,ui=we),gi.prototype.C=function(t,e,n){return new gi(t,e,n)},gi.K=function(t){return pi.test(t)},gi.prototype.B=function(){return this.L().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),gi.K(t)||(t="`"+t+"`"),t}).join(".")},gi.prototype.toString=function(){return this.B()},gi.prototype.W=function(){return 1===this.length&&"__name__"===this.get(0)},gi.j=function(){return new gi(["__name__"])},gi.G=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new xr(Or.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new xr(Or.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new xr(Or.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new xr(Or.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new gi(e)},gi.U=function(){return new gi([])},gi),yi=(vi.H=function(t){return new vi(fi.q(t))},vi.J=function(t){return new vi(fi.q(t).N(5))},vi.prototype.Y=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},vi.prototype.isEqual=function(t){return null!==t&&0===fi.D(this.path,t.path)},vi.prototype.toString=function(){return this.path.toString()},vi.D=function(t,e){return fi.D(t.path,e.path)},vi.X=function(t){return t.length%2==0},vi.Z=function(t){return new vi(new fi(t.slice()))},vi);function vi(t){this.path=t}function gi(){return null!==ui&&ui.apply(this,arguments)||this}function mi(){return null!==ai&&ai.apply(this,arguments)||this}function wi(t,e,n){void 0===e?e=0:e>t.length&&Mr(),void 0===n?n=t.length-e:n>t.length-e&&Mr(),this.segments=t,this.offset=e,this.S=n}function bi(t){this.timestamp=t}function Ii(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new xr(Or.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new xr(Or.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new xr(Or.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new xr(Or.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Ei(t,e){this.m=t,this.A=e,this.R={}}function _i(t){return null==t}function Ti(t){return 0===t&&1/t==-1/0}function Ai(t){return"number"==typeof t&&Number.isInteger(t)&&!Ti(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var Ni=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.tt=null};function Di(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Ni(t,e,n,r,i,o,s)}function Si(t){var e=t;return null===e.tt&&(t=e.path.B(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return t.field.B()+t.op.toString()+So(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return t.field.B()+t.dir}).join(","),_i(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=oa(e.startAt)),e.endAt&&(t+="|ub:",t+=oa(e.endAt)),e.tt=t),e.tt}function Oi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!To(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ua(t.startAt,e.startAt)&&ua(t.endAt,e.endAt)}function xi(t){return yi.X(t.path)&&null===t.collectionGroup&&0===t.filters.length}function Pi(t){this.count=t}var ki,Li=(Ri.prototype.st=function(t){return new Ri(this.target,this.targetId,this.et,t,this.nt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Ri.prototype.it=function(t,e){return new Ri(this.target,this.targetId,this.et,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Ri.prototype.rt=function(t){return new Ri(this.target,this.targetId,this.et,this.sequenceNumber,this.nt,t,this.resumeToken)},Ri);function Ri(t,e,n,r,i,o,s){void 0===i&&(i=li.min()),void 0===o&&(o=li.min()),void 0===s&&(s=Hr.h),this.target=t,this.targetId=e,this.et=n,this.sequenceNumber=r,this.nt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Vi(t){switch(t){case Or.OK:return Mr(),0;case Or.CANCELLED:case Or.UNKNOWN:case Or.DEADLINE_EXCEEDED:case Or.RESOURCE_EXHAUSTED:case Or.INTERNAL:case Or.UNAVAILABLE:case Or.UNAUTHENTICATED:return;case Or.INVALID_ARGUMENT:case Or.NOT_FOUND:case Or.ALREADY_EXISTS:case Or.PERMISSION_DENIED:case Or.FAILED_PRECONDITION:case Or.ABORTED:case Or.OUT_OF_RANGE:case Or.UNIMPLEMENTED:case Or.DATA_LOSS:return 1;default:return Mr(),0}}function Ci(t){if(void 0===t)return Cr("GRPC error has no .code"),Or.UNKNOWN;switch(t){case ki.OK:return Or.OK;case ki.CANCELLED:return Or.CANCELLED;case ki.UNKNOWN:return Or.UNKNOWN;case ki.DEADLINE_EXCEEDED:return Or.DEADLINE_EXCEEDED;case ki.RESOURCE_EXHAUSTED:return Or.RESOURCE_EXHAUSTED;case ki.INTERNAL:return Or.INTERNAL;case ki.UNAVAILABLE:return Or.UNAVAILABLE;case ki.UNAUTHENTICATED:return Or.UNAUTHENTICATED;case ki.INVALID_ARGUMENT:return Or.INVALID_ARGUMENT;case ki.NOT_FOUND:return Or.NOT_FOUND;case ki.ALREADY_EXISTS:return Or.ALREADY_EXISTS;case ki.PERMISSION_DENIED:return Or.PERMISSION_DENIED;case ki.FAILED_PRECONDITION:return Or.FAILED_PRECONDITION;case ki.ABORTED:return Or.ABORTED;case ki.OUT_OF_RANGE:return Or.OUT_OF_RANGE;case ki.UNIMPLEMENTED:return Or.UNIMPLEMENTED;case ki.DATA_LOSS:return Or.DATA_LOSS;default:return Mr()}}(me=ki={})[me.OK=0]="OK",me[me.CANCELLED=1]="CANCELLED",me[me.UNKNOWN=2]="UNKNOWN",me[me.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",me[me.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",me[me.NOT_FOUND=5]="NOT_FOUND",me[me.ALREADY_EXISTS=6]="ALREADY_EXISTS",me[me.PERMISSION_DENIED=7]="PERMISSION_DENIED",me[me.UNAUTHENTICATED=16]="UNAUTHENTICATED",me[me.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",me[me.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",me[me.ABORTED=10]="ABORTED",me[me.OUT_OF_RANGE=11]="OUT_OF_RANGE",me[me.UNIMPLEMENTED=12]="UNIMPLEMENTED",me[me.INTERNAL=13]="INTERNAL",me[me.UNAVAILABLE=14]="UNAVAILABLE",me[me.DATA_LOSS=15]="DATA_LOSS";var Ui=(Bi.prototype.ot=function(t,e){return new Bi(this.D,this.root.ot(t,e,this.D).copy(null,null,Mi.at,null,null))},Bi.prototype.remove=function(t){return new Bi(this.D,this.root.remove(t,this.D).copy(null,null,Mi.at,null,null))},Bi.prototype.get=function(t){for(var e=this.root;!e.P();){var n=this.D(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Bi.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.P();){var r=this.D(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Bi.prototype.P=function(){return this.root.P()},Object.defineProperty(Bi.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Bi.prototype.ct=function(){return this.root.ct()},Bi.prototype.ut=function(){return this.root.ut()},Bi.prototype.ht=function(t){return this.root.ht(t)},Bi.prototype.forEach=function(n){this.ht(function(t,e){return n(t,e),!1})},Bi.prototype.toString=function(){var n=[];return this.ht(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Bi.prototype.lt=function(t){return this.root.lt(t)},Bi.prototype._t=function(){return new qi(this.root,null,this.D,!1)},Bi.prototype.ft=function(t){return new qi(this.root,t,this.D,!1)},Bi.prototype.dt=function(){return new qi(this.root,null,this.D,!0)},Bi.prototype.wt=function(t){return new qi(this.root,t,this.D,!0)},Bi),qi=(ji.prototype.It=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.Et)for(t=t.left;!t.P();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.P();)this.Tt.push(t),t=t.left;return e},ji.prototype.At=function(){return 0<this.Tt.length},ji.prototype.Rt=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},ji),Mi=(Fi.prototype.copy=function(t,e,n,r,i){return new Fi(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Fi.prototype.P=function(){return!1},Fi.prototype.ht=function(t){return this.left.ht(t)||t(this.key,this.value)||this.right.ht(t)},Fi.prototype.lt=function(t){return this.right.lt(t)||t(this.key,this.value)||this.left.lt(t)},Fi.prototype.min=function(){return this.left.P()?this:this.left.min()},Fi.prototype.ct=function(){return this.min().key},Fi.prototype.ut=function(){return this.right.P()?this.key:this.right.ut()},Fi.prototype.ot=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.ot(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.ot(t,e,n))).Pt()},Fi.prototype.gt=function(){if(this.left.P())return Fi.EMPTY;var t=this;return t.left.Vt()||t.left.left.Vt()||(t=t.yt()),(t=t.copy(null,null,null,t.left.gt(),null)).Pt()},Fi.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.P()||r.left.Vt()||r.left.left.Vt()||(r=r.yt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Vt()&&(r=r.bt()),r.right.P()||r.right.Vt()||r.right.left.Vt()||(r=r.vt()),0===e(t,r.key)){if(r.right.P())return Fi.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.gt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Pt()},Fi.prototype.Vt=function(){return this.color},Fi.prototype.Pt=function(){var t=this;return t.right.Vt()&&!t.left.Vt()&&(t=t.St()),t.left.Vt()&&t.left.left.Vt()&&(t=t.bt()),t.left.Vt()&&t.right.Vt()&&(t=t.Dt()),t},Fi.prototype.yt=function(){var t=this.Dt();return t.right.left.Vt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.bt())).St()).Dt()),t},Fi.prototype.vt=function(){var t=this.Dt();return t.left.left.Vt()&&(t=(t=t.bt()).Dt()),t},Fi.prototype.St=function(){var t=this.copy(null,null,Fi.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Fi.prototype.bt=function(){var t=this.copy(null,null,Fi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Fi.prototype.Dt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Fi.prototype.Ct=function(){var t=this.Nt();return Math.pow(2,t)<=this.size+1},Fi.prototype.Nt=function(){if(this.Vt()&&this.left.Vt())throw Mr();if(this.right.Vt())throw Mr();var t=this.left.Nt();if(t!==this.right.Nt())throw Mr();return t+(this.Vt()?0:1)},Fi);function Fi(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Fi.RED,this.left=null!=r?r:Fi.EMPTY,this.right=null!=i?i:Fi.EMPTY,this.size=this.left.size+1+this.right.size}function ji(t,e,n,r){this.Et=r,this.Tt=[];for(var i=1;!t.P();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Et?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.Et?t.right:t.left}}function Bi(t,e){this.D=t,this.root=e||Mi.EMPTY}function Gi(){this.size=0}Mi.EMPTY=null,Mi.RED=!0,Mi.at=!1,Mi.EMPTY=(Object.defineProperty(Gi.prototype,"key",{get:function(){throw Mr()},enumerable:!1,configurable:!0}),Object.defineProperty(Gi.prototype,"value",{get:function(){throw Mr()},enumerable:!1,configurable:!0}),Object.defineProperty(Gi.prototype,"color",{get:function(){throw Mr()},enumerable:!1,configurable:!0}),Object.defineProperty(Gi.prototype,"left",{get:function(){throw Mr()},enumerable:!1,configurable:!0}),Object.defineProperty(Gi.prototype,"right",{get:function(){throw Mr()},enumerable:!1,configurable:!0}),Gi.prototype.copy=function(t,e,n,r,i){return this},Gi.prototype.ot=function(t,e,n){return new Mi(t,e)},Gi.prototype.remove=function(t,e){return this},Gi.prototype.P=function(){return!0},Gi.prototype.ht=function(t){return!1},Gi.prototype.lt=function(t){return!1},Gi.prototype.ct=function(){return null},Gi.prototype.ut=function(){return null},Gi.prototype.Vt=function(){return!1},Gi.prototype.Ct=function(){return!0},Gi.prototype.Nt=function(){return 0},new Gi);var zi=(Ji.prototype.has=function(t){return null!==this.data.get(t)},Ji.prototype.first=function(){return this.data.ct()},Ji.prototype.last=function(){return this.data.ut()},Object.defineProperty(Ji.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Ji.prototype.indexOf=function(t){return this.data.indexOf(t)},Ji.prototype.forEach=function(n){this.data.ht(function(t,e){return n(t),!1})},Ji.prototype.xt=function(t,e){for(var n=this.data.ft(t[0]);n.At();){var r=n.It();if(0<=this.D(r.key,t[1]))return;e(r.key)}},Ji.prototype.Ft=function(t,e){for(var n=void 0!==e?this.data.ft(e):this.data._t();n.At();)if(!t(n.It().key))return},Ji.prototype.Ot=function(t){return(t=this.data.ft(t)).At()?t.It().key:null},Ji.prototype._t=function(){return new Ki(this.data._t())},Ji.prototype.ft=function(t){return new Ki(this.data.ft(t))},Ji.prototype.add=function(t){return this.copy(this.data.remove(t).ot(t,!0))},Ji.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Ji.prototype.P=function(){return this.data.P()},Ji.prototype.kt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Ji.prototype.isEqual=function(t){if(!(t instanceof Ji))return!1;if(this.size!==t.size)return!1;for(var e=this.data._t(),n=t.data._t();e.At();){var r=e.It().key,i=n.It().key;if(0!==this.D(r,i))return!1}return!0},Ji.prototype.L=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Ji.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Ji.prototype.copy=function(t){var e=new Ji(this.D);return e.data=t,e},Ji),Ki=(Wi.prototype.It=function(){return this.Mt.It().key},Wi.prototype.At=function(){return this.Mt.At()},Wi),Hi=new Ui(yi.D);function Wi(t){this.Mt=t}function Ji(t){this.D=t,this.data=new Ui(this.D)}var Qi=new Ui(yi.D),Yi=new Ui(yi.D),Xi=new zi(yi.D);function $i(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Xi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Zi=new zi(Gr),to=(go.Bt=function(t){return new go(t.D)},go.prototype.has=function(t){return null!=this.$t.get(t)},go.prototype.get=function(t){return this.$t.get(t)},go.prototype.first=function(){return this.Lt.ct()},go.prototype.last=function(){return this.Lt.ut()},go.prototype.P=function(){return this.Lt.P()},go.prototype.indexOf=function(t){return(t=this.$t.get(t))?this.Lt.indexOf(t):-1},Object.defineProperty(go.prototype,"size",{get:function(){return this.Lt.size},enumerable:!1,configurable:!0}),go.prototype.forEach=function(n){this.Lt.ht(function(t,e){return n(t),!1})},go.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.$t.ot(t.key,t),e.Lt.ot(t,null))},go.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.$t.remove(t),this.Lt.remove(e)):this},go.prototype.isEqual=function(t){if(!(t instanceof go))return!1;if(this.size!==t.size)return!1;for(var e=this.Lt._t(),n=t.Lt._t();e.At();){var r=e.It().key,i=n.It().key;if(!r.isEqual(i))return!1}return!0},go.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},go.prototype.copy=function(t,e){var n=new go;return n.D=this.D,n.$t=t,n.Lt=e,n},go),eo=(vo.prototype.track=function(t){var e=t.doc.key,n=this.qt.get(e);!n||0!==t.type&&3===n.type?this.qt=this.qt.ot(e,t):3===t.type&&1!==n.type?this.qt=this.qt.ot(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.qt=this.qt.ot(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.qt=this.qt.ot(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.qt=this.qt.remove(e):1===t.type&&2===n.type?this.qt=this.qt.ot(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.qt=this.qt.ot(e,{type:2,doc:t.doc}):Mr()},vo.prototype.Ut=function(){var n=[];return this.qt.ht(function(t,e){n.push(e)}),n},vo),no=(yo.Gt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new yo(t,e,to.Bt(e),i,n,r,!0,!1)},Object.defineProperty(yo.prototype,"hasPendingWrites",{get:function(){return!this.Qt.P()},enumerable:!1,configurable:!0}),yo.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Wt===t.Wt&&this.Qt.isEqual(t.Qt)&&Su(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Kt.isEqual(t.Kt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},yo),ro=(po.Xt=function(t,e){var n=new Map;return n.set(t,io.Zt(t,e)),new po(li.min(),n,Zi,Hi,$i())},po),io=(fo.Zt=function(t,e){return new fo(Hr.h,e,$i(),$i(),$i())},fo),oo=function(t,e,n,r){this.ie=t,this.removedTargetIds=e,this.key=n,this.re=r},so=function(t,e){this.targetId=t,this.oe=e},uo=function(t,e,n,r){void 0===n&&(n=Hr.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},ao=(Object.defineProperty(lo.prototype,"te",{get:function(){return this.he},enumerable:!1,configurable:!0}),Object.defineProperty(lo.prototype,"resumeToken",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(lo.prototype,"_e",{get:function(){return 0!==this.ae},enumerable:!1,configurable:!0}),Object.defineProperty(lo.prototype,"fe",{get:function(){return this.le},enumerable:!1,configurable:!0}),lo.prototype.de=function(t){0<t.o()&&(this.le=!0,this.ue=t)},lo.prototype.we=function(){var n=$i(),r=$i(),i=$i();return this.ce.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Mr()}}),new io(this.ue,this.he,n,r,i)},lo.prototype.Ee=function(){this.le=!1,this.ce=wo()},lo.prototype.Te=function(t,e){this.le=!0,this.ce=this.ce.ot(t,e)},lo.prototype.Ie=function(t){this.le=!0,this.ce=this.ce.remove(t)},lo.prototype.me=function(){this.ae+=1},lo.prototype.Ae=function(){--this.ae},lo.prototype.Re=function(){this.le=!0,this.he=!0},lo),co=(ho.prototype.be=function(t){for(var e=0,n=t.ie;e<n.length;e++){var r=n[e];t.re instanceof cu?this.ve(r,t.re):t.re instanceof hu&&this.Se(r,t.key,t.re)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Se(s,t.key,t.re)}},ho.prototype.De=function(n){var r=this;this.Ce(n,function(t){var e=r.Ne(t);switch(n.state){case 0:r.xe(t)&&e.de(n.resumeToken);break;case 1:e.Ae(),e._e||e.Ee(),e.de(n.resumeToken);break;case 2:e.Ae(),e._e||r.removeTarget(t);break;case 3:r.xe(t)&&(e.Re(),e.de(n.resumeToken));break;case 4:r.xe(t)&&(r.Fe(t),e.de(n.resumeToken));break;default:Mr()}})},ho.prototype.Ce=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.ge.forEach(function(t,e){r.xe(e)&&n(e)})},ho.prototype.Oe=function(t){var e=t.targetId,n=t.oe.count;(t=this.ke(e))&&(xi(t=t.target)?0===n?(t=new yi(t.path),this.Se(e,t,new hu(t,li.min()))):Fr(1===n):this.Me(e)!==n&&(this.Fe(e),this.pe=this.pe.add(e)))},ho.prototype.$e=function(r){var i=this,o=new Map;this.ge.forEach(function(t,e){var n=i.ke(e);n&&(t.te&&xi(n.target)&&(n=new yi(n.target.path),null!==i.Ve.get(n)||i.Le(e,n)||i.Se(e,n,new hu(n,r))),t.fe&&(o.set(e,t.we()),t.Ee()))});var s=$i();this.ye.forEach(function(t,e){var n=!0;e.Ft(function(t){return!(t=i.ke(t))||2===t.et||(n=!1)}),n&&(s=s.add(t))});var t=new ro(r,o,this.pe,this.Ve,s);return this.Ve=Hi,this.ye=mo(),this.pe=new zi(Gr),t},ho.prototype.ve=function(t,e){var n;this.xe(t)&&(n=this.Le(t,e.key)?2:0,this.Ne(t).Te(e.key,n),this.Ve=this.Ve.ot(e.key,e),this.ye=this.ye.ot(e.key,this.Be(e.key).add(t)))},ho.prototype.Se=function(t,e,n){var r;this.xe(t)&&(r=this.Ne(t),this.Le(t,e)?r.Te(e,1):r.Ie(e),this.ye=this.ye.ot(e,this.Be(e).delete(t)),n&&(this.Ve=this.Ve.ot(e,n)))},ho.prototype.removeTarget=function(t){this.ge.delete(t)},ho.prototype.Me=function(t){var e=this.Ne(t).we();return this.Pe.qe(t).size+e.ee.size-e.se.size},ho.prototype.me=function(t){this.Ne(t).me()},ho.prototype.Ne=function(t){var e=this.ge.get(t);return e||(e=new ao,this.ge.set(t,e)),e},ho.prototype.Be=function(t){var e=this.ye.get(t);return e||(e=new zi(Gr),this.ye=this.ye.ot(t,e)),e},ho.prototype.xe=function(t){var e=null!==this.ke(t);return e||Vr("WatchChangeAggregator","Detected inactive target",t),e},ho.prototype.ke=function(t){var e=this.ge.get(t);return e&&e._e?null:this.Pe.Ue(t)},ho.prototype.Fe=function(e){var n=this;this.ge.set(e,new ao),this.Pe.qe(e).forEach(function(t){n.Se(e,t,null)})},ho.prototype.Le=function(t,e){return this.Pe.qe(t).has(e)},ho);function ho(t){this.Pe=t,this.ge=new Map,this.Ve=Hi,this.ye=mo(),this.pe=new zi(Gr)}function lo(){this.ae=0,this.ce=wo(),this.ue=Hr.h,this.he=!1,this.le=!0}function fo(t,e,n,r,i){this.resumeToken=t,this.te=e,this.ee=n,this.ne=r,this.se=i}function po(t,e,n,r,i){this.nt=t,this.zt=e,this.Ht=n,this.Jt=r,this.Yt=i}function yo(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Kt=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.Wt=s,this.jt=u}function vo(){this.qt=new Ui(yi.D)}function go(n){this.D=n?function(t,e){return n(t,e)||yi.D(t.key,e.key)}:function(t,e){return yi.D(t.key,e.key)},this.$t=Qi,this.Lt=new Ui(this.D)}function mo(){return new Ui(yi.D)}function wo(){return new Ui(yi.D)}function bo(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Io(t){return t=Oo(t.mapValue.fields.__local_write_time__.timestampValue),new hi(t.seconds,t.nanos)}var Eo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function _o(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?bo(t)?4:10:Mr()}function To(r,i){var t,e=_o(r);if(e!==_o(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return Io(r).isEqual(Io(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Oo(r.timestampValue),t=Oo(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,Po(r.bytesValue).isEqual(Po(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,xo((t=r).geoPointValue.latitude)===xo(e.geoPointValue.latitude)&&xo(t.geoPointValue.longitude)===xo(e.geoPointValue.longitude);case 2:return t=i,"integerValue"in(e=r)&&"integerValue"in t?xo(e.integerValue)===xo(t.integerValue):"doubleValue"in e&&"doubleValue"in t&&((e=xo(e.doubleValue))===(t=xo(t.doubleValue))?Ti(e)===Ti(t):isNaN(e)&&isNaN(t));case 9:return zr(r.arrayValue.values||[],i.arrayValue.values||[],To);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(ii(e)!==ii(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!To(e[t],n[t])))return!1;return!0}();default:return Mr()}}function Ao(t,e){return void 0!==(t.values||[]).find(function(t){return To(t,e)})}function No(t,e){var n,r,i,o=_o(t),s=_o(e);if(o!==s)return Gr(o,s);switch(o){case 0:return 0;case 1:return Gr(t.booleanValue,e.booleanValue);case 2:return n=e,(r=xo(t.integerValue||t.doubleValue))<(n=xo(n.integerValue||n.doubleValue))?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return Do(t.timestampValue,e.timestampValue);case 4:return Do(Io(t),Io(e));case 5:return Gr(t.stringValue,e.stringValue);case 6:return i=t.bytesValue,s=e.bytesValue,i=Po(i),s=Po(s),i.u(s);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Gr(n[i],r[i]);if(0!==o)return o}return Gr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return o=t.geoPointValue,r=e.geoPointValue,0!==(n=Gr(xo(o.latitude),xo(r.latitude)))?n:Gr(xo(o.longitude),xo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=No(n[i],r[i]);if(o)return o}return Gr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Gr(r[s],o[s]);if(0!==u)return u;if(0!==(u=No(n[r[s]],i[o[s]])))return u}return Gr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Mr()}}function Do(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Gr(t,e);var n=Oo(t),t=Oo(e);return 0!==(e=Gr(n.seconds,t.seconds))?e:Gr(n.nanos,t.nanos)}function So(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=Oo(t=i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?Po(i.bytesValue).toBase64():"referenceValue"in i?(e=i.referenceValue,yi.J(e).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Mr();var t,e}(t)}function Oo(t){if(Fr(!!t),"string"!=typeof t)return{seconds:xo(t.seconds),nanos:xo(t.nanos)};var e=0,n=Eo.exec(t);return Fr(!!n),n[1]&&(n=(n[1]+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function xo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Po(t){return"string"==typeof t?Hr.fromBase64String(t):Hr.fromUint8Array(t)}function ko(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.B()}}function Lo(t){return t&&"integerValue"in t}function Ro(t){return!!t&&"arrayValue"in t}function Vo(t){return t&&"nullValue"in t}function Co(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Uo(t){return t&&"mapValue"in t}var qo={asc:"ASCENDING",desc:"DESCENDING"},Mo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Fo=function(t,e){this._=t,this.Ke=e};function jo(t){return{integerValue:""+t}}function Bo(t,e){if(t.Ke){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ti(e)?"-0":e}}function Go(t,e){return Ai(e)?jo(e):Bo(t,e)}function zo(t,e){return t.Ke?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ko(t,e){return t.Ke?e.toBase64():e.toUint8Array()}function Ho(t){return Fr(!!t),li.V((t=Oo(t),new hi(t.seconds,t.nanos)))}function Wo(t,e){return new fi(["projects",t.projectId,"databases",t.database]).child("documents").child(e).B()}function Jo(t){return Fr(ls(t=fi.q(t))),t}function Qo(t,e){return Wo(t._,e.path)}function Yo(t,e){return Fr((e=Jo(e)).get(1)===t._.projectId),Fr(!e.get(3)&&!t._.database||e.get(3)===t._.database),new yi(ts(e))}function Xo(t,e){return Wo(t._,e)}function $o(t){return 4===(t=Jo(t)).length?fi.U():ts(t)}function Zo(t){return new fi(["projects",t._.projectId,"databases",t._.database]).B()}function ts(t){return Fr(4<t.length&&"documents"===t.get(4)),t.N(5)}function es(t,e,n){return{name:Qo(t,e),fields:n.proto.mapValue.fields}}function ns(t,e){var n,r,i;if(e instanceof js)n={update:es(t,e.key,e.value)};else if(e instanceof $s)n={delete:Qo(t,e.key)};else if(e instanceof Bs)n={update:es(t,e.key,e.data),updateMask:(i=e.Qe,r=[],i.fields.forEach(function(t){return r.push(t.B())}),{fieldPaths:r})};else if(e instanceof Ws)n={transform:{document:Qo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof ys)return{fieldPath:t.field.B(),setToServerValue:"REQUEST_TIME"};if(e instanceof vs)return{fieldPath:t.field.B(),appendMissingElements:{values:e.elements}};if(e instanceof Is)return{fieldPath:t.field.B(),removeAllFromArray:{values:e.elements}};if(e instanceof As)return{fieldPath:t.field.B(),increment:e.We};throw Mr()})}};else{if(!(e instanceof Zs))return Mr();n={verify:Qo(t,e.key)}}return e.Ge.je||(n.currentDocument=void 0!==(i=e.Ge).updateTime?{updateTime:zo(e=t,(t=i.updateTime).v())}:void 0!==i.exists?{exists:i.exists}:Mr()),n}function rs(i,t){var e=t.currentDocument?void 0!==(o=t.currentDocument).updateTime?Ls.updateTime(Ho(o.updateTime)):void 0!==o.exists?Ls.exists(o.exists):Ls.ze():Ls.ze();if(t.update){t.update.name;var n=Yo(i,t.update.name),r=new tu({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=(o=t.updateMask.fieldPaths||[],new Os(o.map(function(t){return di.G(t)})));return new Bs(n,r,o,e)}return new js(n,r,e)}if(t.delete){var s=Yo(i,t.delete);return new $s(s,e)}return t.transform?(r=Yo(i,t.transform.document),s=t.transform.fieldTransforms.map(function(t){return e=i,r=null,"setToServerValue"in(t=t)?(Fr("REQUEST_TIME"===t.setToServerValue),r=new ys):"appendMissingElements"in t?(n=t.appendMissingElements.values||[],r=new vs(n)):"removeAllFromArray"in t?(n=t.removeAllFromArray.values||[],r=new Is(n)):"increment"in t?r=new As(e,t.increment):Mr(),t=di.G(t.fieldPath),new xs(t,r);var e,n,r}),Fr(!0===e.exists),new Ws(r,s)):t.verify?(t=Yo(i,t.verify),new Zs(t,e)):Mr()}function is(t,e){return{documents:[Xo(t,e.path)]}}function os(t,e){var n={structuredQuery:{}},r=e.path;return null!==e.collectionGroup?(n.parent=Xo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Xo(t,r.F()),n.structuredQuery.from=[{collectionId:r.k()}]),(r=function(t){if(0!==t.length)return 1===(t=t.map(function(t){if("=="===t.op){if(Co(t.value))return{unaryFilter:{field:cs(t.field),op:"IS_NAN"}};if(Vo(t.value))return{unaryFilter:{field:cs(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Co(t.value))return{unaryFilter:{field:cs(t.field),op:"IS_NOT_NAN"}};if(Vo(t.value))return{unaryFilter:{field:cs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:cs(t.field),op:(e=t.op,Mo[e]),value:t.value}};var e})).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(e.filters))&&(n.structuredQuery.where=r),(r=function(t){if(0!==t.length)return t.map(function(t){return{field:cs(t.field),direction:(t=t.dir,qo[t])}})}(e.orderBy))&&(n.structuredQuery.orderBy=r),r=e.limit,null!==(r=t.Ke||_i(r)?r:{value:r})&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=us(e.startAt)),e.endAt&&(n.structuredQuery.endAt=us(e.endAt)),n}function ss(t){var e=$o(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Fr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=hs(t.unaryFilter.field);return Ru.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=hs(t.unaryFilter.field);return Ru.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":return n=hs(t.unaryFilter.field),Ru.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":return t=hs(t.unaryFilter.field),Ru.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Mr()}}(e)]:void 0!==e.fieldFilter?[(n=e,Ru.create(hs(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Mr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):Mr():[];var n}(n.where)),t=[],n.orderBy&&(t=n.orderBy.map(function(t){return new ca(hs((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e})),r=null,n.limit&&(r=_i(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=as(n.startAt));var u=null;return n.endAt&&(u=as(n.endAt)),Tu(vu(e,i,t,o,r,"F",s,u))}function us(t){return{before:t.before,values:t.position}}function as(t){var e=!!t.before,t=t.values||[];return new ta(t,e)}function cs(t){return{fieldPath:t.B()}}function hs(t){return di.G(t.fieldPath)}function ls(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function fs(t,e){return t instanceof As?Lo(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var ps,ds,ys=(n(ms,ds=l=function(){this.He=void 0}),ms),vs=(n(gs,ps=l),gs);function gs(t){var e=this;return(e=ps.call(this)||this).elements=t,e}function ms(){return null!==ds&&ds.apply(this,arguments)||this}function ws(t,e){for(var n=Ss(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return To(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var bs,Is=(n(Es,bs=l),Es);function Es(t){var e=this;return(e=bs.call(this)||this).elements=t,e}function _s(t,e){for(var n=Ss(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!To(t,e)})}(i[r]);return{arrayValue:{values:n}}}var Ts,As=(n(Ns,Ts=l),Ns);function Ns(t,e){var n=this;return(n=Ts.call(this)||this).serializer=t,n.We=e,n}function Ds(t){return xo(t.integerValue||t.doubleValue)}function Ss(t){return Ro(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Os=(Ps.prototype.Je=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].M(t))return!0;return!1},Ps.prototype.isEqual=function(t){return zr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Ps),xs=function(t,e){this.field=t,this.transform=e};function Ps(t){(this.fields=t).sort(di.D)}function ks(t,e){this.version=t,this.transformResults=e}var Ls=(Rs.ze=function(){return new Rs},Rs.exists=function(t){return new Rs(void 0,t)},Rs.updateTime=function(t){return new Rs(t)},Object.defineProperty(Rs.prototype,"je",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Rs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Rs);function Rs(t,e){this.updateTime=t,this.exists=e}function Vs(t,e){return void 0!==t.updateTime?e instanceof cu&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof cu}function Cs(t,e,n,r){return t instanceof js?(o=e,Vs((i=t).Ge,o)?(o=qs(o),new cu(i.key,o,i.value,{Ye:!0})):o):t instanceof Bs?function(t,e){if(!Vs(t.Ge,e))return e;var n=qs(e),e=Ks(t,e);return new cu(t.key,n,e,{Ye:!0})}(t,e):t instanceof Ws?function(t,e,n,r){if(!Vs(t.Ge,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],c=a.transform,h=null;n instanceof cu&&(h=n.field(a.field)),null===h&&r instanceof cu&&(h=r.field(a.field)),o.push((i=h,a=e,h=void 0,c instanceof ys?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(h.fields.__previous_value__=i),{mapValue:h}):c instanceof vs?ws(c,i):c instanceof Is?_s(c,i):(i=Ds(c=fs(h=c,i))+Ds(h.We),Lo(c)&&Lo(h.We)?jo(i):Bo(h.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=Qs(t,i.data(),r);return new cu(t.key,i.version,r,{Ye:!0})}(t,e,r,n):Vs(t.Ge,e)?new hu(t.key,li.min()):e;var i,o}function Us(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ge.isEqual(e.Ge)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||zr(t.fieldTransforms,t.fieldTransforms,function(t,e){return t.field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof vs&&e instanceof vs||t instanceof Is&&e instanceof Is?zr(t.elements,e.elements,To):t instanceof As&&e instanceof As?To(t.We,e.We):t instanceof ys&&e instanceof ys)}))}function qs(t){return t instanceof cu?t.version:li.min()}var Ms,Fs,js=(n(zs,Fs=we=function(){}),zs),Bs=(n(Gs,Ms=we),Gs);function Gs(t,e,n,r){var i=this;return(i=Ms.call(this)||this).key=t,i.data=e,i.Qe=n,i.Ge=r,i.type=1,i}function zs(t,e,n){var r=this;return(r=Fs.call(this)||this).key=t,r.value=e,r.Ge=n,r.type=0,r}function Ks(t,e){return n=t,e=e instanceof cu?e.data():tu.empty(),r=new eu(e),n.Qe.fields.forEach(function(t){var e;t.P()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Xe();var n,r}var Hs,Ws=(n(Js,Hs=we),Js);function Js(t,e){var n=this;return(n=Hs.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ge=Ls.exists(!0),n}function Qs(t,e,n){for(var r=new eu(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Xe()}var Ys,Xs,$s=(n(ou,Xs=we),ou),Zs=(n(iu,Ys=we),iu),tu=(ru.empty=function(){return new ru({mapValue:{}})},ru.prototype.field=function(t){if(t.P())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Uo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.k()])||null},ru.prototype.isEqual=function(t){return To(this.proto,t.proto)},ru),eu=(nu.prototype.set=function(t,e){return this.en(t,e),this},nu.prototype.delete=function(t){return this.en(t,null),this},nu.prototype.en=function(t,e){for(var n=this.tn,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===_o(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.k(),e)},nu.prototype.Xe=function(){var t=this.nn(di.U(),this.tn);return null!=t?new tu(t):this.Ze},nu.prototype.nn=function(r,t){var i=this,o=!1,e=this.Ze.field(r),s=Uo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.nn(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},nu);function nu(t){void 0===t&&(t=tu.empty()),this.Ze=t,this.tn=new Map}function ru(t){this.proto=t}function iu(t,e){var n=this;return(n=Ys.call(this)||this).key=t,n.Ge=e,n.type=4,n}function ou(t,e){var n=this;return(n=Xs.call(this)||this).key=t,n.Ge=e,n.type=3,n}var su,uu,au,cu=(n(yu,au=me=function(t,e){this.key=t,this.version=e}),yu.prototype.field=function(t){return this.sn.field(t)},yu.prototype.data=function(){return this.sn},yu.prototype.rn=function(){return this.sn.proto},yu.prototype.isEqual=function(t){return t instanceof yu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ye===t.Ye&&this.hasCommittedMutations===t.hasCommittedMutations&&this.sn.isEqual(t.sn)},yu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.sn.toString()+", {hasLocalMutations: "+this.Ye+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(yu.prototype,"hasPendingWrites",{get:function(){return this.Ye||this.hasCommittedMutations},enumerable:!1,configurable:!0}),yu),hu=(n(du,uu=me),du.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(du.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),du.prototype.isEqual=function(t){return t instanceof du&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},du),lu=(n(pu,su=me),pu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(pu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),pu.prototype.isEqual=function(t){return t instanceof pu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},pu),fu=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.on=n,this.filters=r,this.limit=i,this.an=o,this.startAt=s,this.endAt=u,this.cn=null,this.un=null,this.startAt,this.endAt};function pu(){return null!==su&&su.apply(this,arguments)||this}function du(t,e,n){var r=this;return(r=uu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function yu(t,e,n,r){var i=this;return(i=au.call(this,t,e)||this).sn=n,i.Ye=!!r.Ye,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function vu(t,e,n,r,i,o,s,u){return new fu(t,e,n,r,i,o,s,u)}function gu(t){return new fu(t)}function mu(t){return!_i(t.limit)&&"F"===t.an}function wu(t){return!_i(t.limit)&&"L"===t.an}function bu(t){return 0<t.on.length?t.on[0].field:null}function Iu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.hn())return r.field}return null}function Eu(t){return null!==t.collectionGroup}function _u(t){var e=t;if(null===e.cn){e.cn=[];var n=Iu(e),t=bu(e);if(null!==n&&null===t)n.W()||e.cn.push(new ca(n)),e.cn.push(new ca(di.j(),"asc"));else{for(var r=!1,i=0,o=e.on;i<o.length;i++){var s=o[i];e.cn.push(s),s.field.W()&&(r=!0)}r||(n=0<e.on.length?e.on[e.on.length-1].dir:"asc",e.cn.push(new ca(di.j(),n)))}}return e.cn}function Tu(t){var e=t;if(!e.un)if("F"===e.an)e.un=Di(e.path,e.collectionGroup,_u(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=_u(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new ca(o.field,s))}var u=e.endAt?new ta(e.endAt.position,!e.endAt.before):null,t=e.startAt?new ta(e.startAt.position,!e.startAt.before):null;e.un=Di(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.un}function Au(t,e,n){return new fu(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Nu(t,e){return new fu(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.an,e,t.endAt)}function Du(t,e){return new fu(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.an,t.startAt,e)}function Su(t,e){return Oi(Tu(t),Tu(e))&&t.an===e.an}function Ou(t){return Si(Tu(t))+"|lt:"+t.an}function xu(t){return"Query(target="+(n=(e=Tu(t)).path.B(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return t.field.B()+" "+t.op+" "+So(t.value)}).join(", ")+"]"),_i(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return t.field.B()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+oa(e.startAt)),e.endAt&&(n+=", endAt: "+oa(e.endAt)),"Target("+n+")")+"; limitType="+t.an+")";var e,n}function Pu(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.Y(e.collectionGroup)&&e.path.M(n):yi.X(e.path)?e.path.isEqual(n):e.path.$(n))&&function(t){for(var e=0,n=i.on;e<n.length;e++){var r=n[e];if(!r.field.W()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||sa(t.startAt,_u(t),n))&&(!t.endAt||!sa(t.endAt,_u(t),n)));var e,n}function ku(u){return function(t,e){for(var n=!1,r=0,i=_u(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i;switch(n=t.field.W()?yi.D(e.key,n.key):(r=t.field,i=n,e=e.field(r),r=i.field(r),null!==e&&null!==r?No(e,r):Mr()),t.dir){case"asc":return n;case"desc":return-1*n;default:return Mr()}}(o,t,e);if(0!==s)return s;n=n||o.field.W()}return 0}}var Lu,Ru=(n(Vu,Lu=function(){}),Vu.create=function(t,e,n){return t.W()?"in"===e||"not-in"===e?this.ln(t,e,n):new Mu(t,e,n):"array-contains"===e?new Yu(t,n):"in"===e?new Xu(t,n):"not-in"===e?new $u(t,n):"array-contains-any"===e?new Zu(t,n):new Vu(t,e,n)},Vu.ln=function(t,e,n){return new("in"===e?Fu:ju)(t,n)},Vu.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this._n(No(t,this.value)):null!==t&&_o(this.value)===_o(t)&&this._n(No(t,this.value))},Vu.prototype._n=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Mr()}},Vu.prototype.hn=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Vu);function Vu(t,e,n){var r=this;return(r=Lu.call(this)||this).field=t,r.op=e,r.value=n,r}var Cu,Uu,qu,Mu=(n(zu,qu=Ru),zu.prototype.matches=function(t){return t=yi.D(t.key,this.key),this._n(t)},zu),Fu=(n(Gu,Uu=Ru),Gu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Gu),ju=(n(Bu,Cu=Ru),Bu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Bu);function Bu(t,e){var n=this;return(n=Cu.call(this,t,"not-in",e)||this).keys=Ku(0,e),n}function Gu(t,e){var n=this;return(n=Uu.call(this,t,"in",e)||this).keys=Ku(0,e),n}function zu(t,e,n){var r=this;return(r=qu.call(this,t,e,n)||this).key=yi.J(n.referenceValue),r}function Ku(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return yi.J(t.referenceValue)})}var Hu,Wu,Ju,Qu,Yu=(n(ia,Qu=Ru),ia.prototype.matches=function(t){return Ro(t=t.field(this.field))&&Ao(t.arrayValue,this.value)},ia),Xu=(n(ra,Ju=Ru),ra.prototype.matches=function(t){return null!==(t=t.field(this.field))&&Ao(this.value.arrayValue,t)},ra),$u=(n(na,Wu=Ru),na.prototype.matches=function(t){return!Ao(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&(null!==(t=t.field(this.field))&&!Ao(this.value.arrayValue,t))},na),Zu=(n(ea,Hu=Ru),ea.prototype.matches=function(t){var e=this;return!(!Ro(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return Ao(e.value.arrayValue,t)})},ea),ta=function(t,e){this.position=t,this.before=e};function ea(t,e){return Hu.call(this,t,"array-contains-any",e)||this}function na(t,e){return Wu.call(this,t,"not-in",e)||this}function ra(t,e){return Ju.call(this,t,"in",e)||this}function ia(t,e){return Qu.call(this,t,"array-contains",e)||this}function oa(t){return(t.before?"b":"a")+":"+t.position.map(So).join(",")}function sa(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.W()?yi.D(yi.J(s.referenceValue),n.key):No(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function ua(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!To(t.position[n],e.position[n]))return!1;return!0}var aa,ca=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e},ha=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})},la=(ba.prototype.reset=function(){this.In=0},ba.prototype.Rn=function(){this.In=this.Tn},ba.prototype.Pn=function(t){var e=this;this.cancel();var n=Math.floor(this.In+this.gn()),r=Math.max(0,Date.now()-this.An),i=Math.max(0,n-r);0<i&&Vr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.In+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.mn=this.fn.Vn(this.dn,i,function(){return e.An=Date.now(),t()}),this.In*=this.En,this.In<this.wn&&(this.In=this.wn),this.In>this.Tn&&(this.In=this.Tn)},ba.prototype.yn=function(){null!==this.mn&&(this.mn.pn(),this.mn=null)},ba.prototype.cancel=function(){null!==this.mn&&(this.mn.cancel(),this.mn=null)},ba.prototype.gn=function(){return(Math.random()-.5)*this.In},ba),fa=(wa.prototype.catch=function(t){return this.next(void 0,t)},wa.prototype.next=function(r,i){var o=this;return this.Dn&&Mr(),this.Dn=!0,this.Sn?this.error?this.Cn(i,this.error):this.Nn(r,this.result):new wa(function(e,n){o.bn=function(t){o.Nn(r,t).next(e,n)},o.vn=function(t){o.Cn(i,t).next(e,n)}})},wa.prototype.xn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},wa.prototype.Fn=function(t){try{var e=t();return e instanceof wa?e:wa.resolve(e)}catch(t){return wa.reject(t)}},wa.prototype.Nn=function(t,e){return t?this.Fn(function(){return t(e)}):wa.resolve(e)},wa.prototype.Cn=function(t,e){return t?this.Fn(function(){return t(e)}):wa.reject(e)},wa.resolve=function(n){return new wa(function(t,e){t(n)})},wa.reject=function(n){return new wa(function(t,e){e(n)})},wa.On=function(t){return new wa(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},wa.kn=function(t){for(var n=wa.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?wa.resolve(t):e()})}(r[e]);return n},wa.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.On(i)},wa),pa=(ma.delete=function(t){return Vr("SimpleDb","Removing database:",t),Na(window.indexedDB.deleteDatabase(t)).xn()},ma.Ln=function(){if("undefined"==typeof indexedDB)return!1;if(ma.Bn())return!0;var t=d(),e=0<(n=ma.$n(t))&&n<10,n=0<(n=ma.qn(t))&&n<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||e||n)},ma.Bn=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Un)},ma.Kn=function(t,e){return t.store(e)},ma.$n=function(t){return t=(t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i))?t[1].split("_").slice(0,2).join("."):"-1",Number(t)},ma.qn=function(t){return t=(t=t.match(/Android ([\d.]+)/i))?t[1].split(".").slice(0,2).join("."):"-1",Number(t)},ma.prototype.Qn=function(o){return y(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(Vr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(t){t=t.target.result,e(t)},r.onblocked=function(){n(new ya(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){"VersionError"===(t=t.target.error).name?n(new xr(Or.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new ya(o,t))},r.onupgradeneeded=function(t){Vr("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;i.Mn.createOrUpgrade(e,r.transaction,t.oldVersion,i.version).next(function(){Vr("SimpleDb","Database upgrade to version "+i.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.Wn&&(this.db.onversionchange=function(t){return i.Wn(t)}),this.db)]}})})},ma.prototype.jn=function(e){this.Wn=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},ma.prototype.runTransaction=function(u,n,a,c){return y(this,void 0,void 0,function(){var i,o,s,e;return v(this,function(t){switch(t.label){case 0:i="readonly"===n,o=0,e=function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.Qn(u)];case 2:return s.db=t.sent(),e=Ea.open(s.db,u,i?"readonly":"readwrite",a),n=c(e).catch(function(t){return e.abort(t),fa.reject(t)}).xn(),r={},n.catch(function(){}),[4,e.Gn];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return n=t.sent(),r="FirebaseError"!==n.name&&o<3,Vr("SimpleDb","Transaction failed with error:",n.message,"Retrying:",r),s.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},s=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(e=t.sent()))return[2,e.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},ma.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},ma),da=(Object.defineProperty(ga.prototype,"Sn",{get:function(){return this.Hn},enumerable:!1,configurable:!0}),Object.defineProperty(ga.prototype,"Yn",{get:function(){return this.Jn},enumerable:!1,configurable:!0}),Object.defineProperty(ga.prototype,"cursor",{set:function(t){this.zn=t},enumerable:!1,configurable:!0}),ga.prototype.done=function(){this.Hn=!0},ga.prototype.Xn=function(t){this.Jn=t},ga.prototype.delete=function(){return Na(this.zn.delete())},ga),ya=(n(va,aa=xr),va);function va(t,e){var n=this;return(n=aa.call(this,Or.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function ga(t){this.zn=t,this.Hn=!1,this.Jn=null}function ma(t,e,n){this.name=t,this.version=e,this.Mn=n,12.2===ma.$n(d())&&Cr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function wa(t){var e=this;this.bn=null,this.vn=null,this.result=void 0,this.error=void 0,this.Sn=!1,this.Dn=!1,t(function(t){e.Sn=!0,e.result=t,e.bn&&e.bn(t)},function(t){e.Sn=!0,e.error=t,e.vn&&e.vn(t)})}function ba(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.fn=t,this.dn=e,this.wn=n,this.En=r,this.Tn=i,this.In=0,this.mn=null,this.An=Date.now(),this.reset()}function Ia(t){return"IndexedDbTransactionError"===t.name}var Ea=(Aa.open=function(t,e,n,r){try{return new Aa(e,t.transaction(r,n))}catch(t){throw new ya(e,t)}},Object.defineProperty(Aa.prototype,"Gn",{get:function(){return this.Zn.promise},enumerable:!1,configurable:!0}),Aa.prototype.abort=function(t){t&&this.Zn.reject(t),this.aborted||(Vr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Aa.prototype.store=function(t){return t=this.transaction.objectStore(t),new _a(t)},Aa),_a=(Ta.prototype.put=function(t,e){return Na(t=void 0!==e?(Vr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Vr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},Ta.prototype.add=function(t){return Vr("SimpleDb","ADD",this.store.name,t,t),Na(this.store.add(t))},Ta.prototype.get=function(e){var n=this;return Na(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Vr("SimpleDb","GET",n.store.name,e,t),t})},Ta.prototype.delete=function(t){return Vr("SimpleDb","DELETE",this.store.name,t),Na(this.store.delete(t))},Ta.prototype.count=function(){return Vr("SimpleDb","COUNT",this.store.name),Na(this.store.count())},Ta.prototype.ts=function(t,e){var e=this.cursor(this.options(t,e)),n=[];return this.es(e,function(t,e){n.push(e)}).next(function(){return n})},Ta.prototype.ns=function(t,e){return Vr("SimpleDb","DELETE ALL",this.store.name),(e=this.options(t,e)).ss=!1,e=this.cursor(e),this.es(e,function(t,e,n){return n.delete()})},Ta.prototype.rs=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.es(n,e)},Ta.prototype.os=function(r){var t=this.cursor({});return new fa(function(n,e){t.onerror=function(t){t=Sa(t.target.error),e(t)},t.onsuccess=function(t){var e=t.target.result;e?r(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},Ta.prototype.es=function(t,i){var o=[];return new fa(function(r,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n=t.target.result;n?(e=new da(n),(t=i(n.primaryKey,n.value,e))instanceof fa&&(t=t.catch(function(t){return e.done(),fa.reject(t)}),o.push(t)),e.Sn?r():null===e.Yn?n.continue():n.continue(e.Yn)):r()}}).next(function(){return fa.On(o)})},Ta.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},Ta.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.ss?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},Ta);function Ta(t){this.store=t}function Aa(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.Zn=new ha,this.transaction.oncomplete=function(){n.Zn.resolve()},this.transaction.onabort=function(){t.error?n.Zn.reject(new ya(e,t.error)):n.Zn.resolve()},this.transaction.onerror=function(t){t=Sa(t.target.error),n.Zn.reject(new ya(e,t))}}function Na(t){return new fa(function(e,n){t.onsuccess=function(t){t=t.target.result,e(t)},t.onerror=function(t){t=Sa(t.target.error),n(t)}})}var Da=!1;function Sa(t){var e=pa.$n(d());if(12.2<=e&&e<13&&(e="An internal error was encountered in the Indexed Database server",0<=t.message.indexOf(e))){var n=new xr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Da||(Da=!0,setTimeout(function(){throw n},0)),n}return t}function Oa(){return"undefined"!=typeof window?window:null}function xa(){return"undefined"!=typeof document?document:null}var Pa=(Ra._s=function(t,e,n,r,i){return(i=new Ra(t,e,Date.now()+n,r,i)).start(n),i},Ra.prototype.start=function(t){var e=this;this.fs=setTimeout(function(){return e.ds()},t)},Ra.prototype.pn=function(){return this.ds()},Ra.prototype.cancel=function(t){null!==this.fs&&(this.clearTimeout(),this.ls.reject(new xr(Or.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Ra.prototype.ds=function(){var e=this;this.cs.ws(function(){return null!==e.fs?(e.clearTimeout(),e.op().then(function(t){return e.ls.resolve(t)})):Promise.resolve()})},Ra.prototype.clearTimeout=function(){null!==this.fs&&(this.hs(this),clearTimeout(this.fs),this.fs=null)},Ra),ka=(Object.defineProperty(La.prototype,"ps",{get:function(){return this.Is},enumerable:!1,configurable:!0}),La.prototype.ws=function(t){this.enqueue(t)},La.prototype.bs=function(t){this.vs(),this.Ss(t)},La.prototype.Ds=function(){var t;this.Is||(this.Is=!0,(t=xa())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.ys))},La.prototype.enqueue=function(t){return this.vs(),this.Is?new Promise(function(t){}):this.Ss(t)},La.prototype.Cs=function(t){var e=this;this.ws(function(){return e.Ts.push(t),e.Ns()})},La.prototype.Ns=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Ts.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Ts[0]()];case 2:return t.sent(),this.Ts.shift(),this.Vs.reset(),[3,4];case 3:if(!Ia(e=t.sent()))throw e;return Vr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Ts.length&&this.Vs.Pn(function(){return n.Ns()}),t.label=5;case 5:return[2]}})})},La.prototype.Ss=function(t){var r=this,e=this.Es.then(function(){return r.Ps=!0,t().catch(function(t){throw r.Rs=t,r.Ps=!1,Cr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Ps=!1,t})});return this.Es=e},La.prototype.Vn=function(t,e,n){var r=this;return this.vs(),-1<this.gs.indexOf(t)&&(e=0),n=Pa._s(this,t,e,n,function(t){return r.xs(t)}),this.As.push(n),n},La.prototype.vs=function(){this.Rs&&Mr()},La.prototype.Fs=function(){},La.prototype.Os=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Es];case 1:t.sent(),t.label=2;case 2:if(e!==this.Es)return[3,0];t.label=3;case 3:return[2]}})})},La.prototype.ks=function(t){for(var e=0,n=this.As;e<n.length;e++)if(n[e].dn===t)return!0;return!1},La.prototype.Ms=function(r){var i=this;return this.Os().then(function(){i.As.sort(function(t,e){return t.us-e.us});for(var t=0,e=i.As;t<e.length;t++){var n=e[t];if(n.pn(),"all"!==r&&n.dn===r)break}return i.Os()})},La.prototype.$s=function(t){this.gs.push(t)},La.prototype.xs=function(t){t=this.As.indexOf(t),this.As.splice(t,1)},La);function La(){var e=this;this.Es=Promise.resolve(),this.Ts=[],this.Is=!1,this.As=[],this.Rs=null,this.Ps=!1,this.gs=[],this.Vs=new la(this,"async_queue_retry"),this.ys=function(){var t=xa();t&&Vr("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Vs.yn()};var t=xa();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.ys)}function Ra(t,e,n,r,i){this.cs=t,this.dn=e,this.us=n,this.op=r,this.hs=i,this.ls=new ha,this.then=this.ls.promise.then.bind(this.ls.promise),this.ls.promise.catch(function(t){})}function Va(t,e){if(Cr("AsyncQueue",e+": "+t),Ia(t))return new xr(Or.UNAVAILABLE,e+": "+t);throw t}function Ca(){this.Bs=new ci(Ou,Su),this.onlineState="Unknown",this.qs=new Set}var Ua=function(){this.Ls=void 0,this.listeners=[]};function qa(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.Bs.get(n))||(r=!0,i=new Ua),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Us(n)];case 2:return o.Ls=t.sent(),[3,4];case 3:return o=Va(o=t.sent(),"Initialization of query '"+xu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.Bs.set(n,i),i.listeners.push(u),u.Ks(e.onlineState),i.Ls&&u.Qs(i.Ls)&&Fa(e),[2]}})})}function Ma(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.Bs.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.Bs.delete(n),e.Ws(n))]:[2]})})}function Fa(t){t.qs.forEach(function(t){t.next()})}var ja=(za.prototype.Qs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new no(t.query,t.docs,t.Kt,e,t.Qt,t.fromCache,t.Wt,!0)}var o=!1;return this.Gs?this.Hs(t)&&(this.js.next(t),o=!0):this.Js(t,this.onlineState)&&(this.Ys(t),o=!0),this.zs=t,o},za.prototype.onError=function(t){this.js.error(t)},za.prototype.Ks=function(t){this.onlineState=t;var e=!1;return this.zs&&!this.Gs&&this.Js(this.zs,t)&&(this.Ys(this.zs),e=!0),e},za.prototype.Js=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Xs&&n||t.docs.P()&&"Offline"!==e)},za.prototype.Hs=function(t){if(0<t.docChanges.length)return!0;var e=this.zs&&this.zs.hasPendingWrites!==t.hasPendingWrites;return!(!t.Wt&&!e)&&!0===this.options.includeMetadataChanges},za.prototype.Ys=function(t){t=no.Gt(t.query,t.docs,t.Qt,t.fromCache),this.Gs=!0,this.js.next(t)},za),Ba=(Ga.prototype.Zs=function(){return null!=this.uid},Ga.prototype.ti=function(){return this.Zs()?"uid:"+this.uid:"anonymous-user"},Ga.prototype.isEqual=function(t){return t.uid===this.uid},Ga);function Ga(t){this.uid=t}function za(t,e,n){this.query=t,this.js=e,this.Gs=!1,this.zs=null,this.onlineState="Unknown",this.options=n||{}}function Ka(t,e){this.user=e,this.type="OAuth",this.si={},this.si.Authorization="Bearer "+t}Ba.UNAUTHENTICATED=new Ba(null),Ba.ei=new Ba("google-credentials-uid"),Ba.ni=new Ba("first-party-uid");var Ha=(fc.prototype.getToken=function(){return Promise.resolve(null)},fc.prototype.ri=function(){},fc.prototype.oi=function(t){(this.ii=t)(Ba.UNAUTHENTICATED)},fc.prototype.ai=function(){this.ii=null},fc),Wa=(lc.prototype.getToken=function(){var e=this,n=this.hi,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.hi!==n?(Vr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Fr("string"==typeof t.accessToken),new Ka(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},lc.prototype.ri=function(){this.forceRefresh=!0},lc.prototype.oi=function(t){this.ii=t,this.ui&&t(this.currentUser)},lc.prototype.ai=function(){this.auth&&this.auth.removeAuthTokenListener(this.ci),this.ci=null,this.ii=null},lc.prototype.li=function(){var t=this.auth&&this.auth.getUid();return Fr(null===t||"string"==typeof t),new Ba(t)},lc),Ja=(Object.defineProperty(hc.prototype,"si",{get:function(){var t={"X-Goog-AuthUser":this.fi},e=this._i.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),hc),Qa=(cc.prototype.getToken=function(){return Promise.resolve(new Ja(this._i,this.fi))},cc.prototype.oi=function(t){t(Ba.ni)},cc.prototype.ai=function(){},cc.prototype.ri=function(){},cc),Ya=(ac.prototype.wi=function(t,e,n){for(var r,i,o,s,u,a=n.Ei,c=0;c<this.mutations.length;c++){var h=this.mutations[c];h.key.isEqual(t)&&(r=h,i=e,o=a[c],h=u=s=void 0,e=r instanceof js?new cu(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof Bs?(u=i,h=o,Vs((s=r).Ge,u)?(u=Ks(s,u),new cu(s.key,h.version,u,{hasCommittedMutations:!0})):new lu(s.key,h.version)):r instanceof Ws?function(t,e,n){if(Fr(null!=n.transformResults),!Vs(t.Ge,e))return new lu(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Fr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof cu&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof vs?ws(o,s):o instanceof Is?_s(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=Qs(t,r.data(),e);return new cu(t.key,n,e,{hasCommittedMutations:!0})}(r,i,o):new hu(r.key,o.version,{hasCommittedMutations:!0}))}return e},ac.prototype.Ti=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Cs(i,e,e,this.di))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Cs(a,e,o,this.di))}return e},ac.prototype.Ii=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.Ti(t.key,n.get(t.key));e&&(i=i.ot(t.key,e))}),i},ac.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},$i())},ac.prototype.isEqual=function(t){return this.batchId===t.batchId&&zr(this.mutations,t.mutations,Us)&&zr(this.baseMutations,t.baseMutations,Us)},ac),Xa=(uc.from=function(t,e,n){Fr(t.mutations.length===n.length);for(var r=Yi,i=t.mutations,o=0;o<i.length;o++)r=r.ot(i[o].key,n[o].version);return new uc(t,e,n,r)},uc),l=(Object.defineProperty(sc.prototype,"readTime",{get:function(){return this.gi},set:function(t){this.gi=t},enumerable:!1,configurable:!0}),sc.prototype.Vi=function(t,e){this.yi(),this.readTime=e,this.Ri.set(t.key,t)},sc.prototype.pi=function(t,e){this.yi(),e&&(this.readTime=e),this.Ri.set(t,null)},sc.prototype.bi=function(t,e){this.yi();var n=this.Ri.get(e);return void 0!==n?fa.resolve(n):this.vi(t,e)},sc.prototype.getEntries=function(t,e){return this.Si(t,e)},sc.prototype.apply=function(t){return this.yi(),this.Pi=!0,this.Di(t)},sc.prototype.yi=function(){},sc),$a="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",we=(oc.prototype.Ni=function(t){this.Ci.push(t)},oc.prototype.xi=function(){this.Ci.forEach(function(t){return t()})},oc),Za=(ic.prototype.Mi=function(e,n){var r=this;return this.Oi.$i(e,n).next(function(t){return r.Li(e,n,t)})},ic.prototype.Li=function(t,r,i){return this.Fi.bi(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].Ti(r,t);return t})},ic.prototype.Bi=function(t,e,i){var o=Hi;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].Ti(t,e);o=o.ot(t,e)}),o},ic.prototype.qi=function(e,t){var n=this;return this.Fi.getEntries(e,t).next(function(t){return n.Ui(e,t)})},ic.prototype.Ui=function(e,r){var i=this;return this.Oi.Ki(e,r).next(function(t){var t=i.Bi(e,r,t),n=Hi;return t.forEach(function(t,e){e=e||new hu(t,li.min()),n=n.ot(t,e)}),n})},ic.prototype.Qi=function(t,e,n){return r=e,yi.X(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Wi(t,e.path):Eu(e)?this.ji(t,e,n):this.Gi(t,e,n);var r},ic.prototype.Wi=function(t,e){return this.Mi(t,new yi(e)).next(function(t){var e=Qi;return t instanceof cu&&(e=e.ot(t.key,t)),e})},ic.prototype.ji=function(n,r,i){var o=this,s=r.collectionGroup,u=Qi;return this.ki.zi(n,s).next(function(t){return fa.forEach(t,function(t){var e=(e=r,t=t.child(s),new fu(t,null,e.on.slice(),e.filters.slice(),e.limit,e.an,e.startAt,e.endAt));return o.Gi(n,e,i).next(function(t){t.forEach(function(t,e){u=u.ot(t,e)})})}).next(function(){return u})})},ic.prototype.Gi=function(e,n,t){var a,c,r=this;return this.Fi.Qi(e,n,t).next(function(t){return a=t,r.Oi.Hi(e,n)}).next(function(t){return c=t,r.Ji(e,c,a).next(function(t){a=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,s=Cs(s,s=a.get(u),s,r.di);a=s instanceof cu?a.ot(u,s):a.remove(u)}})}).next(function(){return a.forEach(function(t,e){Pu(n,e)||(a=a.remove(t))}),a})},ic.prototype.Ji=function(t,e,n){for(var r=$i(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Bs&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.Fi.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof cu&&(c=c.ot(t,e))}),c})},ic),tc=(rc.Zi=function(t,e){for(var n=$i(),r=$i(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new rc(t,e.fromCache,n,r)},rc),ec=(nc.prototype.er=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},nc.prototype.next=function(){var t=++this.previousValue;return this.nr&&this.nr(t),t},nc);function nc(t,e){var n=this;this.previousValue=t,e&&(e.tr=function(t){return n.er(t)},this.nr=function(t){return e.sr(t)})}function rc(t,e,n,r){this.targetId=t,this.fromCache=e,this.Yi=n,this.Xi=r}function ic(t,e,n){this.Fi=t,this.Oi=e,this.ki=n}function oc(){this.Ci=[]}function sc(){this.Ri=new ci(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Pi=!1}function uc(t,e,n,r){this.batch=t,this.mi=e,this.Ei=n,this.Ai=r}function ac(t,e,n,r){this.batchId=t,this.di=e,this.baseMutations=n,this.mutations=r}function cc(t,e){this._i=t,this.fi=e}function hc(t,e){this._i=t,this.fi=e,this.type="FirstParty",this.user=Ba.ni}function lc(t){var e=this;this.ci=null,this.currentUser=Ba.UNAUTHENTICATED,this.ui=!1,this.hi=0,this.ii=null,this.forceRefresh=!1,this.ci=function(){e.hi++,e.currentUser=e.li(),e.ui=!0,e.ii&&e.ii(e.currentUser)},this.hi=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.ci):(this.ci(null),t.get().then(function(t){e.auth=t,e.ci&&e.auth.addAuthTokenListener(e.ci)},function(){}))}function fc(){this.ii=null}function pc(t,e){var n=t[0],r=t[1],t=e[0],e=e[1];return 0===(t=Gr(n,t))?Gr(r,e):t}ec.ir=-1;var dc=(mc.prototype.cr=function(){return++this.ar},mc.prototype.ur=function(t){var e=[t,this.cr()];this.buffer.size<this.rr?this.buffer=this.buffer.add(e):pc(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(mc.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),mc),yc={hr:!1,lr:0,_r:0,dr:0},vc=(gc.Ir=function(t){return new gc(t,gc.mr,gc.Ar)},gc);function gc(t,e,n){this.wr=t,this.Er=e,this.Tr=n}function mc(t){this.rr=t,this.buffer=new zi(pc),this.ar=0}vc.mr=10,vc.Ar=1e3,vc.Rr=new vc(41943040,vc.mr,vc.Ar),vc.Pr=new vc(-1,0,0);var wc=(Ec.prototype.start=function(t){-1!==this.gr.params.wr&&this.pr(t)},Ec.prototype.stop=function(){this.yr&&(this.yr.cancel(),this.yr=null)},Object.defineProperty(Ec.prototype,"br",{get:function(){return null!==this.yr},enumerable:!1,configurable:!0}),Ec.prototype.pr=function(n){var t=this,e=this.Vr?3e5:6e4;Vr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.yr=this.cs.Vn("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.yr=null,this.Vr=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.vr(this.gr)];case 2:return t.sent(),[3,7];case 3:return Ia(e=t.sent())?(Vr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Xh(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.pr(n)];case 8:return t.sent(),[2]}})})})},Ec),bc=(Ic.prototype.Dr=function(t,e){return this.Sr.Cr(t).next(function(t){return Math.floor(e/100*t)})},Ic.prototype.Nr=function(t,e){var n=this;if(0===e)return fa.resolve(ec.ir);var r=new dc(e);return this.Sr.Ce(t,function(t){return r.ur(t.sequenceNumber)}).next(function(){return n.Sr.Fr(t,function(t){return r.ur(t)})}).next(function(){return r.maxValue})},Ic.prototype.Or=function(t,e,n){return this.Sr.Or(t,e,n)},Ic.prototype.kr=function(t,e){return this.Sr.kr(t,e)},Ic.prototype.Mr=function(e,n){var r=this;return-1===this.params.wr?(Vr("LruGarbageCollector","Garbage collection skipped; disabled"),fa.resolve(yc)):this.$r(e).next(function(t){return t<r.params.wr?(Vr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.wr),yc):r.Lr(e,n)})},Ic.prototype.$r=function(t){return this.Sr.$r(t)},Ic.prototype.Lr=function(e,n){var r,i,o,s,u,a,c,h=this,l=Date.now();return this.Dr(e,this.params.Er).next(function(t){return i=t>h.params.Tr?(Vr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.Tr+" from "+t),h.params.Tr):t,s=Date.now(),h.Nr(e,i)}).next(function(t){return r=t,u=Date.now(),h.Or(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.kr(e,r)}).next(function(t){return c=Date.now(),Rr()<=f.DEBUG&&Vr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-l)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-l)+"ms"),fa.resolve({hr:!0,lr:i,_r:o,dr:t})})},Ic);function Ic(t,e){this.Sr=t,this.params=e}function Ec(t,e){this.gr=t,this.cs=e,this.Vr=!1,this.yr=null}function _c(t){for(var o="",e=0;e<t.length;e++)0<o.length&&(o=Tc(o)),o=function(t){for(var e=o,n=t.length,r=0;r<n;r++){var i=t.charAt(r);switch(i){case"\0":e+="";break;case"":e+="";break;default:e+=i}}return e}(t.get(e));return Tc(o)}function Tc(t){return t+""}function Ac(t){var e=t.length;if(Fr(2<=e),2===e)return Fr(""===t.charAt(0)&&""===t.charAt(1)),fi.U();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&Mr(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Mr()}o=s+2}return new fi(r)}var Nc=function(t){this.Br=t};function Dc(t,e){if(e.document)return n=t.Br,r=e.document,i=!!e.hasCommittedMutations,t=Yo(n,r.name),n=Ho(r.updateTime),r=new tu({mapValue:{fields:r.fields}}),new cu(t,n,r,{hasCommittedMutations:!!i});var n,r;if(e.noDocument){var i=yi.Z(e.noDocument.path),o=kc(e.noDocument.readTime);return new hu(i,o,{hasCommittedMutations:!!e.hasCommittedMutations})}return e.unknownDocument?(o=yi.Z(e.unknownDocument.path),e=kc(e.unknownDocument.version),new lu(o,e)):Mr()}function Sc(t,e,n){var r=Oc(n),n=e.key.path.F().L();if(e instanceof cu){var i={name:Qo(i=t.Br,(o=e).key),fields:o.rn().mapValue.fields,updateTime:zo(i,o.version.v())},o=e.hasCommittedMutations;return new fh(null,null,i,o,r,n)}if(e instanceof hu){var i=e.key.path.L(),o=Pc(e.version),s=e.hasCommittedMutations;return new fh(null,new hh(i,o),null,s,r,n)}return e instanceof lu?(s=e.key.path.L(),e=Pc(e.version),new fh(new lh(s,e),null,null,!0,r,n)):Mr()}function Oc(t){return[(t=t.v()).seconds,t.nanoseconds]}function xc(t){return t=new hi(t[0],t[1]),li.V(t)}function Pc(t){return t=t.v(),new eh(t.seconds,t.nanoseconds)}function kc(t){return t=new hi(t.seconds,t.nanoseconds),li.V(t)}function Lc(e,t){var n=(t.baseMutations||[]).map(function(t){return rs(e.Br,t)}),r=t.mutations.map(function(t){return rs(e.Br,t)}),i=hi.fromMillis(t.localWriteTimeMs);return new Ya(t.batchId,i,n,r)}function Rc(t){var e=kc(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?kc(t.lastLimboFreeSnapshotVersion):li.min(),r=void 0!==t.query.documents?(Fr(1===(r=t.query).documents.length),Tu(gu($o(r.documents[0])))):ss(t.query);return new Li(r,t.targetId,0,t.lastListenSequenceNumber,e,n,Hr.fromBase64String(t.resumeToken))}function Vc(t,e){var n=Pc(e.nt),r=Pc(e.lastLimboFreeSnapshotVersion),i=(xi(e.target)?is:os)(t.Br,e.target),t=e.resumeToken.toBase64();return new dh(e.targetId,Si(e.target),n,t,e.sequenceNumber,r,i)}var Cc=(Uc.Kr=function(t,e,n,r){return Fr(""!==t.uid),new Uc(t.Zs()?t.uid:"",e,n,r)},Uc.prototype.Qr=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Fc(t).rs({index:uh.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},Uc.prototype.Wr=function(d,y,v,g){var m=this,w=jc(d),b=Fc(d);return b.add({}).next(function(t){Fr("number"==typeof t);for(var e,n,r,i,o,s=new Ya(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return ns(e.Br,t)}),o=r.mutations.map(function(t){return ns(e.Br,t)}),new uh(n,r.batchId,r.di.toMillis(),i,o)),a=[],c=new zi(function(t,e){return Gr(t.B(),e.B())}),h=0,l=g;h<l.length;h++){var f=l[h],p=ah.key(m.userId,f.key.path,t),c=c.add(f.key.path.F());a.push(b.put(u)),a.push(w.put(p,ah.PLACEHOLDER))}return c.forEach(function(t){a.push(m.ki.jr(d,t))}),d.Ni(function(){m.Ur[t]=s.keys()}),fa.On(a).next(function(){return s})})},Uc.prototype.Gr=function(t,e){var n=this;return Fc(t).get(e).next(function(t){return t?(Fr(t.userId===n.userId),Lc(n.serializer,t)):null})},Uc.prototype.zr=function(t,e){var n=this;return this.Ur[e]?fa.resolve(this.Ur[e]):this.Gr(t,e).next(function(t){return t?(t=t.keys(),n.Ur[e]=t):null})},Uc.prototype.Hr=function(t,e){var r=this,i=e+1,e=IDBKeyRange.lowerBound([this.userId,i]),o=null;return Fc(t).rs({index:uh.userMutationsIndex,range:e},function(t,e,n){e.userId===r.userId&&(Fr(e.batchId>=i),o=Lc(r.serializer,e)),n.done()}).next(function(){return o})},Uc.prototype.Jr=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Fc(t).rs({index:uh.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},Uc.prototype.Yr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Fc(t).ts(uh.userMutationsIndex,n).next(function(t){return t.map(function(t){return Lc(e.serializer,t)})})},Uc.prototype.$i=function(o,s){var u=this,t=ah.prefixForPath(this.userId,s.path),t=IDBKeyRange.lowerBound(t),a=[];return jc(o).rs({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Ac(i);if(r===u.userId&&s.path.isEqual(i))return Fc(o).get(t).next(function(t){if(!t)throw Mr();Fr(t.userId===u.userId),a.push(Lc(u.serializer,t))});n.done()}).next(function(){return a})},Uc.prototype.Ki=function(e,t){var s=this,u=new zi(Gr),n=[];return t.forEach(function(o){var t=ah.prefixForPath(s.userId,o.path),t=IDBKeyRange.lowerBound(t),t=jc(e).rs({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Ac(i);r===s.userId&&o.path.isEqual(i)?u=u.add(t):n.done()});n.push(t)}),fa.On(n).next(function(){return s.Xr(e,u)})},Uc.prototype.Hi=function(t,e){var o=this,s=e.path,u=s.length+1,e=ah.prefixForPath(this.userId,s),e=IDBKeyRange.lowerBound(e),a=new zi(Gr);return jc(t).rs({range:e},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Ac(i);r===o.userId&&s.M(i)?i.length===u&&(a=a.add(t)):n.done()}).next(function(){return o.Xr(t,a)})},Uc.prototype.Xr=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(Fc(e).get(t).next(function(t){if(null===t)throw Mr();Fr(t.userId===n.userId),r.push(Lc(n.serializer,t))}))}),fa.On(i).next(function(){return r})},Uc.prototype.Zr=function(e,n){var r=this;return Mc(e.eo,this.userId,n).next(function(t){return e.Ni(function(){r.no(n.batchId)}),fa.forEach(t,function(t){return r.qr.so(e,t)})})},Uc.prototype.no=function(t){delete this.Ur[t]},Uc.prototype.io=function(e){var i=this;return this.Qr(e).next(function(t){if(!t)return fa.resolve();var t=IDBKeyRange.lowerBound(ah.prefixForUser(i.userId)),r=[];return jc(e).rs({range:t},function(t,e,n){t[0]===i.userId?(t=Ac(t[1]),r.push(t)):n.done()}).next(function(){Fr(0===r.length)})})},Uc.prototype.ro=function(t,e){return qc(t,this.userId,e)},Uc.prototype.oo=function(t){var e=this;return Bc(t).get(this.userId).next(function(t){return t||new sh(e.userId,-1,"")})},Uc);function Uc(t,e,n,r){this.userId=t,this.serializer=e,this.ki=n,this.qr=r,this.Ur={}}function qc(t,o,e){var s=(e=ah.prefixForPath(o,e.path))[1],e=IDBKeyRange.lowerBound(e),u=!1;return jc(t).rs({range:e,ss:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function Mc(t,e,n){var r=t.store(uh.store),i=t.store(ah.store),o=[],t=IDBKeyRange.only(n.batchId),s=0,t=r.rs({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){Fr(1===s)}));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],l=ah.key(e,h.key.path,n.batchId);o.push(i.delete(l)),u.push(h.key)}return fa.On(o).next(function(){return u})}function Fc(t){return Rh.Kn(t,uh.store)}function jc(t){return Rh.Kn(t,ah.store)}function Bc(t){return Rh.Kn(t,sh.store)}var Gc,zc=(Wc.prototype.Vi=function(t,e,n){return Qc(t).put(Yc(e),n)},Wc.prototype.pi=function(t,e){return t=Qc(t),e=Yc(e),t.delete(e)},Wc.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.ao(e,t)})},Wc.prototype.bi=function(t,e){var n=this;return Qc(t).get(Yc(e)).next(function(t){return n.co(t)})},Wc.prototype.uo=function(t,e){var n=this;return Qc(t).get(Yc(e)).next(function(t){var e=n.co(t);return e?{ho:e,size:Xc(t)}:null})},Wc.prototype.getEntries=function(t,e){var n=this,r=Hi;return this.lo(t,e,function(t,e){e=n.co(e),r=r.ot(t,e)}).next(function(){return r})},Wc.prototype._o=function(t,e){var r=this,i=Hi,o=new Ui(yi.D);return this.lo(t,e,function(t,e){var n=r.co(e);o=n?(i=i.ot(t,n),o.ot(t,Xc(e))):(i=i.ot(t,null),o.ot(t,0))}).next(function(){return{fo:i,do:o}})},Wc.prototype.lo=function(t,e,i){if(e.P())return fa.resolve();var n=IDBKeyRange.bound(e.first().path.L(),e.last().path.L()),o=e._t(),s=o.It();return Qc(t).rs({range:n},function(t,e,n){for(var r=yi.Z(t);s&&yi.D(s,r)<0;)i(s,null),s=o.It();s&&s.isEqual(r)&&(i(s,e),s=o.At()?o.It():null),s?n.Xn(s.path.L()):n.done()}).next(function(){for(;s;)i(s,null),s=o.At()?o.It():null})},Wc.prototype.Qi=function(t,r,e){var n,i=this,o=Qi,s=r.path.length+1,u={};return e.isEqual(li.min())?(n=r.path.L(),u.range=IDBKeyRange.lowerBound(n)):(n=r.path.L(),e=Oc(e),u.range=IDBKeyRange.lowerBound([n,e],!0),u.index=fh.collectionReadTimeIndex),Qc(t).rs(u,function(t,e,n){t.length===s&&(e=Dc(i.serializer,e),r.path.M(e.key.path)?e instanceof cu&&Pu(r,e)&&(o=o.ot(e.key,e)):n.done())}).next(function(){return o})},Wc.prototype.wo=function(t){return new Kc(this,!!t&&t.Eo)},Wc.prototype.To=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},Wc.prototype.getMetadata=function(t){return Jc(t).get(ph.key).next(function(t){return Fr(!!t),t})},Wc.prototype.ao=function(t,e){return Jc(t).put(ph.key,e)},Wc.prototype.co=function(t){return!t||(t=Dc(this.serializer,t))instanceof hu&&t.version.isEqual(li.min())?null:t},Wc),Kc=(n(Hc,Gc=l),Hc.prototype.Di=function(i){var o=this,s=[],u=0,a=new zi(function(t,e){return Gr(t.B(),e.B())});return this.Ri.forEach(function(t,e){var n,r=o.mo.get(t);e?(n=Sc(o.Io.serializer,e,o.readTime),a=a.add(t.path.F()),e=Xc(n),u+=e-r,s.push(o.Io.Vi(i,t,n))):(u-=r,o.Eo?(r=Sc(o.Io.serializer,new hu(t,li.min()),o.readTime),s.push(o.Io.Vi(i,t,r))):s.push(o.Io.pi(i,t)))}),a.forEach(function(t){s.push(o.Io.ki.jr(i,t))}),s.push(this.Io.updateMetadata(i,u)),fa.On(s)},Hc.prototype.vi=function(t,e){var n=this;return this.Io.uo(t,e).next(function(t){return null===t?(n.mo.set(e,0),null):(n.mo.set(e,t.size),t.ho)})},Hc.prototype.Si=function(t,e){var n=this;return this.Io._o(t,e).next(function(t){var e=t.fo;return t.do.forEach(function(t,e){n.mo.set(t,e)}),e})},Hc);function Hc(t,e){var n=this;return(n=Gc.call(this)||this).Io=t,n.Eo=e,n.mo=new ci(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function Wc(t,e){this.serializer=t,this.ki=e}function Jc(t){return Rh.Kn(t,ph.store)}function Qc(t){return Rh.Kn(t,fh.store)}function Yc(t){return t.path.L()}function Xc(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Mr();e=t.noDocument}return JSON.stringify(e).length}var $c=(oh.prototype.jr=function(t,e){return this.Ao.add(e),fa.resolve()},oh.prototype.zi=function(t,e){return fa.resolve(this.Ao.getEntries(e))},oh),Zc=(ih.prototype.add=function(t){var e=t.k(),n=t.F(),r=this.index[e]||new zi(fi.D),t=!r.has(n);return this.index[e]=r.add(n),t},ih.prototype.has=function(t){var e=t.k(),t=t.F();return(e=this.index[e])&&e.has(t)},ih.prototype.getEntries=function(t){return(this.index[t]||new zi(fi.D)).L()},ih),th=(rh.prototype.createOrUpgrade=function(e,n,t,r){var i=this;Fr(t<r&&0<=t&&r<=10);var o=new Ea("createOrUpgrade",n);t<1&&1<=r&&(e.createObjectStore(nh.store),(s=e).createObjectStore(sh.store,{keyPath:sh.keyPath}),s.createObjectStore(uh.store,{keyPath:uh.keyPath,autoIncrement:!0}).createIndex(uh.userMutationsIndex,uh.userMutationsKeyPath,{unique:!0}),s.createObjectStore(ah.store),mh(e),e.createObjectStore(fh.store));var s,u=fa.resolve();return t<3&&3<=r&&(0!==t&&((s=e).deleteObjectStore(yh.store),s.deleteObjectStore(dh.store),s.deleteObjectStore(vh.store),mh(e)),u=u.next(function(){return t=o.store(vh.store),e=new vh(0,0,li.min().v(),0),t.put(vh.key,e);var t,e})),t<4&&4<=r&&(0!==t&&(u=u.next(function(){return n=e,(r=o).store(uh.store).ts().next(function(t){n.deleteObjectStore(uh.store),n.createObjectStore(uh.store,{keyPath:uh.keyPath,autoIncrement:!0}).createIndex(uh.userMutationsIndex,uh.userMutationsKeyPath,{unique:!0});var e=r.store(uh.store),t=t.map(function(t){return e.put(t)});return fa.On(t)});var n,r})),u=u.next(function(){e.createObjectStore(wh.store,{keyPath:wh.keyPath})})),t<5&&5<=r&&(u=u.next(function(){return i.removeAcknowledgedMutations(o)})),t<6&&6<=r&&(u=u.next(function(){return e.createObjectStore(ph.store),i.addDocumentGlobal(o)})),t<7&&7<=r&&(u=u.next(function(){return i.ensureSequenceNumbers(o)})),t<8&&8<=r&&(u=u.next(function(){return i.createCollectionParentIndex(e,o)})),t<9&&9<=r&&(u=u.next(function(){var t;(t=e).objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(t=n.objectStore(fh.store)).createIndex(fh.readTimeIndex,fh.readTimeIndexPath,{unique:!1}),t.createIndex(fh.collectionReadTimeIndex,fh.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=r&&(u=u.next(function(){return i.rewriteCanonicalIds(o)})),u},rh.prototype.addDocumentGlobal=function(e){var n=0;return e.store(fh.store).rs(function(t,e){n+=Xc(e)}).next(function(){var t=new ph(n);return e.store(ph.store).put(ph.key,t)})},rh.prototype.removeAcknowledgedMutations=function(n){var r=this,t=n.store(sh.store),i=n.store(uh.store);return t.ts().next(function(t){return fa.forEach(t,function(e){var t=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return i.ts(uh.userMutationsIndex,t).next(function(t){return fa.forEach(t,function(t){return Fr(t.userId===e.userId),t=Lc(r.serializer,t),Mc(n,e.userId,t).next(function(){})})})})})},rh.prototype.ensureSequenceNumbers=function(t){var o=t.store(yh.store),e=t.store(fh.store);return t.store(vh.store).get(vh.key).next(function(r){var i=[];return e.rs(function(t,e){var n=new fi(t),t=[0,_c(n)];i.push(o.get(t).next(function(t){return t?fa.resolve():o.put(new yh(0,_c(n),r.highestListenSequenceNumber))}))}).next(function(){return fa.On(i)})})},rh.prototype.createCollectionParentIndex=function(t,e){function r(t){if(i.add(t)){var e=t.k(),t=t.F();return n.put({collectionId:e,parent:_c(t)})}}t.createObjectStore(gh.store,{keyPath:gh.keyPath});var n=e.store(gh.store),i=new Zc;return e.store(fh.store).rs({ss:!0},function(t,e){return r((t=new fi(t)).F())}).next(function(){return e.store(ah.store).rs({ss:!0},function(t,e){t[0];var n=t[1];return r((n=(t[2],Ac(n))).F())})})},rh.prototype.rewriteCanonicalIds=function(t){var n=this,r=t.store(dh.store);return r.rs(function(t,e){return e=Rc(e),e=Vc(n.serializer,e),r.put(e)})},rh),eh=function(t,e){this.seconds=t,this.nanoseconds=e},nh=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function rh(t){this.serializer=t}function ih(){this.index={}}function oh(){this.Ao=new Zc}nh.store="owner",nh.key="owner";var sh=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};sh.store="mutationQueues",sh.keyPath="userId";var uh=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};uh.store="mutations",uh.keyPath="batchId",uh.userMutationsIndex="userMutationsIndex",uh.userMutationsKeyPath=["userId","batchId"];var ah=(ch.prefixForUser=function(t){return[t]},ch.prefixForPath=function(t,e){return[t,_c(e)]},ch.key=function(t,e,n){return[t,_c(e),n]},ch);function ch(){}ah.store="documentMutations",ah.PLACEHOLDER=new ah;var hh=function(t,e){this.path=t,this.readTime=e},lh=function(t,e){this.path=t,this.version=e},fh=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};fh.store="remoteDocuments",fh.readTimeIndex="readTimeIndex",fh.readTimeIndexPath="readTime",fh.collectionReadTimeIndex="collectionReadTimeIndex",fh.collectionReadTimeIndexPath=["parentPath","readTime"];var ph=function(t){this.byteSize=t};ph.store="remoteDocumentGlobal",ph.key="remoteDocumentGlobalKey";var dh=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};dh.store="targets",dh.keyPath="targetId",dh.queryTargetsIndexName="queryTargetsIndex",dh.queryTargetsKeyPath=["canonicalId","targetId"];var yh=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};yh.store="targetDocuments",yh.keyPath=["targetId","path"],yh.documentTargetsIndex="documentTargetsIndex",yh.documentTargetsKeyPath=["path","targetId"];var vh=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};vh.key="targetGlobalKey",vh.store="targetGlobal";var gh=function(t,e){this.collectionId=t,this.parent=e};function mh(t){t.createObjectStore(yh.store,{keyPath:yh.keyPath}).createIndex(yh.documentTargetsIndex,yh.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(dh.store,{keyPath:dh.keyPath}).createIndex(dh.queryTargetsIndexName,dh.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(vh.store)}gh.store="collectionParents",gh.keyPath=["collectionId","parent"];var wh=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};wh.store="clientMetadata",wh.keyPath="clientId";var bh=o(o(o([sh.store,uh.store,ah.store,fh.store,dh.store,nh.store,vh.store,yh.store],[wh.store]),[ph.store]),[gh.store]),Ih=(Eh.prototype.jr=function(t,e){var n=this;if(this.Ro.has(e))return fa.resolve();var r=e.k(),i=e.F();return t.Ni(function(){n.Ro.add(e)}),i={collectionId:r,parent:_c(i)},_h(t).put(i)},Eh.prototype.zi=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Kr(i),""],!1,!0);return _h(t).ts(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(Ac(r.parent))}return o})},Eh);function Eh(){this.Ro=new Zc}function _h(t){return Rh.Kn(t,gh.store)}var Th=(Dh.prototype.next=function(){return this.Po+=2,this.Po},Dh.Vo=function(){return new Dh(0)},Dh.yo=function(){return new Dh(-1)},Dh),Ah=(Nh.prototype.po=function(n){var r=this;return this.bo(n).next(function(t){var e=new Th(t.highestTargetId);return t.highestTargetId=e.next(),r.vo(n,t).next(function(){return t.highestTargetId})})},Nh.prototype.So=function(t){return this.bo(t).next(function(t){return li.V(new hi(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},Nh.prototype.Do=function(t){return this.bo(t).next(function(t){return t.highestListenSequenceNumber})},Nh.prototype.Co=function(e,n,r){var i=this;return this.bo(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.v()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.vo(e,t)})},Nh.prototype.No=function(e,n){var r=this;return this.xo(e,n).next(function(){return r.bo(e).next(function(t){return t.targetCount+=1,r.Fo(n,t),r.vo(e,t)})})},Nh.prototype.Oo=function(t,e){return this.xo(t,e)},Nh.prototype.ko=function(e,t){var n=this;return this.Mo(e,t.targetId).next(function(){return Sh(e).delete(t.targetId)}).next(function(){return n.bo(e)}).next(function(t){return Fr(0<t.targetCount),--t.targetCount,n.vo(e,t)})},Nh.prototype.Or=function(n,r,i){var o=this,s=0,u=[];return Sh(n).rs(function(t,e){(e=Rc(e)).sequenceNumber<=r&&null===i.get(e.targetId)&&(s++,u.push(o.ko(n,e)))}).next(function(){return fa.On(u)}).next(function(){return s})},Nh.prototype.Ce=function(t,n){return Sh(t).rs(function(t,e){e=Rc(e),n(e)})},Nh.prototype.bo=function(t){return Oh(t).get(vh.key).next(function(t){return Fr(null!==t),t})},Nh.prototype.vo=function(t,e){return Oh(t).put(vh.key,e)},Nh.prototype.xo=function(t,e){return Sh(t).put(Vc(this.serializer,e))},Nh.prototype.Fo=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},Nh.prototype.$o=function(t){return this.bo(t).next(function(t){return t.targetCount})},Nh.prototype.Lo=function(t,r){var e=Si(r),e=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),i=null;return Sh(t).rs({range:e,index:dh.queryTargetsIndexName},function(t,e,n){e=Rc(e),Oi(r,e.target)&&(i=e,n.done())}).next(function(){return i})},Nh.prototype.Bo=function(n,t,r){var i=this,o=[],s=xh(n);return t.forEach(function(t){var e=_c(t.path);o.push(s.put(new yh(r,e))),o.push(i.qr.qo(n,r,t))}),fa.On(o)},Nh.prototype.Uo=function(n,t,r){var i=this,o=xh(n);return fa.forEach(t,function(t){var e=_c(t.path);return fa.On([o.delete([r,e]),i.qr.Ko(n,r,t)])})},Nh.prototype.Mo=function(t,e){return t=xh(t),e=IDBKeyRange.bound([e],[e+1],!1,!0),t.delete(e)},Nh.prototype.Qo=function(t,e){var e=IDBKeyRange.bound([e],[e+1],!1,!0),t=xh(t),r=$i();return t.rs({range:e,ss:!0},function(t,e,n){t=Ac(t[1]),t=new yi(t),r=r.add(t)}).next(function(){return r})},Nh.prototype.ro=function(t,e){var e=_c(e.path),e=IDBKeyRange.bound([e],[Kr(e)],!1,!0),i=0;return xh(t).rs({index:yh.documentTargetsIndex,ss:!0,range:e},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},Nh.prototype.Ue=function(t,e){return Sh(t).get(e).next(function(t){return t?Rc(t):null})},Nh);function Nh(t,e){this.qr=t,this.serializer=e}function Dh(t){this.Po=t}function Sh(t){return Rh.Kn(t,dh.store)}function Oh(t){return Rh.Kn(t,vh.store)}function xh(t){return Rh.Kn(t,yh.store)}var Ph,kh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Lh=(n(Ch,Ph=we),Ch),Rh=(Vh.Kn=function(t,e){if(t instanceof Lh)return pa.Kn(t.eo,e);throw Mr()},Vh.prototype.start=function(){var e=this;return this.ra().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new xr(Or.FAILED_PRECONDITION,kh);return e.oa(),e.aa(),e.ca(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.sa.Do(t)})}).then(function(t){e.zo=new ec(t,e.jo)}).then(function(){e.Ho=!0}).catch(function(t){return e.na&&e.na.close(),Promise.reject(t)})},Vh.prototype.ua=function(n){var t=this;return this.ta=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.br?[2,n(e)]:[2]})})},n(this.isPrimary)},Vh.prototype.ha=function(n){var t=this;this.na.jn(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},Vh.prototype.la=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.fn.ws(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.br?[4,this.ra()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},Vh.prototype.ra=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return qh(e).put(new wh(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n._a(e).next(function(t){t||(n.isPrimary=!1,n.fn.Cs(function(){return n.ta(!1)}))})}).next(function(){return n.fa(e)}).next(function(t){return n.isPrimary&&!t?n.da(e).next(function(){return!1}):!!t&&n.wa(e).next(function(){return!0})})}).catch(function(t){if(Ia(t))return Vr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Vr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.fn.Cs(function(){return n.ta(t)}),n.isPrimary=t})},Vh.prototype._a=function(t){var e=this;return Uh(t).get(nh.key).next(function(t){return fa.resolve(e.Ea(t))})},Vh.prototype.Ta=function(t){return qh(t).delete(this.clientId)},Vh.prototype.Ia=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.ma(this.Zo,18e5)?[3,2]:(this.Zo=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=Vh.Kn(t,wh.store);return r.ts().next(function(t){var e=o.Aa(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return fa.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.ia)for(n=0,r=e;n<r.length;n++)i=r[n],this.ia.removeItem(this.Ra(i.clientId));t.label=2;case 2:return[2]}})})},Vh.prototype.ca=function(){var t=this;this.Xo=this.fn.Vn("client_metadata_refresh",4e3,function(){return t.ra().then(function(){return t.Ia()}).then(function(){return t.ca()})})},Vh.prototype.Ea=function(t){return!!t&&t.ownerId===this.clientId},Vh.prototype.fa=function(e){var r=this;return this.Go?fa.resolve(!0):Uh(e).get(nh.key).next(function(t){if(null!==t&&r.ma(t.leaseTimestampMs,5e3)&&!r.Pa(t.ownerId)){if(r.Ea(t)&&r.networkEnabled)return!0;if(!r.Ea(t)){if(!t.allowTabSynchronization)throw new xr(Or.FAILED_PRECONDITION,kh);return!1}}return!(!r.networkEnabled||!r.inForeground)||qh(e).ts().next(function(t){return void 0===r.Aa(t,5e3).find(function(t){if(r.clientId!==t.clientId){var e=!r.networkEnabled&&t.networkEnabled,n=!r.inForeground&&t.inForeground,t=r.networkEnabled===t.networkEnabled;if(e||n&&t)return!0}return!1})})}).next(function(t){return r.isPrimary!==t&&Vr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},Vh.prototype.ga=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return this.Ho=!1,this.Va(),this.Xo&&(this.Xo.cancel(),this.Xo=null),this.ya(),this.pa(),[4,this.na.runTransaction("shutdown","readwrite",[nh.store,wh.store],function(t){var e=new Lh(t,ec.ir);return n.da(e).next(function(){return n.Ta(e)})})];case 1:return t.sent(),this.na.close(),this.ba(),[2]}})})},Vh.prototype.Aa=function(t,e){var n=this;return t.filter(function(t){return n.ma(t.updateTimeMs,e)&&!n.Pa(t.clientId)})},Vh.prototype.va=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return qh(t).ts().next(function(t){return e.Aa(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(Vh.prototype,"br",{get:function(){return this.Ho},enumerable:!1,configurable:!0}),Vh.prototype.Sa=function(t){return Cc.Kr(t,this.serializer,this.ki,this.qr)},Vh.prototype.Da=function(){return this.sa},Vh.prototype.Ca=function(){return this.Fi},Vh.prototype.Na=function(){return this.ki},Vh.prototype.runTransaction=function(e,n,r){var i=this;Vr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.na.runTransaction(e,t,bh,function(t){return o=new Lh(t,i.zo?i.zo.next():ec.ir),"readwrite-primary"===n?i._a(o).next(function(t){return!!t||i.fa(o)}).next(function(t){if(!t)throw Cr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.fn.Cs(function(){return i.ta(!1)}),new xr(Or.FAILED_PRECONDITION,$a);return r(o)}).next(function(t){return i.wa(o).next(function(){return t})}):i.xa(o).next(function(){return r(o)})}).then(function(t){return o.xi(),t})},Vh.prototype.xa=function(t){var e=this;return Uh(t).get(nh.key).next(function(t){if(null!==t&&e.ma(t.leaseTimestampMs,5e3)&&!e.Pa(t.ownerId)&&!e.Ea(t)&&!(e.Go||e.allowTabSynchronization&&t.allowTabSynchronization))throw new xr(Or.FAILED_PRECONDITION,kh)})},Vh.prototype.wa=function(t){var e=new nh(this.clientId,this.allowTabSynchronization,Date.now());return Uh(t).put(nh.key,e)},Vh.Ln=function(){return pa.Ln()},Vh.prototype.da=function(t){var e=this,n=Uh(t);return n.get(nh.key).next(function(t){return e.Ea(t)?(Vr("IndexedDbPersistence","Releasing primary lease."),n.delete(nh.key)):fa.resolve()})},Vh.prototype.ma=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Cr("Detected an update time that is in the future: "+t+" > "+n),1))},Vh.prototype.oa=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Yo=function(){t.fn.ws(function(){return t.inForeground="visible"===t.document.visibilityState,t.ra()})},this.document.addEventListener("visibilitychange",this.Yo),this.inForeground="visible"===this.document.visibilityState)},Vh.prototype.ya=function(){this.Yo&&(this.document.removeEventListener("visibilitychange",this.Yo),this.Yo=null)},Vh.prototype.aa=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Jo=function(){e.Va(),e.fn.ws(function(){return e.ga()})},this.window.addEventListener("unload",this.Jo))},Vh.prototype.pa=function(){this.Jo&&(this.window.removeEventListener("unload",this.Jo),this.Jo=null)},Vh.prototype.Pa=function(t){try{var e=null!==(null===(e=this.ia)||void 0===e?void 0:e.getItem(this.Ra(t)));return Vr("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return Cr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},Vh.prototype.Va=function(){if(this.ia)try{this.ia.setItem(this.Ra(this.clientId),String(Date.now()))}catch(t){Cr("Failed to set zombie client id.",t)}},Vh.prototype.ba=function(){if(this.ia)try{this.ia.removeItem(this.Ra(this.clientId))}catch(t){}},Vh.prototype.Ra=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},Vh);function Vh(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.fn=i,this.window=o,this.document=s,this.jo=a,this.Go=c,this.zo=null,this.Ho=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Jo=null,this.inForeground=!1,this.Yo=null,this.Xo=null,this.Zo=Number.NEGATIVE_INFINITY,this.ta=function(t){return Promise.resolve()},!Vh.Ln())throw new xr(Or.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.qr=new Mh(this,r),this.ea=e+"main",this.serializer=new Nc(u),this.na=new pa(this.ea,10,new th(this.serializer)),this.sa=new Ah(this.qr,this.serializer),this.ki=new Ih,this.Fi=(e=this.serializer,u=this.ki,new zc(e,u)),this.window&&this.window.localStorage?this.ia=this.window.localStorage:(this.ia=null,!1===c&&Cr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function Ch(t,e){var n=this;return(n=Ph.call(this)||this).eo=t,n.Wo=e,n}function Uh(t){return Rh.Kn(t,nh.store)}function qh(t){return Rh.Kn(t,wh.store)}var Mh=(Fh.prototype.Cr=function(t){var n=this.Fa(t);return this.db.Da().$o(t).next(function(e){return n.next(function(t){return e+t})})},Fh.prototype.Fa=function(t){var e=0;return this.Fr(t,function(t){e++}).next(function(){return e})},Fh.prototype.Ce=function(t,e){return this.db.Da().Ce(t,e)},Fh.prototype.Fr=function(t,n){return this.Oa(t,function(t,e){return n(e)})},Fh.prototype.qo=function(t,e,n){return jh(t,n)},Fh.prototype.Ko=function(t,e,n){return jh(t,n)},Fh.prototype.Or=function(t,e,n){return this.db.Da().Or(t,e,n)},Fh.prototype.so=jh,Fh.prototype.ka=function(t,e){return r=e,i=!1,Bc(n=t).os(function(t){return qc(n,t,r).next(function(t){return t&&(i=!0),fa.resolve(!t)})}).next(function(){return i});var n,r,i},Fh.prototype.kr=function(n,r){var i=this,o=this.db.Ca().wo(),s=[],u=0;return this.Oa(n,function(e,t){t<=r&&(t=i.ka(n,e).next(function(t){if(!t)return u++,o.bi(n,e).next(function(){return o.pi(e),xh(n).delete([0,_c(e.path)])})}),s.push(t))}).next(function(){return fa.On(s)}).next(function(){return o.apply(n)}).next(function(){return u})},Fh.prototype.removeTarget=function(t,e){return e=e.st(t.Wo),this.db.Da().Oo(t,e)},Fh.prototype.Ma=jh,Fh.prototype.Oa=function(t,r){var i,t=xh(t),o=ec.ir;return t.rs({index:yh.documentTargetsIndex},function(t,e){var n=t[0],t=(t[1],e.path),e=e.sequenceNumber;0===n?(o!==ec.ir&&r(new yi(Ac(i)),o),o=e,i=t):o=ec.ir}).next(function(){o!==ec.ir&&r(new yi(Ac(i)),o)})},Fh.prototype.$r=function(t){return this.db.Ca().To(t)},Fh);function Fh(t,e){this.db=t,this.gr=new bc(this,e)}function jh(t,e){return xh(t).put((t=t.Wo,new yh(0,_c(e.path),t)))}function Bh(t,e){var n=t.projectId;return t.I||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Gh=(zh.prototype.vr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Mr(t,n.La)})},zh);function zh(t,e,n){this.persistence=t,this.$a=e,this.La=new Ui(Gr),this.Ba=new ci(Si,Oi),this.qa=li.min(),this.Oi=t.Sa(n),this.Ua=t.Ca(),this.sa=t.Da(),this.Ka=new Za(this.Ua,this.Oi,this.persistence.Na()),this.$a.Qa(this.Ka)}function Kh(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Oi,m=e.Ka,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.Oi.Yr(v).next(function(t){return g=t,n=e.persistence.Sa(o),m=new Za(e.Ua,n,e.persistence.Na()),n.Yr(v)}).next(function(t){for(var e=[],n=[],r=$i(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,l=t;h<l.length;h++){var f=l[h];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.qi(v,r).next(function(t){return{Wa:t,ja:e,Ga:n}})})})];case 1:return r=t.sent(),[2,(e.Oi=n,e.Ka=m,e.$a.Qa(e.Ka),r)]}})})}function Hh(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.sa.So(t)})}function Wh(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.sa.Lo(e,r).next(function(t){return t?(n=t,fa.resolve(n)):i.sa.po(e).next(function(t){return n=new Li(r,t,0,e.Wo),i.sa.No(e,n).next(function(){return n})})})}).then(function(t){var e=i.La.get(t.targetId);return(null===e||0<t.nt.u(e.nt))&&(i.La=i.La.ot(t.targetId,t),i.Ba.set(r,t.targetId)),t})}function Jh(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).La.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.qr.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Ia(r=t.sent()))throw r;return Vr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.La=e.La.remove(o),e.Ba.delete(n.target),[2]}})})}function Qh(t,o,s){var u=t,a=li.min(),c=$i();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=Tu(o),(void 0!==(t=(i=t).Ba.get(r))?fa.resolve(i.La.get(t)):i.sa.Lo(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.sa.Qo(e,t.targetId).next(function(t){c=t})}).next(function(){return u.$a.Qi(e,o,s?a:li.min(),s?c:$i())}).next(function(t){return{documents:t,za:c}});var t,n,r,i})}function Yh(t,e){var n=t,r=n.sa;return(t=n.La.get(e))?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Ue(t,e).next(function(t){return t?t.target:null})})}function Xh(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Or.FAILED_PRECONDITION||e.message!==$a)throw e;return Vr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function $h(t,e,n,r,i){var o=this;this.Bc=t,this.qc=e,this.cs=n,this.Uc={},this.Kc=[],this.Qc=new Map,this.Wc=new Set,this.jc=[],this.Gc=i,this.Gc.zc(function(t){n.ws(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return wl(this)?(Vr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Wc.add(4),[4,fl(e)];case 1:return t.sent(),e.Hc.set("Unknown"),e.Wc.delete(4),[4,ll(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Hc=new ol(n,r)}var Zh,tl,el,me=(hl.prototype.ec=function(){return 1===this.state||2===this.state||4===this.state},hl.prototype.nc=function(){return 2===this.state},hl.prototype.start=function(){3!==this.state?this.auth():this.sc()},hl.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.ec()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},hl.prototype.ic=function(){this.state=0,this.Vs.reset()},hl.prototype.rc=function(){var t=this;this.nc()&&null===this.tc&&(this.tc=this.fn.Vn(this.Ja,6e4,function(){return t.oc()}))},hl.prototype.ac=function(t){this.cc(),this.stream.send(t)},hl.prototype.oc=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.nc()?[2,this.close(0)]:[2]})})},hl.prototype.cc=function(){this.tc&&(this.tc.cancel(),this.tc=null)},hl.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.cc(),this.Vs.cancel(),this.Za++,3!==e?this.Vs.reset():n&&n.code===Or.RESOURCE_EXHAUSTED?(Cr(n.toString()),Cr("Using maximum backoff delay to prevent overloading the backend."),this.Vs.Rn()):n&&n.code===Or.UNAUTHENTICATED&&this.Xa.ri(),null!==this.stream&&(this.uc(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.hc(n)];case 1:return t.sent(),[2]}})})},hl.prototype.uc=function(){},hl.prototype.auth=function(){var n=this;this.state=1;var t=this.lc(this.Za),e=this.Za;this.Xa.getToken().then(function(t){n.Za===e&&n._c(t)},function(e){t(function(){var t=new xr(Or.UNKNOWN,"Fetching auth token failed: "+e.message);return n.fc(t)})})},hl.prototype._c=function(t){var e=this,n=this.lc(this.Za);this.stream=this.dc(t),this.stream.wc(function(){n(function(){return e.state=2,e.listener.wc()})}),this.stream.hc(function(t){n(function(){return e.fc(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},hl.prototype.sc=function(){var t=this;this.state=4,this.Vs.Pn(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},hl.prototype.fc=function(t){return Vr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},hl.prototype.lc=function(e){var n=this;return function(t){n.fn.ws(function(){return n.Za===e?t():(Vr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},hl),nl=(n(cl,el=me),cl.prototype.dc=function(t){return this.Ya.Ec("Listen",t)},cl.prototype.onMessage=function(t){this.Vs.reset();var e,n=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:Mr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.Ke?(Fr(void 0===o||"string"==typeof o),Hr.fromBase64String(o||"")):(Fr(void 0===o||o instanceof Uint8Array),Hr.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Or.UNKNOWN:Ci(s.code),new xr(o,s.message||"")),r=new uo(n,r,i,s||null)}else if("documentChange"in e){e.documentChange,(a=e.documentChange).document,a.document.name,a.document.updateTime;var i=Yo(t,a.document.name),u=Ho(a.document.updateTime),s=new tu({mapValue:{fields:a.document.fields}}),u=new cu(i,u,s,{}),s=a.targetIds||[],a=a.removedTargetIds||[];r=new oo(s,a,u.key,u)}else if("documentDelete"in e){e.documentDelete,(a=e.documentDelete).document;var u=Yo(t,a.document),c=a.readTime?Ho(a.readTime):li.min(),c=new hu(u,c),a=a.removedTargetIds||[];r=new oo([],a,c.key,c)}else if("documentRemove"in e){e.documentRemove,(c=e.documentRemove).document;var h=Yo(t,c.document),c=c.removedTargetIds||[];r=new oo([],c,h,null)}else{if(!("filter"in e))return Mr();e.filter,(h=e.filter).targetId,e=new Pi(e=h.count||0),h=h.targetId,r=new so(h,e)}return r}(this.serializer,t),t=!("targetChange"in(e=t))||(e=e.targetChange).targetIds&&e.targetIds.length||!e.readTime?li.min():Ho(e.readTime);return this.listener.Tc(n,t)},cl.prototype.Ic=function(t){var e,n,r,i,o={};o.database=Zo(this.serializer),o.addTarget=(e=this.serializer,(r=xi(r=(n=t).target)?{documents:is(e,r)}:{query:os(e,r)}).targetId=n.targetId,0<n.resumeToken.o()&&(r.resumeToken=Ko(e,n.resumeToken)),r),(t=(this.serializer,i=t,null==(t=function(){switch(i.et){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Mr()}}())?null:{"goog-listen-tags":t}))&&(o.labels=t),this.ac(o)},cl.prototype.mc=function(t){var e={};e.database=Zo(this.serializer),e.removeTarget=t,this.ac(e)},cl),rl=(n(al,tl=me),Object.defineProperty(al.prototype,"Rc",{get:function(){return this.Ac},enumerable:!1,configurable:!0}),al.prototype.start=function(){this.Ac=!1,this.lastStreamToken=void 0,tl.prototype.start.call(this)},al.prototype.uc=function(){this.Ac&&this.Pc([])},al.prototype.dc=function(t){return this.Ya.Ec("Write",t)},al.prototype.onMessage=function(t){if(Fr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Ac){this.Vs.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Fr(void 0!==r),n.map(function(t){return n=r,(t=(e=t).updateTime?Ho(e.updateTime):Ho(n)).isEqual(li.min())&&(t=Ho(n)),n=null,e.transformResults&&0<e.transformResults.length&&(n=e.transformResults),new ks(t,n);var e,n})):[]),n=Ho(t.commitTime);return this.listener.gc(n,e)}var r;return Fr(!t.writeResults||0===t.writeResults.length),this.Ac=!0,this.listener.Vc()},al.prototype.yc=function(){var t={};t.database=Zo(this.serializer),this.ac(t)},al.prototype.Pc=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return ns(e.serializer,t)})};this.ac(t)},al),il=(n(ul,Zh=function(){}),ul.prototype.vc=function(){if(this.bc)throw new xr(Or.FAILED_PRECONDITION,"The client has already been terminated.")},ul.prototype.Sc=function(e,n,r){var i=this;return this.vc(),this.credentials.getToken().then(function(t){return i.Ya.Sc(e,n,r,t)}).catch(function(t){throw t.code===Or.UNAUTHENTICATED&&i.credentials.ri(),t})},ul.prototype.Dc=function(e,n,r){var i=this;return this.vc(),this.credentials.getToken().then(function(t){return i.Ya.Dc(e,n,r,t)}).catch(function(t){throw t.code===Or.UNAUTHENTICATED&&i.credentials.ri(),t})},ul.prototype.terminate=function(){this.bc=!1},ul),ol=(sl.prototype.Oc=function(){var t=this;0===this.Nc&&(this.kc("Unknown"),this.xc=this.cs.Vn("online_state_timeout",1e4,function(){return t.xc=null,t.Mc("Backend didn't respond within 10 seconds."),t.kc("Offline"),Promise.resolve()}))},sl.prototype.$c=function(t){"Online"===this.state?this.kc("Unknown"):(this.Nc++,1<=this.Nc&&(this.Lc(),this.Mc("Connection failed 1 times. Most recent error: "+t.toString()),this.kc("Offline")))},sl.prototype.set=function(t){this.Lc(),this.Nc=0,"Online"===t&&(this.Fc=!1),this.kc(t)},sl.prototype.kc=function(t){t!==this.state&&(this.state=t,this.Cc(t))},sl.prototype.Mc=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.Fc?(Cr(t),this.Fc=!1):Vr("OnlineStateTracker",t)},sl.prototype.Lc=function(){null!==this.xc&&(this.xc.cancel(),this.xc=null)},sl);function sl(t,e){this.cs=t,this.Cc=e,this.state="Unknown",this.Nc=0,this.xc=null,this.Fc=!0}function ul(t,e,n){var r=this;return(r=Zh.call(this)||this).credentials=t,r.Ya=e,r.serializer=n,r.bc=!1,r}function al(t,e,n,r,i){var o=this;return(o=tl.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Ac=!1,o}function cl(t,e,n,r,i){var o=this;return(o=el.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function hl(t,e,n,r,i,o){this.fn=t,this.Ja=n,this.Ya=r,this.Xa=i,this.listener=o,this.state=0,this.Za=0,this.tc=null,this.stream=null,this.Vs=new la(t,e)}function ll(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!wl(r))return[3,4];e=0,n=r.jc,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function fl(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.jc,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function pl(t,e){t.Qc.has(e.targetId)||(t.Qc.set(e.targetId,e),ml(t)?gl(t):Dl(t).nc()&&yl(t,e))}function dl(t,e){var n=t,t=Dl(n);n.Qc.delete(e),t.nc()&&vl(n,e),0===n.Qc.size&&(t.nc()?t.rc():wl(n)&&n.Hc.set("Unknown"))}function yl(t,e){t.Jc.me(e.targetId),Dl(t).Ic(e)}function vl(t,e){t.Jc.me(e),Dl(t).mc(e)}function gl(e){e.Jc=new co({qe:function(t){return e.Uc.qe(t)},Ue:function(t){return e.Qc.get(t)||null}}),Dl(e).start(),e.Hc.Oc()}function ml(t){return wl(t)&&!Dl(t).ec()&&0<t.Qc.size}function wl(t){return 0===t.Wc.size}function bl(t){t.Jc=void 0}function Il(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!Ia(r))throw r;return n.Wc.add(1),[4,fl(n)];case 1:return t.sent(),n.Hc.set("Offline"),i=i||function(){return Hh(n.Bc)},n.cs.Cs(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Vr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Wc.delete(1),[4,ll(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function El(e,n){return n().catch(function(t){return Il(e,t,n)})}function _l(c){return y(this,void 0,void 0,function(){var o,s,u,a;return v(this,function(t){switch(t.label){case 0:s=Sl(o=c),u=0<o.Kc.length?o.Kc[o.Kc.length-1].batchId:-1,t.label=1;case 1:if(!(wl(o)&&o.Kc.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(n=o.Bc,r=u,(i=n).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===r&&(r=-1),i.Oi.Hr(t,r)}))];case 3:return null===(a=t.sent())?(0===o.Kc.length&&s.rc(),[3,7]):(u=a.batchId,e=a,(n=o).Kc.push(e),(n=Sl(n)).nc()&&n.Rc&&n.Pc(e.mutations),[3,6]);case 4:return a=t.sent(),[4,Il(o,a)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Tl(o)&&Al(o),[2]}var e,n,r,i})})}function Tl(t){return wl(t)&&!Sl(t).ec()&&0<t.Kc.length}function Al(t){Sl(t).start()}function Nl(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Wc.delete(2),[4,ll(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Wc.add(2),[4,fl(e)]);case 3:t.sent(),e.Hc.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function Dl(n){var t,e,r,i=this;return n.eu||(n.eu=(t=n.qc,e=n.cs,r={wc:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.Qc.forEach(function(t,e){yl(n,t)}),[2]})})}.bind(null,n),hc:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return bl(e),ml(e)?(e.Hc.$c(n),gl(e)):e.Hc.set("Unknown"),[2]})})}.bind(null,n),Tc:function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Hc.set("Online"),!(u instanceof uo&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Qc.has(i)?[4,o.Uc.Yc(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Qc.delete(i),o.Jc.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Vr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,Il(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof oo?s.Jc.be(u):u instanceof so?s.Jc.Oe(u):s.Jc.De(u),a.isEqual(li.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Hh(s.Bc)];case 8:return o=t.sent(),0<=a.u(o)?[4,(i=a,(e=(r=s).Jc.$e(i)).zt.forEach(function(t,e){var n;0<t.resumeToken.o()&&(n=r.Qc.get(e))&&r.Qc.set(e,n.it(t.resumeToken,i))}),e.Ht.forEach(function(t){var e=r.Qc.get(t);e&&(r.Qc.set(t,e.it(Hr.h,e.nt)),vl(r,t),e=new Li(e.target,t,1,e.sequenceNumber),yl(r,e))}),r.Uc.Xc(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Vr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,Il(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n)},t.vc(),new nl(e,t.Ya,t.credentials,t.serializer,r)),n.jc.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.eu.ic(),ml(n)?gl(n):n.Hc.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.eu.stop()];case 2:t.sent(),bl(n),t.label=3;case 3:return[2]}})})})),n.eu}function Sl(n){var t,e,r,i=this;return n.nu||(n.nu=(t=n.qc,e=n.cs,r={wc:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return Sl(e).yc(),[2]})})}.bind(null,n),hc:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&Sl(e).Rc?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Vi(n=i.code)&&n!==Or.ABORTED?(e=r.Kc.shift(),Sl(r).ic(),[4,El(r,function(){return r.Uc.tu(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,_l(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Tl(e)&&Al(e),[2]}})})}.bind(null,n),Vc:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=Sl(o),n=0,r=o.Kc;n<r.length;n++)i=r[n],e.Pc(i.mutations);return[2]})})}.bind(null,n),gc:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Kc.shift(),n=Xa.from(e,i,o),[4,El(r,function(){return r.Uc.Zc(n)})];case 1:return t.sent(),[4,_l(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.vc(),new rl(e,t.Ya,t.credentials,t.serializer,r)),n.jc.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.nu.ic(),[4,_l(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.nu.stop()];case 3:t.sent(),0<n.Kc.length&&(Vr("RemoteStore","Stopping write stream with "+n.Kc.length+" pending writes"),n.Kc=[]),t.label=4;case 4:return[2]}})})})),n.nu}var Ol=(kl.prototype.P=function(){return this.su.P()},kl.prototype.qo=function(t,e){e=new xl(t,e),this.su=this.su.add(e),this.ru=this.ru.add(e)},kl.prototype.au=function(t,e){var n=this;t.forEach(function(t){return n.qo(t,e)})},kl.prototype.Ko=function(t,e){this.cu(new xl(t,e))},kl.prototype.uu=function(t,e){var n=this;t.forEach(function(t){return n.Ko(t,e)})},kl.prototype.hu=function(t){var e=this,n=new yi(new fi([])),r=new xl(n,t),t=new xl(n,t+1),i=[];return this.ru.xt([r,t],function(t){e.cu(t),i.push(t.key)}),i},kl.prototype.lu=function(){var e=this;this.su.forEach(function(t){return e.cu(t)})},kl.prototype.cu=function(t){this.su=this.su.delete(t),this.ru=this.ru.delete(t)},kl.prototype._u=function(t){var e=new yi(new fi([])),n=new xl(e,t),t=new xl(e,t+1),r=$i();return this.ru.xt([n,t],function(t){r=r.add(t.key)}),r},kl.prototype.ro=function(t){var e=new xl(t,0);return null!==(e=this.su.Ot(e))&&t.isEqual(e.key)},kl),xl=(Pl.iu=function(t,e){return yi.D(t.key,e.key)||Gr(t.fu,e.fu)},Pl.ou=function(t,e){return Gr(t.fu,e.fu)||yi.D(t.key,e.key)},Pl);function Pl(t,e){this.key=t,this.fu=e}function kl(){this.su=new zi(xl.iu),this.ru=new zi(xl.ou)}function Ll(t,e){return"firestore_clients_"+t+"_"+e}function Rl(t,e,n){return n="firestore_mutations_"+t+"_"+n,e.Zs()&&(n+="_"+e.uid),n}function Vl(t,e){return"firestore_targets_"+t+"_"+e}var Cl=(rf.du=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new xr(r.error.code,r.error.message)),i?new rf(t,e,r.state,o):(Cr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},rf.prototype.wu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},rf),Ul=(nf.du=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new xr(n.error.code,n.error.message)),r?new nf(t,n.state,i):(Cr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},nf.prototype.wu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},nf),ql=(ef.du=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Zi,o=0;r&&o<n.activeTargetIds.length;++o)r=Ai(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new ef(t,i):(Cr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},ef),Ml=(tf.du=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new tf(e.clientId,e.onlineState):(Cr("SharedClientState","Failed to parse online state: "+t),null)},tf),Fl=(Zl.prototype.Eu=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Zl.prototype.Tu=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Zl.prototype.wu=function(){var t={activeTargetIds:this.activeTargetIds.L(),updateTimeMs:Date.now()};return JSON.stringify(t)},Zl),jl=($l.Ln=function(t){return!(!t||!t.localStorage)},$l.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,l=this;return v(this,function(t){switch(t.label){case 0:return[4,this.mu.va()];case 1:for(s=t.sent(),e=0,n=s;e<n.length;e++)(r=n[e])!==this.Iu&&(i=this.getItem(Ll(this.persistenceKey,r)))&&(o=ql.du(r,i))&&(this.Pu=this.Pu.ot(o.clientId,o));for(this.Du(),(s=this.storage.getItem(this.Su))&&(u=this.Cu(s))&&this.Nu(u),a=0,c=this.gu;a<c.length;a++)h=c[a],this.Ru(h);return this.gu=[],this.window.addEventListener("unload",function(){return l.ga()}),this.br=!0,[2]}})})},$l.prototype.sr=function(t){this.setItem(this.yu,JSON.stringify(t))},$l.prototype.xu=function(){return this.Fu(this.Pu)},$l.prototype.Ou=function(n){var r=!1;return this.Pu.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},$l.prototype.ku=function(t){this.Mu(t,"pending")},$l.prototype.$u=function(t,e,n){this.Mu(t,e,n),this.Lu(t)},$l.prototype.Bu=function(t){var e,n="not-current";return this.Ou(t)&&(!(e=this.storage.getItem(Vl(this.persistenceKey,t)))||(e=Ul.du(t,e))&&(n=e.state)),this.qu.Eu(t),this.Du(),n},$l.prototype.Uu=function(t){this.qu.Tu(t),this.Du()},$l.prototype.Ku=function(t){return this.qu.activeTargetIds.has(t)},$l.prototype.Qu=function(t){this.removeItem(Vl(this.persistenceKey,t))},$l.prototype.Wu=function(t,e,n){this.ju(t,e,n)},$l.prototype.Gu=function(t,e,n){var r=this;e.forEach(function(t){r.Lu(t)}),this.currentUser=t,n.forEach(function(t){r.ku(t)})},$l.prototype.zu=function(t){this.Hu(t)},$l.prototype.ga=function(){this.br&&(this.window.removeEventListener("storage",this.Au),this.removeItem(this.Vu),this.br=!1)},$l.prototype.getItem=function(t){var e=this.storage.getItem(t);return Vr("SharedClientState","READ",t,e),e},$l.prototype.setItem=function(t,e){Vr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},$l.prototype.removeItem=function(t){Vr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},$l.prototype.Ru=function(t){var e=this,s=t;s.storageArea===this.storage&&(Vr("SharedClientState","EVENT",s.key,s.newValue),s.key!==this.Vu?this.fn.Cs(function(){return y(e,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){if(this.br){if(null!==s.key)if(this.pu.test(s.key)){if(null==s.newValue)return e=this.Ju(s.key),[2,this.Yu(e,null)];if(e=this.Xu(s.key,s.newValue))return[2,this.Yu(e.clientId,e)]}else if(this.bu.test(s.key)){if(null!==s.newValue&&(n=this.Zu(s.key,s.newValue)))return[2,this.th(n)]}else if(this.vu.test(s.key)){if(null!==s.newValue&&(r=this.eh(s.key,s.newValue)))return[2,this.nh(r)]}else if(s.key===this.Su){if(null!==s.newValue&&(i=this.Cu(s.newValue)))return[2,this.Nu(i)]}else s.key===this.yu&&(o=function(t){var e=ec.ir;if(null!=t)try{var n=JSON.parse(t);Fr("number"==typeof n),e=n}catch(t){Cr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(s.newValue))!==ec.ir&&this.tr(o)}else this.gu.push(s);return[2]})})}):Cr("Received WebStorage notification for local change. Another client might have garbage-collected our state"))},Object.defineProperty($l.prototype,"qu",{get:function(){return this.Pu.get(this.Iu)},enumerable:!1,configurable:!0}),$l.prototype.Du=function(){this.setItem(this.Vu,this.qu.wu())},$l.prototype.Mu=function(t,e,n){n=new Cl(this.currentUser,t,e,n),t=Rl(this.persistenceKey,this.currentUser,t),this.setItem(t,n.wu())},$l.prototype.Lu=function(t){t=Rl(this.persistenceKey,this.currentUser,t),this.removeItem(t)},$l.prototype.Hu=function(t){t={clientId:this.Iu,onlineState:t},this.storage.setItem(this.Su,JSON.stringify(t))},$l.prototype.ju=function(t,e,n){var r=Vl(this.persistenceKey,t),n=new Ul(t,e,n);this.setItem(r,n.wu())},$l.prototype.Ju=function(t){return(t=this.pu.exec(t))?t[1]:null},$l.prototype.Xu=function(t,e){return t=this.Ju(t),ql.du(t,e)},$l.prototype.Zu=function(t,e){var n=this.bu.exec(t),t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return Cl.du(new Ba(n),t,e)},$l.prototype.eh=function(t,e){return t=this.vu.exec(t),t=Number(t[1]),Ul.du(t,e)},$l.prototype.Cu=function(t){return Ml.du(t)},$l.prototype.th=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.mu.sh(e.batchId,e.state,e.error)]:(Vr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},$l.prototype.nh=function(t){return this.mu.ih(t.targetId,t.state,t.error)},$l.prototype.Yu=function(t,e){var n=this,r=e?this.Pu.ot(t,e):this.Pu.remove(t),i=this.Fu(this.Pu),o=this.Fu(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.mu.rh(s,u).then(function(){n.Pu=r})},$l.prototype.Nu=function(t){this.Pu.get(t.clientId)&&this.Cc(t.onlineState)},$l.prototype.Fu=function(t){var n=Zi;return t.forEach(function(t,e){n=n.kt(e.activeTargetIds)}),n},$l),Bl=(Xl.prototype.ku=function(t){},Xl.prototype.$u=function(t,e,n){},Xl.prototype.Bu=function(t){return this.oh.Eu(t),this.ah[t]||"not-current"},Xl.prototype.Wu=function(t,e,n){this.ah[t]=e},Xl.prototype.Uu=function(t){this.oh.Tu(t)},Xl.prototype.Ku=function(t){return this.oh.activeTargetIds.has(t)},Xl.prototype.Qu=function(t){delete this.ah[t]},Xl.prototype.xu=function(){return this.oh.activeTargetIds},Xl.prototype.Ou=function(t){return this.oh.activeTargetIds.has(t)},Xl.prototype.start=function(){return this.oh=new Fl,Promise.resolve()},Xl.prototype.Gu=function(t,e,n){},Xl.prototype.zu=function(t){},Xl.prototype.ga=function(){},Xl.prototype.sr=function(t){},Xl),Gl=function(t){this.key=t},zl=function(t){this.key=t},Kl=(Object.defineProperty(Yl.prototype,"dh",{get:function(){return this.uh},enumerable:!1,configurable:!0}),Yl.prototype.wh=function(t,e){var s=this,u=e?e.Eh:new eo,a=(e||this).fh,c=(e||this).Qt,h=a,l=!1,f=mu(this.query)&&a.size===this.query.limit?a.last():null,p=wu(this.query)&&a.size===this.query.limit?a.first():null;if(t.ht(function(t,e){var n=a.get(t),r=(r=e instanceof cu?e:null)&&(Pu(s.query,r)?r:null),i=!!n&&s.Qt.has(n.key),o=!!r&&(r.Ye||s.Qt.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.Th(n,r)||(u.track({type:2,doc:r}),e=!0,(f&&0<s._h(r,f)||p&&s._h(r,p)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),mu(this.query)||wu(this.query))for(;h.size>this.query.limit;){var n=mu(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{fh:h,Eh:u,Ih:l,Qt:c}},Yl.prototype.Th=function(t,e){return t.Ye&&e.hasCommittedMutations&&!e.Ye},Yl.prototype.Di=function(t,e,n){var o=this,r=this.fh;this.fh=t.fh,this.Qt=t.Qt;var i=t.Eh.Ut();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o._h(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Mr()}}var r,i}),this.mh(n);var s=e?this.Ah():[],e=(n=0===this.lh.size&&this.te?1:0)!==this.hh;return this.hh=n,0!==i.length||e?{snapshot:new no(this.query,t.fh,r,i,t.Qt,0==n,e,!1),Rh:s}:{Rh:s}},Yl.prototype.Ks=function(t){return this.te&&"Offline"===t?(this.te=!1,this.Di({fh:this.fh,Eh:new eo,Qt:this.Qt,Ih:!1},!1)):{Rh:[]}},Yl.prototype.Ph=function(t){return!this.uh.has(t)&&!!this.fh.has(t)&&!this.fh.get(t).Ye},Yl.prototype.mh=function(t){var e=this;t&&(t.ee.forEach(function(t){return e.uh=e.uh.add(t)}),t.ne.forEach(function(t){}),t.se.forEach(function(t){return e.uh=e.uh.delete(t)}),this.te=t.te)},Yl.prototype.Ah=function(){var e=this;if(!this.te)return[];var n=this.lh;this.lh=$i(),this.fh.forEach(function(t){e.Ph(t.key)&&(e.lh=e.lh.add(t.key))});var r=[];return n.forEach(function(t){e.lh.has(t)||r.push(new zl(t))}),this.lh.forEach(function(t){n.has(t)||r.push(new Gl(t))}),r},Yl.prototype.gh=function(t){return this.uh=t.za,this.lh=$i(),t=this.wh(t.documents),this.Di(t,!0)},Yl.prototype.Vh=function(){return no.Gt(this.query,this.fh,this.Qt,0===this.hh)},Yl),Hl=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Wl=function(t){this.key=t,this.yh=!1},Jl=(Object.defineProperty(Ql.prototype,"Uh",{get:function(){return!0===this.qh},enumerable:!1,configurable:!0}),Ql);function Ql(t,e,n,r,i,o){this.Bc=t,this.ph=e,this.bh=n,this.Sh=r,this.currentUser=i,this.Dh=o,this.Ch={},this.Nh=new ci(Ou,Su),this.xh=new Map,this.Fh=[],this.Oh=new Ui(yi.D),this.kh=new Map,this.Mh=new Ol,this.$h={},this.Lh=new Map,this.Bh=Th.yo(),this.onlineState="Unknown",this.qh=void 0}function Yl(t,e){this.query=t,this.uh=e,this.hh=null,this.te=!1,this.lh=$i(),this.Qt=$i(),this._h=ku(t),this.fh=new to(this._h)}function Xl(){this.oh=new Fl,this.ah={},this.Cc=null,this.tr=null}function $l(t,e,n,r,i){this.window=t,this.fn=e,this.persistenceKey=n,this.Iu=r,this.mu=null,this.Cc=null,this.tr=null,this.Au=this.Ru.bind(this),this.Pu=new Ui(Gr),this.br=!1,this.gu=[],n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),this.storage=this.window.localStorage,this.currentUser=i,this.Vu=Ll(this.persistenceKey,this.Iu),this.yu="firestore_sequence_number_"+this.persistenceKey,this.Pu=this.Pu.ot(this.Iu,new Fl),this.pu=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.bu=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.vu=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.Su="firestore_online_state_"+this.persistenceKey,this.window.addEventListener("storage",this.Au)}function Zl(){this.activeTargetIds=Zi}function tf(t,e){this.clientId=t,this.onlineState=e}function ef(t,e){this.clientId=t,this.activeTargetIds=e}function nf(t,e,n){this.targetId=t,this.state=e,this.error=n}function rf(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function of(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Kh=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.wh(o)).Ih?[4,Qh(r.Bc,i.query,!1).then(function(t){return t=t.documents,i.view.wh(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.zt.get(i.targetId),n=i.view.Di(e,r.Uh,n),[2,(df(r,i.targetId,n.Rh),n.snapshot)]}})})}(i,t,e,n)},[4,Qh(i.Bc,o,!0)];case 1:return n=t.sent(),r=new Kl(o,n.za),e=r.wh(n.documents),n=io.Zt(s,u&&"Offline"!==i.onlineState),n=r.Di(e,i.Uh,n),df(i,s,n.Rh),r=new Hl(o,s,r),[2,(i.Nh.set(o,r),i.xh.has(s)?i.xh.get(s).push(o):i.xh.set(s,[o]),n.snapshot)]}})})}function sf(f,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:u=bf(f),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(i=u.Bc,a=p,h=i,l=hi.now(),o=a.reduce(function(t,e){return t.add(e.key)},$i()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.Ka.qi(u,o).next(function(t){c=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=c.get(i.key),s instanceof Ws?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof cu?t.field(i.field):void 0;null!=(o=fs(i.transform,o||null))&&(e=(null==e?new eu:e).set(i.field,o))}return e?e.Xe():null}(o):null);null!=o&&e.push(new Bs(i.key,o,function s(t){var u=[];return oi(t.fields||{},function(t,e){var n=new di([t]);if(Uo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Os(u)}(o.proto.mapValue),Ls.exists(!0)))}return h.Oi.Wr(u,l,e,a)})}).then(function(t){var e=t.Ii(c);return{batchId:t.batchId,Ri:e}}))];case 2:return s=t.sent(),u.Sh.ku(s.batchId),e=u,n=s.batchId,r=d,i=(i=(i=e.$h[e.currentUser.ti()])||new Ui(Gr)).ot(n,r),e.$h[e.currentUser.ti()]=i,[4,vf(u,s.Ri)];case 3:return t.sent(),[4,_l(u.ph)];case 4:return t.sent(),[3,6];case 5:return u=Va(u=t.sent(),"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,i,a,c,h,l,o})})}function uf(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:n=i,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Bc,c=e,h=(a=o).nt,l=c.La,c.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var i=c.Ua.wo({Eo:!0});l=c.La;var u=[];a.zt.forEach(function(t,e){var n,r,i,o=l.get(e);o&&(u.push(c.sa.Uo(s,t.se,e).next(function(){return c.sa.Bo(s,t.ee,e)})),0<(i=t.resumeToken).o()&&(n=o.it(i,h).st(s.Wo),l=l.ot(e,n),r=o,i=t,Fr(0<(o=n).resumeToken.o()),(0===r.resumeToken.o()||3e8<=o.nt.p()-r.nt.p()||0<i.ee.size+i.ne.size+i.se.size)&&u.push(c.sa.Oo(s,n))))});var t,o=Hi,n=$i();return a.Jt.forEach(function(t,e){n=n.add(t)}),u.push(i.getEntries(s,n).next(function(r){a.Jt.forEach(function(t,e){var n=r.get(t);e instanceof hu&&e.version.isEqual(li.min())?(i.pi(t,h),o=o.ot(t,e)):null==n||0<e.version.u(n.version)||0===e.version.u(n.version)&&n.hasPendingWrites?(i.Vi(e,h),o=o.ot(t,e)):Vr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Yt.has(t)&&u.push(c.persistence.qr.Ma(s,t))})})),h.isEqual(li.min())||(t=c.sa.So(s).next(function(t){return c.sa.Co(s,s.Wo,h)}),u.push(t)),fa.On(u).next(function(){return i.apply(s)}).next(function(){return c.Ka.Ui(s,o)})}).then(function(t){return c.La=l,t}))];case 2:return r=t.sent(),o.zt.forEach(function(t,e){(e=n.kh.get(e))&&(Fr(t.ee.size+t.ne.size+t.se.size<=1),0<t.ee.size?e.yh=!0:0<t.ne.size?Fr(e.yh):0<t.se.size&&(Fr(e.yh),e.yh=!1))}),[4,vf(n,r,o)];case 3:return t.sent(),[3,6];case 4:return[4,Xh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,a,c,h,l})})}function af(t,n,e){var r;((t=t).Uh&&0===e||!t.Uh&&1===e)&&(r=[],t.Nh.forEach(function(t,e){(e=e.view.Ks(n)).snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.Bs.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Ks(i)&&(o=!0)}),o&&Fa(t)}(t.bh,n),r.length&&t.Ch.Tc(r),t.onlineState=n,t.Uh&&t.Sh.zu(n))}function cf(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:wl((n=o).ph)||Vr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Bc).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Oi.Jr(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Lh.get(r)||[]).push(s),n.Lh.set(r,i),[3,4]);case 3:return i=Va(i=t.sent(),"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function hf(t,e){(t.Lh.get(e)||[]).forEach(function(t){t.resolve()}),t.Lh.delete(e)}function lf(t,e,n){var r=t,i=r.$h[r.currentUser.ti()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.$h[r.currentUser.ti()]=i)}function ff(e,t,n){void 0===n&&(n=null),e.Sh.Uu(t);for(var r=0,i=e.xh.get(t);r<i.length;r++){var o=i[r];e.Nh.delete(o),n&&e.Ch.Qh(o,n)}e.xh.delete(t),e.Uh&&e.Mh.hu(t).forEach(function(t){e.Mh.ro(t)||pf(e,t)})}function pf(t,e){var n=t.Oh.get(e);null!==n&&(dl(t.ph,n),t.Oh=t.Oh.remove(e),t.kh.delete(n),yf(t))}function df(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var u=s[o];u instanceof Gl?(t.Mh.qo(u.key,e),r=t,i=(i=u).key,r.Oh.get(i)||(Vr("SyncEngine","New document in limbo: "+i),r.Fh.push(i),yf(r))):u instanceof zl?(Vr("SyncEngine","Document no longer in limbo: "+u.key),t.Mh.Ko(u.key,e),t.Mh.ro(u.key)||pf(t,u.key)):Mr()}}function yf(t){for(;0<t.Fh.length&&t.Oh.size<t.Dh;){var e=t.Fh.shift(),n=t.Bh.next();t.kh.set(n,new Wl(e)),t.Oh=t.Oh.ot(e,n),pl(t.ph,new Li(Tu(gu(e.path)),n,2,ec.ir))}}function vf(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Nh.P()?[3,3]:(n.Nh.forEach(function(t,e){o.push(n.Kh(e,s,u).then(function(t){t&&(n.Uh&&n.Sh.Wu(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=tc.Zi(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.Ch.Tc(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return fa.forEach(c,function(e){return fa.forEach(e.Yi,function(t){return r.persistence.qr.qo(n,e.targetId,t)}).next(function(){return fa.forEach(e.Xi,function(t){return r.persistence.qr.Ko(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Ia(e=t.sent()))throw e;return Vr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.La.get(o),u=s.nt,u=s.rt(u),r.La=r.La.ot(o,u));return[2]}})})}(n.Bc,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function gf(p,d){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,l,f;return v(this,function(t){switch(t.label){case 0:e=p,n=[],r=[],i=0,o=d,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.xh.get(s))&&0!==a.length?[4,Wh(e.Bc,Tu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(l=h[c],l=e.Nh.get(l),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Qh((e=r).Bc,i.query,!0)];case 1:return n=t.sent(),n=i.view.gh(n),[2,(e.Uh&&df(e,i.targetId,n.Rh),n)]}})})}(e,l)]):[3,6];case 4:(l=t.sent()).snapshot&&r.push(l.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,Yh(e.Bc,s)];case 8:return f=t.sent(),[4,Wh(e.Bc,f)];case 9:return u=t.sent(),[4,of(e,mf(f),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.Ch.Tc(r),n)]}})})}function mf(t){return vu(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function wf(t){return t.ph.Uc.Xc=uf.bind(null,t),t.ph.Uc.qe=function(t,e){var n=t;if((t=n.kh.get(e))&&t.yh)return $i().add(t.key);var r=$i();if(!(e=n.xh.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Nh.get(s),r=r.kt(s.view.dh);return r}.bind(null,t),t.ph.Uc.Yc=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Sh.Wu(s,"rejected",u),i=e.kh.get(s),(n=i&&i.key)?(r=(r=new Ui(yi.D)).ot(n,new hu(n,li.min())),i=$i().add(n),i=new ro(li.min(),new Map,new zi(Gr),r,i),[4,uf(e,i)]):[3,2];case 1:return t.sent(),e.Oh=e.Oh.remove(n),e.kh.delete(s),yf(e),[3,4];case 2:return[4,Jh(e.Bc,s,!1).then(function(){return ff(e,s,u)}).catch(Xh)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,t),t.Ch.Tc=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query;if(u=n.Bs.get(u)){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Qs(s)&&(r=!0);u.Ls=s}}r&&Fa(n)}.bind(null,t.bh),t.Ch.Qh=function(t,e,n){var r=t;if(t=r.Bs.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.Bs.delete(e)}.bind(null,t.bh),t}function bf(t){return t.ph.Uc.Zc=function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Bc,h=s,(l=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=h.batch.keys(),n=l.Ua.wo({Eo:!0}),i=l,o=t,s=n,u=(r=h).batch,a=u.keys(),c=fa.resolve();return a.forEach(function(n){c=c.next(function(){return s.bi(o,n)}).next(function(t){var e=t;Fr(null!==(t=r.Ai.get(n))),(!e||e.version.u(t)<0)&&(e=u.wi(n,e,r))&&s.Vi(e,r.mi)})}),c.next(function(){return i.Oi.Zr(o,u)}).next(function(){return n.apply(t)}).next(function(){return l.Oi.io(t)}).next(function(){return l.Ka.qi(t,e)})}))];case 2:return i=t.sent(),lf(n,r,null),hf(n,r),n.Sh.$u(r,"acknowledged"),[4,vf(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,Xh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,h,l})})}.bind(null,t),t.ph.Uc.tu=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Bc,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Oi.Gr(e,r).next(function(t){return Fr(null!==t),n=t.keys(),i.Oi.Zr(e,t)}).next(function(){return i.Oi.io(e)}).next(function(){return i.Ka.qi(e,n)})}))];case 2:return o=t.sent(),lf(n,u,a),hf(n,u),n.Sh.$u(u,"rejected",a),[4,vf(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Xh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,t),t}var If,Ef,_f,Tf=(Qf.prototype.Qa=function(t){this.Wh=t},Qf.prototype.Qi=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.on.length||1===r.on.length&&r.on[0].field.W())||i.isEqual(li.min())?this.jh(e,r):this.Wh.qi(e,o).next(function(t){var n=s.Gh(r,t);return(mu(r)||wu(r))&&s.Ih(r.an,n,o,i)?s.jh(e,r):(Rr()<=f.DEBUG&&Vr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),xu(r)),s.Wh.Qi(e,r,i).next(function(e){return n.forEach(function(t){e=e.ot(t.key,t)}),e}))})},Qf.prototype.Gh=function(n,t){var r=new zi(ku(n));return t.forEach(function(t,e){e instanceof cu&&Pu(n,e)&&(r=r.add(e))}),r},Qf.prototype.Ih=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version.u(r))},Qf.prototype.jh=function(t,e){return Rr()<=f.DEBUG&&Vr("IndexFreeQueryEngine","Using full collection scan to execute query:",xu(e)),this.Wh.Qi(t,e,li.min())},Qf),Af=(Jf.prototype.Qr=function(t){return fa.resolve(0===this.Oi.length)},Jf.prototype.Wr=function(t,e,n,r){var i=this.zh;this.zh++,0<this.Oi.length&&this.Oi[this.Oi.length-1],n=new Ya(i,e,n,r),this.Oi.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Hh=this.Hh.add(new xl(u.key,i)),this.ki.jr(t,u.key.path.F())}return fa.resolve(n)},Jf.prototype.Gr=function(t,e){return fa.resolve(this.Jh(e))},Jf.prototype.Hr=function(t,e){return e+=1,e=(e=this.Yh(e))<0?0:e,fa.resolve(this.Oi.length>e?this.Oi[e]:null)},Jf.prototype.Jr=function(){return fa.resolve(0===this.Oi.length?-1:this.zh-1)},Jf.prototype.Yr=function(t){return fa.resolve(this.Oi.slice())},Jf.prototype.$i=function(t,e){var n=this,r=new xl(e,0),e=new xl(e,Number.POSITIVE_INFINITY),i=[];return this.Hh.xt([r,e],function(t){t=n.Jh(t.fu),i.push(t)}),fa.resolve(i)},Jf.prototype.Ki=function(t,e){var n=this,r=new zi(Gr);return e.forEach(function(t){var e=new xl(t,0),t=new xl(t,Number.POSITIVE_INFINITY);n.Hh.xt([e,t],function(t){r=r.add(t.fu)})}),fa.resolve(this.Xh(r))},Jf.prototype.Hi=function(t,e){var n=e.path,r=n.length+1,e=n;yi.X(e)||(e=e.child(""));var e=new xl(new yi(e),0),i=new zi(Gr);return this.Hh.Ft(function(t){var e=t.key.path;return!!n.M(e)&&(e.length===r&&(i=i.add(t.fu)),!0)},e),fa.resolve(this.Xh(i))},Jf.prototype.Xh=function(t){var e=this,n=[];return t.forEach(function(t){null!==(t=e.Jh(t))&&n.push(t)}),n},Jf.prototype.Zr=function(n,r){var i=this;Fr(0===this.Zh(r.batchId,"removed")),this.Oi.shift();var o=this.Hh;return fa.forEach(r.mutations,function(t){var e=new xl(t.key,r.batchId);return o=o.delete(e),i.qr.so(n,t.key)}).next(function(){i.Hh=o})},Jf.prototype.no=function(t){},Jf.prototype.ro=function(t,e){var n=new xl(e,0),n=this.Hh.Ot(n);return fa.resolve(e.isEqual(n&&n.key))},Jf.prototype.io=function(t){return this.Oi.length,fa.resolve()},Jf.prototype.Zh=function(t,e){return this.Yh(t)},Jf.prototype.Yh=function(t){return 0===this.Oi.length?0:t-this.Oi[0].batchId},Jf.prototype.Jh=function(t){return(t=this.Yh(t))<0||t>=this.Oi.length?null:this.Oi[t]},Jf),Nf=(Wf.prototype.Vi=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this.tl(e);return this.docs=this.docs.ot(r,{ho:e,size:o,readTime:n}),this.size+=o-i,this.ki.jr(t,r.path.F())},Wf.prototype.pi=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Wf.prototype.bi=function(t,e){return e=this.docs.get(e),fa.resolve(e?e.ho:null)},Wf.prototype.getEntries=function(t,e){var n=this,r=Hi;return e.forEach(function(t){var e=n.docs.get(t);r=r.ot(t,e?e.ho:null)}),fa.resolve(r)},Wf.prototype.Qi=function(t,e,n){for(var r=Qi,i=new yi(e.path.child("")),o=this.docs.ft(i);o.At();){var s=(u=o.It()).key,u=(a=u.value).ho,a=a.readTime;if(!e.path.M(s.path))break;a.u(n)<=0||u instanceof cu&&Pu(e,u)&&(r=r.ot(u.key,u))}return fa.resolve(r)},Wf.prototype.el=function(t,e){return fa.forEach(this.docs,function(t){return e(t)})},Wf.prototype.wo=function(t){return new Df(this)},Wf.prototype.To=function(t){return fa.resolve(this.size)},Wf),Df=(n(Hf,_f=l),Hf.prototype.Di=function(n){var r=this,i=[];return this.Ri.forEach(function(t,e){e?i.push(r.Io.Vi(n,e,r.readTime)):r.Io.pi(t)}),fa.On(i)},Hf.prototype.vi=function(t,e){return this.Io.bi(t,e)},Hf.prototype.Si=function(t,e){return this.Io.getEntries(t,e)},Hf),Sf=(Kf.prototype.Ce=function(t,n){return this.nl.forEach(function(t,e){return n(e)}),fa.resolve()},Kf.prototype.So=function(t){return fa.resolve(this.lastRemoteSnapshotVersion)},Kf.prototype.Do=function(t){return fa.resolve(this.sl)},Kf.prototype.po=function(t){return this.highestTargetId=this.rl.next(),fa.resolve(this.highestTargetId)},Kf.prototype.Co=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.sl&&(this.sl=e),fa.resolve()},Kf.prototype.xo=function(t){this.nl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.rl=new Th(e),this.highestTargetId=e),t.sequenceNumber>this.sl&&(this.sl=t.sequenceNumber)},Kf.prototype.No=function(t,e){return this.xo(e),this.targetCount+=1,fa.resolve()},Kf.prototype.Oo=function(t,e){return this.xo(e),fa.resolve()},Kf.prototype.ko=function(t,e){return this.nl.delete(e.target),this.il.hu(e.targetId),--this.targetCount,fa.resolve()},Kf.prototype.Or=function(n,r,i){var o=this,s=0,u=[];return this.nl.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.nl.delete(t),u.push(o.Mo(n,e.targetId)),s++)}),fa.On(u).next(function(){return s})},Kf.prototype.$o=function(t){return fa.resolve(this.targetCount)},Kf.prototype.Lo=function(t,e){return e=this.nl.get(e)||null,fa.resolve(e)},Kf.prototype.Bo=function(t,e,n){return this.il.au(e,n),fa.resolve()},Kf.prototype.Uo=function(e,t,n){this.il.uu(t,n);var r=this.persistence.qr,i=[];return r&&t.forEach(function(t){i.push(r.so(e,t))}),fa.On(i)},Kf.prototype.Mo=function(t,e){return this.il.hu(e),fa.resolve()},Kf.prototype.Qo=function(t,e){return e=this.il._u(e),fa.resolve(e)},Kf.prototype.ro=function(t,e){return fa.resolve(this.il.ro(e))},Kf),Of=(zf.prototype.start=function(){return Promise.resolve()},zf.prototype.ga=function(){return this.Ho=!1,Promise.resolve()},Object.defineProperty(zf.prototype,"br",{get:function(){return this.Ho},enumerable:!1,configurable:!0}),zf.prototype.ha=function(){},zf.prototype.la=function(){},zf.prototype.Na=function(){return this.ki},zf.prototype.Sa=function(t){var e=this.ol[t.ti()];return e||(e=new Af(this.ki,this.qr),this.ol[t.ti()]=e),e},zf.prototype.Da=function(){return this.sa},zf.prototype.Ca=function(){return this.Fi},zf.prototype.runTransaction=function(t,e,n){var r=this;Vr("MemoryPersistence","Starting transaction:",t);var i=new xf(this.zo.next());return this.qr.cl(),n(i).next(function(t){return r.qr.ul(i).next(function(){return t})}).xn().then(function(t){return i.xi(),t})},zf.prototype.hl=function(e,n){return fa.kn(Object.values(this.ol).map(function(t){return function(){return t.ro(e,n)}}))},zf),xf=(n(Gf,Ef=we),Gf),Pf=(Bf.fl=function(t){return new Bf(t)},Object.defineProperty(Bf.prototype,"dl",{get:function(){if(this._l)return this._l;throw Mr()},enumerable:!1,configurable:!0}),Bf.prototype.qo=function(t,e,n){return this.ll.qo(n,e),this.dl.delete(n.toString()),fa.resolve()},Bf.prototype.Ko=function(t,e,n){return this.ll.Ko(n,e),this.dl.add(n.toString()),fa.resolve()},Bf.prototype.so=function(t,e){return this.dl.add(e.toString()),fa.resolve()},Bf.prototype.removeTarget=function(t,e){var n=this;this.ll.hu(e.targetId).forEach(function(t){return n.dl.add(t.toString())});var r=this.persistence.Da();return r.Qo(t,e.targetId).next(function(t){t.forEach(function(t){return n.dl.add(t.toString())})}).next(function(){return r.ko(t,e)})},Bf.prototype.cl=function(){this._l=new Set},Bf.prototype.ul=function(n){var r=this,i=this.persistence.Ca().wo();return fa.forEach(this.dl,function(t){var e=yi.H(t);return r.wl(n,e).next(function(t){t||i.pi(e)})}).next(function(){return r._l=null,i.apply(n)})},Bf.prototype.Ma=function(t,e){var n=this;return this.wl(t,e).next(function(t){t?n.dl.delete(e.toString()):n.dl.add(e.toString())})},Bf.prototype.al=function(t){return 0},Bf.prototype.wl=function(t,e){var n=this;return fa.kn([function(){return fa.resolve(n.ll.ro(e))},function(){return n.persistence.Da().ro(t,e)},function(){return n.persistence.hl(t,e)}])},Bf),kf=(jf.prototype.wc=function(t){this.Il=t},jf.prototype.hc=function(t){this.ml=t},jf.prototype.onMessage=function(t){this.Al=t},jf.prototype.close=function(){this.Tl()},jf.prototype.send=function(t){this.El(t)},jf.prototype.Rl=function(){this.Il()},jf.prototype.Pl=function(t){this.ml(t)},jf.prototype.gl=function(t){this.Al(t)},jf),Lf={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Rf=(Ff.prototype.Sc=function(e,t,n,r){var i=this.bl(e,t);return Vr("RestConnection","Sending: ",i,n),t={},this.vl(t,r),this.Sl(e,i,t,n).then(function(t){return Vr("RestConnection","Received: ",t),t},function(t){throw Ur("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Ff.prototype.Dc=function(t,e,n,r){return this.Sc(t,e,n,r)},Ff.prototype.vl=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.0.2-20201010222127",t["Content-Type"]="text/plain",e)for(var n in e.si)e.si.hasOwnProperty(n)&&(t[n]=e.si[n])},Ff.prototype.bl=function(t,e){return t=Lf[t],this.yl+"/v1/"+e+":"+t},n(Mf,If=Ff),Mf.prototype.Sl=function(o,e,s,u){return new Promise(function(n,r){var i=new yr;i.listenOnce(pr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case fr.NO_ERROR:var t=i.getResponseJson();Vr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case fr.TIMEOUT:Vr("Connection",'RPC "'+o+'" timed out'),r(new xr(Or.DEADLINE_EXCEEDED,"Request time out"));break;case fr.HTTP_ERROR:var e=i.getStatus();Vr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Or).indexOf(e)?e:Or.UNKNOWN,r(new xr(e,t.message))):r(new xr(Or.UNKNOWN,"Server responded with status "+i.getStatus())):r(new xr(Or.UNAVAILABLE,"Connection failed."));break;default:Mr()}}finally{Vr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},Mf.prototype.Ec=function(t,e){var n,r=[this.yl,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new ur,t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this._.projectId+"/databases/"+this._.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.T};this.vl(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(d())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=d().indexOf("Electron/")||0<=(n=d()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=d().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),Vr("Connection","Creating WebChannel: "+(r=r.join("")),t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new kf({El:function(t){u?Vr("Connection","Not sending because WebChannel is closed:",t):(s||(Vr("Connection","Opening WebChannel transport."),o.open(),s=!0),Vr("Connection","WebChannel sending:",t),o.send(t))},Tl:function(){return o.close()}});return(t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})})(dr.EventType.OPEN,function(){u||Vr("Connection","WebChannel transport opened.")}),t(dr.EventType.CLOSE,function(){u||(u=!0,Vr("Connection","WebChannel transport closed"),a.Pl())}),t(dr.EventType.ERROR,function(t){u||(u=!0,Ur("Connection","WebChannel transport errored:",t),a.Pl(new xr(Or.UNAVAILABLE,"The operation could not be completed")))}),t(dr.EventType.MESSAGE,function(t){var e,n,r,i;u||(Fr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Vr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=ki[r];if(void 0!==t)return Ci(t)}(),i=n.message,void 0===t&&(t=Or.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.Pl(new xr(t,i)),o.close()):(Vr("Connection","WebChannel received:",e),a.gl(e)))}),setTimeout(function(){a.Rl()},0),a},Mf),Vf=(qf.prototype.zc=function(t){this.Fl.push(t)},qf.prototype.ga=function(){window.removeEventListener("online",this.Dl),window.removeEventListener("offline",this.Nl)},qf.prototype.Ol=function(){window.addEventListener("online",this.Dl),window.addEventListener("offline",this.Nl)},qf.prototype.Cl=function(){Vr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Fl;t<e.length;t++)(0,e[t])(0)},qf.prototype.xl=function(){Vr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Fl;t<e.length;t++)(0,e[t])(1)},qf.Ln=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},qf),Cf=(Uf.prototype.zc=function(t){},Uf.prototype.ga=function(){},Uf);function Uf(){}function qf(){var t=this;this.Dl=function(){return t.Cl()},this.Nl=function(){return t.xl()},this.Fl=[],this.Ol()}function Mf(t){var e=this;return(e=If.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.T=t.T,e}function Ff(t){this.Vl=t,this._=t._;var e=t.ssl?"https":"http";this.yl=e+"://"+t.host,this.pl="projects/"+this._.projectId+"/databases/"+this._.database+"/documents"}function jf(t){this.El=t.El,this.Tl=t.Tl}function Bf(t){this.persistence=t,this.ll=new Ol,this._l=null}function Gf(t){var e=this;return(e=Ef.call(this)||this).Wo=t,e}function zf(t){var e=this;this.ol={},this.zo=new ec(0),this.Ho=!1,this.Ho=!0,this.qr=t(this),this.sa=new Sf(this),this.ki=new $c,this.Fi=(t=this.ki,new Nf(t,function(t){return e.qr.al(t)}))}function Kf(t){this.persistence=t,this.nl=new ci(Si,Oi),this.lastRemoteSnapshotVersion=li.min(),this.highestTargetId=0,this.sl=0,this.il=new Ol,this.targetCount=0,this.rl=Th.Vo()}function Hf(t){var e=this;return(e=_f.call(this)||this).Io=t,e}function Wf(t,e){this.ki=t,this.tl=e,this.docs=new Ui(yi.D),this.size=0}function Jf(t,e){this.ki=t,this.qr=e,this.Oi=[],this.zh=1,this.Hh=new zi(xl.iu)}function Qf(){}function Yf(t){return new Fo(t,!0)}var Xf,$f,Zf=(cp.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Sh=this.kl(e),this.persistence=this.Ml(e),[4,this.persistence.start()];case 1:return t.sent(),this.$l=this.Ll(e),this.Bc=this.Bl(e),[2]}})})},cp.prototype.Ll=function(t){return null},cp.prototype.Bl=function(t){return e=this.persistence,n=new Tf,t=t.ql,new Gh(e,n,t);var e,n},cp.prototype.Ml=function(t){return new Of(Pf.fl)},cp.prototype.kl=function(t){return new Bl},cp.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.$l&&this.$l.stop(),[4,this.Sh.ga()];case 1:return t.sent(),[4,this.persistence.ga()];case 2:return t.sent(),[2]}})})},cp),tp=(n(ap,$f=Zf),ap.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,$f.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=Qc(t),r=li.min(),t.rs({index:fh.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=xc(e.readTime)),n.done()}).next(function(){return r});var r}).then(function(t){e.qa=t})]})})}(this.Bc)];case 2:return t.sent(),[4,this.Ul.initialize(this,e)];case 3:return t.sent(),[4,bf(this.Ul.mu)];case 4:return t.sent(),[4,_l(this.Ul.ph)];case 5:return t.sent(),[2]}})})},ap.prototype.Ll=function(t){var e=this.persistence.qr.gr;return new wc(e,t.cs)},ap.prototype.Ml=function(t){var e=Bh(t.Vl._,t.Vl.persistenceKey),n=void 0!==this.cacheSizeBytes?vc.Ir(this.cacheSizeBytes):vc.Rr,r=Yf(t.Vl._);return new Rh(this.synchronizeTabs,e,t.clientId,n,t.cs,Oa(),xa(),r,this.Sh,!!this.forceOwnership)},ap.prototype.kl=function(t){return new Bl},ap),ep=(n(up,Xf=tp),up.prototype.initialize=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,Xf.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.Ul.mu,this.Sh instanceof jl?(this.Sh.mu={sh:function(u,a,c,h){return y(this,void 0,void 0,function(){var o,s;return v(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).Bc,n=a,i=(r=e).Oi,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.zr(e,n).next(function(t){return t?r.Ka.qi(e,t):fa.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,_l(o.ph)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(lf(o,a,h||null),hf(o,a),o.Bc.Oi.no(a)):Mr(),t.label=4;case 4:return[4,vf(o,s)];case 5:return t.sent(),[3,7];case 6:Vr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}.bind(null,e),ih:function(o,u,a,c){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:return(n=o).qh?(Vr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!n.xh.has(u))return[3,8];switch(a){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,(e=n.Bc,(s=e).persistence.runTransaction("Get new document changes","readonly",function(t){return e=s.Ua,n=t,t=s.qa,r=e,i=Hi,o=Oc(t),t=Qc(n),n=IDBKeyRange.lowerBound(o,!0),t.rs({index:fh.readTimeIndex,range:n},function(t,e){var n=Dc(r.serializer,e);i=i.ot(n.key,n),o=e.readTime}).next(function(){return{Ha:i,readTime:xc(o)}});var e,n,r,i,o}).then(function(t){var e=t.Ha,t=t.readTime;return s.qa=t,e}))];case 3:return r=t.sent(),i=ro.Xt(u,"current"===a),[4,vf(n,r,i)];case 4:return t.sent(),[3,8];case 5:return[4,Jh(n.Bc,u,!0)];case 6:return t.sent(),ff(n,u,c),[3,8];case 7:Mr(),t.label=8;case 8:return[2]}var e,s})})}.bind(null,e),rh:function(c,h,l){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a;return v(this,function(t){switch(t.label){case 0:if(!(n=wf(c)).qh)return[3,10];e=0,r=h,t.label=1;case 1:return e<r.length?(r=r[e],n.xh.has(r)?(Vr("SyncEngine","Adding an already active target "+r),[3,5]):[4,Yh(n.Bc,r)]):[3,6];case 2:return i=t.sent(),[4,Wh(n.Bc,i)];case 3:return o=t.sent(),[4,of(n,mf(i),o.targetId,!1)];case 4:t.sent(),pl(n.ph,o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return n.xh.has(e)?[4,Jh(n.Bc,e,!1).then(function(){dl(n.ph,e),ff(n,e)}).catch(Xh)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=0,a=l,t.label=7;case 7:return u<a.length?(a=a[u],[5,s(a)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})}.bind(null,e),va:function(t){return t.Bc.persistence.va()}.bind(null,e)},[4,this.Sh.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence.ua(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,function(h,l){return y(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return v(this,function(t){switch(t.label){case 0:return wf(r=h),bf(r),!0!==l||!0===r.qh?[3,3]:(e=r.Sh.xu(),[4,gf(r,e.L())]);case 1:return i=t.sent(),r.qh=!0,[4,Nl(r.ph,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],pl(r.ph,u);return[3,7];case 3:return!1!==l||!1===r.qh?[3,7]:(a=[],c=Promise.resolve(),r.xh.forEach(function(t,e){r.Sh.Ku(e)?a.push(e):c=c.then(function(){return ff(r,e),Jh(r.Bc,e,!0)}),dl(r.ph,e)}),[4,c]);case 4:return t.sent(),[4,gf(r,a)];case 5:return t.sent(),(n=r).kh.forEach(function(t,e){dl(n.ph,e)}),n.Mh.lu(),n.kh=new Map,n.Oh=new Ui(yi.D),r.qh=!1,[4,Nl(r.ph,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}(this.Ul.mu,e)];case 1:return t.sent(),this.$l&&(e&&!this.$l.br?this.$l.start(this.Bc):e||this.$l.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},up.prototype.kl=function(t){var e=Oa();if(!jl.Ln(e))throw new xr(Or.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Bh(t.Vl._,t.Vl.persistenceKey);return new jl(e,t.cs,n,t.clientId,t.ql)},up),np=(sp.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Bc?[3,2]:(this.Bc=n.Bc,this.Sh=n.Sh,this.qc=this.Kl(r),this.ph=this.Ql(r),this.bh=this.Wl(r),this.mu=this.jl(r,!n.synchronizeTabs),this.Sh.Cc=function(t){return af(e.mu,t,1)},this.ph.Uc.Gl=function(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Vr("SyncEngine","User change. New user:",o.ti()),[4,Kh(n.Bc,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Lh.forEach(function(t){t.forEach(function(t){t.reject(new xr(Or.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Lh.clear(),n.Sh.Gu(o,r.ja,r.Ga),[4,vf(n,r.Wa)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this.mu),[4,Nl(this.ph,this.mu.Uh)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},sp.prototype.Wl=function(t){return new Ca},sp.prototype.Kl=function(t){var e=Yf(t.Vl._),n=(n=t.Vl,new Rf(n));return t=t.credentials,new il(t,n,e)},sp.prototype.Ql=function(t){var e=this;return new $h(this.Bc,this.qc,t.cs,function(t){return af(e.mu,t,0)},t=new(Vf.Ln()?Vf:Cf))},sp.prototype.jl=function(t,e){return n=this.Bc,r=this.ph,i=this.bh,o=this.Sh,s=t.ql,t=t.Dh,e=e,t=new Jl(n,r,i,o,s,t),e&&(t.qh=!0),t;var n,r,i,o,s},sp.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Vr("RemoteStore","RemoteStore shutting down."),e.Wc.add(5),[4,fl(e)];case 1:return t.sent(),e.Gc.ga(),e.Hc.set("Unknown"),[2]}})})}(this.ph)},sp),rp=(op.prototype.next=function(t){this.observer.next&&this.zl(this.observer.next,t)},op.prototype.error=function(t){this.observer.error?this.zl(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},op.prototype.Hl=function(){this.muted=!0},op.prototype.zl=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},op),ip=function(t){this.Jl=t};function op(t){this.observer=t,this.muted=!1}function sp(){}function up(t,e){var n=this;return(n=Xf.call(this,t,e,!1)||this).Ul=t,n.cacheSizeBytes=e,n.synchronizeTabs=!0,n}function ap(t,e,n){var r=this;return(r=$f.call(this)||this).Ul=t,r.cacheSizeBytes=e,r.forceOwnership=n,r.synchronizeTabs=!1,r}function cp(){this.synchronizeTabs=!1}function hp(t,e,n){if(!n)throw new xr(Or.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function lp(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new xr(Or.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function fp(t,e,n,r){if(!0===e&&!0===r)throw new xr(Or.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function pp(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Mr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function dp(t,e){if(t instanceof ip&&(t=t.Jl),t instanceof e)return t;if(e.name===t.constructor.name)throw new xr(Or.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");throw t=pp(t),new xr(Or.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function yp(t,e){if(e<=0)throw new xr(Or.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var vp,gp=function(t){this.Yl=t},mp=(n(wp,vp=gp),wp.prototype.Xl=function(t){if(2!==t.Zl)throw 1===t.Zl?t.t_(this.Yl+"() can only appear at the top level of your update data"):t.t_(this.Yl+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},wp.prototype.isEqual=function(t){return t instanceof wp},wp);function wp(){return null!==vp&&vp.apply(this,arguments)||this}function bp(t,e,n){return new sd({Zl:3,e_:e.settings.e_,methodName:t.Yl,n_:n},e._,e.serializer,e.ignoreUndefinedProperties)}var Ip,Ep,_p,Tp,Ap,Np=(n(Gp,Ap=gp),Gp.prototype.Xl=function(t){return new xs(t.path,new ys)},Gp.prototype.isEqual=function(t){return t instanceof Gp},Gp),Dp=(n(Bp,Tp=gp),Bp.prototype.Xl=function(t){var e=bp(this,t,!0),n=this.s_.map(function(t){return dd(t,e)}),n=new vs(n);return new xs(t.path,n)},Bp.prototype.isEqual=function(t){return this===t},Bp),Sp=(n(jp,_p=gp),jp.prototype.Xl=function(t){var e=bp(this,t,!0),n=this.s_.map(function(t){return dd(t,e)}),n=new Is(n);return new xs(t.path,n)},jp.prototype.isEqual=function(t){return this===t},jp),Op=(n(Fp,Ep=gp),Fp.prototype.Xl=function(t){var e=new As(t.serializer,Go(t.serializer,this.i_));return new xs(t.path,e)},Fp.prototype.isEqual=function(t){return this===t},Fp),xp=(Object.defineProperty(Mp.prototype,"latitude",{get:function(){return this.r_},enumerable:!1,configurable:!0}),Object.defineProperty(Mp.prototype,"longitude",{get:function(){return this.o_},enumerable:!1,configurable:!0}),Mp.prototype.isEqual=function(t){return this.r_===t.r_&&this.o_===t.o_},Mp.prototype.toJSON=function(){return{latitude:this.r_,longitude:this.o_}},Mp.prototype.g=function(t){return Gr(this.r_,t.r_)||Gr(this.o_,t.o_)},Mp),Pp=new Map,kp=(qp.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},qp),Lp=(Up.prototype.h_=function(t){switch(_o(t)){case 0:return null;case 1:return t.booleanValue;case 2:return xo(t.integerValue||t.doubleValue);case 3:return this.l_(t.timestampValue);case 4:return this.__(t);case 5:return t.stringValue;case 6:return this.u_(Po(t.bytesValue));case 7:return this.f_(t.referenceValue);case 8:return this.d_(t.geoPointValue);case 9:return this.w_(t.arrayValue);case 10:return this.E_(t.mapValue);default:throw Mr()}},Up.prototype.E_=function(t){var n=this,r={};return oi(t.fields||{},function(t,e){r[t]=n.h_(e)}),r},Up.prototype.d_=function(t){return new xp(xo(t.latitude),xo(t.longitude))},Up.prototype.w_=function(t){var e=this;return(t.values||[]).map(function(t){return e.h_(t)})},Up.prototype.__=function(t){switch(this.a_){case"previous":var e=function t(e){return bo(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==e?null:this.h_(e);case"estimate":return this.l_(Io(t));default:return null}},Up.prototype.l_=function(t){return t=Oo(t),new hi(t.seconds,t.nanos)},Up.prototype.f_=function(t){var e=fi.q(t);return Fr(ls(e)),t=new ei(e.get(1),e.get(3)),e=new yi(e.N(5)),t.isEqual(this._)||Cr("Document "+e+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+this._.projectId+"/"+this._.database+") instead."),this.c_(e)},Up),l=(Object.defineProperty(Cp.prototype,"id",{get:function(){return this.I_.path.k()},enumerable:!1,configurable:!0}),Object.defineProperty(Cp.prototype,"ref",{get:function(){return new Wp(this.T_,this.A_,this.I_)},enumerable:!1,configurable:!0}),Cp.prototype.exists=function(){return null!==this.m_},Cp.prototype.data=function(){var e=this;if(this.m_){if(this.A_){var t=new Rp(this.T_,this.I_,this.m_,null);return this.A_.fromFirestore(t)}return new Lp(this.T_.R_,"none",function(t){return new Wp(e.T_,null,t)},function(t){return new Jr(t)}).h_(this.m_.rn())}},Cp.prototype.get=function(t){var e=this;if(this.m_&&null!==(t=this.m_.data().field(zp("DocumentSnapshot.get",t))))return new Lp(this.T_.R_,"none",function(t){return new Wp(e.T_,e.A_,t)},function(t){return new Jr(t)}).h_(t)},Cp),Rp=(n(Vp,Ip=l),Vp.prototype.data=function(){return Ip.prototype.data.call(this)},Vp);function Vp(){return null!==Ip&&Ip.apply(this,arguments)||this}function Cp(t,e,n,r){this.T_=t,this.I_=e,this.m_=n,this.A_=r}function Up(t,e,n,r){this._=t,this.a_=e,this.c_=n,this.u_=r}function qp(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new xr(Or.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new xr(Or.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,fp("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function Mp(t,e){if(!isFinite(t)||t<-90||90<t)throw new xr(Or.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new xr(Or.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.r_=t,this.o_=e}function Fp(t,e){var n=this;return(n=Ep.call(this,t)||this).i_=e,n}function jp(t,e){var n=this;return(n=_p.call(this,t)||this).s_=e,n}function Bp(t,e){var n=this;return(n=Tp.call(this,t)||this).s_=e,n}function Gp(){return null!==Ap&&Ap.apply(this,arguments)||this}function zp(t,e){return"string"==typeof e?bd(t,e):e.P_}var Kp,Hp=($p.prototype.isEqual=function(t){return this.P_.isEqual(t.P_)},$p),Wp=(Object.defineProperty(Xp.prototype,"g_",{get:function(){return this.I_.path},enumerable:!1,configurable:!0}),Object.defineProperty(Xp.prototype,"id",{get:function(){return this.I_.path.k()},enumerable:!1,configurable:!0}),Object.defineProperty(Xp.prototype,"path",{get:function(){return this.I_.path.B()},enumerable:!1,configurable:!0}),Object.defineProperty(Xp.prototype,"parent",{get:function(){return new Jp(this.firestore,this.A_,this.I_.path.F())},enumerable:!1,configurable:!0}),Xp.prototype.withConverter=function(t){return new Xp(this.firestore,t,this.I_)},Xp),Jp=(Yp.prototype.withConverter=function(t){return new Yp(this.firestore,t,this.V_)},n(Qp,Kp=Yp),Object.defineProperty(Qp.prototype,"id",{get:function(){return this.V_.path.k()},enumerable:!1,configurable:!0}),Object.defineProperty(Qp.prototype,"path",{get:function(){return this.V_.path.B()},enumerable:!1,configurable:!0}),Object.defineProperty(Qp.prototype,"parent",{get:function(){var t=this.g_.F();return t.P()?null:new Wp(this.firestore,null,new yi(t))},enumerable:!1,configurable:!0}),Qp.prototype.withConverter=function(t){return new Qp(this.firestore,t,this.g_)},Qp);function Qp(t,e,n){var r=this;return(r=Kp.call(this,t,e,gu(n))||this).firestore=t,r.g_=n,r.type="collection",r}function Yp(t,e,n){this.A_=e,this.V_=n,this.type="query",this.firestore=t}function Xp(t,e,n){this.A_=e,this.I_=n,this.type="document",this.firestore=t}function $p(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new xr(Or.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.P_=new di(t)}function Zp(t){var e=t.y_(),n=Yf(t.R_);return new ud(t.R_,!!e.ignoreUndefinedProperties,n)}var td=/^__.*__$/,ed=(id.prototype.p_=function(t,e){var n=[];return null!==this.Qe?n.push(new Bs(t,this.data,this.Qe,e)):n.push(new js(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Ws(t,this.fieldTransforms)),n},id),nd=(rd.prototype.p_=function(t,e){return e=[new Bs(t,this.data,this.Qe,e)],0<this.fieldTransforms.length&&e.push(new Ws(t,this.fieldTransforms)),e},rd);function rd(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function id(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function od(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Mr()}}var sd=(Object.defineProperty(cd.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(cd.prototype,"Zl",{get:function(){return this.settings.Zl},enumerable:!1,configurable:!0}),cd.prototype.v_=function(t){return new cd(Object.assign(Object.assign({},this.settings),t),this._,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},cd.prototype.S_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.v_({path:e,n_:!1})).D_(t),e},cd.prototype.C_=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t);return(t=this.v_({path:t,n_:!1})).b_(),t},cd.prototype.N_=function(t){return this.v_({path:void 0,n_:!0})},cd.prototype.t_=function(t){return Id(t,this.settings.methodName,this.settings.x_||!1,this.path,this.settings.e_)},cd.prototype.contains=function(e){return void 0!==this.Qe.find(function(t){return e.M(t)})||void 0!==this.fieldTransforms.find(function(t){return e.M(t.field)})},cd.prototype.b_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.D_(this.path.get(t))},cd.prototype.D_=function(t){if(0===t.length)throw this.t_("Document fields must not be empty");if(od(this.Zl)&&td.test(t))throw this.t_('Document fields cannot begin and end with "__"')},cd),ud=(ad.prototype.F_=function(t,e,n,r){return void 0===r&&(r=!1),new sd({Zl:t,methodName:e,e_:n,path:di.U(),n_:!1,x_:r},this._,this.serializer,this.ignoreUndefinedProperties)},ad);function ad(t,e,n){this._=t,this.ignoreUndefinedProperties=e,this.serializer=n||Yf(t)}function cd(t,e,n,r,i,o){this.settings=t,this._=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.b_(),this.fieldTransforms=i||[],this.Qe=o||[]}function hd(t,e,n,r,i,o){void 0===o&&(o={});var s=t.F_(o.merge||o.mergeFields?2:0,e,n,i);gd("Data must be an object, but it was:",s,r);var u,a,r=yd(r,s);if(o.merge)u=new Os(s.Qe),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,l=o.mergeFields;h<l.length;h++){var f=md(e,l[h],n);if(!s.contains(f))throw new xr(Or.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");Ed(c,f)||c.push(f)}u=new Os(c),a=s.fieldTransforms.filter(function(t){return u.Je(t.field)})}else u=null,a=s.fieldTransforms;return new ed(new tu(r),u,a)}function ld(t,r,i,e){var o=t.F_(1,r,i);gd("Data must be an object, but it was:",o,e);var s=[],u=new eu;return oi(e,function(t,e){var n=bd(r,t,i);e instanceof ip&&(e=e.Jl),t=o.C_(n),e instanceof mp?s.push(n):null!=(t=dd(e,t))&&(s.push(n),u.set(n,t))}),e=new Os(s),new nd(u.Xe(),e,o.fieldTransforms)}function fd(t,e,n,r,i,o){var s=t.F_(1,e,n),u=[md(e,r,n)],a=[i];if(o.length%2!=0)throw new xr(Or.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(md(e,o[c])),a.push(o[c+1]);for(var h,l,f,p=[],d=new eu,y=u.length-1;0<=y;--y)Ed(p,u[y])||(h=u[y],(l=a[y])instanceof ip&&(l=l.Jl),f=s.C_(h),l instanceof mp?p.push(h):null!=(f=dd(l,f))&&(p.push(h),d.set(h,f)));return i=new Os(p),new nd(d.Xe(),i,s.fieldTransforms)}function pd(t,e,n,r){return void 0===r&&(r=!1),dd(n,t.F_(r?4:3,e))}function dd(s,t){if(s instanceof ip&&(s=s.Jl),vd(s))return gd("Unsupported field value:",t,s),yd(s,t);if(s instanceof gp)return function(t,e){if(!od(e.Zl))throw e.t_(t.Yl+"() can only be used with update() and set()");if(!e.path)throw e.t_(t.Yl+"() is not currently supported inside arrays");(t=t.Xl(e))&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.Qe.push(t.path),s instanceof Array){if(t.settings.n_&&4!==t.Zl)throw t.t_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=dd(i[r],t.N_(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof ip&&(t=t.Jl),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Go(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=hi.fromDate(t);return{timestampValue:zo(e.serializer,n)}}if(t instanceof hi){var r=new hi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:zo(e.serializer,r)}}if(t instanceof xp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Jr)return{bytesValue:Ko(e.serializer,t.l)};if(t instanceof Wp){if(n=e._,!(r=t.firestore.R_).isEqual(n))throw e.t_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Wo(t.firestore.R_||e._,t.I_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.t_("Unsupported field value: "+pp(t))}(s,t)}function yd(t,n){var r={};return si(t)?n.path&&0<n.path.length&&n.Qe.push(n.path):oi(t,function(t,e){null!=(e=dd(e,n.S_(t)))&&(r[t]=e)}),{mapValue:{fields:r}}}function vd(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof hi||t instanceof xp||t instanceof Jr||t instanceof Wp||t instanceof gp)}function gd(t,e,n){if(!vd(n)||"object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))throw"an object"===(n=pp(n))?e.t_(t+" a custom object"):e.t_(t+" "+n);var r}function md(t,e,n){if(e instanceof ip&&(e=e.Jl),e instanceof Hp)return e.P_;if("string"==typeof e)return bd(t,e);throw Id("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var wd=new RegExp("[~\\*/\\[\\]]");function bd(e,n,r){if(0<=n.search(wd))throw Id("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(Hp.bind.apply(Hp,o([void 0],n.split("."))))).P_}catch(t){throw Id("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function Id(t,e,n,r,i){var o=r&&!r.P(),s=void 0!==i,e="Function "+e+"() called with invalid data";return n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new xr(Or.INVALID_ARGUMENT,(e+=". ")+t+n)}function Ed(t,e){return t.some(function(t){return t.isEqual(e)})}var _d=(Sd.prototype.B_=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.q_(),0<this.mutations.length)throw new xr(Or.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var r,e,n,i,o;return v(this,function(t){switch(t.label){case 0:return e=Zo((r=s).serializer)+"/documents",n={documents:u.map(function(t){return Qo(r.serializer,t)})},[4,r.Dc("BatchGetDocuments",e,n)];case 1:return n=t.sent(),i=new Map,n.forEach(function(t){var e,n,t=(n=r.serializer,"found"in t?function(t,e){Fr(!!e.found),e.found.name,e.found.updateTime;var n=Yo(t,e.found.name),t=Ho(e.found.updateTime),e=new tu({mapValue:{fields:e.found.fields}});return new cu(n,t,e,{})}(n,t):"missing"in t?(e=n,Fr(!!(n=t).missing),Fr(!!n.readTime),e=Yo(e,n.missing),n=Ho(n.readTime),new hu(e,n)):Mr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){Fr(!!(t=i.get(t.toString()))),o.push(t)}),o)]}})})}(this.qc,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof hu||t instanceof cu?n.U_(t):Mr()}),e)]}})})},Sd.prototype.set=function(t,e){this.write(e.p_(t,this.Ge(t))),this.L_.add(t.toString())},Sd.prototype.update=function(t,e){try{this.write(e.p_(t,this.K_(t)))}catch(t){this.M_=t}this.L_.add(t.toString())},Sd.prototype.delete=function(t){this.write([new $s(t,this.Ge(t))]),this.L_.add(t.toString())},Sd.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.q_(),this.M_)throw this.M_;return e=this.O_,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=yi.H(e),n.mutations.push(new Zs(e,n.Ge(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=Zo((e=i).serializer)+"/documents",r={writes:o.map(function(t){return ns(e.serializer,t)})},[4,e.Sc("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.qc,this.mutations)];case 1:return t.sent(),this.k_=!0,[2]}})})},Sd.prototype.U_=function(t){var e;if(t instanceof cu)e=t.version;else{if(!(t instanceof hu))throw Mr();e=li.min()}var n=this.O_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new xr(Or.ABORTED,"Document version changed between two reads.")}else this.O_.set(t.key.toString(),e)},Sd.prototype.Ge=function(t){var e=this.O_.get(t.toString());return!this.L_.has(t.toString())&&e?Ls.updateTime(e):Ls.ze()},Sd.prototype.K_=function(t){var e=this.O_.get(t.toString());if(this.L_.has(t.toString())||!e)return Ls.exists(!0);if(e.isEqual(li.min()))throw new xr(Or.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ls.updateTime(e)},Sd.prototype.write=function(t){this.q_(),this.mutations=this.mutations.concat(t)},Sd.prototype.q_=function(){},Sd),Td=(Dd.prototype.run=function(){this.W_()},Dd.prototype.W_=function(){var t=this;this.Vs.Pn(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new _d(this.qc),(n=this.j_(e))&&n.then(function(t){r.cs.ws(function(){return e.commit().then(function(){r.ls.resolve(t)}).catch(function(t){r.G_(t)})})}).catch(function(t){r.G_(t)}),[2]})})})},Dd.prototype.j_=function(t){try{var e=this.updateFunction(t);return!_i(e)&&e.catch&&e.then?e:(this.ls.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.ls.reject(t),null}},Dd.prototype.G_=function(t){var e=this;0<this.Q_&&this.z_(t)?(--this.Q_,this.cs.ws(function(){return e.W_(),Promise.resolve()})):this.ls.reject(t)},Dd.prototype.z_=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!Vi(t))},Dd),Ad=(Nd.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.ui.promise];case 1:return[2,(t.sent(),{cs:this.cs,Vl:this.Vl,clientId:this.clientId,credentials:this.credentials,ql:this.user,Dh:100})]}})})},Nd.prototype.J_=function(t){var e=this;this.H_=t,this.ui.promise.then(function(){return e.H_(e.user)})},Nd.prototype.Y_=function(){if(this.cs.ps)throw new xr(Or.FAILED_PRECONDITION,"The client has already been terminated.")},Nd.prototype.terminate=function(){var t=this;this.cs.Ds();var n=new ha;return this.cs.bs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.X_?[4,this.X_.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.Z_?[4,this.Z_.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.ai(),n.resolve(),[3,6];case 5:return e=Va(t.sent(),"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},Nd);function Nd(t,e,n){var r=this;this.credentials=t,this.cs=e,this.Vl=n,this.user=Ba.UNAUTHENTICATED,this.clientId=jr.t(),this.H_=function(){},this.ui=new ha,this.credentials.oi(function(t){Vr("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.H_(t)),r.ui.resolve()})}function Dd(t,e,n,r){this.cs=t,this.qc=e,this.updateFunction=n,this.ls=r,this.Q_=5,this.Vs=new la(this.cs,"transaction_retry")}function Sd(t){this.qc=t,this.O_=new Map,this.mutations=[],this.k_=!1,this.M_=null,this.L_=new Set}function Od(r,i){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return r.cs.Fs(),Vr("FirestoreClient","Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return e=t.sent(),[4,i.initialize(e)];case 2:return t.sent(),r.J_(function(e){return r.cs.Cs(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Kh(i.Bc,e)];case 1:return t.sent(),[2]}})})})}),i.persistence.ha(function(){return r.terminate()}),r.Z_=i,[2]}})})}function xd(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.cs.Fs(),[4,Pd(r)];case 1:return e=t.sent(),Vr("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.J_(function(t){return r.cs.Cs(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).cs.Fs(),Vr("RemoteStore","RemoteStore received new credentials"),n=wl(e),e.Wc.add(3),[4,fl(e)];case 1:return t.sent(),n&&e.Hc.set("Unknown"),[4,e.Uc.Gl(i)];case 2:return t.sent(),e.Wc.delete(3),[4,ll(e)];case 3:return t.sent(),[2]}})})}(i.ph,t)})}),r.X_=i,[2]}})})}function Pd(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.Z_?[3,2]:(Vr("FirestoreClient","Using default OfflineComponentProvider"),[4,Od(e,new Zf)]);case 1:t.sent(),t.label=2;case 2:return[2,e.Z_]}})})}function kd(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.X_?[3,2]:(Vr("FirestoreClient","Using default OnlineComponentProvider"),[4,xd(e,new np)]);case 1:t.sent(),t.label=2;case 2:return[2,e.X_]}})})}function Ld(t){return Pd(t).then(function(t){return t.persistence})}function Rd(t){return Pd(t).then(function(t){return t.Bc})}function Vd(t){return kd(t).then(function(t){return t.ph})}function Cd(t){return kd(t).then(function(t){return t.mu})}function Ud(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,kd(r)];case 1:return e=t.sent(),[2,((n=e.bh).Us=function(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=wf(s),(o=e.Nh.get(u))?(n=o.targetId,e.Sh.Bu(n),r=o.view.Vh(),[3,4]):[3,1];case 1:return[4,Wh(e.Bc,Tu(u))];case 2:return i=t.sent(),o=e.Sh.Bu(i.targetId),n=i.targetId,[4,of(e,u,n,"current"===o)];case 3:r=t.sent(),e.Uh&&pl(e.ph,i),t.label=4;case 4:return[2,r]}})})}.bind(null,e.mu),n.Ws=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Nh.get(o),1<(r=e.xh.get(n.targetId)).length?[2,(e.xh.set(n.targetId,r.filter(function(t){return!Su(t,o)})),void e.Nh.delete(o))]:e.Uh?(e.Sh.Uu(n.targetId),e.Sh.Ou(n.targetId)?[3,2]:[4,Jh(e.Bc,n.targetId,!1).then(function(){e.Sh.Qu(n.targetId),dl(e.ph,n.targetId),ff(e,n.targetId)}).catch(Xh)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return ff(e,n.targetId),[4,Jh(e.Bc,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.mu),n)]}})})}function qd(n,r){var t=this,i=new ha;return n.cs.ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=sf,[4,Cd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}function Md(n,r,i,o,s){var t=new rp({next:function(t){r.ws(function(){return Ma(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new xr(Or.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new xr(Or.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new ja(gu(i.path),t,{includeMetadataChanges:!0,Xs:!0});return qa(n,u)}function Fd(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var jd,Bd=(Object.defineProperty(zd.prototype,"app",{get:function(){if(!this.if)throw new xr(Or.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.if},enumerable:!1,configurable:!0}),Object.defineProperty(zd.prototype,"rf",{get:function(){return this.nf},enumerable:!1,configurable:!0}),Object.defineProperty(zd.prototype,"af",{get:function(){return void 0!==this.cf},enumerable:!1,configurable:!0}),zd.prototype.uf=function(t){if(this.nf)throw new xr(Or.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.ef=new kp(t),void 0!==t.credentials&&(this.sf=function(t){if(!t)return new Ha;switch(t.type){case"gapi":var e=t.client;return Fr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Qa(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new xr(Or.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},zd.prototype.hf=function(){return this.ef},zd.prototype.y_=function(){return this.nf=!0,this.ef},zd.prototype._delete=function(){return this.cf||(this.cf=this.lf()),this.cf},zd.prototype.lf=function(){return(t=Pp.get(this))&&(Vr("ComponentProvider","Removing Datastore"),Pp.delete(this),t.terminate()),Promise.resolve();var t},n(Gd,jd=zd),Gd.prototype.lf=function(){return this.ff||hy(this),this.ff.terminate()},Gd);function Gd(t,e){var n=this;return(n=jd.call(this,t,e)||this)._f=new ka,n.tf="name"in t?t.name:"[DEFAULT]",n}function zd(t,e){this.tf="(lite)",this.ef=new kp({}),this.nf=!1,t instanceof ei?(this.R_=t,this.sf=new Ha):(this.if=t,this.R_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new xr(Or.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ei(t.options.projectId)}(t),this.sf=new Wa(e))}function Kd(n,r,i){var t=this,o=new ha;return n.cs.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,Od(n,i)];case 1:return t.sent(),[4,xd(n,r)];case 2:return t.sent(),o.resolve(),[3,4];case 3:if(!("FirebaseError"===(t=e=t.sent()).name?t.code===Or.FAILED_PRECONDITION||t.code===Or.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code))throw e;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),o.reject(e),[3,4];case 4:return[2]}})})}).then(function(){return o.promise})}function Hd(t){if(t.rf||t.af)throw new xr(Or.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Wd,Jd,Qd=(n(ty,Jd=l),ty.prototype.exists=function(){return Jd.prototype.exists.call(this)},ty.prototype.data=function(t){var e=this;if(this.m_){if(this.A_){var n=new Yd(this.T_,this.I_,this.m_,this.metadata,null);return this.A_.fromFirestore(n,t)}return new Lp(this.df.R_,(null==t?void 0:t.serverTimestamps)||"none",function(t){return new Wp(e.T_,null,t)},function(t){return new Jr(t)}).h_(this.m_.rn())}},ty.prototype.get=function(t,e){var n=this;if(void 0===e&&(e={}),this.m_&&null!==(t=this.m_.data().field(zp("DocumentSnapshot.get",t))))return new Lp(this.df.R_,e.serverTimestamps||"none",function(t){return new Wp(n.T_,n.A_,t)},function(t){return new Jr(t)}).h_(t)},ty),Yd=(n(Zd,Wd=Qd),Zd.prototype.data=function(t){return void 0===t&&(t={}),Wd.prototype.data.call(this,t)},Zd),Xd=(Object.defineProperty($d.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty($d.prototype,"size",{get:function(){return this.wf.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty($d.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),$d.prototype.forEach=function(e,n){var r=this;this.wf.docs.forEach(function(t){e.call(n,r.Ef(t,r.wf.fromCache,r.wf.Qt.has(t.key)))})},$d.prototype.docChanges=function(t){if(void 0===t&&(t={}),(t=!!t.includeMetadataChanges)&&this.wf.jt)throw new xr(Or.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Tf&&this.If===t||(this.Tf=qy(this.wf,t,this.Ef.bind(this)),this.If=t),this.Tf},$d.prototype.Ef=function(t,e,n){return new Yd(this.T_,t.key,t,new by(n,e),this.query.A_)},$d);function $d(t,e,n){this.T_=t,this.wf=n,this.metadata=new by(n.hasPendingWrites,n.fromCache),this.query=e}function Zd(){return null!==Wd&&Wd.apply(this,arguments)||this}function ty(t,e,n,r,i){var o=this;return(o=Jd.call(this,t,e,n,i)||this).T_=t,o.df=t,o.metadata=r,o}function ey(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=dp(t.firestore,Bd),s=Zp(o);return e instanceof ip&&(e=e.Jl),ny(o,("string"==typeof e||e instanceof Hp?fd(s,"updateDoc",t.I_,e,n,r):ld(s,"updateDoc",t.I_,e)).p_(t.I_,Ls.exists(!0)))}function ny(t,e){return qd(cy(t),e)}function ry(t,e,n){var r=n.docs.get(e.I_);return new Qd(t,e.I_,r,new by(n.hasPendingWrites,n.fromCache),e.A_)}var iy,oy=(ay.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){Hd(t);var n=cy(t),r=t.y_();return Kd(n,t=new np,new tp(t,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t.Jl,{forceOwnership:e})},ay.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){Hd(t);var e=cy(t),n=t.y_();return Kd(e,t=new np,new ep(t,n.cacheSizeBytes))}(t.Jl)},ay.prototype.clearIndexedDbPersistence=function(t){return function(n){var t=this;if(n.rf&&!n.af)throw new xr(Or.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var r=new ha;return n._f.bs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return pa.Ln()?(e=n+"main",[4,pa.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(Bh(n.R_,n.tf))];case 1:return t.sent(),r.resolve(),[3,3];case 2:return e=t.sent(),r.reject(e),[3,3];case 3:return[2]}})})}),r.promise}(t.Jl)},ay),sy=(n(uy,iy=ip),Object.defineProperty(uy.prototype,"R_",{get:function(){return this.Jl.R_},enumerable:!1,configurable:!0}),uy.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.Jl.hf()),t)).merge,this.Jl.uf(t)},uy.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.Jl.hf().host&&Ur("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},uy.prototype.enableNetwork=function(){return function(r){var t=this;return r.cs.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Ld(r)];case 1:return e=t.sent(),[4,Vd(r)];case 2:return n=t.sent(),[2,(e.la(!0),(t=n).Wc.delete(0),ll(t))]}})})})}(cy(this.Jl))},uy.prototype.disableNetwork=function(){return function(r){var t=this;return r.cs.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Ld(r)];case 1:return e=t.sent(),[4,Vd(r)];case 2:return n=t.sent(),[2,(e.la(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Wc.add(0),[4,fl(e)];case 1:return t.sent(),e.Hc.set("Offline"),[2]}})})}(n))]}})})})}(cy(this.Jl))},uy.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&fp("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.mf.enableMultiTabIndexedDbPersistence(this):this.mf.enableIndexedDbPersistence(this,n)},uy.prototype.clearPersistence=function(){return this.mf.clearIndexedDbPersistence(this)},uy.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},uy.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new ha;return n.cs.ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=cf,[4,Cd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(cy(this.Jl))},uy.prototype.onSnapshotsInSync=function(t){return function(t,e){var n=this,r=cy(t),e=Fd(e)?e:{next:e},i=new rp(e);return t._f.ws(function(){return y(n,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.qs.add(e),e.next()},[4,Ud(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})}),function(){i.Hl(),t._f.ws(function(){return y(n,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.qs.delete(e)},[4,Ud(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})})}}(this.Jl,t)},Object.defineProperty(uy.prototype,"app",{get:function(){if(!this.Af)throw new xr(Or.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Af},enumerable:!1,configurable:!0}),uy.prototype.collection=function(t){return hp("Firestore.collection","path",t),cy(this.Jl),new Ly(fi.q(t),this,null)},uy.prototype.doc=function(t){return hp("Firestore.doc","path",t),cy(this.Jl),dy.Rf(fi.q(t),this,null)},uy.prototype.collectionGroup=function(t){if(hp("Firestore.collectionGroup","collectionId",t),0<=t.indexOf("/"))throw new xr(Or.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return cy(this.Jl),new Py(new fu(fi.U(),t),this,null)},uy.prototype.runTransaction=function(e){var n=this;return function(n,r){var t=this,i=new ha;return n.cs.ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,kd(n).then(function(t){return t.qc})];case 1:return e=t.sent(),new Td(n.cs,e,r,i).run(),[2]}})})}),i.promise}(cy(this.Jl),function(t){return e(new fy(n,t))})},uy.prototype.batch=function(){return cy(this.Jl),new py(this)},uy);function uy(t,e,n){var r=this;return(r=iy.call(this,e)||this).mf=n,r.INTERNAL={delete:function(){return void 0===e&&(e="[DEFAULT]"),t="firestore-exp",(n=r.Jl).app.container.getProvider(t).clearInstance(e),n._delete();var t,e,n}},t instanceof ei||(r.Af=t),r}function ay(){}function cy(t){return t.ff||hy(t),t.ff.Y_(),t.ff}function hy(t){var e,n,r=t.y_(),r=(e=t.R_,n=t.tf,new ti(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.ff=new Ad(t.sf,t._f,r)}var ly,fy=(gy.prototype.get=function(t){var e=this,n=Uy(0,t,this.T_);return this.Pf.B_([n.I_]).then(function(t){if(!t||1!==t.length)return Mr();if((t=t[0])instanceof hu)return new Iy(e.T_,n.I_,null,!1,!1,n.A_);if(t instanceof cu)return new Iy(e.T_,n.I_,t,!1,!1,n.A_);throw Mr()})},gy.prototype.set=function(t,e,n){return t=Uy(0,t,this.T_),n=lp("Transaction.set",n),e=My(t.A_,e,n),n=hd(this.gf,"Transaction.set",t.I_,e,null!==t.A_,n),this.Pf.set(t.I_,n),this},gy.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return t=Uy(0,t,this.T_),e instanceof ip&&(e=e.Jl),e="string"==typeof e||e instanceof Hp?fd(this.gf,"Transaction.update",t.I_,e,n,r):ld(this.gf,"Transaction.update",t.I_,e),this.Pf.update(t.I_,e),this},gy.prototype.delete=function(t){return t=Uy(0,t,this.T_),this.Pf.delete(t.I_),this},gy),py=(vy.prototype.set=function(t,e,n){return this.pf(),t=Uy(0,t,this.T_),n=lp("WriteBatch.set",n),e=My(t.A_,e,n),n=hd(this.gf,"WriteBatch.set",t.I_,e,null!==t.A_,n),this.Vf=this.Vf.concat(n.p_(t.I_,Ls.ze())),this},vy.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return this.pf(),t=Uy(0,t,this.T_),e instanceof ip&&(e=e.Jl),e="string"==typeof e||e instanceof Hp?fd(this.gf,"WriteBatch.update",t.I_,e,n,r):ld(this.gf,"WriteBatch.update",t.I_,e),this.Vf=this.Vf.concat(e.p_(t.I_,Ls.exists(!0))),this},vy.prototype.delete=function(t){return this.pf(),t=Uy(0,t,this.T_),this.Vf=this.Vf.concat(new $s(t.I_,Ls.ze())),this},vy.prototype.commit=function(){return this.pf(),this.yf=!0,0<this.Vf.length?qd(cy(this.T_.Jl),this.Vf):Promise.resolve()},vy.prototype.pf=function(){if(this.yf)throw new xr(Or.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},vy),dy=(n(yy,ly=ip),yy.Rf=function(t,e,n){if(t.length%2!=0)throw new xr(Or.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.B()+" has "+t.length);return new yy(e,new Wp(e.Jl,n,new yi(t)))},yy.bf=function(t,e,n){return new yy(e,new Wp(e.Jl,n,t))},Object.defineProperty(yy.prototype,"id",{get:function(){return this.Jl.id},enumerable:!1,configurable:!0}),Object.defineProperty(yy.prototype,"parent",{get:function(){return new Ly(this.Jl.g_.F(),this.firestore,this.Jl.A_)},enumerable:!1,configurable:!0}),Object.defineProperty(yy.prototype,"path",{get:function(){return this.Jl.path},enumerable:!1,configurable:!0}),yy.prototype.collection=function(t){if(hp("DocumentReference.collection","path",t),!t)throw new xr(Or.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");return t=fi.q(t),new Ly(this.Jl.g_.child(t),this.firestore,null)},yy.prototype.isEqual=function(t){return t instanceof ip&&(t=t.Jl),t instanceof Wp&&((e=this.Jl)instanceof Wp||e instanceof Jp)&&(t instanceof Wp||t instanceof Jp)&&e.firestore===t.firestore&&e.path===t.path&&e.A_===t.A_;var e},yy.prototype.set=function(t,e){e=lp("DocumentReference.set",e);try{return n=this.Jl,r=t,i=e,o=dp(n.firestore,Bd),r=My(n.A_,r,i),ny(o,hd(Zp(o),"setDoc",n.I_,r,null!==n.A_,i).p_(n.I_,Ls.ze()))}catch(t){throw my(t,"setDoc","DocumentReference.set")}var n,r,i,o},yy.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?ey(this.Jl,t):ey.apply(void 0,o([this.Jl,t,e],n))}catch(t){throw my(t,"updateDoc","DocumentReference.update")}},yy.prototype.delete=function(){return ny(dp((t=this.Jl).firestore,Bd),[new $s(t.I_,Ls.ze())]);var t},yy.prototype.onSnapshot=function(){for(var e=this,r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var n,i=function(){for(var t=0,e=r;t<e.length;t++){var n=e[t];if("object"==typeof n&&!Fd(n))return n}return{}}(),o={next:function(t){n.next&&n.next(new Iy(e.firestore,t.I_,t.m_,t.metadata.fromCache,t.metadata.hasPendingWrites,e.Jl.A_))},error:null===(o=(n=Fd((o=r)[0])?o[0]:Fd(o[1])?o[1]:"function"==typeof o[0]?{next:o[0],error:o[1],complete:o[2]}:{next:o[1],error:o[2],complete:o[3]}).error)||void 0===o?void 0:o.bind(n),complete:null===(o=n.complete)||void 0===o?void 0:o.bind(n)};return function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i={includeMetadataChanges:!1},o=0;"object"!=typeof n[o]||Fd(n[o])||(i=n[o],o++);var s,u,a,c,h={includeMetadataChanges:i.includeMetadataChanges};Fd(n[o])&&(c=n[o],n[o]=null===(i=c.next)||void 0===i?void 0:i.bind(c),n[o+1]=null===(i=c.error)||void 0===i?void 0:i.bind(c),n[o+2]=null===(i=c.complete)||void 0===i?void 0:i.bind(c)),e instanceof Wp?(u=dp(e.firestore,Bd),a=gu(e.I_.path),s={next:function(t){n[o]&&n[o](ry(u,e,t))},error:n[o+1],complete:n[o+2]}):(u=dp(e.firestore,Bd),a=e.V_,s={next:function(t){n[o]&&n[o](new Xd(u,e,t))},error:n[o+1],complete:n[o+2]},Oy(e.V_));var l=cy(u),f=new rp(s),p=new ja(a,f,h);return u._f.ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=qa,[4,Ud(l)];case 1:return[2,e.apply(void 0,[t.sent(),p])]}})})}),function(){f.Hl(),u._f.ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Ma,[4,Ud(l)];case 1:return[2,e.apply(void 0,[t.sent(),p])]}})})})}}(this.Jl,i,o)},yy.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){var t=this,n=dp(e.firestore,Bd),r=cy(n),i=new ha;return n._f.ws(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Rd(r)];case 1:return[4,function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.Ka.Mi(t,e)}))];case 1:return(r=t.sent())instanceof cu?s.resolve(r):r instanceof hu?s.resolve(null):s.reject(new xr(Or.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=Va(r=t.sent(),"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(t.sent(),e.I_,i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return new Qd(n,e.I_,t,new by(t instanceof cu&&t.Ye,!0),e.A_)})}:"server"===(null==t?void 0:t.source)?function(e){var t=this,n=dp(e.firestore,Bd),r=cy(n),i=new ha;return n._f.ws(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Ud(r)];case 1:return[4,Md(t.sent(),n._f,e.I_,{source:"server"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return ry(n,e,t)})}:function(e){var t=this,n=dp(e.firestore,Bd),r=cy(n),i=new ha;return n._f.ws(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Ud(r)];case 1:return[4,Md(t.sent(),n._f,e.I_,{source:"default"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return ry(n,e,t)})})(this.Jl).then(function(t){return new Iy(e.firestore,t.I_,t.m_,t.metadata.fromCache,t.metadata.hasPendingWrites,e.Jl.A_)})},yy.prototype.withConverter=function(t){return new yy(this.firestore,this.Jl.withConverter(t))},yy);function yy(t,e){var n=this;return(n=ly.call(this,e)||this).firestore=t,n}function vy(t){this.T_=t,this.Vf=[],this.yf=!1,this.gf=Zp(this.T_.Jl)}function gy(t,e){this.T_=t,this.Pf=e,this.gf=Zp(this.T_.Jl)}function my(t,e,n){return t.message=t.message.replace(e+"()",n+"()"),t}var wy,by=(Ay.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Ay),Iy=(Ty.prototype.data=function(t){var e=this;if(void 0===t&&(t={}),this.m_){if(this.A_){var n=new Ey(this.T_,this.I_,this.m_,this.vf,this.Sf,null);return this.A_.fromFirestore(n,t)}return new Lp(this.T_.R_,t.serverTimestamps||"none",function(t){return dy.bf(t,e.T_,null)},function(t){return new Zr(t)}).h_(this.m_.rn())}},Ty.prototype.get=function(t,e){var n=this;if(void 0===e&&(e={}),this.m_&&null!==(t=this.m_.data().field(md("DocumentSnapshot.get",t,this.I_))))return new Lp(this.T_.R_,e.serverTimestamps||"none",function(t){return dy.bf(t,n.T_,n.A_)},function(t){return new Zr(t)}).h_(t)},Object.defineProperty(Ty.prototype,"id",{get:function(){return this.I_.path.k()},enumerable:!1,configurable:!0}),Object.defineProperty(Ty.prototype,"ref",{get:function(){return dy.bf(this.I_,this.T_,this.A_)},enumerable:!1,configurable:!0}),Object.defineProperty(Ty.prototype,"exists",{get:function(){return null!==this.m_},enumerable:!1,configurable:!0}),Object.defineProperty(Ty.prototype,"metadata",{get:function(){return new by(this.Sf,this.vf)},enumerable:!1,configurable:!0}),Ty.prototype.isEqual=function(t){return t instanceof Ty&&this.T_===t.T_&&this.vf===t.vf&&this.I_.isEqual(t.I_)&&(null===this.m_?null===t.m_:this.m_.isEqual(t.m_))&&this.A_===t.A_},Ty),Ey=(n(_y,wy=Iy),_y.prototype.data=function(t){return wy.prototype.data.call(this,t)},_y);function _y(){return null!==wy&&wy.apply(this,arguments)||this}function Ty(t,e,n,r,i,o){this.T_=t,this.I_=e,this.m_=n,this.vf=r,this.Sf=i,this.A_=o}function Ay(t,e){this.hasPendingWrites=t,this.fromCache=e}function Ny(t,e,n){if(n instanceof ip&&(n=n.Jl),"string"==typeof n){if(""===n)throw new xr(Or.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Eu(e)&&-1!==n.indexOf("/"))throw new xr(Or.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child(fi.q(n)),!yi.X(e))throw new xr(Or.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return ko(t,new yi(e))}if(n instanceof Wp)return ko(t,n.I_);throw new xr(Or.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+pp(n)+".")}function Dy(t,e){if(!Array.isArray(t)||0===t.length)throw new xr(Or.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new xr(Or.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Sy(t,e,n){if(!n.isEqual(e))throw new xr(Or.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Oy(t){if(wu(t)&&0===t.on.length)throw new xr(Or.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var xy,Py=(Cy.prototype.where=function(t,e,n){return t=md("Query.where",t),e=function(t,e,n,r,i,o){if(r.W()){if("array-contains"===i||"array-contains-any"===i)throw new xr(Or.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){Dy(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(Ny(n,t,c))}h={arrayValue:{values:s}}}else h=Ny(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Dy(o,i),h=pd(e,"Query.where",o,"in"===i||"not-in"===i);var h=Ru.create(r,i,h);return function(t,e){if(e.hn()){var n=Iu(t);if(null!==n&&!n.isEqual(e.field))throw new xr(Or.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=bu(t))&&Sy(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new xr(Or.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new xr(Or.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(this.V_,this.gf,this.firestore.R_,t,e,n),new Cy((e=(n=this.V_).filters.concat([e]),new fu(n.path,n.collectionGroup,n.on.slice(),e,n.limit,n.an,n.startAt,n.endAt)),this.firestore,this.A_)},Cy.prototype.orderBy=function(t,e){if(void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new xr(Or.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var n,t=md("Query.orderBy",t),t=function(t,e,n){if(null!==t.startAt)throw new xr(Or.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new xr(Or.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return n=e=new ca(e,n),null!==bu(t)||null!==(t=Iu(t))&&Sy(0,t,n.field),e}(this.V_,t,n);return new Cy((t=(n=this.V_).on.concat([t]),new fu(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.an,n.startAt,n.endAt)),this.firestore,this.A_)},Cy.prototype.limit=function(t){return yp("Query.limit",t),new Cy(Au(this.V_,t,"F"),this.firestore,this.A_)},Cy.prototype.limitToLast=function(t){return yp("Query.limitToLast",t),new Cy(Au(this.V_,t,"L"),this.firestore,this.A_)},Cy.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t=this.Df("Query.startAt",t,e,!0),new Cy(Nu(this.V_,t),this.firestore,this.A_)},Cy.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t=this.Df("Query.startAfter",t,e,!1),new Cy(Nu(this.V_,t),this.firestore,this.A_)},Cy.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t=this.Df("Query.endBefore",t,e,!0),new Cy(Du(this.V_,t),this.firestore,this.A_)},Cy.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t=this.Df("Query.endAt",t,e,!1),new Cy(Du(this.V_,t),this.firestore,this.A_)},Cy.prototype.isEqual=function(t){return t instanceof Cy&&this.firestore===t.firestore&&Su(this.V_,t.V_)&&this.A_===t.A_},Cy.prototype.withConverter=function(t){return new Cy(this.V_,this.firestore,t)},Cy.prototype.Df=function(c,t,e,n){return t instanceof Iy?function(t,e,n,r){if(!n)throw new xr(Or.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=_u(t);o<s.length;o++){var u=s[o];if(u.field.W())i.push(ko(e,n.key));else{var a=n.field(u.field);if(bo(a))throw new xr(Or.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a)throw u=u.field.B(),new xr(Or.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.");i.push(a)}}return new ta(i,r)}(this.V_,this.firestore.R_,t.m_,n):(e=[t].concat(e),function(t,e,n,r,i,o){var s=t.on;if(i.length>s.length)throw new xr(Or.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.W()){if("string"!=typeof c)throw new xr(Or.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Eu(t)&&-1!==c.indexOf("/"))throw new xr(Or.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(fi.q(c));if(!yi.X(h))throw new xr(Or.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new yi(h),u.push(ko(e,h))}else c=pd(n,r,c),u.push(c)}return new ta(u,o)}(this.V_,this.firestore.R_,this.gf,c,e,n))},Cy.prototype.onSnapshot=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i,o={},s=0;"object"!=typeof n[s]||Fd(n[s])||(o=n[s],s++),Fd(n[s])&&(i=n[s],n[s]=null===(t=i.next)||void 0===t?void 0:t.bind(i),n[s+1]=null===(t=i.error)||void 0===t?void 0:t.bind(i),n[s+2]=null===(t=i.complete)||void 0===t?void 0:t.bind(i));var u={next:function(t){n[s]&&n[s](new ky(e.firestore,e.V_,t,e.A_))},error:n[s+1],complete:n[s+2]};return Oy(this.V_),function(n,t,e){var r=this,i=new rp(u),o=new ja(t,i,e);return n.cs.ws(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=qa,[4,Ud(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})}),function(){i.Hl(),n.cs.ws(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Ma,[4,Ud(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})})}}(cy(this.firestore.Jl),this.V_,o)},Cy.prototype.get=function(t){var e=this;Oy(this.V_);var n=cy(this.firestore.Jl);return(t&&"cache"===t.source?function(n,r){var t=this,i=new ha;return n.cs.ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Qh(r,i,!0)];case 1:return n=t.sent(),e=new Kl(i,n.za),n=e.wh(n.documents),n=e.Di(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=Va(n=t.sent(),"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})},[4,Rd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(n,this.V_):function(n,r,i){var t=this;void 0===i&&(i={});var o=new ha;return n.cs.ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new rp({next:function(t){n.ws(function(){return Ma(e,s)}),t.fromCache&&"server"===r.source?i.reject(new xr(Or.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new ja(t,o,{includeMetadataChanges:!0,Xs:!0});return qa(e,s)},[4,Ud(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.cs,r,i,o])]}})})}),o.promise}(n,this.V_,t)).then(function(t){return new ky(e.firestore,e.V_,t,e.A_)})},Cy),ky=(Object.defineProperty(Vy.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Vy.prototype,"empty",{get:function(){return this.wf.docs.P()},enumerable:!1,configurable:!0}),Object.defineProperty(Vy.prototype,"size",{get:function(){return this.wf.docs.size},enumerable:!1,configurable:!0}),Vy.prototype.forEach=function(e,n){var r=this;this.wf.docs.forEach(function(t){e.call(n,r.Nf(t,r.metadata.fromCache,r.wf.Qt.has(t.key)))})},Object.defineProperty(Vy.prototype,"query",{get:function(){return new Py(this.Cf,this.T_,this.A_)},enumerable:!1,configurable:!0}),Vy.prototype.docChanges=function(t){if((t=!(!t||!t.includeMetadataChanges))&&this.wf.jt)throw new xr(Or.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Tf&&this.If===t||(this.Tf=qy(this.wf,t,this.Nf.bind(this)),this.If=t),this.Tf},Vy.prototype.isEqual=function(t){return t instanceof Vy&&this.T_===t.T_&&Su(this.Cf,t.Cf)&&this.wf.isEqual(t.wf)&&this.A_===t.A_},Vy.prototype.Nf=function(t,e,n){return new Ey(this.T_,t.key,t,e,n,this.A_)},Vy),Ly=(n(Ry,xy=Py),Object.defineProperty(Ry.prototype,"id",{get:function(){return this.V_.path.k()},enumerable:!1,configurable:!0}),Object.defineProperty(Ry.prototype,"parent",{get:function(){var t=this.V_.path.F();return t.P()?null:dy.Rf(t,this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(Ry.prototype,"path",{get:function(){return this.V_.path.B()},enumerable:!1,configurable:!0}),Ry.prototype.doc=function(t){return 0===arguments.length&&(t=jr.t()),hp("CollectionReference.doc","path",t),t=fi.q(t),dy.Rf(this.V_.path.child(t),this.firestore,this.A_)},Ry.prototype.add=function(t){var t=this.A_?this.A_.toFirestore(t):t,e=this.doc();return dy.bf(e.Jl.I_,this.firestore,null).set(t).then(function(){return e})},Ry.prototype.withConverter=function(t){return new Ry(this.g_,this.firestore,t)},Ry);function Ry(t,e,n){var r=this;if(((r=xy.call(this,gu(t),e,n)||this).g_=t).length%2!=1)throw new xr(Or.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.B()+" has "+t.length);return r}function Vy(t,e,n,r){this.T_=t,this.Cf=e,this.wf=n,this.A_=r,this.Tf=null,this.If=null,this.metadata=new by(n.hasPendingWrites,n.fromCache)}function Cy(t,e,n){this.V_=t,this.firestore=e,this.A_=n,this.gf=Zp(e.Jl)}function Uy(t,e,n){if((e=dp(e,Wp)).firestore!==n.Jl)throw new xr(Or.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function qy(i,e,o){if(i.Kt.P()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Kt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Mr()}}(),doc:e,oldIndex:n,newIndex:r}})}function My(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Fy,jy,we=(n(Gy,jy=ip),Gy.documentId=function(){return new Gy(di.j().B())},Gy.prototype.isEqual=function(t){return t instanceof ip&&(t=t.Jl),t instanceof Hp&&this.Jl.P_.isEqual(t.P_)},Gy),l=(n(By,Fy=ip),By.serverTimestamp=function(){var t=new Np("serverTimestamp");return t.Yl="FieldValue.serverTimestamp",new By(t)},By.delete=function(){var t=new mp("deleteField");return t.Yl="FieldValue.delete",new By(t)},By.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Dp("arrayUnion",t)}.apply(void 0,t);return n.Yl="FieldValue.arrayUnion",new By(n)},By.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Sp("arrayRemove",t)}.apply(void 0,t);return n.Yl="FieldValue.arrayRemove",new By(n)},By.increment=function(t){return(t=new Op("increment",t)).Yl="FieldValue.increment",new By(t)},By.prototype.isEqual=function(t){return this.Jl.isEqual(t.Jl)},By),l={Firestore:sy,GeoPoint:xp,Timestamp:hi,Blob:Zr,Transaction:fy,WriteBatch:py,DocumentReference:dy,DocumentSnapshot:Iy,Query:Py,QueryDocumentSnapshot:Ey,QuerySnapshot:ky,CollectionReference:Ly,FieldPath:we,FieldValue:l,setLogLevel:function(t){kr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};function By(){return null!==Fy&&Fy.apply(this,arguments)||this}function Gy(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return jy.call(this,new(Hp.bind.apply(Hp,o([void 0],t))))||this}(e=e.default).INTERNAL.registerComponent(new vr("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new sy(e,new Bd(e,t),new oy);var e},"PUBLIC").setServiceProps(Object.assign({},l))),e.registerVersion("@firebase/firestore","2.0.2-20201010222127")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});