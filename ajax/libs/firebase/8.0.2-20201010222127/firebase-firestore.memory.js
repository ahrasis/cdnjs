!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Vp){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var e=t(Vp),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var u,i=function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function o(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(Ae=u=u||{})[Ae.DEBUG=0]="DEBUG",Ae[Ae.VERBOSE=1]="VERBOSE",Ae[Ae.INFO=2]="INFO",Ae[Ae.WARN=3]="WARN",Ae[Ae.ERROR=4]="ERROR",Ae[Ae.SILENT=5]="SILENT";function a(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=l[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var h={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},c=u.INFO,l=((Te={})[u.DEBUG]="log",Te[u.VERBOSE]="log",Te[u.INFO]="info",Te[u.WARN]="warn",Te[u.ERROR]="error",Te),f=(Object.defineProperty(p.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),p.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?h[t]:t},Object.defineProperty(p.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),p.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},p.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},p.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},p.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},p.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},p);function p(t){this.name=t,this._logLevel=c,this._logHandler=a,this._userLogHandler=null}function d(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var g,m="FirebaseError",w=(n(b,g=Error),b);function b(t,e,n){e=g.call(this,e)||this;return e.code=t,e.customData=n,e.name=m,Object.setPrototypeOf(e,b.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,E.prototype.create),e}var E=(I.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(A,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new w(o,t,i)},I);function I(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var A=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function N(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var S,O="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},P={},k=O||self;function D(){}function R(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function L(t){var e=R(t);return"array"==e||"object"==e&&"number"==typeof t.length}function _(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var V="closure_uid_"+(1e9*Math.random()>>>0),C=0;function U(t,e,n){return t.call.apply(t.bind,arguments)}function j(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function x(t,e,n){return(x=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?U:j).apply(null,arguments)}function M(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var q=Date.now;function F(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t}function B(){this.j=this.j,this.i=this.i}B.prototype.j=!1,B.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,V)&&t[V]||(t[V]=++C))},B.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var W=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function z(){return Array.prototype.concat.apply([],arguments)}function H(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function Q(t){return/^[\s\xa0]*$/.test(t)}var X,K=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Y(t,e){return-1!=t.indexOf(e)}function Z(t,e){return t<e?-1:e<t?1:0}t:{var $=k.navigator;if($){$=$.userAgent;if($){X=$;break t}}X=""}function J(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function tt(t){var e,n={};for(e in t)n[e]=t[e];return n}var et="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function nt(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<et.length;i++)e=et[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function rt(t){return rt[" "](t),t}rt[" "]=D;var it,ot=Y(X,"Opera"),st=Y(X,"Trident")||Y(X,"MSIE"),ut=Y(X,"Edge"),at=ut||st,ht=Y(X,"Gecko")&&!(Y(X.toLowerCase(),"webkit")&&!Y(X,"Edge"))&&!(Y(X,"Trident")||Y(X,"MSIE"))&&!Y(X,"Edge"),ct=Y(X.toLowerCase(),"webkit")&&!Y(X,"Edge");function lt(){var t=k.document;return t?t.documentMode:void 0}t:{var ft="",pt=(pt=X,ht?/rv:([^\);]+)(\)|;)/.exec(pt):ut?/Edge\/([\d\.]+)/.exec(pt):st?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(pt):ct?/WebKit\/(\S+)/.exec(pt):ot?/(?:Version)[ \/]?(\S+)/.exec(pt):void 0);if(pt&&(ft=pt?pt[1]:""),st){pt=lt();if(null!=pt&&pt>parseFloat(ft)){it=String(pt);break t}}it=ft}var dt={};function yt(u){return t=u,e=function(){for(var t=0,e=K(String(it)).split("."),n=K(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Z(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Z(0==o[2].length,0==s[2].length)||Z(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=dt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var vt=k.document&&st?lt()||(parseInt(it,10)||void 0):void 0,gt=!st||9<=Number(vt),mt=st&&!yt("9"),wt=function(){if(!k.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{k.addEventListener("test",D,e),k.removeEventListener("test",D,e)}catch(t){}return t}();function bt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Et(t,e){if(bt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ht){t:{try{rt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:It[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}bt.prototype.b=function(){this.defaultPrevented=!0},F(Et,bt);var It={2:"touch",3:"pen",4:"mouse"};Et.prototype.b=function(){Et.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,mt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var At="closure_listenable_"+(1e6*Math.random()|0),Tt=0;function Nt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Tt,this.Y=this.Z=!1}function St(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Ot(t){this.src=t,this.a={},this.b=0}function Pt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=W(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(St(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function kt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Ot.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=kt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Nt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Dt="closure_lm_"+(1e6*Math.random()|0),Rt={};function Lt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=qt(r);return e&&e[At]?e.wa(n,r,_(i)?!!i.capture:!!i,o):_t(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Lt(t,e[o],n,r,i);return null}return n=qt(n),t&&t[At]?t.va(e,n,_(r)?!!r.capture:!!r,i):_t(t,e,n,!1,r,i)}function _t(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=_(i)?!!i.capture:!!i;if(s&&!gt)return null;var u,a,h=xt(t);if(h||(t[Dt]=h=new Ot(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=jt,r=a=gt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)wt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ct(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Vt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[At]?Pt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ct(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=xt(e))?(Pt(n,t),0==n.b&&(n.src=null,e[Dt]=null)):St(t)))}function Ct(t){return t in Rt?Rt[t]:Rt[t]="on"+t}function Ut(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Vt(t),n.call(r,e)}function jt(t,e){if(t.Y)return!0;if(gt)return Ut(t,new Et(e,this));if(!e)t:{e=["window","event"];for(var n=k,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ut(t,e=new Et(e,this))}function xt(t){return(t=t[Dt])instanceof Ot?t:null}var Mt="__closure_events_fn_"+(1e9*Math.random()>>>0);function qt(e){return"function"==R(e)?e:(e[Mt]||(e[Mt]=function(t){return e.handleEvent(t)}),e[Mt])}function Ft(){B.call(this),this.c=new Ot(this),(this.J=this).C=null}function Bt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new bt(e,t):e instanceof bt?e.target=e.target||t:(s=e,nt(e=new bt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Wt(o,r,!0,e)&&s;if(s=Wt(o=e.a=t,r,!0,e)&&s,s=Wt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Wt(o=e.a=n[i],r,!1,e)&&s}function Wt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Pt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}F(Ft,B),Ft.prototype[At]=!0,(S=Ft.prototype).addEventListener=function(t,e,n,r){Lt(this,t,e,n,r)},S.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=_(i)?!!i.capture:!!i,r=qt(r),e&&e[At]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=kt(s=e.a[n],r,i,o))&&(St(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&xt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=kt(n,r,i,o)),(r=-1<e?n[e]:null)&&Vt(r))}(this,t,e,n,r)},S.G=function(){if(Ft.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)St(n[r]);delete e.a[t],e.b--}}this.C=null},S.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},S.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Gt=k.JSON.stringify;function zt(){this.b=this.a=null}var Ht,Qt=(Xt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Xt(function(){return new Kt},function(t){t.reset()},100));function Xt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Kt(){this.next=this.b=this.a=null}function Yt(t,e){var n;Ht||(n=k.Promise.resolve(void 0),Ht=function(){n.then(Jt)}),Zt||(Ht(),Zt=!0),$t.add(t,e)}zt.prototype.add=function(t,e){var n=Qt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Kt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Zt=!(Kt.prototype.reset=function(){this.next=this.b=this.a=null}),$t=new zt;function Jt(){for(var t,e;n=e=void 0,n=null,(e=$t).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){k.setTimeout(function(){throw t},0)}(t)}var n=Qt;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Zt=!1}function te(t,e){Ft.call(this),this.b=t||1,this.a=e||k,this.f=x(this.Xa,this),this.g=q()}function ee(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function ne(t,e,n){if("function"==R(t))n&&(t=x(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=x(t.handleEvent,t)}return 2147483647<Number(e)?-1:k.setTimeout(t,e||0)}F(te,Ft),(S=te.prototype).aa=!1,S.M=null,S.Xa=function(){var t;this.aa&&(0<(t=q()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Bt(this,"tick"),this.aa&&(ee(this),this.start())))},S.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=q())},S.G=function(){te.X.G.call(this),ee(this),delete this.a};var re,ie,oe,se=(T(ie=ae,oe=re=B),ie.prototype=null===oe?Object.create(oe):(ue.prototype=oe.prototype,new ue),ae.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=ne(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ae.prototype.G=function(){re.prototype.G.call(this),this.a&&(k.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ae);function ue(){this.constructor=ie}function ae(t,e,n){var r=re.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function he(t){B.call(this),this.b=t,this.a={}}F(he,B);var ce=[];function le(t,e,n,r){Array.isArray(n)||(n&&(ce[0]=n.toString()),n=ce);for(var i=0;i<n.length;i++){var o=Lt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function fe(t){J(t.a,function(t,e){this.a.hasOwnProperty(e)&&Vt(t)},t),t.a={}}function pe(){this.a=!0}function de(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return Gt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}he.prototype.G=function(){he.X.G.call(this),fe(this)},he.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},pe.prototype.info=function(){};var ye=null;function ve(){return ye=ye||new Ft}function ge(t){bt.call(this,"serverreachability",t)}function me(t){var e=ve();Bt(e,new ge(e))}function we(t){bt.call(this,"statevent",t)}function be(t){var e=ve();Bt(e,new we(e))}function Ee(t){bt.call(this,"timingevent",t)}function Ie(t,e){if("function"!=R(t))throw Error("Fn must not be null and must be a function");return k.setTimeout(function(){t()},e)}F(ge,bt),F(we,bt),F(Ee,bt);var Ae={NO_ERROR:0,Ya:1,fb:2,eb:3,ab:4,cb:5,gb:6,Da:7,TIMEOUT:8,jb:9},Te={$a:"complete",nb:"success",Ea:"error",Da:"abort",lb:"ready",mb:"readystatechange",TIMEOUT:"timeout",hb:"incrementaldata",kb:"progress",bb:"downloadprogress",ob:"uploadprogress"};function Ne(){}function Se(t){var e;return(e=t.a)||(e=t.a={}),e}function Oe(){}Ne.prototype.a=null;var Pe,O={OPEN:"a",Za:"b",Ea:"c",ib:"d"};function ke(){bt.call(this,"d")}function De(){bt.call(this,"c")}function Re(){}function Le(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new he(this),this.P=_e,t=at?125:void 0,this.R=new te(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}F(ke,bt),F(De,bt),F(Re,Ne),Pe=new Re;var _e=45e3,Ve={},Ce={};function Ue(t,e,n){t.H=1,t.i=rn(Ze(e)),t.j=n,t.I=!0,je(t,null)}function je(t,e){t.u=q(),Me(t),t.l=Ze(t.i);var s,u,a,h,c,l,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),gn(n.b,"t",r),t.D=0,t.a=cr(t.g,t.g.C?e:null),0<t.O&&(t.F=new se(x(t.Ca,t,t.a),t.O)),le(t.J,t.a,"readystatechange",t.Va),e=t.B?tt(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),me(1),s=t.c,u=t.m,a=t.l,h=t.f,c=t.S,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function xe(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Ce:(i=Number(u.substring(i,o)),isNaN(i)?Ve:(o+=1)+i>u.length?Ce:(u=u.substr(o,i),r.D=o+i,u)));if(u==Ce){4==e&&(t.h=4,be(14),s=!1),de(t.c,t.f,null,"[Incomplete Response]");break}if(u==Ve){t.h=4,be(15),de(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}de(t.c,t.f,u,null),Ge(t,u)}4==e&&0==n.length&&(t.h=1,be(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),nr(e),e.F=!0,be(11))):(de(t.c,t.f,n,"[Invalid Chunked Response]"),We(t),Be(t))}function Me(t){t.T=q()+t.P,qe(t,t.P)}function qe(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ie(x(t.Ta,t),e)}function Fe(t){t.o&&(k.clearTimeout(t.o),t.o=null)}function Be(t){0==t.g.v||t.A||or(t.g,t)}function We(t){Fe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,ee(t.R),fe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ge(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||Tn(u.b,t)))if(u.I=t.N,!t.C&&Tn(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var h=a;if(0==h[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;ir(u),Qn(u)}er(u),be(18)}}else u.oa=h[1],0<u.oa-u.P&&h[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=Ie(x(u.Qa,u),6e3));if(An(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else ur(u,11)}else if(!t.C&&u.a!=t||ir(u),!Q(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++){h=e[a],u.P=h[0],h=h[1],2==u.v?"c"==h[0]?(u.J=h[1],u.ga=h[2],null!=(r=h[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=h[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=h[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(Y(r,"spdy")||Y(r,"quic")||Y(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(Nn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,nn(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=q()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=hr(n,n.C?n.ga:null,n.fa),i.C?(Sn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Fe(o),Me(o)),n.a=i):tr(n),0<u.g.length&&Yn(u)):"stop"!=h[0]&&"close"!=h[0]||ur(u,7):3==u.v&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?ur(u,7):Hn(u):"noop"!=h[0]&&u.f&&u.f.sa(h),u.o=0)}me(4)}catch(t){}}function ze(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(L(t)||"string"==typeof t)G(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(L(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(L(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function He(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof He)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Qe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Xe(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Xe(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Xe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(S=Le.prototype).setTimeout=function(t){this.P=t},S.Va=function(t){t=t.target;var e=this.F;e&&3==Bn(t)?e.f():this.Ca(t)},S.Ca=function(t){try{if(t==this.a)t:{var e=Bn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!at&&!this.a.$())){this.A||4!=e||7==n||me(8==n||r<=0?3:2),Fe(this);var i=this.a.W();this.N=i;n=this.a.$();if(this.b=200==i,r=this.c,u=this.m,a=this.l,h=this.f,c=this.S,l=e,f=i,r.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+c+"]: "+u+"\n"+a+"\n"+l+" "+f}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Q(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,be(12),We(this),Be(this);break t}de(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ge(this,s)}this.I?(xe(this,e,n),at&&this.b&&3==e&&(le(this.J,this.R,"tick",this.Ua),this.R.start())):(de(this.c,this.f,n,null),Ge(this,n)),4==e&&We(this),this.b&&!this.A&&(4==e?or(this.g,this):(this.b=!1,Me(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,be(12)):(this.h=0,be(13)),We(this),Be(this)}}}catch(t){}var u,a,h,c,l,f},S.Ua=function(){var t,e;this.a&&(t=Bn(this.a),e=this.a.$(),this.D<e.length&&(Fe(this),xe(this,t,e),this.b&&4!=t&&Me(this)))},S.cancel=function(){this.A=!0,We(this)},S.Ta=function(){this.o=null;var t,e,n=q();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(me(3),be(17)),We(this),this.h=2,Be(this)):qe(this,this.T-n)},(S=He.prototype).K=function(){Qe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},S.L=function(){return Qe(this),this.a.concat()},S.get=function(t,e){return Xe(this.b,t)?this.b[t]:e},S.set=function(t,e){Xe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},S.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ke=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ye(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ye?(this.a=void 0!==e?e:t.a,$e(this,t.f),this.j=t.j,Je(this,t.c),tn(this,t.h),this.g=t.g,e=t.b,(n=new pn).c=e.c,e.a&&(n.a=new He(e.a),n.b=e.b),en(this,n),this.i=t.i):t&&(n=String(t).match(Ke))?(this.a=!!e,$e(this,n[1]||"",!0),this.j=on(n[2]||""),Je(this,n[3]||"",!0),tn(this,n[4]),this.g=on(n[5]||"",!0),en(this,n[6]||"",!0),this.i=on(n[7]||"")):(this.a=!!e,this.b=new pn(null,this.a))}function Ze(t){return new Ye(t)}function $e(t,e,n){t.f=n?on(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Je(t,e,n){t.c=n?on(e,!0):e}function tn(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function en(t,e,n){var r,i;e instanceof pn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(dn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(yn(this,e),gn(this,n,t))},r)),r.f=i):(n||(e=sn(e,ln)),t.b=new pn(e,t.a))}function nn(t,e,n){t.b.set(e,n)}function rn(t){return nn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^q()).toString(36)),t}function on(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function sn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,un),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function un(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ye.prototype.toString=function(){var t=[],e=this.f;e&&t.push(sn(e,an,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(sn(e,an,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(sn(n,"/"==n.charAt(0)?cn:hn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",sn(n,fn)),t.join("")};var an=/[#\/\?@]/g,hn=/[#\?:]/g,cn=/[#\?]/g,ln=/[#\?@]/g,fn=/#/g;function pn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function dn(n){n.a||(n.a=new He,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function yn(t,e){dn(t),e=mn(t,e),Xe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Xe((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Qe(t)))}function vn(t,e){return dn(t),e=mn(t,e),Xe(t.a.b,e)}function gn(t,e,n){yn(t,e),0<n.length&&(t.c=null,t.a.set(mn(t,e),H(n)),t.b+=n.length)}function mn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function wn(t,e){this.b=t,this.a=e}function bn(t){this.g=t||En,t=k.PerformanceNavigationTiming?0<(t=k.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(k.ia&&k.ia.ya&&k.ia.ya()&&k.ia.ya().pb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(S=pn.prototype).add=function(t,e){dn(this),this.c=null,t=mn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},S.forEach=function(n,r){dn(this),this.a.forEach(function(t,e){G(t,function(t){n.call(r,t,e,this)},this)},this)},S.L=function(){dn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},S.K=function(t){dn(this);var e=[];if("string"==typeof t)vn(this,t)&&(e=z(e,this.a.get(mn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},S.set=function(t,e){return dn(this),this.c=null,vn(this,t=mn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},S.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},S.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var En=10;function In(t){return t.b||t.a&&t.a.size>=t.f}function An(t){return t.b?1:t.a?t.a.size:0}function Tn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Nn(t,e){t.a?t.a.add(e):t.b=e}function Sn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function On(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return H(t.c);var r=t.c;try{for(var i=N(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Pn(){}function kn(){this.a=new Pn}function Dn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}bn.prototype.cancel=function(){var e,t;if(this.c=On(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=N(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},Pn.prototype.stringify=function(t){return k.JSON.stringify(t,void 0)},Pn.prototype.parse=function(t){return k.JSON.parse(t,void 0)};var Rn=k.JSON.parse;function Ln(t){Ft.call(this),this.headers=new He,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=_n,this.D=this.F=!1}F(Ln,Ft);var _n="",Vn=/^https?$/i,Cn=["POST","PUT"];function Un(t){return"content-type"==t.toLowerCase()}function jn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,xn(t),qn(t)}function xn(t){t.u||(t.u=!0,Bt(t,"complete"),Bt(t,"error"))}function Mn(t){if(t.b&&void 0!==P&&(!t.s[1]||4!=Bn(t)||2!=t.W()))if(t.l&&4==Bn(t))ne(t.za,0,t);else if(Bt(t,"readystatechange"),4==Bn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Ke)[1]||null)&&k.self&&k.self.location&&(i=(r=k.self.location.protocol).substr(0,r.length-1)),n=!Vn.test(i?i.toLowerCase():"")),e=n),e)Bt(t,"complete"),Bt(t,"success");else{t.h=6;try{var u=2<Bn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.W()+"]",xn(t)}}finally{qn(t)}}}function qn(t,e){if(t.a){Fn(t);var n=t.a,r=t.s[0]?D:null;t.a=null,t.s=null,e||Bt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Fn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(k.clearTimeout(t.m),t.m=null)}function Bn(t){return t.a?t.a.readyState:0}function Wn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",J(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):nn(t,e,n))}function Gn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function zn(t){this.pa=0,this.g=[],this.c=new pe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Ma=this.R=0,this.Ja=Gn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Fa=Gn("baseRetryDelayMs",5e3,t),this.Pa=Gn("retryDelaySeedMs",1e4,t),this.Ka=Gn("forwardChannelMaxRetries",2,t),this.ma=Gn("forwardChannelRequestTimeoutMs",2e4,t),this.La=t&&t.h||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new bn(t&&t.concurrentRequestLimit),this.ka=new kn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.g&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ia=t&&t.f||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Hn(t){var e,n;Xn(t),3==t.v&&(e=t.R++,nn(n=Ze(t.B),"SID",t.J),nn(n,"RID",e),nn(n,"TYPE","terminate"),$n(t,n),(e=new Le(t,t.c,e,void 0)).H=2,e.i=rn(Ze(n)),n=!1,k.navigator&&k.navigator.sendBeacon&&(n=k.navigator.sendBeacon(e.i.toString(),"")),!n&&k.Image&&((new Image).src=e.i,n=!0),n||(e.a=cr(e.g,null),e.a.ba(e.i)),e.u=q(),Me(e)),ar(t)}function Qn(t){t.a&&(nr(t),t.a.cancel(),t.a=null)}function Xn(t){Qn(t),t.j&&(k.clearTimeout(t.j),t.j=null),ir(t),t.b.cancel(),t.h&&("number"==typeof t.h&&k.clearTimeout(t.h),t.h=null)}function Kn(t,e){t.g.push(new wn(t.Ma++,e)),3==t.v&&Yn(t)}function Yn(t){In(t.b)||t.h||(t.h=!0,Yt(t.Ba,t),t.u=0)}function Zn(t,e){var n=e?e.f:t.R++,r=Ze(t.B);nn(r,"SID",t.J),nn(r,"RID",n),nn(r,"AID",t.P),$n(t,r),t.i&&t.l&&Wn(r,t.i,t.l),n=new Le(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Jn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Nn(t.b,n),Ue(n,r,e)}function $n(t,n){t.f&&ze({},function(t,e){nn(n,e,t)})}function Jn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?x(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{ze(t,function(t,e){var n=t;_(t)&&(n=Gt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s,"req"+h+"_")}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function tr(t){t.a||t.j||(t.T=1,Yt(t.Aa,t),t.o=0)}function er(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=Ie(x(t.Aa,t),sr(t,t.o)),t.o++,1)}function nr(t){null!=t.s&&(k.clearTimeout(t.s),t.s=null)}function rr(t){t.a=new Le(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ze(t.la);nn(e,"RID","rpc"),nn(e,"SID",t.J),nn(e,"CI",t.H?"0":"1"),nn(e,"AID",t.P),$n(t,e),nn(e,"TYPE","xmlhttp"),t.i&&t.l&&Wn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=rn(Ze(e)),n.j=null,n.I=!0,je(n,t)}function ir(t){null!=t.m&&(k.clearTimeout(t.m),t.m=null)}function or(t,e){var n,r=null;if(t.a==e){ir(t),nr(t),t.a=null;var i=2}else{if(!Tn(t.b,e))return;r=e.s,Sn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=q()-e.u,n=t.u,Bt(i=ve(),new Ee(i)),Yn(t)):tr(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(An(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ja?0:t.Ka)))return t.h=Ie(x(t.Ba,t,e),sr(t,t.u)),t.u++,1}}(t,e)||2==i&&er(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:ur(t,5);break;case 4:ur(t,10);break;case 3:ur(t,6);break;default:ur(t,2)}}function sr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Pa);return t.f||(n*=2),n*e}function ur(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=x(t.Wa,t),r||(r=new Ye("//www.google.com/images/cleardot.gif"),k.location&&"http"==k.location.protocol||$e(r,"https"),rn(r)),n=r.toString(),r=o,o=new pe,k.Image?((i=new Image).onload=M(Dn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=M(Dn,o,i,"TestLoadImage: error",!1,r),i.onabort=M(Dn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=M(Dn,o,i,"TestLoadImage: timeout",!1,r),k.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):be(2),t.v=0,t.f&&t.f.ra(e),ar(t),Xn(t)}function ar(t){t.v=0,t.I=-1,t.f&&(0==On(t.b).length&&0==t.g.length||(t.b.c.length=0,H(t.g),t.g.length=0),t.f.qa())}function hr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Ye?Ze(s):new Ye(s,void 0);return""!=a.c?(e&&Je(a,e+"."+a.c),tn(a,a.h)):(u=k.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Ye(null,void 0),r&&$e(u,r),i&&Je(u,i),o&&tn(u,o),s&&(u.g=s),a=u),t.V&&J(t.V,function(t,e){nn(a,e,t)}),e=t.A,n=t.na,e&&n&&nn(a,e,n),nn(a,"VER",t.ha),$n(t,a),a}function cr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Ln(t.La)).F=t.C,e}function lr(){}function fr(){if(st&&!(10<=Number(vt)))throw Error("Environmental error: no available transport.")}function pr(t,e){Ft.call(this),this.a=new zn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!Q(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Q(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new vr(this)}function dr(t){ke.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function yr(){De.call(this),this.status=1}function vr(t){this.a=t}(S=Ln.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Se(this.H):Se(Pe),this.a.onreadystatechange=x(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void jn(this,t)}t=n||"";var i,o=new He(this.headers);r&&ze(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Un,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=k.FormData&&t instanceof k.FormData,0<=W(Cn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Fn(this),0<this.o&&((this.D=(i=this.a,st&&yt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=x(this.xa,this)):this.m=ne(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){jn(this,t)}},S.xa=function(){void 0!==P&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Bt(this,"timeout"),this.abort(8))},S.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Bt(this,"complete"),Bt(this,"abort"),qn(this))},S.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),qn(this,!0)),Ln.X.G.call(this)},S.za=function(){this.j||(this.A||this.l||this.g?Mn(this):this.Sa())},S.Sa=function(){Mn(this)},S.W=function(){try{return 2<Bn(this)?this.a.status:-1}catch(t){return-1}},S.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},S.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Rn(e)}},S.ua=function(){return this.h},S.Oa=function(){return"string"==typeof this.f?this.f:String(this.f)},(S=zn.prototype).ha=8,S.v=1,S.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Le(this,this.c,t,void 0),r=this.l;if(this.O&&(r?nt(r=tt(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Jn(this,n,e),nn(i=Ze(this.B),"RID",t),nn(i,"CVER",22),this.A&&nn(i,"X-HTTP-Session-Id",this.A),$n(this,i),this.i&&r&&Wn(i,this.i,r),Nn(this.b,n),this.Ga&&nn(i,"TYPE","init"),this.da?(nn(i,"$req",e),nn(i,"SID","null"),n.U=!0,Ue(n,i,null)):Ue(n,i,e),this.v=2}}else 3==this.v&&(t?Zn(this,t):0==this.g.length||In(this.b)||Zn(this))},S.Aa=function(){var t;this.j=null,rr(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Ie(x(this.Ra,this),t))},S.Ra=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,be(10),Qn(this),rr(this))},S.Qa=function(){null!=this.m&&(this.m=null,Qn(this),er(this),be(19))},S.Wa=function(t){t?(this.c.info("Successfully pinged google.com"),be(2)):(this.c.info("Failed to ping google.com"),be(1))},(S=lr.prototype).ta=function(){},S.sa=function(){},S.ra=function(){},S.qa=function(){},S.Ha=function(){},fr.prototype.a=function(t,e){return new pr(t,e)},F(pr,Ft),pr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;be(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=hr(t,null,t.fa),Yn(t)},pr.prototype.close=function(){Hn(this.a)},pr.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Kn(this.a,e)):this.l?((e={}).__data__=Gt(t),Kn(this.a,e)):Kn(this.a,t)},pr.prototype.G=function(){this.a.f=null,delete this.f,Hn(this.a),delete this.a,pr.X.G.call(this)},F(dr,ke),F(yr,De),F(vr,lr),vr.prototype.ta=function(){Bt(this.a,"a")},vr.prototype.sa=function(t){Bt(this.a,new dr(t))},vr.prototype.ra=function(t){Bt(this.a,new yr)},vr.prototype.qa=function(){Bt(this.a,"b")},fr.prototype.createWebChannel=fr.prototype.a,pr.prototype.send=pr.prototype.h,pr.prototype.open=pr.prototype.g,Ae.NO_ERROR=0,Ae.TIMEOUT=8,Ae.HTTP_ERROR=6,Te.COMPLETE="complete",(Oe.EventType=O).OPEN="a",O.CLOSE="b",O.ERROR="c",O.MESSAGE="d",Ft.prototype.listen=Ft.prototype.va,Ln.prototype.listenOnce=Ln.prototype.wa,Ln.prototype.getLastError=Ln.prototype.Oa,Ln.prototype.getLastErrorCode=Ln.prototype.ua,Ln.prototype.getStatus=Ln.prototype.W,Ln.prototype.getResponseJson=Ln.prototype.Na,Ln.prototype.getResponseText=Ln.prototype.$,Ln.prototype.send=Ln.prototype.ba;var gr=Ae,mr=Te,wr=Oe,br=Ln,Er=(Ir.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Ir.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Ir.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Ir);function Ir(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Ar=(Tr.prototype.getPlatformInfoString=function(){return this.container.getProviders().map(function(t){if(function(t){t=t.getComponent();return"VERSION"===(null==t?void 0:t.type)}(t)){t=t.getImmediate();return t.library+"/"+t.version}return null}).filter(function(t){return t}).join(" ")},Tr);function Tr(t){this.container=t}var Nr="@firebase/app-exp",Sr=new f("@firebase/app"),Or="[DEFAULT]",Pr=((Te={})[Nr]="fire-core",Te["@firebase/app-compat"]="fire-core-compat",Te["@firebase/analytics"]="fire-analytics",Te["@firebase/auth"]="fire-auth",Te["@firebase/database"]="fire-rtdb",Te["@firebase/functions-exp"]="fire-fn",Te["@firebase/functions-compat"]="fire-fn-compat",Te["@firebase/installations"]="fire-iid",Te["@firebase/messaging"]="fire-fcm",Te["@firebase/performance"]="fire-perf",Te["@firebase/remote-config"]="fire-rc",Te["@firebase/storage"]="fire-gcs",Te["@firebase/firestore"]="fire-fst",Te["fire-js"]="fire-js",Te["firebase-exp"]="fire-js-all",Te),kr=new Map,Dr=new Map;function Rr(t){var e,n,r=t.name;if(!Dr.has(r)){Dr.set(r,t);try{for(var i=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(kr.values()),o=i.next();!o.done;o=i.next()){!function(e,n){try{e.container.addComponent(n)}catch(t){Sr.debug("Component "+n.name+" failed to register with FirebaseApp "+e.name,t)}}(o.value,t)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return 1}Sr.debug("There were multiple attempts to register component "+r+".")}var Lr,Te=((Te={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",Te["bad-app-name"]="Illegal App name: '{$appName}",Te["duplicate-app"]="Firebase App named '{$appName}' already exists",Te["app-deleted"]="Firebase App named '{$appName}' already deleted",Te["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",Te["invalid-log-argument"]="First argument to `onLog` must be null or a function.",Te),_r=new E("app","Firebase",Te);Object.defineProperty(Vr.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(Vr.prototype,"name",{get:function(){return this.checkDestroyed(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(Vr.prototype,"options",{get:function(){return this.checkDestroyed(),this.options_},enumerable:!1,configurable:!0}),Vr.prototype.checkDestroyed=function(){if(this.isDeleted)throw _r.create("app-deleted",{appName:this.name_})};function Vr(t,e,n){var r=this;this.isDeleted=!1,this.options_=i({},t),this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled,this.container=n,this.container.addComponent(new Er("app-exp",function(){return r},"PUBLIC"))}function Cr(t,e,n){var r=null!==(i=Pr[t])&&void 0!==i?i:t;n&&(r+="-"+n);var i=r.match(/\s|\//),t=e.match(/\s|\//);if(i||t){n=['Unable to register library "'+r+'" with version "'+e+'":'];return i&&n.push('library name "'+r+'" contains illegal characters (whitespace or "/")'),i&&t&&n.push("and"),t&&n.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void Sr.warn(n.join(" "))}Rr(new Er(r+"-version",function(){return{library:r,version:e}},"VERSION"))}Rr(new Er("platform-logger",function(t){return new Ar(t)},"PRIVATE")),Cr(Nr,"0.0.800",Lr),Cr("fire-js","");var Ur,jr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},xr=(n(Fr,Ur=Error),Fr),Mr="8.0.2-20201010222127",qr=new f("@firebase/firestore");function Fr(t,e){var n=this;return(n=Ur.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Br(){return qr.logLevel}function Wr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];qr.logLevel<=u.DEBUG&&(e=n.map(Hr),qr.debug.apply(qr,o(["Firestore ("+Mr+"): "+t],e)))}function Gr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];qr.logLevel<=u.ERROR&&(e=n.map(Hr),qr.error.apply(qr,o(["Firestore ("+Mr+"): "+t],e)))}function zr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];qr.logLevel<=u.WARN&&(e=n.map(Hr),qr.warn.apply(qr,o(["Firestore ("+Mr+"): "+t],e)))}function Hr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Qr(t){void 0===t&&(t="Unexpected state");t="FIRESTORE ("+Mr+") INTERNAL ASSERTION FAILED: "+t;throw Gr(t),new Error(t)}function Xr(t){t||Qr()}var Kr=(Yr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Yr);function Yr(){}function Zr(t,e){return t<e?-1:e<t?1:0}function $r(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var Jr=(ti.fromBase64String=function(t){return new ti(atob(t))},ti.fromUint8Array=function(t){return new ti(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},ti.prototype.toBase64=function(){return t=this.i,btoa(t);var t},ti.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},ti.prototype.o=function(){return 2*this.i.length},ti.prototype.u=function(t){return Zr(this.i,t.i)},ti.prototype.isEqual=function(t){return this.i===t.i},ti);function ti(t){this.i=t}Jr.h=new Jr("");var ei=(ni.fromBase64String=function(t){try{return new ni(Jr.fromBase64String(t))}catch(t){throw new xr(jr.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},ni.fromUint8Array=function(t){return new ni(Jr.fromUint8Array(t))},ni.prototype.toBase64=function(){return this.l.toBase64()},ni.prototype.toUint8Array=function(){return this.l.toUint8Array()},ni.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},ni.prototype.isEqual=function(t){return this.l.isEqual(t.l)},ni);function ni(t){this.l=t}function ri(){if("undefined"==typeof Uint8Array)throw new xr(jr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function ii(){if("undefined"==typeof atob)throw new xr(jr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var oi,si=(n(ci,oi=ei),ci.fromBase64String=function(t){ii();try{return new ci(Jr.fromBase64String(t))}catch(t){throw new xr(jr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},ci.fromUint8Array=function(t){return ri(),new ci(Jr.fromUint8Array(t))},ci.prototype.toBase64=function(){return ii(),oi.prototype.toBase64.call(this)},ci.prototype.toUint8Array=function(){return ri(),oi.prototype.toUint8Array.call(this)},ci.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},ci),ui=function(t,e,n,r,i,o){this._=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.m=o},ai=(Object.defineProperty(hi.prototype,"T",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),hi.prototype.isEqual=function(t){return t instanceof hi&&t.projectId===this.projectId&&t.database===this.database},hi);function hi(t,e){this.projectId=t,this.database=e||"(default)"}function ci(){return null!==oi&&oi.apply(this,arguments)||this}function li(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function fi(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function pi(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var di,yi,vi=(ki.prototype.get=function(t){var e=this.I(t),e=this.R[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.A(o,t))return i}},ki.prototype.has=function(t){return void 0!==this.get(t)},ki.prototype.set=function(t,e){var n=this.I(t),r=this.R[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.A(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.R[n]=[[t,e]]},ki.prototype.delete=function(t){var e=this.I(t),n=this.R[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.A(n[r][0],t))return 1===n.length?delete this.R[e]:n.splice(r,1),!0;return!1},ki.prototype.forEach=function(s){fi(this.R,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},ki.prototype.P=function(){return pi(this.R)},ki),gi=(Pi.now=function(){return Pi.fromMillis(Date.now())},Pi.fromDate=function(t){return Pi.fromMillis(t.getTime())},Pi.fromMillis=function(t){var e=Math.floor(t/1e3);return new Pi(e,1e6*(t-1e3*e))},Pi.prototype.toDate=function(){return new Date(this.toMillis())},Pi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Pi.prototype.V=function(t){return this.seconds===t.seconds?Zr(this.nanoseconds,t.nanoseconds):Zr(this.seconds,t.seconds)},Pi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Pi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Pi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},Pi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Pi),mi=(Oi.g=function(t){return new Oi(t)},Oi.min=function(){return new Oi(new gi(0,0))},Oi.prototype.u=function(t){return this.timestamp.V(t.timestamp)},Oi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Oi.prototype.p=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Oi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Oi.prototype.v=function(){return this.timestamp},Oi),Te=(Object.defineProperty(Si.prototype,"length",{get:function(){return this.C},enumerable:!1,configurable:!0}),Si.prototype.isEqual=function(t){return 0===Si.S(this,t)},Si.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Si?t.forEach(function(t){e.push(t)}):e.push(t),this.D(e)},Si.prototype.limit=function(){return this.offset+this.length},Si.prototype.F=function(t){return t=void 0===t?1:t,this.D(this.segments,this.offset+t,this.length-t)},Si.prototype.N=function(){return this.D(this.segments,this.offset,this.length-1)},Si.prototype.$=function(){return this.segments[this.offset]},Si.prototype.O=function(){return this.get(this.length-1)},Si.prototype.get=function(t){return this.segments[this.offset+t]},Si.prototype.P=function(){return 0===this.length},Si.prototype.k=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Si.prototype.M=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Si.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Si.prototype.L=function(){return this.segments.slice(this.offset,this.limit())},Si.S=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Si),wi=(n(Ni,yi=Te),Ni.prototype.D=function(t,e,n){return new Ni(t,e,n)},Ni.prototype.q=function(){return this.L().join("/")},Ni.prototype.toString=function(){return this.q()},Ni.U=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new xr(jr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new Ni(n)},Ni.B=function(){return new Ni([])},Ni),bi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ei=(n(Ti,di=Te),Ti.prototype.D=function(t,e,n){return new Ti(t,e,n)},Ti.j=function(t){return bi.test(t)},Ti.prototype.q=function(){return this.L().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),Ti.j(t)||(t="`"+t+"`"),t}).join(".")},Ti.prototype.toString=function(){return this.q()},Ti.prototype.W=function(){return 1===this.length&&"__name__"===this.get(0)},Ti.K=function(){return new Ti(["__name__"])},Ti.G=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new xr(jr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new xr(jr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new xr(jr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new xr(jr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Ti(e)},Ti.B=function(){return new Ti([])},Ti),Ii=(Ai.H=function(t){return new Ai(wi.U(t))},Ai.Y=function(t){return new Ai(wi.U(t).F(5))},Ai.prototype.J=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Ai.prototype.isEqual=function(t){return null!==t&&0===wi.S(this.path,t.path)},Ai.prototype.toString=function(){return this.path.toString()},Ai.S=function(t,e){return wi.S(t.path,e.path)},Ai.X=function(t){return t.length%2==0},Ai.Z=function(t){return new Ai(new wi(t.slice()))},Ai);function Ai(t){this.path=t}function Ti(){return null!==di&&di.apply(this,arguments)||this}function Ni(){return null!==yi&&yi.apply(this,arguments)||this}function Si(t,e,n){void 0===e?e=0:e>t.length&&Qr(),void 0===n?n=t.length-e:n>t.length-e&&Qr(),this.segments=t,this.offset=e,this.C=n}function Oi(t){this.timestamp=t}function Pi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new xr(jr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new xr(jr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new xr(jr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new xr(jr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function ki(t,e){this.I=t,this.A=e,this.R={}}function Di(t){return null==t}function Ri(t){return 0===t&&1/t==-1/0}var Li=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.tt=null};function _i(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Li(t,e,n,r,i,o,s)}function Vi(t){var e=t;return null===e.tt&&(t=e.path.q(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.q()+t.op.toString()+Vo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.q()+t.dir}).join(","),Di(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=ra(e.startAt)),e.endAt&&(t+="|ub:",t+=ra(e.endAt)),e.tt=t),e.tt}function Ci(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!Do(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!oa(t.startAt,e.startAt)&&oa(t.endAt,e.endAt)}function Ui(t){return Ii.X(t.path)&&null===t.collectionGroup&&0===t.filters.length}function ji(t){this.count=t}var xi,Mi=(qi.prototype.st=function(t){return new qi(this.target,this.targetId,this.nt,t,this.et,this.lastLimboFreeSnapshotVersion,this.resumeToken)},qi.prototype.it=function(t,e){return new qi(this.target,this.targetId,this.nt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},qi.prototype.rt=function(t){return new qi(this.target,this.targetId,this.nt,this.sequenceNumber,this.et,t,this.resumeToken)},qi);function qi(t,e,n,r,i,o,s){void 0===i&&(i=mi.min()),void 0===o&&(o=mi.min()),void 0===s&&(s=Jr.h),this.target=t,this.targetId=e,this.nt=n,this.sequenceNumber=r,this.et=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Fi(t){switch(t){case jr.OK:return Qr(),0;case jr.CANCELLED:case jr.UNKNOWN:case jr.DEADLINE_EXCEEDED:case jr.RESOURCE_EXHAUSTED:case jr.INTERNAL:case jr.UNAVAILABLE:case jr.UNAUTHENTICATED:return;case jr.INVALID_ARGUMENT:case jr.NOT_FOUND:case jr.ALREADY_EXISTS:case jr.PERMISSION_DENIED:case jr.FAILED_PRECONDITION:case jr.ABORTED:case jr.OUT_OF_RANGE:case jr.UNIMPLEMENTED:case jr.DATA_LOSS:return 1;default:return Qr(),0}}function Bi(t){if(void 0===t)return Gr("GRPC error has no .code"),jr.UNKNOWN;switch(t){case xi.OK:return jr.OK;case xi.CANCELLED:return jr.CANCELLED;case xi.UNKNOWN:return jr.UNKNOWN;case xi.DEADLINE_EXCEEDED:return jr.DEADLINE_EXCEEDED;case xi.RESOURCE_EXHAUSTED:return jr.RESOURCE_EXHAUSTED;case xi.INTERNAL:return jr.INTERNAL;case xi.UNAVAILABLE:return jr.UNAVAILABLE;case xi.UNAUTHENTICATED:return jr.UNAUTHENTICATED;case xi.INVALID_ARGUMENT:return jr.INVALID_ARGUMENT;case xi.NOT_FOUND:return jr.NOT_FOUND;case xi.ALREADY_EXISTS:return jr.ALREADY_EXISTS;case xi.PERMISSION_DENIED:return jr.PERMISSION_DENIED;case xi.FAILED_PRECONDITION:return jr.FAILED_PRECONDITION;case xi.ABORTED:return jr.ABORTED;case xi.OUT_OF_RANGE:return jr.OUT_OF_RANGE;case xi.UNIMPLEMENTED:return jr.UNIMPLEMENTED;case xi.DATA_LOSS:return jr.DATA_LOSS;default:return Qr()}}(f=xi=xi||{})[f.OK=0]="OK",f[f.CANCELLED=1]="CANCELLED",f[f.UNKNOWN=2]="UNKNOWN",f[f.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",f[f.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",f[f.NOT_FOUND=5]="NOT_FOUND",f[f.ALREADY_EXISTS=6]="ALREADY_EXISTS",f[f.PERMISSION_DENIED=7]="PERMISSION_DENIED",f[f.UNAUTHENTICATED=16]="UNAUTHENTICATED",f[f.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",f[f.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",f[f.ABORTED=10]="ABORTED",f[f.OUT_OF_RANGE=11]="OUT_OF_RANGE",f[f.UNIMPLEMENTED=12]="UNIMPLEMENTED",f[f.INTERNAL=13]="INTERNAL",f[f.UNAVAILABLE=14]="UNAVAILABLE",f[f.DATA_LOSS=15]="DATA_LOSS";var Wi=(Xi.prototype.ot=function(t,e){return new Xi(this.S,this.root.ot(t,e,this.S).copy(null,null,zi.ut,null,null))},Xi.prototype.remove=function(t){return new Xi(this.S,this.root.remove(t,this.S).copy(null,null,zi.ut,null,null))},Xi.prototype.get=function(t){for(var e=this.root;!e.P();){var n=this.S(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Xi.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.P();){var r=this.S(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Xi.prototype.P=function(){return this.root.P()},Object.defineProperty(Xi.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Xi.prototype.ct=function(){return this.root.ct()},Xi.prototype.ht=function(){return this.root.ht()},Xi.prototype.at=function(t){return this.root.at(t)},Xi.prototype.forEach=function(n){this.at(function(t,e){return n(t,e),!1})},Xi.prototype.toString=function(){var n=[];return this.at(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Xi.prototype.lt=function(t){return this.root.lt(t)},Xi.prototype._t=function(){return new Gi(this.root,null,this.S,!1)},Xi.prototype.ft=function(t){return new Gi(this.root,t,this.S,!1)},Xi.prototype.dt=function(){return new Gi(this.root,null,this.S,!0)},Xi.prototype.wt=function(t){return new Gi(this.root,t,this.S,!0)},Xi),Gi=(Qi.prototype.It=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.Et)for(t=t.left;!t.P();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.P();)this.Tt.push(t),t=t.left;return e},Qi.prototype.At=function(){return 0<this.Tt.length},Qi.prototype.Rt=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},Qi),zi=(Hi.prototype.copy=function(t,e,n,r,i){return new Hi(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Hi.prototype.P=function(){return!1},Hi.prototype.at=function(t){return this.left.at(t)||t(this.key,this.value)||this.right.at(t)},Hi.prototype.lt=function(t){return this.right.lt(t)||t(this.key,this.value)||this.left.lt(t)},Hi.prototype.min=function(){return this.left.P()?this:this.left.min()},Hi.prototype.ct=function(){return this.min().key},Hi.prototype.ht=function(){return this.right.P()?this.key:this.right.ht()},Hi.prototype.ot=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.ot(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.ot(t,e,n))).Pt()},Hi.prototype.yt=function(){if(this.left.P())return Hi.EMPTY;var t=this;return t.left.Vt()||t.left.left.Vt()||(t=t.gt()),(t=t.copy(null,null,null,t.left.yt(),null)).Pt()},Hi.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.P()||r.left.Vt()||r.left.left.Vt()||(r=r.gt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Vt()&&(r=r.vt()),r.right.P()||r.right.Vt()||r.right.left.Vt()||(r=r.bt()),0===e(t,r.key)){if(r.right.P())return Hi.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.yt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Pt()},Hi.prototype.Vt=function(){return this.color},Hi.prototype.Pt=function(){var t=this;return t.right.Vt()&&!t.left.Vt()&&(t=t.Ct()),t.left.Vt()&&t.left.left.Vt()&&(t=t.vt()),t.left.Vt()&&t.right.Vt()&&(t=t.St()),t},Hi.prototype.gt=function(){var t=this.St();return t.right.left.Vt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.vt())).Ct()).St()),t},Hi.prototype.bt=function(){var t=this.St();return t.left.left.Vt()&&(t=(t=t.vt()).St()),t},Hi.prototype.Ct=function(){var t=this.copy(null,null,Hi.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Hi.prototype.vt=function(){var t=this.copy(null,null,Hi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Hi.prototype.St=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Hi.prototype.Dt=function(){var t=this.Ft();return Math.pow(2,t)<=this.size+1},Hi.prototype.Ft=function(){if(this.Vt()&&this.left.Vt())throw Qr();if(this.right.Vt())throw Qr();var t=this.left.Ft();if(t!==this.right.Ft())throw Qr();return t+(this.Vt()?0:1)},Hi);function Hi(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Hi.RED,this.left=null!=r?r:Hi.EMPTY,this.right=null!=i?i:Hi.EMPTY,this.size=this.left.size+1+this.right.size}function Qi(t,e,n,r){this.Et=r,this.Tt=[];for(var i=1;!t.P();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Et?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.Et?t.right:t.left}}function Xi(t,e){this.S=t,this.root=e||zi.EMPTY}function Ki(){this.size=0}zi.EMPTY=null,zi.RED=!0,zi.ut=!1,zi.EMPTY=(Object.defineProperty(Ki.prototype,"key",{get:function(){throw Qr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ki.prototype,"value",{get:function(){throw Qr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ki.prototype,"color",{get:function(){throw Qr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ki.prototype,"left",{get:function(){throw Qr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ki.prototype,"right",{get:function(){throw Qr()},enumerable:!1,configurable:!0}),Ki.prototype.copy=function(t,e,n,r,i){return this},Ki.prototype.ot=function(t,e,n){return new zi(t,e)},Ki.prototype.remove=function(t,e){return this},Ki.prototype.P=function(){return!0},Ki.prototype.at=function(t){return!1},Ki.prototype.lt=function(t){return!1},Ki.prototype.ct=function(){return null},Ki.prototype.ht=function(){return null},Ki.prototype.Vt=function(){return!1},Ki.prototype.Dt=function(){return!0},Ki.prototype.Ft=function(){return 0},new Ki);var Yi=(to.prototype.has=function(t){return null!==this.data.get(t)},to.prototype.first=function(){return this.data.ct()},to.prototype.last=function(){return this.data.ht()},Object.defineProperty(to.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),to.prototype.indexOf=function(t){return this.data.indexOf(t)},to.prototype.forEach=function(n){this.data.at(function(t,e){return n(t),!1})},to.prototype.Nt=function(t,e){for(var n=this.data.ft(t[0]);n.At();){var r=n.It();if(0<=this.S(r.key,t[1]))return;e(r.key)}},to.prototype.xt=function(t,e){for(var n=void 0!==e?this.data.ft(e):this.data._t();n.At();)if(!t(n.It().key))return},to.prototype.$t=function(t){t=this.data.ft(t);return t.At()?t.It().key:null},to.prototype._t=function(){return new Zi(this.data._t())},to.prototype.ft=function(t){return new Zi(this.data.ft(t))},to.prototype.add=function(t){return this.copy(this.data.remove(t).ot(t,!0))},to.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},to.prototype.P=function(){return this.data.P()},to.prototype.Ot=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},to.prototype.isEqual=function(t){if(!(t instanceof to))return!1;if(this.size!==t.size)return!1;for(var e=this.data._t(),n=t.data._t();e.At();){var r=e.It().key,i=n.It().key;if(0!==this.S(r,i))return!1}return!0},to.prototype.L=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},to.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},to.prototype.copy=function(t){var e=new to(this.S);return e.data=t,e},to),Zi=(Ji.prototype.It=function(){return this.kt.It().key},Ji.prototype.At=function(){return this.kt.At()},Ji),$i=new Wi(Ii.S);function Ji(t){this.kt=t}function to(t){this.S=t,this.data=new Wi(this.S)}var eo=new Wi(Ii.S);var no=new Wi(Ii.S),ro=new Yi(Ii.S);function io(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=ro,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var oo=new Yi(Zr);var so=(Ao.qt=function(t){return new Ao(t.S)},Ao.prototype.has=function(t){return null!=this.Mt.get(t)},Ao.prototype.get=function(t){return this.Mt.get(t)},Ao.prototype.first=function(){return this.Lt.ct()},Ao.prototype.last=function(){return this.Lt.ht()},Ao.prototype.P=function(){return this.Lt.P()},Ao.prototype.indexOf=function(t){t=this.Mt.get(t);return t?this.Lt.indexOf(t):-1},Object.defineProperty(Ao.prototype,"size",{get:function(){return this.Lt.size},enumerable:!1,configurable:!0}),Ao.prototype.forEach=function(n){this.Lt.at(function(t,e){return n(t),!1})},Ao.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Mt.ot(t.key,t),e.Lt.ot(t,null))},Ao.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Mt.remove(t),this.Lt.remove(e)):this},Ao.prototype.isEqual=function(t){if(!(t instanceof Ao))return!1;if(this.size!==t.size)return!1;for(var e=this.Lt._t(),n=t.Lt._t();e.At();){var r=e.It().key,i=n.It().key;if(!r.isEqual(i))return!1}return!0},Ao.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Ao.prototype.copy=function(t,e){var n=new Ao;return n.S=this.S,n.Mt=t,n.Lt=e,n},Ao),uo=(Io.prototype.track=function(t){var e=t.doc.key,n=this.Ut.get(e);!n||0!==t.type&&3===n.type?this.Ut=this.Ut.ot(e,t):3===t.type&&1!==n.type?this.Ut=this.Ut.ot(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Ut=this.Ut.ot(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Ut=this.Ut.ot(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Ut=this.Ut.remove(e):1===t.type&&2===n.type?this.Ut=this.Ut.ot(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Ut=this.Ut.ot(e,{type:2,doc:t.doc}):Qr()},Io.prototype.Bt=function(){var n=[];return this.Ut.at(function(t,e){n.push(e)}),n},Io),ao=(Eo.Gt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Eo(t,e,so.qt(e),i,n,r,!0,!1)},Object.defineProperty(Eo.prototype,"hasPendingWrites",{get:function(){return!this.Qt.P()},enumerable:!1,configurable:!0}),Eo.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Wt===t.Wt&&this.Qt.isEqual(t.Qt)&&Su(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.jt.isEqual(t.jt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Eo),ho=(bo.Xt=function(t,e){var n=new Map;return n.set(t,co.Zt(t,e)),new bo(mi.min(),n,oo,$i,io())},bo),co=(wo.Zt=function(t,e){return new wo(Jr.h,e,io(),io(),io())},wo),lo=function(t,e,n,r){this.rn=t,this.removedTargetIds=e,this.key=n,this.on=r},fo=function(t,e){this.targetId=t,this.un=e},po=function(t,e,n,r){void 0===n&&(n=Jr.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},yo=(Object.defineProperty(mo.prototype,"tn",{get:function(){return this.ln},enumerable:!1,configurable:!0}),Object.defineProperty(mo.prototype,"resumeToken",{get:function(){return this.an},enumerable:!1,configurable:!0}),Object.defineProperty(mo.prototype,"fn",{get:function(){return 0!==this.cn},enumerable:!1,configurable:!0}),Object.defineProperty(mo.prototype,"dn",{get:function(){return this._n},enumerable:!1,configurable:!0}),mo.prototype.wn=function(t){0<t.o()&&(this._n=!0,this.an=t)},mo.prototype.mn=function(){var n=io(),r=io(),i=io();return this.hn.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Qr()}}),new co(this.an,this.ln,n,r,i)},mo.prototype.En=function(){this._n=!1,this.hn=No()},mo.prototype.Tn=function(t,e){this._n=!0,this.hn=this.hn.ot(t,e)},mo.prototype.In=function(t){this._n=!0,this.hn=this.hn.remove(t)},mo.prototype.An=function(){this.cn+=1},mo.prototype.Rn=function(){--this.cn},mo.prototype.Pn=function(){this._n=!0,this.ln=!0},mo),vo=(go.prototype.bn=function(t){for(var e=0,n=t.rn;e<n.length;e++){var r=n[e];t.on instanceof au?this.Cn(r,t.on):t.on instanceof hu&&this.Sn(r,t.key,t.on)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Sn(s,t.key,t.on)}},go.prototype.Dn=function(n){var r=this;this.Fn(n,function(t){var e=r.Nn(t);switch(n.state){case 0:r.xn(t)&&e.wn(n.resumeToken);break;case 1:e.Rn(),e.fn||e.En(),e.wn(n.resumeToken);break;case 2:e.Rn(),e.fn||r.removeTarget(t);break;case 3:r.xn(t)&&(e.Pn(),e.wn(n.resumeToken));break;case 4:r.xn(t)&&(r.$n(t),e.wn(n.resumeToken));break;default:Qr()}})},go.prototype.Fn=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Vn.forEach(function(t,e){r.xn(e)&&n(e)})},go.prototype.On=function(t){var e=t.targetId,n=t.un.count,t=this.kn(e);t&&(Ui(t=t.target)?0===n?(t=new Ii(t.path),this.Sn(e,t,new hu(t,mi.min()))):Xr(1===n):this.Mn(e)!==n&&(this.$n(e),this.vn=this.vn.add(e)))},go.prototype.Ln=function(r){var i=this,o=new Map;this.Vn.forEach(function(t,e){var n=i.kn(e);n&&(t.tn&&Ui(n.target)&&(n=new Ii(n.target.path),null!==i.gn.get(n)||i.qn(e,n)||i.Sn(e,n,new hu(n,r))),t.dn&&(o.set(e,t.mn()),t.En()))});var s=io();this.pn.forEach(function(t,e){var n=!0;e.xt(function(t){t=i.kn(t);return!t||2===t.nt||(n=!1)}),n&&(s=s.add(t))});var t=new ho(r,o,this.vn,this.gn,s);return this.gn=$i,this.pn=To(),this.vn=new Yi(Zr),t},go.prototype.Cn=function(t,e){var n;this.xn(t)&&(n=this.qn(t,e.key)?2:0,this.Nn(t).Tn(e.key,n),this.gn=this.gn.ot(e.key,e),this.pn=this.pn.ot(e.key,this.Un(e.key).add(t)))},go.prototype.Sn=function(t,e,n){var r;this.xn(t)&&(r=this.Nn(t),this.qn(t,e)?r.Tn(e,1):r.In(e),this.pn=this.pn.ot(e,this.Un(e).delete(t)),n&&(this.gn=this.gn.ot(e,n)))},go.prototype.removeTarget=function(t){this.Vn.delete(t)},go.prototype.Mn=function(t){var e=this.Nn(t).mn();return this.yn.Bn(t).size+e.nn.size-e.sn.size},go.prototype.An=function(t){this.Nn(t).An()},go.prototype.Nn=function(t){var e=this.Vn.get(t);return e||(e=new yo,this.Vn.set(t,e)),e},go.prototype.Un=function(t){var e=this.pn.get(t);return e||(e=new Yi(Zr),this.pn=this.pn.ot(t,e)),e},go.prototype.xn=function(t){var e=null!==this.kn(t);return e||Wr("WatchChangeAggregator","Detected inactive target",t),e},go.prototype.kn=function(t){var e=this.Vn.get(t);return e&&e.fn?null:this.yn.jn(t)},go.prototype.$n=function(e){var n=this;this.Vn.set(e,new yo),this.yn.Bn(e).forEach(function(t){n.Sn(e,t,null)})},go.prototype.qn=function(t,e){return this.yn.Bn(t).has(e)},go);function go(t){this.yn=t,this.Vn=new Map,this.gn=$i,this.pn=To(),this.vn=new Yi(Zr)}function mo(){this.cn=0,this.hn=No(),this.an=Jr.h,this.ln=!1,this._n=!0}function wo(t,e,n,r,i){this.resumeToken=t,this.tn=e,this.nn=n,this.en=r,this.sn=i}function bo(t,e,n,r,i){this.et=t,this.zt=e,this.Ht=n,this.Yt=r,this.Jt=i}function Eo(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.jt=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.Wt=s,this.Kt=u}function Io(){this.Ut=new Wi(Ii.S)}function Ao(n){this.S=n?function(t,e){return n(t,e)||Ii.S(t.key,e.key)}:function(t,e){return Ii.S(t.key,e.key)},this.Mt=eo,this.Lt=new Wi(this.S)}function To(){return new Wi(Ii.S)}function No(){return new Wi(Ii.S)}function So(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Oo(t){t=Co(t.mapValue.fields.__local_write_time__.timestampValue);return new gi(t.seconds,t.nanos)}var Po=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ko(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?So(t)?4:10:Qr()}function Do(r,i){var t,e=ko(r);if(e!==ko(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return Oo(r).isEqual(Oo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Co(r.timestampValue),t=Co(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,jo(r.bytesValue).isEqual(jo(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Uo((t=r).geoPointValue.latitude)===Uo(e.geoPointValue.latitude)&&Uo(t.geoPointValue.longitude)===Uo(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Uo(t.integerValue)===Uo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=Uo(t.doubleValue),e=Uo(e.doubleValue);return t===e?Ri(t)===Ri(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return $r(r.arrayValue.values||[],i.arrayValue.values||[],Do);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(li(e)!==li(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!Do(e[t],n[t])))return!1;return!0}();default:return Qr()}}function Ro(t,e){return void 0!==(t.values||[]).find(function(t){return Do(t,e)})}function Lo(t,e){var n,r,i=ko(t),o=ko(e);if(i!==o)return Zr(i,o);switch(i){case 0:return 0;case 1:return Zr(t.booleanValue,e.booleanValue);case 2:return n=e,r=Uo(t.integerValue||t.doubleValue),n=Uo(n.integerValue||n.doubleValue),r<n?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return _o(t.timestampValue,e.timestampValue);case 4:return _o(Oo(t),Oo(e));case 5:return Zr(t.stringValue,e.stringValue);case 6:return function(t,e){t=jo(t),e=jo(e);return t.u(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Zr(n[i],r[i]);if(0!==o)return o}return Zr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=Zr(Uo(i.latitude),Uo(r.latitude)))?n:Zr(Uo(i.longitude),Uo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Lo(n[i],r[i]);if(o)return o}return Zr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Zr(r[s],o[s]);if(0!==u)return u;u=Lo(n[r[s]],i[o[s]]);if(0!==u)return u}return Zr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Qr()}}function _o(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Zr(t,e);var n=Co(t),t=Co(e),e=Zr(n.seconds,t.seconds);return 0!==e?e:Zr(n.nanos,t.nanos)}function Vo(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=Co(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?jo(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,Ii.Y(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):Qr();var e}(t)}function Co(t){if(Xr(!!t),"string"!=typeof t)return{seconds:Uo(t.seconds),nanos:Uo(t.nanos)};var e=0,n=Po.exec(t);Xr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Uo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function jo(t){return"string"==typeof t?Jr.fromBase64String(t):Jr.fromUint8Array(t)}function xo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.q()}}function Mo(t){return t&&"integerValue"in t}function qo(t){return!!t&&"arrayValue"in t}function Fo(t){return t&&"nullValue"in t}function Bo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Wo(t){return t&&"mapValue"in t}var Go={asc:"ASCENDING",desc:"DESCENDING"},zo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ho=function(t,e){this._=t,this.Qn=e};function Qo(t){return{integerValue:""+t}}function Xo(t,e){if(t.Qn){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ri(e)?"-0":e}}function Ko(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!Ri(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Qo(e):Xo(t,e);var n}function Yo(t,e){return t.Qn?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Zo(t,e){return t.Qn?e.toBase64():e.toUint8Array()}function $o(t){return Xr(!!t),mi.g((t=Co(t),new gi(t.seconds,t.nanos)))}function Jo(t,e){return new wi(["projects",t.projectId,"databases",t.database]).child("documents").child(e).q()}function ts(t,e){return Jo(t._,e.path)}function es(t,e){Xr(hs(e=wi.U(e)));return Xr(e.get(1)===t._.projectId),Xr(!e.get(3)&&!t._.database||e.get(3)===t._.database),new Ii((Xr(4<(e=e).length&&"documents"===e.get(4)),e.F(5)))}function ns(t,e){return Jo(t._,e)}function rs(t){return new wi(["projects",t._.projectId,"databases",t._.database]).q()}function is(t,e,n){return{name:ts(t,e),fields:n.proto.mapValue.fields}}function os(t,e){var n,r,i;if(e instanceof qs)n={update:is(t,e.key,e.value)};else if(e instanceof Zs)n={delete:ts(t,e.key)};else if(e instanceof Fs)n={update:is(t,e.key,e.data),updateMask:(i=e.Wn,r=[],i.fields.forEach(function(t){return r.push(t.q())}),{fieldPaths:r})};else if(e instanceof Hs)n={transform:{document:ts(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof ps)return{fieldPath:t.field.q(),setToServerValue:"REQUEST_TIME"};if(e instanceof ds)return{fieldPath:t.field.q(),appendMissingElements:{values:e.elements}};if(e instanceof ws)return{fieldPath:t.field.q(),removeAllFromArray:{values:e.elements}};if(e instanceof As)return{fieldPath:t.field.q(),increment:e.Kn};throw Qr()})}};else{if(!(e instanceof $s))return Qr();n={verify:ts(t,e.key)}}return e.zn.Gn||(n.currentDocument=void 0!==(i=e.zn).updateTime?{updateTime:(e=t,t=i.updateTime,Yo(e,t.v()))}:void 0!==i.exists?{exists:i.exists}:Qr()),n}function ss(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=ns(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=ns(t,r.N()),n.structuredQuery.from=[{collectionId:r.O()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(Bo(t.value))return{unaryFilter:{field:as(t.field),op:"IS_NAN"}};if(Fo(t.value))return{unaryFilter:{field:as(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Bo(t.value))return{unaryFilter:{field:as(t.field),op:"IS_NOT_NAN"}};if(Fo(t.value))return{unaryFilter:{field:as(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:as(t.field),op:(e=t.op,zo[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:as((t=t).field),direction:(t=t.dir,Go[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.Qn||Di(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=us(e.startAt)),e.endAt&&(n.structuredQuery.endAt=us(e.endAt)),n}function us(t){return{before:t.before,values:t.position}}function as(t){return{fieldPath:t.q()}}function hs(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}Te=function(){this.Hn=void 0};function cs(t,e){return t instanceof As?Mo(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var ls,fs,ps=(n(vs,fs=Te),vs),ds=(n(ys,ls=Te),ys);function ys(t){var e=this;return(e=ls.call(this)||this).elements=t,e}function vs(){return null!==fs&&fs.apply(this,arguments)||this}function gs(t,e){for(var n=Ss(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return Do(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var ms,ws=(n(bs,ms=Te),bs);function bs(t){var e=this;return(e=ms.call(this)||this).elements=t,e}function Es(t,e){for(var n=Ss(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!Do(t,e)})}(i[r]);return{arrayValue:{values:n}}}var Is,As=(n(Ts,Is=Te),Ts);function Ts(t,e){var n=this;return(n=Is.call(this)||this).serializer=t,n.Kn=e,n}function Ns(t){return Uo(t.integerValue||t.doubleValue)}function Ss(t){return qo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Os(t,e){this.field=t,this.transform=e}var Ps=(ks.prototype.Yn=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].k(t))return!0;return!1},ks.prototype.isEqual=function(t){return $r(this.fields,t.fields,function(t,e){return t.isEqual(e)})},ks);function ks(t){(this.fields=t).sort(Ei.S)}function Ds(t,e){this.version=t,this.transformResults=e}var Rs=(Ls.Jn=function(){return new Ls},Ls.exists=function(t){return new Ls(void 0,t)},Ls.updateTime=function(t){return new Ls(t)},Object.defineProperty(Ls.prototype,"Gn",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Ls.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Ls);function Ls(t,e){this.updateTime=t,this.exists=e}function _s(t,e){return void 0!==t.updateTime?e instanceof au&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof au}f=function(){};function Vs(t,e,n){return t instanceof qs?new au(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof Fs?function(t,e,n){if(!_s(t.zn,e))return new cu(t.key,n.version);e=Gs(t,e);return new au(t.key,n.version,e,{hasCommittedMutations:!0})}(t,e,n):t instanceof Hs?function(t,e,n){if(Xr(null!=n.transformResults),!_s(t.zn,e))return new cu(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Xr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof au&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof ds?gs(o,s):o instanceof ws?Es(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=Xs(t,r.data(),e);return new au(t.key,n,e,{hasCommittedMutations:!0})}(t,e,n):new hu(t.key,n.version,{hasCommittedMutations:!0})}function Cs(t,e,n,r){return t instanceof qs?function(t,e){if(!_s(t.zn,e))return e;e=js(e);return new au(t.key,e,t.value,{Xn:!0})}(t,e):t instanceof Fs?function(t,e){if(!_s(t.zn,e))return e;var n=js(e),e=Gs(t,e);return new au(t.key,n,e,{Xn:!0})}(t,e):t instanceof Hs?function(t,e,n,r){if(!_s(t.zn,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],h=a.transform,c=null;n instanceof au&&(c=n.field(a.field)),null===c&&r instanceof au&&(c=r.field(a.field)),o.push((i=c,a=e,c=void 0,(h=h)instanceof ps?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(c.fields.__previous_value__=i),{mapValue:c}):h instanceof ds?gs(h,i):h instanceof ws?Es(h,i):(h=cs(c=h,i),i=Ns(h)+Ns(c.Kn),Mo(h)&&Mo(c.Kn)?Qo(i):Xo(c.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=Xs(t,i.data(),r);return new au(t.key,i.version,r,{Xn:!0})}(t,e,r,n):(e=e,_s((t=t).zn,e)?new hu(t.key,mi.min()):e)}function Us(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.zn.isEqual(e.zn)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Wn.isEqual(e.Wn):2!==t.type||$r(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof ds&&e instanceof ds||t instanceof ws&&e instanceof ws?$r(t.elements,e.elements,Do):t instanceof As&&e instanceof As?Do(t.Kn,e.Kn):t instanceof ps&&e instanceof ps)}))}function js(t){return t instanceof au?t.version:mi.min()}var xs,Ms,qs=(n(Ws,Ms=f),Ws),Fs=(n(Bs,xs=f),Bs);function Bs(t,e,n,r){var i=this;return(i=xs.call(this)||this).key=t,i.data=e,i.Wn=n,i.zn=r,i.type=1,i}function Ws(t,e,n){var r=this;return(r=Ms.call(this)||this).key=t,r.value=e,r.zn=n,r.type=0,r}function Gs(t,e){return n=t,e=e instanceof au?e.data():Js.empty(),r=new tu(e),n.Wn.fields.forEach(function(t){var e;t.P()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Zn();var n,r}var zs,Hs=(n(Qs,zs=f),Qs);function Qs(t,e){var n=this;return(n=zs.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.zn=Rs.exists(!0),n}function Xs(t,e,n){for(var r=new tu(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Zn()}var Ks,Ys,Zs=(n(iu,Ys=f),iu),$s=(n(ru,Ks=f),ru),Js=(nu.empty=function(){return new nu({mapValue:{}})},nu.prototype.field=function(t){if(t.P())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Wo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.O()])||null},nu.prototype.isEqual=function(t){return Do(this.proto,t.proto)},nu),tu=(eu.prototype.set=function(t,e){return this.ee(t,e),this},eu.prototype.delete=function(t){return this.ee(t,null),this},eu.prototype.ee=function(t,e){for(var n=this.ne,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===ko(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.O(),e)},eu.prototype.Zn=function(){var t=this.se(Ei.B(),this.ne);return null!=t?new Js(t):this.te},eu.prototype.se=function(r,t){var i=this,o=!1,e=this.te.field(r),s=Wo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.se(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},eu);function eu(t){void 0===t&&(t=Js.empty()),this.te=t,this.ne=new Map}function nu(t){this.proto=t}function ru(t,e){var n=this;return(n=Ks.call(this)||this).key=t,n.zn=e,n.type=4,n}function iu(t,e){var n=this;return(n=Ys.call(this)||this).key=t,n.zn=e,n.type=3,n}var ou,su,uu,Te=function(t,e){this.key=t,this.version=e},au=(n(du,uu=Te),du.prototype.field=function(t){return this.ie.field(t)},du.prototype.data=function(){return this.ie},du.prototype.re=function(){return this.ie.proto},du.prototype.isEqual=function(t){return t instanceof du&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Xn===t.Xn&&this.hasCommittedMutations===t.hasCommittedMutations&&this.ie.isEqual(t.ie)},du.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.ie.toString()+", {hasLocalMutations: "+this.Xn+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(du.prototype,"hasPendingWrites",{get:function(){return this.Xn||this.hasCommittedMutations},enumerable:!1,configurable:!0}),du),hu=(n(pu,su=Te),pu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(pu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),pu.prototype.isEqual=function(t){return t instanceof pu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},pu),cu=(n(fu,ou=Te),fu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(fu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),fu.prototype.isEqual=function(t){return t instanceof fu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},fu),lu=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.oe=n,this.filters=r,this.limit=i,this.ue=o,this.startAt=s,this.endAt=u,this.ce=null,this.he=null,this.startAt,this.endAt};function fu(){return null!==ou&&ou.apply(this,arguments)||this}function pu(t,e,n){var r=this;return(r=su.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function du(t,e,n,r){var i=this;return(i=uu.call(this,t,e)||this).ie=n,i.Xn=!!r.Xn,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function yu(t){return new lu(t)}function vu(t){return!Di(t.limit)&&"F"===t.ue}function gu(t){return!Di(t.limit)&&"L"===t.ue}function mu(t){return 0<t.oe.length?t.oe[0].field:null}function wu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.ae())return r.field}return null}function bu(t){return null!==t.collectionGroup}function Eu(t){var e=t;if(null===e.ce){e.ce=[];var n=wu(e),t=mu(e);if(null!==n&&null===t)n.W()||e.ce.push(new sa(n)),e.ce.push(new sa(Ei.K(),"asc"));else{for(var r=!1,i=0,o=e.oe;i<o.length;i++){var s=o[i];e.ce.push(s),s.field.W()&&(r=!0)}r||(n=0<e.oe.length?e.oe[e.oe.length-1].dir:"asc",e.ce.push(new sa(Ei.K(),n)))}}return e.ce}function Iu(t){var e=t;if(!e.he)if("F"===e.ue)e.he=_i(e.path,e.collectionGroup,Eu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Eu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new sa(o.field,s))}var u=e.endAt?new $u(e.endAt.position,!e.endAt.before):null,t=e.startAt?new $u(e.startAt.position,!e.startAt.before):null;e.he=_i(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.he}function Au(t,e,n){return new lu(t.path,t.collectionGroup,t.oe.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Tu(t,e){return new lu(t.path,t.collectionGroup,t.oe.slice(),t.filters.slice(),t.limit,t.ue,e,t.endAt)}function Nu(t,e){return new lu(t.path,t.collectionGroup,t.oe.slice(),t.filters.slice(),t.limit,t.ue,t.startAt,e)}function Su(t,e){return Ci(Iu(t),Iu(e))&&t.ue===e.ue}function Ou(t){return Vi(Iu(t))+"|lt:"+t.ue}function Pu(t){return"Query(target="+(e=Iu(t),n=e.path.q(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.q()+" "+t.op+" "+Vo(t.value)}).join(", ")+"]"),Di(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.q()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+ra(e.startAt)),e.endAt&&(n+=", endAt: "+ra(e.endAt)),"Target("+n+")")+"; limitType="+t.ue+")";var e,n}function ku(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.J(e.collectionGroup)&&e.path.k(n):Ii.X(e.path)?e.path.isEqual(n):e.path.M(n))&&function(t){for(var e=0,n=i.oe;e<n.length;e++){var r=n[e];if(!r.field.W()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||ia(t.startAt,Eu(t),n))&&(!t.endAt||!ia(t.endAt,Eu(t),n)));var e,n}function Du(u){return function(t,e){for(var n=!1,r=0,i=Eu(u);r<i.length;r++){var o=i[r],s=function(t,r,e){e=t.field.W()?Ii.S(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?Lo(n,t):Qr()}(t.field,e);switch(t.dir){case"asc":return e;case"desc":return-1*e;default:return Qr()}}(o,t,e);if(0!==s)return s;n=n||o.field.W()}return 0}}var Ru,Lu=(n(_u,Ru=function(){}),_u.create=function(t,e,n){return t.W()?"in"===e||"not-in"===e?this.le(t,e,n):new ju(t,e,n):"array-contains"===e?new Xu(t,n):"in"===e?new Ku(t,n):"not-in"===e?new Yu(t,n):"array-contains-any"===e?new Zu(t,n):new _u(t,e,n)},_u.le=function(t,e,n){return new("in"===e?xu:Mu)(t,n)},_u.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this._e(Lo(t,this.value)):null!==t&&ko(this.value)===ko(t)&&this._e(Lo(t,this.value))},_u.prototype._e=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Qr()}},_u.prototype.ae=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},_u);function _u(t,e,n){var r=this;return(r=Ru.call(this)||this).field=t,r.op=e,r.value=n,r}var Vu,Cu,Uu,ju=(n(Bu,Uu=Lu),Bu.prototype.matches=function(t){t=Ii.S(t.key,this.key);return this._e(t)},Bu),xu=(n(Fu,Cu=Lu),Fu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Fu),Mu=(n(qu,Vu=Lu),qu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},qu);function qu(t,e){var n=this;return(n=Vu.call(this,t,"not-in",e)||this).keys=Wu(0,e),n}function Fu(t,e){var n=this;return(n=Cu.call(this,t,"in",e)||this).keys=Wu(0,e),n}function Bu(t,e,n){var r=this;return(r=Uu.call(this,t,e,n)||this).key=Ii.Y(n.referenceValue),r}function Wu(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return Ii.Y(t.referenceValue)})}var Gu,zu,Hu,Qu,Xu=(n(na,Qu=Lu),na.prototype.matches=function(t){t=t.field(this.field);return qo(t)&&Ro(t.arrayValue,this.value)},na),Ku=(n(ea,Hu=Lu),ea.prototype.matches=function(t){t=t.field(this.field);return null!==t&&Ro(this.value.arrayValue,t)},ea),Yu=(n(ta,zu=Lu),ta.prototype.matches=function(t){if(Ro(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!Ro(this.value.arrayValue,t)},ta),Zu=(n(Ju,Gu=Lu),Ju.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!qo(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return Ro(e.value.arrayValue,t)})},Ju),$u=function(t,e){this.position=t,this.before=e};function Ju(t,e){return Gu.call(this,t,"array-contains-any",e)||this}function ta(t,e){return zu.call(this,t,"not-in",e)||this}function ea(t,e){return Hu.call(this,t,"in",e)||this}function na(t,e){return Qu.call(this,t,"array-contains",e)||this}function ra(t){return(t.before?"b":"a")+":"+t.position.map(Vo).join(",")}function ia(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.W()?Ii.S(Ii.Y(s.referenceValue),n.key):Lo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function oa(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Do(t.position[n],e.position[n]))return!1;return!0}var sa=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};var ua=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})},aa=(la.prototype.reset=function(){this.Te=0},la.prototype.Re=function(){this.Te=this.Ee},la.prototype.Pe=function(t){var e=this;this.cancel();var n=Math.floor(this.Te+this.ye()),r=Math.max(0,Date.now()-this.Ae),i=Math.max(0,n-r);0<i&&Wr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Te+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ie=this.fe.Ve(this.de,i,function(){return e.Ae=Date.now(),t()}),this.Te*=this.me,this.Te<this.we&&(this.Te=this.we),this.Te>this.Ee&&(this.Te=this.Ee)},la.prototype.ge=function(){null!==this.Ie&&(this.Ie.pe(),this.Ie=null)},la.prototype.cancel=function(){null!==this.Ie&&(this.Ie.cancel(),this.Ie=null)},la.prototype.ye=function(){return(Math.random()-.5)*this.Te},la),ha=(ca.prototype.catch=function(t){return this.next(void 0,t)},ca.prototype.next=function(r,i){var o=this;return this.Se&&Qr(),this.Se=!0,this.Ce?this.error?this.De(i,this.error):this.Fe(r,this.result):new ca(function(e,n){o.ve=function(t){o.Fe(r,t).next(e,n)},o.be=function(t){o.De(i,t).next(e,n)}})},ca.prototype.Ne=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ca.prototype.xe=function(t){try{var e=t();return e instanceof ca?e:ca.resolve(e)}catch(t){return ca.reject(t)}},ca.prototype.Fe=function(t,e){return t?this.xe(function(){return t(e)}):ca.resolve(e)},ca.prototype.De=function(t,e){return t?this.xe(function(){return t(e)}):ca.reject(e)},ca.resolve=function(n){return new ca(function(t,e){t(n)})},ca.reject=function(n){return new ca(function(t,e){e(n)})},ca.$e=function(t){return new ca(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},ca.Oe=function(t){for(var n=ca.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?ca.resolve(t):e()})}(r[e]);return n},ca.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.$e(i)},ca);function ca(t){var e=this;this.ve=null,this.be=null,this.result=void 0,this.error=void 0,this.Ce=!1,this.Se=!1,t(function(t){e.Ce=!0,e.result=t,e.ve&&e.ve(t)},function(t){e.Ce=!0,e.error=t,e.be&&e.be(t)})}function la(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.fe=t,this.de=e,this.we=n,this.me=r,this.Ee=i,this.Te=0,this.Ie=null,this.Ae=Date.now(),this.reset()}function fa(t){return"IndexedDbTransactionError"===t.name}function pa(){return"undefined"!=typeof document?document:null}var da=(ga.Ue=function(t,e,n,r,i){i=new ga(t,e,Date.now()+n,r,i);return i.start(n),i},ga.prototype.start=function(t){var e=this;this.Be=setTimeout(function(){return e.je()},t)},ga.prototype.pe=function(){return this.je()},ga.prototype.cancel=function(t){null!==this.Be&&(this.clearTimeout(),this.qe.reject(new xr(jr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},ga.prototype.je=function(){var e=this;this.ke.Qe(function(){return null!==e.Be?(e.clearTimeout(),e.op().then(function(t){return e.qe.resolve(t)})):Promise.resolve()})},ga.prototype.clearTimeout=function(){null!==this.Be&&(this.Le(this),clearTimeout(this.Be),this.Be=null)},ga),ya=(Object.defineProperty(va.prototype,"ts",{get:function(){return this.Ge},enumerable:!1,configurable:!0}),va.prototype.Qe=function(t){this.enqueue(t)},va.prototype.ns=function(t){this.es(),this.ss(t)},va.prototype.rs=function(){var t;this.Ge||(this.Ge=!0,(t=pa())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Ze))},va.prototype.enqueue=function(t){return this.es(),this.Ge?new Promise(function(t){}):this.ss(t)},va.prototype.os=function(t){var e=this;this.Qe(function(){return e.Ke.push(t),e.us()})},va.prototype.us=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Ke.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Ke[0]()];case 2:return t.sent(),this.Ke.shift(),this.Xe.reset(),[3,4];case 3:if(!fa(e=t.sent()))throw e;return Wr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Ke.length&&this.Xe.Pe(function(){return n.us()}),t.label=5;case 5:return[2]}})})},va.prototype.ss=function(t){var r=this,e=this.We.then(function(){return r.Ye=!0,t().catch(function(t){throw r.He=t,r.Ye=!1,Gr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Ye=!1,t})});return this.We=e},va.prototype.Ve=function(t,e,n){var r=this;this.es(),-1<this.Je.indexOf(t)&&(e=0);n=da.Ue(this,t,e,n,function(t){return r.cs(t)});return this.ze.push(n),n},va.prototype.es=function(){this.He&&Qr()},va.prototype.hs=function(){},va.prototype.ls=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.We];case 1:t.sent(),t.label=2;case 2:if(e!==this.We)return[3,0];t.label=3;case 3:return[2]}})})},va.prototype._s=function(t){for(var e=0,n=this.ze;e<n.length;e++)if(n[e].de===t)return!0;return!1},va.prototype.fs=function(r){var i=this;return this.ls().then(function(){i.ze.sort(function(t,e){return t.Me-e.Me});for(var t=0,e=i.ze;t<e.length;t++){var n=e[t];if(n.pe(),"all"!==r&&n.de===r)break}return i.ls()})},va.prototype.ds=function(t){this.Je.push(t)},va.prototype.cs=function(t){t=this.ze.indexOf(t);this.ze.splice(t,1)},va);function va(){var e=this;this.We=Promise.resolve(),this.Ke=[],this.Ge=!1,this.ze=[],this.He=null,this.Ye=!1,this.Je=[],this.Xe=new aa(this,"async_queue_retry"),this.Ze=function(){var t=pa();t&&Wr("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Xe.ge()};var t=pa();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Ze)}function ga(t,e,n,r,i){this.ke=t,this.de=e,this.Me=n,this.op=r,this.Le=i,this.qe=new ua,this.then=this.qe.promise.then.bind(this.qe.promise),this.qe.promise.catch(function(t){})}function ma(t,e){if(Gr("AsyncQueue",e+": "+t),fa(t))return new xr(jr.UNAVAILABLE,e+": "+t);throw t}function wa(){this.Es=new vi(Ou,Su),this.onlineState="Unknown",this.Ts=new Set}var ba=function(){this.ws=void 0,this.listeners=[]};function Ea(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.Es.get(n))||(r=!0,i=new ba),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Is(n)];case 2:return o.ws=t.sent(),[3,4];case 3:return o=t.sent(),o=ma(o,"Initialization of query '"+Pu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.Es.set(n,i),i.listeners.push(u),u.As(e.onlineState),i.ws&&u.Rs(i.ws)&&Aa(e),[2]}})})}function Ia(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.Es.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.Es.delete(n),e.Ps(n))]:[2]})})}function Aa(t){t.Ts.forEach(function(t){t.next()})}var Ta=(Oa.prototype.Rs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new ao(t.query,t.docs,t.jt,e,t.Qt,t.fromCache,t.Wt,!0)}var o=!1;return this.Vs?this.ps(t)&&(this.ys.next(t),o=!0):this.vs(t,this.onlineState)&&(this.bs(t),o=!0),this.gs=t,o},Oa.prototype.onError=function(t){this.ys.error(t)},Oa.prototype.As=function(t){this.onlineState=t;var e=!1;return this.gs&&!this.Vs&&this.vs(this.gs,t)&&(this.bs(this.gs),e=!0),e},Oa.prototype.vs=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Cs&&n||t.docs.P()&&"Offline"!==e)},Oa.prototype.ps=function(t){if(0<t.docChanges.length)return!0;var e=this.gs&&this.gs.hasPendingWrites!==t.hasPendingWrites;return!(!t.Wt&&!e)&&!0===this.options.includeMetadataChanges},Oa.prototype.bs=function(t){t=ao.Gt(t.query,t.docs,t.Qt,t.fromCache),this.Vs=!0,this.ys.next(t)},Oa),Na=(Sa.prototype.Ss=function(){return null!=this.uid},Sa.prototype.Ds=function(){return this.Ss()?"uid:"+this.uid:"anonymous-user"},Sa.prototype.isEqual=function(t){return t.uid===this.uid},Sa);function Sa(t){this.uid=t}function Oa(t,e,n){this.query=t,this.ys=e,this.Vs=!1,this.gs=null,this.onlineState="Unknown",this.options=n||{}}Na.UNAUTHENTICATED=new Na(null),Na.Fs=new Na("google-credentials-uid"),Na.Ns=new Na("first-party-uid");function Pa(t,e){this.user=e,this.type="OAuth",this.xs={},this.xs.Authorization="Bearer "+t}var ka=(Ha.prototype.getToken=function(){return Promise.resolve(null)},Ha.prototype.Os=function(){},Ha.prototype.ks=function(t){(this.$s=t)(Na.UNAUTHENTICATED)},Ha.prototype.Ms=function(){this.$s=null},Ha),Da=(za.prototype.getToken=function(){var e=this,n=this.Us,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.Us!==n?(Wr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Xr("string"==typeof t.accessToken),new Pa(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},za.prototype.Os=function(){this.forceRefresh=!0},za.prototype.ks=function(t){this.$s=t,this.qs&&t(this.currentUser)},za.prototype.Ms=function(){this.auth&&this.auth.removeAuthTokenListener(this.Ls),this.Ls=null,this.$s=null},za.prototype.Bs=function(){var t=this.auth&&this.auth.getUid();return Xr(null===t||"string"==typeof t),new Na(t)},za),Ra=(Object.defineProperty(Ga.prototype,"xs",{get:function(){var t={"X-Goog-AuthUser":this.Qs},e=this.js.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Ga),La=(Wa.prototype.getToken=function(){return Promise.resolve(new Ra(this.js,this.Qs))},Wa.prototype.ks=function(t){t(Na.Ns)},Wa.prototype.Ms=function(){},Wa.prototype.Os=function(){},Wa),_a=(Ba.prototype.Ks=function(t,e,n){for(var r=n.Gs,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Vs(o,e,r[i]))}return e},Ba.prototype.zs=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Cs(i,e,e,this.Ws))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Cs(a,e,o,this.Ws))}return e},Ba.prototype.Hs=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.zs(t.key,n.get(t.key));e&&(i=i.ot(t.key,e))}),i},Ba.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},io())},Ba.prototype.isEqual=function(t){return this.batchId===t.batchId&&$r(this.mutations,t.mutations,Us)&&$r(this.baseMutations,t.baseMutations,Us)},Ba),Va=(Fa.from=function(t,e,n){Xr(t.mutations.length===n.length);for(var r=no,i=t.mutations,o=0;o<i.length;o++)r=r.ot(i[o].key,n[o].version);return new Fa(t,e,n,r)},Fa),Ca=(qa.prototype.ni=function(e,n){var r=this;return this.Zs.ei(e,n).next(function(t){return r.si(e,n,t)})},qa.prototype.si=function(t,r,i){return this.Xs.ii(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].zs(r,t);return t})},qa.prototype.ri=function(t,e,i){var o=$i;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].zs(t,e);o=o.ot(t,e)}),o},qa.prototype.oi=function(e,t){var n=this;return this.Xs.getEntries(e,t).next(function(t){return n.ui(e,t)})},qa.prototype.ui=function(e,r){var i=this;return this.Zs.ci(e,r).next(function(t){var t=i.ri(e,r,t),n=$i;return t.forEach(function(t,e){e=e||new hu(t,mi.min()),n=n.ot(t,e)}),n})},qa.prototype.hi=function(t,e,n){return r=e,Ii.X(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.ai(t,e.path):bu(e)?this.li(t,e,n):this._i(t,e,n);var r},qa.prototype.ai=function(t,e){return this.ni(t,new Ii(e)).next(function(t){var e=eo;return t instanceof au&&(e=e.ot(t.key,t)),e})},qa.prototype.li=function(n,r,i){var o=this,s=r.collectionGroup,u=eo;return this.ti.fi(n,s).next(function(t){return ha.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new lu(t,null,e.oe.slice(),e.filters.slice(),e.limit,e.ue,e.startAt,e.endAt));return o._i(n,e,i).next(function(t){t.forEach(function(t,e){u=u.ot(t,e)})})}).next(function(){return u})})},qa.prototype._i=function(e,n,t){var h,c,r=this;return this.Xs.hi(e,n,t).next(function(t){return h=t,r.Zs.di(e,n)}).next(function(t){return c=t,r.wi(e,c,h).next(function(t){h=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=h.get(u),a=Cs(s,a,a,r.Ws);h=a instanceof au?h.ot(u,a):h.remove(u)}})}).next(function(){return h.forEach(function(t,e){ku(n,e)||(h=h.remove(t))}),h})},qa.prototype.wi=function(t,e,n){for(var r=io(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Fs&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.Xs.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof au&&(h=h.ot(t,e))}),h})},qa),Ua=(Ma.Ti=function(t,e){for(var n=io(),r=io(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Ma(t,e.fromCache,n,r)},Ma),ja=(xa.prototype.Ai=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},xa.prototype.next=function(){var t=++this.previousValue;return this.Ri&&this.Ri(t),t},xa);function xa(t,e){var n=this;this.previousValue=t,e&&(e.Ii=function(t){return n.Ai(t)},this.Ri=function(t){return e.Pi(t)})}function Ma(t,e,n,r){this.targetId=t,this.fromCache=e,this.mi=n,this.Ei=r}function qa(t,e,n){this.Xs=t,this.Zs=e,this.ti=n}function Fa(t,e,n,r){this.batch=t,this.Ys=e,this.Gs=n,this.Js=r}function Ba(t,e,n,r){this.batchId=t,this.Ws=e,this.baseMutations=n,this.mutations=r}function Wa(t,e){this.js=t,this.Qs=e}function Ga(t,e){this.js=t,this.Qs=e,this.type="FirstParty",this.user=Na.Ns}function za(t){var e=this;this.Ls=null,this.currentUser=Na.UNAUTHENTICATED,this.qs=!1,this.Us=0,this.$s=null,this.forceRefresh=!1,this.Ls=function(){e.Us++,e.currentUser=e.Bs(),e.qs=!0,e.$s&&e.$s(e.currentUser)},this.Us=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Ls):(this.Ls(null),t.get().then(function(t){e.auth=t,e.Ls&&e.auth.addAuthTokenListener(e.Ls)},function(){}))}function Ha(){this.$s=null}ja.yi=-1;var Qa=(th.prototype.gi=function(t,e){return this.Vi.add(e),ha.resolve()},th.prototype.fi=function(t,e){return ha.resolve(this.Vi.getEntries(e))},th),Xa=(Ja.prototype.add=function(t){var e=t.O(),n=t.N(),r=this.index[e]||new Yi(wi.S),t=!r.has(n);return this.index[e]=r.add(n),t},Ja.prototype.has=function(t){var e=t.O(),t=t.N(),e=this.index[e];return e&&e.has(t)},Ja.prototype.getEntries=function(t){return(this.index[t]||new Yi(wi.S)).L()},Ja),Ka=($a.prototype.next=function(){return this.pi+=2,this.pi},$a.vi=function(){return new $a(0)},$a.bi=function(){return new $a(-1)},$a),Ya=(Za.prototype.Ui=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Bi(t,n.Si)})},Za);function Za(t,e,n){this.persistence=t,this.Ci=e,this.Si=new Wi(Zr),this.Di=new vi(Vi,Ci),this.Fi=mi.min(),this.Zs=t.Ni(n),this.xi=t.$i(),this.Oi=t.ki(),this.Mi=new Ca(this.xi,this.Zs,this.persistence.Li()),this.Ci.qi(this.Mi)}function $a(t){this.pi=t}function Ja(){this.index={}}function th(){this.Vi=new Xa}function eh(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Zs,m=e.Mi,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.Zs.ji(v).next(function(t){return g=t,n=e.persistence.Ni(o),m=new Ca(e.xi,n,e.persistence.Li()),n.ji(v)}).next(function(t){for(var e=[],n=[],r=io(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.oi(v,r).next(function(t){return{Qi:t,Wi:e,Ki:n}})})})];case 1:return r=t.sent(),[2,(e.Zs=n,e.Mi=m,e.Ci.qi(e.Mi),r)]}})})}function nh(t,c){var l=t;return l.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=c.batch.keys(),h=l.xi.Gi({zi:!0});return e=l,r=t,o=h,s=(i=c).batch,n=s.keys(),u=ha.resolve(),n.forEach(function(n){u=u.next(function(){return o.ii(r,n)}).next(function(t){var e=t,t=i.Js.get(n);Xr(null!==t),(!e||e.version.u(t)<0)&&(e=s.Ks(n,e,i))&&o.Hi(e,i.Ys)})}),u.next(function(){return e.Zs.Yi(r,s)}).next(function(){return h.apply(t)}).next(function(){return l.Zs.Ji(t)}).next(function(){return l.Mi.oi(t,a)})})}function rh(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Oi.Xi(t)})}function ih(t,a){var h=t,c=a.et,l=h.Si;return h.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var i=h.xi.Gi({zi:!0});l=h.Si;var u=[];a.zt.forEach(function(t,e){var n,r,i,o=l.get(e);o&&(u.push(h.Oi.Zi(s,t.sn,e).next(function(){return h.Oi.tr(s,t.nn,e)})),0<(i=t.resumeToken).o()&&(n=o.it(i,c).st(s.nr),l=l.ot(e,n),r=o,i=t,Xr(0<(o=n).resumeToken.o()),(0===r.resumeToken.o()||3e8<=o.et.p()-r.et.p()||0<i.nn.size+i.en.size+i.sn.size)&&u.push(h.Oi.er(s,n))))});var t,o=$i,n=io();return a.Yt.forEach(function(t,e){n=n.add(t)}),u.push(i.getEntries(s,n).next(function(r){a.Yt.forEach(function(t,e){var n=r.get(t);e instanceof hu&&e.version.isEqual(mi.min())?(i.sr(t,c),o=o.ot(t,e)):null==n||0<e.version.u(n.version)||0===e.version.u(n.version)&&n.hasPendingWrites?(i.Hi(e,c),o=o.ot(t,e)):Wr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Jt.has(t)&&u.push(h.persistence.rr.ir(s,t))})})),c.isEqual(mi.min())||(t=h.Oi.Xi(s).next(function(t){return h.Oi.ur(s,s.nr,c)}),u.push(t)),ha.$e(u).next(function(){return i.apply(s)}).next(function(){return h.Mi.ui(s,o)})}).then(function(t){return h.Si=l,t})}function oh(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).Si.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.rr.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!fa(r=t.sent()))throw r;return Wr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.Si=e.Si.remove(o),e.Di.delete(n.target),[2]}})})}function sh(t,o,s){var u=t,a=mi.min(),h=io();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=Iu(o),(void 0!==(t=(i=t).Di.get(r))?ha.resolve(i.Si.get(t)):i.Oi.hr(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.Oi.ar(e,t.targetId).next(function(t){h=t})}).next(function(){return u.Ci.hi(e,o,s?a:mi.min(),s?h:io())}).next(function(t){return{documents:t,lr:h}});var t,n,r,i})}function uh(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==jr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Wr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function ah(t,e,n,r,i){var o=this;this.io=t,this.ro=e,this.ke=n,this.oo={},this.uo=[],this.co=new Map,this.ho=new Set,this.ao=[],this.lo=i,this.lo._o(function(t){n.Qe(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return kh(this)?(Wr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).ho.add(4),[4,Ih(e)];case 1:return t.sent(),e.fo.set("Unknown"),e.ho.delete(4),[4,Eh(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.fo=new yh(n,r)}var hh,ch,lh,f=(bh.prototype.Tr=function(){return 1===this.state||2===this.state||4===this.state},bh.prototype.Ir=function(){return 2===this.state},bh.prototype.start=function(){3!==this.state?this.auth():this.Ar()},bh.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},bh.prototype.Rr=function(){this.state=0,this.Xe.reset()},bh.prototype.Pr=function(){var t=this;this.Ir()&&null===this.Er&&(this.Er=this.fe.Ve(this._r,6e4,function(){return t.yr()}))},bh.prototype.Vr=function(t){this.gr(),this.stream.send(t)},bh.prototype.yr=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.Ir()?[2,this.close(0)]:[2]})})},bh.prototype.gr=function(){this.Er&&(this.Er.cancel(),this.Er=null)},bh.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.gr(),this.Xe.cancel(),this.mr++,3!==e?this.Xe.reset():n&&n.code===jr.RESOURCE_EXHAUSTED?(Gr(n.toString()),Gr("Using maximum backoff delay to prevent overloading the backend."),this.Xe.Re()):n&&n.code===jr.UNAUTHENTICATED&&this.wr.Os(),null!==this.stream&&(this.pr(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.vr(n)];case 1:return t.sent(),[2]}})})},bh.prototype.pr=function(){},bh.prototype.auth=function(){var n=this;this.state=1;var t=this.br(this.mr),e=this.mr;this.wr.getToken().then(function(t){n.mr===e&&n.Cr(t)},function(e){t(function(){var t=new xr(jr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Sr(t)})})},bh.prototype.Cr=function(t){var e=this,n=this.br(this.mr);this.stream=this.Dr(t),this.stream.Fr(function(){n(function(){return e.state=2,e.listener.Fr()})}),this.stream.vr(function(t){n(function(){return e.Sr(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},bh.prototype.Ar=function(){var t=this;this.state=4,this.Xe.Pe(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},bh.prototype.Sr=function(t){return Wr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},bh.prototype.br=function(e){var n=this;return function(t){n.fe.Qe(function(){return n.mr===e?t():(Wr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},bh),fh=(n(wh,lh=f),wh.prototype.Dr=function(t){return this.dr.Nr("Listen",t)},wh.prototype.onMessage=function(t){this.Xe.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:Qr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.Qn?(Xr(void 0===o||"string"==typeof o),Jr.fromBase64String(o||"")):(Xr(void 0===o||o instanceof Uint8Array),Jr.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?jr.UNKNOWN:Bi(s.code),new xr(o,s.message||"")),r=new po(n,r,i,s||null)}else if("documentChange"in e){e.documentChange;var u=e.documentChange;u.document,u.document.name,u.document.updateTime;var i=es(t,u.document.name),a=$o(u.document.updateTime),s=new Js({mapValue:{fields:u.document.fields}}),a=new au(i,a,s,{}),s=u.targetIds||[],u=u.removedTargetIds||[];r=new lo(s,u,a.key,a)}else if("documentDelete"in e){e.documentDelete;u=e.documentDelete;u.document;var a=es(t,u.document),h=u.readTime?$o(u.readTime):mi.min(),h=new hu(a,h),u=u.removedTargetIds||[];r=new lo([],u,h.key,h)}else if("documentRemove"in e){e.documentRemove;h=e.documentRemove;h.document;var c=es(t,h.document),h=h.removedTargetIds||[];r=new lo([],h,c,null)}else{if(!("filter"in e))return Qr();e.filter;c=e.filter;c.targetId;e=c.count||0,e=new ji(e),c=c.targetId;r=new fo(c,e)}return r}(this.serializer,t),t=function(t){if(!("targetChange"in t))return mi.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?$o(t.readTime):mi.min()}(t);return this.listener.$r(e,t)},wh.prototype.Or=function(t){var e,n,r,i={};i.database=rs(this.serializer),i.addTarget=(e=this.serializer,(r=Ui(r=(n=t).target)?{documents:{documents:[ns(e,r.path)]}}:{query:ss(e,r)}).targetId=n.targetId,0<n.resumeToken.o()&&(r.resumeToken=Zo(e,n.resumeToken)),r);var o,t=(this.serializer,o=t,null==(t=function(){switch(o.nt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Qr()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.Vr(i)},wh.prototype.kr=function(t){var e={};e.database=rs(this.serializer),e.removeTarget=t,this.Vr(e)},wh),ph=(n(mh,ch=f),Object.defineProperty(mh.prototype,"Lr",{get:function(){return this.Mr},enumerable:!1,configurable:!0}),mh.prototype.start=function(){this.Mr=!1,this.lastStreamToken=void 0,ch.prototype.start.call(this)},mh.prototype.pr=function(){this.Mr&&this.qr([])},mh.prototype.Dr=function(t){return this.dr.Nr("Write",t)},mh.prototype.onMessage=function(t){if(Xr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Mr){this.Xe.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Xr(void 0!==r),n.map(function(t){return function(t,e){var n=t.updateTime?$o(t.updateTime):$o(e);n.isEqual(mi.min())&&(n=$o(e));e=null;return t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new Ds(n,e)}(t,r)})):[]),n=$o(t.commitTime);return this.listener.Ur(n,e)}var n,r;return Xr(!t.writeResults||0===t.writeResults.length),this.Mr=!0,this.listener.Br()},mh.prototype.jr=function(){var t={};t.database=rs(this.serializer),this.Vr(t)},mh.prototype.qr=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return os(e.serializer,t)})};this.Vr(t)},mh),dh=(n(gh,hh=function(){}),gh.prototype.Wr=function(){if(this.Qr)throw new xr(jr.FAILED_PRECONDITION,"The client has already been terminated.")},gh.prototype.Kr=function(e,n,r){var i=this;return this.Wr(),this.credentials.getToken().then(function(t){return i.dr.Kr(e,n,r,t)}).catch(function(t){throw t.code===jr.UNAUTHENTICATED&&i.credentials.Os(),t})},gh.prototype.Gr=function(e,n,r){var i=this;return this.Wr(),this.credentials.getToken().then(function(t){return i.dr.Gr(e,n,r,t)}).catch(function(t){throw t.code===jr.UNAUTHENTICATED&&i.credentials.Os(),t})},gh.prototype.terminate=function(){this.Qr=!1},gh),yh=(vh.prototype.Xr=function(){var t=this;0===this.Hr&&(this.Zr("Unknown"),this.Yr=this.ke.Ve("online_state_timeout",1e4,function(){return t.Yr=null,t.no("Backend didn't respond within 10 seconds."),t.Zr("Offline"),Promise.resolve()}))},vh.prototype.eo=function(t){"Online"===this.state?this.Zr("Unknown"):(this.Hr++,1<=this.Hr&&(this.so(),this.no("Connection failed 1 times. Most recent error: "+t.toString()),this.Zr("Offline")))},vh.prototype.set=function(t){this.so(),this.Hr=0,"Online"===t&&(this.Jr=!1),this.Zr(t)},vh.prototype.Zr=function(t){t!==this.state&&(this.state=t,this.zr(t))},vh.prototype.no=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Jr?(Gr(t),this.Jr=!1):Wr("OnlineStateTracker",t)},vh.prototype.so=function(){null!==this.Yr&&(this.Yr.cancel(),this.Yr=null)},vh);function vh(t,e){this.ke=t,this.zr=e,this.state="Unknown",this.Hr=0,this.Yr=null,this.Jr=!0}function gh(t,e,n){var r=this;return(r=hh.call(this)||this).credentials=t,r.dr=e,r.serializer=n,r.Qr=!1,r}function mh(t,e,n,r,i){var o=this;return(o=ch.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Mr=!1,o}function wh(t,e,n,r,i){var o=this;return(o=lh.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function bh(t,e,n,r,i,o){this.fe=t,this._r=n,this.dr=r,this.wr=i,this.listener=o,this.state=0,this.mr=0,this.Er=null,this.stream=null,this.Xe=new aa(t,e)}function Eh(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!kh(r))return[3,4];e=0,n=r.ao,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Ih(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.ao,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Ah(t,e){t.co.has(e.targetId)||(t.co.set(e.targetId,e),Ph(t)?Oh(t):jh(t).Ir()&&Nh(t,e))}function Th(t,e){var n=t,t=jh(n);n.co.delete(e),t.Ir()&&Sh(n,e),0===n.co.size&&(t.Ir()?t.Pr():kh(n)&&n.fo.set("Unknown"))}function Nh(t,e){t.do.An(e.targetId),jh(t).Or(e)}function Sh(t,e){t.do.An(e),jh(t).kr(e)}function Oh(e){e.do=new vo({Bn:function(t){return e.oo.Bn(t)},jn:function(t){return e.co.get(t)||null}}),jh(e).start(),e.fo.Xr()}function Ph(t){return kh(t)&&!jh(t).Tr()&&0<t.co.size}function kh(t){return 0===t.ho.size}function Dh(t){t.do=void 0}function Rh(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.fo.set("Online"),!(u instanceof po&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.co.has(i)?[4,o.oo.wo(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.co.delete(i),o.do.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Wr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,Lh(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof lo?s.do.bn(u):u instanceof fo?s.do.On(u):s.do.Dn(u),a.isEqual(mi.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,rh(s.io)];case 8:return o=t.sent(),0<=a.u(o)?[4,(i=a,(e=(r=s).do.Ln(i)).zt.forEach(function(t,e){var n;0<t.resumeToken.o()&&((n=r.co.get(e))&&r.co.set(e,n.it(t.resumeToken,i)))}),e.Ht.forEach(function(t){var e=r.co.get(t);e&&(r.co.set(t,e.it(Jr.h,e.et)),Sh(r,t),e=new Mi(e.target,t,1,e.sequenceNumber),Nh(r,e))}),r.oo.mo(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Wr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,Lh(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function Lh(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!fa(r))throw r;return n.ho.add(1),[4,Ih(n)];case 1:return t.sent(),n.fo.set("Offline"),i=i||function(){return rh(n.io)},n.ke.os(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Wr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.ho.delete(1),[4,Eh(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function _h(e,n){return n().catch(function(t){return Lh(e,t,n)})}function Vh(a){return y(this,void 0,void 0,function(){var i,o,s,u;return v(this,function(t){switch(t.label){case 0:o=xh(i=a),s=0<i.uo.length?i.uo[i.uo.length-1].batchId:-1,t.label=1;case 1:if(!(kh(i)&&i.uo.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.io,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.Zs.cr(t,n)}))];case 3:return null===(u=t.sent())?(0===i.uo.length&&o.Pr(),[3,7]):(s=u.batchId,function(t,e){t.uo.push(e);t=xh(t);t.Ir()&&t.Lr&&t.qr(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,Lh(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Ch(i)&&Uh(i),[2]}var e,n,r})})}function Ch(t){return kh(t)&&!xh(t).Tr()&&0<t.uo.length}function Uh(t){xh(t).start()}function jh(n){var t,e,r,i=this;return n.Io||(n.Io=(t=n.ro,e=n.ke,r={Fr:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.co.forEach(function(t,e){Nh(n,t)}),[2]})})}.bind(null,n),vr:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return Dh(e),Ph(e)?(e.fo.eo(n),Oh(e)):e.fo.set("Unknown"),[2]})})}.bind(null,n),$r:Rh.bind(null,n)},t.Wr(),new fh(e,t.dr,t.credentials,t.serializer,r)),n.ao.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Io.Rr(),Ph(n)?Oh(n):n.fo.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.Io.stop()];case 2:t.sent(),Dh(n),t.label=3;case 3:return[2]}})})})),n.Io}function xh(n){var t,e,r,i=this;return n.Ao||(n.Ao=(t=n.ro,e=n.ke,r={Fr:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return xh(e).jr(),[2]})})}.bind(null,n),vr:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&xh(e).Lr?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Fi(n=i.code)&&n!==jr.ABORTED?(e=r.uo.shift(),xh(r).Rr(),[4,_h(r,function(){return r.oo.To(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,Vh(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Ch(e)&&Uh(e),[2]}})})}.bind(null,n),Br:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=xh(o),n=0,r=o.uo;n<r.length;n++)i=r[n],e.qr(i.mutations);return[2]})})}.bind(null,n),Ur:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.uo.shift(),n=Va.from(e,i,o),[4,_h(r,function(){return r.oo.Eo(n)})];case 1:return t.sent(),[4,Vh(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Wr(),new ph(e,t.dr,t.credentials,t.serializer,r)),n.ao.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Ao.Rr(),[4,Vh(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.Ao.stop()];case 3:t.sent(),0<n.uo.length&&(Wr("RemoteStore","Stopping write stream with "+n.uo.length+" pending writes"),n.uo=[]),t.label=4;case 4:return[2]}})})})),n.Ao}var Mh=(tc.prototype.P=function(){return this.Ro.P()},tc.prototype.po=function(t,e){e=new qh(t,e);this.Ro=this.Ro.add(e),this.yo=this.yo.add(e)},tc.prototype.vo=function(t,e){var n=this;t.forEach(function(t){return n.po(t,e)})},tc.prototype.bo=function(t,e){this.Co(new qh(t,e))},tc.prototype.So=function(t,e){var n=this;t.forEach(function(t){return n.bo(t,e)})},tc.prototype.Do=function(t){var e=this,n=new Ii(new wi([])),r=new qh(n,t),t=new qh(n,t+1),i=[];return this.yo.Nt([r,t],function(t){e.Co(t),i.push(t.key)}),i},tc.prototype.Fo=function(){var e=this;this.Ro.forEach(function(t){return e.Co(t)})},tc.prototype.Co=function(t){this.Ro=this.Ro.delete(t),this.yo=this.yo.delete(t)},tc.prototype.No=function(t){var e=new Ii(new wi([])),n=new qh(e,t),t=new qh(e,t+1),r=io();return this.yo.Nt([n,t],function(t){r=r.add(t.key)}),r},tc.prototype.xo=function(t){var e=new qh(t,0),e=this.Ro.$t(e);return null!==e&&t.isEqual(e.key)},tc),qh=(Jh.Po=function(t,e){return Ii.S(t.key,e.key)||Zr(t.$o,e.$o)},Jh.Vo=function(t,e){return Zr(t.$o,e.$o)||Ii.S(t.key,e.key)},Jh),Fh=($h.prototype.Oo=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},$h.prototype.ko=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},$h.prototype.Mo=function(){var t={activeTargetIds:this.activeTargetIds.L(),updateTimeMs:Date.now()};return JSON.stringify(t)},$h),Bh=(Zh.prototype.Uo=function(t){},Zh.prototype.Bo=function(t,e,n){},Zh.prototype.jo=function(t){return this.Lo.Oo(t),this.qo[t]||"not-current"},Zh.prototype.Qo=function(t,e,n){this.qo[t]=e},Zh.prototype.Wo=function(t){this.Lo.ko(t)},Zh.prototype.Ko=function(t){return this.Lo.activeTargetIds.has(t)},Zh.prototype.Go=function(t){delete this.qo[t]},Zh.prototype.zo=function(){return this.Lo.activeTargetIds},Zh.prototype.Ho=function(t){return this.Lo.activeTargetIds.has(t)},Zh.prototype.start=function(){return this.Lo=new Fh,Promise.resolve()},Zh.prototype.Yo=function(t,e,n){},Zh.prototype.Jo=function(t){},Zh.prototype.Xo=function(){},Zh.prototype.Pi=function(t){},Zh),Wh=function(t){this.key=t},Gh=function(t){this.key=t},zh=(Object.defineProperty(Yh.prototype,"iu",{get:function(){return this.Zo},enumerable:!1,configurable:!0}),Yh.prototype.ru=function(t,e){var s=this,u=e?e.ou:new uo,a=(e||this).su,h=(e||this).Qt,c=a,l=!1,f=vu(this.query)&&a.size===this.query.limit?a.last():null,p=gu(this.query)&&a.size===this.query.limit?a.first():null;if(t.at(function(t,e){var n=a.get(t),r=(r=e instanceof au?e:null)&&(ku(s.query,r)?r:null),i=!!n&&s.Qt.has(n.key),o=!!r&&(r.Xn||s.Qt.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.uu(n,r)||(u.track({type:2,doc:r}),e=!0,(f&&0<s.eu(r,f)||p&&s.eu(r,p)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(h=r?(c=c.add(r),o?h.add(t):h.delete(t)):(c=c.delete(t),h.delete(t)))}),vu(this.query)||gu(this.query))for(;c.size>this.query.limit;){var n=vu(this.query)?c.last():c.first(),c=c.delete(n.key),h=h.delete(n.key);u.track({type:1,doc:n})}return{su:c,ou:u,cu:l,Qt:h}},Yh.prototype.uu=function(t,e){return t.Xn&&e.hasCommittedMutations&&!e.Xn},Yh.prototype.hu=function(t,e,n){var o=this,r=this.su;this.su=t.su,this.Qt=t.Qt;var i=t.ou.Bt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.eu(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Qr()}}var r,i}),this.au(n);var s=e?this.lu():[],n=0===this.nu.size&&this.tn?1:0,e=n!==this.tu;return this.tu=n,0!==i.length||e?{snapshot:new ao(this.query,t.su,r,i,t.Qt,0==n,e,!1),_u:s}:{_u:s}},Yh.prototype.As=function(t){return this.tn&&"Offline"===t?(this.tn=!1,this.hu({su:this.su,ou:new uo,Qt:this.Qt,cu:!1},!1)):{_u:[]}},Yh.prototype.fu=function(t){return!this.Zo.has(t)&&!!this.su.has(t)&&!this.su.get(t).Xn},Yh.prototype.au=function(t){var e=this;t&&(t.nn.forEach(function(t){return e.Zo=e.Zo.add(t)}),t.en.forEach(function(t){}),t.sn.forEach(function(t){return e.Zo=e.Zo.delete(t)}),this.tn=t.tn)},Yh.prototype.lu=function(){var e=this;if(!this.tn)return[];var n=this.nu;this.nu=io(),this.su.forEach(function(t){e.fu(t.key)&&(e.nu=e.nu.add(t.key))});var r=[];return n.forEach(function(t){e.nu.has(t)||r.push(new Gh(t))}),this.nu.forEach(function(t){n.has(t)||r.push(new Wh(t))}),r},Yh.prototype.du=function(t){this.Zo=t.lr,this.nu=io();t=this.ru(t.documents);return this.hu(t,!0)},Yh.prototype.wu=function(){return ao.Gt(this.query,this.su,this.Qt,0===this.tu)},Yh),Hh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Qh=function(t){this.key=t,this.mu=!1},Xh=(Object.defineProperty(Kh.prototype,"Fu",{get:function(){return!0===this.Du},enumerable:!1,configurable:!0}),Kh);function Kh(t,e,n,r,i,o){this.io=t,this.Eu=e,this.Tu=n,this.Iu=r,this.currentUser=i,this.Au=o,this.Ru={},this.Pu=new vi(Ou,Su),this.yu=new Map,this.Vu=[],this.gu=new Wi(Ii.S),this.pu=new Map,this.vu=new Mh,this.bu={},this.Cu=new Map,this.Su=Ka.bi(),this.onlineState="Unknown",this.Du=void 0}function Yh(t,e){this.query=t,this.Zo=e,this.tu=null,this.tn=!1,this.nu=io(),this.Qt=io(),this.eu=Du(t),this.su=new so(this.eu)}function Zh(){this.Lo=new Fh,this.qo={},this.zr=null,this.Ii=null}function $h(){this.activeTargetIds=oo}function Jh(t,e){this.key=t,this.$o=e}function tc(){this.Ro=new Yi(qh.Po),this.yo=new Yi(qh.Vo)}function ec(h,c){return y(this,void 0,void 0,function(){var n,o,s,u,a;return v(this,function(t){switch(t.label){case 0:return(e=h).Eu.oo.mo=rc.bind(null,e),e.Eu.oo.Bn=function(t,e){var n=t,t=n.pu.get(e);if(t&&t.mu)return io().add(t.key);var r=io(),e=n.yu.get(e);if(!e)return r;for(var i=0,o=e;i<o.length;i++){var s=o[i],s=n.Pu.get(s);r=r.Ot(s.view.iu)}return r}.bind(null,e),e.Eu.oo.wo=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Iu.Qo(s,"rejected",u),i=e.pu.get(s),(n=i&&i.key)?(r=(r=new Wi(Ii.S)).ot(n,new hu(n,mi.min())),i=io().add(n),i=new ho(mi.min(),new Map,new Yi(Zr),r,i),[4,rc(e,i)]):[3,2];case 1:return t.sent(),e.gu=e.gu.remove(n),e.pu.delete(s),lc(e),[3,4];case 2:return[4,oh(e.io,s,!1).then(function(){return ac(e,s,u)}).catch(uh)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.Ru.$r=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.Es.get(u);if(u){for(var a=0,h=u.listeners;a<h.length;a++)h[a].Rs(s)&&(r=!0);u.ws=s}}r&&Aa(n)}.bind(null,e.Tu),e.Ru.Nu=function(t,e,n){var r=t;if(t=r.Es.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.Es.delete(e)}.bind(null,e.Tu),(a=(n=e).Pu.get(c))?(o=a.targetId,n.Iu.jo(o),s=a.view.wu(),[3,4]):[3,1];case 1:return[4,(e=n.io,r=Iu(c),(i=e).persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Oi.hr(e,r).next(function(t){return t?(n=t,ha.resolve(n)):i.Oi.xu(e).next(function(t){return n=new Mi(r,t,0,e.nr),i.Oi.$u(e,n).next(function(){return n})})})}).then(function(t){var e=i.Si.get(t.targetId);return(null===e||0<t.et.u(e.et))&&(i.Si=i.Si.ot(t.targetId,t),i.Di.set(r,t.targetId)),t}))];case 2:return u=t.sent(),a=n.Iu.jo(u.targetId),o=u.targetId,[4,function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Ou=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.ru(o)).cu?[4,sh(r.io,i.query,!1).then(function(t){t=t.documents;return i.view.ru(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.zt.get(i.targetId),n=i.view.hu(e,r.Fu,n),[2,(cc(r,i.targetId,n._u),n.snapshot)]}})})}(i,t,e,n)},[4,sh(i.io,o,!0)];case 1:return n=t.sent(),r=new zh(o,n.lr),e=r.ru(n.documents),n=co.Zt(s,u&&"Offline"!==i.onlineState),n=r.hu(e,i.Fu,n),cc(i,s,n._u),r=new Hh(o,s,r),i.Pu.set(o,r),i.yu.has(s)?i.yu.get(s).push(o):i.yu.set(s,[o]),[2,n.snapshot]}})})}(n,c,o,"current"===a)];case 3:s=t.sent(),n.Fu&&Ah(n.Eu,u),t.label=4;case 4:return[2,s]}var r,i,e})})}function nc(f,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:(o=f).Eu.oo.Eo=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,nh(e.io,o)];case 2:return r=t.sent(),uc(e,n,null),sc(e,n),e.Iu.Bo(n,"acknowledged"),[4,fc(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,uh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,o),o.Eu.oo.To=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.io,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Zs.Lu(e,r).next(function(t){return Xr(null!==t),n=t.keys(),i.Zs.Yi(e,t)}).next(function(){return i.Zs.Ji(e)}).next(function(){return i.Mi.oi(e,n)})}))];case 2:return o=t.sent(),uc(n,u,a),sc(n,u),n.Iu.Bo(u,"rejected",a),[4,fc(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,uh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.io,a=p,c=r,l=gi.now(),i=a.reduce(function(t,e){return t.add(e.key)},io()),c.persistence.runTransaction("Locally write mutations","readwrite",function(u){return c.Mi.oi(u,i).next(function(t){h=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=h.get(i.key),s instanceof Hs?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof au?t.field(i.field):void 0,o=cs(i.transform,o||null);null!=o&&(e=(null==e?new tu:e).set(i.field,o))}return e?e.Zn():null}(o):null);null!=o&&e.push(new Fs(i.key,o,function s(t){var u=[];return fi(t.fields||{},function(t,e){var n=new Ei([t]);if(Wo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Ps(u)}(o.proto.mapValue),Rs.exists(!0)))}return c.Zs.ku(u,l,e,a)})}).then(function(t){var e=t.Hs(h);return{batchId:t.batchId,Mu:e}}))];case 2:return s=t.sent(),u.Iu.Uo(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.bu[e.currentUser.Ds()])||new Wi(Zr)).ot(n,o),e.bu[e.currentUser.Ds()]=r,[4,fc(u,s.Mu)];case 3:return t.sent(),[4,Vh(u.Eu)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=ma(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,h,c,l,i,o})})}function rc(r,i){return y(this,void 0,void 0,function(){var n,e;return v(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,ih(n.io,i)];case 2:return e=t.sent(),i.zt.forEach(function(t,e){e=n.pu.get(e);e&&(Xr(t.nn.size+t.en.size+t.sn.size<=1),0<t.nn.size?e.mu=!0:0<t.en.size?Xr(e.mu):0<t.sn.size&&(Xr(e.mu),e.mu=!1))}),[4,fc(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,uh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function ic(t,n,e){var r,t=t;(t.Fu&&0===e||!t.Fu&&1===e)&&(r=[],t.Pu.forEach(function(t,e){e=e.view.As(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.Es.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].As(i)&&(o=!0)}),o&&Aa(t)}(t.Tu,n),r.length&&t.Ru.$r(r),t.onlineState=n,t.Fu&&t.Iu.Jo(n))}function oc(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:kh((n=o).Eu)||Wr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.io).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Zs.qu(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Cu.get(r)||[]).push(s),n.Cu.set(r,i),[3,4]);case 3:return i=t.sent(),i=ma(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function sc(t,e){(t.Cu.get(e)||[]).forEach(function(t){t.resolve()}),t.Cu.delete(e)}function uc(t,e,n){var r=t,i=r.bu[r.currentUser.Ds()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.bu[r.currentUser.Ds()]=i)}function ac(e,t,n){void 0===n&&(n=null),e.Iu.Wo(t);for(var r=0,i=e.yu.get(t);r<i.length;r++){var o=i[r];e.Pu.delete(o),n&&e.Ru.Nu(o,n)}e.yu.delete(t),e.Fu&&e.vu.Do(t).forEach(function(t){e.vu.xo(t)||hc(e,t)})}function hc(t,e){var n=t.gu.get(e);null!==n&&(Th(t.Eu,n),t.gu=t.gu.remove(e),t.pu.delete(n),lc(t))}function cc(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Wh?(t.vu.po(o.key,e),function(t,e){e=e.key;t.gu.get(e)||(Wr("SyncEngine","New document in limbo: "+e),t.Vu.push(e),lc(t))}(t,o)):o instanceof Gh?(Wr("SyncEngine","Document no longer in limbo: "+o.key),t.vu.bo(o.key,e),t.vu.xo(o.key)||hc(t,o.key)):Qr()}}function lc(t){for(;0<t.Vu.length&&t.gu.size<t.Au;){var e=t.Vu.shift(),n=t.Su.next();t.pu.set(n,new Qh(e)),t.gu=t.gu.ot(e,n),Ah(t.Eu,new Mi(Iu(yu(e.path)),n,2,ja.yi))}}function fc(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Pu.P()?[3,3]:(n.Pu.forEach(function(t,e){o.push(n.Ou(e,s,u).then(function(t){t&&(n.Fu&&n.Iu.Qo(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=Ua.Ti(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.Ru.$r(r),[4,function(a,h){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return ha.forEach(h,function(e){return ha.forEach(e.mi,function(t){return r.persistence.rr.po(n,e.targetId,t)}).next(function(){return ha.forEach(e.Ei,function(t){return r.persistence.rr.bo(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!fa(e=t.sent()))throw e;return Wr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=h;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.Si.get(o),u=s.et,u=s.rt(u),r.Si=r.Si.ot(o,u));return[2]}})})}(n.io,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function pc(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Wr("SyncEngine","User change. New user:",o.Ds()),[4,eh(n.io,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Cu.forEach(function(t){t.forEach(function(t){t.reject(new xr(jr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Cu.clear(),n.Iu.Yo(o,r.Wi,r.Ki),[4,fc(n,r.Qi)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}var dc,yc,vc,gc=(Gc.prototype.qi=function(t){this.Uu=t},Gc.prototype.hi=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.oe.length||1===r.oe.length&&r.oe[0].field.W())||i.isEqual(mi.min())?this.Bu(e,r):this.Uu.oi(e,o).next(function(t){var n=s.ju(r,t);return(vu(r)||gu(r))&&s.cu(r.ue,n,o,i)?s.Bu(e,r):(Br()<=u.DEBUG&&Wr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Pu(r)),s.Uu.hi(e,r,i).next(function(e){return n.forEach(function(t){e=e.ot(t.key,t)}),e}))})},Gc.prototype.ju=function(n,t){var r=new Yi(Du(n));return t.forEach(function(t,e){e instanceof au&&ku(n,e)&&(r=r.add(e))}),r},Gc.prototype.cu=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.u(r))},Gc.prototype.Bu=function(t,e){return Br()<=u.DEBUG&&Wr("IndexFreeQueryEngine","Using full collection scan to execute query:",Pu(e)),this.Uu.hi(t,e,mi.min())},Gc),mc=(Wc.prototype.Ku=function(t){return ha.resolve(0===this.Zs.length)},Wc.prototype.ku=function(t,e,n,r){var i=this.Qu;this.Qu++,0<this.Zs.length&&this.Zs[this.Zs.length-1];n=new _a(i,e,n,r);this.Zs.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Wu=this.Wu.add(new qh(u.key,i)),this.ti.gi(t,u.key.path.N())}return ha.resolve(n)},Wc.prototype.Lu=function(t,e){return ha.resolve(this.Gu(e))},Wc.prototype.cr=function(t,e){e+=1,e=this.zu(e),e=e<0?0:e;return ha.resolve(this.Zs.length>e?this.Zs[e]:null)},Wc.prototype.qu=function(){return ha.resolve(0===this.Zs.length?-1:this.Qu-1)},Wc.prototype.ji=function(t){return ha.resolve(this.Zs.slice())},Wc.prototype.ei=function(t,e){var n=this,r=new qh(e,0),e=new qh(e,Number.POSITIVE_INFINITY),i=[];return this.Wu.Nt([r,e],function(t){t=n.Gu(t.$o);i.push(t)}),ha.resolve(i)},Wc.prototype.ci=function(t,e){var n=this,r=new Yi(Zr);return e.forEach(function(t){var e=new qh(t,0),t=new qh(t,Number.POSITIVE_INFINITY);n.Wu.Nt([e,t],function(t){r=r.add(t.$o)})}),ha.resolve(this.Hu(r))},Wc.prototype.di=function(t,e){var n=e.path,r=n.length+1,e=n;Ii.X(e)||(e=e.child(""));var e=new qh(new Ii(e),0),i=new Yi(Zr);return this.Wu.xt(function(t){var e=t.key.path;return!!n.k(e)&&(e.length===r&&(i=i.add(t.$o)),!0)},e),ha.resolve(this.Hu(i))},Wc.prototype.Hu=function(t){var e=this,n=[];return t.forEach(function(t){t=e.Gu(t);null!==t&&n.push(t)}),n},Wc.prototype.Yi=function(n,r){var i=this;Xr(0===this.Yu(r.batchId,"removed")),this.Zs.shift();var o=this.Wu;return ha.forEach(r.mutations,function(t){var e=new qh(t.key,r.batchId);return o=o.delete(e),i.rr.Ju(n,t.key)}).next(function(){i.Wu=o})},Wc.prototype.Xu=function(t){},Wc.prototype.xo=function(t,e){var n=new qh(e,0),n=this.Wu.$t(n);return ha.resolve(e.isEqual(n&&n.key))},Wc.prototype.Ji=function(t){return this.Zs.length,ha.resolve()},Wc.prototype.Yu=function(t,e){return this.zu(t)},Wc.prototype.zu=function(t){return 0===this.Zs.length?0:t-this.Zs[0].batchId},Wc.prototype.Gu=function(t){t=this.zu(t);return t<0||t>=this.Zs.length?null:this.Zs[t]},Wc),wc=(Bc.prototype.Hi=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.Zu(e);return this.docs=this.docs.ot(r,{tc:e,size:i,readTime:n}),this.size+=i-o,this.ti.gi(t,r.path.N())},Bc.prototype.sr=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Bc.prototype.ii=function(t,e){e=this.docs.get(e);return ha.resolve(e?e.tc:null)},Bc.prototype.getEntries=function(t,e){var n=this,r=$i;return e.forEach(function(t){var e=n.docs.get(t);r=r.ot(t,e?e.tc:null)}),ha.resolve(r)},Bc.prototype.hi=function(t,e,n){for(var r=eo,i=new Ii(e.path.child("")),o=this.docs.ft(i);o.At();){var s=o.It(),u=s.key,a=s.value,s=a.tc,a=a.readTime;if(!e.path.k(u.path))break;a.u(n)<=0||s instanceof au&&ku(e,s)&&(r=r.ot(s.key,s))}return ha.resolve(r)},Bc.prototype.nc=function(t,e){return ha.forEach(this.docs,function(t){return e(t)})},Bc.prototype.Gi=function(t){return new bc(this)},Bc.prototype.ec=function(t){return ha.resolve(this.size)},Bc),bc=(Object.defineProperty(Fc.prototype,"readTime",{get:function(){return this.ic},set:function(t){this.ic=t},enumerable:!1,configurable:!0}),Fc.prototype.Hi=function(t,e){this.rc(),this.readTime=e,this.Mu.set(t.key,t)},Fc.prototype.sr=function(t,e){this.rc(),e&&(this.readTime=e),this.Mu.set(t,null)},Fc.prototype.ii=function(t,e){this.rc();var n=this.Mu.get(e);return void 0!==n?ha.resolve(n):this.oc(t,e)},Fc.prototype.getEntries=function(t,e){return this.uc(t,e)},Fc.prototype.apply=function(t){return this.rc(),this.sc=!0,this.hu(t)},Fc.prototype.rc=function(){},n(qc,vc=Fc),qc.prototype.hu=function(n){var r=this,i=[];return this.Mu.forEach(function(t,e){e?i.push(r.cc.Hi(n,e,r.readTime)):r.cc.sr(t)}),ha.$e(i)},qc.prototype.oc=function(t,e){return this.cc.ii(t,e)},qc.prototype.uc=function(t,e){return this.cc.getEntries(t,e)},qc),Ec=(Mc.prototype.Fn=function(t,n){return this.hc.forEach(function(t,e){return n(e)}),ha.resolve()},Mc.prototype.Xi=function(t){return ha.resolve(this.lastRemoteSnapshotVersion)},Mc.prototype.fc=function(t){return ha.resolve(this.ac)},Mc.prototype.xu=function(t){return this.highestTargetId=this._c.next(),ha.resolve(this.highestTargetId)},Mc.prototype.ur=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ac&&(this.ac=e),ha.resolve()},Mc.prototype.dc=function(t){this.hc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this._c=new Ka(e),this.highestTargetId=e),t.sequenceNumber>this.ac&&(this.ac=t.sequenceNumber)},Mc.prototype.$u=function(t,e){return this.dc(e),this.targetCount+=1,ha.resolve()},Mc.prototype.er=function(t,e){return this.dc(e),ha.resolve()},Mc.prototype.wc=function(t,e){return this.hc.delete(e.target),this.lc.Do(e.targetId),--this.targetCount,ha.resolve()},Mc.prototype.mc=function(n,r,i){var o=this,s=0,u=[];return this.hc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.hc.delete(t),u.push(o.Ec(n,e.targetId)),s++)}),ha.$e(u).next(function(){return s})},Mc.prototype.Tc=function(t){return ha.resolve(this.targetCount)},Mc.prototype.hr=function(t,e){e=this.hc.get(e)||null;return ha.resolve(e)},Mc.prototype.tr=function(t,e,n){return this.lc.vo(e,n),ha.resolve()},Mc.prototype.Zi=function(e,t,n){this.lc.So(t,n);var r=this.persistence.rr,i=[];return r&&t.forEach(function(t){i.push(r.Ju(e,t))}),ha.$e(i)},Mc.prototype.Ec=function(t,e){return this.lc.Do(e),ha.resolve()},Mc.prototype.ar=function(t,e){e=this.lc.No(e);return ha.resolve(e)},Mc.prototype.xo=function(t,e){return ha.resolve(this.lc.xo(e))},Mc),Ic=(xc.prototype.start=function(){return Promise.resolve()},xc.prototype.Xo=function(){return this.Rc=!1,Promise.resolve()},Object.defineProperty(xc.prototype,"yc",{get:function(){return this.Rc},enumerable:!1,configurable:!0}),xc.prototype.Vc=function(){},xc.prototype.gc=function(){},xc.prototype.Li=function(){return this.ti},xc.prototype.Ni=function(t){var e=this.Ic[t.Ds()];return e||(e=new mc(this.ti,this.rr),this.Ic[t.Ds()]=e),e},xc.prototype.ki=function(){return this.Oi},xc.prototype.$i=function(){return this.Xs},xc.prototype.runTransaction=function(t,e,n){var r=this;Wr("MemoryPersistence","Starting transaction:",t);var i=new Ac(this.Ac.next());return this.rr.vc(),n(i).next(function(t){return r.rr.bc(i).next(function(){return t})}).Ne().then(function(t){return i.Cc(),t})},xc.prototype.Sc=function(e,n){return ha.Oe(Object.values(this.Ic).map(function(t){return function(){return t.xo(e,n)}}))},xc),Ac=(jc.prototype.Fc=function(t){this.Dc.push(t)},jc.prototype.Cc=function(){this.Dc.forEach(function(t){return t()})},n(Uc,yc=jc),Uc),Tc=(Cc.$c=function(t){return new Cc(t)},Object.defineProperty(Cc.prototype,"Oc",{get:function(){if(this.xc)return this.xc;throw Qr()},enumerable:!1,configurable:!0}),Cc.prototype.po=function(t,e,n){return this.Nc.po(n,e),this.Oc.delete(n.toString()),ha.resolve()},Cc.prototype.bo=function(t,e,n){return this.Nc.bo(n,e),this.Oc.add(n.toString()),ha.resolve()},Cc.prototype.Ju=function(t,e){return this.Oc.add(e.toString()),ha.resolve()},Cc.prototype.removeTarget=function(t,e){var n=this;this.Nc.Do(e.targetId).forEach(function(t){return n.Oc.add(t.toString())});var r=this.persistence.ki();return r.ar(t,e.targetId).next(function(t){t.forEach(function(t){return n.Oc.add(t.toString())})}).next(function(){return r.wc(t,e)})},Cc.prototype.vc=function(){this.xc=new Set},Cc.prototype.bc=function(n){var r=this,i=this.persistence.$i().Gi();return ha.forEach(this.Oc,function(t){var e=Ii.H(t);return r.kc(n,e).next(function(t){t||i.sr(e)})}).next(function(){return r.xc=null,i.apply(n)})},Cc.prototype.ir=function(t,e){var n=this;return this.kc(t,e).next(function(t){t?n.Oc.delete(e.toString()):n.Oc.add(e.toString())})},Cc.prototype.Pc=function(t){return 0},Cc.prototype.kc=function(t,e){var n=this;return ha.Oe([function(){return ha.resolve(n.Nc.xo(e))},function(){return n.persistence.ki().xo(t,e)},function(){return n.persistence.Sc(t,e)}])},Cc),Nc=(Vc.prototype.Fr=function(t){this.qc=t},Vc.prototype.vr=function(t){this.Uc=t},Vc.prototype.onMessage=function(t){this.Bc=t},Vc.prototype.close=function(){this.Lc()},Vc.prototype.send=function(t){this.Mc(t)},Vc.prototype.jc=function(){this.qc()},Vc.prototype.Qc=function(t){this.Uc(t)},Vc.prototype.Wc=function(t){this.Bc(t)},Vc),Sc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Oc=(_c.prototype.Kr=function(e,t,n,r){var i=this.Hc(e,t);Wr("RestConnection","Sending: ",i,n);t={};return this.Yc(t,r),this.Jc(e,i,t,n).then(function(t){return Wr("RestConnection","Received: ",t),t},function(t){throw zr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},_c.prototype.Gr=function(t,e,n,r){return this.Kr(t,e,n,r)},_c.prototype.Yc=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.0.2-20201010222127",t["Content-Type"]="text/plain",e)for(var n in e.xs)e.xs.hasOwnProperty(n)&&(t[n]=e.xs[n])},_c.prototype.Hc=function(t,e){t=Sc[t];return this.Gc+"/v1/"+e+":"+t},n(Lc,dc=_c),Lc.prototype.Jc=function(o,e,s,u){return new Promise(function(n,r){var i=new br;i.listenOnce(mr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case gr.NO_ERROR:var t=i.getResponseJson();Wr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case gr.TIMEOUT:Wr("Connection",'RPC "'+o+'" timed out'),r(new xr(jr.DEADLINE_EXCEEDED,"Request time out"));break;case gr.HTTP_ERROR:var e=i.getStatus();Wr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(jr).indexOf(e)?e:jr.UNKNOWN,r(new xr(e,t.message))):r(new xr(jr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new xr(jr.UNAVAILABLE,"Connection failed."));break;default:Qr()}}finally{Wr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},Lc.prototype.Nr=function(t,e){var n,r=[this.Gc,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new fr,t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this._.projectId+"/databases/"+this._.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.m};this.Yc(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(d())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=d().indexOf("Electron/")||(0<=(n=d()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=d().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");Wr("Connection","Creating WebChannel: "+r,t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new Nc({Mc:function(t){u?Wr("Connection","Not sending because WebChannel is closed:",t):(s||(Wr("Connection","Opening WebChannel transport."),o.open(),s=!0),Wr("Connection","WebChannel sending:",t),o.send(t))},Lc:function(){return o.close()}}),t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(wr.EventType.OPEN,function(){u||Wr("Connection","WebChannel transport opened.")}),t(wr.EventType.CLOSE,function(){u||(u=!0,Wr("Connection","WebChannel transport closed"),a.Qc())}),t(wr.EventType.ERROR,function(t){u||(u=!0,zr("Connection","WebChannel transport errored:",t),a.Qc(new xr(jr.UNAVAILABLE,"The operation could not be completed")))}),t(wr.EventType.MESSAGE,function(t){var e,n,r,i;u||(Xr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Wr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=xi[r];if(void 0!==t)return Bi(t)}(),i=n.message,void 0===t&&(t=jr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.Qc(new xr(t,i)),o.close()):(Wr("Connection","WebChannel received:",e),a.Wc(e)))}),setTimeout(function(){a.jc()},0),a},Lc),Pc=(Rc.prototype._o=function(t){this.eh.push(t)},Rc.prototype.Xo=function(){window.removeEventListener("online",this.Xc),window.removeEventListener("offline",this.th)},Rc.prototype.sh=function(){window.addEventListener("online",this.Xc),window.addEventListener("offline",this.th)},Rc.prototype.Zc=function(){Wr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.eh;t<e.length;t++)(0,e[t])(0)},Rc.prototype.nh=function(){Wr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.eh;t<e.length;t++)(0,e[t])(1)},Rc.ih=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Rc),kc=(Dc.prototype._o=function(t){},Dc.prototype.Xo=function(){},Dc);function Dc(){}function Rc(){var t=this;this.Xc=function(){return t.Zc()},this.th=function(){return t.nh()},this.eh=[],this.sh()}function Lc(t){var e=this;return(e=dc.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.m=t.m,e}function _c(t){this.Kc=t,this._=t._;var e=t.ssl?"https":"http";this.Gc=e+"://"+t.host,this.zc="projects/"+this._.projectId+"/databases/"+this._.database+"/documents"}function Vc(t){this.Mc=t.Mc,this.Lc=t.Lc}function Cc(t){this.persistence=t,this.Nc=new Mh,this.xc=null}function Uc(t){var e=this;return(e=yc.call(this)||this).nr=t,e}function jc(){this.Dc=[]}function xc(t){var e=this;this.Ic={},this.Ac=new ja(0),this.Rc=!1,this.Rc=!0,this.rr=t(this),this.Oi=new Ec(this),this.ti=new Qa,this.Xs=(t=this.ti,new wc(t,function(t){return e.rr.Pc(t)}))}function Mc(t){this.persistence=t,this.hc=new vi(Vi,Ci),this.lastRemoteSnapshotVersion=mi.min(),this.highestTargetId=0,this.ac=0,this.lc=new Mh,this.targetCount=0,this._c=Ka.vi()}function qc(t){var e=this;return(e=vc.call(this)||this).cc=t,e}function Fc(){this.Mu=new vi(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.sc=!1}function Bc(t,e){this.ti=t,this.Zu=e,this.docs=new Wi(Ii.S),this.size=0}function Wc(t,e){this.ti=t,this.rr=e,this.Zs=[],this.Qu=1,this.Wu=new Yi(qh.Po)}function Gc(){}function zc(t){return new Ho(t,!0)}var Hc=($c.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Iu=this.rh(e),this.persistence=this.oh(e),[4,this.persistence.start()];case 1:return t.sent(),this.uh=this.hh(e),this.io=this.ah(e),[2]}})})},$c.prototype.hh=function(t){return null},$c.prototype.ah=function(t){return e=this.persistence,n=new gc,t=t.lh,new Ya(e,n,t);var e,n},$c.prototype.oh=function(t){return new Ic(Tc.$c)},$c.prototype.rh=function(t){return new Bh},$c.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.uh&&this.uh.stop(),[4,this.Iu.Xo()];case 1:return t.sent(),[4,this.persistence.Xo()];case 2:return t.sent(),[2]}})})},$c),Qc=(Zc.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.io?[3,2]:(this.io=n.io,this.Iu=n.Iu,this.ro=this._h(r),this.Eu=this.fh(r),this.Tu=this.dh(r),this.wh=this.mh(r,!n.synchronizeTabs),this.Iu.zr=function(t){return ic(e.wh,t,1)},this.Eu.oo.Eh=pc.bind(null,this.wh),[4,function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.ho.delete(2),[4,Eh(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.ho.add(2),[4,Ih(e)]);case 3:t.sent(),e.fo.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.Eu,this.wh.Fu)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Zc.prototype.dh=function(t){return new wa},Zc.prototype._h=function(t){var e=zc(t.Kc._),n=(n=t.Kc,new Oc(n));return t=t.credentials,new dh(t,n,e)},Zc.prototype.fh=function(t){var e=this,n=this.io,r=this.ro,i=t.ke,o=function(t){return ic(e.wh,t,0)},t=new(Pc.ih()?Pc:kc);return new ah(n,r,i,o,t)},Zc.prototype.mh=function(t,e){return function(t,e,n,r,i,o,s){o=new Xh(t,e,n,r,i,o);return s&&(o.Du=!0),o}(this.io,this.Eu,this.Tu,this.Iu,t.lh,t.Au,e)},Zc.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Wr("RemoteStore","RemoteStore shutting down."),e.ho.add(5),[4,Ih(e)];case 1:return t.sent(),e.lo.Xo(),e.fo.set("Unknown"),[2]}})})}(this.Eu)},Zc),Xc=(Yc.prototype.next=function(t){this.observer.next&&this.Th(this.observer.next,t)},Yc.prototype.error=function(t){this.observer.error?this.Th(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Yc.prototype.Ih=function(){this.muted=!0},Yc.prototype.Th=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Yc),Kc=function(t){this.Ah=t};function Yc(t){this.observer=t,this.muted=!1}function Zc(){}function $c(){this.synchronizeTabs=!1}function Jc(t,e,n){if(!n)throw new xr(jr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function tl(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new xr(jr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function el(t,e,n,r){if(!0===e&&!0===r)throw new xr(jr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function nl(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Qr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function rl(t,e){if(t instanceof Kc&&(t=t.Ah),t instanceof e)return t;if(e.name===t.constructor.name)throw new xr(jr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");t=nl(t);throw new xr(jr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function il(t,e){if(e<=0)throw new xr(jr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var ol,sl=function(t){this.Rh=t},ul=(n(al,ol=sl),al.prototype.Ph=function(t){if(2!==t.yh)throw 1===t.yh?t.Vh(this.Rh+"() can only appear at the top level of your update data"):t.Vh(this.Rh+"() cannot be used with set() unless you pass {merge:true}");return t.Wn.push(t.path),null},al.prototype.isEqual=function(t){return t instanceof al},al);function al(){return null!==ol&&ol.apply(this,arguments)||this}function hl(t,e,n){return new Kl({yh:3,gh:e.settings.gh,methodName:t.Rh,ph:n},e._,e.serializer,e.ignoreUndefinedProperties)}var cl,ll,fl,pl,dl,yl=(n(Ll,dl=sl),Ll.prototype.Ph=function(t){return new Os(t.path,new ps)},Ll.prototype.isEqual=function(t){return t instanceof Ll},Ll),vl=(n(Rl,pl=sl),Rl.prototype.Ph=function(t){var e=hl(this,t,!0),n=this.bh.map(function(t){return rf(t,e)}),n=new ds(n);return new Os(t.path,n)},Rl.prototype.isEqual=function(t){return this===t},Rl),gl=(n(Dl,fl=sl),Dl.prototype.Ph=function(t){var e=hl(this,t,!0),n=this.bh.map(function(t){return rf(t,e)}),n=new ws(n);return new Os(t.path,n)},Dl.prototype.isEqual=function(t){return this===t},Dl),ml=(n(kl,ll=sl),kl.prototype.Ph=function(t){var e=new As(t.serializer,Ko(t.serializer,this.Ch));return new Os(t.path,e)},kl.prototype.isEqual=function(t){return this===t},kl),wl=(Object.defineProperty(Pl.prototype,"latitude",{get:function(){return this.Sh},enumerable:!1,configurable:!0}),Object.defineProperty(Pl.prototype,"longitude",{get:function(){return this.Dh},enumerable:!1,configurable:!0}),Pl.prototype.isEqual=function(t){return this.Sh===t.Sh&&this.Dh===t.Dh},Pl.prototype.toJSON=function(){return{latitude:this.Sh,longitude:this.Dh}},Pl.prototype.V=function(t){return Zr(this.Sh,t.Sh)||Zr(this.Dh,t.Dh)},Pl),bl=new Map,El=(Ol.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Ol),Il=(Sl.prototype.$h=function(t){switch(ko(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Uo(t.integerValue||t.doubleValue);case 3:return this.Oh(t.timestampValue);case 4:return this.kh(t);case 5:return t.stringValue;case 6:return this.xh(jo(t.bytesValue));case 7:return this.Mh(t.referenceValue);case 8:return this.Lh(t.geoPointValue);case 9:return this.qh(t.arrayValue);case 10:return this.Uh(t.mapValue);default:throw Qr()}},Sl.prototype.Uh=function(t){var n=this,r={};return fi(t.fields||{},function(t,e){r[t]=n.$h(e)}),r},Sl.prototype.Lh=function(t){return new wl(Uo(t.latitude),Uo(t.longitude))},Sl.prototype.qh=function(t){var e=this;return(t.values||[]).map(function(t){return e.$h(t)})},Sl.prototype.kh=function(t){switch(this.Fh){case"previous":var e=function t(e){e=e.mapValue.fields.__previous_value__;return So(e)?t(e):e}(t);return null==e?null:this.$h(e);case"estimate":return this.Oh(Oo(t));default:return null}},Sl.prototype.Oh=function(t){t=Co(t);return new gi(t.seconds,t.nanos)},Sl.prototype.Mh=function(t){var e=wi.U(t);Xr(hs(e));t=new ai(e.get(1),e.get(3)),e=new Ii(e.F(5));return t.isEqual(this._)||Gr("Document "+e+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+this._.projectId+"/"+this._.database+") instead."),this.Nh(e)},Sl),Te=(Object.defineProperty(Nl.prototype,"id",{get:function(){return this.jh.path.O()},enumerable:!1,configurable:!0}),Object.defineProperty(Nl.prototype,"ref",{get:function(){return new Ul(this.Bh,this.Wh,this.jh)},enumerable:!1,configurable:!0}),Nl.prototype.exists=function(){return null!==this.Qh},Nl.prototype.data=function(){var e=this;if(this.Qh){if(this.Wh){var t=new Al(this.Bh,this.jh,this.Qh,null);return this.Wh.fromFirestore(t)}return new Il(this.Bh.Kh,"none",function(t){return new Ul(e.Bh,null,t)},function(t){return new ei(t)}).$h(this.Qh.re())}},Nl.prototype.get=function(t){var e=this;if(this.Qh){t=this.Qh.data().field(_l("DocumentSnapshot.get",t));if(null!==t)return new Il(this.Bh.Kh,"none",function(t){return new Ul(e.Bh,e.Wh,t)},function(t){return new ei(t)}).$h(t)}},Nl),Al=(n(Tl,cl=Te),Tl.prototype.data=function(){return cl.prototype.data.call(this)},Tl);function Tl(){return null!==cl&&cl.apply(this,arguments)||this}function Nl(t,e,n,r){this.Bh=t,this.jh=e,this.Qh=n,this.Wh=r}function Sl(t,e,n,r){this._=t,this.Fh=e,this.Nh=n,this.xh=r}function Ol(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new xr(jr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new xr(jr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,el("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function Pl(t,e){if(!isFinite(t)||t<-90||90<t)throw new xr(jr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new xr(jr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Sh=t,this.Dh=e}function kl(t,e){var n=this;return(n=ll.call(this,t)||this).Ch=e,n}function Dl(t,e){var n=this;return(n=fl.call(this,t)||this).bh=e,n}function Rl(t,e){var n=this;return(n=pl.call(this,t)||this).bh=e,n}function Ll(){return null!==dl&&dl.apply(this,arguments)||this}function _l(t,e){return"string"==typeof e?cf(t,e):e.Gh}var Vl,Cl=(Fl.prototype.isEqual=function(t){return this.Gh.isEqual(t.Gh)},Fl),Ul=(Object.defineProperty(ql.prototype,"zh",{get:function(){return this.jh.path},enumerable:!1,configurable:!0}),Object.defineProperty(ql.prototype,"id",{get:function(){return this.jh.path.O()},enumerable:!1,configurable:!0}),Object.defineProperty(ql.prototype,"path",{get:function(){return this.jh.path.q()},enumerable:!1,configurable:!0}),Object.defineProperty(ql.prototype,"parent",{get:function(){return new jl(this.firestore,this.Wh,this.jh.path.N())},enumerable:!1,configurable:!0}),ql.prototype.withConverter=function(t){return new ql(this.firestore,t,this.jh)},ql),jl=(Ml.prototype.withConverter=function(t){return new Ml(this.firestore,t,this.Hh)},n(xl,Vl=Ml),Object.defineProperty(xl.prototype,"id",{get:function(){return this.Hh.path.O()},enumerable:!1,configurable:!0}),Object.defineProperty(xl.prototype,"path",{get:function(){return this.Hh.path.q()},enumerable:!1,configurable:!0}),Object.defineProperty(xl.prototype,"parent",{get:function(){var t=this.zh.N();return t.P()?null:new Ul(this.firestore,null,new Ii(t))},enumerable:!1,configurable:!0}),xl.prototype.withConverter=function(t){return new xl(this.firestore,t,this.zh)},xl);function xl(t,e,n){var r=this;return(r=Vl.call(this,t,e,yu(n))||this).firestore=t,r.zh=n,r.type="collection",r}function Ml(t,e,n){this.Wh=e,this.Hh=n,this.type="query",this.firestore=t}function ql(t,e,n){this.Wh=e,this.jh=n,this.type="document",this.firestore=t}function Fl(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new xr(jr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Gh=new Ei(t)}function Bl(t){var e=t.Yh(),n=zc(t.Kh);return new Yl(t.Kh,!!e.ignoreUndefinedProperties,n)}var Wl=/^__.*__$/,Gl=(Ql.prototype.Jh=function(t,e){var n=[];return null!==this.Wn?n.push(new Fs(t,this.data,this.Wn,e)):n.push(new qs(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Hs(t,this.fieldTransforms)),n},Ql),zl=(Hl.prototype.Jh=function(t,e){e=[new Fs(t,this.data,this.Wn,e)];return 0<this.fieldTransforms.length&&e.push(new Hs(t,this.fieldTransforms)),e},Hl);function Hl(t,e,n){this.data=t,this.Wn=e,this.fieldTransforms=n}function Ql(t,e,n){this.data=t,this.Wn=e,this.fieldTransforms=n}function Xl(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Qr()}}var Kl=(Object.defineProperty($l.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty($l.prototype,"yh",{get:function(){return this.settings.yh},enumerable:!1,configurable:!0}),$l.prototype.Zh=function(t){return new $l(Object.assign(Object.assign({},this.settings),t),this._,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Wn)},$l.prototype.ta=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.Zh({path:e,ph:!1});return e.na(t),e},$l.prototype.ea=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.Zh({path:t,ph:!1});return t.Xh(),t},$l.prototype.sa=function(t){return this.Zh({path:void 0,ph:!0})},$l.prototype.Vh=function(t){return lf(t,this.settings.methodName,this.settings.ia||!1,this.path,this.settings.gh)},$l.prototype.contains=function(e){return void 0!==this.Wn.find(function(t){return e.k(t)})||void 0!==this.fieldTransforms.find(function(t){return e.k(t.field)})},$l.prototype.Xh=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.na(this.path.get(t))},$l.prototype.na=function(t){if(0===t.length)throw this.Vh("Document fields must not be empty");if(Xl(this.yh)&&Wl.test(t))throw this.Vh('Document fields cannot begin and end with "__"')},$l),Yl=(Zl.prototype.ra=function(t,e,n,r){return void 0===r&&(r=!1),new Kl({yh:t,methodName:e,gh:n,path:Ei.B(),ph:!1,ia:r},this._,this.serializer,this.ignoreUndefinedProperties)},Zl);function Zl(t,e,n){this._=t,this.ignoreUndefinedProperties=e,this.serializer=n||zc(t)}function $l(t,e,n,r,i,o){this.settings=t,this._=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Xh(),this.fieldTransforms=i||[],this.Wn=o||[]}function Jl(t,e,n,r,i,o){void 0===o&&(o={});var s=t.ra(o.merge||o.mergeFields?2:0,e,n,i);uf("Data must be an object, but it was:",s,r);var u,a,r=of(r,s);if(o.merge)u=new Ps(s.Wn),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],c=0,l=o.mergeFields;c<l.length;c++){var f=af(e,l[c],n);if(!s.contains(f))throw new xr(jr.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");ff(h,f)||h.push(f)}u=new Ps(h),a=s.fieldTransforms.filter(function(t){return u.Yn(t.field)})}else u=null,a=s.fieldTransforms;return new Gl(new Js(r),u,a)}function tf(t,r,i,e){var o=t.ra(1,r,i);uf("Data must be an object, but it was:",o,e);var s=[],u=new tu;fi(e,function(t,e){var n=cf(r,t,i);e instanceof Kc&&(e=e.Ah);t=o.ea(n);e instanceof ul?s.push(n):null!=(t=rf(e,t))&&(s.push(n),u.set(n,t))});e=new Ps(s);return new zl(u.Zn(),e,o.fieldTransforms)}function ef(t,e,n,r,i,o){var s=t.ra(1,e,n),u=[af(e,r,n)],a=[i];if(o.length%2!=0)throw new xr(jr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(af(e,o[h])),a.push(o[h+1]);for(var c,l,f,p=[],d=new tu,y=u.length-1;0<=y;--y){ff(p,u[y])||(c=u[y],(l=a[y])instanceof Kc&&(l=l.Ah),f=s.ea(c),l instanceof ul?p.push(c):null!=(f=rf(l,f))&&(p.push(c),d.set(c,f)))}i=new Ps(p);return new zl(d.Zn(),i,s.fieldTransforms)}function nf(t,e,n,r){return void 0===r&&(r=!1),rf(n,t.ra(r?4:3,e))}function rf(s,t){if(s instanceof Kc&&(s=s.Ah),sf(s))return uf("Unsupported field value:",t,s),of(s,t);if(s instanceof sl)return function(t,e){if(!Xl(e.yh))throw e.Vh(t.Rh+"() can only be used with update() and set()");if(!e.path)throw e.Vh(t.Rh+"() is not currently supported inside arrays");t=t.Ph(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.Wn.push(t.path),s instanceof Array){if(t.settings.ph&&4!==t.yh)throw t.Vh("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=rf(i[r],t.sa(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof Kc&&(t=t.Ah),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Ko(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=gi.fromDate(t);return{timestampValue:Yo(e.serializer,n)}}if(t instanceof gi){var r=new gi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Yo(e.serializer,r)}}if(t instanceof wl)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof ei)return{bytesValue:Zo(e.serializer,t.l)};if(t instanceof Ul){n=e._,r=t.firestore.Kh;if(!r.isEqual(n))throw e.Vh("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Jo(t.firestore.Kh||e._,t.jh.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.Vh("Unsupported field value: "+nl(t))}(s,t)}function of(t,n){var r={};return pi(t)?n.path&&0<n.path.length&&n.Wn.push(n.path):fi(t,function(t,e){e=rf(e,n.ta(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function sf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof gi||t instanceof wl||t instanceof ei||t instanceof Ul||t instanceof sl)}function uf(t,e,n){if(!sf(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){n=nl(n);throw"an object"===n?e.Vh(t+" a custom object"):e.Vh(t+" "+n)}var r}function af(t,e,n){if(e instanceof Kc&&(e=e.Ah),e instanceof Cl)return e.Gh;if("string"==typeof e)return cf(t,e);throw lf("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var hf=new RegExp("[~\\*/\\[\\]]");function cf(e,n,r){if(0<=n.search(hf))throw lf("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(Cl.bind.apply(Cl,o([void 0],n.split("."))))).Gh}catch(t){throw lf("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function lf(t,e,n,r,i){var o=r&&!r.P(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new xr(jr.INVALID_ARGUMENT,(e+=". ")+t+n)}function ff(t,e){return t.some(function(t){return t.isEqual(e)})}var pf=(mf.prototype.aa=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.la(),0<this.mutations.length)throw new xr(jr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var n,e,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=rs((n=s).serializer)+"/documents",r={documents:u.map(function(t){return ts(n.serializer,t)})},[4,n.Gr("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.serializer,"found"in(t=t)?function(t,e){Xr(!!e.found),e.found.name,e.found.updateTime;var n=es(t,e.found.name),t=$o(e.found.updateTime),e=new Js({mapValue:{fields:e.found.fields}});return new au(n,t,e,{})}(e,t):"missing"in t?function(t,e){Xr(!!e.missing),Xr(!!e.readTime);t=es(t,e.missing),e=$o(e.readTime);return new hu(t,e)}(e,t):Qr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());Xr(!!t),o.push(t)}),o)]}})})}(this.ro,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof hu||t instanceof au?n._a(t):Qr()}),e)]}})})},mf.prototype.set=function(t,e){this.write(e.Jh(t,this.zn(t))),this.ha.add(t.toString())},mf.prototype.update=function(t,e){try{this.write(e.Jh(t,this.fa(t)))}catch(t){this.ca=t}this.ha.add(t.toString())},mf.prototype.delete=function(t){this.write([new Zs(t,this.zn(t))]),this.ha.add(t.toString())},mf.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.la(),this.ca)throw this.ca;return e=this.oa,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=Ii.H(e);n.mutations.push(new $s(e,n.zn(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=rs((e=i).serializer)+"/documents",r={writes:o.map(function(t){return os(e.serializer,t)})},[4,e.Kr("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.ro,this.mutations)];case 1:return t.sent(),this.ua=!0,[2]}})})},mf.prototype._a=function(t){var e;if(t instanceof au)e=t.version;else{if(!(t instanceof hu))throw Qr();e=mi.min()}var n=this.oa.get(t.key.toString());if(n){if(!e.isEqual(n))throw new xr(jr.ABORTED,"Document version changed between two reads.")}else this.oa.set(t.key.toString(),e)},mf.prototype.zn=function(t){var e=this.oa.get(t.toString());return!this.ha.has(t.toString())&&e?Rs.updateTime(e):Rs.Jn()},mf.prototype.fa=function(t){var e=this.oa.get(t.toString());if(this.ha.has(t.toString())||!e)return Rs.exists(!0);if(e.isEqual(mi.min()))throw new xr(jr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Rs.updateTime(e)},mf.prototype.write=function(t){this.la(),this.mutations=this.mutations.concat(t)},mf.prototype.la=function(){},mf),df=(gf.prototype.run=function(){this.wa()},gf.prototype.wa=function(){var t=this;this.Xe.Pe(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new pf(this.ro),(n=this.ma(e))&&n.then(function(t){r.ke.Qe(function(){return e.commit().then(function(){r.qe.resolve(t)}).catch(function(t){r.Ea(t)})})}).catch(function(t){r.Ea(t)}),[2]})})})},gf.prototype.ma=function(t){try{var e=this.updateFunction(t);return!Di(e)&&e.catch&&e.then?e:(this.qe.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.qe.reject(t),null}},gf.prototype.Ea=function(t){var e=this;0<this.da&&this.Ta(t)?(--this.da,this.ke.Qe(function(){return e.wa(),Promise.resolve()})):this.qe.reject(t)},gf.prototype.Ta=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!Fi(t)},gf),yf=(vf.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.qs.promise];case 1:return[2,(t.sent(),{ke:this.ke,Kc:this.Kc,clientId:this.clientId,credentials:this.credentials,lh:this.user,Au:100})]}})})},vf.prototype.Aa=function(t){var e=this;this.Ia=t,this.qs.promise.then(function(){return e.Ia(e.user)})},vf.prototype.Ra=function(){if(this.ke.ts)throw new xr(jr.FAILED_PRECONDITION,"The client has already been terminated.")},vf.prototype.terminate=function(){var t=this;this.ke.rs();var n=new ua;return this.ke.ns(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.Pa?[4,this.Pa.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.ya?[4,this.ya.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.Ms(),n.resolve(),[3,6];case 5:return e=t.sent(),e=ma(e,"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},vf);function vf(t,e,n){var r=this;this.credentials=t,this.ke=e,this.Kc=n,this.user=Na.UNAUTHENTICATED,this.clientId=Kr.t(),this.Ia=function(){},this.qs=new ua,this.credentials.ks(function(t){Wr("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.Ia(t)),r.qs.resolve()})}function gf(t,e,n,r){this.ke=t,this.ro=e,this.updateFunction=n,this.qe=r,this.da=5,this.Xe=new aa(this.ke,"transaction_retry")}function mf(t){this.ro=t,this.oa=new Map,this.mutations=[],this.ua=!1,this.ca=null,this.ha=new Set}function wf(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.ya?[3,2]:(Wr("FirestoreClient","Using default OfflineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return r.ke.hs(),Wr("FirestoreClient","Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return e=t.sent(),[4,i.initialize(e)];case 2:return t.sent(),r.Aa(function(e){return r.ke.os(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,eh(i.io,e)];case 1:return t.sent(),[2]}})})})}),i.persistence.Vc(function(){return r.terminate()}),r.ya=i,[2]}})})}(e,new Hc)]);case 1:t.sent(),t.label=2;case 2:return[2,e.ya]}})})}function bf(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.Pa?[3,2]:(Wr("FirestoreClient","Using default OnlineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.ke.hs(),[4,wf(r)];case 1:return e=t.sent(),Wr("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.Aa(function(t){return r.ke.os(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).ke.hs(),Wr("RemoteStore","RemoteStore received new credentials"),n=kh(e),e.ho.add(3),[4,Ih(e)];case 1:return t.sent(),n&&e.fo.set("Unknown"),[4,e.oo.Eh(i)];case 2:return t.sent(),e.ho.delete(3),[4,Eh(e)];case 3:return t.sent(),[2]}})})}(i.Eu,t)})}),r.Pa=i,[2]}})})}(e,new Qc)]);case 1:t.sent(),t.label=2;case 2:return[2,e.Pa]}})})}function Ef(t){return wf(t).then(function(t){return t.persistence})}function If(t){return wf(t).then(function(t){return t.io})}function Af(t){return bf(t).then(function(t){return t.Eu})}function Tf(t){return bf(t).then(function(t){return t.wh})}function Nf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,bf(r)];case 1:return e=t.sent(),[2,((n=e.Tu).Is=ec.bind(null,e.wh),n.Ps=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Pu.get(o),1<(r=e.yu.get(n.targetId)).length?[2,(e.yu.set(n.targetId,r.filter(function(t){return!Su(t,o)})),void e.Pu.delete(o))]:e.Fu?(e.Iu.Wo(n.targetId),e.Iu.Ho(n.targetId)?[3,2]:[4,oh(e.io,n.targetId,!1).then(function(){e.Iu.Go(n.targetId),Th(e.Eu,n.targetId),ac(e,n.targetId)}).catch(uh)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return ac(e,n.targetId),[4,oh(e.io,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.wh),n)]}})})}function Sf(n,r){var t=this,i=new ua;return n.ke.Qe(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=nc,[4,Tf(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}function Of(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.Mi.ni(t,e)}))];case 1:return(r=t.sent())instanceof au?s.resolve(r):r instanceof hu?s.resolve(null):s.reject(new xr(jr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),r=ma(r,"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}function Pf(n,r,i,o,s){var t=new Xc({next:function(t){r.Qe(function(){return Ia(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new xr(jr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new xr(jr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Ta(yu(i.path),t,{includeMetadataChanges:!0,Cs:!0});return Ea(n,u)}function kf(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Df,Rf=(Object.defineProperty(_f.prototype,"app",{get:function(){if(!this.ba)throw new xr(jr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.ba},enumerable:!1,configurable:!0}),Object.defineProperty(_f.prototype,"Ca",{get:function(){return this.pa},enumerable:!1,configurable:!0}),Object.defineProperty(_f.prototype,"Sa",{get:function(){return void 0!==this.Da},enumerable:!1,configurable:!0}),_f.prototype.Fa=function(t){if(this.pa)throw new xr(jr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.ga=new El(t),void 0!==t.credentials&&(this.va=function(t){if(!t)return new ka;switch(t.type){case"gapi":var e=t.client;return Xr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new La(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new xr(jr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},_f.prototype.Na=function(){return this.ga},_f.prototype.Yh=function(){return this.pa=!0,this.ga},_f.prototype._delete=function(){return this.Da||(this.Da=this.xa()),this.Da},_f.prototype.xa=function(){return t=this,(e=bl.get(t))&&(Wr("ComponentProvider","Removing Datastore"),bl.delete(t),e.terminate()),Promise.resolve();var t,e},n(Lf,Df=_f),Lf.prototype.xa=function(){return this.Oa||$f(this),this.Oa.terminate()},Lf);function Lf(t,e){var n=this;return(n=Df.call(this,t,e)||this).$a=new ya,n.Va="name"in t?t.name:"[DEFAULT]",n}function _f(t,e){this.Va="(lite)",this.ga=new El({}),this.pa=!1,t instanceof ai?(this.Kh=t,this.va=new ka):(this.ba=t,this.Kh=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new xr(jr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ai(t.options.projectId)}(t),this.va=new Da(e))}var Vf,Cf,Uf=(n(Ff,Cf=Te),Ff.prototype.exists=function(){return Cf.prototype.exists.call(this)},Ff.prototype.data=function(t){var e=this;if(this.Qh){if(this.Wh){var n=new jf(this.Bh,this.jh,this.Qh,this.metadata,null);return this.Wh.fromFirestore(n,t)}return new Il(this.ka.Kh,(null==t?void 0:t.serverTimestamps)||"none",function(t){return new Ul(e.Bh,null,t)},function(t){return new ei(t)}).$h(this.Qh.re())}},Ff.prototype.get=function(t,e){var n=this;if(void 0===e&&(e={}),this.Qh){t=this.Qh.data().field(_l("DocumentSnapshot.get",t));if(null!==t)return new Il(this.ka.Kh,e.serverTimestamps||"none",function(t){return new Ul(n.Bh,n.Wh,t)},function(t){return new ei(t)}).$h(t)}},Ff),jf=(n(qf,Vf=Uf),qf.prototype.data=function(t){return void 0===t&&(t={}),Vf.prototype.data.call(this,t)},qf),xf=(Object.defineProperty(Mf.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Mf.prototype,"size",{get:function(){return this.Ma.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(Mf.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),Mf.prototype.forEach=function(e,n){var r=this;this.Ma.docs.forEach(function(t){e.call(n,r.La(t,r.Ma.fromCache,r.Ma.Qt.has(t.key)))})},Mf.prototype.docChanges=function(t){void 0===t&&(t={});t=!!t.includeMetadataChanges;if(t&&this.Ma.Kt)throw new xr(jr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.qa&&this.Ua===t||(this.qa=Sp(this.Ma,t,this.La.bind(this)),this.Ua=t),this.qa},Mf.prototype.La=function(t,e,n){return new jf(this.Bh,t.key,t,new ap(n,e),this.query.Wh)},Mf);function Mf(t,e,n){this.Bh=t,this.Ma=n,this.metadata=new ap(n.hasPendingWrites,n.fromCache),this.query=e}function qf(){return null!==Vf&&Vf.apply(this,arguments)||this}function Ff(t,e,n,r,i){var o=this;return(o=Cf.call(this,t,e,n,i)||this).Bh=t,o.ka=t,o.metadata=r,o}function Bf(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=rl(t.firestore,Rf),s=Bl(o);return e instanceof Kc&&(e=e.Ah),Wf(o,("string"==typeof e||e instanceof Cl?ef(s,"updateDoc",t.jh,e,n,r):tf(s,"updateDoc",t.jh,e)).Jh(t.jh,Rs.exists(!0)))}function Wf(t,e){return Sf(Zf(t),e)}function Gf(t,e,n){var r=n.docs.get(e.jh);return new Uf(t,e.jh,r,new ap(n.hasPendingWrites,n.fromCache),e.Wh)}var zf,Hf="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Qf=(Yf.prototype.enableIndexedDbPersistence=function(t,e){throw new xr(jr.FAILED_PRECONDITION,Hf)},Yf.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new xr(jr.FAILED_PRECONDITION,Hf)},Yf.prototype.clearIndexedDbPersistence=function(t){throw new xr(jr.FAILED_PRECONDITION,Hf)},Yf),Xf=(n(Kf,zf=Kc),Object.defineProperty(Kf.prototype,"Kh",{get:function(){return this.Ah.Kh},enumerable:!1,configurable:!0}),Kf.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.Ah.Na()),t)).merge,this.Ah.Fa(t)},Kf.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.Ah.Na().host&&zr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},Kf.prototype.enableNetwork=function(){return function(r){var t=this;return r.ke.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Ef(r)];case 1:return e=t.sent(),[4,Af(r)];case 2:return n=t.sent(),[2,(e.gc(!0),(t=n).ho.delete(0),Eh(t))]}})})})}(Zf(this.Ah))},Kf.prototype.disableNetwork=function(){return function(r){var t=this;return r.ke.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Ef(r)];case 1:return e=t.sent(),[4,Af(r)];case 2:return n=t.sent(),[2,(e.gc(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).ho.add(0),[4,Ih(e)];case 1:return t.sent(),e.fo.set("Offline"),[2]}})})}(n))]}})})})}(Zf(this.Ah))},Kf.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&el("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Ba.enableMultiTabIndexedDbPersistence(this):this.Ba.enableIndexedDbPersistence(this,n)},Kf.prototype.clearPersistence=function(){return this.Ba.clearIndexedDbPersistence(this)},Kf.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Kf.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new ua;return n.ke.Qe(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=oc,[4,Tf(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(Zf(this.Ah))},Kf.prototype.onSnapshotsInSync=function(t){return function(t,e){var n=this,r=Zf(t),e=kf(e)?e:{next:e},i=new Xc(e);return t.$a.Qe(function(){return y(n,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Ts.add(e),e.next()},[4,Nf(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})}),function(){i.Ih(),t.$a.Qe(function(){return y(n,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Ts.delete(e)},[4,Nf(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})})}}(this.Ah,t)},Object.defineProperty(Kf.prototype,"app",{get:function(){if(!this.ja)throw new xr(jr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.ja},enumerable:!1,configurable:!0}),Kf.prototype.collection=function(t){return Jc("Firestore.collection","path",t),Zf(this.Ah),new Ep(wi.U(t),this,null)},Kf.prototype.doc=function(t){return Jc("Firestore.doc","path",t),Zf(this.Ah),np.Qa(wi.U(t),this,null)},Kf.prototype.collectionGroup=function(t){if(Jc("Firestore.collectionGroup","collectionId",t),0<=t.indexOf("/"))throw new xr(jr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return Zf(this.Ah),new wp((t=t,new lu(wi.B(),t)),this,null)},Kf.prototype.runTransaction=function(e){var n=this;return function(n,r){var t=this,i=new ua;return n.ke.Qe(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,bf(n).then(function(t){return t.ro})];case 1:return e=t.sent(),new df(n.ke,e,r,i).run(),[2]}})})}),i.promise}(Zf(this.Ah),function(t){return e(new tp(n,t))})},Kf.prototype.batch=function(){return Zf(this.Ah),new ep(this)},Kf);function Kf(t,e,n){var i=this;return(i=zf.call(this,e)||this).Ba=n,i.INTERNAL={delete:function(){return r=i.Ah,t=r.app,void 0===n&&(n=Or),e=e="firestore-exp",t.container.getProvider(e).clearInstance(n),r._delete();var t,e,n,r}},t instanceof ai||(i.ja=t),i}function Yf(){}function Zf(t){return t.Oa||$f(t),t.Oa.Ra(),t.Oa}function $f(t){var e,n,r=t.Yh(),r=(e=t.Kh,n=t.Va,new ui(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.Oa=new yf(t.va,t.$a,r)}var Jf,tp=(op.prototype.get=function(t){var e=this,n=Np(0,t,this.Bh);return this.Wa.aa([n.jh]).then(function(t){if(!t||1!==t.length)return Qr();t=t[0];if(t instanceof hu)return new hp(e.Bh,n.jh,null,!1,!1,n.Wh);if(t instanceof au)return new hp(e.Bh,n.jh,t,!1,!1,n.Wh);throw Qr()})},op.prototype.set=function(t,e,n){t=Np(0,t,this.Bh);n=tl("Transaction.set",n);e=Op(t.Wh,e,n),n=Jl(this.Ka,"Transaction.set",t.jh,e,null!==t.Wh,n);return this.Wa.set(t.jh,n),this},op.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Np(0,t,this.Bh);return e instanceof Kc&&(e=e.Ah),e="string"==typeof e||e instanceof Cl?ef(this.Ka,"Transaction.update",t.jh,e,n,r):tf(this.Ka,"Transaction.update",t.jh,e),this.Wa.update(t.jh,e),this},op.prototype.delete=function(t){t=Np(0,t,this.Bh);return this.Wa.delete(t.jh),this},op),ep=(ip.prototype.set=function(t,e,n){this.Ha();t=Np(0,t,this.Bh);n=tl("WriteBatch.set",n);e=Op(t.Wh,e,n),n=Jl(this.Ka,"WriteBatch.set",t.jh,e,null!==t.Wh,n);return this.Ga=this.Ga.concat(n.Jh(t.jh,Rs.Jn())),this},ip.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.Ha();t=Np(0,t,this.Bh);return e instanceof Kc&&(e=e.Ah),e="string"==typeof e||e instanceof Cl?ef(this.Ka,"WriteBatch.update",t.jh,e,n,r):tf(this.Ka,"WriteBatch.update",t.jh,e),this.Ga=this.Ga.concat(e.Jh(t.jh,Rs.exists(!0))),this},ip.prototype.delete=function(t){this.Ha();t=Np(0,t,this.Bh);return this.Ga=this.Ga.concat(new Zs(t.jh,Rs.Jn())),this},ip.prototype.commit=function(){return this.Ha(),this.za=!0,0<this.Ga.length?Sf(Zf(this.Bh.Ah),this.Ga):Promise.resolve()},ip.prototype.Ha=function(){if(this.za)throw new xr(jr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},ip),np=(n(rp,Jf=Kc),rp.Qa=function(t,e,n){if(t.length%2!=0)throw new xr(jr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.q()+" has "+t.length);return new rp(e,new Ul(e.Ah,n,new Ii(t)))},rp.Ya=function(t,e,n){return new rp(e,new Ul(e.Ah,n,t))},Object.defineProperty(rp.prototype,"id",{get:function(){return this.Ah.id},enumerable:!1,configurable:!0}),Object.defineProperty(rp.prototype,"parent",{get:function(){return new Ep(this.Ah.zh.N(),this.firestore,this.Ah.Wh)},enumerable:!1,configurable:!0}),Object.defineProperty(rp.prototype,"path",{get:function(){return this.Ah.path},enumerable:!1,configurable:!0}),rp.prototype.collection=function(t){if(Jc("DocumentReference.collection","path",t),!t)throw new xr(jr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");t=wi.U(t);return new Ep(this.Ah.zh.child(t),this.firestore,null)},rp.prototype.isEqual=function(t){return t instanceof Kc&&(t=t.Ah),t instanceof Ul&&(((e=this.Ah)instanceof Ul||e instanceof jl)&&(t instanceof Ul||t instanceof jl)&&e.firestore===t.firestore&&e.path===t.path&&e.Wh===t.Wh);var e},rp.prototype.set=function(t,e){e=tl("DocumentReference.set",e);try{return n=this.Ah,r=t,i=e,o=rl(n.firestore,Rf),r=Op(n.Wh,r,i),Wf(o,Jl(Bl(o),"setDoc",n.jh,r,null!==n.Wh,i).Jh(n.jh,Rs.Jn()))}catch(t){throw sp(t,"setDoc","DocumentReference.set")}var n,r,i,o},rp.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Bf(this.Ah,t):Bf.apply(void 0,o([this.Ah,t,e],n))}catch(t){throw sp(t,"updateDoc","DocumentReference.update")}},rp.prototype.delete=function(){return Wf(rl((t=this.Ah).firestore,Rf),[new Zs(t.jh,Rs.Jn())]);var t},rp.prototype.onSnapshot=function(){for(var e=this,r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var n,i,o=function(){for(var t=0,e=r;t<e.length;t++){var n=e[t];if("object"==typeof n&&!kf(n))return n}return{}}(),n={next:function(t){i.next&&i.next(new hp(e.firestore,t.jh,t.Qh,t.metadata.fromCache,t.metadata.hasPendingWrites,e.Ah.Wh))},error:null===(n=(i=kf((n=r)[0])?n[0]:kf(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(n=i.complete)||void 0===n?void 0:n.bind(i)};return function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i={includeMetadataChanges:!1},o=0;"object"!=typeof n[o]||kf(n[o])||(i=n[o],o++);var s,u,a,h,c={includeMetadataChanges:i.includeMetadataChanges};kf(n[o])&&(h=n[o],n[o]=null===(i=h.next)||void 0===i?void 0:i.bind(h),n[o+1]=null===(i=h.error)||void 0===i?void 0:i.bind(h),n[o+2]=null===(i=h.complete)||void 0===i?void 0:i.bind(h)),e instanceof Ul?(u=rl(e.firestore,Rf),a=yu(e.jh.path),s={next:function(t){n[o]&&n[o](Gf(u,e,t))},error:n[o+1],complete:n[o+2]}):(u=rl(e.firestore,Rf),a=e.Hh,s={next:function(t){n[o]&&n[o](new xf(u,e,t))},error:n[o+1],complete:n[o+2]},gp(e.Hh));var l=Zf(u),f=new Xc(s),p=new Ta(a,f,c);return u.$a.Qe(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Ea,[4,Nf(l)];case 1:return[2,e.apply(void 0,[t.sent(),p])]}})})}),function(){f.Ih(),u.$a.Qe(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Ia,[4,Nf(l)];case 1:return[2,e.apply(void 0,[t.sent(),p])]}})})})}}(this.Ah,o,n)},rp.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){var t=this,n=rl(e.firestore,Rf),r=Zf(n),i=new ua;return n.$a.Qe(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,If(r)];case 1:return[4,Of(t.sent(),e.jh,i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return new Uf(n,e.jh,t,new ap(t instanceof au&&t.Xn,!0),e.Wh)})}:"server"===(null==t?void 0:t.source)?function(e){var t=this,n=rl(e.firestore,Rf),r=Zf(n),i=new ua;return n.$a.Qe(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Nf(r)];case 1:return[4,Pf(t.sent(),n.$a,e.jh,{source:"server"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return Gf(n,e,t)})}:function(e){var t=this,n=rl(e.firestore,Rf),r=Zf(n),i=new ua;return n.$a.Qe(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Nf(r)];case 1:return[4,Pf(t.sent(),n.$a,e.jh,{source:"default"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return Gf(n,e,t)})})(this.Ah).then(function(t){return new hp(e.firestore,t.jh,t.Qh,t.metadata.fromCache,t.metadata.hasPendingWrites,e.Ah.Wh)})},rp.prototype.withConverter=function(t){return new rp(this.firestore,this.Ah.withConverter(t))},rp);function rp(t,e){var n=this;return(n=Jf.call(this,e)||this).firestore=t,n}function ip(t){this.Bh=t,this.Ga=[],this.za=!1,this.Ka=Bl(this.Bh.Ah)}function op(t,e){this.Bh=t,this.Wa=e,this.Ka=Bl(this.Bh.Ah)}function sp(t,e,n){return t.message=t.message.replace(e+"()",n+"()"),t}var up,ap=(pp.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},pp),hp=(fp.prototype.data=function(t){var e=this;if(void 0===t&&(t={}),this.Qh){if(this.Wh){var n=new cp(this.Bh,this.jh,this.Qh,this.Ja,this.Xa,null);return this.Wh.fromFirestore(n,t)}return new Il(this.Bh.Kh,t.serverTimestamps||"none",function(t){return np.Ya(t,e.Bh,null)},function(t){return new si(t)}).$h(this.Qh.re())}},fp.prototype.get=function(t,e){var n=this;if(void 0===e&&(e={}),this.Qh){t=this.Qh.data().field(af("DocumentSnapshot.get",t,this.jh));if(null!==t)return new Il(this.Bh.Kh,e.serverTimestamps||"none",function(t){return np.Ya(t,n.Bh,n.Wh)},function(t){return new si(t)}).$h(t)}},Object.defineProperty(fp.prototype,"id",{get:function(){return this.jh.path.O()},enumerable:!1,configurable:!0}),Object.defineProperty(fp.prototype,"ref",{get:function(){return np.Ya(this.jh,this.Bh,this.Wh)},enumerable:!1,configurable:!0}),Object.defineProperty(fp.prototype,"exists",{get:function(){return null!==this.Qh},enumerable:!1,configurable:!0}),Object.defineProperty(fp.prototype,"metadata",{get:function(){return new ap(this.Xa,this.Ja)},enumerable:!1,configurable:!0}),fp.prototype.isEqual=function(t){return t instanceof fp&&this.Bh===t.Bh&&this.Ja===t.Ja&&this.jh.isEqual(t.jh)&&(null===this.Qh?null===t.Qh:this.Qh.isEqual(t.Qh))&&this.Wh===t.Wh},fp),cp=(n(lp,up=hp),lp.prototype.data=function(t){return up.prototype.data.call(this,t)},lp);function lp(){return null!==up&&up.apply(this,arguments)||this}function fp(t,e,n,r,i,o){this.Bh=t,this.jh=e,this.Qh=n,this.Ja=r,this.Xa=i,this.Wh=o}function pp(t,e){this.hasPendingWrites=t,this.fromCache=e}function dp(t,e,n){if(n instanceof Kc&&(n=n.Ah),"string"==typeof n){if(""===n)throw new xr(jr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!bu(e)&&-1!==n.indexOf("/"))throw new xr(jr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(wi.U(n));if(!Ii.X(e))throw new xr(jr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return xo(t,new Ii(e))}if(n instanceof Ul)return xo(t,n.jh);throw new xr(jr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+nl(n)+".")}function yp(t,e){if(!Array.isArray(t)||0===t.length)throw new xr(jr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new xr(jr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function vp(t,e,n){if(!n.isEqual(e))throw new xr(jr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function gp(t){if(gu(t)&&0===t.oe.length)throw new xr(jr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var mp,wp=(Tp.prototype.where=function(t,e,n){t=af("Query.where",t),e=function(t,e,n,r,i,o){if(r.W()){if("array-contains"===i||"array-contains-any"===i)throw new xr(jr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){yp(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var h=a[u];s.push(dp(n,t,h))}c={arrayValue:{values:s}}}else c=dp(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||yp(o,i),c=nf(e,"Query.where",o,"in"===i||"not-in"===i);var c=Lu.create(r,i,c);return function(t,e){if(e.ae()){var n=wu(t);if(null!==n&&!n.isEqual(e.field))throw new xr(jr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=mu(t);null!==n&&vp(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new xr(jr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new xr(jr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,c),c}(this.Hh,this.Ka,this.firestore.Kh,t,e,n);return new Tp((n=this.Hh,e=n.filters.concat([e]),new lu(n.path,n.collectionGroup,n.oe.slice(),e,n.limit,n.ue,n.startAt,n.endAt)),this.firestore,this.Wh)},Tp.prototype.orderBy=function(t,e){if(void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new xr(jr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var n,t=af("Query.orderBy",t),t=function(t,e,n){if(null!==t.startAt)throw new xr(jr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new xr(jr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");e=new sa(e,n);return n=e,null!==mu(t)||null!==(t=wu(t))&&vp(0,t,n.field),e}(this.Hh,t,n);return new Tp((n=this.Hh,t=n.oe.concat([t]),new lu(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.ue,n.startAt,n.endAt)),this.firestore,this.Wh)},Tp.prototype.limit=function(t){return il("Query.limit",t),new Tp(Au(this.Hh,t,"F"),this.firestore,this.Wh)},Tp.prototype.limitToLast=function(t){return il("Query.limitToLast",t),new Tp(Au(this.Hh,t,"L"),this.firestore,this.Wh)},Tp.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.Za("Query.startAt",t,e,!0);return new Tp(Tu(this.Hh,t),this.firestore,this.Wh)},Tp.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.Za("Query.startAfter",t,e,!1);return new Tp(Tu(this.Hh,t),this.firestore,this.Wh)},Tp.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.Za("Query.endBefore",t,e,!0);return new Tp(Nu(this.Hh,t),this.firestore,this.Wh)},Tp.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.Za("Query.endAt",t,e,!1);return new Tp(Nu(this.Hh,t),this.firestore,this.Wh)},Tp.prototype.isEqual=function(t){return t instanceof Tp&&this.firestore===t.firestore&&Su(this.Hh,t.Hh)&&this.Wh===t.Wh},Tp.prototype.withConverter=function(t){return new Tp(this.Hh,this.firestore,t)},Tp.prototype.Za=function(h,t,e,n){if(t instanceof hp)return function(t,e,n,r){if(!n)throw new xr(jr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+h+"().");for(var i=[],o=0,s=Eu(t);o<s.length;o++){var u=s[o];if(u.field.W())i.push(xo(e,n.key));else{var a=n.field(u.field);if(So(a))throw new xr(jr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.q();throw new xr(jr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new $u(i,r)}(this.Hh,this.firestore.Kh,t.Qh,n);e=[t].concat(e);return function(t,e,n,r,i,o){var s=t.oe;if(i.length>s.length)throw new xr(jr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var h=i[a];if(s[a].field.W()){if("string"!=typeof h)throw new xr(jr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!bu(t)&&-1!==h.indexOf("/"))throw new xr(jr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(wi.U(h));if(!Ii.X(c))throw new xr(jr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");c=new Ii(c);u.push(xo(e,c))}else{h=nf(n,r,h);u.push(h)}}return new $u(u,o)}(this.Hh,this.firestore.Kh,this.Ka,h,e,n)},Tp.prototype.onSnapshot=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i,o={},s=0;"object"!=typeof n[s]||kf(n[s])||(o=n[s],s++),kf(n[s])&&(i=n[s],n[s]=null===(t=i.next)||void 0===t?void 0:t.bind(i),n[s+1]=null===(t=i.error)||void 0===t?void 0:t.bind(i),n[s+2]=null===(t=i.complete)||void 0===t?void 0:t.bind(i));var u={next:function(t){n[s]&&n[s](new bp(e.firestore,e.Hh,t,e.Wh))},error:n[s+1],complete:n[s+2]};return gp(this.Hh),function(n,t,e){var r=this,i=new Xc(u),o=new Ta(t,i,e);return n.ke.Qe(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Ea,[4,Nf(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})}),function(){i.Ih(),n.ke.Qe(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Ia,[4,Nf(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})})}}(Zf(this.firestore.Ah),this.Hh,o)},Tp.prototype.get=function(t){var e=this;gp(this.Hh);var n=Zf(this.firestore.Ah);return(t&&"cache"===t.source?function(n,r){var t=this,i=new ua;return n.ke.Qe(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,sh(r,i,!0)];case 1:return n=t.sent(),e=new zh(i,n.lr),n=e.ru(n.documents),n=e.hu(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),n=ma(n,"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})},[4,If(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(n,this.Hh):function(n,r,i){var t=this;void 0===i&&(i={});var o=new ua;return n.ke.Qe(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new Xc({next:function(t){n.Qe(function(){return Ia(e,s)}),t.fromCache&&"server"===r.source?i.reject(new xr(jr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Ta(t,o,{includeMetadataChanges:!0,Cs:!0});return Ea(e,s)},[4,Nf(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.ke,r,i,o])]}})})}),o.promise}(n,this.Hh,t)).then(function(t){return new bp(e.firestore,e.Hh,t,e.Wh)})},Tp),bp=(Object.defineProperty(Ap.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Ap.prototype,"empty",{get:function(){return this.Ma.docs.P()},enumerable:!1,configurable:!0}),Object.defineProperty(Ap.prototype,"size",{get:function(){return this.Ma.docs.size},enumerable:!1,configurable:!0}),Ap.prototype.forEach=function(e,n){var r=this;this.Ma.docs.forEach(function(t){e.call(n,r.nl(t,r.metadata.fromCache,r.Ma.Qt.has(t.key)))})},Object.defineProperty(Ap.prototype,"query",{get:function(){return new wp(this.tl,this.Bh,this.Wh)},enumerable:!1,configurable:!0}),Ap.prototype.docChanges=function(t){t=!(!t||!t.includeMetadataChanges);if(t&&this.Ma.Kt)throw new xr(jr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.qa&&this.Ua===t||(this.qa=Sp(this.Ma,t,this.nl.bind(this)),this.Ua=t),this.qa},Ap.prototype.isEqual=function(t){return t instanceof Ap&&this.Bh===t.Bh&&Su(this.tl,t.tl)&&this.Ma.isEqual(t.Ma)&&this.Wh===t.Wh},Ap.prototype.nl=function(t,e,n){return new cp(this.Bh,t.key,t,e,n,this.Wh)},Ap),Ep=(n(Ip,mp=wp),Object.defineProperty(Ip.prototype,"id",{get:function(){return this.Hh.path.O()},enumerable:!1,configurable:!0}),Object.defineProperty(Ip.prototype,"parent",{get:function(){var t=this.Hh.path.N();return t.P()?null:np.Qa(t,this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(Ip.prototype,"path",{get:function(){return this.Hh.path.q()},enumerable:!1,configurable:!0}),Ip.prototype.doc=function(t){0===arguments.length&&(t=Kr.t()),Jc("CollectionReference.doc","path",t);t=wi.U(t);return np.Qa(this.Hh.path.child(t),this.firestore,this.Wh)},Ip.prototype.add=function(t){var t=this.Wh?this.Wh.toFirestore(t):t,e=this.doc();return np.Ya(e.Ah.jh,this.firestore,null).set(t).then(function(){return e})},Ip.prototype.withConverter=function(t){return new Ip(this.zh,this.firestore,t)},Ip);function Ip(t,e,n){var r=this;if(((r=mp.call(this,yu(t),e,n)||this).zh=t).length%2!=1)throw new xr(jr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.q()+" has "+t.length);return r}function Ap(t,e,n,r){this.Bh=t,this.tl=e,this.Ma=n,this.Wh=r,this.qa=null,this.Ua=null,this.metadata=new ap(n.hasPendingWrites,n.fromCache)}function Tp(t,e,n){this.Hh=t,this.firestore=e,this.Wh=n,this.Ka=Bl(e.Ah)}function Np(t,e,n){e=rl(e,Ul);if(e.firestore!==n.Ah)throw new xr(jr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function Sp(i,e,o){if(i.jt.P()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.jt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Qr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}function Op(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Pp,kp,Dp,f=(n(_p,kp=Kc),_p.documentId=function(){return new _p(Ei.K().q())},_p.prototype.isEqual=function(t){return t instanceof Kc&&(t=t.Ah),t instanceof Cl&&this.Ah.Gh.isEqual(t.Gh)},_p),Te=(n(Lp,Pp=Kc),Lp.serverTimestamp=function(){var t=new yl("serverTimestamp");return t.Rh="FieldValue.serverTimestamp",new Lp(t)},Lp.delete=function(){var t=new ul("deleteField");return t.Rh="FieldValue.delete",new Lp(t)},Lp.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new vl("arrayUnion",t)}.apply(void 0,t);return n.Rh="FieldValue.arrayUnion",new Lp(n)},Lp.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new gl("arrayRemove",t)}.apply(void 0,t);return n.Rh="FieldValue.arrayRemove",new Lp(n)},Lp.increment=function(t){t=new ml("increment",t);return t.Rh="FieldValue.increment",new Lp(t)},Lp.prototype.isEqual=function(t){return this.Ah.isEqual(t.Ah)},Lp),Rp={Firestore:Xf,GeoPoint:wl,Timestamp:gi,Blob:si,Transaction:tp,WriteBatch:ep,DocumentReference:np,DocumentSnapshot:hp,Query:wp,QueryDocumentSnapshot:cp,QuerySnapshot:bp,CollectionReference:Ep,FieldPath:f,FieldValue:Te,setLogLevel:function(t){qr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};function Lp(){return null!==Pp&&Pp.apply(this,arguments)||this}function _p(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return kp.call(this,new(Cl.bind.apply(Cl,o([void 0],t))))||this}(Dp=e.default).INTERNAL.registerComponent(new Er("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new Xf(e,new Rf(e,t),new Qf);var e},"PUBLIC").setServiceProps(Object.assign({},Rp))),Dp.registerVersion("@firebase/firestore","2.0.2-20201010222127")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map
