!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Tg){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var l,e=t(Tg);function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(Ie=l=l||{})[Ie.DEBUG=0]="DEBUG",Ie[Ie.VERBOSE=1]="VERBOSE",Ie[Ie.INFO=2]="INFO",Ie[Ie.WARN=3]="WARN",Ie[Ie.ERROR=4]="ERROR",Ie[Ie.SILENT=5]="SILENT";function n(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=u[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var r={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},i=l.INFO,u=((Te={})[l.DEBUG]="log",Te[l.VERBOSE]="log",Te[l.INFO]="info",Te[l.WARN]="warn",Te[l.ERROR]="error",Te),o=(Object.defineProperty(a.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),a.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?r[t]:t},Object.defineProperty(a.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),a.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.DEBUG],t)),this._logHandler.apply(this,s([this,l.DEBUG],t))},a.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.VERBOSE],t)),this._logHandler.apply(this,s([this,l.VERBOSE],t))},a.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.INFO],t)),this._logHandler.apply(this,s([this,l.INFO],t))},a.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.WARN],t)),this._logHandler.apply(this,s([this,l.WARN],t))},a.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.ERROR],t)),this._logHandler.apply(this,s([this,l.ERROR],t))},a);function a(t){this.name=t,this._logLevel=i,this._logHandler=n,this._userLogHandler=null}var c=function(t,e){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function h(t,e){function n(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function f(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(h(w,d=Error),w);function w(t,e,n){e=d.call(this,e)||this;return e.code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function _(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},x={},S=N||self;function D(){}function O(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function k(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var P="closure_uid_"+(1e9*Math.random()>>>0),R=0;function L(t,e,n){return t.call.apply(t.bind,arguments)}function C(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function V(t,e,n){return(V=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?L:C).apply(null,arguments)}function M(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function U(){return Date.now()}function j(t,o){function e(){}e.prototype=o.prototype,t.X=o.prototype,t.prototype=new e,(t.prototype.constructor=t).Kb=function(t,e,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[e].apply(t,r)}}function q(){this.j=this.j,this.i=this.i}q.prototype.j=!1,q.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,P)&&t[P]||(t[P]=++R))},q.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var F=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},B=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function z(){return Array.prototype.concat.apply([],arguments)}function G(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function K(t){return/^[\s\xa0]*$/.test(t)}var H,W=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Y(t,e){return-1!=t.indexOf(e)}function X(t,e){return t<e?-1:e<t?1:0}t:{var Z=S.navigator;if(Z){Z=Z.userAgent;if(Z){H=Z;break t}}H=""}function Q(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function J(t){var e,n={};for(e in t)n[e]=t[e];return n}var $="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<$.length;i++)e=$[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function et(t){return et[" "](t),t}et[" "]=D;var nt,rt=Y(H,"Opera"),it=Y(H,"Trident")||Y(H,"MSIE"),ot=Y(H,"Edge"),st=ot||it,ut=Y(H,"Gecko")&&!(Y(H.toLowerCase(),"webkit")&&!Y(H,"Edge"))&&!(Y(H,"Trident")||Y(H,"MSIE"))&&!Y(H,"Edge"),at=Y(H.toLowerCase(),"webkit")&&!Y(H,"Edge");function ct(){var t=S.document;return t?t.documentMode:void 0}t:{var ht="",ft=(ft=H,ut?/rv:([^\);]+)(\)|;)/.exec(ft):ot?/Edge\/([\d\.]+)/.exec(ft):it?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ft):at?/WebKit\/(\S+)/.exec(ft):rt?/(?:Version)[ \/]?(\S+)/.exec(ft):void 0);if(ft&&(ht=ft?ft[1]:""),it){ft=ct();if(null!=ft&&ft>parseFloat(ht)){nt=String(ft);break t}}nt=ht}var lt={};function pt(u){return t=u,e=function(){for(var t=0,e=W(String(nt)).split("."),n=W(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=X(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||X(0==o[2].length,0==s[2].length)||X(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=lt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var dt=S.document&&it?ct()||(parseInt(nt,10)||void 0):void 0,yt=!it||9<=Number(dt),vt=it&&!pt("9"),gt=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",D,e),S.removeEventListener("test",D,e)}catch(t){}return t}();function mt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function wt(t,e){if(mt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ut){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:bt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}mt.prototype.b=function(){this.defaultPrevented=!0},j(wt,mt);var bt={2:"touch",3:"pen",4:"mouse"};wt.prototype.b=function(){wt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,vt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Et="closure_listenable_"+(1e6*Math.random()|0),It=0;function Tt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++It,this.Y=this.Z=!1}function _t(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function At(t){this.src=t,this.a={},this.b=0}function Nt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=F(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(_t(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function xt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}At.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=xt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Tt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var St="closure_lm_"+(1e6*Math.random()|0),Dt={};function Ot(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=Ut(r);return e&&e[Et]?e.wa(n,r,k(i)?!!i.capture:!!i,o):kt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ot(t,e[o],n,r,i);return null}return n=Ut(n),t&&t[Et]?t.va(e,n,k(r)?!!r.capture:!!r,i):kt(t,e,n,!1,r,i)}function kt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=k(i)?!!i.capture:!!i;if(s&&!yt)return null;var u,a,c=Vt(t);if(c||(t[St]=c=new At(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Ct,r=a=yt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)gt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Rt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Pt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Et]?Nt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Rt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Vt(e))?(Nt(n,t),0==n.b&&(n.src=null,e[St]=null)):_t(t)))}function Rt(t){return t in Dt?Dt[t]:Dt[t]="on"+t}function Lt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Pt(t),n.call(r,e)}function Ct(t,e){if(t.Y)return!0;if(yt)return Lt(t,new wt(e,this));if(!e)t:{e=["window","event"];for(var n=S,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Lt(t,e=new wt(e,this))}function Vt(t){return(t=t[St])instanceof At?t:null}var Mt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ut(e){return"function"==typeof e?e:(e[Mt]||(e[Mt]=function(t){return e.handleEvent(t)}),e[Mt])}function jt(){q.call(this),this.c=new At(this),(this.J=this).C=null}function qt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new mt(e,t):e instanceof mt?e.target=e.target||t:(s=e,tt(e=new mt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Ft(o,r,!0,e)&&s;if(s=Ft(o=e.a=t,r,!0,e)&&s,s=Ft(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Ft(o=e.a=n[i],r,!1,e)&&s}function Ft(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Nt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}j(jt,q),jt.prototype[Et]=!0,(A=jt.prototype).addEventListener=function(t,e,n,r){Ot(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=k(i)?!!i.capture:!!i,r=Ut(r),e&&e[Et]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=xt(s=e.a[n],r,i,o))&&(_t(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Vt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=xt(n,r,i,o)),(r=-1<e?n[e]:null)&&Pt(r))}(this,t,e,n,r)},A.G=function(){if(jt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)_t(n[r]);delete e.a[t],e.b--}}this.C=null},A.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},A.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Bt=S.JSON.stringify;function zt(){this.b=this.a=null}var Gt,Kt=(Ht.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Ht(function(){return new Wt},function(t){t.reset()}));function Ht(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Wt(){this.next=this.b=this.a=null}function Yt(t,e){var n;Gt||(n=S.Promise.resolve(void 0),Gt=function(){n.then(Qt)}),Xt||(Gt(),Xt=!0),Zt.add(t,e)}zt.prototype.add=function(t,e){var n=Kt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Wt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Xt=!(Wt.prototype.reset=function(){this.next=this.b=this.a=null}),Zt=new zt;function Qt(){for(var t,e;n=e=void 0,n=null,(e=Zt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){S.setTimeout(function(){throw t},0)}(t)}var n=Kt;n.f(t),n.b<100&&(n.b++,t.next=n.a,n.a=t)}Xt=!1}function Jt(t,e){jt.call(this),this.b=t||1,this.a=e||S,this.f=V(this.Za,this),this.g=U()}function $t(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function te(t,e,n){if("function"==typeof t)n&&(t=V(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=V(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}j(Jt,jt),(A=Jt.prototype).aa=!1,A.M=null,A.Za=function(){var t;this.aa&&(0<(t=U()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),qt(this,"tick"),this.aa&&($t(this),this.start())))},A.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=U())},A.G=function(){Jt.X.G.call(this),$t(this),delete this.a};var ee,ne,re,ie=(T(ne=se,re=ee=q),ne.prototype=null===re?Object.create(re):(oe.prototype=re.prototype,new oe),se.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=te(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},se.prototype.G=function(){ee.prototype.G.call(this),this.a&&(S.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},se);function oe(){this.constructor=ne}function se(t,e){var n=ee.call(this)||this;return n.g=t,n.h=e,n.b=null,n.c=!1,n.a=null,n}function ue(t){q.call(this),this.b=t,this.a={}}j(ue,q);var ae=[];function ce(t,e,n,r){Array.isArray(n)||(n&&(ae[0]=n.toString()),n=ae);for(var i=0;i<n.length;i++){var o=Ot(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function he(t){Q(t.a,function(t,e){this.a.hasOwnProperty(e)&&Pt(t)},t),t.a={}}function fe(){this.a=!0}function le(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return Bt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ue.prototype.G=function(){ue.X.G.call(this),he(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},fe.prototype.info=function(){};var pe={},de=null;function ye(){return de=de||new jt}function ve(t){mt.call(this,pe.Fa,t)}function ge(t){var e=ye();qt(e,new ve(e))}function me(t,e){mt.call(this,pe.STAT_EVENT,t),this.stat=e}function we(t){var e=ye();qt(e,new me(e,t))}function be(t){mt.call(this,pe.Ga,t)}function Ee(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}pe.Fa="serverreachability",j(ve,mt),pe.STAT_EVENT="statevent",j(me,mt),pe.Ga="timingevent",j(be,mt);var Ie={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},Te={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function _e(){}function Ae(t){var e;return(e=t.a)||(e=t.a={}),e}function Ne(){}_e.prototype.a=null;var xe,N={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Se(){mt.call(this,"d")}function De(){mt.call(this,"c")}function Oe(){}function ke(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ue(this),this.P=Pe,t=st?125:void 0,this.R=new Jt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}j(Se,mt),j(De,mt),j(Oe,_e),xe=new Oe;var Pe=45e3,Re={},Le={};function Ce(t,e,n){t.H=1,t.i=nn(Ze(e)),t.j=n,t.I=!0,Ve(t,null)}function Ve(t,e){t.u=U(),Ue(t),t.l=Ze(t.i);var s,u,a,c,h,f,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),vn(n.b,"t",r),t.D=0,t.a=cr(t.g,t.g.C?e:null),0<t.O&&(t.F=new ie(V(t.Ca,t,t.a),t.O)),ce(t.J,t.a,"readystatechange",t.Xa),e=t.B?J(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ge(1),s=t.c,u=t.m,a=t.l,c=t.f,h=t.S,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Me(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Le:(i=Number(u.substring(i,o)),isNaN(i)?Re:(o+=1)+i>u.length?Le:(u=u.substr(o,i),r.D=o+i,u)));if(u==Le){4==e&&(t.h=4,we(14),s=!1),le(t.c,t.f,null,"[Incomplete Response]");break}if(u==Re){t.h=4,we(15),le(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}le(t.c,t.f,u,null),ze(t,u)}4==e&&0==n.length&&(t.h=1,we(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),er(e),e.F=!0,we(11))):(le(t.c,t.f,n,"[Invalid Chunked Response]"),Be(t),Fe(t))}function Ue(t){t.T=U()+t.P,je(t,t.P)}function je(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ee(V(t.Va,t),e)}function qe(t){t.o&&(S.clearTimeout(t.o),t.o=null)}function Fe(t){0==t.g.v||t.A||ir(t.g,t)}function Be(t){qe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,$t(t.R),he(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function ze(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||Tn(u.b,t)))if(u.I=t.N,!t.C&&Tn(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;rr(u),Hn(u)}tr(u),we(18)}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=Ee(V(u.Sa,u),6e3));if(In(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else sr(u,11)}else if(!t.C&&u.a!=t||rr(u),!K(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++){c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(Y(r,"spdy")||Y(r,"quic")||Y(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(_n(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,en(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=U()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ar(n,n.C?n.ga:null,n.fa),i.C?(An(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(qe(o),Ue(o)),n.a=i):$n(n),0<u.g.length&&Xn(u)):"stop"!=c[0]&&"close"!=c[0]||sr(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?sr(u,7):Kn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0)}ge(4)}catch(t){}}function Ge(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(O(t)||"string"==typeof t)B(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(O(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(O(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Ke(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ke)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function He(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];We(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)We(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function We(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=ke.prototype).setTimeout=function(t){this.P=t},A.Xa=function(t){t=t.target;var e=this.F;e&&3==Fn(t)?e.f():this.Ca(t)},A.Ca=function(t){try{if(t==this.a)t:{var e=Fn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!st&&!this.a.$())){this.A||4!=e||7==n||ge(8==n||r<=0?3:2),qe(this);var i=this.a.W();this.N=i;n=this.a.$();if(this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.S,f=e,l=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+f+" "+l}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!K(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,we(12),Be(this),Fe(this);break t}le(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,ze(this,s)}this.I?(Me(this,e,n),st&&this.b&&3==e&&(ce(this.J,this.R,"tick",this.Wa),this.R.start())):(le(this.c,this.f,n,null),ze(this,n)),4==e&&Be(this),this.b&&!this.A&&(4==e?ir(this.g,this):(this.b=!1,Ue(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,we(12)):(this.h=0,we(13)),Be(this),Fe(this)}}}catch(t){}var u,a,c,h,f,l},A.Wa=function(){var t,e;this.a&&(t=Fn(this.a),e=this.a.$(),this.D<e.length&&(qe(this),Me(this,t,e),this.b&&4!=t&&Ue(this)))},A.cancel=function(){this.A=!0,Be(this)},A.Va=function(){this.o=null;var t,e,n=U();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ge(3),we(17)),Be(this),this.h=2,Fe(this)):je(this,this.T-n)},(A=Ke.prototype).K=function(){He(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.L=function(){return He(this),this.a.concat()},A.get=function(t,e){return We(this.b,t)?this.b[t]:e},A.set=function(t,e){We(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ye=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Xe(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Xe?(this.a=void 0!==e?e:t.a,Qe(this,t.f),this.j=t.j,Je(this,t.c),$e(this,t.h),this.g=t.g,e=t.b,(n=new ln).c=e.c,e.a&&(n.a=new Ke(e.a),n.b=e.b),tn(this,n),this.i=t.i):t&&(n=String(t).match(Ye))?(this.a=!!e,Qe(this,n[1]||"",!0),this.j=rn(n[2]||""),Je(this,n[3]||"",!0),$e(this,n[4]),this.g=rn(n[5]||"",!0),tn(this,n[6]||"",!0),this.i=rn(n[7]||"")):(this.a=!!e,this.b=new ln(null,this.a))}function Ze(t){return new Xe(t)}function Qe(t,e,n){t.f=n?rn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Je(t,e,n){t.c=n?rn(e,!0):e}function $e(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function tn(t,e,n){var r,i;e instanceof ln?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(pn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(dn(this,e),vn(this,n,t))},r)),r.f=i):(n||(e=on(e,hn)),t.b=new ln(e,t.a))}function en(t,e,n){t.b.set(e,n)}function nn(t){return en(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^U()).toString(36)),t}function rn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function on(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,sn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function sn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Xe.prototype.toString=function(){var t=[],e=this.f;e&&t.push(on(e,un,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(on(e,un,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(on(n,"/"==n.charAt(0)?cn:an,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",on(n,fn)),t.join("")};var un=/[#\/\?@]/g,an=/[#\?:]/g,cn=/[#\?]/g,hn=/[#\?@]/g,fn=/#/g;function ln(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function pn(n){n.a||(n.a=new Ke,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function dn(t,e){pn(t),e=gn(t,e),We(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,We((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&He(t)))}function yn(t,e){return pn(t),e=gn(t,e),We(t.a.b,e)}function vn(t,e,n){dn(t,e),0<n.length&&(t.c=null,t.a.set(gn(t,e),G(n)),t.b+=n.length)}function gn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(A=ln.prototype).add=function(t,e){pn(this),this.c=null,t=gn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,r){pn(this),this.a.forEach(function(t,e){B(t,function(t){n.call(r,t,e,this)},this)},this)},A.L=function(){pn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},A.K=function(t){pn(this);var e=[];if("string"==typeof t)yn(this,t)&&(e=z(e,this.a.get(gn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},A.set=function(t,e){return pn(this),this.c=null,yn(this,t=gn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var mn=function(t,e){this.b=t,this.a=e};function wn(t){this.g=t||bn,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ia&&S.ia.ya&&S.ia.ya()&&S.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var bn=10;function En(t){return t.b||t.a&&t.a.size>=t.f}function In(t){return t.b?1:t.a?t.a.size:0}function Tn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function _n(t,e){t.a?t.a.add(e):t.b=e}function An(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Nn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return G(t.c);var r=t.c;try{for(var i=_(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function xn(){}function Sn(){this.a=new xn}function Dn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}wn.prototype.cancel=function(){var e,t;if(this.c=Nn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=_(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},xn.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},xn.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var On=S.JSON.parse;function kn(t){jt.call(this),this.headers=new Ke,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Pn,this.D=this.F=!1}j(kn,jt);var Pn="",Rn=/^https?$/i,Ln=["POST","PUT"];function Cn(t){return"content-type"==t.toLowerCase()}function Vn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Mn(t),jn(t)}function Mn(t){t.u||(t.u=!0,qt(t,"complete"),qt(t,"error"))}function Un(t){if(t.b&&void 0!==x&&(!t.s[1]||4!=Fn(t)||2!=t.W()))if(t.l&&4==Fn(t))te(t.za,0,t);else if(qt(t,"readystatechange"),4==Fn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}(e=s)||((n=0===o)&&(!(i=String(t.B).match(Ye)[1]||null)&&S.self&&S.self.location&&(i=(r=S.self.location.protocol).substr(0,r.length-1)),n=!Rn.test(i?i.toLowerCase():"")),e=n);if(e)qt(t,"complete"),qt(t,"success");else{t.h=6;try{var u=2<Fn(t)?t.a.statusText:""}catch(o){u=""}t.f=u+" ["+t.W()+"]",Mn(t)}}finally{jn(t)}}}function jn(t,e){if(t.a){qn(t);var n=t.a,r=t.s[0]?D:null;t.a=null,t.s=null,e||qt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function qn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function Fn(t){return t.a?t.a.readyState:0}function Bn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",Q(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):en(t,e,n))}function zn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Gn(t){this.pa=0,this.g=[],this.c=new fe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=zn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=zn("baseRetryDelayMs",5e3,t),this.Ra=zn("retryDelaySeedMs",1e4,t),this.Ma=zn("forwardChannelMaxRetries",2,t),this.ma=zn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new wn(t&&t.concurrentRequestLimit),this.ka=new Sn,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Kn(t){var e,n;Wn(t),3==t.v&&(e=t.R++,en(n=Ze(t.B),"SID",t.J),en(n,"RID",e),en(n,"TYPE","terminate"),Qn(t,n),(e=new ke(t,t.c,e,void 0)).H=2,e.i=nn(Ze(n)),n=!1,S.navigator&&S.navigator.sendBeacon&&(n=S.navigator.sendBeacon(e.i.toString(),"")),!n&&S.Image&&((new Image).src=e.i,n=!0),n||(e.a=cr(e.g,null),e.a.ba(e.i)),e.u=U(),Ue(e)),ur(t)}function Hn(t){t.a&&(er(t),t.a.cancel(),t.a=null)}function Wn(t){Hn(t),t.j&&(S.clearTimeout(t.j),t.j=null),rr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&S.clearTimeout(t.h),t.h=null)}function Yn(t,e){t.g.push(new mn(t.Oa++,e)),3==t.v&&Xn(t)}function Xn(t){En(t.b)||t.h||(t.h=!0,Yt(t.Ba,t),t.u=0)}function Zn(t,e){var n=e?e.f:t.R++,r=Ze(t.B);en(r,"SID",t.J),en(r,"RID",n),en(r,"AID",t.P),Qn(t,r),t.i&&t.l&&Bn(r,t.i,t.l),n=new ke(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Jn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),_n(t.b,n),Ce(n,r,e)}function Qn(t,n){t.f&&Ge({},function(t,e){en(n,e,t)})}function Jn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?V(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{Ge(t,function(t,e){var n=t;k(t)&&(n=Bt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function $n(t){t.a||t.j||(t.T=1,Yt(t.Aa,t),t.o=0)}function tr(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=Ee(V(t.Aa,t),or(t,t.o)),t.o++,1)}function er(t){null!=t.s&&(S.clearTimeout(t.s),t.s=null)}function nr(t){t.a=new ke(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ze(t.la);en(e,"RID","rpc"),en(e,"SID",t.J),en(e,"CI",t.H?"0":"1"),en(e,"AID",t.P),Qn(t,e),en(e,"TYPE","xmlhttp"),t.i&&t.l&&Bn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=nn(Ze(e)),n.j=null,n.I=!0,Ve(n,t)}function rr(t){null!=t.m&&(S.clearTimeout(t.m),t.m=null)}function ir(t,e){var n,r=null;if(t.a==e){rr(t),er(t),t.a=null;var i=2}else{if(!Tn(t.b,e))return;r=e.s,An(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=U()-e.u,n=t.u,qt(i=ye(),new be(i)),Xn(t)):$n(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(In(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)))return t.h=Ee(V(t.Ba,t,e),or(t,t.u)),t.u++,1}}(t,e)||2==i&&tr(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:sr(t,5);break;case 4:sr(t,10);break;case 3:sr(t,6);break;default:sr(t,2)}}function or(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function sr(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=V(t.Ya,t),r||(r=new Xe("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||Qe(r,"https"),nn(r)),n=r.toString(),r=o,o=new fe,S.Image?((i=new Image).onload=M(Dn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=M(Dn,o,i,"TestLoadImage: error",!1,r),i.onabort=M(Dn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=M(Dn,o,i,"TestLoadImage: timeout",!1,r),S.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):we(2),t.v=0,t.f&&t.f.ra(e),ur(t),Wn(t)}function ur(t){t.v=0,t.I=-1,t.f&&(0==Nn(t.b).length&&0==t.g.length||(t.b.c.length=0,G(t.g),t.g.length=0),t.f.qa())}function ar(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Xe?Ze(s):new Xe(s,void 0);return""!=a.c?(e&&Je(a,e+"."+a.c),$e(a,a.h)):(u=S.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Xe(null,void 0),r&&Qe(u,r),i&&Je(u,i),o&&$e(u,o),s&&(u.g=s),a=u),t.V&&Q(t.V,function(t,e){en(a,e,t)}),e=t.A,n=t.na,e&&n&&en(a,e,n),en(a,"VER",t.ha),Qn(t,a),a}function cr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new kn(t.Na)).F=t.C,e}function hr(){}function fr(){if(it&&!(10<=Number(dt)))throw Error("Environmental error: no available transport.")}function lr(t,e){jt.call(this),this.a=new Gn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!K(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!K(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new yr(this)}function pr(t){Se.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function dr(){De.call(this),this.status=1}function yr(t){this.a=t}(A=kn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ae(this.H):Ae(xe),this.a.onreadystatechange=V(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Vn(this,t)}t=n||"";var i,o=new Ke(this.headers);r&&Ge(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Cn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=S.FormData&&t instanceof S.FormData,0<=F(Ln,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{qn(this),0<this.o&&((this.D=(i=this.a,it&&pt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=V(this.xa,this)):this.m=te(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Vn(this,t)}},A.xa=function(){void 0!==x&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,qt(this,"timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,qt(this,"complete"),qt(this,"abort"),jn(this))},A.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),jn(this,!0)),kn.X.G.call(this)},A.za=function(){this.j||(this.A||this.l||this.g?Un(this):this.Ua())},A.Ua=function(){Un(this)},A.W=function(){try{return 2<Fn(this)?this.a.status:-1}catch(t){return-1}},A.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},A.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),On(e)}},A.ua=function(){return this.h},A.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=Gn.prototype).ha=8,A.v=1,A.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new ke(this,this.c,t,void 0),r=this.l;if(this.O&&(r?tt(r=J(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Jn(this,n,e),en(i=Ze(this.B),"RID",t),en(i,"CVER",22),this.A&&en(i,"X-HTTP-Session-Id",this.A),Qn(this,i),this.i&&r&&Bn(i,this.i,r),_n(this.b,n),this.Ia&&en(i,"TYPE","init"),this.da?(en(i,"$req",e),en(i,"SID","null"),n.U=!0,Ce(n,i,null)):Ce(n,i,e),this.v=2}}else 3==this.v&&(t?Zn(this,t):0==this.g.length||En(this.b)||Zn(this))},A.Aa=function(){var t;this.j=null,nr(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Ee(V(this.Ta,this),t))},A.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,we(10),Hn(this),nr(this))},A.Sa=function(){null!=this.m&&(this.m=null,Hn(this),tr(this),we(19))},A.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),we(2)):(this.c.info("Failed to ping google.com"),we(1))},(A=hr.prototype).ta=function(){},A.sa=function(){},A.ra=function(){},A.qa=function(){},A.Ja=function(){},fr.prototype.a=function(t,e){return new lr(t,e)},j(lr,jt),lr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;we(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=ar(t,null,t.fa),Xn(t)},lr.prototype.close=function(){Kn(this.a)},lr.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Yn(this.a,e)):this.l?((e={}).__data__=Bt(t),Yn(this.a,e)):Yn(this.a,t)},lr.prototype.G=function(){this.a.f=null,delete this.f,Kn(this.a),delete this.a,lr.X.G.call(this)},j(pr,Se),j(dr,De),j(yr,hr),yr.prototype.ta=function(){qt(this.a,"a")},yr.prototype.sa=function(t){qt(this.a,new pr(t))},yr.prototype.ra=function(t){qt(this.a,new dr)},yr.prototype.qa=function(){qt(this.a,"b")},fr.prototype.createWebChannel=fr.prototype.a,lr.prototype.send=lr.prototype.h,lr.prototype.open=lr.prototype.g,Ie.NO_ERROR=0,Ie.TIMEOUT=8,Ie.HTTP_ERROR=6,Te.COMPLETE="complete",(Ne.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",jt.prototype.listen=jt.prototype.va,kn.prototype.listenOnce=kn.prototype.wa,kn.prototype.getLastError=kn.prototype.Qa,kn.prototype.getLastErrorCode=kn.prototype.ua,kn.prototype.getStatus=kn.prototype.W,kn.prototype.getResponseJson=kn.prototype.Pa,kn.prototype.getResponseText=kn.prototype.$,kn.prototype.send=kn.prototype.ba;var vr,gr=ye,mr=Ie,wr=Te,br=pe,Er=10,Ir=11,Tr=Ne,_r=kn,Ar={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Nr=(h(Dr,vr=Error),Dr),xr="8.1.2-BundlePrerelease.dee1ef083",Sr=new o("@firebase/firestore");function Dr(t,e){var n=this;return(n=vr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Or(){return Sr.logLevel}function kr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Sr.logLevel<=l.DEBUG&&(e=n.map(Lr),Sr.debug.apply(Sr,f(["Firestore ("+xr+"): "+t],e)))}function Pr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Sr.logLevel<=l.ERROR&&(e=n.map(Lr),Sr.error.apply(Sr,f(["Firestore ("+xr+"): "+t],e)))}function Rr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Sr.logLevel<=l.WARN&&(e=n.map(Lr),Sr.warn.apply(Sr,f(["Firestore ("+xr+"): "+t],e)))}function Lr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Cr(t){void 0===t&&(t="Unexpected state");t="FIRESTORE ("+xr+") INTERNAL ASSERTION FAILED: "+t;throw Pr(t),new Error(t)}function Vr(t){t||Cr()}var Mr=(Ur.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Ur);function Ur(){}function jr(t,e){return t<e?-1:e<t?1:0}function qr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Fr(t){return t+"\0"}var Br=(zr.fromBase64String=function(t){return new zr(atob(t))},zr.fromUint8Array=function(t){return new zr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},zr.prototype.toBase64=function(){return t=this.i,btoa(t);var t},zr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},zr.prototype.o=function(){return 2*this.i.length},zr.prototype.u=function(t){return jr(this.i,t.i)},zr.prototype.isEqual=function(t){return this.i===t.i},zr);function zr(t){this.i=t}Br.h=new Br("");var Gr=(Hr.fromBase64String=function(t){try{return new Hr(Br.fromBase64String(t))}catch(t){throw new Nr(Ar.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},Hr.fromUint8Array=function(t){return new Hr(Br.fromUint8Array(t))},Hr.prototype.toBase64=function(){return this.l.toBase64()},Hr.prototype.toUint8Array=function(){return this.l.toUint8Array()},Hr.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Hr.prototype.isEqual=function(t){return this.l.isEqual(t.l)},Hr),Kr=function(t){this._=t};function Hr(t){this.l=t}function Wr(){if("undefined"==typeof Uint8Array)throw new Nr(Ar.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Yr(){if("undefined"==typeof atob)throw new Nr(Ar.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Xr,Zr=(h(ni,Xr=Kr),ni.fromBase64String=function(t){return Yr(),new ni(Gr.fromBase64String(t))},ni.fromUint8Array=function(t){return Wr(),new ni(Gr.fromUint8Array(t))},ni.prototype.toBase64=function(){return Yr(),this._.toBase64()},ni.prototype.toUint8Array=function(){return Wr(),this._.toUint8Array()},ni.prototype.isEqual=function(t){return this._.isEqual(t._)},ni.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},ni),Qr=function(t,e,n,r,i,o){this.T=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.m=o},Jr=(Object.defineProperty(ei.prototype,"I",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),ei.prototype.isEqual=function(t){return t instanceof ei&&t.projectId===this.projectId&&t.database===this.database},ei),$r=(ti.prototype.A=function(){return null!=this.uid},ti.prototype.R=function(){return this.A()?"uid:"+this.uid:"anonymous-user"},ti.prototype.isEqual=function(t){return t.uid===this.uid},ti);function ti(t){this.uid=t}function ei(t,e){this.projectId=t,this.database=e||"(default)"}function ni(){return null!==Xr&&Xr.apply(this,arguments)||this}$r.UNAUTHENTICATED=new $r(null),$r.P=new $r("google-credentials-uid"),$r.g=new $r("first-party-uid");function ri(t,e){this.user=e,this.type="OAuth",this.V={},this.V.Authorization="Bearer "+t}var ii,oi,si=(Ai.prototype.getToken=function(){return Promise.resolve(null)},Ai.prototype.v=function(){},Ai.prototype.S=function(t){(this.p=t)($r.UNAUTHENTICATED)},Ai.prototype.D=function(){this.p=null},Ai),ui=(_i.prototype.getToken=function(){var e=this,n=this.F,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.F!==n?(kr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Vr("string"==typeof t.accessToken),new ri(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},_i.prototype.v=function(){this.forceRefresh=!0},_i.prototype.S=function(t){this.p=t,this.N&&t(this.currentUser)},_i.prototype.D=function(){this.auth&&this.auth.removeAuthTokenListener(this.C),this.C=null,this.p=null},_i.prototype.O=function(){var t=this.auth&&this.auth.getUid();return Vr(null===t||"string"==typeof t),new $r(t)},_i),ai=(Object.defineProperty(Ti.prototype,"V",{get:function(){var t={"X-Goog-AuthUser":this.M},e=this.k.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Ti),ci=(Ii.prototype.getToken=function(){return Promise.resolve(new ai(this.k,this.M))},Ii.prototype.S=function(t){t($r.g)},Ii.prototype.D=function(){},Ii.prototype.v=function(){},Ii),hi=(Ei.now=function(){return Ei.fromMillis(Date.now())},Ei.fromDate=function(t){return Ei.fromMillis(t.getTime())},Ei.fromMillis=function(t){var e=Math.floor(t/1e3);return new Ei(e,1e6*(t-1e3*e))},Ei.prototype.toDate=function(){return new Date(this.toMillis())},Ei.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Ei.prototype.$=function(t){return this.seconds===t.seconds?jr(this.nanoseconds,t.nanoseconds):jr(this.seconds,t.seconds)},Ei.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Ei.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Ei.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},Ei.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Ei),fi=(bi.L=function(t){return new bi(t)},bi.min=function(){return new bi(new hi(0,0))},bi.prototype.u=function(t){return this.timestamp.$(t.timestamp)},bi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},bi.prototype.B=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},bi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},bi.prototype.q=function(){return this.timestamp},bi),Ie=(Object.defineProperty(wi.prototype,"length",{get:function(){return this.U},enumerable:!1,configurable:!0}),wi.prototype.isEqual=function(t){return 0===wi.K(this,t)},wi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof wi?t.forEach(function(t){e.push(t)}):e.push(t),this.W(e)},wi.prototype.limit=function(){return this.offset+this.length},wi.prototype.j=function(t){return t=void 0===t?1:t,this.W(this.segments,this.offset+t,this.length-t)},wi.prototype.G=function(){return this.W(this.segments,this.offset,this.length-1)},wi.prototype.H=function(){return this.segments[this.offset]},wi.prototype.J=function(){return this.get(this.length-1)},wi.prototype.get=function(t){return this.segments[this.offset+t]},wi.prototype.Y=function(){return 0===this.length},wi.prototype.X=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},wi.prototype.Z=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},wi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},wi.prototype.tt=function(){return this.segments.slice(this.offset,this.limit())},wi.K=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},wi),li=(h(mi,oi=Ie),mi.prototype.W=function(t,e,n){return new mi(t,e,n)},mi.prototype.et=function(){return this.tt().join("/")},mi.prototype.toString=function(){return this.et()},mi.nt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Nr(Ar.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new mi(n)},mi.st=function(){return new mi([])},mi),pi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,di=(h(gi,ii=Ie),gi.prototype.W=function(t,e,n){return new gi(t,e,n)},gi.it=function(t){return pi.test(t)},gi.prototype.et=function(){return this.tt().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),gi.it(t)||(t="`"+t+"`"),t}).join(".")},gi.prototype.toString=function(){return this.et()},gi.prototype.rt=function(){return 1===this.length&&"__name__"===this.get(0)},gi.ot=function(){return new gi(["__name__"])},gi.ct=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Nr(Ar.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Nr(Ar.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Nr(Ar.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new gi(e)},gi.st=function(){return new gi([])},gi),yi=(vi.at=function(t){return new vi(li.nt(t))},vi.ut=function(t){return new vi(li.nt(t).j(5))},vi.prototype.ht=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},vi.prototype.isEqual=function(t){return null!==t&&0===li.K(this.path,t.path)},vi.prototype.toString=function(){return this.path.toString()},vi.K=function(t,e){return li.K(t.path,e.path)},vi.lt=function(t){return t.length%2==0},vi._t=function(t){return new vi(new li(t.slice()))},vi);function vi(t){this.path=t}function gi(){return null!==ii&&ii.apply(this,arguments)||this}function mi(){return null!==oi&&oi.apply(this,arguments)||this}function wi(t,e,n){void 0===e?e=0:e>t.length&&Cr(),void 0===n?n=t.length-e:n>t.length-e&&Cr(),this.segments=t,this.offset=e,this.U=n}function bi(t){this.timestamp=t}function Ei(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Nr(Ar.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Nr(Ar.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Nr(Ar.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Nr(Ar.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Ii(t,e){this.k=t,this.M=e}function Ti(t,e){this.k=t,this.M=e,this.type="FirstParty",this.user=$r.g}function _i(t){var e=this;this.C=null,this.currentUser=$r.UNAUTHENTICATED,this.N=!1,this.F=0,this.p=null,this.forceRefresh=!1,this.C=function(){e.F++,e.currentUser=e.O(),e.N=!0,e.p&&e.p(e.currentUser)},this.F=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.C):(this.C(null),t.get().then(function(t){e.auth=t,e.C&&e.auth.addAuthTokenListener(e.C)},function(){}))}function Ai(){this.p=null}function Ni(t){return null==t}function xi(t){return 0===t&&1/t==-1/0}function Si(t){return"number"==typeof t&&Number.isInteger(t)&&!xi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var Di=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.ft=null};function Oi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Di(t,e,n,r,i,o,s)}function ki(t){var e=t;return null===e.ft&&(t=e.path.et(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.et()+t.op.toString()+Lo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.et()+t.dir}).join(","),Ni(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=ha(e.startAt)),e.endAt&&(t+="|ub:",t+=ha(e.endAt)),e.ft=t),e.ft}function Pi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!Oo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!la(t.startAt,e.startAt)&&la(t.endAt,e.endAt)}function Ri(t){return yi.lt(t.path)&&null===t.collectionGroup&&0===t.filters.length}function Li(t){this.count=t}var Ci,Vi=(Mi.prototype.Et=function(t){return new Mi(this.target,this.targetId,this.dt,t,this.wt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Mi.prototype.Tt=function(t,e){return new Mi(this.target,this.targetId,this.dt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Mi.prototype.It=function(t){return new Mi(this.target,this.targetId,this.dt,this.sequenceNumber,this.wt,t,this.resumeToken)},Mi);function Mi(t,e,n,r,i,o,s){void 0===i&&(i=fi.min()),void 0===o&&(o=fi.min()),void 0===s&&(s=Br.h),this.target=t,this.targetId=e,this.dt=n,this.sequenceNumber=r,this.wt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Ui(t){switch(t){case Ar.OK:return Cr(),0;case Ar.CANCELLED:case Ar.UNKNOWN:case Ar.DEADLINE_EXCEEDED:case Ar.RESOURCE_EXHAUSTED:case Ar.INTERNAL:case Ar.UNAVAILABLE:case Ar.UNAUTHENTICATED:return;case Ar.INVALID_ARGUMENT:case Ar.NOT_FOUND:case Ar.ALREADY_EXISTS:case Ar.PERMISSION_DENIED:case Ar.FAILED_PRECONDITION:case Ar.ABORTED:case Ar.OUT_OF_RANGE:case Ar.UNIMPLEMENTED:case Ar.DATA_LOSS:return 1;default:return Cr(),0}}function ji(t){if(void 0===t)return Pr("GRPC error has no .code"),Ar.UNKNOWN;switch(t){case Ci.OK:return Ar.OK;case Ci.CANCELLED:return Ar.CANCELLED;case Ci.UNKNOWN:return Ar.UNKNOWN;case Ci.DEADLINE_EXCEEDED:return Ar.DEADLINE_EXCEEDED;case Ci.RESOURCE_EXHAUSTED:return Ar.RESOURCE_EXHAUSTED;case Ci.INTERNAL:return Ar.INTERNAL;case Ci.UNAVAILABLE:return Ar.UNAVAILABLE;case Ci.UNAUTHENTICATED:return Ar.UNAUTHENTICATED;case Ci.INVALID_ARGUMENT:return Ar.INVALID_ARGUMENT;case Ci.NOT_FOUND:return Ar.NOT_FOUND;case Ci.ALREADY_EXISTS:return Ar.ALREADY_EXISTS;case Ci.PERMISSION_DENIED:return Ar.PERMISSION_DENIED;case Ci.FAILED_PRECONDITION:return Ar.FAILED_PRECONDITION;case Ci.ABORTED:return Ar.ABORTED;case Ci.OUT_OF_RANGE:return Ar.OUT_OF_RANGE;case Ci.UNIMPLEMENTED:return Ar.UNIMPLEMENTED;case Ci.DATA_LOSS:return Ar.DATA_LOSS;default:return Cr()}}(Te=Ci=Ci||{})[Te.OK=0]="OK",Te[Te.CANCELLED=1]="CANCELLED",Te[Te.UNKNOWN=2]="UNKNOWN",Te[Te.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Te[Te.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Te[Te.NOT_FOUND=5]="NOT_FOUND",Te[Te.ALREADY_EXISTS=6]="ALREADY_EXISTS",Te[Te.PERMISSION_DENIED=7]="PERMISSION_DENIED",Te[Te.UNAUTHENTICATED=16]="UNAUTHENTICATED",Te[Te.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Te[Te.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Te[Te.ABORTED=10]="ABORTED",Te[Te.OUT_OF_RANGE=11]="OUT_OF_RANGE",Te[Te.UNIMPLEMENTED=12]="UNIMPLEMENTED",Te[Te.INTERNAL=13]="INTERNAL",Te[Te.UNAVAILABLE=14]="UNAVAILABLE",Te[Te.DATA_LOSS=15]="DATA_LOSS";var qi=(Ki.prototype.At=function(t,e){return new Ki(this.K,this.root.At(t,e,this.K).copy(null,null,Bi.Rt,null,null))},Ki.prototype.remove=function(t){return new Ki(this.K,this.root.remove(t,this.K).copy(null,null,Bi.Rt,null,null))},Ki.prototype.get=function(t){for(var e=this.root;!e.Y();){var n=this.K(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Ki.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.Y();){var r=this.K(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Ki.prototype.Y=function(){return this.root.Y()},Object.defineProperty(Ki.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Ki.prototype.Pt=function(){return this.root.Pt()},Ki.prototype.yt=function(){return this.root.yt()},Ki.prototype.gt=function(t){return this.root.gt(t)},Ki.prototype.forEach=function(n){this.gt(function(t,e){return n(t,e),!1})},Ki.prototype.toString=function(){var n=[];return this.gt(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Ki.prototype.Vt=function(t){return this.root.Vt(t)},Ki.prototype.bt=function(){return new Fi(this.root,null,this.K,!1)},Ki.prototype.vt=function(t){return new Fi(this.root,t,this.K,!1)},Ki.prototype.St=function(){return new Fi(this.root,null,this.K,!0)},Ki.prototype.Dt=function(t){return new Fi(this.root,t,this.K,!0)},Ki),Fi=(Gi.prototype.Nt=function(){var t=this.xt.pop(),e={key:t.key,value:t.value};if(this.Ct)for(t=t.left;!t.Y();)this.xt.push(t),t=t.right;else for(t=t.right;!t.Y();)this.xt.push(t),t=t.left;return e},Gi.prototype.Ft=function(){return 0<this.xt.length},Gi.prototype.Ot=function(){if(0===this.xt.length)return null;var t=this.xt[this.xt.length-1];return{key:t.key,value:t.value}},Gi),Bi=(zi.prototype.copy=function(t,e,n,r,i){return new zi(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},zi.prototype.Y=function(){return!1},zi.prototype.gt=function(t){return this.left.gt(t)||t(this.key,this.value)||this.right.gt(t)},zi.prototype.Vt=function(t){return this.right.Vt(t)||t(this.key,this.value)||this.left.Vt(t)},zi.prototype.min=function(){return this.left.Y()?this:this.left.min()},zi.prototype.Pt=function(){return this.min().key},zi.prototype.yt=function(){return this.right.Y()?this.key:this.right.yt()},zi.prototype.At=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.At(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.At(t,e,n))).kt()},zi.prototype.Mt=function(){if(this.left.Y())return zi.EMPTY;var t=this;return t.left.$t()||t.left.left.$t()||(t=t.Lt()),(t=t.copy(null,null,null,t.left.Mt(),null)).kt()},zi.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.Y()||r.left.$t()||r.left.left.$t()||(r=r.Lt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.$t()&&(r=r.Bt()),r.right.Y()||r.right.$t()||r.right.left.$t()||(r=r.qt()),0===e(t,r.key)){if(r.right.Y())return zi.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Mt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.kt()},zi.prototype.$t=function(){return this.color},zi.prototype.kt=function(){var t=this;return t.right.$t()&&!t.left.$t()&&(t=t.Ut()),t.left.$t()&&t.left.left.$t()&&(t=t.Bt()),t.left.$t()&&t.right.$t()&&(t=t.Qt()),t},zi.prototype.Lt=function(){var t=this.Qt();return t.right.left.$t()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Bt())).Ut()).Qt()),t},zi.prototype.qt=function(){var t=this.Qt();return t.left.left.$t()&&(t=(t=t.Bt()).Qt()),t},zi.prototype.Ut=function(){var t=this.copy(null,null,zi.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},zi.prototype.Bt=function(){var t=this.copy(null,null,zi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},zi.prototype.Qt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},zi.prototype.Kt=function(){var t=this.Wt();return Math.pow(2,t)<=this.size+1},zi.prototype.Wt=function(){if(this.$t()&&this.left.$t())throw Cr();if(this.right.$t())throw Cr();var t=this.left.Wt();if(t!==this.right.Wt())throw Cr();return t+(this.$t()?0:1)},zi);function zi(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:zi.RED,this.left=null!=r?r:zi.EMPTY,this.right=null!=i?i:zi.EMPTY,this.size=this.left.size+1+this.right.size}function Gi(t,e,n,r){this.Ct=r,this.xt=[];for(var i=1;!t.Y();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Ct?t.left:t.right;else{if(0===i){this.xt.push(t);break}this.xt.push(t),t=this.Ct?t.right:t.left}}function Ki(t,e){this.K=t,this.root=e||Bi.EMPTY}function Hi(){this.size=0}Bi.EMPTY=null,Bi.RED=!0,Bi.Rt=!1,Bi.EMPTY=(Object.defineProperty(Hi.prototype,"key",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Object.defineProperty(Hi.prototype,"value",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Object.defineProperty(Hi.prototype,"color",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Object.defineProperty(Hi.prototype,"left",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Object.defineProperty(Hi.prototype,"right",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Hi.prototype.copy=function(t,e,n,r,i){return this},Hi.prototype.At=function(t,e,n){return new Bi(t,e)},Hi.prototype.remove=function(t,e){return this},Hi.prototype.Y=function(){return!0},Hi.prototype.gt=function(t){return!1},Hi.prototype.Vt=function(t){return!1},Hi.prototype.Pt=function(){return null},Hi.prototype.yt=function(){return null},Hi.prototype.$t=function(){return!1},Hi.prototype.Kt=function(){return!0},Hi.prototype.Wt=function(){return 0},new Hi);var Wi=(Qi.prototype.has=function(t){return null!==this.data.get(t)},Qi.prototype.first=function(){return this.data.Pt()},Qi.prototype.last=function(){return this.data.yt()},Object.defineProperty(Qi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Qi.prototype.indexOf=function(t){return this.data.indexOf(t)},Qi.prototype.forEach=function(n){this.data.gt(function(t,e){return n(t),!1})},Qi.prototype.jt=function(t,e){for(var n=this.data.vt(t[0]);n.Ft();){var r=n.Nt();if(0<=this.K(r.key,t[1]))return;e(r.key)}},Qi.prototype.Gt=function(t,e){for(var n=void 0!==e?this.data.vt(e):this.data.bt();n.Ft();)if(!t(n.Nt().key))return},Qi.prototype.zt=function(t){t=this.data.vt(t);return t.Ft()?t.Nt().key:null},Qi.prototype.bt=function(){return new Yi(this.data.bt())},Qi.prototype.vt=function(t){return new Yi(this.data.vt(t))},Qi.prototype.add=function(t){return this.copy(this.data.remove(t).At(t,!0))},Qi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Qi.prototype.Y=function(){return this.data.Y()},Qi.prototype.Ht=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Qi.prototype.isEqual=function(t){if(!(t instanceof Qi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.bt(),n=t.data.bt();e.Ft();){var r=e.Nt().key,i=n.Nt().key;if(0!==this.K(r,i))return!1}return!0},Qi.prototype.tt=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Qi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Qi.prototype.copy=function(t){var e=new Qi(this.K);return e.data=t,e},Qi),Yi=(Zi.prototype.Nt=function(){return this.Jt.Nt().key},Zi.prototype.Ft=function(){return this.Jt.Ft()},Zi),Xi=new qi(yi.K);function Zi(t){this.Jt=t}function Qi(t){this.K=t,this.data=new qi(this.K)}var Ji=new qi(yi.K);var $i=new qi(yi.K);var to=new Wi(yi.K);function eo(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=to,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var no=new Wi(jr);var ro=(bo.Zt=function(t){return new bo(t.K)},bo.prototype.has=function(t){return null!=this.Yt.get(t)},bo.prototype.get=function(t){return this.Yt.get(t)},bo.prototype.first=function(){return this.Xt.Pt()},bo.prototype.last=function(){return this.Xt.yt()},bo.prototype.Y=function(){return this.Xt.Y()},bo.prototype.indexOf=function(t){t=this.Yt.get(t);return t?this.Xt.indexOf(t):-1},Object.defineProperty(bo.prototype,"size",{get:function(){return this.Xt.size},enumerable:!1,configurable:!0}),bo.prototype.forEach=function(n){this.Xt.gt(function(t,e){return n(t),!1})},bo.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Yt.At(t.key,t),e.Xt.At(t,null))},bo.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Yt.remove(t),this.Xt.remove(e)):this},bo.prototype.isEqual=function(t){if(!(t instanceof bo))return!1;if(this.size!==t.size)return!1;for(var e=this.Xt.bt(),n=t.Xt.bt();e.Ft();){var r=e.Nt().key,i=n.Nt().key;if(!r.isEqual(i))return!1}return!0},bo.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},bo.prototype.copy=function(t,e){var n=new bo;return n.K=this.K,n.Yt=t,n.Xt=e,n},bo),io=(wo.prototype.track=function(t){var e=t.doc.key,n=this.te.get(e);!n||0!==t.type&&3===n.type?this.te=this.te.At(e,t):3===t.type&&1!==n.type?this.te=this.te.At(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.te=this.te.At(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.te=this.te.At(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.te=this.te.remove(e):1===t.type&&2===n.type?this.te=this.te.At(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.te=this.te.At(e,{type:2,doc:t.doc}):Cr()},wo.prototype.ee=function(){var n=[];return this.te.gt(function(t,e){n.push(e)}),n},wo),oo=(mo.oe=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new mo(t,e,ro.Zt(e),i,n,r,!0,!1)},Object.defineProperty(mo.prototype,"hasPendingWrites",{get:function(){return!this.se.Y()},enumerable:!1,configurable:!0}),mo.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.ie===t.ie&&this.se.isEqual(t.se)&&Ru(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.ne.isEqual(t.ne)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},mo),so=(go.le=function(t,e){var n=new Map;return n.set(t,uo._e(t,e)),new go(fi.min(),n,no,Xi,eo())},go),uo=(vo._e=function(t,e){return new vo(Br.h,e,eo(),eo(),eo())},vo),ao=function(t,e,n,r){this.Te=t,this.removedTargetIds=e,this.key=n,this.me=r},co=function(t,e){this.targetId=t,this.Ie=e},ho=function(t,e,n,r){void 0===n&&(n=Br.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},fo=(Object.defineProperty(yo.prototype,"fe",{get:function(){return this.ye},enumerable:!1,configurable:!0}),Object.defineProperty(yo.prototype,"resumeToken",{get:function(){return this.Pe},enumerable:!1,configurable:!0}),Object.defineProperty(yo.prototype,"Ve",{get:function(){return 0!==this.Ae},enumerable:!1,configurable:!0}),Object.defineProperty(yo.prototype,"pe",{get:function(){return this.ge},enumerable:!1,configurable:!0}),yo.prototype.be=function(t){0<t.o()&&(this.ge=!0,this.Pe=t)},yo.prototype.ve=function(){var n=eo(),r=eo(),i=eo();return this.Re.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Cr()}}),new uo(this.Pe,this.ye,n,r,i)},yo.prototype.Se=function(){this.ge=!1,this.Re=Io()},yo.prototype.De=function(t,e){this.ge=!0,this.Re=this.Re.At(t,e)},yo.prototype.Ce=function(t){this.ge=!0,this.Re=this.Re.remove(t)},yo.prototype.xe=function(){this.Ae+=1},yo.prototype.Ne=function(){--this.Ae},yo.prototype.Fe=function(){this.ge=!0,this.ye=!0},yo),lo=(po.prototype.Be=function(t){for(var e=0,n=t.Te;e<n.length;e++){var r=n[e];t.me instanceof vu?this.qe(r,t.me):t.me instanceof gu&&this.Ue(r,t.key,t.me)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.Ue(r,t.key,t.me)},po.prototype.Qe=function(n){var r=this;this.Ke(n,function(t){var e=r.We(t);switch(n.state){case 0:r.je(t)&&e.be(n.resumeToken);break;case 1:e.Ne(),e.Ve||e.Se(),e.be(n.resumeToken);break;case 2:e.Ne(),e.Ve||r.removeTarget(t);break;case 3:r.je(t)&&(e.Fe(),e.be(n.resumeToken));break;case 4:r.je(t)&&(r.Ge(t),e.be(n.resumeToken));break;default:Cr()}})},po.prototype.Ke=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.ke.forEach(function(t,e){r.je(e)&&n(e)})},po.prototype.ze=function(t){var e=t.targetId,n=t.Ie.count,t=this.He(e);t&&(Ri(t=t.target)?0===n?(t=new yi(t.path),this.Ue(e,t,new gu(t,fi.min()))):Vr(1===n):this.Je(e)!==n&&(this.Ge(e),this.Le=this.Le.add(e)))},po.prototype.Ye=function(r){var i=this,o=new Map;this.ke.forEach(function(t,e){var n=i.He(e);n&&(t.fe&&Ri(n.target)&&(n=new yi(n.target.path),null!==i.Me.get(n)||i.Xe(e,n)||i.Ue(e,n,new gu(n,r))),t.pe&&(o.set(e,t.ve()),t.Se()))});var s=eo();this.$e.forEach(function(t,e){var n=!0;e.Gt(function(t){t=i.He(t);return!t||2===t.dt||(n=!1)}),n&&(s=s.add(t))});var t=new so(r,o,this.Le,this.Me,s);return this.Me=Xi,this.$e=Eo(),this.Le=new Wi(jr),t},po.prototype.qe=function(t,e){var n;this.je(t)&&(n=this.Xe(t,e.key)?2:0,this.We(t).De(e.key,n),this.Me=this.Me.At(e.key,e),this.$e=this.$e.At(e.key,this.Ze(e.key).add(t)))},po.prototype.Ue=function(t,e,n){var r;this.je(t)&&(r=this.We(t),this.Xe(t,e)?r.De(e,1):r.Ce(e),this.$e=this.$e.At(e,this.Ze(e).delete(t)),n&&(this.Me=this.Me.At(e,n)))},po.prototype.removeTarget=function(t){this.ke.delete(t)},po.prototype.Je=function(t){var e=this.We(t).ve();return this.Oe.tn(t).size+e.de.size-e.Ee.size},po.prototype.xe=function(t){this.We(t).xe()},po.prototype.We=function(t){var e=this.ke.get(t);return e||(e=new fo,this.ke.set(t,e)),e},po.prototype.Ze=function(t){var e=this.$e.get(t);return e||(e=new Wi(jr),this.$e=this.$e.At(t,e)),e},po.prototype.je=function(t){var e=null!==this.He(t);return e||kr("WatchChangeAggregator","Detected inactive target",t),e},po.prototype.He=function(t){var e=this.ke.get(t);return e&&e.Ve?null:this.Oe.en(t)},po.prototype.Ge=function(e){var n=this;this.ke.set(e,new fo),this.Oe.tn(e).forEach(function(t){n.Ue(e,t,null)})},po.prototype.Xe=function(t,e){return this.Oe.tn(t).has(e)},po);function po(t){this.Oe=t,this.ke=new Map,this.Me=Xi,this.$e=Eo(),this.Le=new Wi(jr)}function yo(){this.Ae=0,this.Re=Io(),this.Pe=Br.h,this.ye=!1,this.ge=!0}function vo(t,e,n,r,i){this.resumeToken=t,this.fe=e,this.de=n,this.we=r,this.Ee=i}function go(t,e,n,r,i){this.wt=t,this.ce=e,this.ae=n,this.ue=r,this.he=i}function mo(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.ne=n,this.docChanges=r,this.se=i,this.fromCache=o,this.ie=s,this.re=u}function wo(){this.te=new qi(yi.K)}function bo(n){this.K=n?function(t,e){return n(t,e)||yi.K(t.key,e.key)}:function(t,e){return yi.K(t.key,e.key)},this.Yt=Ji,this.Xt=new qi(this.K)}function Eo(){return new qi(yi.K)}function Io(){return new qi(yi.K)}function To(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function _o(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Ao(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function No(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function xo(t){t=Co(t.mapValue.fields.__local_write_time__.timestampValue);return new hi(t.seconds,t.nanos)}var So=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Do(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?No(t)?4:10:Cr()}function Oo(r,i){var t,e=Do(r);if(e!==Do(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return xo(r).isEqual(xo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Co(r.timestampValue),t=Co(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,Mo(r.bytesValue).isEqual(Mo(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Vo((t=r).geoPointValue.latitude)===Vo(e.geoPointValue.latitude)&&Vo(t.geoPointValue.longitude)===Vo(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Vo(t.integerValue)===Vo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=Vo(t.doubleValue),e=Vo(e.doubleValue);return t===e?xi(t)===xi(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return qr(r.arrayValue.values||[],i.arrayValue.values||[],Oo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(To(e)!==To(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!Oo(e[t],n[t])))return!1;return!0}();default:return Cr()}}function ko(t,e){return void 0!==(t.values||[]).find(function(t){return Oo(t,e)})}function Po(t,e){var n,r,i=Do(t),o=Do(e);if(i!==o)return jr(i,o);switch(i){case 0:return 0;case 1:return jr(t.booleanValue,e.booleanValue);case 2:return n=e,r=Vo(t.integerValue||t.doubleValue),n=Vo(n.integerValue||n.doubleValue),r<n?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return Ro(t.timestampValue,e.timestampValue);case 4:return Ro(xo(t),xo(e));case 5:return jr(t.stringValue,e.stringValue);case 6:return function(t,e){t=Mo(t),e=Mo(e);return t.u(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=jr(n[i],r[i]);if(0!==o)return o}return jr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=jr(Vo(i.latitude),Vo(r.latitude)))?n:jr(Vo(i.longitude),Vo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Po(n[i],r[i]);if(o)return o}return jr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=jr(r[s],o[s]);if(0!==u)return u;u=Po(n[r[s]],i[o[s]]);if(0!==u)return u}return jr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Cr()}}function Ro(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return jr(t,e);var n=Co(t),t=Co(e),e=jr(n.seconds,t.seconds);return 0!==e?e:jr(n.nanos,t.nanos)}function Lo(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=Co(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Mo(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,yi.ut(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):Cr();var e}(t)}function Co(t){if(Vr(!!t),"string"!=typeof t)return{seconds:Vo(t.seconds),nanos:Vo(t.nanos)};var e=0,n=So.exec(t);Vr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Vo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Mo(t){return"string"==typeof t?Br.fromBase64String(t):Br.fromUint8Array(t)}function Uo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.et()}}function jo(t){return t&&"integerValue"in t}function qo(t){return!!t&&"arrayValue"in t}function Fo(t){return t&&"nullValue"in t}function Bo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function zo(t){return t&&"mapValue"in t}var Go={asc:"ASCENDING",desc:"DESCENDING"},Ko={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ho=function(t,e){this.T=t,this.nn=e};function Wo(t){return{integerValue:""+t}}function Yo(t,e){if(t.nn){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:xi(e)?"-0":e}}function Xo(t,e){return Si(e)?Wo(e):Yo(t,e)}function Zo(t,e){return t.nn?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Qo(t,e){return t.nn?e.toBase64():e.toUint8Array()}function Jo(t){return Vr(!!t),fi.L((t=Co(t),new hi(t.seconds,t.nanos)))}function $o(t,e){return new li(["projects",t.projectId,"databases",t.database]).child("documents").child(e).et()}function ts(t){t=li.nt(t);return Vr(ws(t)),t}function es(t,e){return $o(t.T,e.path)}function ns(t,e){e=ts(e);if(e.get(1)!==t.T.projectId)throw new Nr(Ar.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.T.projectId);if(e.get(3)!==t.T.database)throw new Nr(Ar.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.T.database);return new yi(ss(e))}function rs(t,e){return $o(t.T,e)}function is(t){t=ts(t);return 4===t.length?li.st():ss(t)}function os(t){return new li(["projects",t.T.projectId,"databases",t.T.database]).et()}function ss(t){return Vr(4<t.length&&"documents"===t.get(4)),t.j(5)}function us(t,e,n){return{name:es(t,e),fields:n.proto.mapValue.fields}}function as(t,e,n){var r=ns(t,e.name),t=Jo(e.updateTime),e=new uu({mapValue:{fields:e.fields}});return new vu(r,t,e,{hasCommittedMutations:!!n})}function cs(t,e){var n,r,i;if(e instanceof Xs)n={update:us(t,e.key,e.value)};else if(e instanceof ou)n={delete:es(t,e.key)};else if(e instanceof Zs)n={update:us(t,e.key,e.data),updateMask:(i=e.sn,r=[],i.fields.forEach(function(t){return r.push(t.et())}),{fieldPaths:r})};else{if(!(e instanceof su))return Cr();n={verify:es(t,e.key)}}return 0<e.fieldTransforms.length&&(n.updateTransforms=e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Ts)return{fieldPath:t.field.et(),setToServerValue:"REQUEST_TIME"};if(e instanceof _s)return{fieldPath:t.field.et(),appendMissingElements:{values:e.elements}};if(e instanceof Ds)return{fieldPath:t.field.et(),removeAllFromArray:{values:e.elements}};if(e instanceof Rs)return{fieldPath:t.field.et(),increment:e.rn};throw Cr()})),e.cn.on||(n.currentDocument=void 0!==(i=e.cn).updateTime?{updateTime:(e=t,t=i.updateTime,Zo(e,t.q()))}:void 0!==i.exists?{exists:i.exists}:Cr()),n}function hs(e,t){var n=t.currentDocument?void 0!==(s=t.currentDocument).updateTime?Fs.updateTime(Jo(s.updateTime)):void 0!==s.exists?Fs.exists(s.exists):Fs.an():Fs.an(),r=t.updateTransforms?t.updateTransforms.map(function(t){return function(t,e){var n,r=null;"setToServerValue"in e?(Vr("REQUEST_TIME"===e.setToServerValue),r=new Ts):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],r=new _s(n)):"removeAllFromArray"in e?(n=e.removeAllFromArray.values||[],r=new Ds(n)):"increment"in e?r=new Rs(t,e.increment):Cr();e=di.ct(e.fieldPath);return new Us(e,r)}(e,t)}):[];if(t.update){t.update.name;var i=ns(e,t.update.name),o=new uu({mapValue:{fields:t.update.fields}});if(t.updateMask){var s=(s=t.updateMask.fieldPaths||[],new Ms(s.map(function(t){return di.ct(t)})));return new Zs(i,o,s,n,r)}return new Xs(i,o,n,r)}if(t.delete){r=ns(e,t.delete);return new ou(r,n)}if(t.verify){t=ns(e,t.verify);return new su(t,n)}return Cr()}function fs(t,e){return{documents:[rs(t,e.path)]}}function ls(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=rs(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=rs(t,r.G()),n.structuredQuery.from=[{collectionId:r.J()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(Bo(t.value))return{unaryFilter:{field:vs(t.field),op:"IS_NAN"}};if(Fo(t.value))return{unaryFilter:{field:vs(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Bo(t.value))return{unaryFilter:{field:vs(t.field),op:"IS_NOT_NAN"}};if(Fo(t.value))return{unaryFilter:{field:vs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:vs(t.field),op:(e=t.op,Ko[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:vs((t=t).field),direction:(t=t.dir,Go[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.nn||Ni(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=ds(e.startAt)),e.endAt&&(n.structuredQuery.endAt=ds(e.endAt)),n}function ps(t){var e=is(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Vr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[ms(t)]:void 0!==t.fieldFilter?[(n=t,ju.create(gs(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Cr()}}(),n.fieldFilter.value))]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):Cr():[];var n}(n.where));t=[];n.orderBy&&(t=n.orderBy.map(function(t){return new pa(gs((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));r=null;n.limit&&(r=Ni(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=ys(n.startAt));var u=null;return n.endAt&&(u=ys(n.endAt)),Tu(e,i,t,o,r,"F",s,u)}function ds(t){return{before:t.before,values:t.position}}function ys(t){var e=!!t.before,t=t.values||[];return new oa(t,e)}function vs(t){return{fieldPath:t.et()}}function gs(t){return di.ct(t.fieldPath)}function ms(t){switch(t.unaryFilter.op){case"IS_NAN":var e=gs(t.unaryFilter.field);return ju.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=gs(t.unaryFilter.field);return ju.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":n=gs(t.unaryFilter.field);return ju.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":t=gs(t.unaryFilter.field);return ju.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Cr()}}function ws(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}o=function(){this.un=void 0};function bs(t,e){return t instanceof Rs?jo(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var Es,Is,Ts=(h(Ns,Is=o),Ns),_s=(h(As,Es=o),As);function As(t){var e=this;return(e=Es.call(this)||this).elements=t,e}function Ns(){return null!==Is&&Is.apply(this,arguments)||this}function xs(t,e){for(var n=Vs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return Oo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var Ss,Ds=(h(Os,Ss=o),Os);function Os(t){var e=this;return(e=Ss.call(this)||this).elements=t,e}function ks(t,e){for(var n=Vs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!Oo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var Ps,Rs=(h(Ls,Ps=o),Ls);function Ls(t,e){var n=this;return(n=Ps.call(this)||this).serializer=t,n.rn=e,n}function Cs(t){return Vo(t.integerValue||t.doubleValue)}function Vs(t){return qo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Ms=(js.prototype.hn=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].X(t))return!0;return!1},js.prototype.isEqual=function(t){return qr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},js),Us=function(t,e){this.field=t,this.transform=e};function js(t){(this.fields=t).sort(di.K)}function qs(t,e){this.version=t,this.transformResults=e}var Fs=(Bs.an=function(){return new Bs},Bs.exists=function(t){return new Bs(void 0,t)},Bs.updateTime=function(t){return new Bs(t)},Object.defineProperty(Bs.prototype,"on",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Bs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Bs);function Bs(t,e){this.updateTime=t,this.exists=e}function zs(t,e){return void 0!==t.updateTime?e instanceof vu&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof vu}Ie=function(){};function Gs(t,e,n,r){return t instanceof Xs?function(t,e,n,r){if(!zs(t.cn,e))return e;var i=t.value;t.fieldTransforms&&(r=eu(t.fieldTransforms,n,e,r),i=nu(t.fieldTransforms,i,r));e=Hs(e);return new vu(t.key,e,i,{ln:!0})}(t,e,r,n):t instanceof Zs?function(t,e,n,r){if(!zs(t.cn,e))return e;var i=Hs(e),r=$s(t,e,eu(t.fieldTransforms,n,e,r));return new vu(t.key,i,r,{ln:!0})}(t,e,r,n):(e=e,zs((t=t).cn,e)?new gu(t.key,fi.min()):e)}function Ks(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.cn.isEqual(e.cn)&&(n=t.fieldTransforms,r=e.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&qr(n,r,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof _s&&e instanceof _s||t instanceof Ds&&e instanceof Ds?qr(t.elements,e.elements,Oo):t instanceof Rs&&e instanceof Rs?Oo(t.rn,e.rn):t instanceof Ts&&e instanceof Ts)})))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.sn.isEqual(e.sn));var n,r}function Hs(t){return t instanceof vu?t.version:fi.min()}var Ws,Ys,Xs=(h(Js,Ys=Ie),Js),Zs=(h(Qs,Ws=Ie),Qs);function Qs(t,e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=Ws.call(this)||this).key=t,o.data=e,o.sn=n,o.cn=r,o.fieldTransforms=i,o.type=1,o}function Js(t,e,n,r){void 0===r&&(r=[]);var i=this;return(i=Ys.call(this)||this).key=t,i.value=e,i.cn=n,i.fieldTransforms=r,i.type=0,i}function $s(t,e,n){var r,i,o;return i=t,e=r=e instanceof vu?e.data():uu.empty(),o=new au(e),i.sn.fields.forEach(function(t){var e;t.Y()||(null!==(e=i.data.field(t))?o.set(t,e):o.delete(t))}),r=o._n(),nu(t.fieldTransforms,r,n)}function tu(t,e,n){var r=[];Vr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof vu&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof _s?xs(o,s):o instanceof Ds?ks(o,s):u))}return r}function eu(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],c=a.transform,h=null;n instanceof vu&&(h=n.field(a.field)),null===h&&r instanceof vu&&(h=r.field(a.field)),o.push((i=h,a=e,h=void 0,(c=c)instanceof Ts?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(h.fields.__previous_value__=i),{mapValue:h}):c instanceof _s?xs(c,i):c instanceof Ds?ks(c,i):(c=bs(h=c,i),i=Cs(c)+Cs(h.rn),jo(c)&&jo(h.rn)?Wo(i):Yo(h.serializer,i))))}return o}function nu(t,e,n){for(var r=new au(e),i=0;i<t.length;i++){var o=t[i];r.set(o.field,n[i])}return r._n()}var ru,iu,ou=(h(lu,iu=Ie),lu),su=(h(fu,ru=Ie),fu),uu=(hu.empty=function(){return new hu({mapValue:{}})},hu.prototype.field=function(t){if(t.Y())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!zo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.J()])||null},hu.prototype.isEqual=function(t){return Oo(this.proto,t.proto)},hu),au=(cu.prototype.set=function(t,e){return this.wn(t,e),this},cu.prototype.delete=function(t){return this.wn(t,null),this},cu.prototype.wn=function(t,e){for(var n=this.dn,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===Do(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.J(),e)},cu.prototype._n=function(){var t=this.En(di.st(),this.dn);return null!=t?new uu(t):this.fn},cu.prototype.En=function(r,t){var i=this,o=!1,e=this.fn.field(r),s=zo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.En(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},cu);function cu(t){void 0===t&&(t=uu.empty()),this.fn=t,this.dn=new Map}function hu(t){this.proto=t}function fu(t,e){var n=this;return(n=ru.call(this)||this).key=t,n.cn=e,n.type=3,n.fieldTransforms=[],n}function lu(t,e){var n=this;return(n=iu.call(this)||this).key=t,n.cn=e,n.type=2,n.fieldTransforms=[],n}var pu,du,yu,Te=function(t,e){this.key=t,this.version=e},vu=(h(Iu,yu=Te),Iu.prototype.field=function(t){return this.Tn.field(t)},Iu.prototype.data=function(){return this.Tn},Iu.prototype.mn=function(){return this.Tn.proto},Iu.prototype.isEqual=function(t){return t instanceof Iu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.ln===t.ln&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Tn.isEqual(t.Tn)},Iu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Tn.toString()+", {hasLocalMutations: "+this.ln+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Iu.prototype,"hasPendingWrites",{get:function(){return this.ln||this.hasCommittedMutations},enumerable:!1,configurable:!0}),Iu),gu=(h(Eu,du=Te),Eu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Eu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Eu.prototype.isEqual=function(t){return t instanceof Eu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Eu),mu=(h(bu,pu=Te),bu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(bu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),bu.prototype.isEqual=function(t){return t instanceof bu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},bu),wu=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.In=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.An=null,this.Rn=null,this.startAt,this.endAt};function bu(){return null!==pu&&pu.apply(this,arguments)||this}function Eu(t,e,n){var r=this;return(r=du.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function Iu(t,e,n,r){var i=this;return(i=yu.call(this,t,e)||this).Tn=n,i.ln=!!r.ln,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function Tu(t,e,n,r,i,o,s,u){return new wu(t,e,n,r,i,o,s,u)}function _u(t){return new wu(t)}function Au(t){return!Ni(t.limit)&&"F"===t.limitType}function Nu(t){return!Ni(t.limit)&&"L"===t.limitType}function xu(t){return 0<t.In.length?t.In[0].field:null}function Su(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.Pn())return r.field}return null}function Du(t){return null!==t.collectionGroup}function Ou(t){var e=t;if(null===e.An){e.An=[];var n=Su(e),t=xu(e);if(null!==n&&null===t)n.rt()||e.An.push(new pa(n)),e.An.push(new pa(di.ot(),"asc"));else{for(var r=!1,i=0,o=e.In;i<o.length;i++){var s=o[i];e.An.push(s),s.field.rt()&&(r=!0)}r||(n=0<e.In.length?e.In[e.In.length-1].dir:"asc",e.An.push(new pa(di.ot(),n)))}}return e.An}function ku(t){var e=t;if(!e.Rn)if("F"===e.limitType)e.Rn=Oi(e.path,e.collectionGroup,Ou(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Ou(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new pa(o.field,s))}var u=e.endAt?new oa(e.endAt.position,!e.endAt.before):null,t=e.startAt?new oa(e.startAt.position,!e.startAt.before):null;e.Rn=Oi(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.Rn}function Pu(t,e,n){return new wu(t.path,t.collectionGroup,t.In.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ru(t,e){return Pi(ku(t),ku(e))&&t.limitType===e.limitType}function Lu(t){return ki(ku(t))+"|lt:"+t.limitType}function Cu(t){return"Query(target="+(e=ku(t),n=e.path.et(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.et()+" "+t.op+" "+Lo(t.value)}).join(", ")+"]"),Ni(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.et()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+ha(e.startAt)),e.endAt&&(n+=", endAt: "+ha(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function Vu(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.ht(e.collectionGroup)&&e.path.X(n):yi.lt(e.path)?e.path.isEqual(n):e.path.Z(n))&&function(t){for(var e=0,n=i.In;e<n.length;e++){var r=n[e];if(!r.field.rt()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||fa(t.startAt,Ou(t),n))&&(!t.endAt||!fa(t.endAt,Ou(t),n)));var e,n}function Mu(u){return function(t,e){for(var n=!1,r=0,i=Ou(u);r<i.length;r++){var o=i[r],s=function(t,r,e){e=t.field.rt()?yi.K(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?Po(n,t):Cr()}(t.field,e);switch(t.dir){case"asc":return e;case"desc":return-1*e;default:return Cr()}}(o,t,e);if(0!==s)return s;n=n||o.field.rt()}return 0}}var Uu,ju=(h(qu,Uu=function(){}),qu.create=function(t,e,n){return t.rt()?"in"===e||"not-in"===e?this.yn(t,e,n):new Gu(t,e,n):"array-contains"===e?new ea(t,n):"in"===e?new na(t,n):"not-in"===e?new ra(t,n):"array-contains-any"===e?new ia(t,n):new qu(t,e,n)},qu.yn=function(t,e,n){return new("in"===e?Ku:Hu)(t,n)},qu.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this.gn(Po(t,this.value)):null!==t&&Do(this.value)===Do(t)&&this.gn(Po(t,this.value))},qu.prototype.gn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Cr()}},qu.prototype.Pn=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},qu);function qu(t,e,n){var r=this;return(r=Uu.call(this)||this).field=t,r.op=e,r.value=n,r}var Fu,Bu,zu,Gu=(h(Xu,zu=ju),Xu.prototype.matches=function(t){t=yi.K(t.key,this.key);return this.gn(t)},Xu),Ku=(h(Yu,Bu=ju),Yu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Yu),Hu=(h(Wu,Fu=ju),Wu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Wu);function Wu(t,e){var n=this;return(n=Fu.call(this,t,"not-in",e)||this).keys=Zu(0,e),n}function Yu(t,e){var n=this;return(n=Bu.call(this,t,"in",e)||this).keys=Zu(0,e),n}function Xu(t,e,n){var r=this;return(r=zu.call(this,t,e,n)||this).key=yi.ut(n.referenceValue),r}function Zu(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return yi.ut(t.referenceValue)})}var Qu,Ju,$u,ta,ea=(h(ca,ta=ju),ca.prototype.matches=function(t){t=t.field(this.field);return qo(t)&&ko(t.arrayValue,this.value)},ca),na=(h(aa,$u=ju),aa.prototype.matches=function(t){t=t.field(this.field);return null!==t&&ko(this.value.arrayValue,t)},aa),ra=(h(ua,Ju=ju),ua.prototype.matches=function(t){if(ko(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!ko(this.value.arrayValue,t)},ua),ia=(h(sa,Qu=ju),sa.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!qo(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return ko(e.value.arrayValue,t)})},sa),oa=function(t,e){this.position=t,this.before=e};function sa(t,e){return Qu.call(this,t,"array-contains-any",e)||this}function ua(t,e){return Ju.call(this,t,"not-in",e)||this}function aa(t,e){return $u.call(this,t,"in",e)||this}function ca(t,e){return ta.call(this,t,"array-contains",e)||this}function ha(t){return(t.before?"b":"a")+":"+t.position.map(Lo).join(",")}function fa(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.rt()?yi.K(yi.ut(s.referenceValue),n.key):Po(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function la(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Oo(t.position[n],e.position[n]))return!1;return!0}var pa=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};var da=(Oa.prototype.pn=function(t,e,n){for(var r,i,o,s,u,a,c=n.bn,h=0;h<this.mutations.length;h++){var f=this.mutations[h];f.key.isEqual(t)&&(r=f,i=e,o=c[h],f=a=u=s=void 0,e=r instanceof Xs?(u=o,f=(s=r).value,u.transformResults&&(a=tu(s.fieldTransforms,i,u.transformResults),f=nu(s.fieldTransforms,f,a)),new vu(s.key,u.version,f,{hasCommittedMutations:!0})):r instanceof Zs?function(t,e,n){if(!zs(t.cn,e))return new mu(t.key,n.version);e=$s(t,e,n.transformResults?tu(t.fieldTransforms,e,n.transformResults):[]);return new vu(t.key,n.version,e,{hasCommittedMutations:!0})}(r,i,o):new gu(r.key,o.version,{hasCommittedMutations:!0}))}return e},Oa.prototype.vn=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Gs(i,e,e,this.Vn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Gs(a,e,o,this.Vn))}return e},Oa.prototype.Sn=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.vn(t.key,n.get(t.key));e&&(i=i.At(t.key,e))}),i},Oa.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},eo())},Oa.prototype.isEqual=function(t){return this.batchId===t.batchId&&qr(this.mutations,t.mutations,Ks)&&qr(this.baseMutations,t.baseMutations,Ks)},Oa),ya=(Da.from=function(t,e,n){Vr(t.mutations.length===n.length);for(var r=$i,i=t.mutations,o=0;o<i.length;o++)r=r.At(i[o].key,n[o].version);return new Da(t,e,n,r)},Da),va=(Sa.prototype.get=function(t){var e=this.xn(t),e=this.Fn[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.Nn(o,t))return i}},Sa.prototype.has=function(t){return void 0!==this.get(t)},Sa.prototype.set=function(t,e){var n=this.xn(t),r=this.Fn[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.Nn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.Fn[n]=[[t,e]]},Sa.prototype.delete=function(t){var e=this.xn(t),n=this.Fn[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.Nn(n[r][0],t))return 1===n.length?delete this.Fn[e]:n.splice(r,1),!0;return!1},Sa.prototype.forEach=function(s){_o(this.Fn,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},Sa.prototype.Y=function(){return Ao(this.Fn)},Sa),ga=(xa.prototype.catch=function(t){return this.next(void 0,t)},xa.prototype.next=function(r,i){var o=this;return this.$n&&Cr(),this.$n=!0,this.Mn?this.error?this.Ln(i,this.error):this.Bn(r,this.result):new xa(function(e,n){o.On=function(t){o.Bn(r,t).next(e,n)},o.kn=function(t){o.Ln(i,t).next(e,n)}})},xa.prototype.qn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},xa.prototype.Un=function(t){try{var e=t();return e instanceof xa?e:xa.resolve(e)}catch(t){return xa.reject(t)}},xa.prototype.Bn=function(t,e){return t?this.Un(function(){return t(e)}):xa.resolve(e)},xa.prototype.Ln=function(t,e){return t?this.Un(function(){return t(e)}):xa.reject(e)},xa.resolve=function(n){return new xa(function(t,e){t(n)})},xa.reject=function(n){return new xa(function(t,e){e(n)})},xa.Qn=function(t){return new xa(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},xa.Kn=function(t){for(var n=xa.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?xa.resolve(t):e()})}(r[e]);return n},xa.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Qn(i)},xa),o=(Na.prototype.Gn=function(t){t=this.Wn.get(t);return t?t.readTime:fi.min()},Na.prototype.zn=function(t,e){this.Hn(),this.Wn.set(t.key,{Jn:t,readTime:e})},Na.prototype.Yn=function(t,e){void 0===e&&(e=null),this.Hn(),this.Wn.set(t,{Jn:null,readTime:e})},Na.prototype.Xn=function(t,e){this.Hn();var n=this.Wn.get(e);return void 0!==n?ga.resolve(n.Jn):this.Zn(t,e)},Na.prototype.getEntries=function(t,e){return this.ts(t,e)},Na.prototype.apply=function(t){return this.Hn(),this.jn=!0,this.es(t)},Na.prototype.Hn=function(){},Na),ma="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ie=(Aa.prototype.ss=function(t){this.ns.push(t)},Aa.prototype.rs=function(){this.ns.forEach(function(t){return t()})},Aa),wa=(_a.prototype.hs=function(e,n){var r=this;return this.cs.ls(e,n).next(function(t){return r._s(e,n,t)})},_a.prototype._s=function(t,r,i){return this.os.Xn(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].vn(r,t);return t})},_a.prototype.fs=function(t,e,i){var o=Xi;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].vn(t,e);o=o.At(t,e)}),o},_a.prototype.ds=function(e,t){var n=this;return this.os.getEntries(e,t).next(function(t){return n.ws(e,t)})},_a.prototype.ws=function(e,r){var i=this;return this.cs.Es(e,r).next(function(t){var t=i.fs(e,r,t),n=Xi;return t.forEach(function(t,e){e=e||new gu(t,fi.min()),n=n.At(t,e)}),n})},_a.prototype.Ts=function(t,e,n){return r=e,yi.lt(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Is(t,e.path):Du(e)?this.As(t,e,n):this.Rs(t,e,n);var r},_a.prototype.Is=function(t,e){return this.hs(t,new yi(e)).next(function(t){var e=Ji;return t instanceof vu&&(e=e.At(t.key,t)),e})},_a.prototype.As=function(n,r,i){var o=this,s=r.collectionGroup,u=Ji;return this.us.Ps(n,s).next(function(t){return ga.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new wu(t,null,e.In.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.Rs(n,e,i).next(function(t){t.forEach(function(t,e){u=u.At(t,e)})})}).next(function(){return u})})},_a.prototype.Rs=function(e,n,t){var c,h,r=this;return this.os.Ts(e,n,t).next(function(t){return c=t,r.cs.ys(e,n)}).next(function(t){return h=t,r.gs(e,h,c).next(function(t){c=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),a=Gs(s,a,a,r.Vn);c=a instanceof vu?c.At(u,a):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){Vu(n,e)||(c=c.remove(t))}),c})},_a.prototype.gs=function(t,e,n){for(var r=eo(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Zs&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.os.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof vu&&(c=c.At(t,e))}),c})},_a),ba=(Ta.bs=function(t,e){for(var n=eo(),r=eo(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Ta(t,e.fromCache,n,r)},Ta),Ea=(Ia.prototype.Ss=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Ia.prototype.next=function(){var t=++this.previousValue;return this.Ds&&this.Ds(t),t},Ia);function Ia(t,e){var n=this;this.previousValue=t,e&&(e.vs=function(t){return n.Ss(t)},this.Ds=function(t){return e.Cs(t)})}function Ta(t,e,n,r){this.targetId=t,this.fromCache=e,this.Vs=n,this.ps=r}function _a(t,e,n){this.os=t,this.cs=e,this.us=n}function Aa(){this.ns=[]}function Na(){this.Wn=new va(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.jn=!1}function xa(t){var e=this;this.On=null,this.kn=null,this.result=void 0,this.error=void 0,this.Mn=!1,this.$n=!1,t(function(t){e.Mn=!0,e.result=t,e.On&&e.On(t)},function(t){e.Mn=!0,e.error=t,e.kn&&e.kn(t)})}function Sa(t,e){this.xn=t,this.Nn=e,this.Fn={}}function Da(t,e,n,r){this.batch=t,this.Dn=e,this.bn=n,this.Cn=r}function Oa(t,e,n,r){this.batchId=t,this.Vn=e,this.baseMutations=n,this.mutations=r}Ea.xs=-1;var ka,Pa=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})},Ra=(qa.prototype.reset=function(){this.$s=0},qa.prototype.qs=function(){this.$s=this.Ms},qa.prototype.Us=function(t){var e=this;this.cancel();var n=Math.floor(this.$s+this.Qs()),r=Math.max(0,Date.now()-this.Bs),i=Math.max(0,n-r);0<i&&kr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.$s+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ls=this.Ns.Ks(this.Fs,i,function(){return e.Bs=Date.now(),t()}),this.$s*=this.ks,this.$s<this.Os&&(this.$s=this.Os),this.$s>this.Ms&&(this.$s=this.Ms)},qa.prototype.Ws=function(){null!==this.Ls&&(this.Ls.js(),this.Ls=null)},qa.prototype.cancel=function(){null!==this.Ls&&(this.Ls.cancel(),this.Ls=null)},qa.prototype.Qs=function(){return(Math.random()-.5)*this.$s},qa),La=(ja.delete=function(t){return kr("SimpleDb","Removing database:",t),Ha(window.indexedDB.deleteDatabase(t)).qn()},ja.Hs=function(){if("undefined"==typeof indexedDB)return!1;if(ja.Js())return!0;var t=p(),e=ja.zs(t),n=0<e&&e<10,e=ja.Ys(t),e=0<e&&e<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||e)},ja.Js=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Xs)},ja.Zs=function(t,e){return t.store(e)},ja.zs=function(t){t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),t=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(t)},ja.Ys=function(t){t=t.match(/Android ([\d.]+)/i),t=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(t)},ja.prototype.ti=function(o){return y(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(kr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(t){t=t.target.result;e(t)},r.onblocked=function(){n(new Va(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){t=t.target.error;"VersionError"===t.name?n(new Nr(Ar.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new Va(o,t))},r.onupgradeneeded=function(t){kr("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;i.Gs.createOrUpgrade(e,r.transaction,t.oldVersion,i.version).next(function(){kr("SimpleDb","Database upgrade to version "+i.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.ei&&(this.db.onversionchange=function(t){return i.ei(t)}),this.db)]}})})},ja.prototype.ni=function(e){this.ei=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},ja.prototype.runTransaction=function(u,n,a,c){return y(this,void 0,void 0,function(){var i,o,s,e;return v(this,function(t){switch(t.label){case 0:i="readonly"===n,o=0,e=function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.ti(u)];case 2:return s.db=t.sent(),e=Ba.open(s.db,u,i?"readonly":"readwrite",a),n=c(e).catch(function(t){return e.abort(t),ga.reject(t)}).qn(),r={},n.catch(function(){}),[4,e.si];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return n=t.sent(),r="FirebaseError"!==n.name&&o<3,kr("SimpleDb","Transaction failed with error:",n.message,"Retrying:",r),s.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},s=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(e=t.sent()))return[2,e.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},ja.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},ja),Ca=(Object.defineProperty(Ua.prototype,"Mn",{get:function(){return this.ri},enumerable:!1,configurable:!0}),Object.defineProperty(Ua.prototype,"ci",{get:function(){return this.oi},enumerable:!1,configurable:!0}),Object.defineProperty(Ua.prototype,"cursor",{set:function(t){this.ii=t},enumerable:!1,configurable:!0}),Ua.prototype.done=function(){this.ri=!0},Ua.prototype.ai=function(t){this.oi=t},Ua.prototype.delete=function(){return Ha(this.ii.delete())},Ua),Va=(h(Ma,ka=Nr),Ma);function Ma(t,e){var n=this;return(n=ka.call(this,Ar.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function Ua(t){this.ii=t,this.ri=!1,this.oi=null}function ja(t,e,n){this.name=t,this.version=e,this.Gs=n,12.2===ja.zs(p())&&Pr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function qa(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Ns=t,this.Fs=e,this.Os=n,this.ks=r,this.Ms=i,this.$s=0,this.Ls=null,this.Bs=Date.now(),this.reset()}function Fa(t){return"IndexedDbTransactionError"===t.name}var Ba=(Ka.open=function(t,e,n,r){try{return new Ka(e,t.transaction(r,n))}catch(t){throw new Va(e,t)}},Object.defineProperty(Ka.prototype,"si",{get:function(){return this.ui.promise},enumerable:!1,configurable:!0}),Ka.prototype.abort=function(t){t&&this.ui.reject(t),this.aborted||(kr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Ka.prototype.store=function(t){t=this.transaction.objectStore(t);return new za(t)},Ka),za=(Ga.prototype.put=function(t,e){t=void 0!==e?(kr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(kr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t));return Ha(t)},Ga.prototype.add=function(t){return kr("SimpleDb","ADD",this.store.name,t,t),Ha(this.store.add(t))},Ga.prototype.get=function(e){var n=this;return Ha(this.store.get(e)).next(function(t){return void 0===t&&(t=null),kr("SimpleDb","GET",n.store.name,e,t),t})},Ga.prototype.delete=function(t){return kr("SimpleDb","DELETE",this.store.name,t),Ha(this.store.delete(t))},Ga.prototype.count=function(){return kr("SimpleDb","COUNT",this.store.name),Ha(this.store.count())},Ga.prototype.hi=function(t,e){var e=this.cursor(this.options(t,e)),n=[];return this.li(e,function(t,e){n.push(e)}).next(function(){return n})},Ga.prototype._i=function(t,e){kr("SimpleDb","DELETE ALL",this.store.name);e=this.options(t,e);e.fi=!1;e=this.cursor(e);return this.li(e,function(t,e,n){return n.delete()})},Ga.prototype.di=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.li(n,e)},Ga.prototype.wi=function(r){var t=this.cursor({});return new ga(function(n,e){t.onerror=function(t){t=Ya(t.target.error);e(t)},t.onsuccess=function(t){var e=t.target.result;e?r(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},Ga.prototype.li=function(t,i){var o=[];return new ga(function(r,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n=t.target.result;n?(e=new Ca(n),(t=i(n.primaryKey,n.value,e))instanceof ga&&(t=t.catch(function(t){return e.done(),ga.reject(t)}),o.push(t)),e.Mn?r():null===e.ci?n.continue():n.continue(e.ci)):r()}}).next(function(){return ga.Qn(o)})},Ga.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},Ga.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.fi?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},Ga);function Ga(t){this.store=t}function Ka(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.ui=new Pa,this.transaction.oncomplete=function(){n.ui.resolve()},this.transaction.onabort=function(){t.error?n.ui.reject(new Va(e,t.error)):n.ui.resolve()},this.transaction.onerror=function(t){t=Ya(t.target.error);n.ui.reject(new Va(e,t))}}function Ha(t){return new ga(function(e,n){t.onsuccess=function(t){t=t.target.result;e(t)},t.onerror=function(t){t=Ya(t.target.error);n(t)}})}var Wa=!1;function Ya(t){var e=La.zs(p());if(12.2<=e&&e<13){e="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(e)){var n=new Nr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Wa||(Wa=!0,setTimeout(function(){throw n},0)),n}}return t}function Xa(){return"undefined"!=typeof window?window:null}function Za(){return"undefined"!=typeof document?document:null}var Qa=(tc.Ai=function(t,e,n,r,i){i=new tc(t,e,Date.now()+n,r,i);return i.start(n),i},tc.prototype.start=function(t){var e=this;this.Ri=setTimeout(function(){return e.Pi()},t)},tc.prototype.js=function(){return this.Pi()},tc.prototype.cancel=function(t){null!==this.Ri&&(this.clearTimeout(),this.Ii.reject(new Nr(Ar.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},tc.prototype.Pi=function(){var e=this;this.Ei.yi(function(){return null!==e.Ri?(e.clearTimeout(),e.op().then(function(t){return e.Ii.resolve(t)})):Promise.resolve()})},tc.prototype.clearTimeout=function(){null!==this.Ri&&(this.mi(this),clearTimeout(this.Ri),this.Ri=null)},tc),Ja=(Object.defineProperty($a.prototype,"Ni",{get:function(){return this.pi},enumerable:!1,configurable:!0}),$a.prototype.yi=function(t){this.enqueue(t)},$a.prototype.Fi=function(t){this.Oi(),this.ki(t)},$a.prototype.Mi=function(){var t;this.pi||(this.pi=!0,(t=Za())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.xi))},$a.prototype.enqueue=function(t){return this.Oi(),this.pi?new Promise(function(t){}):this.ki(t)},$a.prototype.$i=function(t){var e=this;this.yi(function(){return e.Vi.push(t),e.Li()})},$a.prototype.Li=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Vi.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Vi[0]()];case 2:return t.sent(),this.Vi.shift(),this.Ci.reset(),[3,4];case 3:if(!Fa(e=t.sent()))throw e;return kr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Vi.length&&this.Ci.Us(function(){return n.Li()}),t.label=5;case 5:return[2]}})})},$a.prototype.ki=function(t){var r=this,e=this.gi.then(function(){return r.Si=!0,t().catch(function(t){throw r.vi=t,r.Si=!1,Pr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Si=!1,t})});return this.gi=e},$a.prototype.Ks=function(t,e,n){var r=this;this.Oi(),-1<this.Di.indexOf(t)&&(e=0);n=Qa.Ai(this,t,e,n,function(t){return r.Bi(t)});return this.bi.push(n),n},$a.prototype.Oi=function(){this.vi&&Cr()},$a.prototype.qi=function(){},$a.prototype.Ui=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.gi];case 1:t.sent(),t.label=2;case 2:if(e!==this.gi)return[3,0];t.label=3;case 3:return[2]}})})},$a.prototype.Qi=function(t){for(var e=0,n=this.bi;e<n.length;e++)if(n[e].Fs===t)return!0;return!1},$a.prototype.Ki=function(r){var i=this;return this.Ui().then(function(){i.bi.sort(function(t,e){return t.Ti-e.Ti});for(var t=0,e=i.bi;t<e.length;t++){var n=e[t];if(n.js(),"all"!==r&&n.Fs===r)break}return i.Ui()})},$a.prototype.Wi=function(t){this.Di.push(t)},$a.prototype.Bi=function(t){t=this.bi.indexOf(t);this.bi.splice(t,1)},$a);function $a(){var e=this;this.gi=Promise.resolve(),this.Vi=[],this.pi=!1,this.bi=[],this.vi=null,this.Si=!1,this.Di=[],this.Ci=new Ra(this,"async_queue_retry"),this.xi=function(){var t=Za();t&&kr("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Ci.Ws()};var t=Za();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.xi)}function tc(t,e,n,r,i){this.Ei=t,this.Fs=e,this.Ti=n,this.op=r,this.mi=i,this.Ii=new Pa,this.then=this.Ii.promise.then.bind(this.Ii.promise),this.Ii.promise.catch(function(t){})}function ec(t,e){if(Pr("AsyncQueue",e+": "+t),Fa(t))return new Nr(Ar.UNAVAILABLE,e+": "+t);throw t}function nc(t,e){var n=t[0],r=t[1],t=e[0],e=e[1],t=jr(n,t);return 0===t?jr(r,e):t}var rc=(uc.prototype.zi=function(){return++this.Gi},uc.prototype.Hi=function(t){var e=[t,this.zi()];this.buffer.size<this.ji?this.buffer=this.buffer.add(e):nc(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(uc.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),uc),ic={Ji:!1,Yi:0,Xi:0,Zi:0},oc=(sc.sr=function(t){return new sc(t,sc.ir,sc.rr)},sc);function sc(t,e,n){this.tr=t,this.er=e,this.nr=n}function uc(t){this.ji=t,this.buffer=new Wi(nc),this.Gi=0}oc.ir=10,oc.rr=1e3,oc.cr=new oc(41943040,oc.ir,oc.rr),oc.ar=new oc(-1,0,0);var ac=(pc.prototype.start=function(t){-1!==this.ur.params.tr&&this._r(t)},pc.prototype.stop=function(){this.lr&&(this.lr.cancel(),this.lr=null)},Object.defineProperty(pc.prototype,"dr",{get:function(){return null!==this.lr},enumerable:!1,configurable:!0}),pc.prototype._r=function(n){var t=this,e=this.hr?3e5:6e4;kr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.lr=this.Ei.Ks("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.lr=null,this.hr=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.wr(this.ur)];case 2:return t.sent(),[3,7];case 3:return Fa(e=t.sent())?(kr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,yf(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this._r(n)];case 8:return t.sent(),[2]}})})})},pc),cc=(lc.prototype.Tr=function(t,e){return this.Er.mr(t).next(function(t){return Math.floor(e/100*t)})},lc.prototype.Ir=function(t,e){var n=this;if(0===e)return ga.resolve(Ea.xs);var r=new rc(e);return this.Er.Ke(t,function(t){return r.Hi(t.sequenceNumber)}).next(function(){return n.Er.Ar(t,function(t){return r.Hi(t)})}).next(function(){return r.maxValue})},lc.prototype.Rr=function(t,e,n){return this.Er.Rr(t,e,n)},lc.prototype.Pr=function(t,e){return this.Er.Pr(t,e)},lc.prototype.yr=function(e,n){var r=this;return-1===this.params.tr?(kr("LruGarbageCollector","Garbage collection skipped; disabled"),ga.resolve(ic)):this.gr(e).next(function(t){return t<r.params.tr?(kr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.tr),ic):r.Vr(e,n)})},lc.prototype.gr=function(t){return this.Er.gr(t)},lc.prototype.Vr=function(e,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.Tr(e,this.params.er).next(function(t){return i=t>h.params.nr?(kr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.nr+" from "+t),h.params.nr):t,s=Date.now(),h.Ir(e,i)}).next(function(t){return r=t,u=Date.now(),h.Rr(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.Pr(e,r)}).next(function(t){return c=Date.now(),Or()<=l.DEBUG&&kr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),ga.resolve({Ji:!0,Yi:i,Xi:o,Zi:t})})},lc),hc=(fc.prototype.pr=function(t){this.br=t},fc.prototype.Ts=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.In.length||1===r.In.length&&r.In[0].field.rt())||i.isEqual(fi.min())?this.vr(e,r):this.br.ds(e,o).next(function(t){var n=s.Sr(r,t);return(Au(r)||Nu(r))&&s.Dr(r.limitType,n,o,i)?s.vr(e,r):(Or()<=l.DEBUG&&kr("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Cu(r)),s.br.Ts(e,r,i).next(function(e){return n.forEach(function(t){e=e.At(t.key,t)}),e}))})},fc.prototype.Sr=function(n,t){var r=new Wi(Mu(n));return t.forEach(function(t,e){e instanceof vu&&Vu(n,e)&&(r=r.add(e))}),r},fc.prototype.Dr=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.u(r))},fc.prototype.vr=function(t,e){return Or()<=l.DEBUG&&kr("QueryEngine","Using full collection scan to execute query:",Cu(e)),this.br.Ts(t,e,fi.min())},fc);function fc(){}function lc(t,e){this.Er=t,this.params=e}function pc(t,e){this.ur=t,this.Ei=e,this.hr=!1,this.lr=null}function dc(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=yc(e)),e=function(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}(t.get(n),e);return yc(e)}function yc(t){return t+"\x01\x01"}function vc(t){var e=t.length;if(Vr(2<=e),2===e)return Vr("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),li.st();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||n<s)&&Cr(),t.charAt(s+1)){case"\x01":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:Cr()}o=s+2}return new li(r)}var gc=function(t){this.Cr=t};function mc(t,e){if(e.document)return as(t.Cr,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=yi._t(e.noDocument.path),r=Tc(e.noDocument.readTime);return new gu(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){n=yi._t(e.unknownDocument.path),r=Tc(e.unknownDocument.version);return new mu(n,r)}return Cr()}function wc(t,e,n){var r=bc(n),n=e.key.path.G().tt();if(e instanceof vu){var i={name:es(o=t.Cr,(s=e).key),fields:s.mn().mapValue.fields,updateTime:Zo(o,s.version.q())},o=e.hasCommittedMutations;return new ih(null,null,i,o,r,n)}if(e instanceof gu){var s=e.key.path.tt(),i=Ic(e.version),o=e.hasCommittedMutations;return new ih(null,new nh(s,i),null,o,r,n)}if(e instanceof mu){o=e.key.path.tt(),e=Ic(e.version);return new ih(new rh(o,e),null,null,!0,r,n)}return Cr()}function bc(t){t=t.q();return[t.seconds,t.nanoseconds]}function Ec(t){t=new hi(t[0],t[1]);return fi.L(t)}function Ic(t){t=t.q();return new Wc(t.seconds,t.nanoseconds)}function Tc(t){t=new hi(t.seconds,t.nanoseconds);return fi.L(t)}function _c(e,t){for(var n=(t.baseMutations||[]).map(function(t){return hs(e.Cr,t)}),r=t.mutations.length-1;0<=r;--r){var i=t.mutations[r];void 0!==(null==i?void 0:i.transform)&&(t.mutations[r-1].updateTransforms=i.transform.fieldTransforms,t.mutations.splice(r,1),--r)}var o=t.mutations.map(function(t){return hs(e.Cr,t)}),s=hi.fromMillis(t.localWriteTimeMs);return new da(t.batchId,s,n,o)}function Ac(t){var e=Tc(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?Tc(t.lastLimboFreeSnapshotVersion):fi.min(),r=void 0!==t.query.documents?(Vr(1===(r=t.query).documents.length),ku(_u(is(r.documents[0])))):ku(ps(t.query));return new Vi(r,t.targetId,0,t.lastListenSequenceNumber,e,n,Br.fromBase64String(t.resumeToken))}function Nc(t,e){var n=Ic(e.wt),r=Ic(e.lastLimboFreeSnapshotVersion),i=(Ri(e.target)?fs:ls)(t.Cr,e.target),t=e.resumeToken.toBase64();return new sh(e.targetId,ki(e.target),n,t,e.sequenceNumber,r,i)}function xc(t){var e=ps({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Pu(e,e.limit,"L"):e}var Sc=(Dc.Or=function(t,e,n,r){return Vr(""!==t.uid),new Dc(t.A()?t.uid:"",e,n,r)},Dc.prototype.kr=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Pc(t).di({index:$c.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},Dc.prototype.Mr=function(d,y,v,g){var m=this,w=Rc(d),b=Pc(d);return b.add({}).next(function(t){Vr("number"==typeof t);for(var e,n,r,i,o,s=new da(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return cs(e.Cr,t)}),o=r.mutations.map(function(t){return cs(e.Cr,t)}),new $c(n,r.batchId,r.Vn.toMillis(),i,o)),a=[],c=new Wi(function(t,e){return jr(t.et(),e.et())}),h=0,f=g;h<f.length;h++){var l=f[h],p=th.key(m.userId,l.key.path,t),c=c.add(l.key.path.G());a.push(b.put(u)),a.push(w.put(p,th.PLACEHOLDER))}return c.forEach(function(t){a.push(m.us.$r(d,t))}),d.ss(function(){m.Fr[t]=s.keys()}),ga.Qn(a).next(function(){return s})})},Dc.prototype.Lr=function(t,e){var n=this;return Pc(t).get(e).next(function(t){return t?(Vr(t.userId===n.userId),_c(n.serializer,t)):null})},Dc.prototype.Br=function(t,e){var n=this;return this.Fr[e]?ga.resolve(this.Fr[e]):this.Lr(t,e).next(function(t){if(t){t=t.keys();return n.Fr[e]=t}return null})},Dc.prototype.qr=function(t,e){var r=this,i=e+1,e=IDBKeyRange.lowerBound([this.userId,i]),o=null;return Pc(t).di({index:$c.userMutationsIndex,range:e},function(t,e,n){e.userId===r.userId&&(Vr(e.batchId>=i),o=_c(r.serializer,e)),n.done()}).next(function(){return o})},Dc.prototype.Ur=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Pc(t).di({index:$c.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},Dc.prototype.Qr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Pc(t).hi($c.userMutationsIndex,n).next(function(t){return t.map(function(t){return _c(e.serializer,t)})})},Dc.prototype.ls=function(o,s){var u=this,t=th.prefixForPath(this.userId,s.path),t=IDBKeyRange.lowerBound(t),a=[];return Rc(o).di({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=vc(i);if(r===u.userId&&s.path.isEqual(i))return Pc(o).get(t).next(function(t){if(!t)throw Cr();Vr(t.userId===u.userId),a.push(_c(u.serializer,t))});n.done()}).next(function(){return a})},Dc.prototype.Es=function(e,t){var s=this,u=new Wi(jr),n=[];return t.forEach(function(o){var t=th.prefixForPath(s.userId,o.path),t=IDBKeyRange.lowerBound(t),t=Rc(e).di({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=vc(i);r===s.userId&&o.path.isEqual(i)?u=u.add(t):n.done()});n.push(t)}),ga.Qn(n).next(function(){return s.Kr(e,u)})},Dc.prototype.ys=function(t,e){var o=this,s=e.path,u=s.length+1,e=th.prefixForPath(this.userId,s),e=IDBKeyRange.lowerBound(e),a=new Wi(jr);return Rc(t).di({range:e},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=vc(i);r===o.userId&&s.X(i)?i.length===u&&(a=a.add(t)):n.done()}).next(function(){return o.Kr(t,a)})},Dc.prototype.Kr=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(Pc(e).get(t).next(function(t){if(null===t)throw Cr();Vr(t.userId===n.userId),r.push(_c(n.serializer,t))}))}),ga.Qn(i).next(function(){return r})},Dc.prototype.Wr=function(e,n){var r=this;return kc(e.jr,this.userId,n).next(function(t){return e.ss(function(){r.Gr(n.batchId)}),ga.forEach(t,function(t){return r.Nr.zr(e,t)})})},Dc.prototype.Gr=function(t){delete this.Fr[t]},Dc.prototype.Hr=function(e){var i=this;return this.kr(e).next(function(t){if(!t)return ga.resolve();var t=IDBKeyRange.lowerBound(th.prefixForUser(i.userId)),r=[];return Rc(e).di({range:t},function(t,e,n){t[0]===i.userId?(t=vc(t[1]),r.push(t)):n.done()}).next(function(){Vr(0===r.length)})})},Dc.prototype.Jr=function(t,e){return Oc(t,this.userId,e)},Dc.prototype.Yr=function(t){var e=this;return Lc(t).get(this.userId).next(function(t){return t||new Jc(e.userId,-1,"")})},Dc);function Dc(t,e,n,r){this.userId=t,this.serializer=e,this.us=n,this.Nr=r,this.Fr={}}function Oc(t,o,e){var e=th.prefixForPath(o,e.path),s=e[1],e=IDBKeyRange.lowerBound(e),u=!1;return Rc(t).di({range:e,fi:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function kc(t,e,n){var r=t.store($c.store),i=t.store(th.store),o=[],t=IDBKeyRange.only(n.batchId),s=0,t=r.di({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){Vr(1===s)}));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],f=th.key(e,h.key.path,n.batchId);o.push(i.delete(f)),u.push(h.key)}return ga.Qn(o).next(function(){return u})}function Pc(t){return Ph.Zs(t,$c.store)}function Rc(t){return Ph.Zs(t,th.store)}function Lc(t){return Ph.Zs(t,Jc.store)}var Cc,Vc=(jc.prototype.zn=function(t,e,n){return Fc(t).put(Bc(e),n)},jc.prototype.Yn=function(t,e){t=Fc(t),e=Bc(e);return t.delete(e)},jc.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.Xr(e,t)})},jc.prototype.Xn=function(t,e){var n=this;return Fc(t).get(Bc(e)).next(function(t){return n.Zr(t)})},jc.prototype.eo=function(t,e){var n=this;return Fc(t).get(Bc(e)).next(function(t){var e=n.Zr(t);return e?{Jn:e,size:zc(t)}:null})},jc.prototype.getEntries=function(t,e){var n=this,r=Xi;return this.no(t,e,function(t,e){e=n.Zr(e);r=r.At(t,e)}).next(function(){return r})},jc.prototype.so=function(t,e){var r=this,i=Xi,o=new qi(yi.K);return this.no(t,e,function(t,e){var n=r.Zr(e);o=n?(i=i.At(t,n),o.At(t,zc(e))):(i=i.At(t,null),o.At(t,0))}).next(function(){return{io:i,ro:o}})},jc.prototype.no=function(t,e,i){if(e.Y())return ga.resolve();var n=IDBKeyRange.bound(e.first().path.tt(),e.last().path.tt()),o=e.bt(),s=o.Nt();return Fc(t).di({range:n},function(t,e,n){for(var r=yi._t(t);s&&yi.K(s,r)<0;)i(s,null),s=o.Nt();s&&s.isEqual(r)&&(i(s,e),s=o.Ft()?o.Nt():null),s?n.ai(s.path.tt()):n.done()}).next(function(){for(;s;)i(s,null),s=o.Ft()?o.Nt():null})},jc.prototype.Ts=function(t,r,e){var n,i=this,o=Ji,s=r.path.length+1,u={};return e.isEqual(fi.min())?(n=r.path.tt(),u.range=IDBKeyRange.lowerBound(n)):(n=r.path.tt(),e=bc(e),u.range=IDBKeyRange.lowerBound([n,e],!0),u.index=ih.collectionReadTimeIndex),Fc(t).di(u,function(t,e,n){t.length===s&&(e=mc(i.serializer,e),r.path.X(e.key.path)?e instanceof vu&&Vu(r,e)&&(o=o.At(e.key,e)):n.done())}).next(function(){return o})},jc.prototype.oo=function(t){return new Mc(this,!!t&&t.co)},jc.prototype.ao=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},jc.prototype.getMetadata=function(t){return qc(t).get(oh.key).next(function(t){return Vr(!!t),t})},jc.prototype.Xr=function(t,e){return qc(t).put(oh.key,e)},jc.prototype.Zr=function(t){if(t){t=mc(this.serializer,t);return t instanceof gu&&t.version.isEqual(fi.min())?null:t}return null},jc),Mc=(h(Uc,Cc=o),Uc.prototype.es=function(i){var o=this,s=[],u=0,a=new Wi(function(t,e){return jr(t.et(),e.et())});return this.Wn.forEach(function(t,e){var n,r=o.ho.get(t);e.Jn?(n=wc(o.uo.serializer,e.Jn,o.Gn(t)),a=a.add(t.path.G()),e=zc(n),u+=e-r,s.push(o.uo.zn(i,t,n))):(u-=r,o.co?(r=wc(o.uo.serializer,new gu(t,fi.min()),o.Gn(t)),s.push(o.uo.zn(i,t,r))):s.push(o.uo.Yn(i,t)))}),a.forEach(function(t){s.push(o.uo.us.$r(i,t))}),s.push(this.uo.updateMetadata(i,u)),ga.Qn(s)},Uc.prototype.Zn=function(t,e){var n=this;return this.uo.eo(t,e).next(function(t){return null===t?(n.ho.set(e,0),null):(n.ho.set(e,t.size),t.Jn)})},Uc.prototype.ts=function(t,e){var n=this;return this.uo.so(t,e).next(function(t){var e=t.io;return t.ro.forEach(function(t,e){n.ho.set(t,e)}),e})},Uc);function Uc(t,e){var n=this;return(n=Cc.call(this)||this).uo=t,n.co=e,n.ho=new va(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function jc(t,e){this.serializer=t,this.us=e}function qc(t){return Ph.Zs(t,oh.store)}function Fc(t){return Ph.Zs(t,ih.store)}function Bc(t){return t.path.tt()}function zc(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Cr();e=t.noDocument}return JSON.stringify(e).length}var Gc=(Qc.prototype.$r=function(t,e){return this.lo.add(e),ga.resolve()},Qc.prototype.Ps=function(t,e){return ga.resolve(this.lo.getEntries(e))},Qc),Kc=(Zc.prototype.add=function(t){var e=t.J(),n=t.G(),r=this.index[e]||new Wi(li.K),t=!r.has(n);return this.index[e]=r.add(n),t},Zc.prototype.has=function(t){var e=t.J(),t=t.G(),e=this.index[e];return e&&e.has(t)},Zc.prototype.getEntries=function(t){return(this.index[t]||new Wi(li.K)).tt()},Zc),Hc=(Xc.prototype.createOrUpgrade=function(e,n,t,r){var i=this;Vr(t<r&&0<=t&&r<=11);var o=new Ba("createOrUpgrade",n);t<1&&1<=r&&(e.createObjectStore(Yc.store),(s=e).createObjectStore(Jc.store,{keyPath:Jc.keyPath}),s.createObjectStore($c.store,{keyPath:$c.keyPath,autoIncrement:!0}).createIndex($c.userMutationsIndex,$c.userMutationsKeyPath,{unique:!0}),s.createObjectStore(th.store),hh(e),e.createObjectStore(ih.store));var s,u=ga.resolve();return t<3&&3<=r&&(0!==t&&((s=e).deleteObjectStore(uh.store),s.deleteObjectStore(sh.store),s.deleteObjectStore(ah.store),hh(e)),u=u.next(function(){return t=o.store(ah.store),e=new ah(0,0,fi.min().q(),0),t.put(ah.key,e);var t,e})),t<4&&4<=r&&(0!==t&&(u=u.next(function(){return n=e,(r=o).store($c.store).hi().next(function(t){n.deleteObjectStore($c.store),n.createObjectStore($c.store,{keyPath:$c.keyPath,autoIncrement:!0}).createIndex($c.userMutationsIndex,$c.userMutationsKeyPath,{unique:!0});var e=r.store($c.store),t=t.map(function(t){return e.put(t)});return ga.Qn(t)});var n,r})),u=u.next(function(){e.createObjectStore(fh.store,{keyPath:fh.keyPath})})),t<5&&5<=r&&(u=u.next(function(){return i.removeAcknowledgedMutations(o)})),t<6&&6<=r&&(u=u.next(function(){return e.createObjectStore(oh.store),i.addDocumentGlobal(o)})),t<7&&7<=r&&(u=u.next(function(){return i.ensureSequenceNumbers(o)})),t<8&&8<=r&&(u=u.next(function(){return i.createCollectionParentIndex(e,o)})),t<9&&9<=r&&(u=u.next(function(){var t;(t=e).objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(t=n.objectStore(ih.store)).createIndex(ih.readTimeIndex,ih.readTimeIndexPath,{unique:!1}),t.createIndex(ih.collectionReadTimeIndex,ih.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=r&&(u=u.next(function(){return i.rewriteCanonicalIds(o)})),t<11&&11<=r&&(u=u.next(function(){e.createObjectStore(lh.store,{keyPath:lh.keyPath}),e.createObjectStore(ph.store,{keyPath:ph.keyPath})})),u},Xc.prototype.addDocumentGlobal=function(e){var n=0;return e.store(ih.store).di(function(t,e){n+=zc(e)}).next(function(){var t=new oh(n);return e.store(oh.store).put(oh.key,t)})},Xc.prototype.removeAcknowledgedMutations=function(n){var r=this,t=n.store(Jc.store),i=n.store($c.store);return t.hi().next(function(t){return ga.forEach(t,function(e){var t=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return i.hi($c.userMutationsIndex,t).next(function(t){return ga.forEach(t,function(t){Vr(t.userId===e.userId);t=_c(r.serializer,t);return kc(n,e.userId,t).next(function(){})})})})})},Xc.prototype.ensureSequenceNumbers=function(t){var o=t.store(uh.store),e=t.store(ih.store);return t.store(ah.store).get(ah.key).next(function(r){var i=[];return e.di(function(t,e){var n=new li(t),t=[0,dc(n)];i.push(o.get(t).next(function(t){return t?ga.resolve():o.put(new uh(0,dc(n),r.highestListenSequenceNumber))}))}).next(function(){return ga.Qn(i)})})},Xc.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(ch.store,{keyPath:ch.keyPath});function r(t){if(i.add(t)){var e=t.J(),t=t.G();return n.put({collectionId:e,parent:dc(t)})}}var n=e.store(ch.store),i=new Kc;return e.store(ih.store).di({fi:!0},function(t,e){t=new li(t);return r(t.G())}).next(function(){return e.store(th.store).di({fi:!0},function(t,e){t[0];var n=t[1],n=(t[2],vc(n));return r(n.G())})})},Xc.prototype.rewriteCanonicalIds=function(t){var n=this,r=t.store(sh.store);return r.di(function(t,e){e=Ac(e),e=Nc(n.serializer,e);return r.put(e)})},Xc),Wc=function(t,e){this.seconds=t,this.nanoseconds=e},Yc=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function Xc(t){this.serializer=t}function Zc(){this.index={}}function Qc(){this.lo=new Kc}Yc.store="owner",Yc.key="owner";var Jc=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Jc.store="mutationQueues",Jc.keyPath="userId";var $c=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};$c.store="mutations",$c.keyPath="batchId",$c.userMutationsIndex="userMutationsIndex",$c.userMutationsKeyPath=["userId","batchId"];var th=(eh.prefixForUser=function(t){return[t]},eh.prefixForPath=function(t,e){return[t,dc(e)]},eh.key=function(t,e,n){return[t,dc(e),n]},eh);function eh(){}th.store="documentMutations",th.PLACEHOLDER=new th;var nh=function(t,e){this.path=t,this.readTime=e},rh=function(t,e){this.path=t,this.version=e},ih=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};ih.store="remoteDocuments",ih.readTimeIndex="readTimeIndex",ih.readTimeIndexPath="readTime",ih.collectionReadTimeIndex="collectionReadTimeIndex",ih.collectionReadTimeIndexPath=["parentPath","readTime"];var oh=function(t){this.byteSize=t};oh.store="remoteDocumentGlobal",oh.key="remoteDocumentGlobalKey";var sh=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};sh.store="targets",sh.keyPath="targetId",sh.queryTargetsIndexName="queryTargetsIndex",sh.queryTargetsKeyPath=["canonicalId","targetId"];var uh=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};uh.store="targetDocuments",uh.keyPath=["targetId","path"],uh.documentTargetsIndex="documentTargetsIndex",uh.documentTargetsKeyPath=["path","targetId"];var ah=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};ah.key="targetGlobalKey",ah.store="targetGlobal";var ch=function(t,e){this.collectionId=t,this.parent=e};function hh(t){t.createObjectStore(uh.store,{keyPath:uh.keyPath}).createIndex(uh.documentTargetsIndex,uh.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(sh.store,{keyPath:sh.keyPath}).createIndex(sh.queryTargetsIndexName,sh.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(ah.store)}ch.store="collectionParents",ch.keyPath=["collectionId","parent"];var fh=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};fh.store="clientMetadata",fh.keyPath="clientId";var lh=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};lh.store="bundles",lh.keyPath="bundleId";var ph=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};ph.store="namedQueries",ph.keyPath="name";var dh=f(f(f(f([Jc.store,$c.store,th.store,ih.store,sh.store,Yc.store,ah.store,uh.store],[fh.store]),[oh.store]),[ch.store]),[lh.store,ph.store]),yh=(vh.prototype._o=function(t,e){return gh(t).get(e).next(function(t){if(t)return{id:(t=t).bundleId,createTime:Tc(t.createTime),version:t.version}})},vh.prototype.fo=function(t,e){return gh(t).put({bundleId:(e=e).id,createTime:Ic(Jo(e.createTime)),version:e.version})},vh.prototype.wo=function(t,e){return mh(t).get(e).next(function(t){if(t)return{name:(t=t).name,query:xc(t.bundledQuery),readTime:Tc(t.readTime)}})},vh.prototype.Eo=function(t,e){return mh(t).put({name:(e=e).name,readTime:Ic(Jo(e.readTime)),bundledQuery:e.bundledQuery})},vh);function vh(t){this.serializer=t}function gh(t){return Ph.Zs(t,lh.store)}function mh(t){return Ph.Zs(t,ph.store)}var wh=(bh.prototype.$r=function(t,e){var n=this;if(this.To.has(e))return ga.resolve();var r=e.J(),i=e.G();t.ss(function(){n.To.add(e)});i={collectionId:r,parent:dc(i)};return Eh(t).put(i)},bh.prototype.Ps=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Fr(i),""],!1,!0);return Eh(t).hi(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(vc(r.parent))}return o})},bh);function bh(){this.To=new Kc}function Eh(t){return Ph.Zs(t,ch.store)}var Ih=(Ah.prototype.next=function(){return this.mo+=2,this.mo},Ah.Io=function(){return new Ah(0)},Ah.Ao=function(){return new Ah(-1)},Ah),Th=(_h.prototype.Ro=function(n){var r=this;return this.Po(n).next(function(t){var e=new Ih(t.highestTargetId);return t.highestTargetId=e.next(),r.yo(n,t).next(function(){return t.highestTargetId})})},_h.prototype.Vo=function(t){return this.Po(t).next(function(t){return fi.L(new hi(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},_h.prototype.po=function(t){return this.Po(t).next(function(t){return t.highestListenSequenceNumber})},_h.prototype.bo=function(e,n,r){var i=this;return this.Po(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.q()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.yo(e,t)})},_h.prototype.vo=function(e,n){var r=this;return this.So(e,n).next(function(){return r.Po(e).next(function(t){return t.targetCount+=1,r.Do(n,t),r.yo(e,t)})})},_h.prototype.Co=function(t,e){return this.So(t,e)},_h.prototype.xo=function(e,t){var n=this;return this.No(e,t.targetId).next(function(){return Nh(e).delete(t.targetId)}).next(function(){return n.Po(e)}).next(function(t){return Vr(0<t.targetCount),--t.targetCount,n.yo(e,t)})},_h.prototype.Rr=function(n,r,i){var o=this,s=0,u=[];return Nh(n).di(function(t,e){e=Ac(e);e.sequenceNumber<=r&&null===i.get(e.targetId)&&(s++,u.push(o.xo(n,e)))}).next(function(){return ga.Qn(u)}).next(function(){return s})},_h.prototype.Ke=function(t,n){return Nh(t).di(function(t,e){e=Ac(e);n(e)})},_h.prototype.Po=function(t){return xh(t).get(ah.key).next(function(t){return Vr(null!==t),t})},_h.prototype.yo=function(t,e){return xh(t).put(ah.key,e)},_h.prototype.So=function(t,e){return Nh(t).put(Nc(this.serializer,e))},_h.prototype.Do=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},_h.prototype.Fo=function(t){return this.Po(t).next(function(t){return t.targetCount})},_h.prototype.Oo=function(t,r){var e=ki(r),e=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),i=null;return Nh(t).di({range:e,index:sh.queryTargetsIndexName},function(t,e,n){e=Ac(e);Pi(r,e.target)&&(i=e,n.done())}).next(function(){return i})},_h.prototype.ko=function(n,t,r){var i=this,o=[],s=Sh(n);return t.forEach(function(t){var e=dc(t.path);o.push(s.put(new uh(r,e))),o.push(i.Nr.Mo(n,r,t))}),ga.Qn(o)},_h.prototype.$o=function(n,t,r){var i=this,o=Sh(n);return ga.forEach(t,function(t){var e=dc(t.path);return ga.Qn([o.delete([r,e]),i.Nr.Lo(n,r,t)])})},_h.prototype.No=function(t,e){t=Sh(t),e=IDBKeyRange.bound([e],[e+1],!1,!0);return t.delete(e)},_h.prototype.Bo=function(t,e){var e=IDBKeyRange.bound([e],[e+1],!1,!0),t=Sh(t),r=eo();return t.di({range:e,fi:!0},function(t,e,n){t=vc(t[1]),t=new yi(t);r=r.add(t)}).next(function(){return r})},_h.prototype.Jr=function(t,e){var e=dc(e.path),e=IDBKeyRange.bound([e],[Fr(e)],!1,!0),i=0;return Sh(t).di({index:uh.documentTargetsIndex,fi:!0,range:e},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},_h.prototype.en=function(t,e){return Nh(t).get(e).next(function(t){return t?Ac(t):null})},_h);function _h(t,e){this.Nr=t,this.serializer=e}function Ah(t){this.mo=t}function Nh(t){return Ph.Zs(t,sh.store)}function xh(t){return Ph.Zs(t,ah.store)}function Sh(t){return Ph.Zs(t,uh.store)}var Dh,Oh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",kh=(h(Lh,Dh=Ie),Lh),Ph=(Rh.Zs=function(t,e){if(t instanceof kh)return La.Zs(t.jr,e);throw Cr()},Rh.prototype.start=function(){var e=this;return this.nc().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Nr(Ar.FAILED_PRECONDITION,Oh);return e.sc(),e.ic(),e.rc(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.Zo.po(t)})}).then(function(t){e.Ko=new Ea(t,e.Uo)}).then(function(){e.Wo=!0}).catch(function(t){return e.Xo&&e.Xo.close(),Promise.reject(t)})},Rh.prototype.oc=function(n){var t=this;return this.Jo=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.dr?[2,n(e)]:[2]})})},n(this.isPrimary)},Rh.prototype.cc=function(n){var t=this;this.Xo.ni(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},Rh.prototype.ac=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Ns.yi(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.dr?[4,this.nc()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},Rh.prototype.nc=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return Vh(e).put(new fh(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.uc(e).next(function(t){t||(n.isPrimary=!1,n.Ns.$i(function(){return n.Jo(!1)}))})}).next(function(){return n.hc(e)}).next(function(t){return n.isPrimary&&!t?n.lc(e).next(function(){return!1}):!!t&&n._c(e).next(function(){return!0})})}).catch(function(t){if(Fa(t))return kr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return kr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.Ns.$i(function(){return n.Jo(t)}),n.isPrimary=t})},Rh.prototype.uc=function(t){var e=this;return Ch(t).get(Yc.key).next(function(t){return ga.resolve(e.fc(t))})},Rh.prototype.dc=function(t){return Vh(t).delete(this.clientId)},Rh.prototype.wc=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.Ec(this.Ho,18e5)?[3,2]:(this.Ho=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=Rh.Zs(t,fh.store);return r.hi().next(function(t){var e=o.Tc(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return ga.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.ec)for(n=0,r=e;n<r.length;n++)i=r[n],this.ec.removeItem(this.mc(i.clientId));t.label=2;case 2:return[2]}})})},Rh.prototype.rc=function(){var t=this;this.zo=this.Ns.Ks("client_metadata_refresh",4e3,function(){return t.nc().then(function(){return t.wc()}).then(function(){return t.rc()})})},Rh.prototype.fc=function(t){return!!t&&t.ownerId===this.clientId},Rh.prototype.hc=function(e){var r=this;return this.Qo?ga.resolve(!0):Ch(e).get(Yc.key).next(function(t){if(null!==t&&r.Ec(t.leaseTimestampMs,5e3)&&!r.Ic(t.ownerId)){if(r.fc(t)&&r.networkEnabled)return!0;if(!r.fc(t)){if(!t.allowTabSynchronization)throw new Nr(Ar.FAILED_PRECONDITION,Oh);return!1}}return!(!r.networkEnabled||!r.inForeground)||Vh(e).hi().next(function(t){return void 0===r.Tc(t,5e3).find(function(t){if(r.clientId!==t.clientId){var e=!r.networkEnabled&&t.networkEnabled,n=!r.inForeground&&t.inForeground,t=r.networkEnabled===t.networkEnabled;if(e||n&&t)return!0}return!1})})}).next(function(t){return r.isPrimary!==t&&kr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},Rh.prototype.Ac=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return this.Wo=!1,this.Rc(),this.zo&&(this.zo.cancel(),this.zo=null),this.Pc(),this.yc(),[4,this.Xo.runTransaction("shutdown","readwrite",[Yc.store,fh.store],function(t){var e=new kh(t,Ea.xs);return n.lc(e).next(function(){return n.dc(e)})})];case 1:return t.sent(),this.Xo.close(),this.gc(),[2]}})})},Rh.prototype.Tc=function(t,e){var n=this;return t.filter(function(t){return n.Ec(t.updateTimeMs,e)&&!n.Ic(t.clientId)})},Rh.prototype.Vc=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return Vh(t).hi().next(function(t){return e.Tc(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(Rh.prototype,"dr",{get:function(){return this.Wo},enumerable:!1,configurable:!0}),Rh.prototype.bc=function(t){return Sc.Or(t,this.serializer,this.us,this.Nr)},Rh.prototype.vc=function(){return this.Zo},Rh.prototype.Sc=function(){return this.os},Rh.prototype.Dc=function(){return this.us},Rh.prototype.Cc=function(){return this.tc},Rh.prototype.runTransaction=function(e,n,r){var i=this;kr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Xo.runTransaction(e,t,dh,function(t){return o=new kh(t,i.Ko?i.Ko.next():Ea.xs),"readwrite-primary"===n?i.uc(o).next(function(t){return!!t||i.hc(o)}).next(function(t){if(!t)throw Pr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.Ns.$i(function(){return i.Jo(!1)}),new Nr(Ar.FAILED_PRECONDITION,ma);return r(o)}).next(function(t){return i._c(o).next(function(){return t})}):i.xc(o).next(function(){return r(o)})}).then(function(t){return o.rs(),t})},Rh.prototype.xc=function(t){var e=this;return Ch(t).get(Yc.key).next(function(t){if(null!==t&&e.Ec(t.leaseTimestampMs,5e3)&&!e.Ic(t.ownerId)&&!e.fc(t)&&!(e.Qo||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Nr(Ar.FAILED_PRECONDITION,Oh)})},Rh.prototype._c=function(t){var e=new Yc(this.clientId,this.allowTabSynchronization,Date.now());return Ch(t).put(Yc.key,e)},Rh.Hs=function(){return La.Hs()},Rh.prototype.lc=function(t){var e=this,n=Ch(t);return n.get(Yc.key).next(function(t){return e.fc(t)?(kr("IndexedDbPersistence","Releasing primary lease."),n.delete(Yc.key)):ga.resolve()})},Rh.prototype.Ec=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Pr("Detected an update time that is in the future: "+t+" > "+n),1))},Rh.prototype.sc=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Go=function(){t.Ns.yi(function(){return t.inForeground="visible"===t.document.visibilityState,t.nc()})},this.document.addEventListener("visibilitychange",this.Go),this.inForeground="visible"===this.document.visibilityState)},Rh.prototype.Pc=function(){this.Go&&(this.document.removeEventListener("visibilitychange",this.Go),this.Go=null)},Rh.prototype.ic=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.jo=function(){e.Rc(),e.Ns.yi(function(){return e.Ac()})},this.window.addEventListener("unload",this.jo))},Rh.prototype.yc=function(){this.jo&&(this.window.removeEventListener("unload",this.jo),this.jo=null)},Rh.prototype.Ic=function(t){try{var e=null!==(null===(e=this.ec)||void 0===e?void 0:e.getItem(this.mc(t)));return kr("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return Pr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},Rh.prototype.Rc=function(){if(this.ec)try{this.ec.setItem(this.mc(this.clientId),String(Date.now()))}catch(t){Pr("Failed to set zombie client id.",t)}},Rh.prototype.gc=function(){if(this.ec)try{this.ec.removeItem(this.mc(this.clientId))}catch(t){}},Rh.prototype.mc=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},Rh);function Rh(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Ns=i,this.window=o,this.document=s,this.Uo=a,this.Qo=c,this.Ko=null,this.Wo=!1,this.isPrimary=!1,this.networkEnabled=!0,this.jo=null,this.inForeground=!1,this.Go=null,this.zo=null,this.Ho=Number.NEGATIVE_INFINITY,this.Jo=function(t){return Promise.resolve()},!Rh.Hs())throw new Nr(Ar.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Nr=new Mh(this,r),this.Yo=e+"main",this.serializer=new gc(u),this.Xo=new La(this.Yo,11,new Hc(this.serializer)),this.Zo=new Th(this.Nr,this.serializer),this.us=new wh,this.os=(e=this.serializer,u=this.us,new Vc(e,u)),this.tc=new yh(this.serializer),this.window&&this.window.localStorage?this.ec=this.window.localStorage:(this.ec=null,!1===c&&Pr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function Lh(t,e){var n=this;return(n=Dh.call(this)||this).jr=t,n.qo=e,n}function Ch(t){return Ph.Zs(t,Yc.store)}function Vh(t){return Ph.Zs(t,fh.store)}var Mh=(Uh.prototype.mr=function(t){var n=this.Nc(t);return this.db.vc().Fo(t).next(function(e){return n.next(function(t){return e+t})})},Uh.prototype.Nc=function(t){var e=0;return this.Ar(t,function(t){e++}).next(function(){return e})},Uh.prototype.Ke=function(t,e){return this.db.vc().Ke(t,e)},Uh.prototype.Ar=function(t,n){return this.Fc(t,function(t,e){return n(e)})},Uh.prototype.Mo=function(t,e,n){return jh(t,n)},Uh.prototype.Lo=function(t,e,n){return jh(t,n)},Uh.prototype.Rr=function(t,e,n){return this.db.vc().Rr(t,e,n)},Uh.prototype.zr=jh,Uh.prototype.Oc=function(t,e){return r=e,i=!1,Lc(n=t).wi(function(t){return Oc(n,t,r).next(function(t){return t&&(i=!0),ga.resolve(!t)})}).next(function(){return i});var n,r,i},Uh.prototype.Pr=function(n,r){var i=this,o=this.db.Sc().oo(),s=[],u=0;return this.Fc(n,function(e,t){t<=r&&(t=i.Oc(n,e).next(function(t){if(!t)return u++,o.Xn(n,e).next(function(){return o.Yn(e),Sh(n).delete([0,dc(e.path)])})}),s.push(t))}).next(function(){return ga.Qn(s)}).next(function(){return o.apply(n)}).next(function(){return u})},Uh.prototype.removeTarget=function(t,e){e=e.Et(t.qo);return this.db.vc().Co(t,e)},Uh.prototype.kc=jh,Uh.prototype.Fc=function(t,r){var i,t=Sh(t),o=Ea.xs;return t.di({index:uh.documentTargetsIndex},function(t,e){var n=t[0],t=(t[1],e.path),e=e.sequenceNumber;0===n?(o!==Ea.xs&&r(new yi(vc(i)),o),o=e,i=t):o=Ea.xs}).next(function(){o!==Ea.xs&&r(new yi(vc(i)),o)})},Uh.prototype.gr=function(t){return this.db.Sc().ao(t)},Uh);function Uh(t,e){this.db=t,this.ur=new cc(this,e)}function jh(t,e){return Sh(t).put((t=t.qo,new uh(0,dc(e.path),t)))}function qh(t,e){var n=t.projectId;return t.I||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}function Fh(n,r){void 0===r&&(r=10240);var i=0;return{read:function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return i<n.byteLength?(e={value:n.slice(i,i+r),done:!1},[2,(i+=r,e)]):[2,{done:!0}]})})},cancel:function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2]})})},releaseLock:function(){}}}function Bh(t,e){if(t instanceof Uint8Array)return Fh(t,e);if(t instanceof ArrayBuffer)return Fh(new Uint8Array(t),e);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}function zh(t){return new Ho(t,!0)}var Gh=(Xh.prototype.Mc=function(){return"metadata"in this.payload},Xh),Kh=(Yh.qc=function(t,e){return new Yh(Bh(t,10240),e)},Yh.prototype.close=function(){return this.$c.cancel()},Yh.prototype.getMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2,this.metadata.promise]})})},Yh.prototype.Uc=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.Bc())]}})})},Yh.prototype.Bc=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return[4,this.Qc()];case 1:return null===(e=t.sent())?[2,null]:(r=this.Lc.decode(e),n=Number(r),isNaN(n)&&this.Kc("length string ("+r+") is not valid number"),[4,this.Wc(n)]);case 2:return r=t.sent(),[2,new Gh(JSON.parse(r),e.length+n)]}})})},Yh.prototype.jc=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},Yh.prototype.Qc=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.jc()<0?[4,this.Gc()]:[3,3];case 1:if(t.sent())return[3,3];t.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((e=this.jc())<0&&this.Kc("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,e),[2,(this.buffer=this.buffer.slice(e),n)])}})})},Yh.prototype.Wc=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.buffer.length<n?[4,this.Gc()]:[3,3];case 1:t.sent()&&this.Kc("Reached the end of bundle when more is expected."),t.label=2;case 2:return[3,0];case 3:return e=this.Lc.decode(this.buffer.slice(0,n)),[2,(this.buffer=this.buffer.slice(n),e)]}})})},Yh.prototype.Kc=function(t){throw this.$c.cancel(),new Error("Invalid bundle format: "+t)},Yh.prototype.Gc=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,this.$c.read()];case 1:return(e=t.sent()).done||((n=new Uint8Array(this.buffer.length+e.value.length)).set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n),[2,e.done]}})})},Yh),Hh=(Wh.prototype.zc=function(t){return ns(this.serializer,t)},Wh.prototype.Hc=function(t){return t.metadata.exists?as(this.serializer,t.document,!1):new gu(this.zc(t.metadata.name),this.Jc(t.metadata.readTime))},Wh.prototype.Jc=Jo,Wh);function Wh(t){this.serializer=t}function Yh(t,e){var n=this;this.$c=t,this.serializer=e,this.metadata=new Pa,this.buffer=new Uint8Array,this.Lc=new TextDecoder("utf-8"),this.Bc().then(function(t){t&&t.Mc()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}function Xh(t,e){this.payload=t,this.byteLength=e}function Zh(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}function Qh(t,e){this.progress=t,this.Yc=e}var Jh=(ef.prototype.ta=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},ef.prototype.ea=function(t){for(var e=new Map,n=new Hh(this.serializer),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.zc(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||eo()).add(s);e.set(c,h)}}return e},ef.prototype.complete=function(){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return[4,function(l,p,d){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a,c,h,f;return v(this,function(t){switch(t.label){case 0:for(e=new Hh((n=l).serializer),r=eo(),i=Xi,o=$i,s=0,u=p;s<u.length;s++)a=u[s],c=e.zc(a.metadata.name),a.document&&(r=r.add(c)),i=i.At(c,e.Hc(a)),o=o.At(c,e.Jc(a.metadata.readTime));return h=n.na.oo({co:!0}),[4,cf(n,ku(_u(li.nt("__bundle__/docs/"+d))))];case 1:return f=t.sent(),[2,n.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return af(e,h,i,fi.min(),o).next(function(t){return h.apply(e),t}).next(function(t){return n.Zo.No(e,f.targetId).next(function(){return n.Zo.ko(e,r,f.targetId)}).next(function(){return n.sa.ws(e,t)})})})]}})})}(this.Zc,this.documents,this.Xc.id)];case 1:e=t.sent(),n=this.ea(this.documents),r=0,i=this.queries,t.label=2;case 2:return r<i.length?(i=i[r],[4,function(e,i,o){return void 0===o&&(o=eo()),y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return[4,cf(e,ku(xc(i.bundledQuery)))];case 1:return n=t.sent(),[2,(r=e).persistence.runTransaction("Save named query","readwrite",function(t){var e=Jo(i.readTime);if(0<=n.wt.u(e))return r.tc.Eo(t,i);e=n.Tt(Br.h,e);return r.ra=r.ra.At(e.targetId,e),r.Zo.Co(t,e).next(function(){return r.Zo.No(t,n.targetId)}).next(function(){return r.Zo.ko(t,o,n.targetId)}).next(function(){return r.tc.Eo(t,i)})})]}})})}(this.Zc,i,n.get(i.name))]):[3,5];case 3:t.sent(),t.label=4;case 4:return r++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Qh(Object.assign({},this.progress),e))]}})})},ef),$h=(tf.prototype.wr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.yr(t,n.ra)})},tf);function tf(t,e,n,r){this.persistence=t,this.ia=e,this.serializer=r,this.ra=new qi(jr),this.oa=new va(ki,Pi),this.ca=fi.min(),this.cs=t.bc(n),this.na=t.Sc(),this.Zo=t.vc(),this.sa=new wa(this.na,this.cs,this.persistence.Dc()),this.tc=t.Cc(),this.ia.pr(this.sa)}function ef(t,e,n){this.Xc=t,this.Zc=e,this.serializer=n,this.queries=[],this.documents=[],this.progress=Zh(t)}function nf(t,e,n,r){return new $h(t,e,n,r)}function rf(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).cs,m=e.sa,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.cs.Qr(v).next(function(t){return g=t,n=e.persistence.bc(o),m=new wa(e.na,n,e.persistence.Dc()),n.Qr(v)}).next(function(t){for(var e=[],n=[],r=eo(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.ds(v,r).next(function(t){return{aa:t,ua:e,ha:n}})})})];case 1:return r=t.sent(),[2,(e.cs=n,e.sa=m,e.ia.pr(e.sa),r)]}})})}function of(t,h){var f=t;return f.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=h.batch.keys(),c=f.na.oo({co:!0});return e=f,r=t,o=c,s=(i=h).batch,n=s.keys(),u=ga.resolve(),n.forEach(function(n){u=u.next(function(){return o.Xn(r,n)}).next(function(t){var e=t,t=i.Cn.get(n);Vr(null!==t),(!e||e.version.u(t)<0)&&(e=s.pn(n,e,i))&&o.zn(e,i.Dn)})}),u.next(function(){return e.cs.Wr(r,s)}).next(function(){return c.apply(t)}).next(function(){return f.cs.Hr(t)}).next(function(){return f.sa.ds(t,a)})})}function sf(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Zo.Vo(t)})}function uf(t,r){var a=t,c=r.wt,h=a.ra;return a.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=a.na.oo({co:!0});h=a.ra;var u=[];r.ce.forEach(function(t,e){var n,r,i,o=h.get(e);o&&(u.push(a.Zo.$o(s,t.Ee,e).next(function(){return a.Zo.ko(s,t.de,e)})),0<(i=t.resumeToken).o()&&(n=o.Tt(i,c).Et(s.qo),h=h.At(e,n),r=o,i=t,Vr(0<(o=n).resumeToken.o()),(0===r.resumeToken.o()||3e8<=o.wt.B()-r.wt.B()||0<i.de.size+i.we.size+i.Ee.size)&&u.push(a.Zo.Co(s,n))))});var e,n=Xi;return r.ue.forEach(function(t,e){r.he.has(t)&&u.push(a.persistence.Nr.kc(s,t))}),u.push(af(s,t,r.ue,c,void 0).next(function(t){n=t})),c.isEqual(fi.min())||(e=a.Zo.Vo(s).next(function(t){return a.Zo.bo(s,s.qo,c)}),u.push(e)),ga.Qn(u).next(function(){return t.apply(s)}).next(function(){return a.sa.ws(s,n)})}).then(function(t){return a.ra=h,t})}function af(t,s,e,u,a){var n=eo();return e.forEach(function(t){return n=n.add(t)}),s.getEntries(t,n).next(function(i){var o=Xi;return e.forEach(function(t,e){var n=i.get(t),r=(null==a?void 0:a.get(t))||u;e instanceof gu&&e.version.isEqual(fi.min())?(s.Yn(t,r),o=o.At(t,e)):null==n||0<e.version.u(n.version)||0===e.version.u(n.version)&&n.hasPendingWrites?(s.zn(e,r),o=o.At(t,e)):kr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o})}function cf(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Zo.Oo(e,r).next(function(t){return t?(n=t,ga.resolve(n)):i.Zo.Ro(e).next(function(t){return n=new Vi(r,t,0,e.qo),i.Zo.vo(e,n).next(function(){return n})})})}).then(function(t){var e=i.ra.get(t.targetId);return(null===e||0<t.wt.u(e.wt))&&(i.ra=i.ra.At(t.targetId,t),i.oa.set(r,t.targetId)),t})}function hf(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).ra.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Nr.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Fa(r=t.sent()))throw r;return kr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.ra=e.ra.remove(o),e.oa.delete(n.target),[2]}})})}function ff(t,o,s){var u=t,a=fi.min(),c=eo();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=ku(o),(void 0!==(t=(i=t).oa.get(r))?ga.resolve(i.ra.get(t)):i.Zo.Oo(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.Zo.Bo(e,t.targetId).next(function(t){c=t})}).next(function(){return u.ia.Ts(e,o,s?a:fi.min(),s?c:eo())}).next(function(t){return{documents:t,la:c}});var t,n,r,i})}function lf(t,e){var n=t,r=n.Zo,t=n.ra.get(e);return t?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.en(t,e).next(function(t){return t?t.target:null})})}function pf(t){var s=t;return s.persistence.runTransaction("Get new document changes","readonly",function(t){return e=s.na,n=t,t=s.ca,r=e,i=Xi,o=bc(t),t=Fc(n),n=IDBKeyRange.lowerBound(o,!0),t.di({index:ih.readTimeIndex,range:n},function(t,e){var n=mc(r.serializer,e);i=i.At(n.key,n),o=e.readTime}).next(function(){return{Yc:i,readTime:Ec(o)}});var e,n,r,i,o}).then(function(t){var e=t.Yc,t=t.readTime;return s.ca=t,e})}function df(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=Fc(t),r=fi.min(),t.di({index:ih.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=Ec(e.readTime)),n.done()}).next(function(){return r});var r}).then(function(t){e.ca=t})]})})}function yf(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Ar.FAILED_PRECONDITION||e.message!==ma)throw e;return kr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function vf(t,e,n,r,i){var o=this;this.Zc=t,this.eu=e,this.Ei=n,this.nu={},this.su=[],this.iu=new Map,this.ru=new Set,this.ou=[],this.cu=i,this.cu.au(function(t){n.yi(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Mf(this)?(kr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).ru.add(4),[4,Of(e)];case 1:return t.sent(),e.uu.set("Unknown"),e.ru.delete(4),[4,Df(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.uu=new Tf(n,r)}var gf,mf,wf,Te=(Sf.prototype.Ta=function(){return 1===this.state||2===this.state||4===this.state},Sf.prototype.ma=function(){return 2===this.state},Sf.prototype.start=function(){3!==this.state?this.auth():this.Ia()},Sf.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Ta()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Sf.prototype.Aa=function(){this.state=0,this.Ci.reset()},Sf.prototype.Ra=function(){var t=this;this.ma()&&null===this.Ea&&(this.Ea=this.Ns.Ks(this._a,6e4,function(){return t.Pa()}))},Sf.prototype.ya=function(t){this.ga(),this.stream.send(t)},Sf.prototype.Pa=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.ma()?[2,this.close(0)]:[2]})})},Sf.prototype.ga=function(){this.Ea&&(this.Ea.cancel(),this.Ea=null)},Sf.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.ga(),this.Ci.cancel(),this.wa++,3!==e?this.Ci.reset():n&&n.code===Ar.RESOURCE_EXHAUSTED?(Pr(n.toString()),Pr("Using maximum backoff delay to prevent overloading the backend."),this.Ci.qs()):n&&n.code===Ar.UNAUTHENTICATED&&this.da.v(),null!==this.stream&&(this.Va(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.pa(n)];case 1:return t.sent(),[2]}})})},Sf.prototype.Va=function(){},Sf.prototype.auth=function(){var n=this;this.state=1;var t=this.ba(this.wa),e=this.wa;this.da.getToken().then(function(t){n.wa===e&&n.va(t)},function(e){t(function(){var t=new Nr(Ar.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Sa(t)})})},Sf.prototype.va=function(t){var e=this,n=this.ba(this.wa);this.stream=this.Da(t),this.stream.Ca(function(){n(function(){return e.state=2,e.listener.Ca()})}),this.stream.pa(function(t){n(function(){return e.Sa(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Sf.prototype.Ia=function(){var t=this;this.state=4,this.Ci.Us(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},Sf.prototype.Sa=function(t){return kr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Sf.prototype.ba=function(e){var n=this;return function(t){n.Ns.yi(function(){return n.wa===e?t():(kr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Sf),bf=(h(xf,wf=Te),xf.prototype.Da=function(t){return this.fa.xa("Listen",t)},xf.prototype.onMessage=function(t){this.Ci.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Cr(),r=e.targetChange.targetIds||[],i=(s=e.targetChange.resumeToken,t.nn?(Vr(void 0===s||"string"==typeof s),Br.fromBase64String(s||"")):(Vr(void 0===s||s instanceof Uint8Array),Br.fromUint8Array(s||new Uint8Array))),o=(u=e.targetChange.cause)&&(a=void 0===(c=u).code?Ar.UNKNOWN:ji(c.code),new Nr(a,c.message||"")),s=new ho(n,r,i,o||null)}else if("documentChange"in e){e.documentChange,(n=e.documentChange).document,n.document.name,n.document.updateTime,r=ns(t,n.document.name),i=Jo(n.document.updateTime);var u=new uu({mapValue:{fields:n.document.fields}}),a=(o=new vu(r,i,u,{}),n.targetIds||[]),c=n.removedTargetIds||[];s=new ao(a,c,o.key,o)}else if("documentDelete"in e)e.documentDelete,(n=e.documentDelete).document,r=ns(t,n.document),i=n.readTime?Jo(n.readTime):fi.min(),u=new gu(r,i),o=n.removedTargetIds||[],s=new ao([],o,u.key,u);else if("documentRemove"in e)e.documentRemove,(n=e.documentRemove).document,r=ns(t,n.document),i=n.removedTargetIds||[],s=new ao([],i,r,null);else{if(!("filter"in e))return Cr();e.filter;e=e.filter;e.targetId,n=e.count||0,r=new Li(n),i=e.targetId,s=new co(i,r)}return s}(this.serializer,t),t=function(t){if(!("targetChange"in t))return fi.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?Jo(t.readTime):fi.min()}(t);return this.listener.Na(e,t)},xf.prototype.Fa=function(t){var e,n,r,i={};i.database=os(this.serializer),i.addTarget=(e=this.serializer,(r=Ri(r=(n=t).target)?{documents:fs(e,r)}:{query:ls(e,r)}).targetId=n.targetId,0<n.resumeToken.o()?r.resumeToken=Qo(e,n.resumeToken):0<n.wt.u(fi.min())&&(r.readTime=Zo(e,n.wt.q())),r);var o,t=(this.serializer,o=t,null==(t=function(){switch(o.dt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Cr()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.ya(i)},xf.prototype.Oa=function(t){var e={};e.database=os(this.serializer),e.removeTarget=t,this.ya(e)},xf),Ef=(h(Nf,mf=Te),Object.defineProperty(Nf.prototype,"Ma",{get:function(){return this.ka},enumerable:!1,configurable:!0}),Nf.prototype.start=function(){this.ka=!1,this.lastStreamToken=void 0,mf.prototype.start.call(this)},Nf.prototype.Va=function(){this.ka&&this.$a([])},Nf.prototype.Da=function(t){return this.fa.xa("Write",t)},Nf.prototype.onMessage=function(t){if(Vr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.ka){this.Ci.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Vr(void 0!==r),n.map(function(t){return function(t,e){var n=t.updateTime?Jo(t.updateTime):Jo(e);n.isEqual(fi.min())&&(n=Jo(e));e=null;return t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new qs(n,e)}(t,r)})):[]),n=Jo(t.commitTime);return this.listener.La(n,e)}var n,r;return Vr(!t.writeResults||0===t.writeResults.length),this.ka=!0,this.listener.Ba()},Nf.prototype.qa=function(){var t={};t.database=os(this.serializer),this.ya(t)},Nf.prototype.$a=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return cs(e.serializer,t)})};this.ya(t)},Nf),If=(h(Af,gf=function(){}),Af.prototype.Qa=function(){if(this.Ua)throw new Nr(Ar.FAILED_PRECONDITION,"The client has already been terminated.")},Af.prototype.Ka=function(e,n,r){var i=this;return this.Qa(),this.credentials.getToken().then(function(t){return i.fa.Ka(e,n,r,t)}).catch(function(t){throw t.code===Ar.UNAUTHENTICATED&&i.credentials.v(),t})},Af.prototype.Wa=function(e,n,r){var i=this;return this.Qa(),this.credentials.getToken().then(function(t){return i.fa.Wa(e,n,r,t)}).catch(function(t){throw t.code===Ar.UNAUTHENTICATED&&i.credentials.v(),t})},Af.prototype.terminate=function(){this.Ua=!1},Af),Tf=(_f.prototype.Ja=function(){var t=this;0===this.Ga&&(this.Ya("Unknown"),this.za=this.Ei.Ks("online_state_timeout",1e4,function(){return t.za=null,t.Xa("Backend didn't respond within 10 seconds."),t.Ya("Offline"),Promise.resolve()}))},_f.prototype.Za=function(t){"Online"===this.state?this.Ya("Unknown"):(this.Ga++,1<=this.Ga&&(this.tu(),this.Xa("Connection failed 1 times. Most recent error: "+t.toString()),this.Ya("Offline")))},_f.prototype.set=function(t){this.tu(),this.Ga=0,"Online"===t&&(this.Ha=!1),this.Ya(t)},_f.prototype.Ya=function(t){t!==this.state&&(this.state=t,this.ja(t))},_f.prototype.Xa=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Ha?(Pr(t),this.Ha=!1):kr("OnlineStateTracker",t)},_f.prototype.tu=function(){null!==this.za&&(this.za.cancel(),this.za=null)},_f);function _f(t,e){this.Ei=t,this.ja=e,this.state="Unknown",this.Ga=0,this.za=null,this.Ha=!0}function Af(t,e,n){var r=this;return(r=gf.call(this)||this).credentials=t,r.fa=e,r.serializer=n,r.Ua=!1,r}function Nf(t,e,n,r,i){var o=this;return(o=mf.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.ka=!1,o}function xf(t,e,n,r,i){var o=this;return(o=wf.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Sf(t,e,n,r,i,o){this.Ns=t,this._a=n,this.fa=r,this.da=i,this.listener=o,this.state=0,this.wa=0,this.Ea=null,this.stream=null,this.Ci=new Ra(t,e)}function Df(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!Mf(r))return[3,4];e=0,n=r.ou,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Of(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.ou,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function kf(t,e){t.iu.has(e.targetId)||(t.iu.set(e.targetId,e),Vf(t)?Cf(t):Hf(t).ma()&&Rf(t,e))}function Pf(t,e){var n=t,t=Hf(n);n.iu.delete(e),t.ma()&&Lf(n,e),0===n.iu.size&&(t.ma()?t.Ra():Mf(n)&&n.uu.set("Unknown"))}function Rf(t,e){t.hu.xe(e.targetId),Hf(t).Fa(e)}function Lf(t,e){t.hu.xe(e),Hf(t).Oa(e)}function Cf(e){e.hu=new lo({tn:function(t){return e.nu.tn(t)},en:function(t){return e.iu.get(t)||null}}),Hf(e).start(),e.uu.Ja()}function Vf(t){return Mf(t)&&!Hf(t).Ta()&&0<t.iu.size}function Mf(t){return 0===t.ru.size}function Uf(t){t.hu=void 0}function jf(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.uu.set("Online"),!(u instanceof ho&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.iu.has(i)?[4,o.nu.lu(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.iu.delete(i),o.hu.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),kr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,qf(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof ao?s.hu.Be(u):u instanceof co?s.hu.ze(u):s.hu.Qe(u),a.isEqual(fi.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,sf(s.Zc)];case 8:return o=t.sent(),0<=a.u(o)?[4,(i=a,(e=(r=s).hu.Ye(i)).ce.forEach(function(t,e){var n;0<t.resumeToken.o()&&((n=r.iu.get(e))&&r.iu.set(e,n.Tt(t.resumeToken,i)))}),e.ae.forEach(function(t){var e=r.iu.get(t);e&&(r.iu.set(t,e.Tt(Br.h,e.wt)),Lf(r,t),e=new Vi(e.target,t,1,e.sequenceNumber),Rf(r,e))}),r.nu._u(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return kr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,qf(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function qf(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!Fa(r))throw r;return n.ru.add(1),[4,Of(n)];case 1:return t.sent(),n.uu.set("Offline"),i=i||function(){return sf(n.Zc)},n.Ei.$i(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return kr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.ru.delete(1),[4,Df(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function Ff(e,n){return n().catch(function(t){return qf(e,t,n)})}function Bf(a){return y(this,void 0,void 0,function(){var i,o,s,u;return v(this,function(t){switch(t.label){case 0:o=Wf(i=a),s=0<i.su.length?i.su[i.su.length-1].batchId:-1,t.label=1;case 1:if(!(Mf(i)&&i.su.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.Zc,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.cs.qr(t,n)}))];case 3:return null===(u=t.sent())?(0===i.su.length&&o.Ra(),[3,7]):(s=u.batchId,function(t,e){t.su.push(e);t=Wf(t);t.ma()&&t.Ma&&t.$a(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,qf(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return zf(i)&&Gf(i),[2]}var e,n,r})})}function zf(t){return Mf(t)&&!Wf(t).Ta()&&0<t.su.length}function Gf(t){Wf(t).start()}function Kf(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.ru.delete(2),[4,Df(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.ru.add(2),[4,Of(e)]);case 3:t.sent(),e.uu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function Hf(n){var t,e,r,i=this;return n.wu||(n.wu=(t=n.eu,e=n.Ei,r={Ca:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.iu.forEach(function(t,e){Rf(n,t)}),[2]})})}.bind(null,n),pa:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return Uf(e),Vf(e)?(e.uu.Za(n),Cf(e)):e.uu.set("Unknown"),[2]})})}.bind(null,n),Na:jf.bind(null,n)},t.Qa(),new bf(e,t.fa,t.credentials,t.serializer,r)),n.ou.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.wu.Aa(),Vf(n)?Cf(n):n.uu.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.wu.stop()];case 2:t.sent(),Uf(n),t.label=3;case 3:return[2]}})})})),n.wu}function Wf(n){var t,e,r,i=this;return n.Eu||(n.Eu=(t=n.eu,e=n.Ei,r={Ca:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return Wf(e).qa(),[2]})})}.bind(null,n),pa:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&Wf(e).Ma?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Ui(n=i.code)&&n!==Ar.ABORTED?(e=r.su.shift(),Wf(r).Aa(),[4,Ff(r,function(){return r.nu.du(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,Bf(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return zf(e)&&Gf(e),[2]}})})}.bind(null,n),Ba:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=Wf(o),n=0,r=o.su;n<r.length;n++)i=r[n],e.$a(i.mutations);return[2]})})}.bind(null,n),La:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.su.shift(),n=ya.from(e,i,o),[4,Ff(r,function(){return r.nu.fu(n)})];case 1:return t.sent(),[4,Bf(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Qa(),new Ef(e,t.fa,t.credentials,t.serializer,r)),n.ou.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Eu.Aa(),[4,Bf(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.Eu.stop()];case 3:t.sent(),0<n.su.length&&(kr("RemoteStore","Stopping write stream with "+n.su.length+" pending writes"),n.su=[]),t.label=4;case 4:return[2]}})})})),n.Eu}function Yf(){this.queries=new va(Lu,Ru),this.onlineState="Unknown",this.mu=new Set}var Xf=function(){this.Tu=void 0,this.listeners=[]};function Zf(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new Xf),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Iu(n)];case 2:return o.Tu=t.sent(),[3,4];case 3:return o=t.sent(),o=ec(o,"Initialization of query '"+Cu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.Au(e.onlineState),i.Tu&&u.Ru(i.Tu)&&Jf(e),[2]}})})}function Qf(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.Pu(n))]:[2]})})}function Jf(t){t.mu.forEach(function(t){t.next()})}var $f=(il.prototype.Ru=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new oo(t.query,t.docs,t.ne,e,t.se,t.fromCache,t.ie,!0)}var o=!1;return this.gu?this.pu(t)&&(this.yu.next(t),o=!0):this.bu(t,this.onlineState)&&(this.vu(t),o=!0),this.Vu=t,o},il.prototype.onError=function(t){this.yu.error(t)},il.prototype.Au=function(t){this.onlineState=t;var e=!1;return this.Vu&&!this.gu&&this.bu(this.Vu,t)&&(this.vu(this.Vu),e=!0),e},il.prototype.bu=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Su&&n||t.docs.Y()&&"Offline"!==e)},il.prototype.pu=function(t){if(0<t.docChanges.length)return!0;var e=this.Vu&&this.Vu.hasPendingWrites!==t.hasPendingWrites;return!(!t.ie&&!e)&&!0===this.options.includeMetadataChanges},il.prototype.vu=function(t){t=oo.oe(t.query,t.docs,t.se,t.fromCache),this.gu=!0,this.yu.next(t)},il),tl=(rl.prototype.Y=function(){return this.Du.Y()},rl.prototype.Mo=function(t,e){e=new el(t,e);this.Du=this.Du.add(e),this.xu=this.xu.add(e)},rl.prototype.Fu=function(t,e){var n=this;t.forEach(function(t){return n.Mo(t,e)})},rl.prototype.Lo=function(t,e){this.Ou(new el(t,e))},rl.prototype.ku=function(t,e){var n=this;t.forEach(function(t){return n.Lo(t,e)})},rl.prototype.Mu=function(t){var e=this,n=new yi(new li([])),r=new el(n,t),t=new el(n,t+1),i=[];return this.xu.jt([r,t],function(t){e.Ou(t),i.push(t.key)}),i},rl.prototype.$u=function(){var e=this;this.Du.forEach(function(t){return e.Ou(t)})},rl.prototype.Ou=function(t){this.Du=this.Du.delete(t),this.xu=this.xu.delete(t)},rl.prototype.Lu=function(t){var e=new yi(new li([])),n=new el(e,t),t=new el(e,t+1),r=eo();return this.xu.jt([n,t],function(t){r=r.add(t.key)}),r},rl.prototype.Jr=function(t){var e=new el(t,0),e=this.Du.zt(e);return null!==e&&t.isEqual(e.key)},rl),el=(nl.Cu=function(t,e){return yi.K(t.key,e.key)||jr(t.Bu,e.Bu)},nl.Nu=function(t,e){return jr(t.Bu,e.Bu)||yi.K(t.key,e.key)},nl);function nl(t,e){this.key=t,this.Bu=e}function rl(){this.Du=new Wi(el.Cu),this.xu=new Wi(el.Nu)}function il(t,e,n){this.query=t,this.yu=e,this.gu=!1,this.Vu=null,this.onlineState="Unknown",this.options=n||{}}function ol(t,e){return"firestore_clients_"+t+"_"+e}function sl(t,e,n){n="firestore_mutations_"+t+"_"+n;return e.A()&&(n+="_"+e.uid),n}function ul(t,e){return"firestore_targets_"+t+"_"+e}var al=(Dl.qu=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Nr(r.error.code,r.error.message)),i?new Dl(t,e,r.state,o):(Pr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},Dl.prototype.Uu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Dl),cl=(Sl.qu=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Nr(n.error.code,n.error.message)),r?new Sl(t,n.state,i):(Pr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},Sl.prototype.Uu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Sl),hl=(xl.qu=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=no,o=0;r&&o<n.activeTargetIds.length;++o)r=Si(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new xl(t,i):(Pr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},xl),fl=(Nl.qu=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new Nl(e.clientId,e.onlineState):(Pr("SharedClientState","Failed to parse online state: "+t),null)},Nl),ll=(Al.prototype.Qu=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Al.prototype.Ku=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Al.prototype.Uu=function(){var t={activeTargetIds:this.activeTargetIds.tt(),updateTimeMs:Date.now()};return JSON.stringify(t)},Al),pl=(_l.Hs=function(t){return!(!t||!t.localStorage)},_l.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f=this;return v(this,function(t){switch(t.label){case 0:return[4,this.ju.Vc()];case 1:for(s=t.sent(),e=0,n=s;e<n.length;e++)(r=n[e])!==this.Wu&&(i=this.getItem(ol(this.persistenceKey,r)))&&(o=hl.qu(r,i))&&(this.Hu=this.Hu.At(o.clientId,o));for(this.ih(),(s=this.storage.getItem(this.nh))&&(u=this.rh(s))&&this.oh(u),a=0,c=this.Ju;a<c.length;a++)h=c[a],this.zu(h);return this.Ju=[],this.window.addEventListener("unload",function(){return f.Ac()}),this.dr=!0,[2]}})})},_l.prototype.Cs=function(t){this.setItem(this.Xu,JSON.stringify(t))},_l.prototype.ah=function(){return this.uh(this.Hu)},_l.prototype.hh=function(n){var r=!1;return this.Hu.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},_l.prototype.lh=function(t){this._h(t,"pending")},_l.prototype.fh=function(t,e,n){this._h(t,e,n),this.dh(t)},_l.prototype.wh=function(t){var e,n="not-current";return this.hh(t)&&(!(e=this.storage.getItem(ul(this.persistenceKey,t)))||(e=cl.qu(t,e))&&(n=e.state)),this.Eh.Qu(t),this.ih(),n},_l.prototype.Th=function(t){this.Eh.Ku(t),this.ih()},_l.prototype.mh=function(t){return this.Eh.activeTargetIds.has(t)},_l.prototype.Ih=function(t){this.removeItem(ul(this.persistenceKey,t))},_l.prototype.Ah=function(t,e,n){this.Rh(t,e,n)},_l.prototype.Ph=function(t,e,n){var r=this;e.forEach(function(t){r.dh(t)}),this.currentUser=t,n.forEach(function(t){r.lh(t)})},_l.prototype.yh=function(t){this.gh(t)},_l.prototype.Vh=function(){this.ph()},_l.prototype.Ac=function(){this.dr&&(this.window.removeEventListener("storage",this.Gu),this.removeItem(this.Yu),this.dr=!1)},_l.prototype.getItem=function(t){var e=this.storage.getItem(t);return kr("SharedClientState","READ",t,e),e},_l.prototype.setItem=function(t,e){kr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},_l.prototype.removeItem=function(t){kr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},_l.prototype.zu=function(t){var e=this,o=t;if(o.storageArea===this.storage){if(kr("SharedClientState","EVENT",o.key,o.newValue),o.key===this.Yu)return void Pr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ns.$i(function(){return y(e,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){if(this.dr){if(null!==o.key)if(this.Zu.test(o.key)){if(null==o.newValue)return e=this.bh(o.key),[2,this.Sh(e,null)];if(e=this.Dh(o.key,o.newValue))return[2,this.Sh(e.clientId,e)]}else if(this.th.test(o.key)){if(null!==o.newValue&&(n=this.Ch(o.key,o.newValue)))return[2,this.xh(n)]}else if(this.eh.test(o.key)){if(null!==o.newValue&&(r=this.Nh(o.key,o.newValue)))return[2,this.Fh(r)]}else if(o.key===this.nh){if(null!==o.newValue&&(i=this.rh(o.newValue)))return[2,this.oh(i)]}else if(o.key===this.Xu)(i=function(t){var e=Ea.xs;if(null!=t)try{var n=JSON.parse(t);Vr("number"==typeof n),e=n}catch(t){Pr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(o.newValue))!==Ea.xs&&this.vs(i);else if(o.key===this.sh)return[2,this.ju.Oh()]}else this.Ju.push(o);return[2]})})})}},Object.defineProperty(_l.prototype,"Eh",{get:function(){return this.Hu.get(this.Wu)},enumerable:!1,configurable:!0}),_l.prototype.ih=function(){this.setItem(this.Yu,this.Eh.Uu())},_l.prototype._h=function(t,e,n){n=new al(this.currentUser,t,e,n),t=sl(this.persistenceKey,this.currentUser,t);this.setItem(t,n.Uu())},_l.prototype.dh=function(t){t=sl(this.persistenceKey,this.currentUser,t);this.removeItem(t)},_l.prototype.gh=function(t){t={clientId:this.Wu,onlineState:t};this.storage.setItem(this.nh,JSON.stringify(t))},_l.prototype.Rh=function(t,e,n){var r=ul(this.persistenceKey,t),n=new cl(t,e,n);this.setItem(r,n.Uu())},_l.prototype.ph=function(){this.setItem(this.sh,"value-not-used")},_l.prototype.bh=function(t){t=this.Zu.exec(t);return t?t[1]:null},_l.prototype.Dh=function(t,e){t=this.bh(t);return hl.qu(t,e)},_l.prototype.Ch=function(t,e){var n=this.th.exec(t),t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return al.qu(new $r(n),t,e)},_l.prototype.Nh=function(t,e){t=this.eh.exec(t),t=Number(t[1]);return cl.qu(t,e)},_l.prototype.rh=function(t){return fl.qu(t)},_l.prototype.xh=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.ju.kh(e.batchId,e.state,e.error)]:(kr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},_l.prototype.Fh=function(t){return this.ju.Mh(t.targetId,t.state,t.error)},_l.prototype.Sh=function(t,e){var n=this,r=e?this.Hu.At(t,e):this.Hu.remove(t),i=this.uh(this.Hu),o=this.uh(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.ju.$h(s,u).then(function(){n.Hu=r})},_l.prototype.oh=function(t){this.Hu.get(t.clientId)&&this.ja(t.onlineState)},_l.prototype.uh=function(t){var n=no;return t.forEach(function(t,e){n=n.Ht(e.activeTargetIds)}),n},_l),dl=(Tl.prototype.lh=function(t){},Tl.prototype.fh=function(t,e,n){},Tl.prototype.wh=function(t){return this.Lh.Qu(t),this.Bh[t]||"not-current"},Tl.prototype.Ah=function(t,e,n){this.Bh[t]=e},Tl.prototype.Th=function(t){this.Lh.Ku(t)},Tl.prototype.mh=function(t){return this.Lh.activeTargetIds.has(t)},Tl.prototype.Ih=function(t){delete this.Bh[t]},Tl.prototype.ah=function(){return this.Lh.activeTargetIds},Tl.prototype.hh=function(t){return this.Lh.activeTargetIds.has(t)},Tl.prototype.start=function(){return this.Lh=new ll,Promise.resolve()},Tl.prototype.Ph=function(t,e,n){},Tl.prototype.yh=function(t){},Tl.prototype.Ac=function(){},Tl.prototype.Cs=function(t){},Tl.prototype.Vh=function(){},Tl),yl=function(t){this.key=t},vl=function(t){this.key=t},gl=(Object.defineProperty(Il.prototype,"jh",{get:function(){return this.qh},enumerable:!1,configurable:!0}),Il.prototype.Gh=function(t,e){var s=this,u=e?e.zh:new io,a=(e||this).Wh,c=(e||this).se,h=a,f=!1,l=Au(this.query)&&a.size===this.query.limit?a.last():null,p=Nu(this.query)&&a.size===this.query.limit?a.first():null;if(t.gt(function(t,e){var n=a.get(t),r=(r=e instanceof vu?e:null)&&(Vu(s.query,r)?r:null),i=!!n&&s.se.has(n.key),o=!!r&&(r.ln||s.se.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.Hh(n,r)||(u.track({type:2,doc:r}),e=!0,(l&&0<s.Kh(r,l)||p&&s.Kh(r,p)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(l||p)&&(f=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),Au(this.query)||Nu(this.query))for(;h.size>this.query.limit;){var n=Au(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{Wh:h,zh:u,Dr:f,se:c}},Il.prototype.Hh=function(t,e){return t.ln&&e.hasCommittedMutations&&!e.ln},Il.prototype.es=function(t,e,n){var o=this,r=this.Wh;this.Wh=t.Wh,this.se=t.se;var i=t.zh.ee();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.Kh(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Cr()}}var r,i}),this.Jh(n);var s=e?this.Yh():[],n=0===this.Qh.size&&this.fe?1:0,e=n!==this.Uh;return this.Uh=n,0!==i.length||e?{snapshot:new oo(this.query,t.Wh,r,i,t.se,0==n,e,!1),Xh:s}:{Xh:s}},Il.prototype.Au=function(t){return this.fe&&"Offline"===t?(this.fe=!1,this.es({Wh:this.Wh,zh:new io,se:this.se,Dr:!1},!1)):{Xh:[]}},Il.prototype.Zh=function(t){return!this.qh.has(t)&&!!this.Wh.has(t)&&!this.Wh.get(t).ln},Il.prototype.Jh=function(t){var e=this;t&&(t.de.forEach(function(t){return e.qh=e.qh.add(t)}),t.we.forEach(function(t){}),t.Ee.forEach(function(t){return e.qh=e.qh.delete(t)}),this.fe=t.fe)},Il.prototype.Yh=function(){var e=this;if(!this.fe)return[];var n=this.Qh;this.Qh=eo(),this.Wh.forEach(function(t){e.Zh(t.key)&&(e.Qh=e.Qh.add(t.key))});var r=[];return n.forEach(function(t){e.Qh.has(t)||r.push(new vl(t))}),this.Qh.forEach(function(t){n.has(t)||r.push(new yl(t))}),r},Il.prototype.tl=function(t){this.qh=t.la,this.Qh=eo();t=this.Gh(t.documents);return this.es(t,!0)},Il.prototype.el=function(){return oo.oe(this.query,this.Wh,this.se,0===this.Uh)},Il),ml=function(t,e,n){this.query=t,this.targetId=e,this.view=n},wl=function(t){this.key=t,this.nl=!1},bl=(Object.defineProperty(El.prototype,"ml",{get:function(){return!0===this.Tl},enumerable:!1,configurable:!0}),El);function El(t,e,n,r,i,o){this.Zc=t,this.sl=e,this.il=n,this.rl=r,this.currentUser=i,this.ol=o,this.cl={},this.al=new va(Lu,Ru),this.ul=new Map,this.hl=[],this.ll=new qi(yi.K),this._l=new Map,this.fl=new tl,this.dl={},this.wl=new Map,this.El=Ih.Ao(),this.onlineState="Unknown",this.Tl=void 0}function Il(t,e){this.query=t,this.qh=e,this.Uh=null,this.fe=!1,this.Qh=eo(),this.se=eo(),this.Kh=Mu(t),this.Wh=new ro(this.Kh)}function Tl(){this.Lh=new ll,this.Bh={},this.ja=null,this.vs=null}function _l(t,e,n,r,i){this.window=t,this.Ns=e,this.persistenceKey=n,this.Wu=r,this.ju=null,this.ja=null,this.vs=null,this.Gu=this.zu.bind(this),this.Hu=new qi(jr),this.dr=!1,this.Ju=[];n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Yu=ol(this.persistenceKey,this.Wu),this.Xu="firestore_sequence_number_"+this.persistenceKey,this.Hu=this.Hu.At(this.Wu,new ll),this.Zu=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.th=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.eh=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.nh="firestore_online_state_"+this.persistenceKey,this.sh="firestore_bundle_loaded_"+this.persistenceKey,this.window.addEventListener("storage",this.Gu)}function Al(){this.activeTargetIds=no}function Nl(t,e){this.clientId=t,this.onlineState=e}function xl(t,e){this.clientId=t,this.activeTargetIds=e}function Sl(t,e,n){this.targetId=t,this.state=e,this.error=n}function Dl(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function Ol(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Il=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.Gh(o)).Dr?[4,ff(r.Zc,i.query,!1).then(function(t){t=t.documents;return i.view.Gh(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.ce.get(i.targetId),n=i.view.es(e,r.ml,n),[2,(ql(r,i.targetId,n.Xh),n.snapshot)]}})})}(i,t,e,n)},[4,ff(i.Zc,o,!0)];case 1:return n=t.sent(),r=new gl(o,n.la),e=r.Gh(n.documents),n=uo._e(s,u&&"Offline"!==i.onlineState),n=r.es(e,i.ml,n),ql(i,s,n.Xh),r=new ml(o,s,r),[2,(i.al.set(o,r),i.ul.has(s)?i.ul.get(s).push(o):i.ul.set(s,[o]),n.snapshot)]}})})}function kl(l,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:u=Xl(l),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(i=u.Zc,a=p,h=i,f=hi.now(),o=a.reduce(function(t,e){return t.add(e.key)},eo()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.sa.ds(u,o).next(function(t){c=t;for(var e,n=[],r=0,i=a;r<i.length;r++){var o=i[r],s=(e=o,s=c.get(o.key),void 0!==e.fieldTransforms?function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof vu?e.field(o.field):void 0,s=bs(o.transform,s||null);null!=s&&(n=(null==n?new au:n).set(o.field,s))}return n?n._n():null}(e.fieldTransforms,s):null);null!=s&&n.push(new Zs(o.key,s,function s(t){var u=[];return _o(t.fields||{},function(t,e){var n=new di([t]);if(zo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Ms(u)}(s.proto.mapValue),Fs.exists(!0)))}return h.cs.Mr(u,f,n,a)})}).then(function(t){var e=t.Sn(c);return{batchId:t.batchId,Wn:e}}))];case 2:return s=t.sent(),u.rl.lh(s.batchId),e=u,n=s.batchId,r=d,i=(i=(i=e.dl[e.currentUser.R()])||new qi(jr)).At(n,r),e.dl[e.currentUser.R()]=i,[4,Bl(u,s.Wn)];case 3:return t.sent(),[4,Bf(u.sl)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=ec(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,i,a,c,h,f,o})})}function Pl(r,i){return y(this,void 0,void 0,function(){var n,e;return v(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,uf(n.Zc,i)];case 2:return e=t.sent(),i.ce.forEach(function(t,e){e=n._l.get(e);e&&(Vr(t.de.size+t.we.size+t.Ee.size<=1),0<t.de.size?e.nl=!0:0<t.we.size?Vr(e.nl):0<t.Ee.size&&(Vr(e.nl),e.nl=!1))}),[4,Bl(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,yf(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function Rl(t,n,e){var r,t=t;(t.ml&&0===e||!t.ml&&1===e)&&(r=[],t.al.forEach(function(t,e){e=e.view.Au(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Au(i)&&(o=!0)}),o&&Jf(t)}(t.il,n),r.length&&t.cl.Na(r),t.onlineState=n,t.ml&&t.rl.yh(n))}function Ll(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Zc,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.cs.Lr(e,r).next(function(t){return Vr(null!==t),n=t.keys(),i.cs.Wr(e,t)}).next(function(){return i.cs.Hr(e)}).next(function(){return i.sa.ds(e,n)})}))];case 2:return o=t.sent(),Ml(n,u,a),Vl(n,u),n.rl.fh(u,"rejected",a),[4,Bl(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,yf(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}function Cl(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:Mf((n=o).sl)||kr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Zc).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.cs.Ur(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.wl.get(r)||[]).push(s),n.wl.set(r,i),[3,4]);case 3:return i=t.sent(),i=ec(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function Vl(t,e){(t.wl.get(e)||[]).forEach(function(t){t.resolve()}),t.wl.delete(e)}function Ml(t,e,n){var r=t,i=r.dl[r.currentUser.R()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.dl[r.currentUser.R()]=i)}function Ul(e,t,n){void 0===n&&(n=null),e.rl.Th(t);for(var r=0,i=e.ul.get(t);r<i.length;r++){var o=i[r];e.al.delete(o),n&&e.cl.Al(o,n)}e.ul.delete(t),e.ml&&e.fl.Mu(t).forEach(function(t){e.fl.Jr(t)||jl(e,t)})}function jl(t,e){var n=t.ll.get(e);null!==n&&(Pf(t.sl,n),t.ll=t.ll.remove(e),t._l.delete(n),Fl(t))}function ql(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof yl?(t.fl.Mo(o.key,e),function(t,e){e=e.key;t.ll.get(e)||(kr("SyncEngine","New document in limbo: "+e),t.hl.push(e),Fl(t))}(t,o)):o instanceof vl?(kr("SyncEngine","Document no longer in limbo: "+o.key),t.fl.Lo(o.key,e),t.fl.Jr(o.key)||jl(t,o.key)):Cr()}}function Fl(t){for(;0<t.hl.length&&t.ll.size<t.ol;){var e=t.hl.shift(),n=t.El.next();t._l.set(n,new wl(e)),t.ll=t.ll.At(e,n),kf(t.sl,new Vi(ku(_u(e.path)),n,2,Ea.xs))}}function Bl(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).al.Y()?[3,3]:(n.al.forEach(function(t,e){o.push(n.Il(e,s,u).then(function(t){t&&(n.ml&&n.rl.Ah(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=ba.bs(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.cl.Na(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return ga.forEach(c,function(e){return ga.forEach(e.Vs,function(t){return r.persistence.Nr.Mo(n,e.targetId,t)}).next(function(){return ga.forEach(e.ps,function(t){return r.persistence.Nr.Lo(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Fa(e=t.sent()))throw e;return kr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.ra.get(o),u=s.wt,u=s.It(u),r.ra=r.ra.At(o,u));return[2]}})})}(n.Zc,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function zl(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(kr("SyncEngine","User change. New user:",o.R()),[4,rf(n.Zc,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).wl.forEach(function(t){t.forEach(function(t){t.reject(new Nr(Ar.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.wl.clear(),n.rl.Ph(o,r.ua,r.ha),[4,Bl(n,r.aa)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}function Gl(u,a,c,h){return y(this,void 0,void 0,function(){var o,s;return v(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).Zc,n=a,i=(r=e).cs,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Br(e,n).next(function(t){return t?r.sa.ds(e,t):ga.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,Bf(o.sl)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(Ml(o,a,h||null),Vl(o,a),o.Zc.cs.Gr(a)):Cr(),t.label=4;case 4:return[4,Bl(o,s)];case 5:return t.sent(),[3,7];case 6:kr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}function Kl(h,f){return y(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return v(this,function(t){switch(t.label){case 0:return Yl(r=h),Xl(r),!0!==f||!0===r.Tl?[3,3]:(e=r.rl.ah(),[4,Hl(r,e.tt())]);case 1:return i=t.sent(),r.Tl=!0,[4,Kf(r.sl,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],kf(r.sl,u);return[3,7];case 3:return!1!==f||!1===r.Tl?[3,7]:(a=[],c=Promise.resolve(),r.ul.forEach(function(t,e){r.rl.mh(e)?a.push(e):c=c.then(function(){return Ul(r,e),hf(r.Zc,e,!0)}),Pf(r.sl,e)}),[4,c]);case 4:return t.sent(),[4,Hl(r,a)];case 5:return t.sent(),(n=r)._l.forEach(function(t,e){Pf(n.sl,e)}),n.fl.$u(),n._l=new Map,n.ll=new qi(yi.K),r.Tl=!1,[4,Kf(r.sl,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}function Hl(p,d){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l;return v(this,function(t){switch(t.label){case 0:e=p,n=[],r=[],i=0,o=d,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.ul.get(s))&&0!==a.length?[4,cf(e.Zc,ku(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(f=h[c],f=e.al.get(f),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,ff((e=r).Zc,i.query,!0)];case 1:return n=t.sent(),n=i.view.tl(n),[2,(e.ml&&ql(e,i.targetId,n.Xh),n)]}})})}(e,f)]):[3,6];case 4:(f=t.sent()).snapshot&&r.push(f.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,lf(e.Zc,s)];case 8:return l=t.sent(),[4,cf(e.Zc,l)];case 9:return u=t.sent(),[4,Ol(e,Wl(l),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.cl.Na(r),n)]}})})}function Wl(t){return Tu(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Yl(t){return t.sl.nu._u=Pl.bind(null,t),t.sl.nu.tn=function(t,e){var n=t;if((t=n._l.get(e))&&t.nl)return eo().add(t.key);var r=eo();if(!(e=n.ul.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.al.get(s),r=r.Ht(s.view.jh);return r}.bind(null,t),t.sl.nu.lu=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).rl.Ah(s,"rejected",u),i=e._l.get(s),(n=i&&i.key)?(r=(r=new qi(yi.K)).At(n,new gu(n,fi.min())),i=eo().add(n),i=new so(fi.min(),new Map,new Wi(jr),r,i),[4,Pl(e,i)]):[3,2];case 1:return t.sent(),e.ll=e.ll.remove(n),e._l.delete(s),Fl(e),[3,4];case 2:return[4,hf(e.Zc,s,!1).then(function(){return Ul(e,s,u)}).catch(yf)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,t),t.cl.Na=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.queries.get(u);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Ru(s)&&(r=!0);u.Tu=s}}r&&Jf(n)}.bind(null,t.il),t.cl.Al=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,t.il),t}function Xl(t){return t.sl.nu.fu=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,of(e.Zc,o)];case 2:return r=t.sent(),Ml(e,n,null),Vl(e,n),e.rl.fh(n,"acknowledged"),[4,Bl(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,yf(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,t),t.sl.nu.du=Ll.bind(null,t),t}function Zl(t,e,n){var r=t;(function(l,p,d){return y(this,void 0,void 0,function(){var u,a,c,h,f;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,14,,15]),[4,p.getMetadata()];case 1:return u=t.sent(),[4,(r=l.Zc,i=u,s=new Hh((o=r).serializer).Jc(i.createTime),o.persistence.runTransaction("hasNewerBundle","readonly",function(t){return o.tc._o(t,i.id)}).then(function(t){return!!t&&0<=t.createTime.u(s)}))];case 2:return t.sent()?[4,p.close()]:[3,4];case 3:return[2,(t.sent(),void d.Rl({taskState:"Success",documentsLoaded:u.totalDocuments,bytesLoaded:u.totalBytes,totalDocuments:u.totalDocuments,totalBytes:u.totalBytes}))];case 4:return d.Pl(Zh(u)),a=new Jh(u,l.Zc,p.serializer),[4,p.Uc()];case 5:c=t.sent(),t.label=6;case 6:return c?[4,a.ta(c)]:[3,10];case 7:return(h=t.sent())&&d.Pl(h),[4,p.Uc()];case 8:c=t.sent(),t.label=9;case 9:return[3,6];case 10:return[4,a.complete()];case 11:return f=t.sent(),[4,Bl(l,f.Yc,void 0)];case 12:return t.sent(),[4,(r=l.Zc,e=u,(n=r).persistence.runTransaction("Save bundle","readwrite",function(t){return n.tc.fo(t,e)}))];case 13:return t.sent(),d.Rl(f.progress),[3,15];case 14:return Rr("SyncEngine","Loading bundle failed with "+(f=t.sent())),d.yl(f),[3,15];case 15:return[2]}var e,n,r,i,o,s})})})(r,e,n).then(function(){r.rl.Vh()})}var Ql,Jl,$l,tp,ep,np=(Mp.prototype.kr=function(t){return ga.resolve(0===this.cs.length)},Mp.prototype.Mr=function(t,e,n,r){var i=this.gl;this.gl++,0<this.cs.length&&this.cs[this.cs.length-1];n=new da(i,e,n,r);this.cs.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Vl=this.Vl.add(new el(u.key,i)),this.us.$r(t,u.key.path.G())}return ga.resolve(n)},Mp.prototype.Lr=function(t,e){return ga.resolve(this.pl(e))},Mp.prototype.qr=function(t,e){e+=1,e=this.bl(e),e=e<0?0:e;return ga.resolve(this.cs.length>e?this.cs[e]:null)},Mp.prototype.Ur=function(){return ga.resolve(0===this.cs.length?-1:this.gl-1)},Mp.prototype.Qr=function(t){return ga.resolve(this.cs.slice())},Mp.prototype.ls=function(t,e){var n=this,r=new el(e,0),e=new el(e,Number.POSITIVE_INFINITY),i=[];return this.Vl.jt([r,e],function(t){t=n.pl(t.Bu);i.push(t)}),ga.resolve(i)},Mp.prototype.Es=function(t,e){var n=this,r=new Wi(jr);return e.forEach(function(t){var e=new el(t,0),t=new el(t,Number.POSITIVE_INFINITY);n.Vl.jt([e,t],function(t){r=r.add(t.Bu)})}),ga.resolve(this.vl(r))},Mp.prototype.ys=function(t,e){var n=e.path,r=n.length+1,e=n;yi.lt(e)||(e=e.child(""));var e=new el(new yi(e),0),i=new Wi(jr);return this.Vl.Gt(function(t){var e=t.key.path;return!!n.X(e)&&(e.length===r&&(i=i.add(t.Bu)),!0)},e),ga.resolve(this.vl(i))},Mp.prototype.vl=function(t){var e=this,n=[];return t.forEach(function(t){t=e.pl(t);null!==t&&n.push(t)}),n},Mp.prototype.Wr=function(n,r){var i=this;Vr(0===this.Sl(r.batchId,"removed")),this.cs.shift();var o=this.Vl;return ga.forEach(r.mutations,function(t){var e=new el(t.key,r.batchId);return o=o.delete(e),i.Nr.zr(n,t.key)}).next(function(){i.Vl=o})},Mp.prototype.Gr=function(t){},Mp.prototype.Jr=function(t,e){var n=new el(e,0),n=this.Vl.zt(n);return ga.resolve(e.isEqual(n&&n.key))},Mp.prototype.Hr=function(t){return this.cs.length,ga.resolve()},Mp.prototype.Sl=function(t,e){return this.bl(t)},Mp.prototype.bl=function(t){return 0===this.cs.length?0:t-this.cs[0].batchId},Mp.prototype.pl=function(t){t=this.bl(t);return t<0||t>=this.cs.length?null:this.cs[t]},Mp),rp=(Vp.prototype.zn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.Dl(e);return this.docs=this.docs.At(r,{Jn:e,size:i,readTime:n}),this.size+=i-o,this.us.$r(t,r.path.G())},Vp.prototype.Yn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Vp.prototype.Xn=function(t,e){e=this.docs.get(e);return ga.resolve(e?e.Jn:null)},Vp.prototype.getEntries=function(t,e){var n=this,r=Xi;return e.forEach(function(t){var e=n.docs.get(t);r=r.At(t,e?e.Jn:null)}),ga.resolve(r)},Vp.prototype.Ts=function(t,e,n){for(var r=Ji,i=new yi(e.path.child("")),o=this.docs.vt(i);o.Ft();){var s=o.Nt(),u=s.key,a=s.value,s=a.Jn,a=a.readTime;if(!e.path.X(u.path))break;a.u(n)<=0||s instanceof vu&&Vu(e,s)&&(r=r.At(s.key,s))}return ga.resolve(r)},Vp.prototype.Cl=function(t,e){return ga.forEach(this.docs,function(t){return e(t)})},Vp.prototype.oo=function(t){return new ip(this)},Vp.prototype.ao=function(t){return ga.resolve(this.size)},Vp),ip=(h(Cp,ep=o),Cp.prototype.es=function(n){var r=this,i=[];return this.Wn.forEach(function(t,e){e&&e.Jn?i.push(r.uo.zn(n,e.Jn,r.Gn(t))):r.uo.Yn(t)}),ga.Qn(i)},Cp.prototype.Zn=function(t,e){return this.uo.Xn(t,e)},Cp.prototype.ts=function(t,e){return this.uo.getEntries(t,e)},Cp),op=(Lp.prototype.Ke=function(t,n){return this.xl.forEach(function(t,e){return n(e)}),ga.resolve()},Lp.prototype.Vo=function(t){return ga.resolve(this.lastRemoteSnapshotVersion)},Lp.prototype.po=function(t){return ga.resolve(this.Nl)},Lp.prototype.Ro=function(t){return this.highestTargetId=this.Ol.next(),ga.resolve(this.highestTargetId)},Lp.prototype.bo=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Nl&&(this.Nl=e),ga.resolve()},Lp.prototype.So=function(t){this.xl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Ol=new Ih(e),this.highestTargetId=e),t.sequenceNumber>this.Nl&&(this.Nl=t.sequenceNumber)},Lp.prototype.vo=function(t,e){return this.So(e),this.targetCount+=1,ga.resolve()},Lp.prototype.Co=function(t,e){return this.So(e),ga.resolve()},Lp.prototype.xo=function(t,e){return this.xl.delete(e.target),this.Fl.Mu(e.targetId),--this.targetCount,ga.resolve()},Lp.prototype.Rr=function(n,r,i){var o=this,s=0,u=[];return this.xl.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.xl.delete(t),u.push(o.No(n,e.targetId)),s++)}),ga.Qn(u).next(function(){return s})},Lp.prototype.Fo=function(t){return ga.resolve(this.targetCount)},Lp.prototype.Oo=function(t,e){e=this.xl.get(e)||null;return ga.resolve(e)},Lp.prototype.ko=function(t,e,n){return this.Fl.Fu(e,n),ga.resolve()},Lp.prototype.$o=function(e,t,n){this.Fl.ku(t,n);var r=this.persistence.Nr,i=[];return r&&t.forEach(function(t){i.push(r.zr(e,t))}),ga.Qn(i)},Lp.prototype.No=function(t,e){return this.Fl.Mu(e),ga.resolve()},Lp.prototype.Bo=function(t,e){e=this.Fl.Lu(e);return ga.resolve(e)},Lp.prototype.Jr=function(t,e){return ga.resolve(this.Fl.Jr(e))},Lp),sp=(Rp.prototype._o=function(t,e){return ga.resolve(this.kl.get(e))},Rp.prototype.fo=function(t,e){return this.kl.set(e.id,{id:e.id,version:e.version,createTime:Jo(e.createTime)}),ga.resolve()},Rp.prototype.wo=function(t,e){return ga.resolve(this.Ml.get(e))},Rp.prototype.Eo=function(t,e){return this.Ml.set(e.name,{name:(e=e).name,query:xc(e.bundledQuery),readTime:Jo(e.readTime)}),ga.resolve()},Rp),up=(Pp.prototype.start=function(){return Promise.resolve()},Pp.prototype.Ac=function(){return this.Wo=!1,Promise.resolve()},Object.defineProperty(Pp.prototype,"dr",{get:function(){return this.Wo},enumerable:!1,configurable:!0}),Pp.prototype.cc=function(){},Pp.prototype.ac=function(){},Pp.prototype.Dc=function(){return this.us},Pp.prototype.bc=function(t){var e=this.$l[t.R()];return e||(e=new np(this.us,this.Nr),this.$l[t.R()]=e),e},Pp.prototype.vc=function(){return this.Zo},Pp.prototype.Sc=function(){return this.os},Pp.prototype.Cc=function(){return this.tc},Pp.prototype.runTransaction=function(t,e,n){var r=this;kr("MemoryPersistence","Starting transaction:",t);var i=new ap(this.Ko.next());return this.Nr.Bl(),n(i).next(function(t){return r.Nr.ql(i).next(function(){return t})}).qn().then(function(t){return i.rs(),t})},Pp.prototype.Ul=function(e,n){return ga.Kn(Object.values(this.$l).map(function(t){return function(){return t.Jr(e,n)}}))},Pp),ap=(h(kp,tp=Ie),kp),cp=(Op.Wl=function(t){return new Op(t)},Object.defineProperty(Op.prototype,"jl",{get:function(){if(this.Kl)return this.Kl;throw Cr()},enumerable:!1,configurable:!0}),Op.prototype.Mo=function(t,e,n){return this.Ql.Mo(n,e),this.jl.delete(n.toString()),ga.resolve()},Op.prototype.Lo=function(t,e,n){return this.Ql.Lo(n,e),this.jl.add(n.toString()),ga.resolve()},Op.prototype.zr=function(t,e){return this.jl.add(e.toString()),ga.resolve()},Op.prototype.removeTarget=function(t,e){var n=this;this.Ql.Mu(e.targetId).forEach(function(t){return n.jl.add(t.toString())});var r=this.persistence.vc();return r.Bo(t,e.targetId).next(function(t){t.forEach(function(t){return n.jl.add(t.toString())})}).next(function(){return r.xo(t,e)})},Op.prototype.Bl=function(){this.Kl=new Set},Op.prototype.ql=function(n){var r=this,i=this.persistence.Sc().oo();return ga.forEach(this.jl,function(t){var e=yi.at(t);return r.Gl(n,e).next(function(t){t||i.Yn(e)})}).next(function(){return r.Kl=null,i.apply(n)})},Op.prototype.kc=function(t,e){var n=this;return this.Gl(t,e).next(function(t){t?n.jl.delete(e.toString()):n.jl.add(e.toString())})},Op.prototype.Ll=function(t){return 0},Op.prototype.Gl=function(t,e){var n=this;return ga.Kn([function(){return ga.resolve(n.Ql.Jr(e))},function(){return n.persistence.vc().Jr(t,e)},function(){return n.persistence.Ul(t,e)}])},Op),hp=(Dp.prototype.Ca=function(t){this.Jl=t},Dp.prototype.pa=function(t){this.Yl=t},Dp.prototype.onMessage=function(t){this.Xl=t},Dp.prototype.close=function(){this.Hl()},Dp.prototype.send=function(t){this.zl(t)},Dp.prototype.Zl=function(){this.Jl()},Dp.prototype.t_=function(t){this.Yl(t)},Dp.prototype.e_=function(t){this.Xl(t)},Dp),fp={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},lp=(Sp.prototype.Ka=function(e,t,n,r){var i=this.r_(e,t);kr("RestConnection","Sending: ",i,n);t={};return this.o_(t,r),this.c_(e,i,t,n).then(function(t){return kr("RestConnection","Received: ",t),t},function(t){throw Rr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Sp.prototype.Wa=function(t,e,n,r){return this.Ka(t,e,n,r)},Sp.prototype.o_=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.1.2-BundlePrerelease.dee1ef083",t["Content-Type"]="text/plain",e)for(var n in e.V)e.V.hasOwnProperty(n)&&(t[n]=e.V[n])},Sp.prototype.r_=function(t,e){t=fp[t];return this.s_+"/v1/"+e+":"+t},h(xp,$l=Sp),xp.prototype.c_=function(o,e,s,u){return new Promise(function(n,r){var i=new _r;i.listenOnce(wr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case mr.NO_ERROR:var t=i.getResponseJson();kr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case mr.TIMEOUT:kr("Connection",'RPC "'+o+'" timed out'),r(new Nr(Ar.DEADLINE_EXCEEDED,"Request time out"));break;case mr.HTTP_ERROR:var e=i.getStatus();kr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace(/_/g,"-"),e=0<=Object.values(Ar).indexOf(e)?e:Ar.UNKNOWN,r(new Nr(e,t.message))):r(new Nr(Ar.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Nr(Ar.UNAVAILABLE,"Connection failed."));break;default:Cr()}}finally{kr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},xp.prototype.xa=function(t,e){var n,r=[this.s_,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new fr,o=gr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.T.projectId+"/databases/"+this.T.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.m};this.o_(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||(0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");kr("Connection","Creating WebChannel: "+r,t);var s=i.createWebChannel(r,t),u=!1,a=!1,c=new hp({zl:function(t){a?kr("Connection","Not sending because WebChannel is closed:",t):(u||(kr("Connection","Opening WebChannel transport."),s.open(),u=!0),kr("Connection","WebChannel sending:",t),s.send(t))},Hl:function(){return s.close()}}),t=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(s,Tr.EventType.OPEN,function(){a||kr("Connection","WebChannel transport opened.")}),t(s,Tr.EventType.CLOSE,function(){a||(a=!0,kr("Connection","WebChannel transport closed"),c.t_())}),t(s,Tr.EventType.ERROR,function(t){a||(a=!0,Rr("Connection","WebChannel transport errored:",t),c.t_(new Nr(Ar.UNAVAILABLE,"The operation could not be completed")))}),t(s,Tr.EventType.MESSAGE,function(t){var e,n,r,i;a||(Vr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(kr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Ci[r];if(void 0!==t)return ji(t)}(),i=n.message,void 0===t&&(t=Ar.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),a=!0,c.t_(new Nr(t,i)),s.close()):(kr("Connection","WebChannel received:",e),c.e_(e)))}),t(o,br.STAT_EVENT,function(t){t.stat===Er?kr("Connection","Detected buffering proxy"):t.stat===Ir&&kr("Connection","Detected no buffering proxy")}),setTimeout(function(){c.Zl()},0),c},xp),pp=(Np.prototype.au=function(t){this.__.push(t)},Np.prototype.Ac=function(){window.removeEventListener("online",this.a_),window.removeEventListener("offline",this.h_)},Np.prototype.f_=function(){window.addEventListener("online",this.a_),window.addEventListener("offline",this.h_)},Np.prototype.u_=function(){kr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.__;t<e.length;t++)(0,e[t])(0)},Np.prototype.l_=function(){kr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.__;t<e.length;t++)(0,e[t])(1)},Np.Hs=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Np),dp=(Ap.prototype.au=function(t){},Ap.prototype.Ac=function(){},Ap),yp=(_p.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.serializer=zh(e.n_.T),this.rl=this.d_(e),this.persistence=this.w_(e),[4,this.persistence.start()];case 1:return t.sent(),this.E_=this.T_(e),this.Zc=this.m_(e),[2]}})})},_p.prototype.T_=function(t){return null},_p.prototype.m_=function(t){return nf(this.persistence,new hc,t.I_,this.serializer)},_p.prototype.w_=function(t){return new up(cp.Wl,this.serializer)},_p.prototype.d_=function(t){return new dl},_p.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.E_&&this.E_.stop(),[4,this.rl.Ac()];case 1:return t.sent(),[4,this.persistence.Ac()];case 2:return t.sent(),[2]}})})},_p),vp=(h(Tp,Jl=yp),Tp.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Jl.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,df(this.Zc)];case 2:return t.sent(),[4,this.A_.initialize(this,e)];case 3:return t.sent(),[4,Xl(this.A_.ju)];case 4:return t.sent(),[4,Bf(this.A_.sl)];case 5:return t.sent(),[2]}})})},Tp.prototype.m_=function(t){return nf(this.persistence,new hc,t.I_,this.serializer)},Tp.prototype.T_=function(t){var e=this.persistence.Nr.ur;return new ac(e,t.Ei)},Tp.prototype.w_=function(t){var e=qh(t.n_.T,t.n_.persistenceKey),n=void 0!==this.cacheSizeBytes?oc.sr(this.cacheSizeBytes):oc.cr;return new Ph(this.synchronizeTabs,e,t.clientId,n,t.Ei,Xa(),Za(),this.serializer,this.rl,!!this.forceOwnership)},Tp.prototype.d_=function(t){return new dl},Tp),gp=(h(Ip,Ql=vp),Ip.prototype.initialize=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,Ql.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.A_.ju,this.rl instanceof pl?(this.rl.ju={kh:Gl.bind(null,e),Mh:function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return(e=i).Tl?(kr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!e.ul.has(o))return[3,8];switch(s){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,pf(e.Zc)];case 3:return n=t.sent(),r=so.le(o,"current"===s),[4,Bl(e,n,r)];case 4:return t.sent(),[3,8];case 5:return[4,hf(e.Zc,o,!0)];case 6:return t.sent(),Ul(e,o,u),[3,8];case 7:Cr(),t.label=8;case 8:return[2]}})})}.bind(null,e),$h:function(c,h,f){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a;return v(this,function(t){switch(t.label){case 0:if(!(n=Yl(c)).Tl)return[3,10];e=0,r=h,t.label=1;case 1:return e<r.length?(r=r[e],n.ul.has(r)?(kr("SyncEngine","Adding an already active target "+r),[3,5]):[4,lf(n.Zc,r)]):[3,6];case 2:return i=t.sent(),[4,cf(n.Zc,i)];case 3:return o=t.sent(),[4,Ol(n,Wl(i),o.targetId,!1)];case 4:t.sent(),kf(n.sl,o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return n.ul.has(e)?[4,hf(n.Zc,e,!1).then(function(){Pf(n.sl,e),Ul(n,e)}).catch(yf)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=0,a=f,t.label=7;case 7:return u<a.length?(a=a[u],[5,s(a)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})}.bind(null,e),Vc:function(t){return t.Zc.persistence.Vc()}.bind(null,e),Oh:function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,pf((e=n).Zc).then(function(t){return Bl(e,t)})]})})}.bind(null,e)},[4,this.rl.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence.oc(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Kl(this.A_.ju,e)];case 1:return t.sent(),this.E_&&(e&&!this.E_.dr?this.E_.start(this.Zc):e||this.E_.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},Ip.prototype.d_=function(t){var e=Xa();if(!pl.Hs(e))throw new Nr(Ar.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=qh(t.n_.T,t.n_.persistenceKey);return new pl(e,t.Ei,n,t.clientId,t.I_)},Ip),mp=(Ep.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Zc?[3,2]:(this.Zc=n.Zc,this.rl=n.rl,this.eu=this.R_(r),this.sl=this.P_(r),this.il=this.y_(r),this.ju=this.g_(r,!n.synchronizeTabs),this.rl.ja=function(t){return Rl(e.ju,t,1)},this.sl.nu.V_=zl.bind(null,this.ju),[4,Kf(this.sl,this.ju.ml)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Ep.prototype.y_=function(t){return new Yf},Ep.prototype.R_=function(t){var e=zh(t.n_.T),n=(n=t.n_,new lp(n));return t=t.credentials,new If(t,n,e)},Ep.prototype.P_=function(t){var e=this,n=this.Zc,r=this.eu,i=t.Ei,o=function(t){return Rl(e.ju,t,0)},t=new(pp.Hs()?pp:dp);return new vf(n,r,i,o,t)},Ep.prototype.g_=function(t,e){return function(t,e,n,r,i,o,s){o=new bl(t,e,n,r,i,o);return s&&(o.Tl=!0),o}(this.Zc,this.sl,this.il,this.rl,t.I_,t.ol,e)},Ep.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,kr("RemoteStore","RemoteStore shutting down."),e.ru.add(5),[4,Of(e)];case 1:return t.sent(),e.cu.Ac(),e.uu.set("Unknown"),[2]}})})}(this.sl)},Ep),wp=(bp.prototype.next=function(t){this.observer.next&&this.p_(this.observer.next,t)},bp.prototype.error=function(t){this.observer.error?this.p_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},bp.prototype.b_=function(){this.muted=!0},bp.prototype.p_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},bp);function bp(t){this.observer=t,this.muted=!1}function Ep(){}function Ip(t,e){var n=this;return(n=Ql.call(this,t,e,!1)||this).A_=t,n.cacheSizeBytes=e,n.synchronizeTabs=!0,n}function Tp(t,e,n){var r=this;return(r=Jl.call(this)||this).A_=t,r.cacheSizeBytes=e,r.forceOwnership=n,r.synchronizeTabs=!1,r}function _p(){this.synchronizeTabs=!1}function Ap(){}function Np(){var t=this;this.a_=function(){return t.u_()},this.h_=function(){return t.l_()},this.__=[],this.f_()}function xp(t){var e=this;return(e=$l.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.m=t.m,e}function Sp(t){this.n_=t,this.T=t.T;var e=t.ssl?"https":"http";this.s_=e+"://"+t.host,this.i_="projects/"+this.T.projectId+"/databases/"+this.T.database+"/documents"}function Dp(t){this.zl=t.zl,this.Hl=t.Hl}function Op(t){this.persistence=t,this.Ql=new tl,this.Kl=null}function kp(t){var e=this;return(e=tp.call(this)||this).qo=t,e}function Pp(t,e){var n=this;this.$l={},this.Ko=new Ea(0),this.Wo=!1,this.Wo=!0,this.Nr=t(this),this.Zo=new op(this),this.us=new Gc,this.os=(t=this.us,new rp(t,function(t){return n.Nr.Ll(t)})),this.serializer=new gc(e),this.tc=new sp(this.serializer)}function Rp(t){this.serializer=t,this.kl=new Map,this.Ml=new Map}function Lp(t){this.persistence=t,this.xl=new va(ki,Pi),this.lastRemoteSnapshotVersion=fi.min(),this.highestTargetId=0,this.Nl=0,this.Fl=new tl,this.targetCount=0,this.Ol=Ih.Io()}function Cp(t){var e=this;return(e=ep.call(this)||this).uo=t,e}function Vp(t,e){this.us=t,this.Dl=e,this.docs=new qi(yi.K),this.size=0}function Mp(t,e){this.us=t,this.Nr=e,this.cs=[],this.gl=1,this.Vl=new Wi(el.Cu)}function Up(t,e,n){if(!n)throw new Nr(Ar.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function jp(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function qp(t,e,n,r){if(!0===e&&!0===r)throw new Nr(Ar.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Fp(t){if(!yi.lt(t))throw new Nr(Ar.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Bp(t){if(yi.lt(t))throw new Nr(Ar.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function zp(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Cr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Gp(t,e){if("_delegate"in t&&(t=t._),t instanceof e)return t;if(e.name===t.constructor.name)throw new Nr(Ar.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");t=zp(t);throw new Nr(Ar.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function Kp(t,e){if(e<=0)throw new Nr(Ar.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Hp,Wp=function(t){this._methodName=t},Yp=(h(Xp,Hp=Wp),Xp.prototype.v_=function(t){if(2!==t.S_)throw 1===t.S_?t.D_(this._methodName+"() can only appear at the top level of your update data"):t.D_(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.sn.push(t.path),null},Xp.prototype.isEqual=function(t){return t instanceof Xp},Xp);function Xp(){return null!==Hp&&Hp.apply(this,arguments)||this}function Zp(t,e,n){return new Uy({S_:3,C_:e.settings.C_,methodName:t._methodName,x_:n},e.T,e.serializer,e.ignoreUndefinedProperties)}var Qp,Jp,$p,td,ed,nd,rd=(h(_d,nd=Wp),_d.prototype.v_=function(t){return new Us(t.path,new Ts)},_d.prototype.isEqual=function(t){return t instanceof _d},_d),id=(h(Td,ed=Wp),Td.prototype.v_=function(t){var e=Zp(this,t,!0),n=this.N_.map(function(t){return Hy(t,e)}),n=new _s(n);return new Us(t.path,n)},Td.prototype.isEqual=function(t){return this===t},Td),od=(h(Id,td=Wp),Id.prototype.v_=function(t){var e=Zp(this,t,!0),n=this.N_.map(function(t){return Hy(t,e)}),n=new Ds(n);return new Us(t.path,n)},Id.prototype.isEqual=function(t){return this===t},Id),sd=(h(Ed,$p=Wp),Ed.prototype.v_=function(t){var e=new Rs(t.serializer,Xo(t.serializer,this.F_));return new Us(t.path,e)},Ed.prototype.isEqual=function(t){return this===t},Ed),ud=(Object.defineProperty(bd.prototype,"latitude",{get:function(){return this.O_},enumerable:!1,configurable:!0}),Object.defineProperty(bd.prototype,"longitude",{get:function(){return this.k_},enumerable:!1,configurable:!0}),bd.prototype.isEqual=function(t){return this.O_===t.O_&&this.k_===t.k_},bd.prototype.toJSON=function(){return{latitude:this.O_,longitude:this.k_}},bd.prototype.$=function(t){return jr(this.O_,t.O_)||jr(this.k_,t.k_)},bd),ad=new Map,cd=(wd.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},wd),hd=(Object.defineProperty(md.prototype,"app",{get:function(){if(!this.Q_)throw new Nr(Ar.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Q_},enumerable:!1,configurable:!0}),Object.defineProperty(md.prototype,"K_",{get:function(){return this.B_},enumerable:!1,configurable:!0}),Object.defineProperty(md.prototype,"W_",{get:function(){return void 0!==this.j_},enumerable:!1,configurable:!0}),md.prototype.G_=function(t){if(this.B_)throw new Nr(Ar.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.L_=new cd(t),void 0!==t.credentials&&(this.U_=function(t){if(!t)return new si;switch(t.type){case"gapi":var e=t.client;return Vr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new ci(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Nr(Ar.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},md.prototype.z_=function(){return this.L_},md.prototype.H_=function(){return this.B_=!0,this.L_},md.prototype._delete=function(){return this.j_||(this.j_=this.J_()),this.j_},md.prototype.J_=function(){return(t=ad.get(this))&&(kr("ComponentProvider","Removing Datastore"),ad.delete(this),t.terminate()),Promise.resolve();var t},md),o=(gd.prototype.Y_=function(t,e){switch(void 0===e&&(e="none"),Do(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Vo(t.integerValue||t.doubleValue);case 3:return this.X_(t.timestampValue);case 4:return this.Z_(t,e);case 5:return t.stringValue;case 6:return this.tf(Mo(t.bytesValue));case 7:return this.ef(t.referenceValue);case 8:return this.nf(t.geoPointValue);case 9:return this.sf(t.arrayValue,e);case 10:return this.rf(t.mapValue,e);default:throw Cr()}},gd.prototype.rf=function(t,n){var r=this,i={};return _o(t.fields||{},function(t,e){i[t]=r.Y_(e,n)}),i},gd.prototype.nf=function(t){return new ud(Vo(t.latitude),Vo(t.longitude))},gd.prototype.sf=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.Y_(t,e)})},gd.prototype.Z_=function(t,e){switch(e){case"previous":var n=function t(e){e=e.mapValue.fields.__previous_value__;return No(e)?t(e):e}(t);return null==n?null:this.Y_(n,e);case"estimate":return this.X_(xo(t));default:return null}},gd.prototype.X_=function(t){t=Co(t);return new hi(t.seconds,t.nanos)},gd.prototype.cf=function(t,e){var n=li.nt(t);Vr(ws(n));t=new Jr(n.get(1),n.get(3)),n=new yi(n.j(5));return t.isEqual(e)||Pr("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},gd),fd=(h(vd,Jp=o),vd.prototype.tf=function(t){return new Zr(new Gr(t))},vd.prototype.ef=function(t){t=this.cf(t,this.firestore.q_);return Mv.af(t,this.firestore,null)},vd),ld=(Object.defineProperty(yd.prototype,"id",{get:function(){return this.lf.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(yd.prototype,"ref",{get:function(){return new Zd(this.uf,this.ff,this.lf)},enumerable:!1,configurable:!0}),yd.prototype.exists=function(){return null!==this._f},yd.prototype.data=function(){if(this._f){if(this.ff){var t=new pd(this.uf,this.hf,this.lf,this._f,null);return this.ff.fromFirestore(t)}return this.hf.Y_(this._f.mn())}},yd.prototype.get=function(t){if(this._f){t=this._f.data().field(Ad("DocumentSnapshot.get",t));if(null!==t)return this.hf.Y_(t)}},yd),pd=(h(dd,Qp=ld),dd.prototype.data=function(){return Qp.prototype.data.call(this)},dd);function dd(){return null!==Qp&&Qp.apply(this,arguments)||this}function yd(t,e,n,r,i){this.uf=t,this.hf=e,this.lf=n,this._f=r,this.ff=i}function vd(t){var e=this;return(e=Jp.call(this)||this).firestore=t,e}function gd(){}function md(t,e){this.M_="(lite)",this.L_=new cd({}),this.B_=!1,t instanceof Jr?(this.q_=t,this.U_=new si):(this.Q_=t,this.q_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Nr(Ar.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Jr(t.options.projectId)}(t),this.U_=new ui(e))}function wd(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Nr(Ar.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Nr(Ar.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,qp("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function bd(t,e){if(!isFinite(t)||t<-90||90<t)throw new Nr(Ar.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Nr(Ar.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.O_=t,this.k_=e}function Ed(t,e){var n=this;return(n=$p.call(this,t)||this).F_=e,n}function Id(t,e){var n=this;return(n=td.call(this,t)||this).N_=e,n}function Td(t,e){var n=this;return(n=ed.call(this,t)||this).N_=e,n}function _d(){return null!==nd&&nd.apply(this,arguments)||this}function Ad(t,e){return"string"==typeof e?Jy(t,e):(e instanceof Kr?e._:e).df}var Nd,xd=(Od.prototype.isEqual=function(t){return this.df.isEqual(t.df)},Od),Sd=(h(Dd,Nd=hd),Dd.prototype.J_=function(){return this.Ef||kv(this),this.Ef.terminate()},Dd);function Dd(t,e){var n=this;return(n=Nd.call(this,t,e)||this).wf=new Ja,n.M_="name"in t?t.name:"[DEFAULT]",n}function Od(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.df=new di(t)}function kd(n,r,i){var t=this,o=new Pa;return n.Ei.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,uv(n,i)];case 1:return t.sent(),[4,av(n,r)];case 2:return t.sent(),o.resolve(),[3,4];case 3:if(!("FirebaseError"===(t=e=t.sent()).name?t.code===Ar.FAILED_PRECONDITION||t.code===Ar.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code))throw e;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),o.reject(e),[3,4];case 4:return[2]}})})}).then(function(){return o.promise})}function Pd(t){if(t.K_||t.W_)throw new Nr(Ar.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Rd,Ld,Cd=(h(qd,Ld=ld),qd.prototype.exists=function(){return Ld.prototype.exists.call(this)},qd.prototype.data=function(t){if(void 0===t&&(t={}),this._f){if(this.ff){var e=new Vd(this.uf,this.hf,this.lf,this._f,this.metadata,null);return this.ff.fromFirestore(e,t)}return this.hf.Y_(this._f.mn(),t.serverTimestamps)}},qd.prototype.get=function(t,e){if(void 0===e&&(e={}),this._f){t=this._f.data().field(Ad("DocumentSnapshot.get",t));if(null!==t)return this.hf.Y_(t,e.serverTimestamps)}},qd),Vd=(h(jd,Rd=Cd),jd.prototype.data=function(t){return void 0===t&&(t={}),Rd.prototype.data.call(this,t)},jd),Md=(Object.defineProperty(Ud.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Ud.prototype,"size",{get:function(){return this.mf.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(Ud.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),Ud.prototype.forEach=function(e,n){var r=this;this.mf.docs.forEach(function(t){e.call(n,new Vd(r.uf,r.hf,t.key,t,new Zv(r.mf.se.has(t.key),r.mf.fromCache),r.query.ff))})},Ud.prototype.docChanges=function(t){void 0===t&&(t={});t=!!t.includeMetadataChanges;if(t&&this.mf.re)throw new Nr(Ar.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.If&&this.Af===t||(this.If=function(i,e){if(i.mf.ne.Y()){var n=0;return i.mf.docChanges.map(function(t){var e=new Vd(i.uf,i.hf,t.doc.key,t.doc,new Zv(i.mf.se.has(t.doc.key),i.mf.fromCache),i.query.ff);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.mf.ne;return i.mf.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new Vd(i.uf,i.hf,t.doc.key,t.doc,new Zv(i.mf.se.has(t.doc.key),i.mf.fromCache),i.query.ff),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Cr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.Af=t),this.If},Ud);function Ud(t,e,n,r){this.uf=t,this.hf=e,this.mf=r,this.metadata=new Zv(r.hasPendingWrites,r.fromCache),this.query=n}function jd(){return null!==Rd&&Rd.apply(this,arguments)||this}function qd(t,e,n,r,i,o){var s=this;return(s=Ld.call(this,t,e,n,r,o)||this).uf=t,s.Tf=t,s.metadata=i,s}function Fd(t,e){return t instanceof Cd&&e instanceof Cd?t.uf===e.uf&&t.lf.isEqual(e.lf)&&(null===t._f?null===e._f:t._f.isEqual(e._f))&&t.ff===e.ff:t instanceof Md&&e instanceof Md&&t.uf===e.uf&&Oy(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.mf.isEqual(e.mf)}function Bd(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var zd,Gd=(h(Kd,zd=o),Kd.prototype.tf=function(t){return new Gr(t)},Kd.prototype.ef=function(t){t=this.cf(t,this.firestore.q_);return new Zd(this.firestore,null,t)},Kd);function Kd(t){var e=this;return(e=zd.call(this)||this).firestore=t,e}function Hd(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Gp(t,Zd);var o=Gp(t.firestore,Sd),s=ky(o);return e instanceof Kr&&(e=e._),Yd(o,[("string"==typeof e||e instanceof xd?Gy(s,"updateDoc",t.lf,e,n,r):zy(s,"updateDoc",t.lf,e)).Pf(t.lf,Fs.exists(!0))])}function Wd(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];e instanceof Kr&&(e=e._);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||Bd(n[i])||(r=n[i],i++);var o,s,u,a,c,h,f={includeMetadataChanges:r.includeMetadataChanges};return Bd(n[i])&&(o=n[i],n[i]=null===(r=o.next)||void 0===r?void 0:r.bind(o),n[i+1]=null===(r=o.error)||void 0===r?void 0:r.bind(o),n[i+2]=null===(r=o.complete)||void 0===r?void 0:r.bind(o)),e instanceof Zd?(u=Gp(e.firestore,Sd),a=_u(e.lf.path),h={next:function(t){n[i]&&n[i](Xd(u,e,t))},error:n[i+1],complete:n[i+2]}):(s=Gp(e,Qd),u=Gp(s.firestore,Sd),a=s.Rf,c=new Gd(u),h={next:function(t){n[i]&&n[i](new Md(u,c,s,t))},error:n[i+1],complete:n[i+2]},by(e.Rf)),function(n,t,e){var r=this,i=new wp(h),o=new $f(t,i,e);return n.Ei.yi(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Zf,[4,yv(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})}),function(){i.b_(),n.Ei.yi(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Qf,[4,yv(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})})}}(Ov(u),a,f)}function Yd(t,e){return function(n,r){var t=this,i=new Pa;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=kl,[4,dv(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(Ov(t),e)}function Xd(t,e,n){var r=n.docs.get(e.lf),i=new Gd(t);return new Cd(t,i,e.lf,r,new Zv(n.hasPendingWrites,n.fromCache),e.ff)}var Zd=(Object.defineProperty($d.prototype,"yf",{get:function(){return this.lf.path},enumerable:!1,configurable:!0}),Object.defineProperty($d.prototype,"id",{get:function(){return this.lf.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty($d.prototype,"path",{get:function(){return this.lf.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty($d.prototype,"parent",{get:function(){return new Iy(this.firestore,this.ff,this.lf.path.G())},enumerable:!1,configurable:!0}),$d.prototype.withConverter=function(t){return new $d(this.firestore,t,this.lf)},$d),Qd=(Jd.prototype.withConverter=function(t){return new Jd(this.firestore,t,this.Rf)},Jd),Ie=function(){};function Jd(t,e,n){this.ff=e,this.Rf=n,this.type="query",this.firestore=t}function $d(t,e,n){this.ff=e,this.lf=n,this.type="document",this.firestore=t}function ty(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){t=i[r].gf(t)}return t}var ey,ny,ry,iy,oy,sy=(h(yy,oy=Ie),yy.prototype.gf=function(t){var e=ky(t.firestore),e=function(t,e,n,r,i,o){if(r.rt()){if("array-contains"===i||"array-contains-any"===i)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){my(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(gy(n,t,c))}h={arrayValue:{values:s}}}else h=gy(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||my(o,i),h=Ky(e,"where",o,"in"===i||"not-in"===i);var h=ju.create(r,i,h);return function(t,e){if(e.Pn()){var n=Su(t);if(null!==n&&!n.isEqual(e.field))throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=xu(t);null!==n&&wy(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new Nr(Ar.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Nr(Ar.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(t.Rf,e,t.firestore.q_,this.Vf,this.pf,this.bf);return new Qd(t.firestore,t.ff,(t=t.Rf,e=t.filters.concat([e]),new wu(t.path,t.collectionGroup,t.In.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},yy),uy=(h(dy,iy=Ie),dy.prototype.gf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new pa(e,n);return e=r,null!==xu(n=t)||null!==(t=Su(n))&&wy(0,t,e.field),r}(t.Rf,this.Vf,this.vf);return new Qd(t.firestore,t.ff,(t=t.Rf,e=t.In.concat([e]),new wu(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},dy),ay=(h(py,ry=Ie),py.prototype.gf=function(t){return new Qd(t.firestore,t.ff,Pu(t.Rf,this.Sf,this.Df))},py),cy=(h(ly,ny=Ie),ly.prototype.gf=function(t){var e=vy(t,this.type,this.Cf,this.xf);return new Qd(t.firestore,t.ff,(t=t.Rf,e=e,new wu(t.path,t.collectionGroup,t.In.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},ly),hy=(h(fy,ey=Ie),fy.prototype.gf=function(t){var e=vy(t,this.type,this.Cf,this.xf);return new Qd(t.firestore,t.ff,(t=t.Rf,e=e,new wu(t.path,t.collectionGroup,t.In.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},fy);function fy(t,e,n){var r=this;return(r=ey.call(this)||this).type=t,r.Cf=e,r.xf=n,r}function ly(t,e,n){var r=this;return(r=ny.call(this)||this).type=t,r.Cf=e,r.xf=n,r}function py(t,e,n){var r=this;return(r=ry.call(this)||this).type=t,r.Sf=e,r.Df=n,r}function dy(t,e){var n=this;return(n=iy.call(this)||this).Vf=t,n.vf=e,n.type="orderBy",n}function yy(t,e,n){var r=this;return(r=oy.call(this)||this).Vf=t,r.pf=e,r.bf=n,r.type="where",r}function vy(t,c,e,n){if(e[0]instanceof Kr&&(e[0]=e[0]._),e[0]instanceof ld)return function(t,e,n,r){if(!n)throw new Nr(Ar.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=Ou(t);o<s.length;o++){var u=s[o];if(u.field.rt())i.push(Uo(e,n.key));else{var a=n.field(u.field);if(No(a))throw new Nr(Ar.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.et();throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new oa(i,r)}(t.Rf,t.firestore.q_,e[0]._f,n);var r=ky(t.firestore);return function(t,e,n,r,i,o){var s=t.In;if(i.length>s.length)throw new Nr(Ar.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.rt()){if("string"!=typeof c)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Du(t)&&-1!==c.indexOf("/"))throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(li.nt(c));if(!yi.lt(h))throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new yi(h);u.push(Uo(e,h))}else{c=Ky(n,r,c);u.push(c)}}return new oa(u,o)}(t.Rf,t.firestore.q_,r,c,e,n)}function gy(t,e,n){if(n instanceof Kr&&(n=n._),"string"==typeof n){if(""===n)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Du(e)&&-1!==n.indexOf("/"))throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(li.nt(n));if(!yi.lt(e))throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Uo(t,new yi(e))}if(n instanceof Zd)return Uo(t,n.lf);throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+zp(n)+".")}function my(t,e){if(!Array.isArray(t)||0===t.length)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function wy(t,e,n){if(!n.isEqual(e))throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function by(t){if(Nu(t)&&0===t.In.length)throw new Nr(Ar.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Ey,Iy=(h(Ty,Ey=Qd),Object.defineProperty(Ty.prototype,"id",{get:function(){return this.Rf.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(Ty.prototype,"path",{get:function(){return this.Rf.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(Ty.prototype,"parent",{get:function(){var t=this.yf.G();return t.Y()?null:new Zd(this.firestore,null,new yi(t))},enumerable:!1,configurable:!0}),Ty.prototype.withConverter=function(t){return new Ty(this.firestore,t,this.yf)},Ty);function Ty(t,e,n){var r=this;return(r=Ey.call(this,t,e,_u(n))||this).firestore=t,r.yf=n,r.type="collection",r}function _y(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Kr&&(t=t._),Up("collection","path",e),t instanceof hd)return Bp(n=li.nt.apply(li,f([e],r))),new Iy(t,null,n);if(!(t instanceof Zd||t instanceof Iy))throw new Nr(Ar.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Bp(n=li.nt.apply(li,f([t.path],r)).child(li.nt(e))),new Iy(t.firestore,null,n)}function Ay(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Kr&&(t=t._),1===arguments.length&&(e=Mr.t()),Up("doc","path",e),t instanceof hd)return Fp(n=li.nt.apply(li,f([e],r))),new Zd(t,null,new yi(n));if(!(t instanceof Zd||t instanceof Iy))throw new Nr(Ar.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Fp(n=t.yf.child(li.nt.apply(li,f([e],r)))),new Zd(t.firestore,t instanceof Iy?t.ff:null,new yi(n))}var Ny,xy=(h(Sy,Ny=o),Sy.prototype.tf=function(t){return new Gr(t)},Sy.prototype.ef=function(t){t=this.cf(t,this.firestore.q_);return new Zd(this.firestore,null,t)},Sy);function Sy(t){var e=this;return(e=Ny.call(this)||this).firestore=t,e}function Dy(t,e){return t instanceof Kr&&(t=t._),e instanceof Kr&&(e=e._),(t instanceof Zd||t instanceof Iy)&&(e instanceof Zd||e instanceof Iy)&&t.firestore===e.firestore&&t.path===e.path&&t.ff===e.ff}function Oy(t,e){return t instanceof Kr&&(t=t._),e instanceof Kr&&(e=e._),t instanceof Qd&&e instanceof Qd&&t.firestore===e.firestore&&Ru(t.Rf,e.Rf)&&t.ff===e.ff}function ky(t){var e=t.H_(),n=zh(t.q_);return new jy(t.q_,!!e.ignoreUndefinedProperties,n)}var Py=/^__.*__$/,Ry=(Vy.prototype.Pf=function(t,e){return null!==this.sn?new Zs(t,this.data,this.sn,e,this.fieldTransforms):new Xs(t,this.data,e,this.fieldTransforms)},Vy),Ly=(Cy.prototype.Pf=function(t,e){return new Zs(t,this.data,this.sn,e,this.fieldTransforms)},Cy);function Cy(t,e,n){this.data=t,this.sn=e,this.fieldTransforms=n}function Vy(t,e,n){this.data=t,this.sn=e,this.fieldTransforms=n}function My(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Cr()}}var Uy=(Object.defineProperty(Fy.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Fy.prototype,"S_",{get:function(){return this.settings.S_},enumerable:!1,configurable:!0}),Fy.prototype.Ff=function(t){return new Fy(Object.assign(Object.assign({},this.settings),t),this.T,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.sn)},Fy.prototype.Of=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.Ff({path:e,x_:!1});return e.kf(t),e},Fy.prototype.Mf=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.Ff({path:t,x_:!1});return t.Nf(),t},Fy.prototype.$f=function(t){return this.Ff({path:void 0,x_:!0})},Fy.prototype.D_=function(t){return $y(t,this.settings.methodName,this.settings.Lf||!1,this.path,this.settings.C_)},Fy.prototype.contains=function(e){return void 0!==this.sn.find(function(t){return e.X(t)})||void 0!==this.fieldTransforms.find(function(t){return e.X(t.field)})},Fy.prototype.Nf=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.kf(this.path.get(t))},Fy.prototype.kf=function(t){if(0===t.length)throw this.D_("Document fields must not be empty");if(My(this.S_)&&Py.test(t))throw this.D_('Document fields cannot begin and end with "__"')},Fy),jy=(qy.prototype.Bf=function(t,e,n,r){return void 0===r&&(r=!1),new Uy({S_:t,methodName:e,C_:n,path:di.st(),x_:!1,Lf:r},this.T,this.serializer,this.ignoreUndefinedProperties)},qy);function qy(t,e,n){this.T=t,this.ignoreUndefinedProperties=e,this.serializer=n||zh(t)}function Fy(t,e,n,r,i,o){this.settings=t,this.T=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Nf(),this.fieldTransforms=i||[],this.sn=o||[]}function By(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Bf(o.merge||o.mergeFields?2:0,e,n,i);Xy("Data must be an object, but it was:",s,r);var u,a,r=Wy(r,s);if(o.merge)u=new Ms(s.sn),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=Zy(e,f[h],n);if(!s.contains(l))throw new Nr(Ar.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");tv(c,l)||c.push(l)}u=new Ms(c),a=s.fieldTransforms.filter(function(t){return u.hn(t.field)})}else u=null,a=s.fieldTransforms;return new Ry(new uu(r),u,a)}function zy(t,r,i,e){var o=t.Bf(1,r,i);Xy("Data must be an object, but it was:",o,e);var s=[],u=new au;_o(e,function(t,e){var n=Jy(r,t,i);e instanceof Kr&&(e=e._);t=o.Mf(n);e instanceof Yp?s.push(n):null!=(t=Hy(e,t))&&(s.push(n),u.set(n,t))});e=new Ms(s);return new Ly(u._n(),e,o.fieldTransforms)}function Gy(t,e,n,r,i,o){var s=t.Bf(1,e,n),u=[Zy(e,r,n)],a=[i];if(o.length%2!=0)throw new Nr(Ar.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Zy(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new au,y=u.length-1;0<=y;--y){tv(p,u[y])||(h=u[y],(f=a[y])instanceof Kr&&(f=f._),l=s.Mf(h),f instanceof Yp?p.push(h):null!=(l=Hy(f,l))&&(p.push(h),d.set(h,l)))}i=new Ms(p);return new Ly(d._n(),i,s.fieldTransforms)}function Ky(t,e,n,r){return void 0===r&&(r=!1),Hy(n,t.Bf(r?4:3,e))}function Hy(s,t){if(s instanceof Kr&&(s=s._),Yy(s))return Xy("Unsupported field value:",t,s),Wy(s,t);if(s instanceof Wp)return function(t,e){if(!My(e.S_))throw e.D_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.D_(t._methodName+"() is not currently supported inside arrays");t=t.v_(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.sn.push(t.path),s instanceof Array){if(t.settings.x_&&4!==t.S_)throw t.D_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Hy(i[r],t.$f(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof Kr&&(t=t._),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Xo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=hi.fromDate(t);return{timestampValue:Zo(e.serializer,n)}}if(t instanceof hi)return n=new hi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Zo(e.serializer,n)};if(t instanceof ud)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Gr)return{bytesValue:Qo(e.serializer,t.l)};if(t instanceof Zd){n=e.T;var r=t.firestore.q_;if(!r.isEqual(n))throw e.D_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:$o(t.firestore.q_||e.T,t.lf.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.D_("Unsupported field value: "+zp(t))}(s,t)}function Wy(t,n){var r={};return Ao(t)?n.path&&0<n.path.length&&n.sn.push(n.path):_o(t,function(t,e){e=Hy(e,n.Of(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function Yy(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof hi||t instanceof ud||t instanceof Gr||t instanceof Zd||t instanceof Wp)}function Xy(t,e,n){if(!Yy(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){n=zp(n);throw"an object"===n?e.D_(t+" a custom object"):e.D_(t+" "+n)}var r}function Zy(t,e,n){if(e instanceof Kr&&(e=e._),e instanceof xd)return e.df;if("string"==typeof e)return Jy(t,e);throw $y("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Qy=new RegExp("[~\\*/\\[\\]]");function Jy(e,n,r){if(0<=n.search(Qy))throw $y("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(xd.bind.apply(xd,f([void 0],n.split("."))))).df}catch(t){throw $y("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function $y(t,e,n,r,i){var o=r&&!r.Y(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Nr(Ar.INVALID_ARGUMENT,(e+=". ")+t+n)}function tv(t,e){return t.some(function(t){return t.isEqual(e)})}var ev=(sv.prototype.Wf=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.jf(),0<this.mutations.length)throw new Nr(Ar.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var n,e,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=os((n=s).serializer)+"/documents",r={documents:u.map(function(t){return es(n.serializer,t)})},[4,n.Wa("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.serializer,"found"in(t=t)?function(t,e){Vr(!!e.found),e.found.name,e.found.updateTime;var n=ns(t,e.found.name),t=Jo(e.found.updateTime),e=new uu({mapValue:{fields:e.found.fields}});return new vu(n,t,e,{})}(e,t):"missing"in t?function(t,e){Vr(!!e.missing),Vr(!!e.readTime);t=ns(t,e.missing),e=Jo(e.readTime);return new gu(t,e)}(e,t):Cr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());Vr(!!t),o.push(t)}),o)]}})})}(this.eu,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof gu||t instanceof vu?n.Gf(t):Cr()}),e)]}})})},sv.prototype.set=function(t,e){this.write(e.Pf(t,this.cn(t))),this.Kf.add(t.toString())},sv.prototype.update=function(t,e){try{this.write(e.Pf(t,this.zf(t)))}catch(t){this.Qf=t}this.Kf.add(t.toString())},sv.prototype.delete=function(t){this.write(new ou(t,this.cn(t))),this.Kf.add(t.toString())},sv.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.jf(),this.Qf)throw this.Qf;return e=this.qf,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=yi.at(e);n.mutations.push(new su(e,n.cn(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=os((e=i).serializer)+"/documents",r={writes:o.map(function(t){return cs(e.serializer,t)})},[4,e.Ka("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.eu,this.mutations)];case 1:return t.sent(),this.Uf=!0,[2]}})})},sv.prototype.Gf=function(t){var e;if(t instanceof vu)e=t.version;else{if(!(t instanceof gu))throw Cr();e=fi.min()}var n=this.qf.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Nr(Ar.ABORTED,"Document version changed between two reads.")}else this.qf.set(t.key.toString(),e)},sv.prototype.cn=function(t){var e=this.qf.get(t.toString());return!this.Kf.has(t.toString())&&e?Fs.updateTime(e):Fs.an()},sv.prototype.zf=function(t){var e=this.qf.get(t.toString());if(this.Kf.has(t.toString())||!e)return Fs.exists(!0);if(e.isEqual(fi.min()))throw new Nr(Ar.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Fs.updateTime(e)},sv.prototype.write=function(t){this.jf(),this.mutations.push(t)},sv.prototype.jf=function(){},sv),nv=(ov.prototype.run=function(){this.Jf()},ov.prototype.Jf=function(){var t=this;this.Ci.Us(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new ev(this.eu),(n=this.Yf(e))&&n.then(function(t){r.Ei.yi(function(){return e.commit().then(function(){r.Ii.resolve(t)}).catch(function(t){r.Xf(t)})})}).catch(function(t){r.Xf(t)}),[2]})})})},ov.prototype.Yf=function(t){try{var e=this.updateFunction(t);return!Ni(e)&&e.catch&&e.then?e:(this.Ii.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ii.reject(t),null}},ov.prototype.Xf=function(t){var e=this;0<this.Hf&&this.Zf(t)?(--this.Hf,this.Ei.yi(function(){return e.Jf(),Promise.resolve()})):this.Ii.reject(t)},ov.prototype.Zf=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!Ui(t)},ov),rv=(iv.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.N.promise];case 1:return[2,(t.sent(),{Ei:this.Ei,n_:this.n_,clientId:this.clientId,credentials:this.credentials,I_:this.user,ol:100})]}})})},iv.prototype.ed=function(t){var e=this;this.td=t,this.N.promise.then(function(){return e.td(e.user)})},iv.prototype.nd=function(){if(this.Ei.Ni)throw new Nr(Ar.FAILED_PRECONDITION,"The client has already been terminated.")},iv.prototype.terminate=function(){var t=this;this.Ei.Mi();var n=new Pa;return this.Ei.Fi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.sd?[4,this.sd.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.rd?[4,this.rd.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.D(),n.resolve(),[3,6];case 5:return e=t.sent(),e=ec(e,"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},iv);function iv(t,e,n){var r=this;this.credentials=t,this.Ei=e,this.n_=n,this.user=$r.UNAUTHENTICATED,this.clientId=Mr.t(),this.td=function(){},this.N=new Pa,this.credentials.S(function(t){kr("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.td(t)),r.N.resolve()})}function ov(t,e,n,r){this.Ei=t,this.eu=e,this.updateFunction=n,this.Ii=r,this.Hf=5,this.Ci=new Ra(this.Ei,"transaction_retry")}function sv(t){this.eu=t,this.qf=new Map,this.mutations=[],this.Uf=!1,this.Qf=null,this.Kf=new Set}function uv(r,i){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return r.Ei.qi(),kr("FirestoreClient","Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return e=t.sent(),[4,i.initialize(e)];case 2:return t.sent(),r.ed(function(e){return r.Ei.$i(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,rf(i.Zc,e)];case 1:return t.sent(),[2]}})})})}),i.persistence.cc(function(){return r.terminate()}),r.rd=i,[2]}})})}function av(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.Ei.qi(),[4,cv(r)];case 1:return e=t.sent(),kr("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.ed(function(t){return r.Ei.$i(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).Ei.qi(),kr("RemoteStore","RemoteStore received new credentials"),n=Mf(e),e.ru.add(3),[4,Of(e)];case 1:return t.sent(),n&&e.uu.set("Unknown"),[4,e.nu.V_(i)];case 2:return t.sent(),e.ru.delete(3),[4,Df(e)];case 3:return t.sent(),[2]}})})}(i.sl,t)})}),r.sd=i,[2]}})})}function cv(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.rd?[3,2]:(kr("FirestoreClient","Using default OfflineComponentProvider"),[4,uv(e,new yp)]);case 1:t.sent(),t.label=2;case 2:return[2,e.rd]}})})}function hv(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.sd?[3,2]:(kr("FirestoreClient","Using default OnlineComponentProvider"),[4,av(e,new mp)]);case 1:t.sent(),t.label=2;case 2:return[2,e.sd]}})})}function fv(t){return cv(t).then(function(t){return t.persistence})}function lv(t){return cv(t).then(function(t){return t.Zc})}function pv(t){return hv(t).then(function(t){return t.sl})}function dv(t){return hv(t).then(function(t){return t.ju})}function yv(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,hv(r)];case 1:return e=t.sent(),[2,((n=e.il).Iu=function(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=Yl(s),(o=e.al.get(u))?(n=o.targetId,e.rl.wh(n),r=o.view.el(),[3,4]):[3,1];case 1:return[4,cf(e.Zc,ku(u))];case 2:return i=t.sent(),o=e.rl.wh(i.targetId),n=i.targetId,[4,Ol(e,u,n,"current"===o)];case 3:r=t.sent(),e.ml&&kf(e.sl,i),t.label=4;case 4:return[2,r]}})})}.bind(null,e.ju),n.Pu=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).al.get(o),1<(r=e.ul.get(n.targetId)).length?[2,(e.ul.set(n.targetId,r.filter(function(t){return!Ru(t,o)})),void e.al.delete(o))]:e.ml?(e.rl.Th(n.targetId),e.rl.hh(n.targetId)?[3,2]:[4,hf(e.Zc,n.targetId,!1).then(function(){e.rl.Ih(n.targetId),Pf(e.sl,n.targetId),Ul(e,n.targetId)}).catch(yf)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Ul(e,n.targetId),[4,hf(e.Zc,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.ju),n)]}})})}function vv(n,r,i){var t=this;void 0===i&&(i={});var o=new Pa;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(n,r,i,o,s){var t=new wp({next:function(t){r.yi(function(){return Qf(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Nr(Ar.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Nr(Ar.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new $f(_u(i.path),t,{includeMetadataChanges:!0,Su:!0});return Zf(n,u)},[4,yv(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.Ei,r,i,o])]}})})}),o.promise}function gv(n,r,i){var t=this;void 0===i&&(i={});var o=new Pa;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new wp({next:function(t){n.yi(function(){return Qf(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Nr(Ar.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new $f(t,o,{includeMetadataChanges:!0,Su:!0});return Zf(e,s)},[4,yv(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.Ei,r,i,o])]}})})}),o.promise}var mv=(wv.prototype.set=function(t,e,n){this.ld();t=bv(t,this.uf),e=fg(t.ff,e,n),n=By(this.hd,"WriteBatch.set",t.lf,e,null!==t.ff,n);return this.ad.push(n.Pf(t.lf,Fs.an())),this},wv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.ld();t=bv(t,this.uf);return e instanceof Kr&&(e=e._),e="string"==typeof e||e instanceof xd?Gy(this.hd,"WriteBatch.update",t.lf,e,n,r):zy(this.hd,"WriteBatch.update",t.lf,e),this.ad.push(e.Pf(t.lf,Fs.exists(!0))),this},wv.prototype.delete=function(t){this.ld();t=bv(t,this.uf);return this.ad=this.ad.concat(new ou(t.lf,Fs.an())),this},wv.prototype.commit=function(){return this.ld(),this.ud=!0,0<this.ad.length?this.od(this.ad):Promise.resolve()},wv.prototype.ld=function(){if(this.ud)throw new Nr(Ar.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},wv);function wv(t,e){this.uf=t,this.od=e,this.ad=[],this.ud=!1,this.hd=ky(t)}function bv(t,e){if(t instanceof Kr&&(t=t._),t.firestore!==e)throw new Nr(Ar.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var Ev,Iv,Tv=(Dv.prototype.get=function(t){var e=this,n=bv(t,this.uf),r=new xy(this.uf);return this._d.Wf([n.lf]).then(function(t){if(!t||1!==t.length)return Cr();t=t[0];if(t instanceof gu)return new ld(e.uf,r,n.lf,null,n.ff);if(t instanceof vu)return new ld(e.uf,r,t.key,t,n.ff);throw Cr()})},Dv.prototype.set=function(t,e,n){t=bv(t,this.uf),e=fg(t.ff,e,n),n=By(this.hd,"Transaction.set",t.lf,e,null!==t.ff,n);return this._d.set(t.lf,n),this},Dv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=bv(t,this.uf);return e instanceof Kr&&(e=e._),e="string"==typeof e||e instanceof xd?Gy(this.hd,"Transaction.update",t.lf,e,n,r):zy(this.hd,"Transaction.update",t.lf,e),this._d.update(t.lf,e),this},Dv.prototype.delete=function(t){t=bv(t,this.uf);return this._d.delete(t.lf),this},h(Sv,Iv=Dv),Sv.prototype.get=function(t){var e=this,n=bv(t,this.uf),r=new Gd(this.uf);return Iv.prototype.get.call(this,t).then(function(t){return new Cd(e.uf,r,n.lf,t._f,new Zv(!1,!1),n.ff)})},Sv),_v=(xv.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){Pd(t=Gp(t,Sd));var n=Ov(t),r=t.H_(),t=new mp;return kd(n,t,new vp(t,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._,{forceOwnership:e})},xv.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){Pd(t=Gp(t,Sd));var e=Ov(t),n=t.H_(),t=new mp;return kd(e,t,new gp(t,n.cacheSizeBytes))}(t._)},xv.prototype.clearIndexedDbPersistence=function(t){return function(n){var t=this;if(n.K_&&!n.W_)throw new Nr(Ar.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var r=new Pa;return n.wf.Fi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return La.Hs()?(e=n+"main",[4,La.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(qh(n.q_,n.M_))];case 1:return t.sent(),r.resolve(),[3,3];case 2:return e=t.sent(),r.reject(e),[3,3];case 3:return[2]}})})}),r.promise}(t._)},xv),Av=(h(Nv,Ev=Kr),Object.defineProperty(Nv.prototype,"q_",{get:function(){return this._.q_},enumerable:!1,configurable:!0}),Nv.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._.z_()),t)).merge,this._.G_(t)},Nv.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this._.z_().host&&Rr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},Nv.prototype.enableNetwork=function(){return function(r){var t=this;return r.Ei.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,fv(r)];case 1:return e=t.sent(),[4,pv(r)];case 2:return n=t.sent(),[2,(e.ac(!0),(t=n).ru.delete(0),Df(t))]}})})})}(Ov(Gp(this._,Sd)))},Nv.prototype.disableNetwork=function(){return function(r){var t=this;return r.Ei.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,fv(r)];case 1:return e=t.sent(),[4,pv(r)];case 2:return n=t.sent(),[2,(e.ac(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).ru.add(0),[4,Of(e)];case 1:return t.sent(),e.uu.set("Offline"),[2]}})})}(n))]}})})})}(Ov(Gp(this._,Sd)))},Nv.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&qp("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.fd.enableMultiTabIndexedDbPersistence(this):this.fd.enableIndexedDbPersistence(this,n)},Nv.prototype.clearPersistence=function(){return this.fd.clearIndexedDbPersistence(this)},Nv.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this._._delete()},Nv.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new Pa;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Cl,[4,dv(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(Ov(Gp(this._,Sd)))},Nv.prototype.onSnapshotsInSync=function(t){return e=this._,t=t,function(n,t){var e=this,r=new wp(t);return n.Ei.yi(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.mu.add(e),e.next()},[4,yv(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),function(){r.b_(),n.Ei.yi(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.mu.delete(e)},[4,yv(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}}(Ov(Gp(e,Sd)),Bd(t)?t:{next:t});var e},Object.defineProperty(Nv.prototype,"app",{get:function(){if(!this.dd)throw new Nr(Ar.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.dd},enumerable:!1,configurable:!0}),Nv.prototype.collection=function(t){try{return new ng(this,_y(this._,t))}catch(t){throw Fv(t,"collection()","Firestore.collection()")}},Nv.prototype.doc=function(t){try{return new Mv(this,Ay(this._,t))}catch(t){throw Fv(t,"doc()","Firestore.doc()")}},Nv.prototype.collectionGroup=function(t){try{return new $v(this,function(t,e){if(t=Gp(t,hd),Up("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new Nr(Ar.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Qd(t,null,(e=e,new wu(li.st(),e)))}(this._,t))}catch(t){throw Fv(t,"collectionGroup()","Firestore.collectionGroup()")}},Nv.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new Pa;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,hv(n).then(function(t){return t.eu})];case 1:return e=t.sent(),new nv(n.Ei,e,r,i).run(),[2]}})})}),i.promise}(Ov(n=this._),function(t){return t=new Tv(n,t),e(new Cv(r,t))})},Nv.prototype.batch=function(){var e=this;return Ov(this._),new Vv(new mv(this._,function(t){return Yd(e._,t)}))},Nv.prototype.loadBundle=function(t){throw new Nr(Ar.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},Nv.prototype.namedQuery=function(t){throw new Nr(Ar.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},Nv);function Nv(t,e,n){var r=this;return(r=Ev.call(this,e)||this).fd=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof Jr||(r.dd=t),r}function xv(){}function Sv(t,e){var n=this;return(n=Iv.call(this,t,e)||this).uf=t,n}function Dv(t,e){this.uf=t,this._d=e,this.hd=ky(t)}function Ov(t){return t.Ef||kv(t),t.Ef.nd(),t.Ef}function kv(t){var e,n,r=t.H_(),r=(e=t.q_,n=t.M_,new Qr(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.Ef=new rv(t.U_,t.wf,r)}var Pv,Rv,Lv,Cv=(h(qv,Lv=Kr),qv.prototype.get=function(t){var e=this,t=hg(t);return this._.get(t).then(function(t){return new Qv(e.uf,t)})},qv.prototype.set=function(t,e,n){t=hg(t);return n?(jp("Transaction.set",n),this._.set(t,e,n)):this._.set(t,e),this},qv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=hg(t);return 2===arguments.length?this._.update(o,e):(t=this._).update.apply(t,f([o,e,n],r)),this},qv.prototype.delete=function(t){t=hg(t);return this._.delete(t),this},qv),Vv=(h(jv,Rv=Kr),jv.prototype.set=function(t,e,n){t=hg(t);return n?(jp("WriteBatch.set",n),this._.set(t,e,n)):this._.set(t,e),this},jv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=hg(t);return 2===arguments.length?this._.update(o,e):(t=this._).update.apply(t,f([o,e,n],r)),this},jv.prototype.delete=function(t){t=hg(t);return this._.delete(t),this},jv.prototype.commit=function(){return this._.commit()},jv),Mv=(h(Uv,Pv=Kr),Uv.wd=function(t,e,n){if(t.length%2!=0)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.et()+" has "+t.length);return new Uv(e,new Zd(e._,n,new yi(t)))},Uv.af=function(t,e,n){return new Uv(e,new Zd(e._,n,t))},Object.defineProperty(Uv.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(Uv.prototype,"parent",{get:function(){return new ng(this.firestore,this._.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(Uv.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Uv.prototype.collection=function(t){try{return new ng(this.firestore,_y(this._,t))}catch(t){throw Fv(t,"collection()","DocumentReference.collection()")}},Uv.prototype.isEqual=function(t){return t instanceof Kr&&(t=t._),t instanceof Zd&&Dy(this._,t)},Uv.prototype.set=function(t,e){e=jp("DocumentReference.set",e);try{return function(t,e,n){t=Gp(t,Zd);var r=Gp(t.firestore,Sd),e=fg(t.ff,e,n);return Yd(r,[By(ky(r),"setDoc",t.lf,e,null!==t.ff,n).Pf(t.lf,Fs.an())])}(this._,t,e)}catch(t){throw Fv(t,"setDoc()","DocumentReference.set()")}},Uv.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Hd(this._,t):Hd.apply(void 0,f([this._,t,e],n))}catch(t){throw Fv(t,"updateDoc()","DocumentReference.update()")}},Uv.prototype.delete=function(){return Yd(Gp((t=this._).firestore,Sd),[new ou(t.lf,Fs.an())]);var t},Uv.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Bv(t),i=zv(t,function(t){return new Qv(e.firestore,new Cd(e.firestore._,e.hf,t.lf,t._f,t.metadata,e._.ff))});return Wd(this._,r,i)},Uv.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=Gp(e,Zd);var n=Gp(e.firestore,Sd),t=Ov(n),r=new Gd(n);return function(n,r){var t=this,i=new Pa;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.sa.hs(t,e)}))];case 1:return(r=t.sent())instanceof vu?s.resolve(r):r instanceof gu?s.resolve(null):s.reject(new Nr(Ar.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),r=ec(r,"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})},[4,lv(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.lf).then(function(t){return new Cd(n,r,e.lf,t,new Zv(t instanceof vu&&t.ln,!0),e.ff)})}:"server"===(null==t?void 0:t.source)?function(e){e=Gp(e,Zd);var n=Gp(e.firestore,Sd);return vv(Ov(n),e.lf,{source:"server"}).then(function(t){return Xd(n,e,t)})}:function(e){e=Gp(e,Zd);var n=Gp(e.firestore,Sd);return vv(Ov(n),e.lf).then(function(t){return Xd(n,e,t)})})(this._).then(function(t){return new Qv(e.firestore,new Cd(e.firestore._,e.hf,t.lf,t._f,t.metadata,e._.ff))})},Uv.prototype.withConverter=function(t){return new Uv(this.firestore,this._.withConverter(t))},Uv);function Uv(t,e){var n=this;return(n=Pv.call(this,e)||this).firestore=t,n.hf=new fd(t),n}function jv(){return null!==Rv&&Rv.apply(this,arguments)||this}function qv(t,e){var n=this;return(n=Lv.call(this,e)||this).uf=t,n}function Fv(t,e,n){return t.message=t.message.replace(e,n),t}function Bv(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Bd(r))return r}return{}}function zv(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=Bd(t[0])?t[0]:Bd(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var Gv,Kv,Hv,Wv,Yv,Xv,Zv=(cg.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},cg),Qv=(h(ag,Xv=Kr),Object.defineProperty(ag.prototype,"ref",{get:function(){return new Mv(this.uf,this._.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(ag.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(ag.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(ag.prototype,"exists",{get:function(){return this._.exists()},enumerable:!1,configurable:!0}),ag.prototype.data=function(t){return this._.data(t)},ag.prototype.get=function(t,e){return this._.get(t,e)},ag.prototype.isEqual=function(t){return Fd(this._,t._)},ag),Jv=(h(ug,Yv=Qv),ug.prototype.data=function(t){return this._.data(t)},ug),$v=(h(sg,Wv=Kr),sg.prototype.where=function(t,e,n){try{return new sg(this.firestore,ty(this._,(r=n,i=e,o=Ad("where",t),new sy(o,i,r))))}catch(t){throw Fv(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},sg.prototype.orderBy=function(n,t){try{return new sg(this.firestore,ty(this._,function(t){void 0===t&&(t="asc");var e=t,t=Ad("orderBy",n);return new uy(t,e)}(t)))}catch(n){throw Fv(n,/(orderBy|where)\(\)/,"Query.$1()")}},sg.prototype.limit=function(t){try{return new sg(this.firestore,ty(this._,(Kp("limit",e=t),new ay("limit",e,"F"))))}catch(t){throw Fv(t,"limit()","Query.limit()")}var e},sg.prototype.limitToLast=function(t){try{return new sg(this.firestore,ty(this._,(Kp("limitToLast",e=t),new ay("limitToLast",e,"L"))))}catch(t){throw Fv(t,"limitToLast()","Query.limitToLast()")}var e},sg.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new sg(this.firestore,ty(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new cy("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw Fv(t,"startAt()","Query.startAt()")}},sg.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new sg(this.firestore,ty(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new cy("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw Fv(t,"startAfter()","Query.startAfter()")}},sg.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new sg(this.firestore,ty(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new hy("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw Fv(t,"endBefore()","Query.endBefore()")}},sg.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new sg(this.firestore,ty(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new hy("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw Fv(t,"endAt()","Query.endAt()")}},sg.prototype.isEqual=function(t){return Oy(this._,t._)},sg.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=Gp(e,Qd);var n=Gp(e.firestore,Sd),t=Ov(n),r=new Gd(n);return function(n,r){var t=this,i=new Pa;return n.Ei.yi(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,ff(r,i,!0)];case 1:return n=t.sent(),e=new gl(i,n.la),n=e.Gh(n.documents),n=e.es(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),n=ec(n,"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})},[4,lv(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.Rf).then(function(t){return new Md(n,r,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){e=Gp(e,Qd);var n=Gp(e.firestore,Sd),t=Ov(n),r=new Gd(n);return gv(t,e.Rf,{source:"server"}).then(function(t){return new Md(n,r,e,t)})}:function(e){e=Gp(e,Qd);var n=Gp(e.firestore,Sd),t=Ov(n),r=new Gd(n);return by(e.Rf),gv(t,e.Rf).then(function(t){return new Md(n,r,e,t)})})(this._).then(function(t){return new eg(e.firestore,new Md(e.firestore._,e.hf,e._,t.mf))})},sg.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Bv(t),i=zv(t,function(t){return new eg(e.firestore,new Md(e.firestore._,e.hf,e._,t.mf))});return Wd(this._,r,i)},sg.prototype.withConverter=function(t){return new sg(this.firestore,this._.withConverter(t))},sg),tg=(h(og,Hv=Kr),Object.defineProperty(og.prototype,"type",{get:function(){return this._.type},enumerable:!1,configurable:!0}),Object.defineProperty(og.prototype,"doc",{get:function(){return new Jv(this.uf,this._.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(og.prototype,"oldIndex",{get:function(){return this._.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(og.prototype,"newIndex",{get:function(){return this._.newIndex},enumerable:!1,configurable:!0}),og),eg=(h(ig,Kv=Kr),Object.defineProperty(ig.prototype,"query",{get:function(){return new $v(this.uf,this._.query)},enumerable:!1,configurable:!0}),Object.defineProperty(ig.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(ig.prototype,"size",{get:function(){return this._.size},enumerable:!1,configurable:!0}),Object.defineProperty(ig.prototype,"empty",{get:function(){return this._.empty},enumerable:!1,configurable:!0}),Object.defineProperty(ig.prototype,"docs",{get:function(){var e=this;return this._.docs.map(function(t){return new Jv(e.uf,t)})},enumerable:!1,configurable:!0}),ig.prototype.docChanges=function(t){var e=this;return this._.docChanges(t).map(function(t){return new tg(e.uf,t)})},ig.prototype.forEach=function(e,n){var r=this;this._.forEach(function(t){e.call(n,new Jv(r.uf,t))})},ig.prototype.isEqual=function(t){return Fd(this._,t._)},ig),ng=(h(rg,Gv=$v),Object.defineProperty(rg.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(rg.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Object.defineProperty(rg.prototype,"parent",{get:function(){var t=this._.parent;return t?new Mv(this.firestore,t):null},enumerable:!1,configurable:!0}),rg.prototype.doc=function(t){try{return new Mv(this.firestore,void 0===t?Ay(this._):Ay(this._,t))}catch(t){throw Fv(t,"doc()","CollectionReference.doc()")}},rg.prototype.add=function(t){var e,n,r,i=this;return e=this._,n=t,t=Gp(e.firestore,Sd),r=Ay(e),n=fg(e.ff,n),Yd(t,[By(ky(e.firestore),"addDoc",r.lf,n,null!==e.ff,{}).Pf(r.lf,Fs.exists(!1))]).then(function(){return r}).then(function(t){return new Mv(i.firestore,t)})},rg.prototype.isEqual=function(t){return Dy(this._,t._)},rg.prototype.withConverter=function(t){return new rg(this.firestore,this._.withConverter(t))},rg);function rg(t,e){var n=this;return(n=Gv.call(this,t,e)||this).firestore=t,n._=e,n}function ig(t,e){var n=this;return(n=Kv.call(this,e)||this).uf=t,n}function og(t,e){var n=this;return(n=Hv.call(this,e)||this).uf=t,n}function sg(t,e){var n=this;return(n=Wv.call(this,e)||this).firestore=t,n.hf=new fd(t),n}function ug(){return null!==Yv&&Yv.apply(this,arguments)||this}function ag(t,e){var n=this;return(n=Xv.call(this,e)||this).uf=t,n}function cg(t,e){this.hasPendingWrites=t,this.fromCache=e}function hg(t){return t instanceof Kr&&(t=t._),Gp(t,Zd)}function fg(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var lg,pg,Ie=(h(gg,pg=Kr),gg.documentId=function(){return new gg(di.ot().et())},gg.prototype.isEqual=function(t){return t instanceof Kr&&(t=t._),t instanceof xd&&this._.df.isEqual(t.df)},gg),o=(h(vg,lg=Kr),vg.serverTimestamp=function(){var t=new rd("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new vg(t)},vg.delete=function(){var t=new Yp("deleteField");return t._methodName="FieldValue.delete",new vg(t)},vg.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new id("arrayUnion",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayUnion",new vg(n)},vg.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new od("arrayRemove",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayRemove",new vg(n)},vg.increment=function(t){t=new sd("increment",t);return t._methodName="FieldValue.increment",new vg(t)},vg.prototype.isEqual=function(t){return this._.isEqual(t._)},vg),dg=(yg.prototype.onProgress=function(t,e,n){this.Ed={next:t,error:e,complete:n}},yg.prototype.catch=function(t){return this.Td.promise.catch(t)},yg.prototype.then=function(t,e){return this.Td.promise.then(t,e)},yg.prototype.Rl=function(t){this.Pl(t),this.Ed.complete&&this.Ed.complete(),this.Td.resolve(t)},yg.prototype.yl=function(t){this.md.taskState="Error",this.Ed.next&&this.Ed.next(this.md),this.Ed.error&&this.Ed.error(t),this.Td.reject(t)},yg.prototype.Pl=function(t){this.md=t,this.Ed.next&&this.Ed.next(t)},yg);function yg(){this.Ed={},this.Td=new Pa,this.md={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}function vg(){return null!==lg&&lg.apply(this,arguments)||this}function gg(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return pg.call(this,new(xd.bind.apply(xd,f([void 0],t))))||this}var mg=(wg.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},wg.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},wg.prototype.setServiceProps=function(t){return this.serviceProps=t,this},wg);function wg(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var bg,Eg,Ig={Firestore:Av,GeoPoint:ud,Timestamp:hi,Blob:Zr,Transaction:Cv,WriteBatch:Vv,DocumentReference:Mv,DocumentSnapshot:Qv,Query:$v,QueryDocumentSnapshot:Jv,QuerySnapshot:eg,CollectionReference:ng,FieldPath:Ie,FieldValue:o,setLogLevel:function(t){Sr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(bg=e.default).INTERNAL.registerComponent(new mg("firestore",function(t){var e=t.getProvider("app").getImmediate();return e=e,t=t.getProvider("auth-internal"),new Av(e,new Sd(e,t),new _v)},"PUBLIC").setServiceProps(Object.assign({},Ig))),bg.registerVersion("@firebase/firestore","2.0.5-BundlePrerelease.dee1ef083"),(Eg=Av).prototype.loadBundle=function(t){return e=this,o=t,t=new dg,function(n,t,r){var e=this,i=function(t,e){t="string"==typeof t?(new TextEncoder).encode(t):t;return new Kh(Bh(t),e)}(o,zh(t));n.Ei.yi(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Zl,[4,dv(n)];case 1:return e.apply(void 0,[t.sent(),i,r]),[2]}})})})}(Ov(e._),e.q_,t),t;var e,o},Eg.prototype.namedQuery=function(t){return t=t,function(n,r){var t=this;return n.Ei.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){var n=t;return n.persistence.runTransaction("Get named query","readonly",function(t){return n.tc.wo(t,e)})},[4,lv(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}(Ov((e=this)._),t).then(function(t){return t?new $v(e,new Qd(e._,null,t.query)):null});var e}}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.js.map
