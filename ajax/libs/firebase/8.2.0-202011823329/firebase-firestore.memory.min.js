!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Nd){"use strict";try{(function(){var u,t,e=(t=Nd)&&"object"==typeof t&&"default"in t?t:{default:t};function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function n(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=a[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(ge=u=u||{})[ge.DEBUG=0]="DEBUG",ge[ge.VERBOSE=1]="VERBOSE",ge[ge.INFO=2]="INFO",ge[ge.WARN=3]="WARN",ge[ge.ERROR=4]="ERROR",ge[ge.SILENT=5]="SILENT";var r={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},i=u.INFO,a=((me={})[u.DEBUG]="log",me[u.VERBOSE]="log",me[u.INFO]="info",me[u.WARN]="warn",me[u.ERROR]="error",me),o=(Object.defineProperty(c.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),c.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?r[t]:t},Object.defineProperty(c.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),c.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},c.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},c.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},c.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},c.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},c);function c(t){this.name=t,this._logLevel=i,this._logHandler=n,this._userLogHandler=null}var h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function f(t,e){function n(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function l(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(f(w,d=Error),w);function w(t,e,n){return(e=d.call(this,e)||this).code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(_.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=(t=this.errors[t])?(r=i,t.replace(E,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},_);function _(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var E=/\{\$([^}]+)}/g,I=function(t,e){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function T(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},N=A||self;function O(){}function S(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function R(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var L="closure_uid_"+(1e9*Math.random()>>>0),k=0;function D(t,e,n){return t.call.apply(t.bind,arguments)}function P(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function C(t,e,n){return(C=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?D:P).apply(null,arguments)}function U(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function V(){return Date.now()}function x(t,o){function e(){}e.prototype=o.prototype,t.X=o.prototype,t.prototype=new e,(t.prototype.constructor=t).Kb=function(t,e,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[e].apply(t,r)}}function M(){this.j=this.j,this.i=this.i}M.prototype.j=!1,M.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,L)&&this[L]||(this[L]=++k))},M.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var j=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},q=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function F(){return Array.prototype.concat.apply([],arguments)}function B(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function G(t){return/^[\s\xa0]*$/.test(t)}var z=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function H(t,e){return-1!=t.indexOf(e)}function W(t,e){return t<e?-1:e<t?1:0}var Y=N.navigator;function Q(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function K(t){var e,n={};for(e in t)n[e]=t[e];return n}ut=(Y=Y&&Y.userAgent)?Y:"";var X="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function J(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<X.length;i++)e=X[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function $(t){return $[" "](t),t}$[" "]=O;var Z,tt=H(ut,"Opera"),et=H(ut,"Trident")||H(ut,"MSIE"),nt=H(ut,"Edge"),rt=nt||et,it=H(ut,"Gecko")&&!(H(ut.toLowerCase(),"webkit")&&!H(ut,"Edge"))&&!(H(ut,"Trident")||H(ut,"MSIE"))&&!H(ut,"Edge"),ot=H(ut.toLowerCase(),"webkit")&&!H(ut,"Edge");function st(){var t=N.document;return t?t.documentMode:void 0}var Y="",ut=(ut=ut,it?/rv:([^\);]+)(\)|;)/.exec(ut):nt?/Edge\/([\d\.]+)/.exec(ut):et?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ut):ot?/WebKit\/(\S+)/.exec(ut):tt?/(?:Version)[ \/]?(\S+)/.exec(ut):void 0);ut&&(Y=ut?ut[1]:""),Z=et&&null!=(ut=st())&&ut>parseFloat(Y)?String(ut):Y;var at={};function ct(u){return t=u,e=function(){for(var t=0,e=z(String(Z)).split("."),n=z(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++)for(var o=e[i]||"",s=n[i]||"";o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],(0!=o[0].length||0!=s[0].length)&&(t=W(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||W(0==o[2].length,0==s[2].length)||W(o[2],s[2]),o=o[3],s=s[3],0==t););return 0<=t},n=at,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var ht=N.document&&et&&(st()||parseInt(Z,10))||void 0,ft=!et||9<=Number(ht),lt=et&&!ct("9"),pt=function(){if(!N.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{N.addEventListener("test",O,e),N.removeEventListener("test",O,e)}catch(t){}return t}();function dt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function yt(t,e){if(dt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(it){t:{try{$(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:vt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}dt.prototype.b=function(){this.defaultPrevented=!0},x(yt,dt);var vt={2:"touch",3:"pen",4:"mouse"};yt.prototype.b=function(){yt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,lt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var gt="closure_listenable_"+(1e6*Math.random()|0),mt=0;function wt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++mt,this.Y=this.Z=!1}function bt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function _t(t){this.src=t,this.a={},this.b=0}function Et(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=j(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(bt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function It(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}_t.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=It(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new wt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Tt="closure_lm_"+(1e6*Math.random()|0),At={};function Nt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Ct(r),e&&e[gt]?e.wa(n,r,R(i)?!!i.capture:!!i,o):Ot(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Nt(t,e[o],n,r,i);return null}return n=Ct(n),t&&t[gt]?t.va(e,n,R(r)?!!r.capture:!!r,i):Ot(t,e,n,!1,r,i)}function Ot(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=R(i)?!!i.capture:!!i;if(s&&!ft)return null;var u,a,c=Dt(t);if(c||(t[Tt]=c=new _t(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=kt,r=a=ft?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)pt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Rt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function St(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[gt]?Et(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Rt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Dt(e))?(Et(n,t),0==n.b&&(n.src=null,e[Tt]=null)):bt(t)))}function Rt(t){return t in At?At[t]:At[t]="on"+t}function Lt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&St(t),n.call(r,e)}function kt(t,e){if(t.Y)return!0;if(ft)return Lt(t,new yt(e,this));if(!e)t:{e=["window","event"];for(var n=N,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Lt(t,e=new yt(e,this))}function Dt(t){return(t=t[Tt])instanceof _t?t:null}var Pt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ct(e){return"function"==typeof e?e:(e[Pt]||(e[Pt]=function(t){return e.handleEvent(t)}),e[Pt])}function Ut(){M.call(this),this.c=new _t(this),(this.J=this).C=null}function Vt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new dt(e,t):e instanceof dt?e.target=e.target||t:(s=e,J(e=new dt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=xt(o,r,!0,e)&&s;if(s=xt(o=e.a=t,r,!0,e)&&s,s=xt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=xt(o=e.a=n[i],r,!1,e)&&s}function xt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Et(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}x(Ut,M),Ut.prototype[gt]=!0,(ut=Ut.prototype).addEventListener=function(t,e,n,r){Nt(this,t,e,n,r)},ut.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=R(i)?!!i.capture:!!i,r=Ct(r),e&&e[gt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=It(s=e.a[n],r,i,o))&&(bt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Dt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=It(n,r,i,o)),(r=-1<e?n[e]:null)&&St(r))}(this,t,e,n,r)},ut.G=function(){if(Ut.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)bt(n[r]);delete e.a[t],e.b--}}this.C=null},ut.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},ut.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Mt=N.JSON.stringify;function jt(){this.b=this.a=null}var qt,Ft=(Bt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Bt(function(){return new Gt},function(t){t.reset()}));function Bt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Gt(){this.next=this.b=this.a=null}function zt(t,e){var n;qt||(n=N.Promise.resolve(void 0),qt=function(){n.then(Yt)}),Ht||(qt(),Ht=!0),Wt.add(t,e)}jt.prototype.add=function(t,e){var n=Ft.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Gt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Ht=!(Gt.prototype.reset=function(){this.next=this.b=this.a=null}),Wt=new jt;function Yt(){for(var t,e;n=e=void 0,n=null,(e=Wt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){N.setTimeout(function(){throw t},0)}(t)}var n=Ft;n.f(t),n.b<100&&(n.b++,t.next=n.a,n.a=t)}Ht=!1}function Qt(t,e){Ut.call(this),this.b=t||1,this.a=e||N,this.f=C(this.Za,this),this.g=V()}function Kt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Xt(t,e,n){if("function"==typeof t)n&&(t=C(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=C(t.handleEvent,t)}return 2147483647<Number(e)?-1:N.setTimeout(t,e||0)}x(Qt,Ut),(ut=Qt.prototype).aa=!1,ut.M=null,ut.Za=function(){var t;this.aa&&(0<(t=V()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Vt(this,"tick"),this.aa&&(Kt(this),this.start())))},ut.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=V())},ut.G=function(){Qt.X.G.call(this),Kt(this),delete this.a};var Jt,$t,Zt=(I($t=ee,Y=Jt=M),$t.prototype=null===Y?Object.create(Y):(te.prototype=Y.prototype,new te),ee.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=Xt(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ee.prototype.G=function(){Jt.prototype.G.call(this),this.a&&(N.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ee);function te(){this.constructor=$t}function ee(t,e){var n=Jt.call(this)||this;return n.g=t,n.h=e,n.b=null,n.c=!1,n.a=null,n}function ne(t){M.call(this),this.b=t,this.a={}}x(ne,M);var re=[];function ie(t,e,n,r){Array.isArray(n)||(n&&(re[0]=n.toString()),n=re);for(var i=0;i<n.length;i++){var o=Nt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function oe(t){Q(t.a,function(t,e){this.a.hasOwnProperty(e)&&St(t)},t),t.a={}}function se(){this.a=!0}function ue(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return Mt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ne.prototype.G=function(){ne.X.G.call(this),oe(this)},ne.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},se.prototype.info=function(){};var ae={},ce=null;function he(){return ce=ce||new Ut}function fe(t){dt.call(this,ae.Fa,t)}function le(){var t=he();Vt(t,new fe(t))}function pe(t,e){dt.call(this,ae.STAT_EVENT,t),this.stat=e}function de(t){var e=he();Vt(e,new pe(e,t))}function ye(t){dt.call(this,ae.Ga,t)}function ve(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return N.setTimeout(function(){t()},e)}ae.Fa="serverreachability",x(fe,dt),ae.STAT_EVENT="statevent",x(pe,dt),ae.Ga="timingevent",x(ye,dt);var ge={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},me={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function we(){}function be(t){var e;return(e=t.a)||(e=t.a={}),e}function _e(){}we.prototype.a=null;var Ee,A={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Ie(){dt.call(this,"d")}function Te(){dt.call(this,"c")}function Ae(){}function Ne(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ne(this),this.P=Oe,t=rt?125:void 0,this.R=new Qt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}x(Ie,dt),x(Te,dt),x(Ae,we),Ee=new Ae;var Oe=45e3,Se={},Re={};function Le(t,e,n){t.H=1,t.i=Je(He(e)),t.j=n,t.I=!0,ke(t,null)}function ke(t,e){t.u=V(),Pe(t),t.l=He(t.i);var s,u,a,c,h,f,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),fn(n.b,"t",r),t.D=0,t.a=ir(t.g,t.g.C?e:null),0<t.O&&(t.F=new Zt(C(t.Ca,t,t.a),t.O)),ie(t.J,t.a,"readystatechange",t.Xa),e=t.B?K(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),le(),s=t.c,u=t.m,a=t.l,c=t.f,h=t.S,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function De(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Re:(i=Number(u.substring(i,o)),isNaN(i)?Se:(o+=1)+i>u.length?Re:(u=u.substr(o,i),r.D=o+i,u)));if(u==Re){4==e&&(t.h=4,de(14),s=!1),ue(t.c,t.f,null,"[Incomplete Response]");break}if(u==Se){t.h=4,de(15),ue(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}ue(t.c,t.f,u,null),Me(t,u)}4==e&&0==n.length&&(t.h=1,de(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Xn(e),e.F=!0,de(11))):(ue(t.c,t.f,n,"[Invalid Chunked Response]"),xe(t),Ve(t))}function Pe(t){t.T=V()+t.P,Ce(t,t.P)}function Ce(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=ve(C(t.Va,t),e)}function Ue(t){t.o&&(N.clearTimeout(t.o),t.o=null)}function Ve(t){0==t.g.v||t.A||Zn(t.g,t)}function xe(t){Ue(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Kt(t.R),oe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Me(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||mn(u.b,t)))if(u.I=t.N,!t.C&&mn(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;$n(u),Fn(u)}Kn(u),de(18)}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=ve(C(u.Sa,u),6e3));if(gn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else er(u,11)}else if(!t.C&&u.a!=t||$n(u),!G(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(H(r,"spdy")||H(r,"quic")||H(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(wn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,Xe(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=V()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=rr(n,n.C?n.ga:null,n.fa),i.C?(bn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Ue(o),Pe(o)),n.a=i):Qn(n),0<u.g.length&&zn(u)):"stop"!=c[0]&&"close"!=c[0]||er(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?er(u,7):qn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0);le()}catch(t){}}function je(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(S(t)||"string"==typeof t)q(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(S(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(S(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function qe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof qe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Fe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Be(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Be(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Be(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(ut=Ne.prototype).setTimeout=function(t){this.P=t},ut.Xa=function(t){t=t.target;var e=this.F;e&&3==Vn(t)?e.f():this.Ca(t)},ut.Ca=function(t){try{if(t==this.a)t:{var e=Vn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!rt&&!this.a.$())){this.A||4!=e||7==n||le(),Ue(this);var i=this.a.W();if(this.N=i,n=this.a.$(),this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.S,f=e,l=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+f+" "+l}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!G(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,de(12),xe(this),Ve(this);break t}ue(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Me(this,s)}this.I?(De(this,e,n),rt&&this.b&&3==e&&(ie(this.J,this.R,"tick",this.Wa),this.R.start())):(ue(this.c,this.f,n,null),Me(this,n)),4==e&&xe(this),this.b&&!this.A&&(4==e?Zn(this.g,this):(this.b=!1,Pe(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,de(12)):(this.h=0,de(13)),xe(this),Ve(this)}}}catch(t){}var u,a,c,h,f,l},ut.Wa=function(){var t,e;this.a&&(t=Vn(this.a),e=this.a.$(),this.D<e.length&&(Ue(this),De(this,t,e),this.b&&4!=t&&Pe(this)))},ut.cancel=function(){this.A=!0,xe(this)},ut.Va=function(){this.o=null;var t,e,n=V();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(le(),de(17)),xe(this),this.h=2,Ve(this)):Ce(this,this.T-n)},(ut=qe.prototype).K=function(){Fe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},ut.L=function(){return Fe(this),this.a.concat()},ut.get=function(t,e){return Be(this.b,t)?this.b[t]:e},ut.set=function(t,e){Be(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},ut.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ge=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function ze(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof ze?(this.a=void 0!==e?e:t.a,We(this,t.f),this.j=t.j,Ye(this,t.c),Qe(this,t.h),this.g=t.g,e=t.b,(n=new un).c=e.c,e.a&&(n.a=new qe(e.a),n.b=e.b),Ke(this,n),this.i=t.i):t&&(n=String(t).match(Ge))?(this.a=!!e,We(this,n[1]||"",!0),this.j=$e(n[2]||""),Ye(this,n[3]||"",!0),Qe(this,n[4]),this.g=$e(n[5]||"",!0),Ke(this,n[6]||"",!0),this.i=$e(n[7]||"")):(this.a=!!e,this.b=new un(null,this.a))}function He(t){return new ze(t)}function We(t,e,n){t.f=n?$e(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ye(t,e,n){t.c=n?$e(e,!0):e}function Qe(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Ke(t,e,n){var r,i;e instanceof un?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(an(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(cn(this,e),fn(this,n,t))},r)),r.f=i):(n||(e=Ze(e,on)),t.b=new un(e,t.a))}function Xe(t,e,n){t.b.set(e,n)}function Je(t){return Xe(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^V()).toString(36)),t}function $e(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ze(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,tn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function tn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}ze.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Ze(e,en,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(Ze(e,en,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Ze(n,"/"==n.charAt(0)?rn:nn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Ze(n,sn)),t.join("")};var en=/[#\/\?@]/g,nn=/[#\?:]/g,rn=/[#\?]/g,on=/[#\?@]/g,sn=/#/g;function un(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function an(o){o.a||(o.a=new qe,o.b=0,o.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],r=n,i=i?decodeURIComponent(i.replace(/\+/g," ")):"",o.add(decodeURIComponent(r.replace(/\+/g," ")),i)}}}(o.c))}function cn(t,e){an(t),e=ln(t,e),Be(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Be((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Fe(t)))}function hn(t,e){return an(t),e=ln(t,e),Be(t.a.b,e)}function fn(t,e,n){cn(t,e),0<n.length&&(t.c=null,t.a.set(ln(t,e),B(n)),t.b+=n.length)}function ln(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(ut=un.prototype).add=function(t,e){an(this),this.c=null,t=ln(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},ut.forEach=function(n,r){an(this),this.a.forEach(function(t,e){q(t,function(t){n.call(r,t,e,this)},this)},this)},ut.L=function(){an(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},ut.K=function(t){an(this);var e=[];if("string"==typeof t)hn(this,t)&&(e=F(e,this.a.get(ln(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=F(e,t[n])}return e},ut.set=function(t,e){return an(this),this.c=null,hn(this,t=ln(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},ut.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},ut.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};function pn(t,e){this.b=t,this.a=e}function dn(t){this.g=t||yn,t=N.PerformanceNavigationTiming?0<(t=N.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(N.ia&&N.ia.ya&&N.ia.ya()&&N.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var yn=10;function vn(t){return t.b||t.a&&t.a.size>=t.f}function gn(t){return t.b?1:t.a?t.a.size:0}function mn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function wn(t,e){t.a?t.a.add(e):t.b=e}function bn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function _n(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return B(t.c);var r=t.c;try{for(var i=T(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function En(){}function In(){this.a=new En}function Tn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}dn.prototype.cancel=function(){var t,e;if(this.c=_n(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=T(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},En.prototype.stringify=function(t){return N.JSON.stringify(t,void 0)},En.prototype.parse=function(t){return N.JSON.parse(t,void 0)};var An=N.JSON.parse;function Nn(t){Ut.call(this),this.headers=new qe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=On,this.D=this.F=!1}x(Nn,Ut);var On="",Sn=/^https?$/i,Rn=["POST","PUT"];function Ln(t){return"content-type"==t.toLowerCase()}function kn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Dn(t),Cn(t)}function Dn(t){t.u||(t.u=!0,Vt(t,"complete"),Vt(t,"error"))}function Pn(t){if(t.b&&(!t.s[1]||4!=Vn(t)||2!=t.W()))if(t.l&&4==Vn(t))Xt(t.za,0,t);else if(Vt(t,"readystatechange"),4==Vn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Ge)[1]||null)&&N.self&&N.self.location&&(i=(r=N.self.location.protocol).substr(0,r.length-1)),n=!Sn.test(i?i.toLowerCase():"")),e=n),e)Vt(t,"complete"),Vt(t,"success");else{t.h=6;try{var u=2<Vn(t)?t.a.statusText:""}catch(o){u=""}t.f=u+" ["+t.W()+"]",Dn(t)}}finally{Cn(t)}}}function Cn(t,e){if(t.a){Un(t);var n=t.a,r=t.s[0]?O:null;t.a=null,t.s=null,e||Vt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Un(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(N.clearTimeout(t.m),t.m=null)}function Vn(t){return t.a?t.a.readyState:0}function xn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",Q(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Xe(t,e,n))}function Mn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function jn(t){this.pa=0,this.g=[],this.c=new se,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Mn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Mn("baseRetryDelayMs",5e3,t),this.Ra=Mn("retryDelaySeedMs",1e4,t),this.Ma=Mn("forwardChannelMaxRetries",2,t),this.ma=Mn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new dn(t&&t.concurrentRequestLimit),this.ka=new In,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function qn(t){var e,n;Bn(t),3==t.v&&(e=t.R++,Xe(n=He(t.B),"SID",t.J),Xe(n,"RID",e),Xe(n,"TYPE","terminate"),Wn(t,n),(e=new Ne(t,t.c,e,void 0)).H=2,e.i=Je(He(n)),n=!1,N.navigator&&N.navigator.sendBeacon&&(n=N.navigator.sendBeacon(e.i.toString(),"")),!n&&N.Image&&((new Image).src=e.i,n=!0),n||(e.a=ir(e.g,null),e.a.ba(e.i)),e.u=V(),Pe(e)),nr(t)}function Fn(t){t.a&&(Xn(t),t.a.cancel(),t.a=null)}function Bn(t){Fn(t),t.j&&(N.clearTimeout(t.j),t.j=null),$n(t),t.b.cancel(),t.h&&("number"==typeof t.h&&N.clearTimeout(t.h),t.h=null)}function Gn(t,e){t.g.push(new pn(t.Oa++,e)),3==t.v&&zn(t)}function zn(t){vn(t.b)||t.h||(t.h=!0,zt(t.Ba,t),t.u=0)}function Hn(t,e){var n=e?e.f:t.R++,r=He(t.B);Xe(r,"SID",t.J),Xe(r,"RID",n),Xe(r,"AID",t.P),Wn(t,r),t.i&&t.l&&xn(r,t.i,t.l),n=new Ne(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Yn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),wn(t.b,n),Le(n,r,e)}function Wn(t,n){t.f&&je({},function(t,e){Xe(n,e,t)})}function Yn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?C(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+c+"_"||"";try{je(t,function(t,e){var n=t;R(t)&&(n=Mt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s)}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Qn(t){t.a||t.j||(t.T=1,zt(t.Aa,t),t.o=0)}function Kn(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=ve(C(t.Aa,t),tr(t,t.o)),t.o++,1)}function Xn(t){null!=t.s&&(N.clearTimeout(t.s),t.s=null)}function Jn(t){t.a=new Ne(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=He(t.la);Xe(e,"RID","rpc"),Xe(e,"SID",t.J),Xe(e,"CI",t.H?"0":"1"),Xe(e,"AID",t.P),Wn(t,e),Xe(e,"TYPE","xmlhttp"),t.i&&t.l&&xn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=Je(He(e)),n.j=null,n.I=!0,ke(n,t)}function $n(t){null!=t.m&&(N.clearTimeout(t.m),t.m=null)}function Zn(t,e){var n,r,i,o=null;if(t.a==e){$n(t),Xn(t),t.a=null;var s=2}else{if(!mn(t.b,e))return;o=e.s,bn(t.b,e),s=1}if(t.I=e.N,0!=t.v)if(e.b)1==s?(o=e.j?e.j.length:0,e=V()-e.u,n=t.u,Vt(s=he(),new ye(s)),zn(t)):Qn(t);else if(3==(n=e.h)||0==n&&0<t.I||(1!=s||(i=e,gn((r=t).b)>=r.b.f-(r.h?1:0)||(r.h?(r.g=i.s.concat(r.g),0):1==r.v||2==r.v||r.u>=(r.La?0:r.Ma)||(r.h=ve(C(r.Ba,r,i),tr(r,r.u)),r.u++,0))))&&(2!=s||!Kn(t)))switch(o&&0<o.length&&(e=t.b,e.c=e.c.concat(o)),n){case 1:er(t,5);break;case 4:er(t,10);break;case 3:er(t,6);break;default:er(t,2)}}function tr(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function er(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=C(t.Ya,t),r||(r=new ze("//www.google.com/images/cleardot.gif"),N.location&&"http"==N.location.protocol||We(r,"https"),Je(r)),n=r.toString(),r=o,o=new se,N.Image?((i=new Image).onload=U(Tn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=U(Tn,o,i,"TestLoadImage: error",!1,r),i.onabort=U(Tn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=U(Tn,o,i,"TestLoadImage: timeout",!1,r),N.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):de(2),t.v=0,t.f&&t.f.ra(e),nr(t),Bn(t)}function nr(t){t.v=0,t.I=-1,t.f&&(0==_n(t.b).length&&0==t.g.length||(t.b.c.length=0,B(t.g),t.g.length=0),t.f.qa())}function rr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof ze?He(s):new ze(s,void 0);return""!=a.c?(e&&Ye(a,e+"."+a.c),Qe(a,a.h)):(r=(u=N.location).protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new ze(null,void 0),r&&We(u,r),i&&Ye(u,i),o&&Qe(u,o),s&&(u.g=s),a=u),t.V&&Q(t.V,function(t,e){Xe(a,e,t)}),e=t.A,n=t.na,e&&n&&Xe(a,e,n),Xe(a,"VER",t.ha),Wn(t,a),a}function ir(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Nn(t.Na)).F=t.C,e}function or(){}function sr(){if(et&&!(10<=Number(ht)))throw Error("Environmental error: no available transport.")}function ur(t,e){Ut.call(this),this.a=new jn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!G(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!G(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new hr(this)}function ar(t){Ie.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function cr(){Te.call(this),this.status=1}function hr(t){this.a=t}(ut=Nn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?be(this.H):be(Ee),this.a.onreadystatechange=C(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void kn(this,t)}t=n||"";var i,o=new qe(this.headers);r&&je(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Ln,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=N.FormData&&t instanceof N.FormData,0<=j(Rn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Un(this),0<this.o&&((this.D=(i=this.a,et&&ct(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=C(this.xa,this)):this.m=Xt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){kn(this,t)}},ut.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Vt(this,"timeout"),this.abort(8))},ut.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Vt(this,"complete"),Vt(this,"abort"),Cn(this))},ut.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Cn(this,!0)),Nn.X.G.call(this)},ut.za=function(){this.j||(this.A||this.l||this.g?Pn(this):this.Ua())},ut.Ua=function(){Pn(this)},ut.W=function(){try{return 2<Vn(this)?this.a.status:-1}catch(t){return-1}},ut.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},ut.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),An(e)}},ut.ua=function(){return this.h},ut.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(ut=jn.prototype).ha=8,ut.v=1,ut.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ne(this,this.c,t,void 0),r=this.l;if(this.O&&(r?J(r=K(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Yn(this,n,e),Xe(i=He(this.B),"RID",t),Xe(i,"CVER",22),this.A&&Xe(i,"X-HTTP-Session-Id",this.A),Wn(this,i),this.i&&r&&xn(i,this.i,r),wn(this.b,n),this.Ia&&Xe(i,"TYPE","init"),this.da?(Xe(i,"$req",e),Xe(i,"SID","null"),n.U=!0,Le(n,i,null)):Le(n,i,e),this.v=2}}else 3==this.v&&(t?Hn(this,t):0==this.g.length||vn(this.b)||Hn(this))},ut.Aa=function(){var t;this.j=null,Jn(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=ve(C(this.Ta,this),t))},ut.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,de(10),Fn(this),Jn(this))},ut.Sa=function(){null!=this.m&&(this.m=null,Fn(this),Kn(this),de(19))},ut.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),de(2)):(this.c.info("Failed to ping google.com"),de(1))},(ut=or.prototype).ta=function(){},ut.sa=function(){},ut.ra=function(){},ut.qa=function(){},ut.Ja=function(){},sr.prototype.a=function(t,e){return new ur(t,e)},x(ur,Ut),ur.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;de(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=rr(t,null,t.fa),zn(t)},ur.prototype.close=function(){qn(this.a)},ur.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Gn(this.a,e)):this.l?((e={}).__data__=Mt(t),Gn(this.a,e)):Gn(this.a,t)},ur.prototype.G=function(){this.a.f=null,delete this.f,qn(this.a),delete this.a,ur.X.G.call(this)},x(ar,Ie),x(cr,Te),x(hr,or),hr.prototype.ta=function(){Vt(this.a,"a")},hr.prototype.sa=function(t){Vt(this.a,new ar(t))},hr.prototype.ra=function(t){Vt(this.a,new cr)},hr.prototype.qa=function(){Vt(this.a,"b")},sr.prototype.createWebChannel=sr.prototype.a,ur.prototype.send=ur.prototype.h,ur.prototype.open=ur.prototype.g,ge.NO_ERROR=0,ge.TIMEOUT=8,ge.HTTP_ERROR=6,me.COMPLETE="complete",(_e.EventType=A).OPEN="a",A.CLOSE="b",A.ERROR="c",A.MESSAGE="d",Ut.prototype.listen=Ut.prototype.va,Nn.prototype.listenOnce=Nn.prototype.wa,Nn.prototype.getLastError=Nn.prototype.Qa,Nn.prototype.getLastErrorCode=Nn.prototype.ua,Nn.prototype.getStatus=Nn.prototype.W,Nn.prototype.getResponseJson=Nn.prototype.Pa,Nn.prototype.getResponseText=Nn.prototype.$,Nn.prototype.send=Nn.prototype.ba;var fr=he,lr=ge,pr=me,dr=ae,yr=_e,vr=Nn,gr="8.2.0-202011823329",mr=new o("@firebase/firestore");function wr(){return mr.logLevel}function br(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];mr.logLevel<=u.DEBUG&&(e=n.map(Ir),mr.debug.apply(mr,l(["Firestore ("+gr+"): "+t],e)))}function _r(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];mr.logLevel<=u.ERROR&&(e=n.map(Ir),mr.error.apply(mr,l(["Firestore ("+gr+"): "+t],e)))}function Er(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];mr.logLevel<=u.WARN&&(e=n.map(Ir),mr.warn.apply(mr,l(["Firestore ("+gr+"): "+t],e)))}function Ir(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Tr(t){throw void 0===t&&(t="Unexpected state"),_r(t="FIRESTORE ("+gr+") INTERNAL ASSERTION FAILED: "+t),new Error(t)}function Ar(t){t||Tr()}var Nr=(Or.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Or);function Or(){}function Sr(t,e){return t<e?-1:e<t?1:0}function Rr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var Lr=(kr.fromBase64String=function(t){return new kr(atob(t))},kr.fromUint8Array=function(t){return new kr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},kr.prototype.toBase64=function(){return t=this.i,btoa(t);var t},kr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},kr.prototype.o=function(){return 2*this.i.length},kr.prototype.u=function(t){return Sr(this.i,t.i)},kr.prototype.isEqual=function(t){return this.i===t.i},kr);function kr(t){this.i=t}Lr.h=new Lr("");var Dr,Pr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Cr=(f(Mr,Dr=Error),Mr),Ur=(xr.fromBase64String=function(t){try{return new xr(Lr.fromBase64String(t))}catch(t){throw new Cr(Pr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},xr.fromUint8Array=function(t){return new xr(Lr.fromUint8Array(t))},xr.prototype.toBase64=function(){return this.l.toBase64()},xr.prototype.toUint8Array=function(){return this.l.toUint8Array()},xr.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},xr.prototype.isEqual=function(t){return this.l.isEqual(t.l)},xr),Vr=function(t){this._=t};function xr(t){this.l=t}function Mr(t,e){var n=this;return(n=Dr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function jr(){if("undefined"==typeof Uint8Array)throw new Cr(Pr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function qr(){if("undefined"==typeof atob)throw new Cr(Pr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Fr,Br=(f(Hr,Fr=Vr),Hr.fromBase64String=function(t){return qr(),new Hr(Ur.fromBase64String(t))},Hr.fromUint8Array=function(t){return jr(),new Hr(Ur.fromUint8Array(t))},Hr.prototype.toBase64=function(){return qr(),this._.toBase64()},Hr.prototype.toUint8Array=function(){return jr(),this._.toUint8Array()},Hr.prototype.isEqual=function(t){return this._.isEqual(t._)},Hr.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Hr),Gr=(zr.prototype.T=function(){return null!=this.uid},zr.prototype.I=function(){return this.T()?"uid:"+this.uid:"anonymous-user"},zr.prototype.isEqual=function(t){return t.uid===this.uid},zr);function zr(t){this.uid=t}function Hr(){return null!==Fr&&Fr.apply(this,arguments)||this}function Wr(t,e){this.user=e,this.type="OAuth",this.R={},this.R.Authorization="Bearer "+t}Gr.UNAUTHENTICATED=new Gr(null),Gr.m=new Gr("google-credentials-uid"),Gr.A=new Gr("first-party-uid");var Yr=(ui.prototype.getToken=function(){return Promise.resolve(null)},ui.prototype.g=function(){},ui.prototype.V=function(t){(this.P=t)(Gr.UNAUTHENTICATED)},ui.prototype.p=function(){this.P=null},ui),Qr=(si.prototype.getToken=function(){var e=this,n=this.D,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.D!==n?(br("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Ar("string"==typeof t.accessToken),new Wr(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},si.prototype.g=function(){this.forceRefresh=!0},si.prototype.V=function(t){this.P=t,this.S&&t(this.currentUser)},si.prototype.p=function(){this.auth&&this.auth.removeAuthTokenListener(this.v),this.v=null,this.P=null},si.prototype.C=function(){var t=this.auth&&this.auth.getUid();return Ar(null===t||"string"==typeof t),new Gr(t)},si),Kr=(Object.defineProperty(oi.prototype,"R",{get:function(){var t={"X-Goog-AuthUser":this.F},e=this.N.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),oi),Xr=(ii.prototype.getToken=function(){return Promise.resolve(new Kr(this.N,this.F))},ii.prototype.V=function(t){t(Gr.A)},ii.prototype.p=function(){},ii.prototype.g=function(){},ii),Jr=function(t,e,n,r,i,o){this.O=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.k=o},$r=(Object.defineProperty(ri.prototype,"M",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),ri.prototype.isEqual=function(t){return t instanceof ri&&t.projectId===this.projectId&&t.database===this.database},ri),Zr=(ni.prototype.$=function(t){},ni.prototype.L=function(){},ni),ti=(ei.prototype.$=function(t){this.W.push(t)},ei.prototype.L=function(){window.removeEventListener("online",this.B),window.removeEventListener("offline",this.U)},ei.prototype.j=function(){window.addEventListener("online",this.B),window.addEventListener("offline",this.U)},ei.prototype.q=function(){br("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.W;t<e.length;t++)(0,e[t])(0)},ei.prototype.K=function(){br("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.W;t<e.length;t++)(0,e[t])(1)},ei.G=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},ei);function ei(){var t=this;this.B=function(){return t.q()},this.U=function(){return t.K()},this.W=[],this.j()}function ni(){}function ri(t,e){this.projectId=t,this.database=e||"(default)"}function ii(t,e){this.N=t,this.F=e}function oi(t,e){this.N=t,this.F=e,this.type="FirstParty",this.user=Gr.A}function si(t){var e=this;this.v=null,this.currentUser=Gr.UNAUTHENTICATED,this.S=!1,this.D=0,this.P=null,this.forceRefresh=!1,this.v=function(){e.D++,e.currentUser=e.C(),e.S=!0,e.P&&e.P(e.currentUser)},this.D=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.v):(this.v(null),t.get().then(function(t){e.auth=t,e.v&&e.auth.addAuthTokenListener(e.v)},function(){}))}function ui(){this.P=null}function ai(t){return null==t}function ci(t){return 0===t&&1/t==-1/0}var hi,fi={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};function li(t){switch(t){case Pr.OK:return Tr(),0;case Pr.CANCELLED:case Pr.UNKNOWN:case Pr.DEADLINE_EXCEEDED:case Pr.RESOURCE_EXHAUSTED:case Pr.INTERNAL:case Pr.UNAVAILABLE:case Pr.UNAUTHENTICATED:return;case Pr.INVALID_ARGUMENT:case Pr.NOT_FOUND:case Pr.ALREADY_EXISTS:case Pr.PERMISSION_DENIED:case Pr.FAILED_PRECONDITION:case Pr.ABORTED:case Pr.OUT_OF_RANGE:case Pr.UNIMPLEMENTED:case Pr.DATA_LOSS:return 1;default:return Tr(),0}}function pi(t){if(void 0===t)return _r("GRPC error has no .code"),Pr.UNKNOWN;switch(t){case hi.OK:return Pr.OK;case hi.CANCELLED:return Pr.CANCELLED;case hi.UNKNOWN:return Pr.UNKNOWN;case hi.DEADLINE_EXCEEDED:return Pr.DEADLINE_EXCEEDED;case hi.RESOURCE_EXHAUSTED:return Pr.RESOURCE_EXHAUSTED;case hi.INTERNAL:return Pr.INTERNAL;case hi.UNAVAILABLE:return Pr.UNAVAILABLE;case hi.UNAUTHENTICATED:return Pr.UNAUTHENTICATED;case hi.INVALID_ARGUMENT:return Pr.INVALID_ARGUMENT;case hi.NOT_FOUND:return Pr.NOT_FOUND;case hi.ALREADY_EXISTS:return Pr.ALREADY_EXISTS;case hi.PERMISSION_DENIED:return Pr.PERMISSION_DENIED;case hi.FAILED_PRECONDITION:return Pr.FAILED_PRECONDITION;case hi.ABORTED:return Pr.ABORTED;case hi.OUT_OF_RANGE:return Pr.OUT_OF_RANGE;case hi.UNIMPLEMENTED:return Pr.UNIMPLEMENTED;case hi.DATA_LOSS:return Pr.DATA_LOSS;default:return Tr()}}(me=hi={})[me.OK=0]="OK",me[me.CANCELLED=1]="CANCELLED",me[me.UNKNOWN=2]="UNKNOWN",me[me.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",me[me.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",me[me.NOT_FOUND=5]="NOT_FOUND",me[me.ALREADY_EXISTS=6]="ALREADY_EXISTS",me[me.PERMISSION_DENIED=7]="PERMISSION_DENIED",me[me.UNAUTHENTICATED=16]="UNAUTHENTICATED",me[me.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",me[me.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",me[me.ABORTED=10]="ABORTED",me[me.OUT_OF_RANGE=11]="OUT_OF_RANGE",me[me.UNIMPLEMENTED=12]="UNIMPLEMENTED",me[me.INTERNAL=13]="INTERNAL",me[me.UNAVAILABLE=14]="UNAVAILABLE",me[me.DATA_LOSS=15]="DATA_LOSS";var di,yi,vi,gi=(Ci.prototype.Y=function(t){this.X=t},Ci.prototype.Z=function(t){this.tt=t},Ci.prototype.onMessage=function(t){this.et=t},Ci.prototype.close=function(){this.J()},Ci.prototype.send=function(t){this.H(t)},Ci.prototype.nt=function(){this.X()},Ci.prototype.st=function(t){this.tt(t)},Ci.prototype.it=function(t){this.et(t)},Ci),mi=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})},wi=(Pi.prototype.at=function(e,t,n,r){var i=this.ut(e,t);return br("RestConnection","Sending: ",i,n),t={},this.ht(t,r),this.lt(e,i,t,n).then(function(t){return br("RestConnection","Received: ",t),t},function(t){throw Er("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Pi.prototype._t=function(t,e,n,r){return this.at(t,e,n,r)},Pi.prototype.ht=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.2.0-202011823329",t["Content-Type"]="text/plain",e)for(var n in e.R)e.R.hasOwnProperty(n)&&(t[n]=e.R[n])},Pi.prototype.ut=function(t,e){return t=fi[t],this.ot+"/v1/"+e+":"+t},f(Di,vi=Pi),Di.prototype.lt=function(o,e,s,u){return new Promise(function(n,r){var i=new vr;i.listenOnce(pr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case lr.NO_ERROR:var t=i.getResponseJson();br("Connection","XHR received:",JSON.stringify(t)),n(t);break;case lr.TIMEOUT:br("Connection",'RPC "'+o+'" timed out'),r(new Cr(Pr.DEADLINE_EXCEEDED,"Request time out"));break;case lr.HTTP_ERROR:var e=i.getStatus();br("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace(/_/g,"-"),e=0<=Object.values(Pr).indexOf(e)?e:Pr.UNKNOWN,r(new Cr(e,t.message))):r(new Cr(Pr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Cr(Pr.UNAVAILABLE,"Connection failed."));break;default:Tr()}}finally{br("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},Di.prototype.ft=function(t,e){var n,r=[this.ot,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new sr,o=fr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.O.projectId+"/databases/"+this.O.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.k};this.ht(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),br("Connection","Creating WebChannel: "+(r=r.join("")),t);var s=i.createWebChannel(r,t),u=!1,a=!1,c=new gi({H:function(t){a?br("Connection","Not sending because WebChannel is closed:",t):(u||(br("Connection","Opening WebChannel transport."),s.open(),u=!0),br("Connection","WebChannel sending:",t),s.send(t))},J:function(){return s.close()}});return(t=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})})(s,yr.EventType.OPEN,function(){a||br("Connection","WebChannel transport opened.")}),t(s,yr.EventType.CLOSE,function(){a||(a=!0,br("Connection","WebChannel transport closed"),c.st())}),t(s,yr.EventType.ERROR,function(t){a||(a=!0,Er("Connection","WebChannel transport errored:",t),c.st(new Cr(Pr.UNAVAILABLE,"The operation could not be completed")))}),t(s,yr.EventType.MESSAGE,function(t){var e,n,r,i;a||(Ar(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(br("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=hi[r];if(void 0!==t)return pi(t)}(),i=n.message,void 0===t&&(t=Pr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),a=!0,c.st(new Cr(t,i)),s.close()):(br("Connection","WebChannel received:",e),c.it(e)))}),t(o,dr.STAT_EVENT,function(t){10===t.stat?br("Connection","Detected buffering proxy"):11===t.stat&&br("Connection","Detected no buffering proxy")}),setTimeout(function(){c.nt()},0),c},Di),bi=(ki.now=function(){return ki.fromMillis(Date.now())},ki.fromDate=function(t){return ki.fromMillis(t.getTime())},ki.fromMillis=function(t){var e=Math.floor(t/1e3);return new ki(e,1e6*(t-1e3*e))},ki.prototype.toDate=function(){return new Date(this.toMillis())},ki.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},ki.prototype.dt=function(t){return this.seconds===t.seconds?Sr(this.nanoseconds,t.nanoseconds):Sr(this.seconds,t.seconds)},ki.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},ki.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},ki.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},ki.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},ki),_i=(Li.wt=function(t){return new Li(t)},Li.min=function(){return new Li(new bi(0,0))},Li.prototype.u=function(t){return this.timestamp.dt(t.timestamp)},Li.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Li.prototype.Et=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Li.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Li.prototype.Tt=function(){return this.timestamp},Li),o=(Object.defineProperty(Ri.prototype,"length",{get:function(){return this.It},enumerable:!1,configurable:!0}),Ri.prototype.isEqual=function(t){return 0===Ri.At(this,t)},Ri.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Ri?t.forEach(function(t){e.push(t)}):e.push(t),this.Rt(e)},Ri.prototype.limit=function(){return this.offset+this.length},Ri.prototype.Pt=function(t){return t=void 0===t?1:t,this.Rt(this.segments,this.offset+t,this.length-t)},Ri.prototype.yt=function(){return this.Rt(this.segments,this.offset,this.length-1)},Ri.prototype.gt=function(){return this.segments[this.offset]},Ri.prototype.Vt=function(){return this.get(this.length-1)},Ri.prototype.get=function(t){return this.segments[this.offset+t]},Ri.prototype.bt=function(){return 0===this.length},Ri.prototype.vt=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Ri.prototype.St=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Ri.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Ri.prototype.Dt=function(){return this.segments.slice(this.offset,this.limit())},Ri.At=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Ri),Ei=(f(Si,yi=o),Si.prototype.Rt=function(t,e,n){return new Si(t,e,n)},Si.prototype.Ct=function(){return this.Dt().join("/")},Si.prototype.toString=function(){return this.Ct()},Si.xt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Cr(Pr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new Si(n)},Si.Nt=function(){return new Si([])},Si),Ii=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ti=(f(Oi,di=o),Oi.prototype.Rt=function(t,e,n){return new Oi(t,e,n)},Oi.Ft=function(t){return Ii.test(t)},Oi.prototype.Ct=function(){return this.Dt().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Oi.Ft(t)||(t="`"+t+"`"),t}).join(".")},Oi.prototype.toString=function(){return this.Ct()},Oi.prototype.Ot=function(){return 1===this.length&&"__name__"===this.get(0)},Oi.kt=function(){return new Oi(["__name__"])},Oi.Mt=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Cr(Pr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Cr(Pr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Cr(Pr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Cr(Pr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Oi(e)},Oi.Nt=function(){return new Oi([])},Oi),Ai=(Ni.$t=function(t){return new Ni(Ei.xt(t))},Ni.Lt=function(t){return new Ni(Ei.xt(t).Pt(5))},Ni.prototype.Bt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Ni.prototype.isEqual=function(t){return null!==t&&0===Ei.At(this.path,t.path)},Ni.prototype.toString=function(){return this.path.toString()},Ni.At=function(t,e){return Ei.At(t.path,e.path)},Ni.qt=function(t){return t.length%2==0},Ni.Ut=function(t){return new Ni(new Ei(t.slice()))},Ni);function Ni(t){this.path=t}function Oi(){return null!==di&&di.apply(this,arguments)||this}function Si(){return null!==yi&&yi.apply(this,arguments)||this}function Ri(t,e,n){void 0===e?e=0:e>t.length&&Tr(),void 0===n?n=t.length-e:n>t.length-e&&Tr(),this.segments=t,this.offset=e,this.It=n}function Li(t){this.timestamp=t}function ki(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Cr(Pr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Cr(Pr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Cr(Pr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Cr(Pr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Di(t){var e=this;return(e=vi.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.k=t.k,e}function Pi(t){this.rt=t,this.O=t.O;var e=t.ssl?"https":"http";this.ot=e+"://"+t.host,this.ct="projects/"+this.O.projectId+"/databases/"+this.O.database+"/documents"}function Ci(t){this.H=t.H,this.J=t.J}function Ui(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Vi(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function xi(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Mi=(qi.prototype.Qt=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].vt(t))return!0;return!1},qi.prototype.isEqual=function(t){return Rr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},qi),ji=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function qi(t){(this.fields=t).sort(Ti.At)}function Fi(t){if(Ar(!!t),"string"!=typeof t)return{seconds:Bi(t.seconds),nanos:Bi(t.nanos)};var e=0,n=ji.exec(t);return Ar(!!n),n[1]&&(n=(n[1]+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Bi(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Gi(t){return"string"==typeof t?Lr.fromBase64String(t):Lr.fromUint8Array(t)}function zi(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Hi(t){return t=Fi(t.mapValue.fields.__local_write_time__.timestampValue),new bi(t.seconds,t.nanos)}function Wi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?zi(t)?4:10:Tr()}function Yi(r,i){var t,e=Wi(r);if(e!==Wi(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return Hi(r).isEqual(Hi(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Fi(r.timestampValue),t=Fi(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,Gi(r.bytesValue).isEqual(Gi(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Bi((t=r).geoPointValue.latitude)===Bi(e.geoPointValue.latitude)&&Bi(t.geoPointValue.longitude)===Bi(e.geoPointValue.longitude);case 2:return t=i,"integerValue"in(e=r)&&"integerValue"in t?Bi(e.integerValue)===Bi(t.integerValue):"doubleValue"in e&&"doubleValue"in t&&((e=Bi(e.doubleValue))===(t=Bi(t.doubleValue))?ci(e)===ci(t):isNaN(e)&&isNaN(t));case 9:return Rr(r.arrayValue.values||[],i.arrayValue.values||[],Yi);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Ui(e)!==Ui(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!Yi(e[t],n[t])))return!1;return!0}();default:return Tr()}}function Qi(t,e){return void 0!==(t.values||[]).find(function(t){return Yi(t,e)})}function Ki(t,e){var n,r,i,o=Wi(t),s=Wi(e);if(o!==s)return Sr(o,s);switch(o){case 0:return 0;case 1:return Sr(t.booleanValue,e.booleanValue);case 2:return n=e,(r=Bi(t.integerValue||t.doubleValue))<(n=Bi(n.integerValue||n.doubleValue))?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return Xi(t.timestampValue,e.timestampValue);case 4:return Xi(Hi(t),Hi(e));case 5:return Sr(t.stringValue,e.stringValue);case 6:return i=t.bytesValue,s=e.bytesValue,i=Gi(i),s=Gi(s),i.u(s);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Sr(n[i],r[i]);if(0!==o)return o}return Sr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return o=t.geoPointValue,r=e.geoPointValue,0!==(n=Sr(Bi(o.latitude),Bi(r.latitude)))?n:Sr(Bi(o.longitude),Bi(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Ki(n[i],r[i]);if(o)return o}return Sr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Sr(r[s],o[s]);if(0!==u)return u;if(0!==(u=Ki(n[r[s]],i[o[s]])))return u}return Sr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Tr()}}function Xi(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Sr(t,e);var n=Fi(t),t=Fi(e);return 0!==(e=Sr(n.seconds,t.seconds))?e:Sr(n.nanos,t.nanos)}function Ji(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=Fi(t=i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?Gi(i.bytesValue).toBase64():"referenceValue"in i?(e=i.referenceValue,Ai.Lt(e).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Tr();var t,e}(t)}function $i(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.Ct()}}function Zi(t){return t&&"integerValue"in t}function to(t){return!!t&&"arrayValue"in t}function eo(t){return t&&"nullValue"in t}function no(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ro(t){return t&&"mapValue"in t}var io=(uo.empty=function(){return new uo({mapValue:{}})},uo.prototype.field=function(t){if(t.bt())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!ro(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.Vt()])||null},uo.prototype.isEqual=function(t){return Yi(this.proto,t.proto)},uo),oo=(so.prototype.set=function(t,e){return this.jt(t,e),this},so.prototype.delete=function(t){return this.jt(t,null),this},so.prototype.jt=function(t,e){for(var n=this.Wt,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===Wi(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.Vt(),e)},so.prototype.Gt=function(){var t=this.zt(Ti.Nt(),this.Wt);return null!=t?new io(t):this.Kt},so.prototype.zt=function(r,t){var i=this,o=!1,e=this.Kt.field(r),s=ro(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.zt(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},so);function so(t){void 0===t&&(t=io.empty()),this.Kt=t,this.Wt=new Map}function uo(t){this.proto=t}var ao,co,ho,fo=(f(mo,ho=me=function(t,e){this.key=t,this.version=e}),mo.prototype.field=function(t){return this.Ht.field(t)},mo.prototype.data=function(){return this.Ht},mo.prototype.Yt=function(){return this.Ht.proto},mo.prototype.isEqual=function(t){return t instanceof mo&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Jt===t.Jt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Ht.isEqual(t.Ht)},mo.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Ht.toString()+", {hasLocalMutations: "+this.Jt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(mo.prototype,"hasPendingWrites",{get:function(){return this.Jt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),mo),lo=(f(go,co=me),go.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(go.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),go.prototype.isEqual=function(t){return t instanceof go&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},go),po=(f(vo,ao=me),vo.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(vo.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),vo.prototype.isEqual=function(t){return t instanceof vo&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},vo),yo=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Xt=null};function vo(){return null!==ao&&ao.apply(this,arguments)||this}function go(t,e,n){var r=this;return(r=co.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function mo(t,e,n,r){var i=this;return(i=ho.call(this,t,e)||this).Ht=n,i.Jt=!!r.Jt,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function wo(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new yo(t,e,n,r,i,o,s)}function bo(t){var e=t;return null===e.Xt&&(t=e.path.Ct(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return t.field.Ct()+t.op.toString()+Ji(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return t.field.Ct()+t.dir}).join(","),ai(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=Ko(e.startAt)),e.endAt&&(t+="|ub:",t+=Ko(e.endAt)),e.Xt=t),e.Xt}function _o(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!Yi(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!$o(t.startAt,e.startAt)&&$o(t.endAt,e.endAt)}function Eo(t){return Ai.qt(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Io,To=(f(Ao,Io=function(){}),Ao.create=function(t,e,n){return t.Ot()?"in"===e||"not-in"===e?this.Zt(t,e,n):new Ro(t,e,n):"array-contains"===e?new qo(t,n):"in"===e?new Fo(t,n):"not-in"===e?new Bo(t,n):"array-contains-any"===e?new Go(t,n):new Ao(t,e,n)},Ao.Zt=function(t,e,n){return new("in"===e?Lo:ko)(t,n)},Ao.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this.te(Ki(t,this.value)):null!==t&&Wi(this.value)===Wi(t)&&this.te(Ki(t,this.value))},Ao.prototype.te=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Tr()}},Ao.prototype.ee=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Ao);function Ao(t,e,n){var r=this;return(r=Io.call(this)||this).field=t,r.op=e,r.value=n,r}var No,Oo,So,Ro=(f(Co,So=To),Co.prototype.matches=function(t){return t=Ai.At(t.key,this.key),this.te(t)},Co),Lo=(f(Po,Oo=To),Po.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Po),ko=(f(Do,No=To),Do.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Do);function Do(t,e){var n=this;return(n=No.call(this,t,"not-in",e)||this).keys=Uo(0,e),n}function Po(t,e){var n=this;return(n=Oo.call(this,t,"in",e)||this).keys=Uo(0,e),n}function Co(t,e,n){var r=this;return(r=So.call(this,t,e,n)||this).key=Ai.Lt(n.referenceValue),r}function Uo(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return Ai.Lt(t.referenceValue)})}var Vo,xo,Mo,jo,qo=(f(Qo,jo=To),Qo.prototype.matches=function(t){return to(t=t.field(this.field))&&Qi(t.arrayValue,this.value)},Qo),Fo=(f(Yo,Mo=To),Yo.prototype.matches=function(t){return null!==(t=t.field(this.field))&&Qi(this.value.arrayValue,t)},Yo),Bo=(f(Wo,xo=To),Wo.prototype.matches=function(t){return!Qi(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&(null!==(t=t.field(this.field))&&!Qi(this.value.arrayValue,t))},Wo),Go=(f(Ho,Vo=To),Ho.prototype.matches=function(t){var e=this;return!(!to(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return Qi(e.value.arrayValue,t)})},Ho),zo=function(t,e){this.position=t,this.before=e};function Ho(t,e){return Vo.call(this,t,"array-contains-any",e)||this}function Wo(t,e){return xo.call(this,t,"not-in",e)||this}function Yo(t,e){return Mo.call(this,t,"in",e)||this}function Qo(t,e){return jo.call(this,t,"array-contains",e)||this}function Ko(t){return(t.before?"b":"a")+":"+t.position.map(Ji).join(",")}var Xo=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Jo(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.Ot()?Ai.At(Ai.Lt(s.referenceValue),n.key):Ki(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function $o(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Yi(t.position[n],e.position[n]))return!1;return!0}var Zo=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.ne=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.se=null,this.ie=null,this.startAt,this.endAt};function ts(t){return new Zo(t)}function es(t){return!ai(t.limit)&&"F"===t.limitType}function ns(t){return!ai(t.limit)&&"L"===t.limitType}function rs(t){return 0<t.ne.length?t.ne[0].field:null}function is(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.ee())return r.field}return null}function os(t){return null!==t.collectionGroup}function ss(t){var e=t;if(null===e.se){e.se=[];var n=is(e),t=rs(e);if(null!==n&&null===t)n.Ot()||e.se.push(new Xo(n)),e.se.push(new Xo(Ti.kt(),"asc"));else{for(var r=!1,i=0,o=e.ne;i<o.length;i++){var s=o[i];e.se.push(s),s.field.Ot()&&(r=!0)}r||(n=0<e.ne.length?e.ne[e.ne.length-1].dir:"asc",e.se.push(new Xo(Ti.kt(),n)))}}return e.se}function us(t){var e=t;if(!e.ie)if("F"===e.limitType)e.ie=wo(e.path,e.collectionGroup,ss(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=ss(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Xo(o.field,s))}var u=e.endAt?new zo(e.endAt.position,!e.endAt.before):null,t=e.startAt?new zo(e.startAt.position,!e.startAt.before):null;e.ie=wo(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.ie}function as(t,e,n){return new Zo(t.path,t.collectionGroup,t.ne.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function cs(t,e){return _o(us(t),us(e))&&t.limitType===e.limitType}function hs(t){return bo(us(t))+"|lt:"+t.limitType}function fs(t){return"Query(target="+(n=(e=us(t)).path.Ct(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return t.field.Ct()+" "+t.op+" "+Ji(t.value)}).join(", ")+"]"),ai(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return t.field.Ct()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Ko(e.startAt)),e.endAt&&(n+=", endAt: "+Ko(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function ls(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.Bt(e.collectionGroup)&&e.path.vt(n):Ai.qt(e.path)?e.path.isEqual(n):e.path.St(n))&&function(t){for(var e=0,n=i.ne;e<n.length;e++){var r=n[e];if(!r.field.Ot()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||Jo(t.startAt,ss(t),n))&&(!t.endAt||!Jo(t.endAt,ss(t),n)));var e,n}function ps(u){return function(t,e){for(var n=!1,r=0,i=ss(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i;switch(n=t.field.Ot()?Ai.At(e.key,n.key):(r=t.field,i=n,e=e.field(r),r=i.field(r),null!==e&&null!==r?Ki(e,r):Tr()),t.dir){case"asc":return n;case"desc":return-1*n;default:return Tr()}}(o,t,e);if(0!==s)return s;n=n||o.field.Ot()}return 0}}var ds=(ys.prototype.ce=function(t){return new ys(this.target,this.targetId,this.re,t,this.oe,this.lastLimboFreeSnapshotVersion,this.resumeToken)},ys.prototype.ae=function(t,e){return new ys(this.target,this.targetId,this.re,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},ys.prototype.ue=function(t){return new ys(this.target,this.targetId,this.re,this.sequenceNumber,this.oe,t,this.resumeToken)},ys);function ys(t,e,n,r,i,o,s){void 0===i&&(i=_i.min()),void 0===o&&(o=_i.min()),void 0===s&&(s=Lr.h),this.target=t,this.targetId=e,this.re=n,this.sequenceNumber=r,this.oe=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function vs(t,e){if(t.he){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ci(e)?"-0":e}}function gs(t){return{integerValue:""+t}}function ms(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!ci(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?gs(e):vs(t,e);var n}function ws(t,e){return t instanceof Ds?Zi(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var bs,_s,Es=(f(As,_s=o=function(){this.le=void 0}),As),Is=(f(Ts,bs=o),Ts);function Ts(t){var e=this;return(e=bs.call(this)||this).elements=t,e}function As(){return null!==_s&&_s.apply(this,arguments)||this}function Ns(t,e){for(var n=Us(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return Yi(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var Os,Ss=(f(Rs,Os=o),Rs);function Rs(t){var e=this;return(e=Os.call(this)||this).elements=t,e}function Ls(t,e){for(var n=Us(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!Yi(t,e)})}(i[r]);return{arrayValue:{values:n}}}var ks,Ds=(f(Ps,ks=o),Ps);function Ps(t,e){var n=this;return(n=ks.call(this)||this).fe=t,n._e=e,n}function Cs(t){return Bi(t.integerValue||t.doubleValue)}function Us(t){return to(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Vs(t,e){this.field=t,this.transform=e}function xs(t,e){this.version=t,this.transformResults=e}var Ms=(js.de=function(){return new js},js.exists=function(t){return new js(void 0,t)},js.updateTime=function(t){return new js(t)},Object.defineProperty(js.prototype,"we",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),js.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},js);function js(t,e){this.updateTime=t,this.exists=e}function qs(t,e){return void 0!==t.updateTime?e instanceof fo&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof fo}function Fs(t,e,n,r){return t instanceof Ws?function(t,e,n,r){if(!qs(t.Ee,e))return e;var i=t.value;return t.fieldTransforms&&(r=$s(t.fieldTransforms,n,e,r),i=Zs(t.fieldTransforms,i,r)),e=Gs(e),new fo(t.key,e,i,{Jt:!0})}(t,e,r,n):t instanceof Ys?function(t,e,n,r){if(!qs(t.Ee,e))return e;var i=Gs(e),r=Xs(t,e,$s(t.fieldTransforms,n,e,r));return new fo(t.key,i,r,{Jt:!0})}(t,e,r,n):qs(t.Ee,e)?new lo(t.key,_i.min()):e}function Bs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ee.isEqual(e.Ee)&&(n=t.fieldTransforms,r=e.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&Rr(n,r,function(t,e){return t.field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof Is&&e instanceof Is||t instanceof Ss&&e instanceof Ss?Rr(t.elements,e.elements,Yi):t instanceof Ds&&e instanceof Ds?Yi(t._e,e._e):t instanceof Es&&e instanceof Es)})))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.Te.isEqual(e.Te));var n,r}function Gs(t){return t instanceof fo?t.version:_i.min()}var zs,Hs,Ws=(f(Ks,Hs=me=function(){}),Ks),Ys=(f(Qs,zs=me),Qs);function Qs(t,e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=zs.call(this)||this).key=t,o.data=e,o.Te=n,o.Ee=r,o.fieldTransforms=i,o.type=1,o}function Ks(t,e,n,r){void 0===r&&(r=[]);var i=this;return(i=Hs.call(this)||this).key=t,i.value=e,i.Ee=n,i.fieldTransforms=r,i.type=0,i}function Xs(t,e,n){var r,i,o=t;return e=e instanceof fo?e.data():io.empty(),i=new oo(e),o.Te.fields.forEach(function(t){var e;t.bt()||(null!==(e=o.data.field(t))?i.set(t,e):i.delete(t))}),r=i.Gt(),Zs(t.fieldTransforms,r,n)}function Js(t,e,n){var r=[];Ar(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof fo&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof Is?Ns(o,s):o instanceof Ss?Ls(o,s):u))}return r}function $s(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],c=a.transform,h=null;n instanceof fo&&(h=n.field(a.field)),null===h&&r instanceof fo&&(h=r.field(a.field)),o.push((i=h,a=e,h=void 0,c instanceof Es?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(h.fields.__previous_value__=i),{mapValue:h}):c instanceof Is?Ns(c,i):c instanceof Ss?Ls(c,i):(i=Cs(c=ws(h=c,i))+Cs(h._e),Zi(c)&&Zi(h._e)?gs(i):vs(h.fe,i))))}return o}function Zs(t,e,n){for(var r=new oo(e),i=0;i<t.length;i++){var o=t[i];r.set(o.field,n[i])}return r.Gt()}function tu(t){this.count=t}var eu,nu,ru=(f(lu,nu=me),lu),iu=(f(fu,eu=me),fu),ou=(hu.prototype.Ie=function(t,e){return new hu(this.At,this.root.Ie(t,e,this.At).copy(null,null,uu.me,null,null))},hu.prototype.remove=function(t){return new hu(this.At,this.root.remove(t,this.At).copy(null,null,uu.me,null,null))},hu.prototype.get=function(t){for(var e=this.root;!e.bt();){var n=this.At(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},hu.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.bt();){var r=this.At(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},hu.prototype.bt=function(){return this.root.bt()},Object.defineProperty(hu.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),hu.prototype.Ae=function(){return this.root.Ae()},hu.prototype.Re=function(){return this.root.Re()},hu.prototype.Pe=function(t){return this.root.Pe(t)},hu.prototype.forEach=function(n){this.Pe(function(t,e){return n(t,e),!1})},hu.prototype.toString=function(){var n=[];return this.Pe(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},hu.prototype.ye=function(t){return this.root.ye(t)},hu.prototype.ge=function(){return new su(this.root,null,this.At,!1)},hu.prototype.Ve=function(t){return new su(this.root,t,this.At,!1)},hu.prototype.pe=function(){return new su(this.root,null,this.At,!0)},hu.prototype.be=function(t){return new su(this.root,t,this.At,!0)},hu),su=(cu.prototype.De=function(){var t=this.Se.pop(),e={key:t.key,value:t.value};if(this.ve)for(t=t.left;!t.bt();)this.Se.push(t),t=t.right;else for(t=t.right;!t.bt();)this.Se.push(t),t=t.left;return e},cu.prototype.Ce=function(){return 0<this.Se.length},cu.prototype.xe=function(){if(0===this.Se.length)return null;var t=this.Se[this.Se.length-1];return{key:t.key,value:t.value}},cu),uu=(au.prototype.copy=function(t,e,n,r,i){return new au(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},au.prototype.bt=function(){return!1},au.prototype.Pe=function(t){return this.left.Pe(t)||t(this.key,this.value)||this.right.Pe(t)},au.prototype.ye=function(t){return this.right.ye(t)||t(this.key,this.value)||this.left.ye(t)},au.prototype.min=function(){return this.left.bt()?this:this.left.min()},au.prototype.Ae=function(){return this.min().key},au.prototype.Re=function(){return this.right.bt()?this.key:this.right.Re()},au.prototype.Ie=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Ie(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Ie(t,e,n))).Ne()},au.prototype.Fe=function(){if(this.left.bt())return au.EMPTY;var t=this;return t.left.Oe()||t.left.left.Oe()||(t=t.ke()),(t=t.copy(null,null,null,t.left.Fe(),null)).Ne()},au.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.bt()||r.left.Oe()||r.left.left.Oe()||(r=r.ke()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Oe()&&(r=r.Me()),r.right.bt()||r.right.Oe()||r.right.left.Oe()||(r=r.$e()),0===e(t,r.key)){if(r.right.bt())return au.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Fe())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Ne()},au.prototype.Oe=function(){return this.color},au.prototype.Ne=function(){var t=this;return t.right.Oe()&&!t.left.Oe()&&(t=t.Le()),t.left.Oe()&&t.left.left.Oe()&&(t=t.Me()),t.left.Oe()&&t.right.Oe()&&(t=t.Be()),t},au.prototype.ke=function(){var t=this.Be();return t.right.left.Oe()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Me())).Le()).Be()),t},au.prototype.$e=function(){var t=this.Be();return t.left.left.Oe()&&(t=(t=t.Me()).Be()),t},au.prototype.Le=function(){var t=this.copy(null,null,au.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},au.prototype.Me=function(){var t=this.copy(null,null,au.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},au.prototype.Be=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},au.prototype.qe=function(){var t=this.Ue();return Math.pow(2,t)<=this.size+1},au.prototype.Ue=function(){if(this.Oe()&&this.left.Oe())throw Tr();if(this.right.Oe())throw Tr();var t=this.left.Ue();if(t!==this.right.Ue())throw Tr();return t+(this.Oe()?0:1)},au);function au(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:au.RED,this.left=null!=r?r:au.EMPTY,this.right=null!=i?i:au.EMPTY,this.size=this.left.size+1+this.right.size}function cu(t,e,n,r){this.ve=r,this.Se=[];for(var i=1;!t.bt();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.ve?t.left:t.right;else{if(0===i){this.Se.push(t);break}this.Se.push(t),t=this.ve?t.right:t.left}}function hu(t,e){this.At=t,this.root=e||uu.EMPTY}function fu(t,e){var n=this;return(n=eu.call(this)||this).key=t,n.Ee=e,n.type=3,n.fieldTransforms=[],n}function lu(t,e){var n=this;return(n=nu.call(this)||this).key=t,n.Ee=e,n.type=2,n.fieldTransforms=[],n}function pu(){this.size=0}uu.EMPTY=null,uu.RED=!0,uu.me=!1,uu.EMPTY=(Object.defineProperty(pu.prototype,"key",{get:function(){throw Tr()},enumerable:!1,configurable:!0}),Object.defineProperty(pu.prototype,"value",{get:function(){throw Tr()},enumerable:!1,configurable:!0}),Object.defineProperty(pu.prototype,"color",{get:function(){throw Tr()},enumerable:!1,configurable:!0}),Object.defineProperty(pu.prototype,"left",{get:function(){throw Tr()},enumerable:!1,configurable:!0}),Object.defineProperty(pu.prototype,"right",{get:function(){throw Tr()},enumerable:!1,configurable:!0}),pu.prototype.copy=function(t,e,n,r,i){return this},pu.prototype.Ie=function(t,e,n){return new uu(t,e)},pu.prototype.remove=function(t,e){return this},pu.prototype.bt=function(){return!0},pu.prototype.Pe=function(t){return!1},pu.prototype.ye=function(t){return!1},pu.prototype.Ae=function(){return null},pu.prototype.Re=function(){return null},pu.prototype.Oe=function(){return!1},pu.prototype.qe=function(){return!0},pu.prototype.Ue=function(){return 0},new pu);var du=(mu.prototype.has=function(t){return null!==this.data.get(t)},mu.prototype.first=function(){return this.data.Ae()},mu.prototype.last=function(){return this.data.Re()},Object.defineProperty(mu.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),mu.prototype.indexOf=function(t){return this.data.indexOf(t)},mu.prototype.forEach=function(n){this.data.Pe(function(t,e){return n(t),!1})},mu.prototype.Qe=function(t,e){for(var n=this.data.Ve(t[0]);n.Ce();){var r=n.De();if(0<=this.At(r.key,t[1]))return;e(r.key)}},mu.prototype.Ke=function(t,e){for(var n=void 0!==e?this.data.Ve(e):this.data.ge();n.Ce();)if(!t(n.De().key))return},mu.prototype.We=function(t){return(t=this.data.Ve(t)).Ce()?t.De().key:null},mu.prototype.ge=function(){return new yu(this.data.ge())},mu.prototype.Ve=function(t){return new yu(this.data.Ve(t))},mu.prototype.add=function(t){return this.copy(this.data.remove(t).Ie(t,!0))},mu.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},mu.prototype.bt=function(){return this.data.bt()},mu.prototype.je=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},mu.prototype.isEqual=function(t){if(!(t instanceof mu))return!1;if(this.size!==t.size)return!1;for(var e=this.data.ge(),n=t.data.ge();e.Ce();){var r=e.De().key,i=n.De().key;if(0!==this.At(r,i))return!1}return!0},mu.prototype.Dt=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},mu.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},mu.prototype.copy=function(t){var e=new mu(this.At);return e.data=t,e},mu),yu=(gu.prototype.De=function(){return this.Ge.De().key},gu.prototype.Ce=function(){return this.Ge.Ce()},gu),vu=new ou(Ai.At);function gu(t){this.Ge=t}function mu(t){this.At=t,this.data=new ou(this.At)}var wu=new ou(Ai.At),bu=new ou(Ai.At),_u=new du(Ai.At);function Eu(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=_u,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Iu=new du(Sr),Tu=(qu.Je=function(t){return new qu(t.At)},qu.prototype.has=function(t){return null!=this.ze.get(t)},qu.prototype.get=function(t){return this.ze.get(t)},qu.prototype.first=function(){return this.He.Ae()},qu.prototype.last=function(){return this.He.Re()},qu.prototype.bt=function(){return this.He.bt()},qu.prototype.indexOf=function(t){return(t=this.ze.get(t))?this.He.indexOf(t):-1},Object.defineProperty(qu.prototype,"size",{get:function(){return this.He.size},enumerable:!1,configurable:!0}),qu.prototype.forEach=function(n){this.He.Pe(function(t,e){return n(t),!1})},qu.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.ze.Ie(t.key,t),e.He.Ie(t,null))},qu.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.ze.remove(t),this.He.remove(e)):this},qu.prototype.isEqual=function(t){if(!(t instanceof qu))return!1;if(this.size!==t.size)return!1;for(var e=this.He.ge(),n=t.He.ge();e.Ce();){var r=e.De().key,i=n.De().key;if(!r.isEqual(i))return!1}return!0},qu.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},qu.prototype.copy=function(t,e){var n=new qu;return n.At=this.At,n.ze=t,n.He=e,n},qu),Au=(ju.prototype.track=function(t){var e=t.doc.key,n=this.Ye.get(e);!n||0!==t.type&&3===n.type?this.Ye=this.Ye.Ie(e,t):3===t.type&&1!==n.type?this.Ye=this.Ye.Ie(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Ye=this.Ye.Ie(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Ye=this.Ye.Ie(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Ye=this.Ye.remove(e):1===t.type&&2===n.type?this.Ye=this.Ye.Ie(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Ye=this.Ye.Ie(e,{type:2,doc:t.doc}):Tr()},ju.prototype.Xe=function(){var n=[];return this.Ye.Pe(function(t,e){n.push(e)}),n},ju),Nu=(Mu.sn=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Mu(t,e,Tu.Je(e),i,n,r,!0,!1)},Object.defineProperty(Mu.prototype,"hasPendingWrites",{get:function(){return!this.tn.bt()},enumerable:!1,configurable:!0}),Mu.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.en===t.en&&this.tn.isEqual(t.tn)&&cs(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ze.isEqual(t.Ze)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Mu),Ou=(xu.un=function(t,e){var n=new Map;return n.set(t,Su.hn(t,e)),new xu(_i.min(),n,Iu,vu,Eu())},xu),Su=(Vu.hn=function(t,e){return new Vu(Lr.h,e,Eu(),Eu(),Eu())},Vu),Ru=function(t,e,n,r){this.wn=t,this.removedTargetIds=e,this.key=n,this.En=r},Lu=function(t,e){this.targetId=t,this.Tn=e},ku=function(t,e,n,r){void 0===n&&(n=Lr.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Du=(Object.defineProperty(Uu.prototype,"ln",{get:function(){return this.Rn},enumerable:!1,configurable:!0}),Object.defineProperty(Uu.prototype,"resumeToken",{get:function(){return this.An},enumerable:!1,configurable:!0}),Object.defineProperty(Uu.prototype,"yn",{get:function(){return 0!==this.In},enumerable:!1,configurable:!0}),Object.defineProperty(Uu.prototype,"gn",{get:function(){return this.Pn},enumerable:!1,configurable:!0}),Uu.prototype.Vn=function(t){0<t.o()&&(this.Pn=!0,this.An=t)},Uu.prototype.pn=function(){var n=Eu(),r=Eu(),i=Eu();return this.mn.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Tr()}}),new Su(this.An,this.Rn,n,r,i)},Uu.prototype.bn=function(){this.Pn=!1,this.mn=Bu()},Uu.prototype.vn=function(t,e){this.Pn=!0,this.mn=this.mn.Ie(t,e)},Uu.prototype.Sn=function(t){this.Pn=!0,this.mn=this.mn.remove(t)},Uu.prototype.Dn=function(){this.In+=1},Uu.prototype.Cn=function(){--this.In},Uu.prototype.xn=function(){this.Pn=!0,this.Rn=!0},Uu),Pu=(Cu.prototype.$n=function(t){for(var e=0,n=t.wn;e<n.length;e++){var r=n[e];t.En instanceof fo?this.Ln(r,t.En):t.En instanceof lo&&this.Bn(r,t.key,t.En)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.Bn(r,t.key,t.En)},Cu.prototype.qn=function(n){var r=this;this.Un(n,function(t){var e=r.Qn(t);switch(n.state){case 0:r.Kn(t)&&e.Vn(n.resumeToken);break;case 1:e.Cn(),e.yn||e.bn(),e.Vn(n.resumeToken);break;case 2:e.Cn(),e.yn||r.removeTarget(t);break;case 3:r.Kn(t)&&(e.xn(),e.Vn(n.resumeToken));break;case 4:r.Kn(t)&&(r.Wn(t),e.Vn(n.resumeToken));break;default:Tr()}})},Cu.prototype.Un=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Fn.forEach(function(t,e){r.Kn(e)&&n(e)})},Cu.prototype.jn=function(t){var e=t.targetId,n=t.Tn.count;(t=this.Gn(e))&&(Eo(t=t.target)?0===n?(t=new Ai(t.path),this.Bn(e,t,new lo(t,_i.min()))):Ar(1===n):this.zn(e)!==n&&(this.Wn(e),this.Mn=this.Mn.add(e)))},Cu.prototype.Hn=function(r){var i=this,o=new Map;this.Fn.forEach(function(t,e){var n=i.Gn(e);n&&(t.ln&&Eo(n.target)&&(n=new Ai(n.target.path),null!==i.On.get(n)||i.Jn(e,n)||i.Bn(e,n,new lo(n,r))),t.gn&&(o.set(e,t.pn()),t.bn()))});var s=Eu();this.kn.forEach(function(t,e){var n=!0;e.Ke(function(t){return!(t=i.Gn(t))||2===t.re||(n=!1)}),n&&(s=s.add(t))});var t=new Ou(r,o,this.Mn,this.On,s);return this.On=vu,this.kn=Fu(),this.Mn=new du(Sr),t},Cu.prototype.Ln=function(t,e){var n;this.Kn(t)&&(n=this.Jn(t,e.key)?2:0,this.Qn(t).vn(e.key,n),this.On=this.On.Ie(e.key,e),this.kn=this.kn.Ie(e.key,this.Yn(e.key).add(t)))},Cu.prototype.Bn=function(t,e,n){var r;this.Kn(t)&&(r=this.Qn(t),this.Jn(t,e)?r.vn(e,1):r.Sn(e),this.kn=this.kn.Ie(e,this.Yn(e).delete(t)),n&&(this.On=this.On.Ie(e,n)))},Cu.prototype.removeTarget=function(t){this.Fn.delete(t)},Cu.prototype.zn=function(t){var e=this.Qn(t).pn();return this.Nn.Xn(t).size+e._n.size-e.dn.size},Cu.prototype.Dn=function(t){this.Qn(t).Dn()},Cu.prototype.Qn=function(t){var e=this.Fn.get(t);return e||(e=new Du,this.Fn.set(t,e)),e},Cu.prototype.Yn=function(t){var e=this.kn.get(t);return e||(e=new du(Sr),this.kn=this.kn.Ie(t,e)),e},Cu.prototype.Kn=function(t){var e=null!==this.Gn(t);return e||br("WatchChangeAggregator","Detected inactive target",t),e},Cu.prototype.Gn=function(t){var e=this.Fn.get(t);return e&&e.yn?null:this.Nn.Zn(t)},Cu.prototype.Wn=function(e){var n=this;this.Fn.set(e,new Du),this.Nn.Xn(e).forEach(function(t){n.Bn(e,t,null)})},Cu.prototype.Jn=function(t,e){return this.Nn.Xn(t).has(e)},Cu);function Cu(t){this.Nn=t,this.Fn=new Map,this.On=vu,this.kn=Fu(),this.Mn=new du(Sr)}function Uu(){this.In=0,this.mn=Bu(),this.An=Lr.h,this.Rn=!1,this.Pn=!0}function Vu(t,e,n,r,i){this.resumeToken=t,this.ln=e,this._n=n,this.fn=r,this.dn=i}function xu(t,e,n,r,i){this.oe=t,this.rn=e,this.on=n,this.cn=r,this.an=i}function Mu(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Ze=n,this.docChanges=r,this.tn=i,this.fromCache=o,this.en=s,this.nn=u}function ju(){this.Ye=new ou(Ai.At)}function qu(n){this.At=n?function(t,e){return n(t,e)||Ai.At(t.key,e.key)}:function(t,e){return Ai.At(t.key,e.key)},this.ze=wu,this.He=new ou(this.At)}function Fu(){return new ou(Ai.At)}function Bu(){return new ou(Ai.At)}var Gu={asc:"ASCENDING",desc:"DESCENDING"},zu={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Hu=function(t,e){this.O=t,this.he=e};function Wu(t,e){return t.he?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Yu(t,e){return t.he?e.toBase64():e.toUint8Array()}function Qu(t){return Ar(!!t),_i.wt((t=Fi(t),new bi(t.seconds,t.nanos)))}function Ku(t,e){return new Ei(["projects",t.projectId,"databases",t.database]).child("documents").child(e).Ct()}function Xu(t){return Ar(ca(t=Ei.xt(t))),t}function Ju(t,e){return Ku(t.O,e.path)}function $u(t,e){if((e=Xu(e)).get(1)!==t.O.projectId)throw new Cr(Pr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.O.projectId);if(e.get(3)!==t.O.database)throw new Cr(Pr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.O.database);return new Ai(ea(e))}function Zu(t,e){return Ku(t.O,e)}function ta(t){return new Ei(["projects",t.O.projectId,"databases",t.O.database]).Ct()}function ea(t){return Ar(4<t.length&&"documents"===t.get(4)),t.Pt(5)}function na(t,e,n){return{name:Ju(t,e),fields:n.proto.mapValue.fields}}function ra(t,e){var n,r,i;if(e instanceof Ws)n={update:na(t,e.key,e.value)};else if(e instanceof ru)n={delete:Ju(t,e.key)};else if(e instanceof Ys)n={update:na(t,e.key,e.data),updateMask:(i=e.Te,r=[],i.fields.forEach(function(t){return r.push(t.Ct())}),{fieldPaths:r})};else{if(!(e instanceof iu))return Tr();n={verify:Ju(t,e.key)}}return 0<e.fieldTransforms.length&&(n.updateTransforms=e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Es)return{fieldPath:t.field.Ct(),setToServerValue:"REQUEST_TIME"};if(e instanceof Is)return{fieldPath:t.field.Ct(),appendMissingElements:{values:e.elements}};if(e instanceof Ss)return{fieldPath:t.field.Ct(),removeAllFromArray:{values:e.elements}};if(e instanceof Ds)return{fieldPath:t.field.Ct(),increment:e._e};throw Tr()})),e.Ee.we||(n.currentDocument=void 0!==(i=e.Ee).updateTime?{updateTime:Wu(e=t,(t=i.updateTime).Tt())}:void 0!==i.exists?{exists:i.exists}:Tr()),n}function ia(t){var e=4===(o=Xu(t.parent)).length?Ei.Nt():ea(o),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Ar(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=aa(t.unaryFilter.field);return To.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=aa(t.unaryFilter.field);return To.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":return n=aa(t.unaryFilter.field),To.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":return t=aa(t.unaryFilter.field),To.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Tr()}}(e)]:void 0!==e.fieldFilter?[(n=e,To.create(aa(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Tr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):Tr():[];var n}(n.where)),t=[],n.orderBy&&(t=n.orderBy.map(function(t){return new Xo(aa((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e})),r=null,n.limit&&(r=ai(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=sa(n.startAt));var u=null;return n.endAt&&(u=sa(n.endAt)),new Zo(e,i,t,o,r,"F",s,u)}function oa(t){return{before:t.before,values:t.position}}function sa(t){var e=!!t.before,t=t.values||[];return new zo(t,e)}function ua(t){return{fieldPath:t.Ct()}}function aa(t){return Ti.Mt(t.fieldPath)}function ca(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function ha(t){return new Hu(t,!0)}var fa=(la.prototype.catch=function(t){return this.next(void 0,t)},la.prototype.next=function(r,i){var o=this;return this.ss&&Tr(),this.ss=!0,this.ns?this.error?this.rs(i,this.error):this.os(r,this.result):new la(function(e,n){o.ts=function(t){o.os(r,t).next(e,n)},o.es=function(t){o.rs(i,t).next(e,n)}})},la.prototype.cs=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},la.prototype.us=function(t){try{var e=t();return e instanceof la?e:la.resolve(e)}catch(t){return la.reject(t)}},la.prototype.os=function(t,e){return t?this.us(function(){return t(e)}):la.resolve(e)},la.prototype.rs=function(t,e){return t?this.us(function(){return t(e)}):la.reject(e)},la.resolve=function(n){return new la(function(t,e){t(n)})},la.reject=function(n){return new la(function(t,e){e(n)})},la.hs=function(t){return new la(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},la.ls=function(t){for(var n=la.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?la.resolve(t):e()})}(r[e]);return n},la.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.hs(i)},la);function la(t){var e=this;this.ts=null,this.es=null,this.result=void 0,this.error=void 0,this.ns=!1,this.ss=!1,t(function(t){e.ns=!0,e.result=t,e.ts&&e.ts(t)},function(t){e.ns=!0,e.error=t,e.es&&e.es(t)})}function pa(t){return"IndexedDbTransactionError"===t.name}var da=(ya.qs=function(t,e,n,r,i){return(i=new ya(t,e,Date.now()+n,r,i)).start(n),i},ya.prototype.start=function(t){var e=this;this.Us=setTimeout(function(){return e.Qs()},t)},ya.prototype.Ks=function(){return this.Qs()},ya.prototype.cancel=function(t){null!==this.Us&&(this.clearTimeout(),this.Bs.reject(new Cr(Pr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},ya.prototype.Qs=function(){var e=this;this.ks.Ws(function(){return null!==e.Us?(e.clearTimeout(),e.op().then(function(t){return e.Bs.resolve(t)})):Promise.resolve()})},ya.prototype.clearTimeout=function(){null!==this.Us&&(this.Ls(this),clearTimeout(this.Us),this.Us=null)},ya);function ya(t,e,n,r,i){this.ks=t,this.Ms=e,this.$s=n,this.op=r,this.Ls=i,this.Bs=new mi,this.then=this.Bs.promise.then.bind(this.Bs.promise),this.Bs.promise.catch(function(t){})}function va(t,e){if(_r("AsyncQueue",e+": "+t),pa(t))return new Cr(Pr.UNAVAILABLE,e+": "+t);throw t}var ga,ma,wa,ba=(ka.prototype.reset=function(){this.Js=0},ka.prototype.Zs=function(){this.Js=this.Hs},ka.prototype.ti=function(t){var e=this;this.cancel();var n=Math.floor(this.Js+this.ei()),r=Math.max(0,Date.now()-this.Xs),i=Math.max(0,n-r);0<i&&br("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Js+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ys=this.js.ni(this.Ms,i,function(){return e.Xs=Date.now(),t()}),this.Js*=this.zs,this.Js<this.Gs&&(this.Js=this.Gs),this.Js>this.Hs&&(this.Js=this.Hs)},ka.prototype.si=function(){null!==this.Ys&&(this.Ys.Ks(),this.Ys=null)},ka.prototype.cancel=function(){null!==this.Ys&&(this.Ys.cancel(),this.Ys=null)},ka.prototype.ei=function(){return(Math.random()-.5)*this.Js},ka),o=(La.prototype.hi=function(){return 1===this.state||2===this.state||4===this.state},La.prototype.li=function(){return 2===this.state},La.prototype.start=function(){3!==this.state?this.auth():this._i()},La.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.hi()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},La.prototype.fi=function(){this.state=0,this.ui.reset()},La.prototype.di=function(){var t=this;this.li()&&null===this.ai&&(this.ai=this.js.ni(this.ii,6e4,function(){return t.wi()}))},La.prototype.Ei=function(t){this.Ti(),this.stream.send(t)},La.prototype.wi=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.li()?[2,this.close(0)]:[2]})})},La.prototype.Ti=function(){this.ai&&(this.ai.cancel(),this.ai=null)},La.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Ti(),this.ui.cancel(),this.ci++,3!==e?this.ui.reset():n&&n.code===Pr.RESOURCE_EXHAUSTED?(_r(n.toString()),_r("Using maximum backoff delay to prevent overloading the backend."),this.ui.Zs()):n&&n.code===Pr.UNAUTHENTICATED&&this.oi.g(),null!==this.stream&&(this.Ii(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Z(n)];case 1:return t.sent(),[2]}})})},La.prototype.Ii=function(){},La.prototype.auth=function(){var n=this;this.state=1;var t=this.mi(this.ci),e=this.ci;this.oi.getToken().then(function(t){n.ci===e&&n.Ai(t)},function(e){t(function(){var t=new Cr(Pr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Ri(t)})})},La.prototype.Ai=function(t){var e=this,n=this.mi(this.ci);this.stream=this.Pi(t),this.stream.Y(function(){n(function(){return e.state=2,e.listener.Y()})}),this.stream.Z(function(t){n(function(){return e.Ri(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},La.prototype._i=function(){var t=this;this.state=4,this.ui.ti(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},La.prototype.Ri=function(t){return br("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},La.prototype.mi=function(e){var n=this;return function(t){n.js.Ws(function(){return n.ci===e?t():(br("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},La),_a=(f(Ra,wa=o),Ra.prototype.Pi=function(t){return this.ri.ft("Listen",t)},Ra.prototype.onMessage=function(t){this.ui.reset();var e,n=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Tr(),r=e.targetChange.targetIds||[],i=(s=e.targetChange.resumeToken,t.he?(Ar(void 0===s||"string"==typeof s),Lr.fromBase64String(s||"")):(Ar(void 0===s||s instanceof Uint8Array),Lr.fromUint8Array(s||new Uint8Array))),o=(u=e.targetChange.cause)&&(a=void 0===(c=u).code?Pr.UNKNOWN:pi(c.code),new Cr(a,c.message||"")),s=new ku(n,r,i,o||null)}else if("documentChange"in e){e.documentChange,(n=e.documentChange).document,n.document.name,n.document.updateTime,r=$u(t,n.document.name),i=Qu(n.document.updateTime);var u=new io({mapValue:{fields:n.document.fields}}),a=(o=new fo(r,i,u,{}),n.targetIds||[]),c=n.removedTargetIds||[],s=new Ru(a,c,o.key,o)}else if("documentDelete"in e)e.documentDelete,(n=e.documentDelete).document,r=$u(t,n.document),i=n.readTime?Qu(n.readTime):_i.min(),u=new lo(r,i),o=n.removedTargetIds||[],s=new Ru([],o,u.key,u);else if("documentRemove"in e)e.documentRemove,(n=e.documentRemove).document,r=$u(t,n.document),i=n.removedTargetIds||[],s=new Ru([],i,r,null);else{if(!("filter"in e))return Tr();e.filter,(e=e.filter).targetId,r=new tu(n=e.count||0),i=e.targetId,s=new Lu(i,r)}return s}(this.fe,t),t=!("targetChange"in(e=t))||(e=e.targetChange).targetIds&&e.targetIds.length||!e.readTime?_i.min():Qu(e.readTime);return this.listener.yi(n,t)},Ra.prototype.gi=function(t){var e,n,r,i,o,s,u,a,c={};c.database=ta(this.fe),c.addTarget=(e=this.fe,(r=Eo(r=(n=t).target)?{documents:{documents:[Zu(e,r.path)]}}:{query:(i=e,s={structuredQuery:{}},u=(o=r).path,null!==o.collectionGroup?(s.parent=Zu(i,u),s.structuredQuery.from=[{collectionId:o.collectionGroup,allDescendants:!0}]):(s.parent=Zu(i,u.yt()),s.structuredQuery.from=[{collectionId:u.Vt()}]),(u=function(t){if(0!==t.length)return 1===(t=t.map(function(t){if("=="===t.op){if(no(t.value))return{unaryFilter:{field:ua(t.field),op:"IS_NAN"}};if(eo(t.value))return{unaryFilter:{field:ua(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(no(t.value))return{unaryFilter:{field:ua(t.field),op:"IS_NOT_NAN"}};if(eo(t.value))return{unaryFilter:{field:ua(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ua(t.field),op:(e=t.op,zu[e]),value:t.value}};var e})).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(o.filters))&&(s.structuredQuery.where=u),(u=function(t){if(0!==t.length)return t.map(function(t){return{field:ua(t.field),direction:(t=t.dir,Gu[t])}})}(o.orderBy))&&(s.structuredQuery.orderBy=u),u=o.limit,null!==(u=i.he||ai(u)?u:{value:u})&&(s.structuredQuery.limit=u),o.startAt&&(s.structuredQuery.startAt=oa(o.startAt)),o.endAt&&(s.structuredQuery.endAt=oa(o.endAt)),s)}).targetId=n.targetId,0<n.resumeToken.o()?r.resumeToken=Yu(e,n.resumeToken):0<n.oe.u(_i.min())&&(r.readTime=Wu(e,n.oe.Tt())),r),(t=(this.fe,a=t,null==(t=function(){switch(a.re){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Tr()}}())?null:{"goog-listen-tags":t}))&&(c.labels=t),this.Ei(c)},Ra.prototype.Vi=function(t){var e={};e.database=ta(this.fe),e.removeTarget=t,this.Ei(e)},Ra),Ea=(f(Sa,ma=o),Object.defineProperty(Sa.prototype,"bi",{get:function(){return this.pi},enumerable:!1,configurable:!0}),Sa.prototype.start=function(){this.pi=!1,this.lastStreamToken=void 0,ma.prototype.start.call(this)},Sa.prototype.Ii=function(){this.pi&&this.vi([])},Sa.prototype.Pi=function(t){return this.ri.ft("Write",t)},Sa.prototype.onMessage=function(t){if(Ar(!!t.streamToken),this.lastStreamToken=t.streamToken,this.pi){this.ui.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Ar(void 0!==r),n.map(function(t){return n=r,(t=(e=t).updateTime?Qu(e.updateTime):Qu(n)).isEqual(_i.min())&&(t=Qu(n)),n=null,e.transformResults&&0<e.transformResults.length&&(n=e.transformResults),new xs(t,n);var e,n})):[]),n=Qu(t.commitTime);return this.listener.Si(n,e)}var r;return Ar(!t.writeResults||0===t.writeResults.length),this.pi=!0,this.listener.Di()},Sa.prototype.Ci=function(){var t={};t.database=ta(this.fe),this.Ei(t)},Sa.prototype.vi=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return ra(e.fe,t)})};this.Ei(t)},Sa),Ia=(f(Oa,ga=function(){}),Oa.prototype.Ni=function(){if(this.xi)throw new Cr(Pr.FAILED_PRECONDITION,"The client has already been terminated.")},Oa.prototype.at=function(e,n,r){var i=this;return this.Ni(),this.credentials.getToken().then(function(t){return i.ri.at(e,n,r,t)}).catch(function(t){throw t.code===Pr.UNAUTHENTICATED&&i.credentials.g(),t})},Oa.prototype._t=function(e,n,r){var i=this;return this.Ni(),this.credentials.getToken().then(function(t){return i.ri._t(e,n,r,t)}).catch(function(t){throw t.code===Pr.UNAUTHENTICATED&&i.credentials.g(),t})},Oa.prototype.terminate=function(){this.xi=!1},Oa),me=(Na.prototype.Oi=function(t){this.Fi.push(t)},Na.prototype.ki=function(){this.Fi.forEach(function(t){return t()})},Na),Ta=(Aa.prototype.Ji=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Aa.prototype.next=function(){var t=++this.previousValue;return this.Yi&&this.Yi(t),t},Aa);function Aa(t,e){var n=this;this.previousValue=t,e&&(e.Hi=function(t){return n.Ji(t)},this.Yi=function(t){return e.Xi(t)})}function Na(){this.Fi=[]}function Oa(t,e,n){var r=this;return(r=ga.call(this)||this).credentials=t,r.ri=e,r.fe=n,r.xi=!1,r}function Sa(t,e,n,r,i){var o=this;return(o=ma.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).fe=r,o.pi=!1,o}function Ra(t,e,n,r,i){var o=this;return(o=wa.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).fe=r,o}function La(t,e,n,r,i,o){this.js=t,this.ii=n,this.ri=r,this.oi=i,this.listener=o,this.state=0,this.ci=0,this.ai=null,this.stream=null,this.ui=new ba(t,e)}function ka(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.js=t,this.Ms=e,this.Gs=n,this.zs=r,this.Hs=i,this.Js=0,this.Ys=null,this.Xs=Date.now(),this.reset()}function Da(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Pr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return br("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Pa(t,e){this.progress=t,this.tr=e}Ta.Zi=-1;var Ca=(qa.prototype.nr=function(t,e,n){for(var r,i,o,s,u,a,c=n.sr,h=0;h<this.mutations.length;h++){var f=this.mutations[h];f.key.isEqual(t)&&(r=f,u=e,i=c[h],f=a=void 0,e=r instanceof Ws?(a=i,f=(o=r).value,a.transformResults&&(s=Js(o.fieldTransforms,u,a.transformResults),f=Zs(o.fieldTransforms,f,s)),new fo(o.key,a.version,f,{hasCommittedMutations:!0})):r instanceof Ys?(a=u,f=i,qs((u=r).Ee,a)?(a=Xs(u,a,f.transformResults?Js(u.fieldTransforms,a,f.transformResults):[]),new fo(u.key,f.version,a,{hasCommittedMutations:!0})):new po(u.key,f.version)):new lo(r.key,i.version,{hasCommittedMutations:!0}))}return e},qa.prototype.ir=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Fs(i,e,e,this.er))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Fs(a,e,o,this.er))}return e},qa.prototype.rr=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.ir(t.key,n.get(t.key));e&&(i=i.Ie(t.key,e))}),i},qa.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Eu())},qa.prototype.isEqual=function(t){return this.batchId===t.batchId&&Rr(this.mutations,t.mutations,Bs)&&Rr(this.baseMutations,t.baseMutations,Bs)},qa),Ua=(ja.from=function(t,e,n){Ar(t.mutations.length===n.length);for(var r=bu,i=t.mutations,o=0;o<i.length;o++)r=r.Ie(i[o].key,n[o].version);return new ja(t,e,n,r)},ja),Va=(Ma.prototype.get=function(t){var e=this.ur(t);if(void 0!==(e=this.lr[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.hr(i,t))return o}},Ma.prototype.has=function(t){return void 0!==this.get(t)},Ma.prototype.set=function(t,e){var n=this.ur(t),r=this.lr[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.hr(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.lr[n]=[[t,e]]},Ma.prototype.delete=function(t){var e=this.ur(t),n=this.lr[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.hr(n[r][0],t))return 1===n.length?delete this.lr[e]:n.splice(r,1),!0;return!1},Ma.prototype.forEach=function(s){Vi(this.lr,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];s(i,o)}})},Ma.prototype.bt=function(){return xi(this.lr)},Ma),o=(xa.prototype.wr=function(t){return(t=this._r.get(t))?t.readTime:_i.min()},xa.prototype.Er=function(t,e){this.Tr(),this._r.set(t.key,{Ir:t,readTime:e})},xa.prototype.mr=function(t,e){void 0===e&&(e=null),this.Tr(),this._r.set(t,{Ir:null,readTime:e})},xa.prototype.Ar=function(t,e){this.Tr();var n=this._r.get(e);return void 0!==n?fa.resolve(n.Ir):this.Rr(t,e)},xa.prototype.getEntries=function(t,e){return this.Pr(t,e)},xa.prototype.apply=function(t){return this.Tr(),this.dr=!0,this.yr(t)},xa.prototype.Tr=function(){},xa);function xa(){this._r=new Va(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.dr=!1}function Ma(t,e){this.ur=t,this.hr=e,this.lr={}}function ja(t,e,n,r){this.batch=t,this.cr=e,this.sr=n,this.ar=r}function qa(t,e,n,r){this.batchId=t,this.er=e,this.baseMutations=n,this.mutations=r}function Fa(t,e,n){if(!n)throw new Cr(Pr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Ba(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Cr(Pr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Ga(t,e,n,r){if(!0===e&&!0===r)throw new Cr(Pr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function za(t){if(!Ai.qt(t))throw new Cr(Pr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Ha(t){if(Ai.qt(t))throw new Cr(Pr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Wa(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Tr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Ya(t,e){if("_delegate"in t&&(t=t._),t instanceof e)return t;if(e.name===t.constructor.name)throw new Cr(Pr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");throw t=Wa(t),new Cr(Pr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function Qa(t,e){if(e<=0)throw new Cr(Pr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}function Ka(t){this.co=t}var Xa=(tc.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},tc),Ja=new Map,$a=(Object.defineProperty(Za.prototype,"app",{get:function(){if(!this.Jr)throw new Cr(Pr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Jr},enumerable:!1,configurable:!0}),Object.defineProperty(Za.prototype,"Yr",{get:function(){return this.Gr},enumerable:!1,configurable:!0}),Object.defineProperty(Za.prototype,"Xr",{get:function(){return void 0!==this.Zr},enumerable:!1,configurable:!0}),Za.prototype.eo=function(t){if(this.Gr)throw new Cr(Pr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.jr=new Xa(t),void 0!==t.credentials&&(this.Hr=function(t){if(!t)return new Yr;switch(t.type){case"gapi":var e=t.client;return Ar(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Xr(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Cr(Pr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Za.prototype.no=function(){return this.jr},Za.prototype.so=function(){return this.Gr=!0,this.jr},Za.prototype._delete=function(){return this.Zr||(this.Zr=this.io()),this.Zr},Za.prototype.io=function(){return(t=Ja.get(this))&&(br("ComponentProvider","Removing Datastore"),Ja.delete(this),t.terminate()),Promise.resolve();var t},Za);function Za(t,e){this.Wr="(lite)",this.jr=new Xa({}),this.Gr=!1,t instanceof $r?(this.zr=t,this.Hr=new Yr):(this.Jr=t,this.zr=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Cr(Pr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new $r(t.options.projectId)}(t),this.Hr=new Qr(e))}function tc(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Cr(Pr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Cr(Pr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Ga("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function ec(t){var e=ia({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?as(e,e.limit,"L"):e}var nc=(yc.prototype.fo=function(t,e){return this._o.add(e),fa.resolve()},yc.prototype.wo=function(t,e){return fa.resolve(this._o.getEntries(e))},yc),rc=(dc.prototype.add=function(t){var e=t.Vt(),n=t.yt(),r=this.index[e]||new du(Ei.At),t=!r.has(n);return this.index[e]=r.add(n),t},dc.prototype.has=function(t){var e=t.Vt(),t=t.yt();return(e=this.index[e])&&e.has(t)},dc.prototype.getEntries=function(t){return(this.index[t]||new du(Ei.At)).Dt()},dc),ic=(pc.prototype.next=function(){return this.Lo+=2,this.Lo},pc.Bo=function(){return new pc(0)},pc.qo=function(){return new pc(-1)},pc),oc=(lc.prototype.Pa=function(e,n){var r=this;return this.Ra.So(e,n).next(function(t){return r.ya(e,n,t)})},lc.prototype.ya=function(t,r,i){return this.Kc.Ar(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].ir(r,t);return t})},lc.prototype.ga=function(t,e,i){var o=vu;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].ir(t,e);o=o.Ie(t,e)}),o},lc.prototype.Va=function(e,t){var n=this;return this.Kc.getEntries(e,t).next(function(t){return n.pa(e,t)})},lc.prototype.pa=function(e,r){var i=this;return this.Ra.Do(e,r).next(function(t){var t=i.ga(e,r,t),n=vu;return t.forEach(function(t,e){e=e||new lo(t,_i.min()),n=n.Ie(t,e)}),n})},lc.prototype.Pc=function(t,e,n){return r=e,Ai.qt(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.ba(t,e.path):os(e)?this.va(t,e,n):this.Sa(t,e,n);var r},lc.prototype.ba=function(t,e){return this.Pa(t,new Ai(e)).next(function(t){var e=wu;return t instanceof fo&&(e=e.Ie(t.key,t)),e})},lc.prototype.va=function(n,r,i){var o=this,s=r.collectionGroup,u=wu;return this.To.wo(n,s).next(function(t){return fa.forEach(t,function(t){var e=(e=r,t=t.child(s),new Zo(t,null,e.ne.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.Sa(n,e,i).next(function(t){t.forEach(function(t,e){u=u.Ie(t,e)})})}).next(function(){return u})})},lc.prototype.Sa=function(e,n,t){var a,c,r=this;return this.Kc.Pc(e,n,t).next(function(t){return a=t,r.Ra.xo(e,n)}).next(function(t){return c=t,r.Da(e,c,a).next(function(t){a=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,s=Fs(s,s=a.get(u),s,r.er);a=s instanceof fo?a.Ie(u,s):a.remove(u)}})}).next(function(){return a.forEach(function(t,e){ls(n,e)||(a=a.remove(t))}),a})},lc.prototype.Da=function(t,e,n){for(var r=Eu(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Ys&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.Kc.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof fo&&(c=c.Ie(t,e))}),c})},lc),sc=(fc.Na=function(t,e){for(var n=Eu(),r=Eu(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new fc(t,e.fromCache,n,r)},fc),uc=(hc.prototype.Fa=function(t){this.Oa=t},hc.prototype.Pc=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.ne.length||1===r.ne.length&&r.ne[0].field.Ot())||i.isEqual(_i.min())?this.ka(e,r):this.Oa.Va(e,o).next(function(t){var n=s.Ma(r,t);return(es(r)||ns(r))&&s.$a(r.limitType,n,o,i)?s.ka(e,r):(wr()<=u.DEBUG&&br("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),fs(r)),s.Oa.Pc(e,r,i).next(function(e){return n.forEach(function(t){e=e.Ie(t.key,t)}),e}))})},hc.prototype.Ma=function(n,t){var r=new du(ps(n));return t.forEach(function(t,e){e instanceof fo&&ls(n,e)&&(r=r.add(e))}),r},hc.prototype.$a=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version.u(r))},hc.prototype.ka=function(t,e){return wr()<=u.DEBUG&&br("QueryEngine","Using full collection scan to execute query:",fs(e)),this.Oa.Pc(t,e,_i.min())},hc),ac=(cc.prototype.Fr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Ur(t,n.Ba)})},cc);function cc(t,e,n,r){this.persistence=t,this.La=e,this.fe=r,this.Ba=new ou(Sr),this.qa=new Va(bo,_o),this.Ua=_i.min(),this.Ra=t.Ta(n),this.Qa=t._c(),this.Qc=t.ac(),this.Ka=new oc(this.Qa,this.Ra,this.persistence.Ia()),this.Wc=t.ma(),this.La.Fa(this.Ka)}function hc(){}function fc(t,e,n,r){this.targetId=t,this.fromCache=e,this.Ca=n,this.xa=r}function lc(t,e,n){this.Kc=t,this.Ra=e,this.To=n}function pc(t){this.Lo=t}function dc(){this.index={}}function yc(){this._o=new rc}function vc(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Ra,m=e.Ka,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.Ra.vo(v).next(function(t){return g=t,n=e.persistence.Ta(o),m=new oc(e.Qa,n,e.persistence.Ia()),n.vo(v)}).next(function(t){for(var e=[],n=[],r=Eu(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Va(v,r).next(function(t){return{Wa:t,ja:e,Ga:n}})})})];case 1:return r=t.sent(),[2,(e.Ra=n,e.Ka=m,e.La.Fa(e.Ka),r)]}})})}function gc(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Qc.Wo(t)})}function mc(t,s,e,u,a){var n=Eu();return e.forEach(function(t){return n=n.add(t)}),s.getEntries(t,n).next(function(i){var o=vu;return e.forEach(function(t,e){var n=i.get(t),r=(null==a?void 0:a.get(t))||u;e instanceof lo&&e.version.isEqual(_i.min())?(s.mr(t,r),o=o.Ie(t,e)):null==n||0<e.version.u(n.version)||0===e.version.u(n.version)&&n.hasPendingWrites?(s.Er(e,r),o=o.Ie(t,e)):br("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o})}function wc(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Qc.ec(e,r).next(function(t){return t?(n=t,fa.resolve(n)):i.Qc.Uo(e).next(function(t){return n=new ds(r,t,0,e.oo),i.Qc.zo(e,n).next(function(){return n})})})}).then(function(t){var e=i.Ba.get(t.targetId);return(null===e||0<t.oe.u(e.oe))&&(i.Ba=i.Ba.Ie(t.targetId,t),i.qa.set(r,t.targetId)),t})}function bc(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).Ba.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Io.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!pa(r=t.sent()))throw r;return br("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.Ba=e.Ba.remove(o),e.qa.delete(n.target),[2]}})})}function _c(t,o,s){var u=t,a=_i.min(),c=Eu();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=us(o),(void 0!==(t=(i=t).qa.get(r))?fa.resolve(i.Ba.get(t)):i.Qc.ec(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.Qc.oc(e,t.targetId).next(function(t){c=t})}).next(function(){return u.La.Pc(e,o,s?a:_i.min(),s?c:Eu())}).next(function(t){return{documents:t,za:c}});var t,n,r,i})}var Ec,Ic,Tc=(Yc.prototype.ao=function(t,e){return fa.resolve(this.Xa.get(e))},Yc.prototype.uo=function(t,e){return this.Xa.set(e.id,{id:e.id,version:e.version,createTime:Qu(e.createTime)}),fa.resolve()},Yc.prototype.ho=function(t,e){return fa.resolve(this.Za.get(e))},Yc.prototype.lo=function(t,e){return this.Za.set(e.name,{name:e.name,query:ec(e.bundledQuery),readTime:Qu(e.readTime)}),fa.resolve()},Yc),Ac=(Wc.prototype.bt=function(){return this.tu.bt()},Wc.prototype.sc=function(t,e){e=new Nc(t,e),this.tu=this.tu.add(e),this.nu=this.nu.add(e)},Wc.prototype.iu=function(t,e){var n=this;t.forEach(function(t){return n.sc(t,e)})},Wc.prototype.rc=function(t,e){this.ru(new Nc(t,e))},Wc.prototype.ou=function(t,e){var n=this;t.forEach(function(t){return n.rc(t,e)})},Wc.prototype.cu=function(t){var e=this,n=new Ai(new Ei([])),r=new Nc(n,t),t=new Nc(n,t+1),i=[];return this.nu.Qe([r,t],function(t){e.ru(t),i.push(t.key)}),i},Wc.prototype.au=function(){var e=this;this.tu.forEach(function(t){return e.ru(t)})},Wc.prototype.ru=function(t){this.tu=this.tu.delete(t),this.nu=this.nu.delete(t)},Wc.prototype.uu=function(t){var e=new Ai(new Ei([])),n=new Nc(e,t),t=new Nc(e,t+1),r=Eu();return this.nu.Qe([n,t],function(t){r=r.add(t.key)}),r},Wc.prototype.Mo=function(t){var e=new Nc(t,0);return null!==(e=this.tu.We(e))&&t.isEqual(e.key)},Wc),Nc=(Hc.eu=function(t,e){return Ai.At(t.key,e.key)||Sr(t.hu,e.hu)},Hc.su=function(t,e){return Sr(t.hu,e.hu)||Ai.At(t.key,e.key)},Hc),Oc=(zc.prototype.Ro=function(t){return fa.resolve(0===this.Ra.length)},zc.prototype.Po=function(t,e,n,r){var i=this.lu;this.lu++,0<this.Ra.length&&this.Ra[this.Ra.length-1],n=new Ca(i,e,n,r),this.Ra.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this._u=this._u.add(new Nc(u.key,i)),this.To.fo(t,u.key.path.yt())}return fa.resolve(n)},zc.prototype.yo=function(t,e){return fa.resolve(this.fu(e))},zc.prototype.po=function(t,e){return e+=1,e=(e=this.du(e))<0?0:e,fa.resolve(this.Ra.length>e?this.Ra[e]:null)},zc.prototype.bo=function(){return fa.resolve(0===this.Ra.length?-1:this.lu-1)},zc.prototype.vo=function(t){return fa.resolve(this.Ra.slice())},zc.prototype.So=function(t,e){var n=this,r=new Nc(e,0),e=new Nc(e,Number.POSITIVE_INFINITY),i=[];return this._u.Qe([r,e],function(t){t=n.fu(t.hu),i.push(t)}),fa.resolve(i)},zc.prototype.Do=function(t,e){var n=this,r=new du(Sr);return e.forEach(function(t){var e=new Nc(t,0),t=new Nc(t,Number.POSITIVE_INFINITY);n._u.Qe([e,t],function(t){r=r.add(t.hu)})}),fa.resolve(this.wu(r))},zc.prototype.xo=function(t,e){var n=e.path,r=n.length+1,e=n;Ai.qt(e)||(e=e.child(""));var e=new Nc(new Ai(e),0),i=new du(Sr);return this._u.Ke(function(t){var e=t.key.path;return!!n.vt(e)&&(e.length===r&&(i=i.add(t.hu)),!0)},e),fa.resolve(this.wu(i))},zc.prototype.wu=function(t){var e=this,n=[];return t.forEach(function(t){null!==(t=e.fu(t))&&n.push(t)}),n},zc.prototype.No=function(n,r){var i=this;Ar(0===this.Eu(r.batchId,"removed")),this.Ra.shift();var o=this._u;return fa.forEach(r.mutations,function(t){var e=new Nc(t.key,r.batchId);return o=o.delete(e),i.Io.Oo(n,t.key)}).next(function(){i._u=o})},zc.prototype.Fo=function(t){},zc.prototype.Mo=function(t,e){var n=new Nc(e,0),n=this._u.We(n);return fa.resolve(e.isEqual(n&&n.key))},zc.prototype.ko=function(t){return this.Ra.length,fa.resolve()},zc.prototype.Eu=function(t,e){return this.du(t)},zc.prototype.du=function(t){return 0===this.Ra.length?0:t-this.Ra[0].batchId},zc.prototype.fu=function(t){return(t=this.du(t))<0||t>=this.Ra.length?null:this.Ra[t]},zc),Sc=(Gc.prototype.Er=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this.Tu(e);return this.docs=this.docs.Ie(r,{Ir:e,size:o,readTime:n}),this.size+=o-i,this.To.fo(t,r.path.yt())},Gc.prototype.mr=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Gc.prototype.Ar=function(t,e){return e=this.docs.get(e),fa.resolve(e?e.Ir:null)},Gc.prototype.getEntries=function(t,e){var n=this,r=vu;return e.forEach(function(t){var e=n.docs.get(t);r=r.Ie(t,e?e.Ir:null)}),fa.resolve(r)},Gc.prototype.Pc=function(t,e,n){for(var r=wu,i=new Ai(e.path.child("")),o=this.docs.Ve(i);o.Ce();){var s=(u=o.De()).key,u=(a=u.value).Ir,a=a.readTime;if(!e.path.vt(s.path))break;a.u(n)<=0||u instanceof fo&&ls(e,u)&&(r=r.Ie(u.key,u))}return fa.resolve(r)},Gc.prototype.Iu=function(t,e){return fa.forEach(this.docs,function(t){return e(t)})},Gc.prototype.lc=function(t){return new Rc(this)},Gc.prototype.dc=function(t){return fa.resolve(this.size)},Gc),Rc=(f(Bc,Ic=o),Bc.prototype.yr=function(n){var r=this,i=[];return this._r.forEach(function(t,e){e&&e.Ir?i.push(r.gc.Er(n,e.Ir,r.wr(t))):r.gc.mr(t)}),fa.hs(i)},Bc.prototype.Rr=function(t,e){return this.gc.Ar(t,e)},Bc.prototype.Pr=function(t,e){return this.gc.getEntries(t,e)},Bc),Lc=(Fc.prototype.Un=function(t,n){return this.mu.forEach(function(t,e){return n(e)}),fa.resolve()},Fc.prototype.Wo=function(t){return fa.resolve(this.lastRemoteSnapshotVersion)},Fc.prototype.jo=function(t){return fa.resolve(this.Au)},Fc.prototype.Uo=function(t){return this.highestTargetId=this.Pu.next(),fa.resolve(this.highestTargetId)},Fc.prototype.Go=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Au&&(this.Au=e),fa.resolve()},Fc.prototype.Ho=function(t){this.mu.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Pu=new ic(e),this.highestTargetId=e),t.sequenceNumber>this.Au&&(this.Au=t.sequenceNumber)},Fc.prototype.zo=function(t,e){return this.Ho(e),this.targetCount+=1,fa.resolve()},Fc.prototype.Yo=function(t,e){return this.Ho(e),fa.resolve()},Fc.prototype.Xo=function(t,e){return this.mu.delete(e.target),this.Ru.cu(e.targetId),--this.targetCount,fa.resolve()},Fc.prototype.Br=function(n,r,i){var o=this,s=0,u=[];return this.mu.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.mu.delete(t),u.push(o.Zo(n,e.targetId)),s++)}),fa.hs(u).next(function(){return s})},Fc.prototype.tc=function(t){return fa.resolve(this.targetCount)},Fc.prototype.ec=function(t,e){return e=this.mu.get(e)||null,fa.resolve(e)},Fc.prototype.nc=function(t,e,n){return this.Ru.iu(e,n),fa.resolve()},Fc.prototype.ic=function(e,t,n){this.Ru.ou(t,n);var r=this.persistence.Io,i=[];return r&&t.forEach(function(t){i.push(r.Oo(e,t))}),fa.hs(i)},Fc.prototype.Zo=function(t,e){return this.Ru.cu(e),fa.resolve()},Fc.prototype.oc=function(t,e){return e=this.Ru.uu(e),fa.resolve(e)},Fc.prototype.Mo=function(t,e){return fa.resolve(this.Ru.Mo(e))},Fc),kc=(qc.prototype.start=function(){return Promise.resolve()},qc.prototype.L=function(){return this.Oc=!1,Promise.resolve()},Object.defineProperty(qc.prototype,"Nr",{get:function(){return this.Oc},enumerable:!1,configurable:!0}),qc.prototype.Xc=function(){},qc.prototype.Zc=function(){},qc.prototype.Ia=function(){return this.To},qc.prototype.Ta=function(t){var e=this.yu[t.I()];return e||(e=new Oc(this.To,this.Io),this.yu[t.I()]=e),e},qc.prototype.ac=function(){return this.Qc},qc.prototype._c=function(){return this.Kc},qc.prototype.ma=function(){return this.Wc},qc.prototype.runTransaction=function(t,e,n){var r=this;br("MemoryPersistence","Starting transaction:",t);var i=new Dc(this.Fc.next());return this.Io.Vu(),n(i).next(function(t){return r.Io.pu(i).next(function(){return t})}).cs().then(function(t){return i.ki(),t})},qc.prototype.bu=function(e,n){return fa.ls(Object.values(this.yu).map(function(t){return function(){return t.Mo(e,n)}}))},qc),Dc=(f(jc,Ec=me),jc),Pc=(Mc.Du=function(t){return new Mc(t)},Object.defineProperty(Mc.prototype,"Cu",{get:function(){if(this.Su)return this.Su;throw Tr()},enumerable:!1,configurable:!0}),Mc.prototype.sc=function(t,e,n){return this.vu.sc(n,e),this.Cu.delete(n.toString()),fa.resolve()},Mc.prototype.rc=function(t,e,n){return this.vu.rc(n,e),this.Cu.add(n.toString()),fa.resolve()},Mc.prototype.Oo=function(t,e){return this.Cu.add(e.toString()),fa.resolve()},Mc.prototype.removeTarget=function(t,e){var n=this;this.vu.cu(e.targetId).forEach(function(t){return n.Cu.add(t.toString())});var r=this.persistence.ac();return r.oc(t,e.targetId).next(function(t){t.forEach(function(t){return n.Cu.add(t.toString())})}).next(function(){return r.Xo(t,e)})},Mc.prototype.Vu=function(){this.Su=new Set},Mc.prototype.pu=function(n){var r=this,i=this.persistence._c().lc();return fa.forEach(this.Cu,function(t){var e=Ai.$t(t);return r.xu(n,e).next(function(t){t||i.mr(e)})}).next(function(){return r.Su=null,i.apply(n)})},Mc.prototype.fc=function(t,e){var n=this;return this.xu(t,e).next(function(t){t?n.Cu.delete(e.toString()):n.Cu.add(e.toString())})},Mc.prototype.gu=function(t){return 0},Mc.prototype.xu=function(t,e){var n=this;return fa.ls([function(){return fa.resolve(n.vu.Mo(e))},function(){return n.persistence.ac().Mo(t,e)},function(){return n.persistence.bu(t,e)}])},Mc),Cc=(xc.prototype.Ou=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},xc.prototype.ku=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},xc.prototype.Fu=function(){var t={activeTargetIds:this.activeTargetIds.Dt(),updateTimeMs:Date.now()};return JSON.stringify(t)},xc),Uc=(Vc.prototype.sh=function(t){},Vc.prototype.rh=function(t,e,n){},Vc.prototype.ah=function(t){return this.xh.Ou(t),this.Nh[t]||"not-current"},Vc.prototype.fh=function(t,e,n){this.Nh[t]=e},Vc.prototype.hh=function(t){this.xh.ku(t)},Vc.prototype.lh=function(t){return this.xh.activeTargetIds.has(t)},Vc.prototype._h=function(t){delete this.Nh[t]},Vc.prototype.th=function(){return this.xh.activeTargetIds},Vc.prototype.nh=function(t){return this.xh.activeTargetIds.has(t)},Vc.prototype.start=function(){return this.xh=new Cc,Promise.resolve()},Vc.prototype.wh=function(t,e,n){},Vc.prototype.Eh=function(t){},Vc.prototype.L=function(){},Vc.prototype.Xi=function(t){},Vc.prototype.Ih=function(){},Vc);function Vc(){this.xh=new Cc,this.Nh={},this.Lu=null,this.Hi=null}function xc(){this.activeTargetIds=Iu}function Mc(t){this.persistence=t,this.vu=new Ac,this.Su=null}function jc(t){var e=this;return(e=Ec.call(this)||this).oo=t,e}function qc(t,e){var n=this;this.yu={},this.Fc=new Ta(0),this.Oc=!1,this.Oc=!0,this.Io=t(this),this.Qc=new Lc(this),this.To=new nc,this.Kc=(t=this.To,new Sc(t,function(t){return n.Io.gu(t)})),this.fe=new Ka(e),this.Wc=new Tc(this.fe)}function Fc(t){this.persistence=t,this.mu=new Va(bo,_o),this.lastRemoteSnapshotVersion=_i.min(),this.highestTargetId=0,this.Au=0,this.Ru=new Ac,this.targetCount=0,this.Pu=ic.Bo()}function Bc(t){var e=this;return(e=Ic.call(this)||this).gc=t,e}function Gc(t,e){this.To=t,this.Tu=e,this.docs=new ou(Ai.At),this.size=0}function zc(t,e){this.To=t,this.Io=e,this.Ra=[],this.lu=1,this._u=new du(Nc.eu)}function Hc(t,e){this.key=t,this.hu=e}function Wc(){this.tu=new du(Nc.eu),this.nu=new du(Nc.su)}function Yc(t){this.fe=t,this.Xa=new Map,this.Za=new Map}function Qc(){return"undefined"!=typeof document?document:null}function Kc(t,e,n,r,i){var o=this;this.Uh=t,this.Qh=e,this.ks=n,this.Kh={},this.Wh=[],this.jh=new Map,this.Gh=new Set,this.zh=[],this.Hh=i,this.Hh.$(function(t){n.Ws(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return sh(this)?(br("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Gh.add(4),[4,Zc(e)];case 1:return t.sent(),e.Jh.set("Unknown"),e.Gh.delete(4),[4,$c(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Jh=new Xc(n,r)}var Xc=(Jc.prototype.Mh=function(){var t=this;0===this.Fh&&(this.$h("Unknown"),this.Oh=this.ks.ni("online_state_timeout",1e4,function(){return t.Oh=null,t.Lh("Backend didn't respond within 10 seconds."),t.$h("Offline"),Promise.resolve()}))},Jc.prototype.Bh=function(t){"Online"===this.state?this.$h("Unknown"):(this.Fh++,1<=this.Fh&&(this.qh(),this.Lh("Connection failed 1 times. Most recent error: "+t.toString()),this.$h("Offline")))},Jc.prototype.set=function(t){this.qh(),this.Fh=0,"Online"===t&&(this.kh=!1),this.$h(t)},Jc.prototype.$h=function(t){t!==this.state&&(this.state=t,this.Lu(t))},Jc.prototype.Lh=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.kh?(_r(t),this.kh=!1):br("OnlineStateTracker",t)},Jc.prototype.qh=function(){null!==this.Oh&&(this.Oh.cancel(),this.Oh=null)},Jc);function Jc(t,e){this.ks=t,this.Lu=e,this.state="Unknown",this.Fh=0,this.Oh=null,this.kh=!0}function $c(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!sh(r))return[3,4];e=0,n=r.zh,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Zc(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.zh,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function th(t,e){t.jh.has(e.targetId)||(t.jh.set(e.targetId,e),oh(t)?ih(t):ph(t).li()&&nh(t,e))}function eh(t,e){var n=t,t=ph(n);n.jh.delete(e),t.li()&&rh(n,e),0===n.jh.size&&(t.li()?t.di():sh(n)&&n.Jh.set("Unknown"))}function nh(t,e){t.Yh.Dn(e.targetId),ph(t).gi(e)}function rh(t,e){t.Yh.Dn(e),ph(t).Vi(e)}function ih(e){e.Yh=new Pu({Xn:function(t){return e.Kh.Xn(t)},Zn:function(t){return e.jh.get(t)||null}}),ph(e).start(),e.Jh.Mh()}function oh(t){return sh(t)&&!ph(t).hi()&&0<t.jh.size}function sh(t){return 0===t.Gh.size}function uh(t){t.Yh=void 0}function ah(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!pa(r))throw r;return n.Gh.add(1),[4,Zc(n)];case 1:return t.sent(),n.Jh.set("Offline"),i=i||function(){return gc(n.Uh)},n.ks.ea(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return br("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Gh.delete(1),[4,$c(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function ch(e,n){return n().catch(function(t){return ah(e,t,n)})}function hh(c){return y(this,void 0,void 0,function(){var o,s,u,a;return v(this,function(t){switch(t.label){case 0:s=dh(o=c),u=0<o.Wh.length?o.Wh[o.Wh.length-1].batchId:-1,t.label=1;case 1:if(!(sh(o)&&o.Wh.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(n=o.Uh,r=u,(i=n).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===r&&(r=-1),i.Ra.po(t,r)}))];case 3:return null===(a=t.sent())?(0===o.Wh.length&&s.di(),[3,7]):(u=a.batchId,e=a,(n=o).Wh.push(e),(n=dh(n)).li()&&n.bi&&n.vi(e.mutations),[3,6]);case 4:return a=t.sent(),[4,ah(o,a)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return fh(o)&&lh(o),[2]}var e,n,r,i})})}function fh(t){return sh(t)&&!dh(t).hi()&&0<t.Wh.length}function lh(t){dh(t).start()}function ph(n){var t,e,r,i=this;return n.nl||(n.nl=(t=n.Qh,e=n.ks,r={Y:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.jh.forEach(function(t,e){nh(n,t)}),[2]})})}.bind(null,n),Z:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return uh(e),oh(e)?(e.Jh.Bh(n),ih(e)):e.Jh.set("Unknown"),[2]})})}.bind(null,n),yi:function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Jh.set("Online"),!(u instanceof ku&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.jh.has(i)?[4,o.Kh.Xh(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.jh.delete(i),o.Yh.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),br("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,ah(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof Ru?s.Yh.$n(u):u instanceof Lu?s.Yh.jn(u):s.Yh.qn(u),a.isEqual(_i.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,gc(s.Uh)];case 8:return o=t.sent(),0<=a.u(o)?[4,(i=a,(e=(r=s).Yh.Hn(i)).rn.forEach(function(t,e){var n;0<t.resumeToken.o()&&(n=r.jh.get(e))&&r.jh.set(e,n.ae(t.resumeToken,i))}),e.on.forEach(function(t){var e=r.jh.get(t);e&&(r.jh.set(t,e.ae(Lr.h,e.oe)),rh(r,t),e=new ds(e.target,t,1,e.sequenceNumber),nh(r,e))}),r.Kh.Zh(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return br("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,ah(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n)},t.Ni(),new _a(e,t.ri,t.credentials,t.fe,r)),n.zh.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.nl.fi(),oh(n)?ih(n):n.Jh.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.nl.stop()];case 2:t.sent(),uh(n),t.label=3;case 3:return[2]}})})})),n.nl}function dh(n){var t,e,r,i=this;return n.sl||(n.sl=(t=n.Qh,e=n.ks,r={Y:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return dh(e).Ci(),[2]})})}.bind(null,n),Z:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&dh(e).bi?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return li(n=i.code)&&n!==Pr.ABORTED?(e=r.Wh.shift(),dh(r).fi(),[4,ch(r,function(){return r.Kh.el(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,hh(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return fh(e)&&lh(e),[2]}})})}.bind(null,n),Di:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=dh(o),n=0,r=o.Wh;n<r.length;n++)i=r[n],e.vi(i.mutations);return[2]})})}.bind(null,n),Si:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Wh.shift(),n=Ua.from(e,i,o),[4,ch(r,function(){return r.Kh.tl(n)})];case 1:return t.sent(),[4,hh(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Ni(),new Ea(e,t.ri,t.credentials,t.fe,r)),n.zh.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.sl.fi(),[4,hh(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.sl.stop()];case 3:t.sent(),0<n.Wh.length&&(br("RemoteStore","Stopping write stream with "+n.Wh.length+" pending writes"),n.Wh=[]),t.label=4;case 4:return[2]}})})})),n.sl}function yh(){this.queries=new Va(hs,cs),this.onlineState="Unknown",this.rl=new Set}var vh=function(){this.il=void 0,this.listeners=[]};function gh(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new vh),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.ol(n)];case 2:return o.il=t.sent(),[3,4];case 3:return o=va(o=t.sent(),"Initialization of query '"+fs(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.cl(e.onlineState),i.il&&u.al(i.il)&&wh(e),[2]}})})}function mh(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.ul(n))]:[2]})})}function wh(t){t.rl.forEach(function(t){t.next()})}var bh=(Oh.prototype.al=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Nu(t.query,t.docs,t.Ze,e,t.tn,t.fromCache,t.en,!0)}var o=!1;return this.ll?this.fl(t)&&(this.hl.next(t),o=!0):this.dl(t,this.onlineState)&&(this.wl(t),o=!0),this._l=t,o},Oh.prototype.onError=function(t){this.hl.error(t)},Oh.prototype.cl=function(t){this.onlineState=t;var e=!1;return this._l&&!this.ll&&this.dl(this._l,t)&&(this.wl(this._l),e=!0),e},Oh.prototype.dl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.El&&n||t.docs.bt()&&"Offline"!==e)},Oh.prototype.fl=function(t){if(0<t.docChanges.length)return!0;var e=this._l&&this._l.hasPendingWrites!==t.hasPendingWrites;return!(!t.en&&!e)&&!0===this.options.includeMetadataChanges},Oh.prototype.wl=function(t){t=Nu.sn(t.query,t.docs,t.tn,t.fromCache),this.ll=!0,this.hl.next(t)},Oh),_h=(Nh.prototype.Tl=function(){return"metadata"in this.payload},Nh),Eh=(Ah.prototype.Ha=function(t){return $u(this.fe,t)},Ah.prototype.Ja=function(t){return t.metadata.exists?(r=$u(this.fe,(n=t.document).name),e=Qu(n.updateTime),n=new io({mapValue:{fields:n.fields}}),new fo(r,e,n,{hasCommittedMutations:!1})):new lo(this.Ha(t.metadata.name),this.Ya(t.metadata.readTime));var e,n,r},Ah.prototype.Ya=Qu,Ah),Ih=(Th.prototype.ml=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},Th.prototype.Al=function(t){for(var e=new Map,n=new Eh(this.fe),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.Ha(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||Eu()).add(s);e.set(c,h)}}return e},Th.prototype.complete=function(){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return[4,function(f,l,p,d){return y(this,void 0,void 0,function(){var n,r,i,o,e,s,u,a,c,h;return v(this,function(t){switch(t.label){case 0:for(n=f,r=Eu(),i=vu,o=bu,e=0,s=p;e<s.length;e++)u=s[e],a=l.Ha(u.metadata.name),u.document&&(r=r.add(a)),i=i.Ie(a,l.Ja(u)),o=o.Ie(a,l.Ya(u.metadata.readTime));return c=n.Qa.lc({yc:!0}),[4,wc(n,us(ts(Ei.xt("__bundle__/docs/"+d))))];case 1:return h=t.sent(),[2,n.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return mc(e,c,i,_i.min(),o).next(function(t){return c.apply(e),t}).next(function(t){return n.Qc.Zo(e,h.targetId).next(function(){return n.Qc.nc(e,r,h.targetId)}).next(function(){return n.Ka.pa(e,t)})})})]}})})}(this.Uh,new Eh(this.fe),this.documents,this.Il.id)];case 1:e=t.sent(),n=this.Al(this.documents),r=0,i=this.queries,t.label=2;case 2:return r<i.length?(i=i[r],[4,function(e,i,o){return void 0===o&&(o=Eu()),y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return[4,wc(e,us(ec(i.bundledQuery)))];case 1:return n=t.sent(),[2,(r=e).persistence.runTransaction("Save named query","readwrite",function(t){var e=Qu(i.readTime);return 0<=n.oe.u(e)?r.Wc.lo(t,i):(e=n.ae(Lr.h,e),r.Ba=r.Ba.Ie(e.targetId,e),r.Qc.Yo(t,e).next(function(){return r.Qc.Zo(t,n.targetId)}).next(function(){return r.Qc.nc(t,o,n.targetId)}).next(function(){return r.Wc.lo(t,i)}))})]}})})}(this.Uh,i,n.get(i.name))]):[3,5];case 3:t.sent(),t.label=4;case 4:return r++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Pa(Object.assign({},this.progress),e))]}})})},Th);function Th(t,e,n){this.Il=t,this.Uh=e,this.fe=n,this.queries=[],this.documents=[],this.progress=Sh(t)}function Ah(t){this.fe=t}function Nh(t,e){this.payload=t,this.byteLength=e}function Oh(t,e,n){this.query=t,this.hl=e,this.ll=!1,this._l=null,this.onlineState="Unknown",this.options=n||{}}function Sh(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var Rh=function(t){this.key=t},Lh=function(t){this.key=t},kh=(Object.defineProperty(Vh.prototype,"pl",{get:function(){return this.Rl},enumerable:!1,configurable:!0}),Vh.prototype.bl=function(t,e){var s=this,u=e?e.vl:new Au,a=(e||this).Vl,c=(e||this).tn,h=a,f=!1,l=es(this.query)&&a.size===this.query.limit?a.last():null,p=ns(this.query)&&a.size===this.query.limit?a.first():null;if(t.Pe(function(t,e){var n=a.get(t),r=(r=e instanceof fo?e:null)&&(ls(s.query,r)?r:null),i=!!n&&s.tn.has(n.key),o=!!r&&(r.Jt||s.tn.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.Sl(n,r)||(u.track({type:2,doc:r}),e=!0,(l&&0<s.gl(r,l)||p&&s.gl(r,p)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(l||p)&&(f=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),es(this.query)||ns(this.query))for(;h.size>this.query.limit;){var n=es(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{Vl:h,vl:u,$a:f,tn:c}},Vh.prototype.Sl=function(t,e){return t.Jt&&e.hasCommittedMutations&&!e.Jt},Vh.prototype.yr=function(t,e,n){var o=this,r=this.Vl;this.Vl=t.Vl,this.tn=t.tn;var i=t.vl.Xe();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.gl(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Tr()}}var r,i}),this.Dl(n);var s=e?this.Cl():[],e=(n=0===this.yl.size&&this.ln?1:0)!==this.Pl;return this.Pl=n,0!==i.length||e?{snapshot:new Nu(this.query,t.Vl,r,i,t.tn,0==n,e,!1),xl:s}:{xl:s}},Vh.prototype.cl=function(t){return this.ln&&"Offline"===t?(this.ln=!1,this.yr({Vl:this.Vl,vl:new Au,tn:this.tn,$a:!1},!1)):{xl:[]}},Vh.prototype.Nl=function(t){return!this.Rl.has(t)&&!!this.Vl.has(t)&&!this.Vl.get(t).Jt},Vh.prototype.Dl=function(t){var e=this;t&&(t._n.forEach(function(t){return e.Rl=e.Rl.add(t)}),t.fn.forEach(function(t){}),t.dn.forEach(function(t){return e.Rl=e.Rl.delete(t)}),this.ln=t.ln)},Vh.prototype.Cl=function(){var e=this;if(!this.ln)return[];var n=this.yl;this.yl=Eu(),this.Vl.forEach(function(t){e.Nl(t.key)&&(e.yl=e.yl.add(t.key))});var r=[];return n.forEach(function(t){e.yl.has(t)||r.push(new Lh(t))}),this.yl.forEach(function(t){n.has(t)||r.push(new Rh(t))}),r},Vh.prototype.Fl=function(t){return this.Rl=t.za,this.yl=Eu(),t=this.bl(t.documents),this.yr(t,!0)},Vh.prototype.Ol=function(){return Nu.sn(this.query,this.Vl,this.tn,0===this.Pl)},Vh),Dh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Ph=function(t){this.key=t,this.kl=!1},Ch=(Object.defineProperty(Uh.prototype,"Xl",{get:function(){return!0===this.Yl},enumerable:!1,configurable:!0}),Uh);function Uh(t,e,n,r,i,o){this.Uh=t,this.Ml=e,this.$l=n,this.Ll=r,this.currentUser=i,this.Bl=o,this.ql={},this.Ul=new Va(hs,cs),this.Ql=new Map,this.Kl=[],this.Wl=new ou(Ai.At),this.jl=new Map,this.Gl=new Ac,this.zl={},this.Hl=new Map,this.Jl=ic.qo(),this.onlineState="Unknown",this.Yl=void 0}function Vh(t,e){this.query=t,this.Rl=e,this.Pl=null,this.ln=!1,this.yl=Eu(),this.tn=Eu(),this.gl=ps(t),this.Vl=new Tu(this.gl)}function xh(l,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:(o=l).Ml.Kh.tl=function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Uh,h=s,(f=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=h.batch.keys(),n=f.Qa.lc({yc:!0}),i=f,o=t,s=n,u=(r=h).batch,a=u.keys(),c=fa.resolve();return a.forEach(function(n){c=c.next(function(){return s.Ar(o,n)}).next(function(t){var e=t;Ar(null!==(t=r.ar.get(n))),(!e||e.version.u(t)<0)&&(e=u.nr(n,e,r))&&s.Er(e,r.cr)})}),c.next(function(){return i.Ra.No(o,u)}).next(function(){return n.apply(t)}).next(function(){return f.Ra.ko(t)}).next(function(){return f.Ka.Va(t,e)})}))];case 2:return i=t.sent(),Bh(n,r,null),Fh(n,r),n.Ll.rh(r,"acknowledged"),[4,Yh(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,Da(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,h,f})})}.bind(null,o),o.Ml.Kh.el=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Uh,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Ra.yo(e,r).next(function(t){return Ar(null!==t),n=t.keys(),i.Ra.No(e,t)}).next(function(){return i.Ra.ko(e)}).next(function(){return i.Ka.Va(e,n)})}))];case 2:return o=t.sent(),Bh(n,u,a),Fh(n,u),n.Ll.rh(u,"rejected",a),[4,Yh(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Da(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.Uh,a=p,h=r,f=bi.now(),i=a.reduce(function(t,e){return t.add(e.key)},Eu()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.Ka.Va(u,i).next(function(t){c=t;for(var e,n=[],r=0,i=a;r<i.length;r++){var o=i[r],s=(e=o,s=c.get(o.key),void 0!==e.fieldTransforms?function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof fo?e.field(o.field):void 0;null!=(s=ws(o.transform,s||null))&&(n=(null==n?new oo:n).set(o.field,s))}return n?n.Gt():null}(e.fieldTransforms,s):null);null!=s&&n.push(new Ys(o.key,s,function s(t){var u=[];return Vi(t.fields||{},function(t,e){var n=new Ti([t]);if(ro(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Mi(u)}(s.proto.mapValue),Ms.exists(!0)))}return h.Ra.Po(u,f,n,a)})}).then(function(t){var e=t.rr(c);return{batchId:t.batchId,_r:e}}))];case 2:return s=t.sent(),u.Ll.sh(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.zl[e.currentUser.I()])||new ou(Sr)).Ie(n,o),e.zl[e.currentUser.I()]=r,[4,Yh(u,s._r)];case 3:return t.sent(),[4,hh(u.Ml)];case 4:return t.sent(),[3,6];case 5:return u=va(u=t.sent(),"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,c,h,f,i,o})})}function Mh(o,s){return y(this,void 0,void 0,function(){var n,i;return v(this,function(t){switch(t.label){case 0:n=o,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Uh,a=e,c=(r=s).oe,h=a.Ba,a.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=a.Qa.lc({yc:!0});h=a.Ba;var u=[];r.rn.forEach(function(t,e){var n,r,i,o=h.get(e);o&&(u.push(a.Qc.ic(s,t.dn,e).next(function(){return a.Qc.nc(s,t._n,e)})),0<(i=t.resumeToken).o()&&(n=o.ae(i,c).ce(s.oo),h=h.Ie(e,n),r=o,i=t,Ar(0<(o=n).resumeToken.o()),(0===r.resumeToken.o()||3e8<=o.oe.Et()-r.oe.Et()||0<i._n.size+i.fn.size+i.dn.size)&&u.push(a.Qc.Yo(s,n))))});var e,n=vu;return r.cn.forEach(function(t,e){r.an.has(t)&&u.push(a.persistence.Io.fc(s,t))}),u.push(mc(s,t,r.cn,c,void 0).next(function(t){n=t})),c.isEqual(_i.min())||(e=a.Qc.Wo(s).next(function(t){return a.Qc.Go(s,s.oo,c)}),u.push(e)),fa.hs(u).next(function(){return t.apply(s)}).next(function(){return a.Ka.pa(s,n)})}).then(function(t){return a.Ba=h,t}))];case 2:return i=t.sent(),s.rn.forEach(function(t,e){(e=n.jl.get(e))&&(Ar(t._n.size+t.fn.size+t.dn.size<=1),0<t._n.size?e.kl=!0:0<t.fn.size?Ar(e.kl):0<t.dn.size&&(Ar(e.kl),e.kl=!1))}),[4,Yh(n,i,s)];case 3:return t.sent(),[3,6];case 4:return[4,Da(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,a,c,h})})}function jh(t,n,e){var r;((t=t).Xl&&0===e||!t.Xl&&1===e)&&(r=[],t.Ul.forEach(function(t,e){(e=e.view.cl(n)).snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].cl(i)&&(o=!0)}),o&&wh(t)}(t.$l,n),r.length&&t.ql.yi(r),t.onlineState=n,t.Xl&&t.Ll.Eh(n))}function qh(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:sh((n=o).Ml)||br("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Uh).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Ra.bo(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Hl.get(r)||[]).push(s),n.Hl.set(r,i),[3,4]);case 3:return i=va(i=t.sent(),"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function Fh(t,e){(t.Hl.get(e)||[]).forEach(function(t){t.resolve()}),t.Hl.delete(e)}function Bh(t,e,n){var r=t,i=r.zl[r.currentUser.I()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.zl[r.currentUser.I()]=i)}function Gh(e,t,n){void 0===n&&(n=null),e.Ll.hh(t);for(var r=0,i=e.Ql.get(t);r<i.length;r++){var o=i[r];e.Ul.delete(o),n&&e.ql.t_(o,n)}e.Ql.delete(t),e.Xl&&e.Gl.cu(t).forEach(function(t){e.Gl.Mo(t)||zh(e,t)})}function zh(t,e){var n=t.Wl.get(e);null!==n&&(eh(t.Ml,n),t.Wl=t.Wl.remove(e),t.jl.delete(n),Wh(t))}function Hh(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var u=s[o];u instanceof Rh?(t.Gl.sc(u.key,e),r=t,i=(i=u).key,r.Wl.get(i)||(br("SyncEngine","New document in limbo: "+i),r.Kl.push(i),Wh(r))):u instanceof Lh?(br("SyncEngine","Document no longer in limbo: "+u.key),t.Gl.rc(u.key,e),t.Gl.Mo(u.key)||zh(t,u.key)):Tr()}}function Wh(t){for(;0<t.Kl.length&&t.Wl.size<t.Bl;){var e=t.Kl.shift(),n=t.Jl.next();t.jl.set(n,new Ph(e)),t.Wl=t.Wl.Ie(e,n),th(t.Ml,new ds(us(ts(e.path)),n,2,Ta.Zi))}}function Yh(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Ul.bt()?[3,3]:(n.Ul.forEach(function(t,e){o.push(n.Zl(e,s,u).then(function(t){t&&(n.Xl&&n.Ll.fh(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=sc.Na(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.ql.yi(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return fa.forEach(c,function(e){return fa.forEach(e.Ca,function(t){return r.persistence.Io.sc(n,e.targetId,t)}).next(function(){return fa.forEach(e.xa,function(t){return r.persistence.Io.rc(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!pa(e=t.sent()))throw e;return br("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.Ba.get(o),u=s.oe,u=s.ue(u),r.Ba=r.Ba.Ie(o,u));return[2]}})})}(n.Uh,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function Qh(t,e,n){var r=t;(function(l,p,d){return y(this,void 0,void 0,function(){var u,a,c,h,f;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,14,,15]),[4,p.getMetadata()];case 1:return u=t.sent(),[4,(r=l.Uh,o=r,s=Qu((i=u).createTime),o.persistence.runTransaction("hasNewerBundle","readonly",function(t){return o.Wc.ao(t,i.id)}).then(function(t){return!!t&&0<=t.createTime.u(s)}))];case 2:return t.sent()?[4,p.close()]:[3,4];case 3:return[2,(t.sent(),void d.e_({taskState:"Success",documentsLoaded:u.totalDocuments,bytesLoaded:u.totalBytes,totalDocuments:u.totalDocuments,totalBytes:u.totalBytes}))];case 4:return d.n_(Sh(u)),a=new Ih(u,l.Uh,p.fe),[4,p.s_()];case 5:c=t.sent(),t.label=6;case 6:return c?[4,a.ml(c)]:[3,10];case 7:return(h=t.sent())&&d.n_(h),[4,p.s_()];case 8:c=t.sent(),t.label=9;case 9:return[3,6];case 10:return[4,a.complete()];case 11:return f=t.sent(),[4,Yh(l,f.tr,void 0)];case 12:return t.sent(),[4,(r=l.Uh,e=u,(n=r).persistence.runTransaction("Save bundle","readwrite",function(t){return n.Wc.uo(t,e)}))];case 13:return t.sent(),d.e_(f.progress),[3,15];case 14:return Er("SyncEngine","Loading bundle failed with "+(f=t.sent())),d.i_(f),[3,15];case 15:return[2]}var e,n,r,i,o,s})})})(r,e,n).then(function(){r.Ll.Ih()})}var Kh=($h.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.fe=ha(e.rt.O),this.Ll=this.r_(e),this.persistence=this.o_(e),[4,this.persistence.start()];case 1:return t.sent(),this.c_=this.a_(e),this.Uh=this.u_(e),[2]}})})},$h.prototype.a_=function(t){return null},$h.prototype.u_=function(t){return e=this.persistence,n=new uc,r=t.h_,t=this.fe,new ac(e,n,r,t);var e,n,r},$h.prototype.o_=function(t){return new kc(Pc.Du,this.fe)},$h.prototype.r_=function(t){return new Uc},$h.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.c_&&this.c_.stop(),[4,this.Ll.L()];case 1:return t.sent(),[4,this.persistence.L()];case 2:return t.sent(),[2]}})})},$h),Xh=(Jh.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Uh?[3,2]:(this.Uh=n.Uh,this.Ll=n.Ll,this.Qh=this.__(r),this.Ml=this.f_(r),this.$l=this.d_(r),this.$u=this.w_(r,!n.synchronizeTabs),this.Ll.Lu=function(t){return jh(e.$u,t,1)},this.Ml.Kh.E_=function(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(br("SyncEngine","User change. New user:",o.I()),[4,vc(n.Uh,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Hl.forEach(function(t){t.forEach(function(t){t.reject(new Cr(Pr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Hl.clear(),n.Ll.wh(o,r.ja,r.Ga),[4,Yh(n,r.Wa)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this.$u),[4,function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Gh.delete(2),[4,$c(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Gh.add(2),[4,Zc(e)]);case 3:t.sent(),e.Jh.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.Ml,this.$u.Xl)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Jh.prototype.d_=function(t){return new yh},Jh.prototype.__=function(t){var e=ha(t.rt.O),n=(n=t.rt,new wi(n));return t=t.credentials,new Ia(t,n,e)},Jh.prototype.f_=function(t){var e=this;return new Kc(this.Uh,this.Qh,t.ks,function(t){return jh(e.$u,t,0)},t=new(ti.G()?ti:Zr))},Jh.prototype.w_=function(t,e){return n=this.Uh,r=this.Ml,i=this.$l,o=this.Ll,s=t.h_,t=t.Bl,e=e,t=new Ch(n,r,i,o,s,t),e&&(t.Yl=!0),t;var n,r,i,o,s},Jh.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,br("RemoteStore","RemoteStore shutting down."),e.Gh.add(5),[4,Zc(e)];case 1:return t.sent(),e.Hh.L(),e.Jh.set("Unknown"),[2]}})})}(this.Ml)},Jh);function Jh(){}function $h(){this.synchronizeTabs=!1}function Zh(n,r){void 0===r&&(r=10240);var i=0;return{read:function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return i<n.byteLength?(e={value:n.slice(i,i+r),done:!1},[2,(i+=r,e)]):[2,{done:!0}]})})},cancel:function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2]})})},releaseLock:function(){}}}var tf,ef=(df.prototype.next=function(t){this.observer.next&&this.T_(this.observer.next,t)},df.prototype.error=function(t){this.observer.error?this.T_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},df.prototype.I_=function(){this.muted=!0},df.prototype.T_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},df),nf=(pf.prototype.close=function(){return this.m_.cancel()},pf.prototype.getMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2,this.metadata.promise]})})},pf.prototype.s_=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.R_())]}})})},pf.prototype.R_=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return[4,this.P_()];case 1:return null===(e=t.sent())?[2,null]:(r=this.A_.decode(e),n=Number(r),isNaN(n)&&this.y_("length string ("+r+") is not valid number"),[4,this.g_(n)]);case 2:return r=t.sent(),[2,new _h(JSON.parse(r),e.length+n)]}})})},pf.prototype.V_=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},pf.prototype.P_=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.V_()<0?[4,this.p_()]:[3,3];case 1:if(t.sent())return[3,3];t.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((e=this.V_())<0&&this.y_("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,e),[2,(this.buffer=this.buffer.slice(e),n)])}})})},pf.prototype.g_=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.buffer.length<n?[4,this.p_()]:[3,3];case 1:t.sent()&&this.y_("Reached the end of bundle when more is expected."),t.label=2;case 2:return[3,0];case 3:return e=this.A_.decode(this.buffer.slice(0,n)),[2,(this.buffer=this.buffer.slice(n),e)]}})})},pf.prototype.y_=function(t){throw this.m_.cancel(),new Error("Invalid bundle format: "+t)},pf.prototype.p_=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,this.m_.read()];case 1:return(e=t.sent()).done||((n=new Uint8Array(this.buffer.length+e.value.length)).set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n),[2,e.done]}})})},pf),rf=(lf.prototype.isEqual=function(t){return this.b_.isEqual(t.b_)},lf),of=function(t){this._methodName=t},sf=(Object.defineProperty(ff.prototype,"D_",{get:function(){return this.S_.path},enumerable:!1,configurable:!0}),Object.defineProperty(ff.prototype,"id",{get:function(){return this.S_.path.Vt()},enumerable:!1,configurable:!0}),Object.defineProperty(ff.prototype,"path",{get:function(){return this.S_.path.Ct()},enumerable:!1,configurable:!0}),Object.defineProperty(ff.prototype,"parent",{get:function(){return new af(this.firestore,this.v_,this.S_.path.yt())},enumerable:!1,configurable:!0}),ff.prototype.withConverter=function(t){return new ff(this.firestore,t,this.S_)},ff),uf=(hf.prototype.withConverter=function(t){return new hf(this.firestore,t,this.C_)},hf),af=(f(cf,tf=uf),Object.defineProperty(cf.prototype,"id",{get:function(){return this.C_.path.Vt()},enumerable:!1,configurable:!0}),Object.defineProperty(cf.prototype,"path",{get:function(){return this.C_.path.Ct()},enumerable:!1,configurable:!0}),Object.defineProperty(cf.prototype,"parent",{get:function(){var t=this.D_.yt();return t.bt()?null:new sf(this.firestore,null,new Ai(t))},enumerable:!1,configurable:!0}),cf.prototype.withConverter=function(t){return new cf(this.firestore,t,this.D_)},cf);function cf(t,e,n){var r=this;return(r=tf.call(this,t,e,ts(n))||this).firestore=t,r.D_=n,r.type="collection",r}function hf(t,e,n){this.v_=e,this.C_=n,this.type="query",this.firestore=t}function ff(t,e,n){this.v_=e,this.S_=n,this.type="document",this.firestore=t}function lf(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Cr(Pr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.b_=new Ti(t)}function pf(t,e){var n=this;this.m_=t,this.fe=e,this.metadata=new mi,this.buffer=new Uint8Array,this.A_=new TextDecoder("utf-8"),this.R_().then(function(t){t&&t.Tl()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}function df(t){this.observer=t,this.muted=!1}function yf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Vr&&(t=t._),Fa("collection","path",e),t instanceof $a)return Ha(n=Ei.xt.apply(Ei,l([e],r))),new af(t,null,n);if(!(t instanceof sf||t instanceof af))throw new Cr(Pr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Ha(n=Ei.xt.apply(Ei,l([t.path],r)).child(Ei.xt(e))),new af(t.firestore,null,n)}function vf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Vr&&(t=t._),1===arguments.length&&(e=Nr.t()),Fa("doc","path",e),t instanceof $a)return za(n=Ei.xt.apply(Ei,l([e],r))),new sf(t,null,new Ai(n));if(!(t instanceof sf||t instanceof af))throw new Cr(Pr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return za(n=t.D_.child(Ei.xt.apply(Ei,l([e],r)))),new sf(t.firestore,t instanceof af?t.v_:null,new Ai(n))}function gf(t,e){return t instanceof Vr&&(t=t._),e instanceof Vr&&(e=e._),(t instanceof sf||t instanceof af)&&(e instanceof sf||e instanceof af)&&t.firestore===e.firestore&&t.path===e.path&&t.v_===e.v_}function mf(t,e){return t instanceof Vr&&(t=t._),e instanceof Vr&&(e=e._),t instanceof uf&&e instanceof uf&&t.firestore===e.firestore&&cs(t.C_,e.C_)&&t.v_===e.v_}var wf=(Object.defineProperty(Af.prototype,"latitude",{get:function(){return this.x_},enumerable:!1,configurable:!0}),Object.defineProperty(Af.prototype,"longitude",{get:function(){return this.N_},enumerable:!1,configurable:!0}),Af.prototype.isEqual=function(t){return this.x_===t.x_&&this.N_===t.N_},Af.prototype.toJSON=function(){return{latitude:this.x_,longitude:this.N_}},Af.prototype.dt=function(t){return Sr(this.x_,t.x_)||Sr(this.N_,t.N_)},Af),bf=/^__.*__$/,_f=(Tf.prototype.F_=function(t,e){return null!==this.Te?new Ys(t,this.data,this.Te,e,this.fieldTransforms):new Ws(t,this.data,e,this.fieldTransforms)},Tf),Ef=(If.prototype.F_=function(t,e){return new Ys(t,this.data,this.Te,e,this.fieldTransforms)},If);function If(t,e,n){this.data=t,this.Te=e,this.fieldTransforms=n}function Tf(t,e,n){this.data=t,this.Te=e,this.fieldTransforms=n}function Af(t,e){if(!isFinite(t)||t<-90||90<t)throw new Cr(Pr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Cr(Pr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.x_=t,this.N_=e}function Nf(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Tr()}}var Of=(Object.defineProperty(Lf.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Lf.prototype,"k_",{get:function(){return this.settings.k_},enumerable:!1,configurable:!0}),Lf.prototype.M_=function(t){return new Lf(Object.assign(Object.assign({},this.settings),t),this.O,this.fe,this.ignoreUndefinedProperties,this.fieldTransforms,this.Te)},Lf.prototype.L_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.M_({path:e,B_:!1})).q_(t),e},Lf.prototype.U_=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t);return(t=this.M_({path:t,B_:!1})).O_(),t},Lf.prototype.Q_=function(t){return this.M_({path:void 0,B_:!0})},Lf.prototype.K_=function(t){return ol(t,this.settings.methodName,this.settings.W_||!1,this.path,this.settings.j_)},Lf.prototype.contains=function(e){return void 0!==this.Te.find(function(t){return e.vt(t)})||void 0!==this.fieldTransforms.find(function(t){return e.vt(t.field)})},Lf.prototype.O_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.q_(this.path.get(t))},Lf.prototype.q_=function(t){if(0===t.length)throw this.K_("Document fields must not be empty");if(Nf(this.k_)&&bf.test(t))throw this.K_('Document fields cannot begin and end with "__"')},Lf),Sf=(Rf.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new Of({k_:t,methodName:e,j_:n,path:Ti.Nt(),B_:!1,W_:r},this.O,this.fe,this.ignoreUndefinedProperties)},Rf);function Rf(t,e,n){this.O=t,this.ignoreUndefinedProperties=e,this.fe=n||ha(t)}function Lf(t,e,n,r,i,o){this.settings=t,this.O=e,this.fe=n,this.ignoreUndefinedProperties=r,void 0===i&&this.O_(),this.fieldTransforms=i||[],this.Te=o||[]}function kf(t){var e=t.so(),n=ha(t.zr);return new Sf(t.zr,!!e.ignoreUndefinedProperties,n)}function Df(t,e,n,r,i,o){void 0===o&&(o={});var s=t.G_(o.merge||o.mergeFields?2:0,e,n,i);el("Data must be an object, but it was:",s,r);var u,a,r=Zf(r,s);if(o.merge)u=new Mi(s.Te),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=nl(e,f[h],n);if(!s.contains(l))throw new Cr(Pr.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");sl(c,l)||c.push(l)}u=new Mi(c),a=s.fieldTransforms.filter(function(t){return u.Qt(t.field)})}else u=null,a=s.fieldTransforms;return new _f(new io(r),u,a)}var Pf,Cf=(f(Uf,Pf=of),Uf.prototype.z_=function(t){if(2!==t.k_)throw 1===t.k_?t.K_(this._methodName+"() can only appear at the top level of your update data"):t.K_(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.Te.push(t.path),null},Uf.prototype.isEqual=function(t){return t instanceof Uf},Uf);function Uf(){return null!==Pf&&Pf.apply(this,arguments)||this}function Vf(t,e,n){return new Of({k_:3,j_:e.settings.j_,methodName:t._methodName,B_:n},e.O,e.fe,e.ignoreUndefinedProperties)}var xf,Mf,jf,qf,Ff=(f(Qf,qf=of),Qf.prototype.z_=function(t){return new Vs(t.path,new Es)},Qf.prototype.isEqual=function(t){return t instanceof Qf},Qf),Bf=(f(Yf,jf=of),Yf.prototype.z_=function(t){var e=Vf(this,t,!0),n=this.H_.map(function(t){return $f(t,e)}),n=new Is(n);return new Vs(t.path,n)},Yf.prototype.isEqual=function(t){return this===t},Yf),Gf=(f(Wf,Mf=of),Wf.prototype.z_=function(t){var e=Vf(this,t,!0),n=this.H_.map(function(t){return $f(t,e)}),n=new Ss(n);return new Vs(t.path,n)},Wf.prototype.isEqual=function(t){return this===t},Wf),zf=(f(Hf,xf=of),Hf.prototype.z_=function(t){var e=new Ds(t.fe,ms(t.fe,this.J_));return new Vs(t.path,e)},Hf.prototype.isEqual=function(t){return this===t},Hf);function Hf(t,e){var n=this;return(n=xf.call(this,t)||this).J_=e,n}function Wf(t,e){var n=this;return(n=Mf.call(this,t)||this).H_=e,n}function Yf(t,e){var n=this;return(n=jf.call(this,t)||this).H_=e,n}function Qf(){return null!==qf&&qf.apply(this,arguments)||this}function Kf(t,r,i,e){var o=t.G_(1,r,i);el("Data must be an object, but it was:",o,e);var s=[],u=new oo;return Vi(e,function(t,e){var n=il(r,t,i);e instanceof Vr&&(e=e._),t=o.U_(n),e instanceof Cf?s.push(n):null!=(t=$f(e,t))&&(s.push(n),u.set(n,t))}),e=new Mi(s),new Ef(u.Gt(),e,o.fieldTransforms)}function Xf(t,e,n,r,i,o){var s=t.G_(1,e,n),u=[nl(e,r,n)],a=[i];if(o.length%2!=0)throw new Cr(Pr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(nl(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new oo,y=u.length-1;0<=y;--y)sl(p,u[y])||(h=u[y],(f=a[y])instanceof Vr&&(f=f._),l=s.U_(h),f instanceof Cf?p.push(h):null!=(l=$f(f,l))&&(p.push(h),d.set(h,l)));return i=new Mi(p),new Ef(d.Gt(),i,s.fieldTransforms)}function Jf(t,e,n,r){return void 0===r&&(r=!1),$f(n,t.G_(r?4:3,e))}function $f(s,t){if(s instanceof Vr&&(s=s._),tl(s))return el("Unsupported field value:",t,s),Zf(s,t);if(s instanceof of)return function(t,e){if(!Nf(e.k_))throw e.K_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.K_(t._methodName+"() is not currently supported inside arrays");(t=t.z_(e))&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.Te.push(t.path),s instanceof Array){if(t.settings.B_&&4!==t.k_)throw t.K_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=$f(i[r],t.Q_(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof Vr&&(t=t._),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return ms(e.fe,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=bi.fromDate(t);return{timestampValue:Wu(e.fe,n)}}if(t instanceof bi)return n=new bi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Wu(e.fe,n)};if(t instanceof wf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Ur)return{bytesValue:Yu(e.fe,t.l)};if(t instanceof sf){n=e.O;var r=t.firestore.zr;if(!r.isEqual(n))throw e.K_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Ku(t.firestore.zr||e.O,t.S_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.K_("Unsupported field value: "+Wa(t))}(s,t)}function Zf(t,n){var r={};return xi(t)?n.path&&0<n.path.length&&n.Te.push(n.path):Vi(t,function(t,e){null!=(e=$f(e,n.L_(t)))&&(r[t]=e)}),{mapValue:{fields:r}}}function tl(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof bi||t instanceof wf||t instanceof Ur||t instanceof sf||t instanceof of)}function el(t,e,n){if(!tl(n)||"object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))throw"an object"===(n=Wa(n))?e.K_(t+" a custom object"):e.K_(t+" "+n);var r}function nl(t,e,n){if(e instanceof Vr&&(e=e._),e instanceof rf)return e.b_;if("string"==typeof e)return il(t,e);throw ol("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var rl=new RegExp("[~\\*/\\[\\]]");function il(e,n,r){if(0<=n.search(rl))throw ol("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(rf.bind.apply(rf,l([void 0],n.split("."))))).b_}catch(t){throw ol("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function ol(t,e,n,r,i){var o=r&&!r.bt(),s=void 0!==i,e="Function "+e+"() called with invalid data";return n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Cr(Pr.INVALID_ARGUMENT,(e+=". ")+t+n)}function sl(t,e){return t.some(function(t){return t.isEqual(e)})}var ul=(ll.prototype.ef=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.nf(),0<this.mutations.length)throw new Cr(Pr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var r,e,n,i,o;return v(this,function(t){switch(t.label){case 0:return e=ta((r=s).fe)+"/documents",n={documents:u.map(function(t){return Ju(r.fe,t)})},[4,r._t("BatchGetDocuments",e,n)];case 1:return n=t.sent(),i=new Map,n.forEach(function(t){var e,n,t=(n=r.fe,"found"in t?function(t,e){Ar(!!e.found),e.found.name,e.found.updateTime;var n=$u(t,e.found.name),t=Qu(e.found.updateTime),e=new io({mapValue:{fields:e.found.fields}});return new fo(n,t,e,{})}(n,t):"missing"in t?(e=n,Ar(!!(n=t).missing),Ar(!!n.readTime),e=$u(e,n.missing),n=Qu(n.readTime),new lo(e,n)):Tr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){Ar(!!(t=i.get(t.toString()))),o.push(t)}),o)]}})})}(this.Qh,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof lo||t instanceof fo?n.sf(t):Tr()}),e)]}})})},ll.prototype.set=function(t,e){this.write(e.F_(t,this.Ee(t))),this.tf.add(t.toString())},ll.prototype.update=function(t,e){try{this.write(e.F_(t,this.rf(t)))}catch(t){this.Z_=t}this.tf.add(t.toString())},ll.prototype.delete=function(t){this.write(new ru(t,this.Ee(t))),this.tf.add(t.toString())},ll.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.nf(),this.Z_)throw this.Z_;return e=this.Y_,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=Ai.$t(e),n.mutations.push(new iu(e,n.Ee(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=ta((e=i).fe)+"/documents",r={writes:o.map(function(t){return ra(e.fe,t)})},[4,e.at("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Qh,this.mutations)];case 1:return t.sent(),this.X_=!0,[2]}})})},ll.prototype.sf=function(t){var e;if(t instanceof fo)e=t.version;else{if(!(t instanceof lo))throw Tr();e=_i.min()}var n=this.Y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Cr(Pr.ABORTED,"Document version changed between two reads.")}else this.Y_.set(t.key.toString(),e)},ll.prototype.Ee=function(t){var e=this.Y_.get(t.toString());return!this.tf.has(t.toString())&&e?Ms.updateTime(e):Ms.de()},ll.prototype.rf=function(t){var e=this.Y_.get(t.toString());if(this.tf.has(t.toString())||!e)return Ms.exists(!0);if(e.isEqual(_i.min()))throw new Cr(Pr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ms.updateTime(e)},ll.prototype.write=function(t){this.nf(),this.mutations.push(t)},ll.prototype.nf=function(){},ll),al=(fl.prototype.run=function(){this.af()},fl.prototype.af=function(){var t=this;this.ui.ti(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new ul(this.Qh),(n=this.uf(e))&&n.then(function(t){r.ks.Ws(function(){return e.commit().then(function(){r.Bs.resolve(t)}).catch(function(t){r.hf(t)})})}).catch(function(t){r.hf(t)}),[2]})})})},fl.prototype.uf=function(t){try{var e=this.updateFunction(t);return!ai(e)&&e.catch&&e.then?e:(this.Bs.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Bs.reject(t),null}},fl.prototype.hf=function(t){var e=this;0<this.cf&&this.lf(t)?(--this.cf,this.ks.Ws(function(){return e.af(),Promise.resolve()})):this.Bs.reject(t)},fl.prototype.lf=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!li(t))},fl),cl=(hl.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.S.promise];case 1:return[2,(t.sent(),{ks:this.ks,rt:this.rt,clientId:this.clientId,credentials:this.credentials,h_:this.user,Bl:100})]}})})},hl.prototype.ff=function(t){var e=this;this._f=t,this.S.promise.then(function(){return e._f(e.user)})},hl.prototype.df=function(){if(this.ks.wf)throw new Cr(Pr.FAILED_PRECONDITION,"The client has already been terminated.")},hl.prototype.terminate=function(){var t=this;this.ks.Ef();var n=new mi;return this.ks.Tf(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.If?[4,this.If.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.mf?[4,this.mf.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.p(),n.resolve(),[3,6];case 5:return e=va(t.sent(),"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},hl);function hl(t,e,n){var r=this;this.credentials=t,this.ks=e,this.rt=n,this.user=Gr.UNAUTHENTICATED,this.clientId=Nr.t(),this._f=function(){},this.S=new mi,this.credentials.V(function(t){br("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r._f(t)),r.S.resolve()})}function fl(t,e,n,r){this.ks=t,this.Qh=e,this.updateFunction=n,this.Bs=r,this.cf=5,this.ui=new ba(this.ks,"transaction_retry")}function ll(t){this.Qh=t,this.Y_=new Map,this.mutations=[],this.X_=!1,this.Z_=null,this.tf=new Set}function pl(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.mf?[3,2]:(br("FirestoreClient","Using default OfflineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return r.ks.Af(),br("FirestoreClient","Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return e=t.sent(),[4,i.initialize(e)];case 2:return t.sent(),r.ff(function(e){return r.ks.ea(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,vc(i.Uh,e)];case 1:return t.sent(),[2]}})})})}),i.persistence.Xc(function(){return r.terminate()}),r.mf=i,[2]}})})}(e,new Kh)]);case 1:t.sent(),t.label=2;case 2:return[2,e.mf]}})})}function dl(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.If?[3,2]:(br("FirestoreClient","Using default OnlineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.ks.Af(),[4,pl(r)];case 1:return e=t.sent(),br("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.ff(function(t){return r.ks.ea(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).ks.Af(),br("RemoteStore","RemoteStore received new credentials"),n=sh(e),e.Gh.add(3),[4,Zc(e)];case 1:return t.sent(),n&&e.Jh.set("Unknown"),[4,e.Kh.E_(i)];case 2:return t.sent(),e.Gh.delete(3),[4,$c(e)];case 3:return t.sent(),[2]}})})}(i.Ml,t)})}),r.If=i,[2]}})})}(e,new Xh)]);case 1:t.sent(),t.label=2;case 2:return[2,e.If]}})})}function yl(t){return pl(t).then(function(t){return t.persistence})}function vl(t){return pl(t).then(function(t){return t.Uh})}function gl(t){return dl(t).then(function(t){return t.Ml})}function ml(t){return dl(t).then(function(t){return t.$u})}function wl(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,dl(r)];case 1:return e=t.sent(),[2,((n=e.$l).ol=function(u,a){return y(this,void 0,void 0,function(){var n,r,i,o,s;return v(this,function(t){switch(t.label){case 0:return(e=u).Ml.Kh.Zh=Mh.bind(null,e),e.Ml.Kh.Xn=function(t,e){var n=t;if((t=n.jl.get(e))&&t.kl)return Eu().add(t.key);var r=Eu();if(!(e=n.Ql.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Ul.get(s),r=r.je(s.view.pl);return r}.bind(null,e),e.Ml.Kh.Xh=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Ll.fh(s,"rejected",u),i=e.jl.get(s),(n=i&&i.key)?(r=(r=new ou(Ai.At)).Ie(n,new lo(n,_i.min())),i=Eu().add(n),i=new Ou(_i.min(),new Map,new du(Sr),r,i),[4,Mh(e,i)]):[3,2];case 1:return t.sent(),e.Wl=e.Wl.remove(n),e.jl.delete(s),Wh(e),[3,4];case 2:return[4,bc(e.Uh,s,!1).then(function(){return Gh(e,s,u)}).catch(Da)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.ql.yi=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query;if(u=n.queries.get(u)){for(var a=0,c=u.listeners;a<c.length;a++)c[a].al(s)&&(r=!0);u.il=s}}r&&wh(n)}.bind(null,e.$l),e.ql.t_=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,e.$l),(s=(n=e).Ul.get(a))?(r=s.targetId,n.Ll.ah(r),i=s.view.Ol(),[3,4]):[3,1];case 1:return[4,wc(n.Uh,us(a))];case 2:return o=t.sent(),s=n.Ll.ah(o.targetId),r=o.targetId,[4,function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Zl=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.bl(o)).$a?[4,_c(r.Uh,i.query,!1).then(function(t){return t=t.documents,i.view.bl(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.rn.get(i.targetId),n=i.view.yr(e,r.Xl,n),[2,(Hh(r,i.targetId,n.xl),n.snapshot)]}})})}(i,t,e,n)},[4,_c(i.Uh,o,!0)];case 1:return n=t.sent(),r=new kh(o,n.za),e=r.bl(n.documents),n=Su.hn(s,u&&"Offline"!==i.onlineState),n=r.yr(e,i.Xl,n),Hh(i,s,n.xl),r=new Dh(o,s,r),[2,(i.Ul.set(o,r),i.Ql.has(s)?i.Ql.get(s).push(o):i.Ql.set(s,[o]),n.snapshot)]}})})}(n,a,r,"current"===s)];case 3:i=t.sent(),n.Xl&&th(n.Ml,o),t.label=4;case 4:return[2,i]}var e})})}.bind(null,e.$u),n.ul=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Ul.get(o),1<(r=e.Ql.get(n.targetId)).length?[2,(e.Ql.set(n.targetId,r.filter(function(t){return!cs(t,o)})),void e.Ul.delete(o))]:e.Xl?(e.Ll.hh(n.targetId),e.Ll.nh(n.targetId)?[3,2]:[4,bc(e.Uh,n.targetId,!1).then(function(){e.Ll._h(n.targetId),eh(e.Ml,n.targetId),Gh(e,n.targetId)}).catch(Da)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Gh(e,n.targetId),[4,bc(e.Uh,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.$u),n)]}})})}function bl(n,r,i){var t=this;void 0===i&&(i={});var o=new mi;return n.ks.Ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(n,r,i,o,s){var t=new ef({next:function(t){r.Ws(function(){return mh(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Cr(Pr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Cr(Pr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new bh(ts(i.path),t,{includeMetadataChanges:!0,El:!0});return gh(n,u)},[4,wl(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.ks,r,i,o])]}})})}),o.promise}function _l(n,r,i){var t=this;void 0===i&&(i={});var o=new mi;return n.ks.Ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new ef({next:function(t){n.Ws(function(){return mh(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Cr(Pr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new bh(t,o,{includeMetadataChanges:!0,El:!0});return gh(e,s)},[4,wl(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.ks,r,i,o])]}})})}),o.promise}var El,Il=(Object.defineProperty(Nl.prototype,"wf",{get:function(){return this.yf},enumerable:!1,configurable:!0}),Nl.prototype.Ws=function(t){this.enqueue(t)},Nl.prototype.Tf=function(t){this.Sf(),this.Df(t)},Nl.prototype.Ef=function(){var t;this.yf||(this.yf=!0,(t=Qc())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.vf))},Nl.prototype.enqueue=function(t){return this.Sf(),this.yf?new Promise(function(t){}):this.Df(t)},Nl.prototype.ea=function(t){var e=this;this.Ws(function(){return e.Pf.push(t),e.Cf()})},Nl.prototype.Cf=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Pf.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Pf[0]()];case 2:return t.sent(),this.Pf.shift(),this.ui.reset(),[3,4];case 3:if(!pa(e=t.sent()))throw e;return br("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Pf.length&&this.ui.ti(function(){return n.Cf()}),t.label=5;case 5:return[2]}})})},Nl.prototype.Df=function(t){var r=this,e=this.Rf.then(function(){return r.pf=!0,t().catch(function(t){throw r.Vf=t,r.pf=!1,_r("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.pf=!1,t})});return this.Rf=e},Nl.prototype.ni=function(t,e,n){var r=this;return this.Sf(),-1<this.bf.indexOf(t)&&(e=0),n=da.qs(this,t,e,n,function(t){return r.xf(t)}),this.gf.push(n),n},Nl.prototype.Sf=function(){this.Vf&&Tr()},Nl.prototype.Af=function(){},Nl.prototype.Nf=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Rf];case 1:t.sent(),t.label=2;case 2:if(e!==this.Rf)return[3,0];t.label=3;case 3:return[2]}})})},Nl.prototype.Ff=function(t){for(var e=0,n=this.gf;e<n.length;e++)if(n[e].Ms===t)return!0;return!1},Nl.prototype.Of=function(r){var i=this;return this.Nf().then(function(){i.gf.sort(function(t,e){return t.$s-e.$s});for(var t=0,e=i.gf;t<e.length;t++){var n=e[t];if(n.Ks(),"all"!==r&&n.Ms===r)break}return i.Nf()})},Nl.prototype.kf=function(t){this.bf.push(t)},Nl.prototype.xf=function(t){t=this.gf.indexOf(t),this.gf.splice(t,1)},Nl),Tl=(f(Al,El=$a),Al.prototype.io=function(){return this.$f||Sl(this),this.$f.terminate()},Al);function Al(t,e){var n=this;return(n=El.call(this,t,e)||this).Mf=new Il,n.Wr="name"in t?t.name:"[DEFAULT]",n}function Nl(){var e=this;this.Rf=Promise.resolve(),this.Pf=[],this.yf=!1,this.gf=[],this.Vf=null,this.pf=!1,this.bf=[],this.ui=new ba(this,"async_queue_retry"),this.vf=function(){var t=Qc();t&&br("AsyncQueue","Visibility state changed to "+t.visibilityState),e.ui.si()};var t=Qc();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.vf)}function Ol(t){return t.$f||Sl(t),t.$f.df(),t.$f}function Sl(t){var e,n,r=t.so(),r=(e=t.zr,n=t.Wr,new Jr(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.$f=new cl(t.Hr,t.Mf,r)}var Rl,o=(Cl.prototype.Lf=function(t,e){switch(void 0===e&&(e="none"),Wi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Bi(t.integerValue||t.doubleValue);case 3:return this.Bf(t.timestampValue);case 4:return this.qf(t,e);case 5:return t.stringValue;case 6:return this.Uf(Gi(t.bytesValue));case 7:return this.Qf(t.referenceValue);case 8:return this.Kf(t.geoPointValue);case 9:return this.Wf(t.arrayValue,e);case 10:return this.jf(t.mapValue,e);default:throw Tr()}},Cl.prototype.jf=function(t,n){var r=this,i={};return Vi(t.fields||{},function(t,e){i[t]=r.Lf(e,n)}),i},Cl.prototype.Kf=function(t){return new wf(Bi(t.latitude),Bi(t.longitude))},Cl.prototype.Wf=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.Lf(t,e)})},Cl.prototype.qf=function(t,e){switch(e){case"previous":var n=function t(e){return zi(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==n?null:this.Lf(n,e);case"estimate":return this.Bf(Hi(t));default:return null}},Cl.prototype.Bf=function(t){return t=Fi(t),new bi(t.seconds,t.nanos)},Cl.prototype.Gf=function(t,e){var n=Ei.xt(t);return Ar(ca(n)),t=new $r(n.get(1),n.get(3)),n=new Ai(n.Pt(5)),t.isEqual(e)||_r("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},Cl),Ll=(Object.defineProperty(Pl.prototype,"id",{get:function(){return this.S_.path.Vt()},enumerable:!1,configurable:!0}),Object.defineProperty(Pl.prototype,"ref",{get:function(){return new sf(this.zf,this.v_,this.S_)},enumerable:!1,configurable:!0}),Pl.prototype.exists=function(){return null!==this.Jf},Pl.prototype.data=function(){if(this.Jf){if(this.v_){var t=new kl(this.zf,this.Hf,this.S_,this.Jf,null);return this.v_.fromFirestore(t)}return this.Hf.Lf(this.Jf.Yt())}},Pl.prototype.get=function(t){if(this.Jf&&null!==(t=this.Jf.data().field(Ul("DocumentSnapshot.get",t))))return this.Hf.Lf(t)},Pl),kl=(f(Dl,Rl=Ll),Dl.prototype.data=function(){return Rl.prototype.data.call(this)},Dl);function Dl(){return null!==Rl&&Rl.apply(this,arguments)||this}function Pl(t,e,n,r,i){this.zf=t,this.Hf=e,this.S_=n,this.Jf=r,this.v_=i}function Cl(){}function Ul(t,e){return"string"==typeof e?il(t,e):(e instanceof Vr?e._:e).b_}function Vl(t){if(ns(t)&&0===t.ne.length)throw new Cr(Pr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}function xl(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++)t=i[r].Yf(t);return t}var Ml,jl,ql,Fl,Bl,Gl=(f($l,Bl=me=function(){}),$l.prototype.Yf=function(t){var e=kf(t.firestore),e=function(t,e,n,r,i,o){if(r.Ot()){if("array-contains"===i||"array-contains-any"===i)throw new Cr(Pr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){ep(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(tp(n,t,c))}h={arrayValue:{values:s}}}else h=tp(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||ep(o,i),h=Jf(e,"where",o,"in"===i||"not-in"===i);var h=To.create(r,i,h);return function(t,e){if(e.ee()){var n=is(t);if(null!==n&&!n.isEqual(e.field))throw new Cr(Pr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=rs(t))&&np(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new Cr(Pr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Cr(Pr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(t.C_,e,t.firestore.zr,this.Xf,this.Zf,this.td);return new uf(t.firestore,t.v_,(e=(t=t.C_).filters.concat([e]),new Zo(t.path,t.collectionGroup,t.ne.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},$l),zl=(f(Jl,Fl=me),Jl.prototype.Yf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Cr(Pr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Cr(Pr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Xo(e,n);return e=r,null!==rs(n=t)||null!==(t=is(n))&&np(0,t,e.field),r}(t.C_,this.Xf,this.ed);return new uf(t.firestore,t.v_,(e=(t=t.C_).ne.concat([e]),new Zo(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},Jl),Hl=(f(Xl,ql=me),Xl.prototype.Yf=function(t){return new uf(t.firestore,t.v_,as(t.C_,this.nd,this.sd))},Xl),Wl=(f(Kl,jl=me),Kl.prototype.Yf=function(t){var e=Zl(t,this.type,this.rd,this.od);return new uf(t.firestore,t.v_,(t=t.C_,new Zo(t.path,t.collectionGroup,t.ne.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},Kl),Yl=(f(Ql,Ml=me),Ql.prototype.Yf=function(t){var e=Zl(t,this.type,this.rd,this.od);return new uf(t.firestore,t.v_,(t=t.C_,new Zo(t.path,t.collectionGroup,t.ne.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},Ql);function Ql(t,e,n){var r=this;return(r=Ml.call(this)||this).type=t,r.rd=e,r.od=n,r}function Kl(t,e,n){var r=this;return(r=jl.call(this)||this).type=t,r.rd=e,r.od=n,r}function Xl(t,e,n){var r=this;return(r=ql.call(this)||this).type=t,r.nd=e,r.sd=n,r}function Jl(t,e){var n=this;return(n=Fl.call(this)||this).Xf=t,n.ed=e,n.type="orderBy",n}function $l(t,e,n){var r=this;return(r=Bl.call(this)||this).Xf=t,r.Zf=e,r.td=n,r.type="where",r}function Zl(t,c,e,n){if(e[0]instanceof Vr&&(e[0]=e[0]._),e[0]instanceof Ll)return function(t,e,n,r){if(!n)throw new Cr(Pr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=ss(t);o<s.length;o++){var u=s[o];if(u.field.Ot())i.push($i(e,n.key));else{var a=n.field(u.field);if(zi(a))throw new Cr(Pr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a)throw u=u.field.Ct(),new Cr(Pr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.");i.push(a)}}return new zo(i,r)}(t.C_,t.firestore.zr,e[0].Jf,n);var r=kf(t.firestore);return function(t,e,n,r,i,o){var s=t.ne;if(i.length>s.length)throw new Cr(Pr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.Ot()){if("string"!=typeof c)throw new Cr(Pr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!os(t)&&-1!==c.indexOf("/"))throw new Cr(Pr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(Ei.xt(c));if(!Ai.qt(h))throw new Cr(Pr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new Ai(h),u.push($i(e,h))}else c=Jf(n,r,c),u.push(c)}return new zo(u,o)}(t.C_,t.firestore.zr,r,c,e,n)}function tp(t,e,n){if(n instanceof Vr&&(n=n._),"string"==typeof n){if(""===n)throw new Cr(Pr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!os(e)&&-1!==n.indexOf("/"))throw new Cr(Pr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child(Ei.xt(n)),!Ai.qt(e))throw new Cr(Pr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return $i(t,new Ai(e))}if(n instanceof sf)return $i(t,n.S_);throw new Cr(Pr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Wa(n)+".")}function ep(t,e){if(!Array.isArray(t)||0===t.length)throw new Cr(Pr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Cr(Pr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function np(t,e,n){if(!n.isEqual(e))throw new Cr(Pr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function rp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var ip,op=(f(sp,ip=o),sp.prototype.Uf=function(t){return new Ur(t)},sp.prototype.Qf=function(t){return t=this.Gf(t,this.firestore.zr),new sf(this.firestore,null,t)},sp);function sp(t){var e=this;return(e=ip.call(this)||this).firestore=t,e}function up(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var ap,cp,hp=(gp.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},gp),fp=(f(vp,cp=Ll),vp.prototype.exists=function(){return cp.prototype.exists.call(this)},vp.prototype.data=function(t){if(void 0===t&&(t={}),this.Jf){if(this.v_){var e=new lp(this.zf,this.Hf,this.S_,this.Jf,this.metadata,null);return this.v_.fromFirestore(e,t)}return this.Hf.Lf(this.Jf.Yt(),t.serverTimestamps)}},vp.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Jf&&null!==(t=this.Jf.data().field(Ul("DocumentSnapshot.get",t))))return this.Hf.Lf(t,e.serverTimestamps)},vp),lp=(f(yp,ap=fp),yp.prototype.data=function(t){return void 0===t&&(t={}),ap.prototype.data.call(this,t)},yp),pp=(Object.defineProperty(dp.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(dp.prototype,"size",{get:function(){return this.ud.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(dp.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),dp.prototype.forEach=function(e,n){var r=this;this.ud.docs.forEach(function(t){e.call(n,new lp(r.zf,r.Hf,t.key,t,new hp(r.ud.tn.has(t.key),r.ud.fromCache),r.query.v_))})},dp.prototype.docChanges=function(t){if(void 0===t&&(t={}),(t=!!t.includeMetadataChanges)&&this.ud.nn)throw new Cr(Pr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.hd&&this.ld===t||(this.hd=function(i,e){if(i.ud.Ze.bt()){var n=0;return i.ud.docChanges.map(function(t){var e=new lp(i.zf,i.Hf,t.doc.key,t.doc,new hp(i.ud.tn.has(t.doc.key),i.ud.fromCache),i.query.v_);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.ud.Ze;return i.ud.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new lp(i.zf,i.Hf,t.doc.key,t.doc,new hp(i.ud.tn.has(t.doc.key),i.ud.fromCache),i.query.v_),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Tr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.ld=t),this.hd},dp);function dp(t,e,n,r){this.zf=t,this.Hf=e,this.ud=r,this.metadata=new hp(r.hasPendingWrites,r.fromCache),this.query=n}function yp(){return null!==ap&&ap.apply(this,arguments)||this}function vp(t,e,n,r,i,o){var s=this;return(s=cp.call(this,t,e,n,r,o)||this).zf=t,s.ad=t,s.metadata=i,s}function gp(t,e){this.hasPendingWrites=t,this.fromCache=e}function mp(t,e){return t instanceof fp&&e instanceof fp?t.zf===e.zf&&t.S_.isEqual(e.S_)&&(null===t.Jf?null===e.Jf:t.Jf.isEqual(e.Jf))&&t.v_===e.v_:t instanceof pp&&e instanceof pp&&t.zf===e.zf&&mf(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.ud.isEqual(e.ud)}var wp,bp=(f(_p,wp=o),_p.prototype.Uf=function(t){return new Ur(t)},_p.prototype.Qf=function(t){return t=this.Gf(t,this.firestore.zr),new sf(this.firestore,null,t)},_p);function _p(t){var e=this;return(e=wp.call(this)||this).firestore=t,e}function Ep(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Ya(t,sf);var o=Ya(t.firestore,Tl),s=kf(o);return e instanceof Vr&&(e=e._),Tp(o,[("string"==typeof e||e instanceof rf?Xf(s,"updateDoc",t.S_,e,n,r):Kf(s,"updateDoc",t.S_,e)).F_(t.S_,Ms.exists(!0))])}function Ip(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];e instanceof Vr&&(e=e._);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||up(n[i])||(r=n[i],i++);var o,s,u,a,c,h,f={includeMetadataChanges:r.includeMetadataChanges};return up(n[i])&&(o=n[i],n[i]=null===(r=o.next)||void 0===r?void 0:r.bind(o),n[i+1]=null===(r=o.error)||void 0===r?void 0:r.bind(o),n[i+2]=null===(r=o.complete)||void 0===r?void 0:r.bind(o)),e instanceof sf?(u=Ya(e.firestore,Tl),a=ts(e.S_.path),h={next:function(t){n[i]&&n[i](Ap(u,e,t))},error:n[i+1],complete:n[i+2]}):(s=Ya(e,uf),u=Ya(s.firestore,Tl),a=s.C_,c=new bp(u),h={next:function(t){n[i]&&n[i](new pp(u,c,s,t))},error:n[i+1],complete:n[i+2]},Vl(e.C_)),function(n,t,e){var r=this,i=new ef(h),o=new bh(t,i,e);return n.ks.Ws(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=gh,[4,wl(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})}),function(){i.I_(),n.ks.Ws(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=mh,[4,wl(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})})}}(Ol(u),a,f)}function Tp(t,e){return function(n,r){var t=this,i=new mi;return n.ks.Ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=xh,[4,ml(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(Ol(t),e)}function Ap(t,e,n){var r=n.docs.get(e.S_),i=new bp(t);return new fp(t,i,e.S_,r,new hp(n.hasPendingWrites,n.fromCache),e.v_)}var Np=(Op.prototype.set=function(t,e,n){return this.Ed(),e=rp((t=Sp(t,this.zf)).v_,e,n),n=Df(this.wd,"WriteBatch.set",t.S_,e,null!==t.v_,n),this.fd.push(n.F_(t.S_,Ms.de())),this},Op.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return this.Ed(),t=Sp(t,this.zf),e instanceof Vr&&(e=e._),e="string"==typeof e||e instanceof rf?Xf(this.wd,"WriteBatch.update",t.S_,e,n,r):Kf(this.wd,"WriteBatch.update",t.S_,e),this.fd.push(e.F_(t.S_,Ms.exists(!0))),this},Op.prototype.delete=function(t){return this.Ed(),t=Sp(t,this.zf),this.fd=this.fd.concat(new ru(t.S_,Ms.de())),this},Op.prototype.commit=function(){return this.Ed(),this.dd=!0,0<this.fd.length?this._d(this.fd):Promise.resolve()},Op.prototype.Ed=function(){if(this.dd)throw new Cr(Pr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Op);function Op(t,e){this.zf=t,this._d=e,this.fd=[],this.dd=!1,this.wd=kf(t)}function Sp(t,e){if(t instanceof Vr&&(t=t._),t.firestore!==e)throw new Cr(Pr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var Rp,Lp,kp,Dp=(Fp.prototype.get=function(t){var e=this,n=Sp(t,this.zf),r=new op(this.zf);return this.Td.ef([n.S_]).then(function(t){if(!t||1!==t.length)return Tr();if((t=t[0])instanceof lo)return new Ll(e.zf,r,n.S_,null,n.v_);if(t instanceof fo)return new Ll(e.zf,r,t.key,t,n.v_);throw Tr()})},Fp.prototype.set=function(t,e,n){return e=rp((t=Sp(t,this.zf)).v_,e,n),n=Df(this.wd,"Transaction.set",t.S_,e,null!==t.v_,n),this.Td.set(t.S_,n),this},Fp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return t=Sp(t,this.zf),e instanceof Vr&&(e=e._),e="string"==typeof e||e instanceof rf?Xf(this.wd,"Transaction.update",t.S_,e,n,r):Kf(this.wd,"Transaction.update",t.S_,e),this.Td.update(t.S_,e),this},Fp.prototype.delete=function(t){return t=Sp(t,this.zf),this.Td.delete(t.S_),this},f(qp,kp=Fp),qp.prototype.get=function(t){var e=this,n=Sp(t,this.zf),r=new bp(this.zf);return kp.prototype.get.call(this,t).then(function(t){return new fp(e.zf,r,n.S_,t.Jf,new hp(!1,!1),n.v_)})},qp),Pp="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Cp=(jp.prototype.enableIndexedDbPersistence=function(t,e){throw new Cr(Pr.FAILED_PRECONDITION,Pp)},jp.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new Cr(Pr.FAILED_PRECONDITION,Pp)},jp.prototype.clearIndexedDbPersistence=function(t){throw new Cr(Pr.FAILED_PRECONDITION,Pp)},jp),Up=(f(Mp,Lp=Vr),Object.defineProperty(Mp.prototype,"zr",{get:function(){return this._.zr},enumerable:!1,configurable:!0}),Mp.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._.no()),t)).merge,this._.eo(t)},Mp.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this._.no().host&&Er("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},Mp.prototype.enableNetwork=function(){return function(r){var t=this;return r.ks.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,yl(r)];case 1:return e=t.sent(),[4,gl(r)];case 2:return n=t.sent(),[2,(e.Zc(!0),(t=n).Gh.delete(0),$c(t))]}})})})}(Ol(Ya(this._,Tl)))},Mp.prototype.disableNetwork=function(){return function(r){var t=this;return r.ks.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,yl(r)];case 1:return e=t.sent(),[4,gl(r)];case 2:return n=t.sent(),[2,(e.Zc(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Gh.add(0),[4,Zc(e)];case 1:return t.sent(),e.Jh.set("Offline"),[2]}})})}(n))]}})})})}(Ol(Ya(this._,Tl)))},Mp.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Ga("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Id.enableMultiTabIndexedDbPersistence(this):this.Id.enableIndexedDbPersistence(this,n)},Mp.prototype.clearPersistence=function(){return this.Id.clearIndexedDbPersistence(this)},Mp.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this._._delete()},Mp.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new mi;return n.ks.Ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=qh,[4,ml(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(Ol(Ya(this._,Tl)))},Mp.prototype.onSnapshotsInSync=function(t){return function(n,t){var e=this,r=new ef(t);return n.ks.Ws(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.rl.add(e),e.next()},[4,wl(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),function(){r.I_(),n.ks.Ws(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.rl.delete(e)},[4,wl(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}}(Ol(Ya(this._,Tl)),up(t)?t:{next:t})},Object.defineProperty(Mp.prototype,"app",{get:function(){if(!this.md)throw new Cr(Pr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.md},enumerable:!1,configurable:!0}),Mp.prototype.collection=function(t){try{return new fd(this,yf(this._,t))}catch(t){throw Jp(t,"collection()","Firestore.collection()")}},Mp.prototype.doc=function(t){try{return new Yp(this,vf(this._,t))}catch(t){throw Jp(t,"doc()","Firestore.doc()")}},Mp.prototype.collectionGroup=function(t){try{return new ad(this,function(t,e){if(t=Ya(t,$a),Fa("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new Cr(Pr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new uf(t,null,new Zo(Ei.Nt(),e))}(this._,t))}catch(t){throw Jp(t,"collectionGroup()","Firestore.collectionGroup()")}},Mp.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new mi;return n.ks.Ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,dl(n).then(function(t){return t.Qh})];case 1:return e=t.sent(),new al(n.ks,e,r,i).run(),[2]}})})}),i.promise}(Ol(n=this._),function(t){return t=new Dp(n,t),e(new Hp(r,t))})},Mp.prototype.batch=function(){var e=this;return Ol(this._),new Wp(new Np(this._,function(t){return Tp(e._,t)}))},Mp.prototype.loadBundle=function(t){throw new Cr(Pr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},Mp.prototype.namedQuery=function(t){throw new Cr(Pr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},Mp),Vp=(f(xp,Rp=o),xp.prototype.Uf=function(t){return new Br(new Ur(t))},xp.prototype.Qf=function(t){return t=this.Gf(t,this.firestore.zr),Yp.Ad(t,this.firestore,null)},xp);function xp(t){var e=this;return(e=Rp.call(this)||this).firestore=t,e}function Mp(t,e,n){var r=this;return(r=Lp.call(this,e)||this).Id=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof $r||(r.md=t),r}function jp(){}function qp(t,e){var n=this;return(n=kp.call(this,t,e)||this).zf=t,n}function Fp(t,e){this.zf=t,this.Td=e,this.wd=kf(t)}var Bp,Gp,zp,Hp=(f(Xp,zp=Vr),Xp.prototype.get=function(t){var e=this,t=md(t);return this._.get(t).then(function(t){return new sd(e.zf,t)})},Xp.prototype.set=function(t,e,n){return t=md(t),n?(Ba("Transaction.set",n),this._.set(t,e,n)):this._.set(t,e),this},Xp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=md(t);return 2===arguments.length?this._.update(o,e):(t=this._).update.apply(t,l([o,e,n],r)),this},Xp.prototype.delete=function(t){return t=md(t),this._.delete(t),this},Xp),Wp=(f(Kp,Gp=Vr),Kp.prototype.set=function(t,e,n){return t=md(t),n?(Ba("WriteBatch.set",n),this._.set(t,e,n)):this._.set(t,e),this},Kp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=md(t);return 2===arguments.length?this._.update(o,e):(t=this._).update.apply(t,l([o,e,n],r)),this},Kp.prototype.delete=function(t){return t=md(t),this._.delete(t),this},Kp.prototype.commit=function(){return this._.commit()},Kp),Yp=(f(Qp,Bp=Vr),Qp.Rd=function(t,e,n){if(t.length%2!=0)throw new Cr(Pr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.Ct()+" has "+t.length);return new Qp(e,new sf(e._,n,new Ai(t)))},Qp.Ad=function(t,e,n){return new Qp(e,new sf(e._,n,t))},Object.defineProperty(Qp.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(Qp.prototype,"parent",{get:function(){return new fd(this.firestore,this._.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(Qp.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Qp.prototype.collection=function(t){try{return new fd(this.firestore,yf(this._,t))}catch(t){throw Jp(t,"collection()","DocumentReference.collection()")}},Qp.prototype.isEqual=function(t){return t instanceof Vr&&(t=t._),t instanceof sf&&gf(this._,t)},Qp.prototype.set=function(t,e){e=Ba("DocumentReference.set",e);try{return function(t,e,n){t=Ya(t,sf);var r=Ya(t.firestore,Tl),e=rp(t.v_,e,n);return Tp(r,[Df(kf(r),"setDoc",t.S_,e,null!==t.v_,n).F_(t.S_,Ms.de())])}(this._,t,e)}catch(t){throw Jp(t,"setDoc()","DocumentReference.set()")}},Qp.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Ep(this._,t):Ep.apply(void 0,l([this._,t,e],n))}catch(t){throw Jp(t,"updateDoc()","DocumentReference.update()")}},Qp.prototype.delete=function(){return Tp(Ya((t=this._).firestore,Tl),[new ru(t.S_,Ms.de())]);var t},Qp.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=$p(t),i=Zp(t,function(t){return new sd(e.firestore,new fp(e.firestore._,e.Hf,t.S_,t.Jf,t.metadata,e._.v_))});return Ip(this._,r,i)},Qp.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=Ya(e,sf);var n=Ya(e.firestore,Tl),t=Ol(n),r=new bp(n);return function(n,r){var t=this,i=new mi;return n.ks.Ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(o,s,u){return y(this,void 0,void 0,function(){var r,i;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=s,(n=o).persistence.runTransaction("read document","readonly",function(t){return n.Ka.Pa(t,e)}))];case 1:return(i=t.sent())instanceof fo?u.resolve(i):i instanceof lo?u.resolve(null):u.reject(new Cr(Pr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),i=va(r,"Failed to get document '"+s+" from cache"),u.reject(i),[3,3];case 3:return[2]}var e,n})})},[4,vl(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.S_).then(function(t){return new fp(n,r,e.S_,t,new hp(t instanceof fo&&t.Jt,!0),e.v_)})}:"server"===(null==t?void 0:t.source)?function(e){e=Ya(e,sf);var n=Ya(e.firestore,Tl);return bl(Ol(n),e.S_,{source:"server"}).then(function(t){return Ap(n,e,t)})}:function(e){e=Ya(e,sf);var n=Ya(e.firestore,Tl);return bl(Ol(n),e.S_).then(function(t){return Ap(n,e,t)})})(this._).then(function(t){return new sd(e.firestore,new fp(e.firestore._,e.Hf,t.S_,t.Jf,t.metadata,e._.v_))})},Qp.prototype.withConverter=function(t){return new Qp(this.firestore,this._.withConverter(t))},Qp);function Qp(t,e){var n=this;return(n=Bp.call(this,e)||this).firestore=t,n.Hf=new Vp(t),n}function Kp(){return null!==Gp&&Gp.apply(this,arguments)||this}function Xp(t,e){var n=this;return(n=zp.call(this,e)||this).zf=t,n}function Jp(t,e,n){return t.message=t.message.replace(e,n),t}function $p(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!up(r))return r}return{}}function Zp(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=up(t[0])?t[0]:up(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var td,ed,nd,rd,id,od,sd=(f(gd,od=Vr),Object.defineProperty(gd.prototype,"ref",{get:function(){return new Yp(this.zf,this._.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(gd.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(gd.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(gd.prototype,"exists",{get:function(){return this._.exists()},enumerable:!1,configurable:!0}),gd.prototype.data=function(t){return this._.data(t)},gd.prototype.get=function(t,e){return this._.get(t,e)},gd.prototype.isEqual=function(t){return mp(this._,t._)},gd),ud=(f(vd,id=sd),vd.prototype.data=function(t){return this._.data(t)},vd),ad=(f(yd,rd=Vr),yd.prototype.where=function(t,e,n){try{return new yd(this.firestore,xl(this._,(r=n,i=e,o=Ul("where",t),new Gl(o,i,r))))}catch(t){throw Jp(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},yd.prototype.orderBy=function(n,t){try{return new yd(this.firestore,xl(this._,function(t){void 0===t&&(t="asc");var e=t,t=Ul("orderBy",n);return new zl(t,e)}(t)))}catch(n){throw Jp(n,/(orderBy|where)\(\)/,"Query.$1()")}},yd.prototype.limit=function(t){try{return new yd(this.firestore,xl(this._,(Qa("limit",e=t),new Hl("limit",e,"F"))))}catch(t){throw Jp(t,"limit()","Query.limit()")}var e},yd.prototype.limitToLast=function(t){try{return new yd(this.firestore,xl(this._,(Qa("limitToLast",e=t),new Hl("limitToLast",e,"L"))))}catch(t){throw Jp(t,"limitToLast()","Query.limitToLast()")}var e},yd.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new yd(this.firestore,xl(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Wl("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw Jp(t,"startAt()","Query.startAt()")}},yd.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new yd(this.firestore,xl(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Wl("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw Jp(t,"startAfter()","Query.startAfter()")}},yd.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new yd(this.firestore,xl(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Yl("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw Jp(t,"endBefore()","Query.endBefore()")}},yd.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new yd(this.firestore,xl(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Yl("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw Jp(t,"endAt()","Query.endAt()")}},yd.prototype.isEqual=function(t){return mf(this._,t._)},yd.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=Ya(e,uf);var n=Ya(e.firestore,Tl),t=Ol(n),r=new bp(n);return function(n,r){var t=this,i=new mi;return n.ks.Ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,_c(i,o,!0)];case 1:return r=t.sent(),e=new kh(o,r.za),n=e.bl(r.documents),n=e.yr(n,!1),s.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),r=va(n,"Failed to execute query '"+o+" against cache"),s.reject(r),[3,3];case 3:return[2]}})})},[4,vl(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.C_).then(function(t){return new pp(n,r,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){e=Ya(e,uf);var n=Ya(e.firestore,Tl),t=Ol(n),r=new bp(n);return _l(t,e.C_,{source:"server"}).then(function(t){return new pp(n,r,e,t)})}:function(e){e=Ya(e,uf);var n=Ya(e.firestore,Tl),t=Ol(n),r=new bp(n);return Vl(e.C_),_l(t,e.C_).then(function(t){return new pp(n,r,e,t)})})(this._).then(function(t){return new hd(e.firestore,new pp(e.firestore._,e.Hf,e._,t.ud))})},yd.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=$p(t),i=Zp(t,function(t){return new hd(e.firestore,new pp(e.firestore._,e.Hf,e._,t.ud))});return Ip(this._,r,i)},yd.prototype.withConverter=function(t){return new yd(this.firestore,this._.withConverter(t))},yd),cd=(f(dd,nd=Vr),Object.defineProperty(dd.prototype,"type",{get:function(){return this._.type},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"doc",{get:function(){return new ud(this.zf,this._.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"oldIndex",{get:function(){return this._.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"newIndex",{get:function(){return this._.newIndex},enumerable:!1,configurable:!0}),dd),hd=(f(pd,ed=Vr),Object.defineProperty(pd.prototype,"query",{get:function(){return new ad(this.zf,this._.query)},enumerable:!1,configurable:!0}),Object.defineProperty(pd.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(pd.prototype,"size",{get:function(){return this._.size},enumerable:!1,configurable:!0}),Object.defineProperty(pd.prototype,"empty",{get:function(){return this._.empty},enumerable:!1,configurable:!0}),Object.defineProperty(pd.prototype,"docs",{get:function(){var e=this;return this._.docs.map(function(t){return new ud(e.zf,t)})},enumerable:!1,configurable:!0}),pd.prototype.docChanges=function(t){var e=this;return this._.docChanges(t).map(function(t){return new cd(e.zf,t)})},pd.prototype.forEach=function(e,n){var r=this;this._.forEach(function(t){e.call(n,new ud(r.zf,t))})},pd.prototype.isEqual=function(t){return mp(this._,t._)},pd),fd=(f(ld,td=ad),Object.defineProperty(ld.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(ld.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Object.defineProperty(ld.prototype,"parent",{get:function(){var t=this._.parent;return t?new Yp(this.firestore,t):null},enumerable:!1,configurable:!0}),ld.prototype.doc=function(t){try{return new Yp(this.firestore,void 0===t?vf(this._):vf(this._,t))}catch(t){throw Jp(t,"doc()","CollectionReference.doc()")}},ld.prototype.add=function(t){var e,n=this,r=this._,i=t;return t=Ya(r.firestore,Tl),e=vf(r),i=rp(r.v_,i),Tp(t,[Df(kf(r.firestore),"addDoc",e.S_,i,null!==r.v_,{}).F_(e.S_,Ms.exists(!1))]).then(function(){return e}).then(function(t){return new Yp(n.firestore,t)})},ld.prototype.isEqual=function(t){return gf(this._,t._)},ld.prototype.withConverter=function(t){return new ld(this.firestore,this._.withConverter(t))},ld);function ld(t,e){var n=this;return(n=td.call(this,t,e)||this).firestore=t,n._=e,n}function pd(t,e){var n=this;return(n=ed.call(this,e)||this).zf=t,n}function dd(t,e){var n=this;return(n=nd.call(this,e)||this).zf=t,n}function yd(t,e){var n=this;return(n=rd.call(this,e)||this).firestore=t,n.Hf=new Vp(t),n}function vd(){return null!==id&&id.apply(this,arguments)||this}function gd(t,e){var n=this;return(n=od.call(this,e)||this).zf=t,n}function md(t){return t instanceof Vr&&(t=t._),Ya(t,sf)}var wd,bd,me=(f(Td,bd=Vr),Td.documentId=function(){return new Td(Ti.kt().Ct())},Td.prototype.isEqual=function(t){return t instanceof Vr&&(t=t._),t instanceof rf&&this._.b_.isEqual(t.b_)},Td),o=(f(Id,wd=Vr),Id.serverTimestamp=function(){var t=new Ff("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new Id(t)},Id.delete=function(){var t=new Cf("deleteField");return t._methodName="FieldValue.delete",new Id(t)},Id.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Bf("arrayUnion",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayUnion",new Id(n)},Id.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Gf("arrayRemove",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayRemove",new Id(n)},Id.increment=function(t){return(t=new zf("increment",t))._methodName="FieldValue.increment",new Id(t)},Id.prototype.isEqual=function(t){return this._.isEqual(t._)},Id),_d=(Ed.prototype.onProgress=function(t,e,n){this.Pd={next:t,error:e,complete:n}},Ed.prototype.catch=function(t){return this.yd.promise.catch(t)},Ed.prototype.then=function(t,e){return this.yd.promise.then(t,e)},Ed.prototype.e_=function(t){this.n_(t),this.Pd.complete&&this.Pd.complete(),this.yd.resolve(t)},Ed.prototype.i_=function(t){this.gd.taskState="Error",this.Pd.next&&this.Pd.next(this.gd),this.Pd.error&&this.Pd.error(t),this.yd.reject(t)},Ed.prototype.n_=function(t){this.gd=t,this.Pd.next&&this.Pd.next(t)},Ed);function Ed(){this.Pd={},this.yd=new mi,this.gd={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}function Id(){return null!==wd&&wd.apply(this,arguments)||this}function Td(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return bd.call(this,new(rf.bind.apply(rf,l([void 0],t))))||this}Ad.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Ad.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Ad.prototype.setServiceProps=function(t){return this.serviceProps=t,this},ge=Ad;function Ad(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}o={Firestore:Up,GeoPoint:wf,Timestamp:bi,Blob:Br,Transaction:Hp,WriteBatch:Wp,DocumentReference:Yp,DocumentSnapshot:sd,Query:ad,QueryDocumentSnapshot:ud,QuerySnapshot:hd,CollectionReference:fd,FieldPath:me,FieldValue:o,setLogLevel:function(t){mr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(e=e.default).INTERNAL.registerComponent(new ge("firestore",function(t){var e=t.getProvider("app").getImmediate();return t=t.getProvider("auth-internal"),new Up(e,new Tl(e,t),new Cp)},"PUBLIC").setServiceProps(Object.assign({},o))),e.registerVersion("@firebase/firestore","2.1.0-202011823329"),Up.prototype.loadBundle=function(t){return e=this,s=t,t=new _d,function(n,t,r){var e,i=this,o=(e=s,t=ha(t),e=function(t){if(t instanceof Uint8Array)return Zh(t,void 0);if(t instanceof ArrayBuffer)return Zh(new Uint8Array(t),void 0);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof e?(new TextEncoder).encode(e):e),new nf(e,t));n.ks.Ws(function(){return y(i,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Qh,[4,ml(n)];case 1:return e.apply(void 0,[t.sent(),o,r]),[2]}})})})}(Ol(e._),e.zr,t),t;var e,s},Up.prototype.namedQuery=function(t){return function(n,r){var t=this;return n.ks.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){var n=t;return n.persistence.runTransaction("Get named query","readonly",function(t){return n.Wc.ho(t,e)})},[4,vl(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}(Ol((e=this)._),t).then(function(t){return t?new ad(e,new uf(e._,null,t.query)):null});var e}}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});