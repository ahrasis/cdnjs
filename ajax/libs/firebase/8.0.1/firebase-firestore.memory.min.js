!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Sf){"use strict";try{(function(){var u,t,e=(t=Sf)&&"object"==typeof t&&"default"in t?t:{default:t},r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(ge=u=u||{})[ge.DEBUG=0]="DEBUG",ge[ge.VERBOSE=1]="VERBOSE",ge[ge.INFO=2]="INFO",ge[ge.WARN=3]="WARN",ge[ge.ERROR=4]="ERROR",ge[ge.SILENT=5]="SILENT";var a={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},h=u.INFO,c=((me={})[u.DEBUG]="log",me[u.VERBOSE]="log",me[u.INFO]="info",me[u.WARN]="warn",me[u.ERROR]="error",me),l=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?a[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},f);function f(t){this.name=t,this._logLevel=h,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e,n){return(e=d.call(this,e)||this).code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=(t=this.errors[t])?(r=i,t.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},O=N||self;function S(){}function P(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function L(t){var e=P(t);return"array"==e||"object"==e&&"number"==typeof t.length}function R(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var k="closure_uid_"+(1e9*Math.random()>>>0),D=0;function _(t,e,n){return t.call.apply(t.bind,arguments)}function V(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function C(t,e,n){return(C=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?_:V).apply(null,arguments)}function x(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var U=Date.now;function M(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t}function q(){this.j=this.j,this.i=this.i}q.prototype.j=!1,q.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,k)&&this[k]||(this[k]=++D))},q.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var j=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},F=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function B(){return Array.prototype.concat.apply([],arguments)}function G(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function W(t){return/^[\s\xa0]*$/.test(t)}var H=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function z(t,e){return-1!=t.indexOf(e)}function X(t,e){return t<e?-1:e<t?1:0}var Q=O.navigator;function $(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Y(t){var e,n={};for(e in t)n[e]=t[e];return n}at=(Q=Q&&Q.userAgent)?Q:"";var K="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Z(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<K.length;i++)e=K[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function J(t){return J[" "](t),t}J[" "]=S;var tt,et=z(at,"Opera"),nt=z(at,"Trident")||z(at,"MSIE"),rt=z(at,"Edge"),it=rt||nt,ot=z(at,"Gecko")&&!(z(at.toLowerCase(),"webkit")&&!z(at,"Edge"))&&!(z(at,"Trident")||z(at,"MSIE"))&&!z(at,"Edge"),st=z(at.toLowerCase(),"webkit")&&!z(at,"Edge");function ut(){var t=O.document;return t?t.documentMode:void 0}var Q="",at=(at=at,ot?/rv:([^\);]+)(\)|;)/.exec(at):rt?/Edge\/([\d\.]+)/.exec(at):nt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(at):st?/WebKit\/(\S+)/.exec(at):et?/(?:Version)[ \/]?(\S+)/.exec(at):void 0);at&&(Q=at?at[1]:""),tt=nt&&null!=(at=ut())&&at>parseFloat(Q)?String(at):Q;var ht={};function ct(u){return t=u,e=function(){for(var t=0,e=H(String(tt)).split("."),n=H(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++)for(var o=e[i]||"",s=n[i]||"";o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],(0!=o[0].length||0!=s[0].length)&&(t=X(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||X(0==o[2].length,0==s[2].length)||X(o[2],s[2]),o=o[3],s=s[3],0==t););return 0<=t},n=ht,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var lt=O.document&&nt&&(ut()||parseInt(tt,10))||void 0,ft=!nt||9<=Number(lt),pt=nt&&!ct("9"),dt=function(){if(!O.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{O.addEventListener("test",S,e),O.removeEventListener("test",S,e)}catch(t){}return t}();function yt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function vt(t,e){if(yt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ot){t:{try{J(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:gt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}yt.prototype.b=function(){this.defaultPrevented=!0},M(vt,yt);var gt={2:"touch",3:"pen",4:"mouse"};vt.prototype.b=function(){vt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,pt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var mt="closure_listenable_"+(1e6*Math.random()|0),wt=0;function bt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++wt,this.Y=this.Z=!1}function Et(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function It(t){this.src=t,this.a={},this.b=0}function Tt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=j(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Et(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function At(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}It.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=At(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new bt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Nt="closure_lm_"+(1e6*Math.random()|0),Ot={};function St(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Ct(r),e&&e[mt]?e.wa(n,r,R(i)?!!i.capture:!!i,o):Pt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)St(t,e[o],n,r,i);return null}return n=Ct(n),t&&t[mt]?t.va(e,n,R(r)?!!r.capture:!!r,i):Pt(t,e,n,!1,r,i)}function Pt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=R(i)?!!i.capture:!!i;if(s&&!ft)return null;var u,a,h=_t(t);if(h||(t[Nt]=h=new It(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=Dt,r=a=ft?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)dt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Rt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Lt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[mt]?Tt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Rt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=_t(e))?(Tt(n,t),0==n.b&&(n.src=null,e[Nt]=null)):Et(t)))}function Rt(t){return t in Ot?Ot[t]:Ot[t]="on"+t}function kt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Lt(t),n.call(r,e)}function Dt(t,e){if(t.Y)return!0;if(ft)return kt(t,new vt(e,this));if(!e)t:{e=["window","event"];for(var n=O,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return kt(t,e=new vt(e,this))}function _t(t){return(t=t[Nt])instanceof It?t:null}var Vt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ct(e){return"function"==P(e)?e:(e[Vt]||(e[Vt]=function(t){return e.handleEvent(t)}),e[Vt])}function xt(){q.call(this),this.c=new It(this),(this.J=this).C=null}function Ut(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new yt(e,t):e instanceof yt?e.target=e.target||t:(s=e,Z(e=new yt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Mt(o,r,!0,e)&&s;if(s=Mt(o=e.a=t,r,!0,e)&&s,s=Mt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Mt(o=e.a=n[i],r,!1,e)&&s}function Mt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Tt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}M(xt,q),xt.prototype[mt]=!0,(at=xt.prototype).addEventListener=function(t,e,n,r){St(this,t,e,n,r)},at.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=R(i)?!!i.capture:!!i,r=Ct(r),e&&e[mt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=At(s=e.a[n],r,i,o))&&(Et(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&_t(e))&&(n=e.a[n.toString()],e=-1,n&&(e=At(n,r,i,o)),(r=-1<e?n[e]:null)&&Lt(r))}(this,t,e,n,r)},at.G=function(){if(xt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Et(n[r]);delete e.a[t],e.b--}}this.C=null},at.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},at.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var qt=O.JSON.stringify;function jt(){this.b=this.a=null}var Ft,Bt=(Gt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Gt(function(){return new Wt},function(t){t.reset()},100));function Gt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Wt(){this.next=this.b=this.a=null}function Ht(t,e){var n;Ft||(n=O.Promise.resolve(void 0),Ft=function(){n.then(Qt)}),zt||(Ft(),zt=!0),Xt.add(t,e)}jt.prototype.add=function(t,e){var n=Bt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Wt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var zt=!(Wt.prototype.reset=function(){this.next=this.b=this.a=null}),Xt=new jt;function Qt(){for(var t,e;n=e=void 0,n=null,(e=Xt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){O.setTimeout(function(){throw t},0)}(t)}var n=Bt;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}zt=!1}function $t(t,e){xt.call(this),this.b=t||1,this.a=e||O,this.f=C(this.Xa,this),this.g=U()}function Yt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Kt(t,e,n){if("function"==P(t))n&&(t=C(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=C(t.handleEvent,t)}return 2147483647<Number(e)?-1:O.setTimeout(t,e||0)}M($t,xt),(at=$t.prototype).aa=!1,at.M=null,at.Xa=function(){var t;this.aa&&(0<(t=U()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Ut(this,"tick"),this.aa&&(Yt(this),this.start())))},at.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=U())},at.G=function(){$t.X.G.call(this),Yt(this),delete this.a};var Zt,Jt,te=(T(Jt=ne,Q=Zt=q),Jt.prototype=null===Q?Object.create(Q):(ee.prototype=Q.prototype,new ee),ne.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=Kt(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ne.prototype.G=function(){Zt.prototype.G.call(this),this.a&&(O.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ne);function ee(){this.constructor=Jt}function ne(t,e,n){var r=Zt.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function re(t){q.call(this),this.b=t,this.a={}}M(re,q);var ie=[];function oe(t,e,n,r){Array.isArray(n)||(n&&(ie[0]=n.toString()),n=ie);for(var i=0;i<n.length;i++){var o=St(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function se(t){$(t.a,function(t,e){this.a.hasOwnProperty(e)&&Lt(t)},t),t.a={}}function ue(){this.a=!0}function ae(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return qt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}re.prototype.G=function(){re.X.G.call(this),se(this)},re.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ue.prototype.info=function(){};var he=null;function ce(){return he=he||new xt}function le(t){yt.call(this,"serverreachability",t)}function fe(){var t=ce();Ut(t,new le(t))}function pe(t){yt.call(this,"statevent",t)}function de(){var t=ce();Ut(t,new pe(t))}function ye(t){yt.call(this,"timingevent",t)}function ve(t,e){if("function"!=P(t))throw Error("Fn must not be null and must be a function");return O.setTimeout(function(){t()},e)}M(le,yt),M(pe,yt),M(ye,yt);var ge={NO_ERROR:0,Ya:1,fb:2,eb:3,ab:4,cb:5,gb:6,Da:7,TIMEOUT:8,jb:9},me={$a:"complete",nb:"success",Ea:"error",Da:"abort",lb:"ready",mb:"readystatechange",TIMEOUT:"timeout",hb:"incrementaldata",kb:"progress",bb:"downloadprogress",ob:"uploadprogress"};function we(){}function be(t){var e;return(e=t.a)||(e=t.a={}),e}function Ee(){}we.prototype.a=null;var Ie,N={OPEN:"a",Za:"b",Ea:"c",ib:"d"};function Te(){yt.call(this,"d")}function Ae(){yt.call(this,"c")}function Ne(){}function Oe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new re(this),this.P=Se,t=it?125:void 0,this.R=new $t(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}M(Te,yt),M(Ae,yt),M(Ne,we),Ie=new Ne;var Se=45e3,Pe={},Le={};function Re(t,e,n){t.H=1,t.i=Ke(He(e)),t.j=n,t.I=!0,ke(t,null)}function ke(t,e){t.u=U(),_e(t),t.l=He(t.i);var s,u,a,h,c,l,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),ln(n.b,"t",r),t.D=0,t.a=ir(t.g,t.g.C?e:null),0<t.O&&(t.F=new te(C(t.Ca,t,t.a),t.O)),oe(t.J,t.a,"readystatechange",t.Va),e=t.B?Y(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),fe(),s=t.c,u=t.m,a=t.l,h=t.f,c=t.S,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function De(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Le:(i=Number(u.substring(i,o)),isNaN(i)?Pe:(o+=1)+i>u.length?Le:(u=u.substr(o,i),r.D=o+i,u)));if(u==Le){4==e&&(t.h=4,de(),s=!1),ae(t.c,t.f,null,"[Incomplete Response]");break}if(u==Pe){t.h=4,de(),ae(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}ae(t.c,t.f,u,null),Me(t,u)}4==e&&0==n.length&&(t.h=1,de(),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Yn(e),e.F=!0,de())):(ae(t.c,t.f,n,"[Invalid Chunked Response]"),Ue(t),xe(t))}function _e(t){t.T=U()+t.P,Ve(t,t.P)}function Ve(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=ve(C(t.Ta,t),e)}function Ce(t){t.o&&(O.clearTimeout(t.o),t.o=null)}function xe(t){0==t.g.v||t.A||Jn(t.g,t)}function Ue(t){Ce(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Yt(t.R),se(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Me(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||mn(u.b,t)))if(u.I=t.N,!t.C&&mn(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var h=a;if(0==h[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;Zn(u),Fn(u)}$n(u),de()}}else u.oa=h[1],0<u.oa-u.P&&h[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=ve(C(u.Qa,u),6e3));if(gn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else er(u,11)}else if(!t.C&&u.a!=t||Zn(u),!W(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)h=e[a],u.P=h[0],h=h[1],2==u.v?"c"==h[0]?(u.J=h[1],u.ga=h[2],null!=(r=h[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=h[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=h[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(z(r,"spdy")||z(r,"quic")||z(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(wn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,Ye(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=U()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=rr(n,n.C?n.ga:null,n.fa),i.C?(bn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Ce(o),_e(o)),n.a=i):Qn(n),0<u.g.length&&Wn(u)):"stop"!=h[0]&&"close"!=h[0]||er(u,7):3==u.v&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?er(u,7):jn(u):"noop"!=h[0]&&u.f&&u.f.sa(h),u.o=0);fe()}catch(t){}}function qe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(L(t)||"string"==typeof t)F(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(L(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(L(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function je(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof je)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Fe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Be(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Be(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Be(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(at=Oe.prototype).setTimeout=function(t){this.P=t},at.Va=function(t){t=t.target;var e=this.F;e&&3==xn(t)?e.f():this.Ca(t)},at.Ca=function(t){try{if(t==this.a)t:{var e=xn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!it&&!this.a.$())){this.A||4!=e||7==n||fe(),Ce(this);var i=this.a.W();if(this.N=i,n=this.a.$(),this.b=200==i,r=this.c,u=this.m,a=this.l,h=this.f,c=this.S,l=e,f=i,r.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+c+"]: "+u+"\n"+a+"\n"+l+" "+f}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!W(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,de(),Ue(this),xe(this);break t}ae(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Me(this,s)}this.I?(De(this,e,n),it&&this.b&&3==e&&(oe(this.J,this.R,"tick",this.Ua),this.R.start())):(ae(this.c,this.f,n,null),Me(this,n)),4==e&&Ue(this),this.b&&!this.A&&(4==e?Jn(this.g,this):(this.b=!1,_e(this)))}else 400==i&&0<n.indexOf("Unknown SID")?this.h=3:this.h=0,de(),Ue(this),xe(this)}}}catch(t){}var u,a,h,c,l,f},at.Ua=function(){var t,e;this.a&&(t=xn(this.a),e=this.a.$(),this.D<e.length&&(Ce(this),De(this,t,e),this.b&&4!=t&&_e(this)))},at.cancel=function(){this.A=!0,Ue(this)},at.Ta=function(){this.o=null;var t,e,n=U();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(fe(),de()),Ue(this),this.h=2,xe(this)):Ve(this,this.T-n)},(at=je.prototype).K=function(){Fe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},at.L=function(){return Fe(this),this.a.concat()},at.get=function(t,e){return Be(this.b,t)?this.b[t]:e},at.set=function(t,e){Be(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},at.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ge=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function We(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof We?(this.a=void 0!==e?e:t.a,ze(this,t.f),this.j=t.j,Xe(this,t.c),Qe(this,t.h),this.g=t.g,e=t.b,(n=new un).c=e.c,e.a&&(n.a=new je(e.a),n.b=e.b),$e(this,n),this.i=t.i):t&&(n=String(t).match(Ge))?(this.a=!!e,ze(this,n[1]||"",!0),this.j=Ze(n[2]||""),Xe(this,n[3]||"",!0),Qe(this,n[4]),this.g=Ze(n[5]||"",!0),$e(this,n[6]||"",!0),this.i=Ze(n[7]||"")):(this.a=!!e,this.b=new un(null,this.a))}function He(t){return new We(t)}function ze(t,e,n){t.f=n?Ze(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Xe(t,e,n){t.c=n?Ze(e,!0):e}function Qe(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function $e(t,e,n){var r,i;e instanceof un?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(an(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(hn(this,e),ln(this,n,t))},r)),r.f=i):(n||(e=Je(e,on)),t.b=new un(e,t.a))}function Ye(t,e,n){t.b.set(e,n)}function Ke(t){return Ye(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^U()).toString(36)),t}function Ze(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Je(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,tn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function tn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}We.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Je(e,en,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(Je(e,en,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Je(n,"/"==n.charAt(0)?rn:nn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Je(n,sn)),t.join("")};var en=/[#\/\?@]/g,nn=/[#\?:]/g,rn=/[#\?]/g,on=/[#\?@]/g,sn=/#/g;function un(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function an(o){o.a||(o.a=new je,o.b=0,o.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],r=n,i=i?decodeURIComponent(i.replace(/\+/g," ")):"",o.add(decodeURIComponent(r.replace(/\+/g," ")),i)}}}(o.c))}function hn(t,e){an(t),e=fn(t,e),Be(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Be((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Fe(t)))}function cn(t,e){return an(t),e=fn(t,e),Be(t.a.b,e)}function ln(t,e,n){hn(t,e),0<n.length&&(t.c=null,t.a.set(fn(t,e),G(n)),t.b+=n.length)}function fn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function pn(t,e){this.b=t,this.a=e}function dn(t){this.g=t||yn,t=O.PerformanceNavigationTiming?0<(t=O.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(O.ia&&O.ia.ya&&O.ia.ya()&&O.ia.ya().pb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(at=un.prototype).add=function(t,e){an(this),this.c=null,t=fn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},at.forEach=function(n,r){an(this),this.a.forEach(function(t,e){F(t,function(t){n.call(r,t,e,this)},this)},this)},at.L=function(){an(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},at.K=function(t){an(this);var e=[];if("string"==typeof t)cn(this,t)&&(e=B(e,this.a.get(fn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=B(e,t[n])}return e},at.set=function(t,e){return an(this),this.c=null,cn(this,t=fn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},at.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},at.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var yn=10;function vn(t){return t.b||t.a&&t.a.size>=t.f}function gn(t){return t.b?1:t.a?t.a.size:0}function mn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function wn(t,e){t.a?t.a.add(e):t.b=e}function bn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function En(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return G(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function In(){}function Tn(){this.a=new In}function An(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}dn.prototype.cancel=function(){var t,e;if(this.c=En(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},In.prototype.stringify=function(t){return O.JSON.stringify(t,void 0)},In.prototype.parse=function(t){return O.JSON.parse(t,void 0)};var Nn=O.JSON.parse;function On(t){xt.call(this),this.headers=new je,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Sn,this.D=this.F=!1}M(On,xt);var Sn="",Pn=/^https?$/i,Ln=["POST","PUT"];function Rn(t){return"content-type"==t.toLowerCase()}function kn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Dn(t),Vn(t)}function Dn(t){t.u||(t.u=!0,Ut(t,"complete"),Ut(t,"error"))}function _n(t){if(t.b&&(!t.s[1]||4!=xn(t)||2!=t.W()))if(t.l&&4==xn(t))Kt(t.za,0,t);else if(Ut(t,"readystatechange"),4==xn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Ge)[1]||null)&&O.self&&O.self.location&&(i=(r=O.self.location.protocol).substr(0,r.length-1)),n=!Pn.test(i?i.toLowerCase():"")),e=n),e)Ut(t,"complete"),Ut(t,"success");else{t.h=6;try{var u=2<xn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.W()+"]",Dn(t)}}finally{Vn(t)}}}function Vn(t,e){if(t.a){Cn(t);var n=t.a,r=t.s[0]?S:null;t.a=null,t.s=null,e||Ut(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Cn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(O.clearTimeout(t.m),t.m=null)}function xn(t){return t.a?t.a.readyState:0}function Un(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",$(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Ye(t,e,n))}function Mn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function qn(t){this.pa=0,this.g=[],this.c=new ue,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Ma=this.R=0,this.Ja=Mn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Fa=Mn("baseRetryDelayMs",5e3,t),this.Pa=Mn("retryDelaySeedMs",1e4,t),this.Ka=Mn("forwardChannelMaxRetries",2,t),this.ma=Mn("forwardChannelRequestTimeoutMs",2e4,t),this.La=t&&t.h||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new dn(t&&t.concurrentRequestLimit),this.ka=new Tn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.g&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ia=t&&t.f||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function jn(t){var e,n;Bn(t),3==t.v&&(e=t.R++,Ye(n=He(t.B),"SID",t.J),Ye(n,"RID",e),Ye(n,"TYPE","terminate"),zn(t,n),(e=new Oe(t,t.c,e,void 0)).H=2,e.i=Ke(He(n)),n=!1,O.navigator&&O.navigator.sendBeacon&&(n=O.navigator.sendBeacon(e.i.toString(),"")),!n&&O.Image&&((new Image).src=e.i,n=!0),n||(e.a=ir(e.g,null),e.a.ba(e.i)),e.u=U(),_e(e)),nr(t)}function Fn(t){t.a&&(Yn(t),t.a.cancel(),t.a=null)}function Bn(t){Fn(t),t.j&&(O.clearTimeout(t.j),t.j=null),Zn(t),t.b.cancel(),t.h&&("number"==typeof t.h&&O.clearTimeout(t.h),t.h=null)}function Gn(t,e){t.g.push(new pn(t.Ma++,e)),3==t.v&&Wn(t)}function Wn(t){vn(t.b)||t.h||(t.h=!0,Ht(t.Ba,t),t.u=0)}function Hn(t,e){var n=e?e.f:t.R++,r=He(t.B);Ye(r,"SID",t.J),Ye(r,"RID",n),Ye(r,"AID",t.P),zn(t,r),t.i&&t.l&&Un(r,t.i,t.l),n=new Oe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Xn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),wn(t.b,n),Re(n,r,e)}function zn(t,n){t.f&&qe({},function(t,e){Ye(n,e,t)})}function Xn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?C(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+h+"_"||"";try{qe(t,function(t,e){var n=t;R(t)&&(n=qt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s)}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Qn(t){t.a||t.j||(t.T=1,Ht(t.Aa,t),t.o=0)}function $n(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=ve(C(t.Aa,t),tr(t,t.o)),t.o++,1)}function Yn(t){null!=t.s&&(O.clearTimeout(t.s),t.s=null)}function Kn(t){t.a=new Oe(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=He(t.la);Ye(e,"RID","rpc"),Ye(e,"SID",t.J),Ye(e,"CI",t.H?"0":"1"),Ye(e,"AID",t.P),zn(t,e),Ye(e,"TYPE","xmlhttp"),t.i&&t.l&&Un(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=Ke(He(e)),n.j=null,n.I=!0,ke(n,t)}function Zn(t){null!=t.m&&(O.clearTimeout(t.m),t.m=null)}function Jn(t,e){var n,r,i,o=null;if(t.a==e){Zn(t),Yn(t),t.a=null;var s=2}else{if(!mn(t.b,e))return;o=e.s,bn(t.b,e),s=1}if(t.I=e.N,0!=t.v)if(e.b)1==s?(o=e.j?e.j.length:0,e=U()-e.u,n=t.u,Ut(s=ce(),new ye(s)),Wn(t)):Qn(t);else if(3==(n=e.h)||0==n&&0<t.I||(1!=s||(i=e,gn((r=t).b)>=r.b.f-(r.h?1:0)||(r.h?(r.g=i.s.concat(r.g),0):1==r.v||2==r.v||r.u>=(r.Ja?0:r.Ka)||(r.h=ve(C(r.Ba,r,i),tr(r,r.u)),r.u++,0))))&&(2!=s||!$n(t)))switch(o&&0<o.length&&(e=t.b,e.c=e.c.concat(o)),n){case 1:er(t,5);break;case 4:er(t,10);break;case 3:er(t,6);break;default:er(t,2)}}function tr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Pa);return t.f||(n*=2),n*e}function er(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=C(t.Wa,t),r||(r=new We("//www.google.com/images/cleardot.gif"),O.location&&"http"==O.location.protocol||ze(r,"https"),Ke(r)),n=r.toString(),r=o,o=new ue,O.Image?((i=new Image).onload=x(An,o,i,"TestLoadImage: loaded",!0,r),i.onerror=x(An,o,i,"TestLoadImage: error",!1,r),i.onabort=x(An,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=x(An,o,i,"TestLoadImage: timeout",!1,r),O.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):de(),t.v=0,t.f&&t.f.ra(e),nr(t),Bn(t)}function nr(t){t.v=0,t.I=-1,t.f&&(0==En(t.b).length&&0==t.g.length||(t.b.c.length=0,G(t.g),t.g.length=0),t.f.qa())}function rr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof We?He(s):new We(s,void 0);return""!=a.c?(e&&Xe(a,e+"."+a.c),Qe(a,a.h)):(r=(u=O.location).protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new We(null,void 0),r&&ze(u,r),i&&Xe(u,i),o&&Qe(u,o),s&&(u.g=s),a=u),t.V&&$(t.V,function(t,e){Ye(a,e,t)}),e=t.A,n=t.na,e&&n&&Ye(a,e,n),Ye(a,"VER",t.ha),zn(t,a),a}function ir(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new On(t.La)).F=t.C,e}function or(){}function sr(){if(nt&&!(10<=Number(lt)))throw Error("Environmental error: no available transport.")}function ur(t,e){xt.call(this),this.a=new qn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!W(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!W(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new cr(this)}function ar(t){Te.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function hr(){Ae.call(this),this.status=1}function cr(t){this.a=t}(at=On.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?be(this.H):be(Ie),this.a.onreadystatechange=C(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void kn(this,t)}t=n||"";var i,o=new je(this.headers);r&&qe(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Rn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=O.FormData&&t instanceof O.FormData,0<=j(Ln,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Cn(this),0<this.o&&((this.D=(i=this.a,nt&&ct(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=C(this.xa,this)):this.m=Kt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){kn(this,t)}},at.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Ut(this,"timeout"),this.abort(8))},at.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Ut(this,"complete"),Ut(this,"abort"),Vn(this))},at.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Vn(this,!0)),On.X.G.call(this)},at.za=function(){this.j||(this.A||this.l||this.g?_n(this):this.Sa())},at.Sa=function(){_n(this)},at.W=function(){try{return 2<xn(this)?this.a.status:-1}catch(t){return-1}},at.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},at.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Nn(e)}},at.ua=function(){return this.h},at.Oa=function(){return"string"==typeof this.f?this.f:String(this.f)},(at=qn.prototype).ha=8,at.v=1,at.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Oe(this,this.c,t,void 0),r=this.l;if(this.O&&(r?Z(r=Y(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Xn(this,n,e),Ye(i=He(this.B),"RID",t),Ye(i,"CVER",22),this.A&&Ye(i,"X-HTTP-Session-Id",this.A),zn(this,i),this.i&&r&&Un(i,this.i,r),wn(this.b,n),this.Ga&&Ye(i,"TYPE","init"),this.da?(Ye(i,"$req",e),Ye(i,"SID","null"),n.U=!0,Re(n,i,null)):Re(n,i,e),this.v=2}}else 3==this.v&&(t?Hn(this,t):0==this.g.length||vn(this.b)||Hn(this))},at.Aa=function(){var t;this.j=null,Kn(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=ve(C(this.Ra,this),t))},at.Ra=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,de(),Fn(this),Kn(this))},at.Qa=function(){null!=this.m&&(this.m=null,Fn(this),$n(this),de())},at.Wa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),de()},(at=or.prototype).ta=function(){},at.sa=function(){},at.ra=function(){},at.qa=function(){},at.Ha=function(){},sr.prototype.a=function(t,e){return new ur(t,e)},M(ur,xt),ur.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;de(),t.fa=e,t.V=n||{},t.H=t.S,t.B=rr(t,null,t.fa),Wn(t)},ur.prototype.close=function(){jn(this.a)},ur.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Gn(this.a,e)):this.l?((e={}).__data__=qt(t),Gn(this.a,e)):Gn(this.a,t)},ur.prototype.G=function(){this.a.f=null,delete this.f,jn(this.a),delete this.a,ur.X.G.call(this)},M(ar,Te),M(hr,Ae),M(cr,or),cr.prototype.ta=function(){Ut(this.a,"a")},cr.prototype.sa=function(t){Ut(this.a,new ar(t))},cr.prototype.ra=function(t){Ut(this.a,new hr)},cr.prototype.qa=function(){Ut(this.a,"b")},sr.prototype.createWebChannel=sr.prototype.a,ur.prototype.send=ur.prototype.h,ur.prototype.open=ur.prototype.g,ge.NO_ERROR=0,ge.TIMEOUT=8,ge.HTTP_ERROR=6,me.COMPLETE="complete",(Ee.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",xt.prototype.listen=xt.prototype.va,On.prototype.listenOnce=On.prototype.wa,On.prototype.getLastError=On.prototype.Oa,On.prototype.getLastErrorCode=On.prototype.ua,On.prototype.getStatus=On.prototype.W,On.prototype.getResponseJson=On.prototype.Na,On.prototype.getResponseText=On.prototype.$,On.prototype.send=On.prototype.ba;var lr=ge,fr=me,pr=Ee,dr=On,me=(yr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},yr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},yr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},yr);function yr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var vr,gr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},mr=(n(br,vr=Error),br),wr=new l("@firebase/firestore");function br(t,e){var n=this;return(n=vr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Er(){return wr.logLevel}function Ir(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];wr.logLevel<=u.DEBUG&&(e=n.map(Nr),wr.debug.apply(wr,i(["Firestore (8.0.1): "+t],e)))}function Tr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];wr.logLevel<=u.ERROR&&(e=n.map(Nr),wr.error.apply(wr,i(["Firestore (8.0.1): "+t],e)))}function Ar(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];wr.logLevel<=u.WARN&&(e=n.map(Nr),wr.warn.apply(wr,i(["Firestore (8.0.1): "+t],e)))}function Nr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Or(t){throw void 0===t&&(t="Unexpected state"),Tr(t="FIRESTORE (8.0.1) INTERNAL ASSERTION FAILED: "+t),new Error(t)}function Sr(t){t||Or()}var Pr=(Lr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Lr);function Lr(){}function Rr(t,e){return t<e?-1:e<t?1:0}function kr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var Dr=(_r.fromBase64String=function(t){return new _r(atob(t))},_r.fromUint8Array=function(t){return new _r(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},_r.prototype.toBase64=function(){return t=this.i,btoa(t);var t},_r.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},_r.prototype.o=function(){return 2*this.i.length},_r.prototype.u=function(t){return Rr(this.i,t.i)},_r.prototype.isEqual=function(t){return this.i===t.i},_r);function _r(t){this.i=t}Dr.h=new Dr("");var Vr=(Cr.fromBase64String=function(t){try{return new Cr(Dr.fromBase64String(t))}catch(t){throw new mr(gr.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},Cr.fromUint8Array=function(t){return new Cr(Dr.fromUint8Array(t))},Cr.prototype.toBase64=function(){return this.l.toBase64()},Cr.prototype.toUint8Array=function(){return this.l.toUint8Array()},Cr.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Cr.prototype.isEqual=function(t){return this.l.isEqual(t.l)},Cr);function Cr(t){this.l=t}function xr(){if("undefined"==typeof Uint8Array)throw new mr(gr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Ur(){if("undefined"==typeof atob)throw new mr(gr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Mr,qr=(n(Gr,Mr=Vr),Gr.fromBase64String=function(t){Ur();try{return new Gr(Dr.fromBase64String(t))}catch(t){throw new mr(gr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Gr.fromUint8Array=function(t){return xr(),new Gr(Dr.fromUint8Array(t))},Gr.prototype.toBase64=function(){return Ur(),Mr.prototype.toBase64.call(this)},Gr.prototype.toUint8Array=function(){return xr(),Mr.prototype.toUint8Array.call(this)},Gr.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Gr),jr=function(t,e,n,r,i,o){this._=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.m=o},Fr=(Object.defineProperty(Br.prototype,"T",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Br.prototype.isEqual=function(t){return t instanceof Br&&t.projectId===this.projectId&&t.database===this.database},Br.prototype.u=function(t){return Rr(this.projectId,t.projectId)||Rr(this.database,t.database)},Br);function Br(t,e){this.projectId=t,this.database=e||"(default)"}function Gr(){return null!==Mr&&Mr.apply(this,arguments)||this}function Wr(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Hr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function zr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Xr,Qr,$r=(ai.prototype.get=function(t){var e=this.I(t);if(void 0!==(e=this.R[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.A(i,t))return o}},ai.prototype.has=function(t){return void 0!==this.get(t)},ai.prototype.set=function(t,e){var n=this.I(t),r=this.R[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.A(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.R[n]=[[t,e]]},ai.prototype.delete=function(t){var e=this.I(t),n=this.R[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.A(n[r][0],t))return 1===n.length?delete this.R[e]:n.splice(r,1),!0;return!1},ai.prototype.forEach=function(s){Hr(this.R,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];s(i,o)}})},ai.prototype.P=function(){return zr(this.R)},ai),Yr=(ui.now=function(){return ui.fromMillis(Date.now())},ui.fromDate=function(t){return ui.fromMillis(t.getTime())},ui.fromMillis=function(t){var e=Math.floor(t/1e3);return new ui(e,1e6*(t-1e3*e))},ui.prototype.toDate=function(){return new Date(this.toMillis())},ui.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},ui.prototype.V=function(t){return this.seconds===t.seconds?Rr(this.nanoseconds,t.nanoseconds):Rr(this.seconds,t.seconds)},ui.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},ui.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},ui.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},ui.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},ui),Kr=(si.g=function(t){return new si(t)},si.min=function(){return new si(new Yr(0,0))},si.prototype.u=function(t){return this.timestamp.V(t.timestamp)},si.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},si.prototype.p=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},si.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},si.prototype.v=function(){return this.timestamp},si),l=(Object.defineProperty(oi.prototype,"length",{get:function(){return this.C},enumerable:!1,configurable:!0}),oi.prototype.isEqual=function(t){return 0===oi.S(this,t)},oi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof oi?t.forEach(function(t){e.push(t)}):e.push(t),this.D(e)},oi.prototype.limit=function(){return this.offset+this.length},oi.prototype.F=function(t){return t=void 0===t?1:t,this.D(this.segments,this.offset+t,this.length-t)},oi.prototype.N=function(){return this.D(this.segments,this.offset,this.length-1)},oi.prototype.O=function(){return this.segments[this.offset]},oi.prototype.k=function(){return this.get(this.length-1)},oi.prototype.get=function(t){return this.segments[this.offset+t]},oi.prototype.P=function(){return 0===this.length},oi.prototype.$=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},oi.prototype.M=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},oi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},oi.prototype.L=function(){return this.segments.slice(this.offset,this.limit())},oi.S=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},oi),Zr=(n(ii,Qr=l),ii.prototype.D=function(t,e,n){return new ii(t,e,n)},ii.prototype.q=function(){return this.L().join("/")},ii.prototype.toString=function(){return this.q()},ii.U=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new mr(gr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new ii(n)},ii.B=function(){return new ii([])},ii),Jr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ti=(n(ri,Xr=l),ri.prototype.D=function(t,e,n){return new ri(t,e,n)},ri.j=function(t){return Jr.test(t)},ri.prototype.q=function(){return this.L().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),ri.j(t)||(t="`"+t+"`"),t}).join(".")},ri.prototype.toString=function(){return this.q()},ri.prototype.W=function(){return 1===this.length&&"__name__"===this.get(0)},ri.K=function(){return new ri(["__name__"])},ri.G=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new mr(gr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new mr(gr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new mr(gr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new mr(gr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ri(e)},ri.B=function(){return new ri([])},ri),ei=(ni.H=function(t){return new ni(Zr.U(t))},ni.Y=function(t){return new ni(Zr.U(t).F(5))},ni.prototype.J=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ni.prototype.isEqual=function(t){return null!==t&&0===Zr.S(this.path,t.path)},ni.prototype.toString=function(){return this.path.toString()},ni.S=function(t,e){return Zr.S(t.path,e.path)},ni.X=function(t){return t.length%2==0},ni.Z=function(t){return new ni(new Zr(t.slice()))},ni);function ni(t){this.path=t}function ri(){return null!==Xr&&Xr.apply(this,arguments)||this}function ii(){return null!==Qr&&Qr.apply(this,arguments)||this}function oi(t,e,n){void 0===e?e=0:e>t.length&&Or(),void 0===n?n=t.length-e:n>t.length-e&&Or(),this.segments=t,this.offset=e,this.C=n}function si(t){this.timestamp=t}function ui(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new mr(gr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new mr(gr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new mr(gr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new mr(gr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function ai(t,e){this.I=t,this.A=e,this.R={}}function hi(t){return null==t}function ci(t){return 0===t&&1/t==-1/0}var li=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.tt=null};function fi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new li(t,e,n,r,i,o,s)}function pi(t){var e=t;return null===e.tt&&(t=e.path.q(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return t.field.q()+t.op.toString()+fo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return t.field.q()+t.dir}).join(","),hi(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=Vu(e.startAt)),e.endAt&&(t+="|ub:",t+=Vu(e.endAt)),e.tt=t),e.tt}function di(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!ao(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!xu(t.startAt,e.startAt)&&xu(t.endAt,e.endAt)}function yi(t){return ei.X(t.path)&&null===t.collectionGroup&&0===t.filters.length}function vi(t){this.count=t}var gi,mi=(wi.prototype.st=function(t){return new wi(this.target,this.targetId,this.nt,t,this.et,this.lastLimboFreeSnapshotVersion,this.resumeToken)},wi.prototype.it=function(t,e){return new wi(this.target,this.targetId,this.nt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},wi.prototype.rt=function(t){return new wi(this.target,this.targetId,this.nt,this.sequenceNumber,this.et,t,this.resumeToken)},wi);function wi(t,e,n,r,i,o,s){void 0===i&&(i=Kr.min()),void 0===o&&(o=Kr.min()),void 0===s&&(s=Dr.h),this.target=t,this.targetId=e,this.nt=n,this.sequenceNumber=r,this.et=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function bi(t){switch(t){case gr.OK:return Or(),0;case gr.CANCELLED:case gr.UNKNOWN:case gr.DEADLINE_EXCEEDED:case gr.RESOURCE_EXHAUSTED:case gr.INTERNAL:case gr.UNAVAILABLE:case gr.UNAUTHENTICATED:return;case gr.INVALID_ARGUMENT:case gr.NOT_FOUND:case gr.ALREADY_EXISTS:case gr.PERMISSION_DENIED:case gr.FAILED_PRECONDITION:case gr.ABORTED:case gr.OUT_OF_RANGE:case gr.UNIMPLEMENTED:case gr.DATA_LOSS:return 1;default:return Or(),0}}function Ei(t){if(void 0===t)return Tr("GRPC error has no .code"),gr.UNKNOWN;switch(t){case gi.OK:return gr.OK;case gi.CANCELLED:return gr.CANCELLED;case gi.UNKNOWN:return gr.UNKNOWN;case gi.DEADLINE_EXCEEDED:return gr.DEADLINE_EXCEEDED;case gi.RESOURCE_EXHAUSTED:return gr.RESOURCE_EXHAUSTED;case gi.INTERNAL:return gr.INTERNAL;case gi.UNAVAILABLE:return gr.UNAVAILABLE;case gi.UNAUTHENTICATED:return gr.UNAUTHENTICATED;case gi.INVALID_ARGUMENT:return gr.INVALID_ARGUMENT;case gi.NOT_FOUND:return gr.NOT_FOUND;case gi.ALREADY_EXISTS:return gr.ALREADY_EXISTS;case gi.PERMISSION_DENIED:return gr.PERMISSION_DENIED;case gi.FAILED_PRECONDITION:return gr.FAILED_PRECONDITION;case gi.ABORTED:return gr.ABORTED;case gi.OUT_OF_RANGE:return gr.OUT_OF_RANGE;case gi.UNIMPLEMENTED:return gr.UNIMPLEMENTED;case gi.DATA_LOSS:return gr.DATA_LOSS;default:return Or()}}(l=gi={})[l.OK=0]="OK",l[l.CANCELLED=1]="CANCELLED",l[l.UNKNOWN=2]="UNKNOWN",l[l.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",l[l.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",l[l.NOT_FOUND=5]="NOT_FOUND",l[l.ALREADY_EXISTS=6]="ALREADY_EXISTS",l[l.PERMISSION_DENIED=7]="PERMISSION_DENIED",l[l.UNAUTHENTICATED=16]="UNAUTHENTICATED",l[l.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",l[l.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",l[l.ABORTED=10]="ABORTED",l[l.OUT_OF_RANGE=11]="OUT_OF_RANGE",l[l.UNIMPLEMENTED=12]="UNIMPLEMENTED",l[l.INTERNAL=13]="INTERNAL",l[l.UNAVAILABLE=14]="UNAVAILABLE",l[l.DATA_LOSS=15]="DATA_LOSS";var Ii=(Si.prototype.ot=function(t,e){return new Si(this.S,this.root.ot(t,e,this.S).copy(null,null,Ai.ut,null,null))},Si.prototype.remove=function(t){return new Si(this.S,this.root.remove(t,this.S).copy(null,null,Ai.ut,null,null))},Si.prototype.get=function(t){for(var e=this.root;!e.P();){var n=this.S(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Si.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.P();){var r=this.S(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Si.prototype.P=function(){return this.root.P()},Object.defineProperty(Si.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Si.prototype.ct=function(){return this.root.ct()},Si.prototype.ht=function(){return this.root.ht()},Si.prototype.at=function(t){return this.root.at(t)},Si.prototype.forEach=function(n){this.at(function(t,e){return n(t,e),!1})},Si.prototype.toString=function(){var n=[];return this.at(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Si.prototype.lt=function(t){return this.root.lt(t)},Si.prototype._t=function(){return new Ti(this.root,null,this.S,!1)},Si.prototype.ft=function(t){return new Ti(this.root,t,this.S,!1)},Si.prototype.dt=function(){return new Ti(this.root,null,this.S,!0)},Si.prototype.wt=function(t){return new Ti(this.root,t,this.S,!0)},Si),Ti=(Oi.prototype.It=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.Et)for(t=t.left;!t.P();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.P();)this.Tt.push(t),t=t.left;return e},Oi.prototype.At=function(){return 0<this.Tt.length},Oi.prototype.Rt=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},Oi),Ai=(Ni.prototype.copy=function(t,e,n,r,i){return new Ni(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Ni.prototype.P=function(){return!1},Ni.prototype.at=function(t){return this.left.at(t)||t(this.key,this.value)||this.right.at(t)},Ni.prototype.lt=function(t){return this.right.lt(t)||t(this.key,this.value)||this.left.lt(t)},Ni.prototype.min=function(){return this.left.P()?this:this.left.min()},Ni.prototype.ct=function(){return this.min().key},Ni.prototype.ht=function(){return this.right.P()?this.key:this.right.ht()},Ni.prototype.ot=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.ot(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.ot(t,e,n))).Pt()},Ni.prototype.yt=function(){if(this.left.P())return Ni.EMPTY;var t=this;return t.left.Vt()||t.left.left.Vt()||(t=t.gt()),(t=t.copy(null,null,null,t.left.yt(),null)).Pt()},Ni.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.P()||r.left.Vt()||r.left.left.Vt()||(r=r.gt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Vt()&&(r=r.vt()),r.right.P()||r.right.Vt()||r.right.left.Vt()||(r=r.bt()),0===e(t,r.key)){if(r.right.P())return Ni.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.yt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Pt()},Ni.prototype.Vt=function(){return this.color},Ni.prototype.Pt=function(){var t=this;return t.right.Vt()&&!t.left.Vt()&&(t=t.Ct()),t.left.Vt()&&t.left.left.Vt()&&(t=t.vt()),t.left.Vt()&&t.right.Vt()&&(t=t.St()),t},Ni.prototype.gt=function(){var t=this.St();return t.right.left.Vt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.vt())).Ct()).St()),t},Ni.prototype.bt=function(){var t=this.St();return t.left.left.Vt()&&(t=(t=t.vt()).St()),t},Ni.prototype.Ct=function(){var t=this.copy(null,null,Ni.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Ni.prototype.vt=function(){var t=this.copy(null,null,Ni.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Ni.prototype.St=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Ni.prototype.Dt=function(){var t=this.Ft();return Math.pow(2,t)<=this.size+1},Ni.prototype.Ft=function(){if(this.Vt()&&this.left.Vt())throw Or();if(this.right.Vt())throw Or();var t=this.left.Ft();if(t!==this.right.Ft())throw Or();return t+(this.Vt()?0:1)},Ni);function Ni(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Ni.RED,this.left=null!=r?r:Ni.EMPTY,this.right=null!=i?i:Ni.EMPTY,this.size=this.left.size+1+this.right.size}function Oi(t,e,n,r){this.Et=r,this.Tt=[];for(var i=1;!t.P();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Et?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.Et?t.right:t.left}}function Si(t,e){this.S=t,this.root=e||Ai.EMPTY}function Pi(){this.size=0}Ai.EMPTY=null,Ai.RED=!0,Ai.ut=!1,Ai.EMPTY=(Object.defineProperty(Pi.prototype,"key",{get:function(){throw Or()},enumerable:!1,configurable:!0}),Object.defineProperty(Pi.prototype,"value",{get:function(){throw Or()},enumerable:!1,configurable:!0}),Object.defineProperty(Pi.prototype,"color",{get:function(){throw Or()},enumerable:!1,configurable:!0}),Object.defineProperty(Pi.prototype,"left",{get:function(){throw Or()},enumerable:!1,configurable:!0}),Object.defineProperty(Pi.prototype,"right",{get:function(){throw Or()},enumerable:!1,configurable:!0}),Pi.prototype.copy=function(t,e,n,r,i){return this},Pi.prototype.ot=function(t,e,n){return new Ai(t,e)},Pi.prototype.remove=function(t,e){return this},Pi.prototype.P=function(){return!0},Pi.prototype.at=function(t){return!1},Pi.prototype.lt=function(t){return!1},Pi.prototype.ct=function(){return null},Pi.prototype.ht=function(){return null},Pi.prototype.Vt=function(){return!1},Pi.prototype.Dt=function(){return!0},Pi.prototype.Ft=function(){return 0},new Pi);var Li=(_i.prototype.has=function(t){return null!==this.data.get(t)},_i.prototype.first=function(){return this.data.ct()},_i.prototype.last=function(){return this.data.ht()},Object.defineProperty(_i.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),_i.prototype.indexOf=function(t){return this.data.indexOf(t)},_i.prototype.forEach=function(n){this.data.at(function(t,e){return n(t),!1})},_i.prototype.Nt=function(t,e){for(var n=this.data.ft(t[0]);n.At();){var r=n.It();if(0<=this.S(r.key,t[1]))return;e(r.key)}},_i.prototype.xt=function(t,e){for(var n=void 0!==e?this.data.ft(e):this.data._t();n.At();)if(!t(n.It().key))return},_i.prototype.Ot=function(t){return(t=this.data.ft(t)).At()?t.It().key:null},_i.prototype._t=function(){return new Ri(this.data._t())},_i.prototype.ft=function(t){return new Ri(this.data.ft(t))},_i.prototype.add=function(t){return this.copy(this.data.remove(t).ot(t,!0))},_i.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},_i.prototype.P=function(){return this.data.P()},_i.prototype.kt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},_i.prototype.isEqual=function(t){if(!(t instanceof _i))return!1;if(this.size!==t.size)return!1;for(var e=this.data._t(),n=t.data._t();e.At();){var r=e.It().key,i=n.It().key;if(0!==this.S(r,i))return!1}return!0},_i.prototype.L=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},_i.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},_i.prototype.copy=function(t){var e=new _i(this.S);return e.data=t,e},_i),Ri=(Di.prototype.It=function(){return this.$t.It().key},Di.prototype.At=function(){return this.$t.At()},Di),ki=new Ii(ei.S);function Di(t){this.$t=t}function _i(t){this.S=t,this.data=new Ii(this.S)}var Vi=new Ii(ei.S),Ci=new Ii(ei.S),xi=new Li(ei.S);function Ui(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=xi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Mi=new Li(Rr),qi=(eo.qt=function(t){return new eo(t.S)},eo.prototype.has=function(t){return null!=this.Mt.get(t)},eo.prototype.get=function(t){return this.Mt.get(t)},eo.prototype.first=function(){return this.Lt.ct()},eo.prototype.last=function(){return this.Lt.ht()},eo.prototype.P=function(){return this.Lt.P()},eo.prototype.indexOf=function(t){return(t=this.Mt.get(t))?this.Lt.indexOf(t):-1},Object.defineProperty(eo.prototype,"size",{get:function(){return this.Lt.size},enumerable:!1,configurable:!0}),eo.prototype.forEach=function(n){this.Lt.at(function(t,e){return n(t),!1})},eo.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Mt.ot(t.key,t),e.Lt.ot(t,null))},eo.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Mt.remove(t),this.Lt.remove(e)):this},eo.prototype.isEqual=function(t){if(!(t instanceof eo))return!1;if(this.size!==t.size)return!1;for(var e=this.Lt._t(),n=t.Lt._t();e.At();){var r=e.It().key,i=n.It().key;if(!r.isEqual(i))return!1}return!0},eo.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},eo.prototype.copy=function(t,e){var n=new eo;return n.S=this.S,n.Mt=t,n.Lt=e,n},eo),ji=(to.prototype.track=function(t){var e=t.doc.key,n=this.Ut.get(e);!n||0!==t.type&&3===n.type?this.Ut=this.Ut.ot(e,t):3===t.type&&1!==n.type?this.Ut=this.Ut.ot(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Ut=this.Ut.ot(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Ut=this.Ut.ot(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Ut=this.Ut.remove(e):1===t.type&&2===n.type?this.Ut=this.Ut.ot(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Ut=this.Ut.ot(e,{type:2,doc:t.doc}):Or()},to.prototype.Bt=function(){var n=[];return this.Ut.at(function(t,e){n.push(e)}),n},to),Fi=(Ji.Gt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Ji(t,e,qi.qt(e),i,n,r,!0,!1)},Object.defineProperty(Ji.prototype,"hasPendingWrites",{get:function(){return!this.Wt.P()},enumerable:!1,configurable:!0}),Ji.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Qt===t.Qt&&this.Wt.isEqual(t.Wt)&&ru(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.jt.isEqual(t.jt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Ji),Bi=(Zi.Xt=function(t,e){var n=new Map;return n.set(t,Gi.Zt(t,e)),new Zi(Kr.min(),n,Mi,ki,Ui())},Zi),Gi=(Ki.Zt=function(t,e){return new Ki(Dr.h,e,Ui(),Ui(),Ui())},Ki),Wi=function(t,e,n,r){this.rn=t,this.removedTargetIds=e,this.key=n,this.on=r},Hi=function(t,e){this.targetId=t,this.un=e},zi=function(t,e,n,r){void 0===n&&(n=Dr.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Xi=(Object.defineProperty(Yi.prototype,"tn",{get:function(){return this.ln},enumerable:!1,configurable:!0}),Object.defineProperty(Yi.prototype,"resumeToken",{get:function(){return this.an},enumerable:!1,configurable:!0}),Object.defineProperty(Yi.prototype,"fn",{get:function(){return 0!==this.cn},enumerable:!1,configurable:!0}),Object.defineProperty(Yi.prototype,"dn",{get:function(){return this._n},enumerable:!1,configurable:!0}),Yi.prototype.wn=function(t){0<t.o()&&(this._n=!0,this.an=t)},Yi.prototype.En=function(){var n=Ui(),r=Ui(),i=Ui();return this.hn.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Or()}}),new Gi(this.an,this.ln,n,r,i)},Yi.prototype.mn=function(){this._n=!1,this.hn=ro()},Yi.prototype.Tn=function(t,e){this._n=!0,this.hn=this.hn.ot(t,e)},Yi.prototype.In=function(t){this._n=!0,this.hn=this.hn.remove(t)},Yi.prototype.An=function(){this.cn+=1},Yi.prototype.Rn=function(){--this.cn},Yi.prototype.Pn=function(){this._n=!0,this.ln=!0},Yi),Qi=($i.prototype.bn=function(t){for(var e=0,n=t.rn;e<n.length;e++){var r=n[e];t.on instanceof qs?this.Cn(r,t.on):t.on instanceof js&&this.Sn(r,t.key,t.on)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Sn(s,t.key,t.on)}},$i.prototype.Dn=function(n){var r=this;this.Fn(n,function(t){var e=r.Nn(t);switch(n.state){case 0:r.xn(t)&&e.wn(n.resumeToken);break;case 1:e.Rn(),e.fn||e.mn(),e.wn(n.resumeToken);break;case 2:e.Rn(),e.fn||r.removeTarget(t);break;case 3:r.xn(t)&&(e.Pn(),e.wn(n.resumeToken));break;case 4:r.xn(t)&&(r.On(t),e.wn(n.resumeToken));break;default:Or()}})},$i.prototype.Fn=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Vn.forEach(function(t,e){r.xn(e)&&n(e)})},$i.prototype.kn=function(t){var e=t.targetId,n=t.un.count;(t=this.$n(e))&&(yi(t=t.target)?0===n?(t=new ei(t.path),this.Sn(e,t,new js(t,Kr.min()))):Sr(1===n):this.Mn(e)!==n&&(this.On(e),this.vn=this.vn.add(e)))},$i.prototype.Ln=function(r){var i=this,o=new Map;this.Vn.forEach(function(t,e){var n=i.$n(e);n&&(t.tn&&yi(n.target)&&(n=new ei(n.target.path),null!==i.gn.get(n)||i.qn(e,n)||i.Sn(e,n,new js(n,r))),t.dn&&(o.set(e,t.En()),t.mn()))});var s=Ui();this.pn.forEach(function(t,e){var n=!0;e.xt(function(t){return!(t=i.$n(t))||2===t.nt||(n=!1)}),n&&(s=s.add(t))});var t=new Bi(r,o,this.vn,this.gn,s);return this.gn=ki,this.pn=no(),this.vn=new Li(Rr),t},$i.prototype.Cn=function(t,e){var n;this.xn(t)&&(n=this.qn(t,e.key)?2:0,this.Nn(t).Tn(e.key,n),this.gn=this.gn.ot(e.key,e),this.pn=this.pn.ot(e.key,this.Un(e.key).add(t)))},$i.prototype.Sn=function(t,e,n){var r;this.xn(t)&&(r=this.Nn(t),this.qn(t,e)?r.Tn(e,1):r.In(e),this.pn=this.pn.ot(e,this.Un(e).delete(t)),n&&(this.gn=this.gn.ot(e,n)))},$i.prototype.removeTarget=function(t){this.Vn.delete(t)},$i.prototype.Mn=function(t){var e=this.Nn(t).En();return this.yn.Bn(t).size+e.nn.size-e.sn.size},$i.prototype.An=function(t){this.Nn(t).An()},$i.prototype.Nn=function(t){var e=this.Vn.get(t);return e||(e=new Xi,this.Vn.set(t,e)),e},$i.prototype.Un=function(t){var e=this.pn.get(t);return e||(e=new Li(Rr),this.pn=this.pn.ot(t,e)),e},$i.prototype.xn=function(t){var e=null!==this.$n(t);return e||Ir("WatchChangeAggregator","Detected inactive target",t),e},$i.prototype.$n=function(t){var e=this.Vn.get(t);return e&&e.fn?null:this.yn.jn(t)},$i.prototype.On=function(e){var n=this;this.Vn.set(e,new Xi),this.yn.Bn(e).forEach(function(t){n.Sn(e,t,null)})},$i.prototype.qn=function(t,e){return this.yn.Bn(t).has(e)},$i);function $i(t){this.yn=t,this.Vn=new Map,this.gn=ki,this.pn=no(),this.vn=new Li(Rr)}function Yi(){this.cn=0,this.hn=ro(),this.an=Dr.h,this.ln=!1,this._n=!0}function Ki(t,e,n,r,i){this.resumeToken=t,this.tn=e,this.nn=n,this.en=r,this.sn=i}function Zi(t,e,n,r,i){this.et=t,this.Ht=e,this.zt=n,this.Yt=r,this.Jt=i}function Ji(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.jt=n,this.docChanges=r,this.Wt=i,this.fromCache=o,this.Qt=s,this.Kt=u}function to(){this.Ut=new Ii(ei.S)}function eo(n){this.S=n?function(t,e){return n(t,e)||ei.S(t.key,e.key)}:function(t,e){return ei.S(t.key,e.key)},this.Mt=Vi,this.Lt=new Ii(this.S)}function no(){return new Ii(ei.S)}function ro(){return new Ii(ei.S)}function io(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function oo(t){return t=po(t.mapValue.fields.__local_write_time__.timestampValue),new Yr(t.seconds,t.nanos)}var so=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function uo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?io(t)?4:10:Or()}function ao(r,i){var t,e=uo(r);if(e!==uo(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return oo(r).isEqual(oo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=po(r.timestampValue),t=po(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,vo(r.bytesValue).isEqual(vo(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,yo((t=r).geoPointValue.latitude)===yo(e.geoPointValue.latitude)&&yo(t.geoPointValue.longitude)===yo(e.geoPointValue.longitude);case 2:return t=i,"integerValue"in(e=r)&&"integerValue"in t?yo(e.integerValue)===yo(t.integerValue):"doubleValue"in e&&"doubleValue"in t&&((e=yo(e.doubleValue))===(t=yo(t.doubleValue))?ci(e)===ci(t):isNaN(e)&&isNaN(t));case 9:return kr(r.arrayValue.values||[],i.arrayValue.values||[],ao);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Wr(e)!==Wr(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!ao(e[t],n[t])))return!1;return!0}();default:return Or()}}function ho(t,e){return void 0!==(t.values||[]).find(function(t){return ao(t,e)})}function co(t,e){var n,r,i,o=uo(t),s=uo(e);if(o!==s)return Rr(o,s);switch(o){case 0:return 0;case 1:return Rr(t.booleanValue,e.booleanValue);case 2:return n=e,(r=yo(t.integerValue||t.doubleValue))<(n=yo(n.integerValue||n.doubleValue))?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return lo(t.timestampValue,e.timestampValue);case 4:return lo(oo(t),oo(e));case 5:return Rr(t.stringValue,e.stringValue);case 6:return i=t.bytesValue,s=e.bytesValue,i=vo(i),s=vo(s),i.u(s);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Rr(n[i],r[i]);if(0!==o)return o}return Rr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return o=t.geoPointValue,r=e.geoPointValue,0!==(n=Rr(yo(o.latitude),yo(r.latitude)))?n:Rr(yo(o.longitude),yo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=co(n[i],r[i]);if(o)return o}return Rr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Rr(r[s],o[s]);if(0!==u)return u;if(0!==(u=co(n[r[s]],i[o[s]])))return u}return Rr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Or()}}function lo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Rr(t,e);var n=po(t),t=po(e);return 0!==(e=Rr(n.seconds,t.seconds))?e:Rr(n.nanos,t.nanos)}function fo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=po(t=i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?vo(i.bytesValue).toBase64():"referenceValue"in i?(e=i.referenceValue,ei.Y(e).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Or();var t,e}(t)}function po(t){if(Sr(!!t),"string"!=typeof t)return{seconds:yo(t.seconds),nanos:yo(t.nanos)};var e=0,n=so.exec(t);return Sr(!!n),n[1]&&(n=(n[1]+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function yo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function vo(t){return"string"==typeof t?Dr.fromBase64String(t):Dr.fromUint8Array(t)}function go(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.q()}}function mo(t){return t&&"integerValue"in t}function wo(t){return!!t&&"arrayValue"in t}function bo(t){return t&&"nullValue"in t}function Eo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Io(t){return t&&"mapValue"in t}var To={asc:"ASCENDING",desc:"DESCENDING"},Ao={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},No=function(t,e){this._=t,this.Wn=e};function Oo(t){return{integerValue:""+t}}function So(t,e){if(t.Wn){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ci(e)?"-0":e}}function Po(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!ci(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Oo(e):So(t,e);var n}function Lo(t,e){return t.Wn?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ro(t,e){return t.Wn?e.toBase64():e.toUint8Array()}function ko(t){return Sr(!!t),Kr.g((t=po(t),new Yr(t.seconds,t.nanos)))}function Do(t,e){return new Zr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).q()}function _o(t,e){return Do(t._,e.path)}function Vo(t,e){return Sr(Fo(e=Zr.U(e))),Sr(e.get(1)===t._.projectId),Sr(!e.get(3)&&!t._.database||e.get(3)===t._.database),new ei((Sr(4<e.length&&"documents"===e.get(4)),e.F(5)))}function Co(t,e){return Do(t._,e)}function xo(t){return new Zr(["projects",t._.projectId,"databases",t._.database]).q()}function Uo(t,e,n){return{name:_o(t,e),fields:n.proto.mapValue.fields}}function Mo(t,e){var n,r,i;if(e instanceof gs)n={update:Uo(t,e.key,e.value)};else if(e instanceof Ps)n={delete:_o(t,e.key)};else if(e instanceof ms)n={update:Uo(t,e.key,e.data),updateMask:(i=e.Qn,r=[],i.fields.forEach(function(t){return r.push(t.q())}),{fieldPaths:r})};else if(e instanceof Ts)n={transform:{document:_o(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Ho)return{fieldPath:t.field.q(),setToServerValue:"REQUEST_TIME"};if(e instanceof zo)return{fieldPath:t.field.q(),appendMissingElements:{values:e.elements}};if(e instanceof Ko)return{fieldPath:t.field.q(),removeAllFromArray:{values:e.elements}};if(e instanceof es)return{fieldPath:t.field.q(),increment:e.Kn};throw Or()})}};else{if(!(e instanceof Ls))return Or();n={verify:_o(t,e.key)}}return e.Hn.Gn||(n.currentDocument=void 0!==(i=e.Hn).updateTime?{updateTime:Lo(e=t,(t=i.updateTime).v())}:void 0!==i.exists?{exists:i.exists}:Or()),n}function qo(t){return{before:t.before,values:t.position}}function jo(t){return{fieldPath:t.q()}}function Fo(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function Bo(t,e){return t instanceof es?mo(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var Go,Wo,Ho=(n(Qo,Wo=l=function(){this.zn=void 0}),Qo),zo=(n(Xo,Go=l),Xo);function Xo(t){var e=this;return(e=Go.call(this)||this).elements=t,e}function Qo(){return null!==Wo&&Wo.apply(this,arguments)||this}function $o(t,e){for(var n=is(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return ao(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var Yo,Ko=(n(Zo,Yo=l),Zo);function Zo(t){var e=this;return(e=Yo.call(this)||this).elements=t,e}function Jo(t,e){for(var n=is(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!ao(t,e)})}(i[r]);return{arrayValue:{values:n}}}var ts,es=(n(ns,ts=l),ns);function ns(t,e){var n=this;return(n=ts.call(this)||this).serializer=t,n.Kn=e,n}function rs(t){return yo(t.integerValue||t.doubleValue)}function is(t){return wo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function os(t,e){this.field=t,this.transform=e}var ss=(us.prototype.Yn=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].$(t))return!0;return!1},us.prototype.isEqual=function(t){return kr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},us);function us(t){(this.fields=t).sort(ti.S)}function as(t,e){this.version=t,this.transformResults=e}var hs=(cs.Jn=function(){return new cs},cs.exists=function(t){return new cs(void 0,t)},cs.updateTime=function(t){return new cs(t)},Object.defineProperty(cs.prototype,"Gn",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),cs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},cs);function cs(t,e){this.updateTime=t,this.exists=e}function ls(t,e){return void 0!==t.updateTime?e instanceof qs&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof qs}function fs(t,e,n,r){return t instanceof gs?(o=e,ls((i=t).Hn,o)?(o=ds(o),new qs(i.key,o,i.value,{Xn:!0})):o):t instanceof ms?function(t,e){if(!ls(t.Hn,e))return e;var n=ds(e),e=Es(t,e);return new qs(t.key,n,e,{Xn:!0})}(t,e):t instanceof Ts?function(t,e,n,r){if(!ls(t.Hn,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],h=a.transform,c=null;n instanceof qs&&(c=n.field(a.field)),null===c&&r instanceof qs&&(c=r.field(a.field)),o.push((i=c,a=e,c=void 0,h instanceof Ho?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(c.fields.__previous_value__=i),{mapValue:c}):h instanceof zo?$o(h,i):h instanceof Ko?Jo(h,i):(i=rs(h=Bo(c=h,i))+rs(c.Kn),mo(h)&&mo(c.Kn)?Oo(i):So(c.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=Ns(t,i.data(),r);return new qs(t.key,i.version,r,{Xn:!0})}(t,e,r,n):ls(t.Hn,e)?new js(t.key,Kr.min()):e;var i,o}function ps(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Hn.isEqual(e.Hn)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qn.isEqual(e.Qn):2!==t.type||kr(t.fieldTransforms,t.fieldTransforms,function(t,e){return t.field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof zo&&e instanceof zo||t instanceof Ko&&e instanceof Ko?kr(t.elements,e.elements,ao):t instanceof es&&e instanceof es?ao(t.Kn,e.Kn):t instanceof Ho&&e instanceof Ho)}))}function ds(t){return t instanceof qs?t.version:Kr.min()}var ys,vs,gs=(n(bs,vs=l=function(){}),bs),ms=(n(ws,ys=l),ws);function ws(t,e,n,r){var i=this;return(i=ys.call(this)||this).key=t,i.data=e,i.Qn=n,i.Hn=r,i.type=1,i}function bs(t,e,n){var r=this;return(r=vs.call(this)||this).key=t,r.value=e,r.Hn=n,r.type=0,r}function Es(t,e){return n=t,e=e instanceof qs?e.data():Rs.empty(),r=new ks(e),n.Qn.fields.forEach(function(t){var e;t.P()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Zn();var n,r}var Is,Ts=(n(As,Is=l),As);function As(t,e){var n=this;return(n=Is.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Hn=hs.exists(!0),n}function Ns(t,e,n){for(var r=new ks(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Zn()}var Os,Ss,Ps=(n(Cs,Ss=l),Cs),Ls=(n(Vs,Os=l),Vs),Rs=(_s.empty=function(){return new _s({mapValue:{}})},_s.prototype.field=function(t){if(t.P())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Io(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.k()])||null},_s.prototype.isEqual=function(t){return ao(this.proto,t.proto)},_s),ks=(Ds.prototype.set=function(t,e){return this.ee(t,e),this},Ds.prototype.delete=function(t){return this.ee(t,null),this},Ds.prototype.ee=function(t,e){for(var n=this.ne,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===uo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.k(),e)},Ds.prototype.Zn=function(){var t=this.se(ti.B(),this.ne);return null!=t?new Rs(t):this.te},Ds.prototype.se=function(r,t){var i=this,o=!1,e=this.te.field(r),s=Io(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.se(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Ds);function Ds(t){void 0===t&&(t=Rs.empty()),this.te=t,this.ne=new Map}function _s(t){this.proto=t}function Vs(t,e){var n=this;return(n=Os.call(this)||this).key=t,n.Hn=e,n.type=4,n}function Cs(t,e){var n=this;return(n=Ss.call(this)||this).key=t,n.Hn=e,n.type=3,n}var xs,Us,Ms,qs=(n(Hs,Ms=l=function(t,e){this.key=t,this.version=e}),Hs.prototype.field=function(t){return this.ie.field(t)},Hs.prototype.data=function(){return this.ie},Hs.prototype.re=function(){return this.ie.proto},Hs.prototype.isEqual=function(t){return t instanceof Hs&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Xn===t.Xn&&this.hasCommittedMutations===t.hasCommittedMutations&&this.ie.isEqual(t.ie)},Hs.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.ie.toString()+", {hasLocalMutations: "+this.Xn+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Hs.prototype,"hasPendingWrites",{get:function(){return this.Xn||this.hasCommittedMutations},enumerable:!1,configurable:!0}),Hs),js=(n(Ws,Us=l),Ws.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Ws.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Ws.prototype.isEqual=function(t){return t instanceof Ws&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Ws),Fs=(n(Gs,xs=l),Gs.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Gs.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Gs.prototype.isEqual=function(t){return t instanceof Gs&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Gs),Bs=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.oe=n,this.filters=r,this.limit=i,this.ue=o,this.startAt=s,this.endAt=u,this.ce=null,this.he=null,this.startAt,this.endAt};function Gs(){return null!==xs&&xs.apply(this,arguments)||this}function Ws(t,e,n){var r=this;return(r=Us.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function Hs(t,e,n,r){var i=this;return(i=Ms.call(this,t,e)||this).ie=n,i.Xn=!!r.Xn,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function zs(t){return new Bs(t)}function Xs(t){return!hi(t.limit)&&"F"===t.ue}function Qs(t){return!hi(t.limit)&&"L"===t.ue}function $s(t){return 0<t.oe.length?t.oe[0].field:null}function Ys(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.ae())return r.field}return null}function Ks(t){return null!==t.collectionGroup}function Zs(t){var e=t;if(null===e.ce){e.ce=[];var n=Ys(e),t=$s(e);if(null!==n&&null===t)n.W()||e.ce.push(new Uu(n)),e.ce.push(new Uu(ti.K(),"asc"));else{for(var r=!1,i=0,o=e.oe;i<o.length;i++){var s=o[i];e.ce.push(s),s.field.W()&&(r=!0)}r||(n=0<e.oe.length?e.oe[e.oe.length-1].dir:"asc",e.ce.push(new Uu(ti.K(),n)))}}return e.ce}function Js(t){var e=t;if(!e.he)if("F"===e.ue)e.he=fi(e.path,e.collectionGroup,Zs(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Zs(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Uu(o.field,s))}var u=e.endAt?new Lu(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Lu(e.startAt.position,!e.startAt.before):null;e.he=fi(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.he}function tu(t,e,n){return new Bs(t.path,t.collectionGroup,t.oe.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function eu(t,e){return new Bs(t.path,t.collectionGroup,t.oe.slice(),t.filters.slice(),t.limit,t.ue,e,t.endAt)}function nu(t,e){return new Bs(t.path,t.collectionGroup,t.oe.slice(),t.filters.slice(),t.limit,t.ue,t.startAt,e)}function ru(t,e){return di(Js(t),Js(e))&&t.ue===e.ue}function iu(t){return pi(Js(t))+"|lt:"+t.ue}function ou(t){return"Query(target="+(n=(e=Js(t)).path.q(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return t.field.q()+" "+t.op+" "+fo(t.value)}).join(", ")+"]"),hi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return t.field.q()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Vu(e.startAt)),e.endAt&&(n+=", endAt: "+Vu(e.endAt)),"Target("+n+")")+"; limitType="+t.ue+")";var e,n}function su(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.J(e.collectionGroup)&&e.path.$(n):ei.X(e.path)?e.path.isEqual(n):e.path.M(n))&&function(t){for(var e=0,n=i.oe;e<n.length;e++){var r=n[e];if(!r.field.W()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||Cu(t.startAt,Zs(t),n))&&(!t.endAt||!Cu(t.endAt,Zs(t),n)));var e,n}function uu(u){return function(t,e){for(var n=!1,r=0,i=Zs(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i;switch(n=t.field.W()?ei.S(e.key,n.key):(r=t.field,i=n,e=e.field(r),r=i.field(r),null!==e&&null!==r?co(e,r):Or()),t.dir){case"asc":return n;case"desc":return-1*n;default:return Or()}}(o,t,e);if(0!==s)return s;n=n||o.field.W()}return 0}}var au,hu=(n(cu,au=function(){}),cu.create=function(t,e,n){return t.W()?"in"===e||"not-in"===e?this.le(t,e,n):new du(t,e,n):"array-contains"===e?new Nu(t,n):"in"===e?new Ou(t,n):"not-in"===e?new Su(t,n):"array-contains-any"===e?new Pu(t,n):new cu(t,e,n)},cu.le=function(t,e,n){return new("in"===e?yu:vu)(t,n)},cu.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this._e(co(t,this.value)):null!==t&&uo(this.value)===uo(t)&&this._e(co(t,this.value))},cu.prototype._e=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Or()}},cu.prototype.ae=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},cu);function cu(t,e,n){var r=this;return(r=au.call(this)||this).field=t,r.op=e,r.value=n,r}var lu,fu,pu,du=(n(wu,pu=hu),wu.prototype.matches=function(t){return t=ei.S(t.key,this.key),this._e(t)},wu),yu=(n(mu,fu=hu),mu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},mu),vu=(n(gu,lu=hu),gu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},gu);function gu(t,e){var n=this;return(n=lu.call(this,t,"not-in",e)||this).keys=bu(0,e),n}function mu(t,e){var n=this;return(n=fu.call(this,t,"in",e)||this).keys=bu(0,e),n}function wu(t,e,n){var r=this;return(r=pu.call(this,t,e,n)||this).key=ei.Y(n.referenceValue),r}function bu(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return ei.Y(t.referenceValue)})}var Eu,Iu,Tu,Au,Nu=(n(_u,Au=hu),_u.prototype.matches=function(t){return wo(t=t.field(this.field))&&ho(t.arrayValue,this.value)},_u),Ou=(n(Du,Tu=hu),Du.prototype.matches=function(t){return null!==(t=t.field(this.field))&&ho(this.value.arrayValue,t)},Du),Su=(n(ku,Iu=hu),ku.prototype.matches=function(t){return!ho(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&(null!==(t=t.field(this.field))&&!ho(this.value.arrayValue,t))},ku),Pu=(n(Ru,Eu=hu),Ru.prototype.matches=function(t){var e=this;return!(!wo(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return ho(e.value.arrayValue,t)})},Ru),Lu=function(t,e){this.position=t,this.before=e};function Ru(t,e){return Eu.call(this,t,"array-contains-any",e)||this}function ku(t,e){return Iu.call(this,t,"not-in",e)||this}function Du(t,e){return Tu.call(this,t,"in",e)||this}function _u(t,e){return Au.call(this,t,"array-contains",e)||this}function Vu(t){return(t.before?"b":"a")+":"+t.position.map(fo).join(",")}function Cu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.W()?ei.S(ei.Y(s.referenceValue),n.key):co(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function xu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!ao(t.position[n],e.position[n]))return!1;return!0}var Uu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Mu(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var qu=(Bu.prototype.reset=function(){this.Te=0},Bu.prototype.Re=function(){this.Te=this.me},Bu.prototype.Pe=function(t){var e=this;this.cancel();var n=Math.floor(this.Te+this.ye()),r=Math.max(0,Date.now()-this.Ae),i=Math.max(0,n-r);0<i&&Ir("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Te+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ie=this.fe.Ve(this.de,i,function(){return e.Ae=Date.now(),t()}),this.Te*=this.Ee,this.Te<this.we&&(this.Te=this.we),this.Te>this.me&&(this.Te=this.me)},Bu.prototype.ge=function(){null!==this.Ie&&(this.Ie.pe(),this.Ie=null)},Bu.prototype.cancel=function(){null!==this.Ie&&(this.Ie.cancel(),this.Ie=null)},Bu.prototype.ye=function(){return(Math.random()-.5)*this.Te},Bu),ju=(Fu.prototype.catch=function(t){return this.next(void 0,t)},Fu.prototype.next=function(r,i){var o=this;return this.Se&&Or(),this.Se=!0,this.Ce?this.error?this.De(i,this.error):this.Fe(r,this.result):new Fu(function(e,n){o.ve=function(t){o.Fe(r,t).next(e,n)},o.be=function(t){o.De(i,t).next(e,n)}})},Fu.prototype.Ne=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Fu.prototype.xe=function(t){try{var e=t();return e instanceof Fu?e:Fu.resolve(e)}catch(t){return Fu.reject(t)}},Fu.prototype.Fe=function(t,e){return t?this.xe(function(){return t(e)}):Fu.resolve(e)},Fu.prototype.De=function(t,e){return t?this.xe(function(){return t(e)}):Fu.reject(e)},Fu.resolve=function(n){return new Fu(function(t,e){t(n)})},Fu.reject=function(n){return new Fu(function(t,e){e(n)})},Fu.Oe=function(t){return new Fu(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Fu.ke=function(t){for(var n=Fu.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Fu.resolve(t):e()})}(r[e]);return n},Fu.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Oe(i)},Fu);function Fu(t){var e=this;this.ve=null,this.be=null,this.result=void 0,this.error=void 0,this.Ce=!1,this.Se=!1,t(function(t){e.Ce=!0,e.result=t,e.ve&&e.ve(t)},function(t){e.Ce=!0,e.error=t,e.be&&e.be(t)})}function Bu(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.fe=t,this.de=e,this.we=n,this.Ee=r,this.me=i,this.Te=0,this.Ie=null,this.Ae=Date.now(),this.reset()}function Gu(t){return"IndexedDbTransactionError"===t.name}function Wu(){return"undefined"!=typeof document?document:null}var Hu=(Qu.Ue=function(t,e,n,r,i){return(i=new Qu(t,e,Date.now()+n,r,i)).start(n),i},Qu.prototype.start=function(t){var e=this;this.Be=setTimeout(function(){return e.je()},t)},Qu.prototype.pe=function(){return this.je()},Qu.prototype.cancel=function(t){null!==this.Be&&(this.clearTimeout(),this.qe.reject(new mr(gr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Qu.prototype.je=function(){var e=this;this.$e.We(function(){return null!==e.Be?(e.clearTimeout(),e.op().then(function(t){return e.qe.resolve(t)})):Promise.resolve()})},Qu.prototype.clearTimeout=function(){null!==this.Be&&(this.Le(this),clearTimeout(this.Be),this.Be=null)},Qu),zu=(Object.defineProperty(Xu.prototype,"ts",{get:function(){return this.Ge},enumerable:!1,configurable:!0}),Xu.prototype.We=function(t){this.enqueue(t)},Xu.prototype.ns=function(t){this.es(),this.ss(t)},Xu.prototype.rs=function(){var t;this.Ge||(this.Ge=!0,(t=Wu())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Ze))},Xu.prototype.enqueue=function(t){return this.es(),this.Ge?new Promise(function(t){}):this.ss(t)},Xu.prototype.os=function(t){var e=this;this.We(function(){return e.Ke.push(t),e.us()})},Xu.prototype.us=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Ke.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Ke[0]()];case 2:return t.sent(),this.Ke.shift(),this.Xe.reset(),[3,4];case 3:if(!Gu(e=t.sent()))throw e;return Ir("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Ke.length&&this.Xe.Pe(function(){return n.us()}),t.label=5;case 5:return[2]}})})},Xu.prototype.ss=function(t){var r=this,e=this.Qe.then(function(){return r.Ye=!0,t().catch(function(t){throw r.ze=t,r.Ye=!1,Tr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Ye=!1,t})});return this.Qe=e},Xu.prototype.Ve=function(t,e,n){var r=this;return this.es(),-1<this.Je.indexOf(t)&&(e=0),n=Hu.Ue(this,t,e,n,function(t){return r.cs(t)}),this.He.push(n),n},Xu.prototype.es=function(){this.ze&&Or()},Xu.prototype.hs=function(){},Xu.prototype.ls=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Qe];case 1:t.sent(),t.label=2;case 2:if(e!==this.Qe)return[3,0];t.label=3;case 3:return[2]}})})},Xu.prototype._s=function(t){for(var e=0,n=this.He;e<n.length;e++)if(n[e].de===t)return!0;return!1},Xu.prototype.fs=function(r){var i=this;return this.ls().then(function(){i.He.sort(function(t,e){return t.Me-e.Me});for(var t=0,e=i.He;t<e.length;t++){var n=e[t];if(n.pe(),"all"!==r&&n.de===r)break}return i.ls()})},Xu.prototype.ds=function(t){this.Je.push(t)},Xu.prototype.cs=function(t){t=this.He.indexOf(t),this.He.splice(t,1)},Xu);function Xu(){var e=this;this.Qe=Promise.resolve(),this.Ke=[],this.Ge=!1,this.He=[],this.ze=null,this.Ye=!1,this.Je=[],this.Xe=new qu(this,"async_queue_retry"),this.Ze=function(){var t=Wu();t&&Ir("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Xe.ge()};var t=Wu();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Ze)}function Qu(t,e,n,r,i){this.$e=t,this.de=e,this.Me=n,this.op=r,this.Le=i,this.qe=new Mu,this.then=this.qe.promise.then.bind(this.qe.promise),this.qe.promise.catch(function(t){})}function $u(t,e){if(Tr("AsyncQueue",e+": "+t),Gu(t))return new mr(gr.UNAVAILABLE,e+": "+t);throw t}function Yu(){this.Es=new $r(iu,ru),this.onlineState="Unknown",this.Ts=new Set}var Ku=function(){this.ws=void 0,this.listeners=[]};function Zu(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.Es.get(n))||(r=!0,i=new Ku),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Is(n)];case 2:return o.ws=t.sent(),[3,4];case 3:return o=$u(o=t.sent(),"Initialization of query '"+ou(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.Es.set(n,i),i.listeners.push(u),u.As(e.onlineState),i.ws&&u.Rs(i.ws)&&ta(e),[2]}})})}function Ju(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.Es.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.Es.delete(n),e.Ps(n))]:[2]})})}function ta(t){t.Ts.forEach(function(t){t.next()})}var ea=(ia.prototype.Rs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Fi(t.query,t.docs,t.jt,e,t.Wt,t.fromCache,t.Qt,!0)}var o=!1;return this.Vs?this.ps(t)&&(this.ys.next(t),o=!0):this.vs(t,this.onlineState)&&(this.bs(t),o=!0),this.gs=t,o},ia.prototype.onError=function(t){this.ys.error(t)},ia.prototype.As=function(t){this.onlineState=t;var e=!1;return this.gs&&!this.Vs&&this.vs(this.gs,t)&&(this.bs(this.gs),e=!0),e},ia.prototype.vs=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Cs&&n||t.docs.P()&&"Offline"!==e)},ia.prototype.ps=function(t){if(0<t.docChanges.length)return!0;var e=this.gs&&this.gs.hasPendingWrites!==t.hasPendingWrites;return!(!t.Qt&&!e)&&!0===this.options.includeMetadataChanges},ia.prototype.bs=function(t){t=Fi.Gt(t.query,t.docs,t.Wt,t.fromCache),this.Vs=!0,this.ys.next(t)},ia),na=(ra.prototype.Ss=function(){return null!=this.uid},ra.prototype.Ds=function(){return this.Ss()?"uid:"+this.uid:"anonymous-user"},ra.prototype.isEqual=function(t){return t.uid===this.uid},ra);function ra(t){this.uid=t}function ia(t,e,n){this.query=t,this.ys=e,this.Vs=!1,this.gs=null,this.onlineState="Unknown",this.options=n||{}}function oa(t,e){this.user=e,this.type="OAuth",this.xs={},this.xs.Authorization="Bearer "+t}na.UNAUTHENTICATED=new na(null),na.Fs=new na("google-credentials-uid"),na.Ns=new na("first-party-uid");var sa=(Ta.prototype.getToken=function(){return Promise.resolve(null)},Ta.prototype.ks=function(){},Ta.prototype.$s=function(t){(this.Os=t)(na.UNAUTHENTICATED)},Ta.prototype.Ms=function(){this.Os=null},Ta),ua=(Ia.prototype.getToken=function(){var e=this,n=this.Us,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.Us!==n?(Ir("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Sr("string"==typeof t.accessToken),new oa(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Ia.prototype.ks=function(){this.forceRefresh=!0},Ia.prototype.$s=function(t){this.Os=t,this.qs&&t(this.currentUser)},Ia.prototype.Ms=function(){this.auth&&this.auth.removeAuthTokenListener(this.Ls),this.Ls=null,this.Os=null},Ia.prototype.Bs=function(){var t=this.auth&&this.auth.getUid();return Sr(null===t||"string"==typeof t),new na(t)},Ia),aa=(Object.defineProperty(Ea.prototype,"xs",{get:function(){var t={"X-Goog-AuthUser":this.Ws},e=this.js.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Ea),ha=(ba.prototype.getToken=function(){return Promise.resolve(new aa(this.js,this.Ws))},ba.prototype.$s=function(t){t(na.Ns)},ba.prototype.Ms=function(){},ba.prototype.ks=function(){},ba),ca=(wa.prototype.Ks=function(t,e,n){for(var r,i,o,s,u,a=n.Gs,h=0;h<this.mutations.length;h++){var c=this.mutations[h];c.key.isEqual(t)&&(r=c,i=e,o=a[h],c=u=s=void 0,e=r instanceof gs?new qs(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof ms?(u=i,c=o,ls((s=r).Hn,u)?(u=Es(s,u),new qs(s.key,c.version,u,{hasCommittedMutations:!0})):new Fs(s.key,c.version)):r instanceof Ts?function(t,e,n){if(Sr(null!=n.transformResults),!ls(t.Hn,e))return new Fs(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Sr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof qs&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof zo?$o(o,s):o instanceof Ko?Jo(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=Ns(t,r.data(),e);return new qs(t.key,n,e,{hasCommittedMutations:!0})}(r,i,o):new js(r.key,o.version,{hasCommittedMutations:!0}))}return e},wa.prototype.Hs=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=fs(i,e,e,this.Qs))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=fs(a,e,o,this.Qs))}return e},wa.prototype.zs=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.Hs(t.key,n.get(t.key));e&&(i=i.ot(t.key,e))}),i},wa.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Ui())},wa.prototype.isEqual=function(t){return this.batchId===t.batchId&&kr(this.mutations,t.mutations,ps)&&kr(this.baseMutations,t.baseMutations,ps)},wa),la=(ma.from=function(t,e,n){Sr(t.mutations.length===n.length);for(var r=Ci,i=t.mutations,o=0;o<i.length;o++)r=r.ot(i[o].key,n[o].version);return new ma(t,e,n,r)},ma),fa=(ga.prototype.ni=function(e,n){var r=this;return this.Zs.ei(e,n).next(function(t){return r.si(e,n,t)})},ga.prototype.si=function(t,r,i){return this.Xs.ii(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].Hs(r,t);return t})},ga.prototype.ri=function(t,e,i){var o=ki;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].Hs(t,e);o=o.ot(t,e)}),o},ga.prototype.oi=function(e,t){var n=this;return this.Xs.getEntries(e,t).next(function(t){return n.ui(e,t)})},ga.prototype.ui=function(e,r){var i=this;return this.Zs.ci(e,r).next(function(t){var t=i.ri(e,r,t),n=ki;return t.forEach(function(t,e){e=e||new js(t,Kr.min()),n=n.ot(t,e)}),n})},ga.prototype.hi=function(t,e,n){return r=e,ei.X(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.ai(t,e.path):Ks(e)?this.li(t,e,n):this._i(t,e,n);var r},ga.prototype.ai=function(t,e){return this.ni(t,new ei(e)).next(function(t){var e=Vi;return t instanceof qs&&(e=e.ot(t.key,t)),e})},ga.prototype.li=function(n,r,i){var o=this,s=r.collectionGroup,u=Vi;return this.ti.fi(n,s).next(function(t){return ju.forEach(t,function(t){var e=(e=r,t=t.child(s),new Bs(t,null,e.oe.slice(),e.filters.slice(),e.limit,e.ue,e.startAt,e.endAt));return o._i(n,e,i).next(function(t){t.forEach(function(t,e){u=u.ot(t,e)})})}).next(function(){return u})})},ga.prototype._i=function(e,n,t){var a,h,r=this;return this.Xs.hi(e,n,t).next(function(t){return a=t,r.Zs.di(e,n)}).next(function(t){return h=t,r.wi(e,h,a).next(function(t){a=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,s=fs(s,s=a.get(u),s,r.Qs);a=s instanceof qs?a.ot(u,s):a.remove(u)}})}).next(function(){return a.forEach(function(t,e){su(n,e)||(a=a.remove(t))}),a})},ga.prototype.wi=function(t,e,n){for(var r=Ui(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof ms&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.Xs.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof qs&&(h=h.ot(t,e))}),h})},ga),pa=(va.Ti=function(t,e){for(var n=Ui(),r=Ui(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new va(t,e.fromCache,n,r)},va),da=(ya.prototype.Ai=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},ya.prototype.next=function(){var t=++this.previousValue;return this.Ri&&this.Ri(t),t},ya);function ya(t,e){var n=this;this.previousValue=t,e&&(e.Ii=function(t){return n.Ai(t)},this.Ri=function(t){return e.Pi(t)})}function va(t,e,n,r){this.targetId=t,this.fromCache=e,this.Ei=n,this.mi=r}function ga(t,e,n){this.Xs=t,this.Zs=e,this.ti=n}function ma(t,e,n,r){this.batch=t,this.Ys=e,this.Gs=n,this.Js=r}function wa(t,e,n,r){this.batchId=t,this.Qs=e,this.baseMutations=n,this.mutations=r}function ba(t,e){this.js=t,this.Ws=e}function Ea(t,e){this.js=t,this.Ws=e,this.type="FirstParty",this.user=na.Ns}function Ia(t){var e=this;this.Ls=null,this.currentUser=na.UNAUTHENTICATED,this.qs=!1,this.Us=0,this.Os=null,this.forceRefresh=!1,this.Ls=function(){e.Us++,e.currentUser=e.Bs(),e.qs=!0,e.Os&&e.Os(e.currentUser)},this.Us=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Ls):(this.Ls(null),t.get().then(function(t){e.auth=t,e.Ls&&e.auth.addAuthTokenListener(e.Ls)},function(){}))}function Ta(){this.Os=null}da.yi=-1;var Aa=(ka.prototype.gi=function(t,e){return this.Vi.add(e),ju.resolve()},ka.prototype.fi=function(t,e){return ju.resolve(this.Vi.getEntries(e))},ka),Na=(Ra.prototype.add=function(t){var e=t.k(),n=t.N(),r=this.index[e]||new Li(Zr.S),t=!r.has(n);return this.index[e]=r.add(n),t},Ra.prototype.has=function(t){var e=t.k(),t=t.N();return(e=this.index[e])&&e.has(t)},Ra.prototype.getEntries=function(t){return(this.index[t]||new Li(Zr.S)).L()},Ra),Oa=(La.prototype.next=function(){return this.pi+=2,this.pi},La.vi=function(){return new La(0)},La.bi=function(){return new La(-1)},La),Sa=(Pa.prototype.Ui=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Bi(t,n.Si)})},Pa);function Pa(t,e,n){this.persistence=t,this.Ci=e,this.Si=new Ii(Rr),this.Di=new $r(pi,di),this.Fi=Kr.min(),this.Zs=t.Ni(n),this.xi=t.Oi(),this.ki=t.$i(),this.Mi=new fa(this.xi,this.Zs,this.persistence.Li()),this.Ci.qi(this.Mi)}function La(t){this.pi=t}function Ra(){this.index={}}function ka(){this.Vi=new Na}function Da(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Zs,m=e.Mi,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.Zs.ji(v).next(function(t){return g=t,n=e.persistence.Ni(o),m=new fa(e.xi,n,e.persistence.Li()),n.ji(v)}).next(function(t){for(var e=[],n=[],r=Ui(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.oi(v,r).next(function(t){return{Wi:t,Qi:e,Ki:n}})})})];case 1:return r=t.sent(),[2,(e.Zs=n,e.Mi=m,e.Ci.qi(e.Mi),r)]}})})}function _a(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.ki.Xi(t)})}function Va(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).Si.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.rr.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Gu(r=t.sent()))throw r;return Ir("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.Si=e.Si.remove(o),e.Di.delete(n.target),[2]}})})}function Ca(t,o,s){var u=t,a=Kr.min(),h=Ui();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=Js(o),(void 0!==(t=(i=t).Di.get(r))?ju.resolve(i.Si.get(t)):i.ki.hr(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.ki.ar(e,t.targetId).next(function(t){h=t})}).next(function(){return u.Ci.hi(e,o,s?a:Kr.min(),s?h:Ui())}).next(function(t){return{documents:t,lr:h}});var t,n,r,i})}function xa(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==gr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Ir("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Ua(t,e,n,r,i){var o=this;this.io=t,this.ro=e,this.$e=n,this.oo={},this.uo=[],this.co=new Map,this.ho=new Set,this.ao=[],this.lo=i,this.lo._o(function(t){n.We(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return ih(this)?(Ir("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).ho.add(4),[4,Ka(e)];case 1:return t.sent(),e.fo.set("Unknown"),e.ho.delete(4),[4,Ya(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.fo=new Wa(n,r)}var Ma,qa,ja,l=($a.prototype.Tr=function(){return 1===this.state||2===this.state||4===this.state},$a.prototype.Ir=function(){return 2===this.state},$a.prototype.start=function(){3!==this.state?this.auth():this.Ar()},$a.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},$a.prototype.Rr=function(){this.state=0,this.Xe.reset()},$a.prototype.Pr=function(){var t=this;this.Ir()&&null===this.mr&&(this.mr=this.fe.Ve(this._r,6e4,function(){return t.yr()}))},$a.prototype.Vr=function(t){this.gr(),this.stream.send(t)},$a.prototype.yr=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.Ir()?[2,this.close(0)]:[2]})})},$a.prototype.gr=function(){this.mr&&(this.mr.cancel(),this.mr=null)},$a.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.gr(),this.Xe.cancel(),this.Er++,3!==e?this.Xe.reset():n&&n.code===gr.RESOURCE_EXHAUSTED?(Tr(n.toString()),Tr("Using maximum backoff delay to prevent overloading the backend."),this.Xe.Re()):n&&n.code===gr.UNAUTHENTICATED&&this.wr.ks(),null!==this.stream&&(this.pr(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.vr(n)];case 1:return t.sent(),[2]}})})},$a.prototype.pr=function(){},$a.prototype.auth=function(){var n=this;this.state=1;var t=this.br(this.Er),e=this.Er;this.wr.getToken().then(function(t){n.Er===e&&n.Cr(t)},function(e){t(function(){var t=new mr(gr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Sr(t)})})},$a.prototype.Cr=function(t){var e=this,n=this.br(this.Er);this.stream=this.Dr(t),this.stream.Fr(function(){n(function(){return e.state=2,e.listener.Fr()})}),this.stream.vr(function(t){n(function(){return e.Sr(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},$a.prototype.Ar=function(){var t=this;this.state=4,this.Xe.Pe(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},$a.prototype.Sr=function(t){return Ir("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},$a.prototype.br=function(e){var n=this;return function(t){n.fe.We(function(){return n.Er===e?t():(Ir("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},$a),Fa=(n(Qa,ja=l),Qa.prototype.Dr=function(t){return this.dr.Nr("Listen",t)},Qa.prototype.onMessage=function(t){this.Xe.reset();var e,n=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:Or(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.Wn?(Sr(void 0===o||"string"==typeof o),Dr.fromBase64String(o||"")):(Sr(void 0===o||o instanceof Uint8Array),Dr.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?gr.UNKNOWN:Ei(s.code),new mr(o,s.message||"")),r=new zi(n,r,i,s||null)}else if("documentChange"in e){e.documentChange,(a=e.documentChange).document,a.document.name,a.document.updateTime;var i=Vo(t,a.document.name),u=ko(a.document.updateTime),s=new Rs({mapValue:{fields:a.document.fields}}),u=new qs(i,u,s,{}),s=a.targetIds||[],a=a.removedTargetIds||[];r=new Wi(s,a,u.key,u)}else if("documentDelete"in e){e.documentDelete,(a=e.documentDelete).document;var u=Vo(t,a.document),h=a.readTime?ko(a.readTime):Kr.min(),h=new js(u,h),a=a.removedTargetIds||[];r=new Wi([],a,h.key,h)}else if("documentRemove"in e){e.documentRemove,(h=e.documentRemove).document;var c=Vo(t,h.document),h=h.removedTargetIds||[];r=new Wi([],h,c,null)}else{if(!("filter"in e))return Or();e.filter,(c=e.filter).targetId,e=new vi(e=c.count||0),c=c.targetId,r=new Hi(c,e)}return r}(this.serializer,t),t=!("targetChange"in(e=t))||(e=e.targetChange).targetIds&&e.targetIds.length||!e.readTime?Kr.min():ko(e.readTime);return this.listener.Or(n,t)},Qa.prototype.kr=function(t){var e,n,r,i,o,s,u,a,h={};h.database=xo(this.serializer),h.addTarget=(e=this.serializer,(r=yi(r=(n=t).target)?{documents:{documents:[Co(e,r.path)]}}:{query:(i=e,s={structuredQuery:{}},u=(o=r).path,null!==o.collectionGroup?(s.parent=Co(i,u),s.structuredQuery.from=[{collectionId:o.collectionGroup,allDescendants:!0}]):(s.parent=Co(i,u.N()),s.structuredQuery.from=[{collectionId:u.k()}]),(u=function(t){if(0!==t.length)return 1===(t=t.map(function(t){if("=="===t.op){if(Eo(t.value))return{unaryFilter:{field:jo(t.field),op:"IS_NAN"}};if(bo(t.value))return{unaryFilter:{field:jo(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Eo(t.value))return{unaryFilter:{field:jo(t.field),op:"IS_NOT_NAN"}};if(bo(t.value))return{unaryFilter:{field:jo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:jo(t.field),op:(e=t.op,Ao[e]),value:t.value}};var e})).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(o.filters))&&(s.structuredQuery.where=u),(u=function(t){if(0!==t.length)return t.map(function(t){return{field:jo(t.field),direction:(t=t.dir,To[t])}})}(o.orderBy))&&(s.structuredQuery.orderBy=u),u=o.limit,null!==(u=i.Wn||hi(u)?u:{value:u})&&(s.structuredQuery.limit=u),o.startAt&&(s.structuredQuery.startAt=qo(o.startAt)),o.endAt&&(s.structuredQuery.endAt=qo(o.endAt)),s)}).targetId=n.targetId,0<n.resumeToken.o()&&(r.resumeToken=Ro(e,n.resumeToken)),r),(t=(this.serializer,a=t,null==(t=function(){switch(a.nt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Or()}}())?null:{"goog-listen-tags":t}))&&(h.labels=t),this.Vr(h)},Qa.prototype.$r=function(t){var e={};e.database=xo(this.serializer),e.removeTarget=t,this.Vr(e)},Qa),Ba=(n(Xa,qa=l),Object.defineProperty(Xa.prototype,"Lr",{get:function(){return this.Mr},enumerable:!1,configurable:!0}),Xa.prototype.start=function(){this.Mr=!1,this.lastStreamToken=void 0,qa.prototype.start.call(this)},Xa.prototype.pr=function(){this.Mr&&this.qr([])},Xa.prototype.Dr=function(t){return this.dr.Nr("Write",t)},Xa.prototype.onMessage=function(t){if(Sr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Mr){this.Xe.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Sr(void 0!==r),n.map(function(t){return n=r,(t=(e=t).updateTime?ko(e.updateTime):ko(n)).isEqual(Kr.min())&&(t=ko(n)),n=null,e.transformResults&&0<e.transformResults.length&&(n=e.transformResults),new as(t,n);var e,n})):[]),n=ko(t.commitTime);return this.listener.Ur(n,e)}var r;return Sr(!t.writeResults||0===t.writeResults.length),this.Mr=!0,this.listener.Br()},Xa.prototype.jr=function(){var t={};t.database=xo(this.serializer),this.Vr(t)},Xa.prototype.qr=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return Mo(e.serializer,t)})};this.Vr(t)},Xa),Ga=(n(za,Ma=function(){}),za.prototype.Qr=function(){if(this.Wr)throw new mr(gr.FAILED_PRECONDITION,"The client has already been terminated.")},za.prototype.Kr=function(e,n,r){var i=this;return this.Qr(),this.credentials.getToken().then(function(t){return i.dr.Kr(e,n,r,t)}).catch(function(t){throw t.code===gr.UNAUTHENTICATED&&i.credentials.ks(),t})},za.prototype.Gr=function(e,n,r){var i=this;return this.Qr(),this.credentials.getToken().then(function(t){return i.dr.Gr(e,n,r,t)}).catch(function(t){throw t.code===gr.UNAUTHENTICATED&&i.credentials.ks(),t})},za.prototype.terminate=function(){this.Wr=!1},za),Wa=(Ha.prototype.Xr=function(){var t=this;0===this.zr&&(this.Zr("Unknown"),this.Yr=this.$e.Ve("online_state_timeout",1e4,function(){return t.Yr=null,t.no("Backend didn't respond within 10 seconds."),t.Zr("Offline"),Promise.resolve()}))},Ha.prototype.eo=function(t){"Online"===this.state?this.Zr("Unknown"):(this.zr++,1<=this.zr&&(this.so(),this.no("Connection failed 1 times. Most recent error: "+t.toString()),this.Zr("Offline")))},Ha.prototype.set=function(t){this.so(),this.zr=0,"Online"===t&&(this.Jr=!1),this.Zr(t)},Ha.prototype.Zr=function(t){t!==this.state&&(this.state=t,this.Hr(t))},Ha.prototype.no=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.Jr?(Tr(t),this.Jr=!1):Ir("OnlineStateTracker",t)},Ha.prototype.so=function(){null!==this.Yr&&(this.Yr.cancel(),this.Yr=null)},Ha);function Ha(t,e){this.$e=t,this.Hr=e,this.state="Unknown",this.zr=0,this.Yr=null,this.Jr=!0}function za(t,e,n){var r=this;return(r=Ma.call(this)||this).credentials=t,r.dr=e,r.serializer=n,r.Wr=!1,r}function Xa(t,e,n,r,i){var o=this;return(o=qa.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Mr=!1,o}function Qa(t,e,n,r,i){var o=this;return(o=ja.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function $a(t,e,n,r,i,o){this.fe=t,this._r=n,this.dr=r,this.wr=i,this.listener=o,this.state=0,this.Er=0,this.mr=null,this.stream=null,this.Xe=new qu(t,e)}function Ya(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!ih(r))return[3,4];e=0,n=r.ao,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Ka(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.ao,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Za(t,e){t.co.has(e.targetId)||(t.co.set(e.targetId,e),rh(t)?nh(t):lh(t).Ir()&&th(t,e))}function Ja(t,e){var n=t,t=lh(n);n.co.delete(e),t.Ir()&&eh(n,e),0===n.co.size&&(t.Ir()?t.Pr():ih(n)&&n.fo.set("Unknown"))}function th(t,e){t.do.An(e.targetId),lh(t).kr(e)}function eh(t,e){t.do.An(e),lh(t).$r(e)}function nh(e){e.do=new Qi({Bn:function(t){return e.oo.Bn(t)},jn:function(t){return e.co.get(t)||null}}),lh(e).start(),e.fo.Xr()}function rh(t){return ih(t)&&!lh(t).Tr()&&0<t.co.size}function ih(t){return 0===t.ho.size}function oh(t){t.do=void 0}function sh(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!Gu(r))throw r;return n.ho.add(1),[4,Ka(n)];case 1:return t.sent(),n.fo.set("Offline"),i=i||function(){return _a(n.io)},n.$e.os(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Ir("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.ho.delete(1),[4,Ya(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function uh(e,n){return n().catch(function(t){return sh(e,t,n)})}function ah(h){return y(this,void 0,void 0,function(){var o,s,u,a;return v(this,function(t){switch(t.label){case 0:s=fh(o=h),u=0<o.uo.length?o.uo[o.uo.length-1].batchId:-1,t.label=1;case 1:if(!(ih(o)&&o.uo.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(n=o.io,r=u,(i=n).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===r&&(r=-1),i.Zs.cr(t,r)}))];case 3:return null===(a=t.sent())?(0===o.uo.length&&s.Pr(),[3,7]):(u=a.batchId,e=a,(n=o).uo.push(e),(n=fh(n)).Ir()&&n.Lr&&n.qr(e.mutations),[3,6]);case 4:return a=t.sent(),[4,sh(o,a)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return hh(o)&&ch(o),[2]}var e,n,r,i})})}function hh(t){return ih(t)&&!fh(t).Tr()&&0<t.uo.length}function ch(t){fh(t).start()}function lh(n){var t,e,r,i=this;return n.Io||(n.Io=(t=n.ro,e=n.$e,r={Fr:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.co.forEach(function(t,e){th(n,t)}),[2]})})}.bind(null,n),vr:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return oh(e),rh(e)?(e.fo.eo(n),nh(e)):e.fo.set("Unknown"),[2]})})}.bind(null,n),Or:function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.fo.set("Online"),!(u instanceof zi&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.co.has(i)?[4,o.oo.wo(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.co.delete(i),o.do.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Ir("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,sh(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof Wi?s.do.bn(u):u instanceof Hi?s.do.kn(u):s.do.Dn(u),a.isEqual(Kr.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,_a(s.io)];case 8:return o=t.sent(),0<=a.u(o)?[4,(i=a,(e=(r=s).do.Ln(i)).Ht.forEach(function(t,e){var n;0<t.resumeToken.o()&&(n=r.co.get(e))&&r.co.set(e,n.it(t.resumeToken,i))}),e.zt.forEach(function(t){var e=r.co.get(t);e&&(r.co.set(t,e.it(Dr.h,e.et)),eh(r,t),e=new mi(e.target,t,1,e.sequenceNumber),th(r,e))}),r.oo.Eo(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Ir("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,sh(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n)},t.Qr(),new Fa(e,t.dr,t.credentials,t.serializer,r)),n.ao.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Io.Rr(),rh(n)?nh(n):n.fo.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.Io.stop()];case 2:t.sent(),oh(n),t.label=3;case 3:return[2]}})})})),n.Io}function fh(n){var t,e,r,i=this;return n.Ao||(n.Ao=(t=n.ro,e=n.$e,r={Fr:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return fh(e).jr(),[2]})})}.bind(null,n),vr:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&fh(e).Lr?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return bi(n=i.code)&&n!==gr.ABORTED?(e=r.uo.shift(),fh(r).Rr(),[4,uh(r,function(){return r.oo.To(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,ah(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return hh(e)&&ch(e),[2]}})})}.bind(null,n),Br:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=fh(o),n=0,r=o.uo;n<r.length;n++)i=r[n],e.qr(i.mutations);return[2]})})}.bind(null,n),Ur:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.uo.shift(),n=la.from(e,i,o),[4,uh(r,function(){return r.oo.mo(n)})];case 1:return t.sent(),[4,ah(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Qr(),new Ba(e,t.dr,t.credentials,t.serializer,r)),n.ao.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Ao.Rr(),[4,ah(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.Ao.stop()];case 3:t.sent(),0<n.uo.length&&(Ir("RemoteStore","Stopping write stream with "+n.uo.length+" pending writes"),n.uo=[]),t.label=4;case 4:return[2]}})})})),n.Ao}var ph=(Ph.prototype.P=function(){return this.Ro.P()},Ph.prototype.po=function(t,e){e=new dh(t,e),this.Ro=this.Ro.add(e),this.yo=this.yo.add(e)},Ph.prototype.vo=function(t,e){var n=this;t.forEach(function(t){return n.po(t,e)})},Ph.prototype.bo=function(t,e){this.Co(new dh(t,e))},Ph.prototype.So=function(t,e){var n=this;t.forEach(function(t){return n.bo(t,e)})},Ph.prototype.Do=function(t){var e=this,n=new ei(new Zr([])),r=new dh(n,t),t=new dh(n,t+1),i=[];return this.yo.Nt([r,t],function(t){e.Co(t),i.push(t.key)}),i},Ph.prototype.Fo=function(){var e=this;this.Ro.forEach(function(t){return e.Co(t)})},Ph.prototype.Co=function(t){this.Ro=this.Ro.delete(t),this.yo=this.yo.delete(t)},Ph.prototype.No=function(t){var e=new ei(new Zr([])),n=new dh(e,t),t=new dh(e,t+1),r=Ui();return this.yo.Nt([n,t],function(t){r=r.add(t.key)}),r},Ph.prototype.xo=function(t){var e=new dh(t,0);return null!==(e=this.Ro.Ot(e))&&t.isEqual(e.key)},Ph),dh=(Sh.Po=function(t,e){return ei.S(t.key,e.key)||Rr(t.Oo,e.Oo)},Sh.Vo=function(t,e){return Rr(t.Oo,e.Oo)||ei.S(t.key,e.key)},Sh),yh=(Oh.prototype.ko=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Oh.prototype.$o=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Oh.prototype.Mo=function(){var t={activeTargetIds:this.activeTargetIds.L(),updateTimeMs:Date.now()};return JSON.stringify(t)},Oh),vh=(Nh.prototype.Uo=function(t){},Nh.prototype.Bo=function(t,e,n){},Nh.prototype.jo=function(t){return this.Lo.ko(t),this.qo[t]||"not-current"},Nh.prototype.Wo=function(t,e,n){this.qo[t]=e},Nh.prototype.Qo=function(t){this.Lo.$o(t)},Nh.prototype.Ko=function(t){return this.Lo.activeTargetIds.has(t)},Nh.prototype.Go=function(t){delete this.qo[t]},Nh.prototype.Ho=function(){return this.Lo.activeTargetIds},Nh.prototype.zo=function(t){return this.Lo.activeTargetIds.has(t)},Nh.prototype.start=function(){return this.Lo=new yh,Promise.resolve()},Nh.prototype.Yo=function(t,e,n){},Nh.prototype.Jo=function(t){},Nh.prototype.Xo=function(){},Nh.prototype.Pi=function(t){},Nh),gh=function(t){this.key=t},mh=function(t){this.key=t},wh=(Object.defineProperty(Ah.prototype,"iu",{get:function(){return this.Zo},enumerable:!1,configurable:!0}),Ah.prototype.ru=function(t,e){var s=this,u=e?e.ou:new ji,a=(e||this).su,h=(e||this).Wt,c=a,l=!1,f=Xs(this.query)&&a.size===this.query.limit?a.last():null,p=Qs(this.query)&&a.size===this.query.limit?a.first():null;if(t.at(function(t,e){var n=a.get(t),r=(r=e instanceof qs?e:null)&&(su(s.query,r)?r:null),i=!!n&&s.Wt.has(n.key),o=!!r&&(r.Xn||s.Wt.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.uu(n,r)||(u.track({type:2,doc:r}),e=!0,(f&&0<s.eu(r,f)||p&&s.eu(r,p)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(h=r?(c=c.add(r),o?h.add(t):h.delete(t)):(c=c.delete(t),h.delete(t)))}),Xs(this.query)||Qs(this.query))for(;c.size>this.query.limit;){var n=Xs(this.query)?c.last():c.first(),c=c.delete(n.key),h=h.delete(n.key);u.track({type:1,doc:n})}return{su:c,ou:u,cu:l,Wt:h}},Ah.prototype.uu=function(t,e){return t.Xn&&e.hasCommittedMutations&&!e.Xn},Ah.prototype.hu=function(t,e,n){var o=this,r=this.su;this.su=t.su,this.Wt=t.Wt;var i=t.ou.Bt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.eu(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Or()}}var r,i}),this.au(n);var s=e?this.lu():[],e=(n=0===this.nu.size&&this.tn?1:0)!==this.tu;return this.tu=n,0!==i.length||e?{snapshot:new Fi(this.query,t.su,r,i,t.Wt,0==n,e,!1),_u:s}:{_u:s}},Ah.prototype.As=function(t){return this.tn&&"Offline"===t?(this.tn=!1,this.hu({su:this.su,ou:new ji,Wt:this.Wt,cu:!1},!1)):{_u:[]}},Ah.prototype.fu=function(t){return!this.Zo.has(t)&&!!this.su.has(t)&&!this.su.get(t).Xn},Ah.prototype.au=function(t){var e=this;t&&(t.nn.forEach(function(t){return e.Zo=e.Zo.add(t)}),t.en.forEach(function(t){}),t.sn.forEach(function(t){return e.Zo=e.Zo.delete(t)}),this.tn=t.tn)},Ah.prototype.lu=function(){var e=this;if(!this.tn)return[];var n=this.nu;this.nu=Ui(),this.su.forEach(function(t){e.fu(t.key)&&(e.nu=e.nu.add(t.key))});var r=[];return n.forEach(function(t){e.nu.has(t)||r.push(new mh(t))}),this.nu.forEach(function(t){n.has(t)||r.push(new gh(t))}),r},Ah.prototype.du=function(t){return this.Zo=t.lr,this.nu=Ui(),t=this.ru(t.documents),this.hu(t,!0)},Ah.prototype.wu=function(){return Fi.Gt(this.query,this.su,this.Wt,0===this.tu)},Ah),bh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Eh=function(t){this.key=t,this.Eu=!1},Ih=(Object.defineProperty(Th.prototype,"Fu",{get:function(){return!0===this.Du},enumerable:!1,configurable:!0}),Th);function Th(t,e,n,r,i,o){this.io=t,this.mu=e,this.Tu=n,this.Iu=r,this.currentUser=i,this.Au=o,this.Ru={},this.Pu=new $r(iu,ru),this.yu=new Map,this.Vu=[],this.gu=new Ii(ei.S),this.pu=new Map,this.vu=new ph,this.bu={},this.Cu=new Map,this.Su=Oa.bi(),this.onlineState="Unknown",this.Du=void 0}function Ah(t,e){this.query=t,this.Zo=e,this.tu=null,this.tn=!1,this.nu=Ui(),this.Wt=Ui(),this.eu=uu(t),this.su=new qi(this.eu)}function Nh(){this.Lo=new yh,this.qo={},this.Hr=null,this.Ii=null}function Oh(){this.activeTargetIds=Mi}function Sh(t,e){this.key=t,this.Oo=e}function Ph(){this.Ro=new Li(dh.Po),this.yo=new Li(dh.Vo)}function Lh(f,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:(o=f).mu.oo.mo=function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.io,c=s,(l=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=c.batch.keys(),n=l.xi.Gi({Hi:!0}),i=l,o=t,s=n,u=(r=c).batch,a=u.keys(),h=ju.resolve();return a.forEach(function(n){h=h.next(function(){return s.ii(o,n)}).next(function(t){var e=t;Sr(null!==(t=r.Js.get(n))),(!e||e.version.u(t)<0)&&(e=u.Ks(n,e,r))&&s.zi(e,r.Ys)})}),h.next(function(){return i.Zs.Yi(o,u)}).next(function(){return n.apply(t)}).next(function(){return l.Zs.Ji(t)}).next(function(){return l.Mi.oi(t,e)})}))];case 2:return i=t.sent(),Vh(n,r,null),_h(n,r),n.Iu.Bo(r,"acknowledged"),[4,qh(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,xa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,c,l})})}.bind(null,o),o.mu.oo.To=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.io,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Zs.Lu(e,r).next(function(t){return Sr(null!==t),n=t.keys(),i.Zs.Yi(e,t)}).next(function(){return i.Zs.Ji(e)}).next(function(){return i.Mi.oi(e,n)})}))];case 2:return o=t.sent(),Vh(n,u,a),_h(n,u),n.Iu.Bo(u,"rejected",a),[4,qh(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,xa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.io,a=p,c=r,l=Yr.now(),i=a.reduce(function(t,e){return t.add(e.key)},Ui()),c.persistence.runTransaction("Locally write mutations","readwrite",function(u){return c.Mi.oi(u,i).next(function(t){h=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=h.get(i.key),s instanceof Ts?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof qs?t.field(i.field):void 0;null!=(o=Bo(i.transform,o||null))&&(e=(null==e?new ks:e).set(i.field,o))}return e?e.Zn():null}(o):null);null!=o&&e.push(new ms(i.key,o,function s(t){var u=[];return Hr(t.fields||{},function(t,e){var n=new ti([t]);if(Io(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new ss(u)}(o.proto.mapValue),hs.exists(!0)))}return c.Zs.$u(u,l,e,a)})}).then(function(t){var e=t.zs(h);return{batchId:t.batchId,Mu:e}}))];case 2:return s=t.sent(),u.Iu.Uo(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.bu[e.currentUser.Ds()])||new Ii(Rr)).ot(n,o),e.bu[e.currentUser.Ds()]=r,[4,qh(u,s.Mu)];case 3:return t.sent(),[4,ah(u.mu)];case 4:return t.sent(),[3,6];case 5:return u=$u(u=t.sent(),"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,h,c,l,i,o})})}function Rh(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:n=i,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.io,h=e,c=(a=o).et,l=h.Si,h.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var i=h.xi.Gi({Hi:!0});l=h.Si;var u=[];a.Ht.forEach(function(t,e){var n,r,i,o=l.get(e);o&&(u.push(h.ki.Zi(s,t.sn,e).next(function(){return h.ki.tr(s,t.nn,e)})),0<(i=t.resumeToken).o()&&(n=o.it(i,c).st(s.nr),l=l.ot(e,n),r=o,i=t,Sr(0<(o=n).resumeToken.o()),(0===r.resumeToken.o()||3e8<=o.et.p()-r.et.p()||0<i.nn.size+i.en.size+i.sn.size)&&u.push(h.ki.er(s,n))))});var t,o=ki,n=Ui();return a.Yt.forEach(function(t,e){n=n.add(t)}),u.push(i.getEntries(s,n).next(function(r){a.Yt.forEach(function(t,e){var n=r.get(t);e instanceof js&&e.version.isEqual(Kr.min())?(i.sr(t,c),o=o.ot(t,e)):null==n||0<e.version.u(n.version)||0===e.version.u(n.version)&&n.hasPendingWrites?(i.zi(e,c),o=o.ot(t,e)):Ir("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Jt.has(t)&&u.push(h.persistence.rr.ir(s,t))})})),c.isEqual(Kr.min())||(t=h.ki.Xi(s).next(function(t){return h.ki.ur(s,s.nr,c)}),u.push(t)),ju.Oe(u).next(function(){return i.apply(s)}).next(function(){return h.Mi.ui(s,o)})}).then(function(t){return h.Si=l,t}))];case 2:return r=t.sent(),o.Ht.forEach(function(t,e){(e=n.pu.get(e))&&(Sr(t.nn.size+t.en.size+t.sn.size<=1),0<t.nn.size?e.Eu=!0:0<t.en.size?Sr(e.Eu):0<t.sn.size&&(Sr(e.Eu),e.Eu=!1))}),[4,qh(n,r,o)];case 3:return t.sent(),[3,6];case 4:return[4,xa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,a,h,c,l})})}function kh(t,n,e){var r;((t=t).Fu&&0===e||!t.Fu&&1===e)&&(r=[],t.Pu.forEach(function(t,e){(e=e.view.As(n)).snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.Es.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].As(i)&&(o=!0)}),o&&ta(t)}(t.Tu,n),r.length&&t.Ru.Or(r),t.onlineState=n,t.Fu&&t.Iu.Jo(n))}function Dh(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:ih((n=o).mu)||Ir("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.io).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Zs.qu(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Cu.get(r)||[]).push(s),n.Cu.set(r,i),[3,4]);case 3:return i=$u(i=t.sent(),"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function _h(t,e){(t.Cu.get(e)||[]).forEach(function(t){t.resolve()}),t.Cu.delete(e)}function Vh(t,e,n){var r=t,i=r.bu[r.currentUser.Ds()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.bu[r.currentUser.Ds()]=i)}function Ch(e,t,n){void 0===n&&(n=null),e.Iu.Qo(t);for(var r=0,i=e.yu.get(t);r<i.length;r++){var o=i[r];e.Pu.delete(o),n&&e.Ru.Nu(o,n)}e.yu.delete(t),e.Fu&&e.vu.Do(t).forEach(function(t){e.vu.xo(t)||xh(e,t)})}function xh(t,e){var n=t.gu.get(e);null!==n&&(Ja(t.mu,n),t.gu=t.gu.remove(e),t.pu.delete(n),Mh(t))}function Uh(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var u=s[o];u instanceof gh?(t.vu.po(u.key,e),r=t,i=(i=u).key,r.gu.get(i)||(Ir("SyncEngine","New document in limbo: "+i),r.Vu.push(i),Mh(r))):u instanceof mh?(Ir("SyncEngine","Document no longer in limbo: "+u.key),t.vu.bo(u.key,e),t.vu.xo(u.key)||xh(t,u.key)):Or()}}function Mh(t){for(;0<t.Vu.length&&t.gu.size<t.Au;){var e=t.Vu.shift(),n=t.Su.next();t.pu.set(n,new Eh(e)),t.gu=t.gu.ot(e,n),Za(t.mu,new mi(Js(zs(e.path)),n,2,da.yi))}}function qh(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Pu.P()?[3,3]:(n.Pu.forEach(function(t,e){o.push(n.ku(e,s,u).then(function(t){t&&(n.Fu&&n.Iu.Wo(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=pa.Ti(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.Ru.Or(r),[4,function(a,h){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return ju.forEach(h,function(e){return ju.forEach(e.Ei,function(t){return r.persistence.rr.po(n,e.targetId,t)}).next(function(){return ju.forEach(e.mi,function(t){return r.persistence.rr.bo(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Gu(e=t.sent()))throw e;return Ir("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=h;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.Si.get(o),u=s.et,u=s.rt(u),r.Si=r.Si.ot(o,u));return[2]}})})}(n.io,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}var jh,Fh,Bh,Gh=(vc.prototype.qi=function(t){this.Uu=t},vc.prototype.hi=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.oe.length||1===r.oe.length&&r.oe[0].field.W())||i.isEqual(Kr.min())?this.Bu(e,r):this.Uu.oi(e,o).next(function(t){var n=s.ju(r,t);return(Xs(r)||Qs(r))&&s.cu(r.ue,n,o,i)?s.Bu(e,r):(Er()<=u.DEBUG&&Ir("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ou(r)),s.Uu.hi(e,r,i).next(function(e){return n.forEach(function(t){e=e.ot(t.key,t)}),e}))})},vc.prototype.ju=function(n,t){var r=new Li(uu(n));return t.forEach(function(t,e){e instanceof qs&&su(n,e)&&(r=r.add(e))}),r},vc.prototype.cu=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version.u(r))},vc.prototype.Bu=function(t,e){return Er()<=u.DEBUG&&Ir("IndexFreeQueryEngine","Using full collection scan to execute query:",ou(e)),this.Uu.hi(t,e,Kr.min())},vc),Wh=(yc.prototype.Ku=function(t){return ju.resolve(0===this.Zs.length)},yc.prototype.$u=function(t,e,n,r){var i=this.Wu;this.Wu++,0<this.Zs.length&&this.Zs[this.Zs.length-1],n=new ca(i,e,n,r),this.Zs.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Qu=this.Qu.add(new dh(u.key,i)),this.ti.gi(t,u.key.path.N())}return ju.resolve(n)},yc.prototype.Lu=function(t,e){return ju.resolve(this.Gu(e))},yc.prototype.cr=function(t,e){return e+=1,e=(e=this.Hu(e))<0?0:e,ju.resolve(this.Zs.length>e?this.Zs[e]:null)},yc.prototype.qu=function(){return ju.resolve(0===this.Zs.length?-1:this.Wu-1)},yc.prototype.ji=function(t){return ju.resolve(this.Zs.slice())},yc.prototype.ei=function(t,e){var n=this,r=new dh(e,0),e=new dh(e,Number.POSITIVE_INFINITY),i=[];return this.Qu.Nt([r,e],function(t){t=n.Gu(t.Oo),i.push(t)}),ju.resolve(i)},yc.prototype.ci=function(t,e){var n=this,r=new Li(Rr);return e.forEach(function(t){var e=new dh(t,0),t=new dh(t,Number.POSITIVE_INFINITY);n.Qu.Nt([e,t],function(t){r=r.add(t.Oo)})}),ju.resolve(this.zu(r))},yc.prototype.di=function(t,e){var n=e.path,r=n.length+1,e=n;ei.X(e)||(e=e.child(""));var e=new dh(new ei(e),0),i=new Li(Rr);return this.Qu.xt(function(t){var e=t.key.path;return!!n.$(e)&&(e.length===r&&(i=i.add(t.Oo)),!0)},e),ju.resolve(this.zu(i))},yc.prototype.zu=function(t){var e=this,n=[];return t.forEach(function(t){null!==(t=e.Gu(t))&&n.push(t)}),n},yc.prototype.Yi=function(n,r){var i=this;Sr(0===this.Yu(r.batchId,"removed")),this.Zs.shift();var o=this.Qu;return ju.forEach(r.mutations,function(t){var e=new dh(t.key,r.batchId);return o=o.delete(e),i.rr.Ju(n,t.key)}).next(function(){i.Qu=o})},yc.prototype.Xu=function(t){},yc.prototype.xo=function(t,e){var n=new dh(e,0),n=this.Qu.Ot(n);return ju.resolve(e.isEqual(n&&n.key))},yc.prototype.Ji=function(t){return this.Zs.length,ju.resolve()},yc.prototype.Yu=function(t,e){return this.Hu(t)},yc.prototype.Hu=function(t){return 0===this.Zs.length?0:t-this.Zs[0].batchId},yc.prototype.Gu=function(t){return(t=this.Hu(t))<0||t>=this.Zs.length?null:this.Zs[t]},yc),Hh=(dc.prototype.zi=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this.Zu(e);return this.docs=this.docs.ot(r,{tc:e,size:o,readTime:n}),this.size+=o-i,this.ti.gi(t,r.path.N())},dc.prototype.sr=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},dc.prototype.ii=function(t,e){return e=this.docs.get(e),ju.resolve(e?e.tc:null)},dc.prototype.getEntries=function(t,e){var n=this,r=ki;return e.forEach(function(t){var e=n.docs.get(t);r=r.ot(t,e?e.tc:null)}),ju.resolve(r)},dc.prototype.hi=function(t,e,n){for(var r=Vi,i=new ei(e.path.child("")),o=this.docs.ft(i);o.At();){var s=(u=o.It()).key,u=(a=u.value).tc,a=a.readTime;if(!e.path.$(s.path))break;a.u(n)<=0||u instanceof qs&&su(e,u)&&(r=r.ot(u.key,u))}return ju.resolve(r)},dc.prototype.nc=function(t,e){return ju.forEach(this.docs,function(t){return e(t)})},dc.prototype.Gi=function(t){return new zh(this)},dc.prototype.ec=function(t){return ju.resolve(this.size)},dc),zh=(Object.defineProperty(pc.prototype,"readTime",{get:function(){return this.ic},set:function(t){this.ic=t},enumerable:!1,configurable:!0}),pc.prototype.zi=function(t,e){this.rc(),this.readTime=e,this.Mu.set(t.key,t)},pc.prototype.sr=function(t,e){this.rc(),e&&(this.readTime=e),this.Mu.set(t,null)},pc.prototype.ii=function(t,e){this.rc();var n=this.Mu.get(e);return void 0!==n?ju.resolve(n):this.oc(t,e)},pc.prototype.getEntries=function(t,e){return this.uc(t,e)},pc.prototype.apply=function(t){return this.rc(),this.sc=!0,this.hu(t)},pc.prototype.rc=function(){},n(fc,Bh=pc),fc.prototype.hu=function(n){var r=this,i=[];return this.Mu.forEach(function(t,e){e?i.push(r.cc.zi(n,e,r.readTime)):r.cc.sr(t)}),ju.Oe(i)},fc.prototype.oc=function(t,e){return this.cc.ii(t,e)},fc.prototype.uc=function(t,e){return this.cc.getEntries(t,e)},fc),Xh=(lc.prototype.Fn=function(t,n){return this.hc.forEach(function(t,e){return n(e)}),ju.resolve()},lc.prototype.Xi=function(t){return ju.resolve(this.lastRemoteSnapshotVersion)},lc.prototype.fc=function(t){return ju.resolve(this.ac)},lc.prototype.xu=function(t){return this.highestTargetId=this._c.next(),ju.resolve(this.highestTargetId)},lc.prototype.ur=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ac&&(this.ac=e),ju.resolve()},lc.prototype.dc=function(t){this.hc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this._c=new Oa(e),this.highestTargetId=e),t.sequenceNumber>this.ac&&(this.ac=t.sequenceNumber)},lc.prototype.Ou=function(t,e){return this.dc(e),this.targetCount+=1,ju.resolve()},lc.prototype.er=function(t,e){return this.dc(e),ju.resolve()},lc.prototype.wc=function(t,e){return this.hc.delete(e.target),this.lc.Do(e.targetId),--this.targetCount,ju.resolve()},lc.prototype.Ec=function(n,r,i){var o=this,s=0,u=[];return this.hc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.hc.delete(t),u.push(o.mc(n,e.targetId)),s++)}),ju.Oe(u).next(function(){return s})},lc.prototype.Tc=function(t){return ju.resolve(this.targetCount)},lc.prototype.hr=function(t,e){return e=this.hc.get(e)||null,ju.resolve(e)},lc.prototype.tr=function(t,e,n){return this.lc.vo(e,n),ju.resolve()},lc.prototype.Zi=function(e,t,n){this.lc.So(t,n);var r=this.persistence.rr,i=[];return r&&t.forEach(function(t){i.push(r.Ju(e,t))}),ju.Oe(i)},lc.prototype.mc=function(t,e){return this.lc.Do(e),ju.resolve()},lc.prototype.ar=function(t,e){return e=this.lc.No(e),ju.resolve(e)},lc.prototype.xo=function(t,e){return ju.resolve(this.lc.xo(e))},lc),Qh=(cc.prototype.start=function(){return Promise.resolve()},cc.prototype.Xo=function(){return this.Rc=!1,Promise.resolve()},Object.defineProperty(cc.prototype,"yc",{get:function(){return this.Rc},enumerable:!1,configurable:!0}),cc.prototype.Vc=function(){},cc.prototype.gc=function(){},cc.prototype.Li=function(){return this.ti},cc.prototype.Ni=function(t){var e=this.Ic[t.Ds()];return e||(e=new Wh(this.ti,this.rr),this.Ic[t.Ds()]=e),e},cc.prototype.$i=function(){return this.ki},cc.prototype.Oi=function(){return this.Xs},cc.prototype.runTransaction=function(t,e,n){var r=this;Ir("MemoryPersistence","Starting transaction:",t);var i=new $h(this.Ac.next());return this.rr.vc(),n(i).next(function(t){return r.rr.bc(i).next(function(){return t})}).Ne().then(function(t){return i.Cc(),t})},cc.prototype.Sc=function(e,n){return ju.ke(Object.values(this.Ic).map(function(t){return function(){return t.xo(e,n)}}))},cc),$h=(hc.prototype.Fc=function(t){this.Dc.push(t)},hc.prototype.Cc=function(){this.Dc.forEach(function(t){return t()})},n(ac,Fh=hc),ac),Yh=(uc.Oc=function(t){return new uc(t)},Object.defineProperty(uc.prototype,"kc",{get:function(){if(this.xc)return this.xc;throw Or()},enumerable:!1,configurable:!0}),uc.prototype.po=function(t,e,n){return this.Nc.po(n,e),this.kc.delete(n.toString()),ju.resolve()},uc.prototype.bo=function(t,e,n){return this.Nc.bo(n,e),this.kc.add(n.toString()),ju.resolve()},uc.prototype.Ju=function(t,e){return this.kc.add(e.toString()),ju.resolve()},uc.prototype.removeTarget=function(t,e){var n=this;this.Nc.Do(e.targetId).forEach(function(t){return n.kc.add(t.toString())});var r=this.persistence.$i();return r.ar(t,e.targetId).next(function(t){t.forEach(function(t){return n.kc.add(t.toString())})}).next(function(){return r.wc(t,e)})},uc.prototype.vc=function(){this.xc=new Set},uc.prototype.bc=function(n){var r=this,i=this.persistence.Oi().Gi();return ju.forEach(this.kc,function(t){var e=ei.H(t);return r.$c(n,e).next(function(t){t||i.sr(e)})}).next(function(){return r.xc=null,i.apply(n)})},uc.prototype.ir=function(t,e){var n=this;return this.$c(t,e).next(function(t){t?n.kc.delete(e.toString()):n.kc.add(e.toString())})},uc.prototype.Pc=function(t){return 0},uc.prototype.$c=function(t,e){var n=this;return ju.ke([function(){return ju.resolve(n.Nc.xo(e))},function(){return n.persistence.$i().xo(t,e)},function(){return n.persistence.Sc(t,e)}])},uc),Kh=(sc.prototype.Fr=function(t){this.qc=t},sc.prototype.vr=function(t){this.Uc=t},sc.prototype.onMessage=function(t){this.Bc=t},sc.prototype.close=function(){this.Lc()},sc.prototype.send=function(t){this.Mc(t)},sc.prototype.jc=function(){this.qc()},sc.prototype.Wc=function(t){this.Uc(t)},sc.prototype.Qc=function(t){this.Bc(t)},sc),Zh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Jh=(oc.prototype.Kr=function(e,t,n,r){var i=this.zc(e,t);return Ir("RestConnection","Sending: ",i,n),t={},this.Yc(t,r),this.Jc(e,i,t,n).then(function(t){return Ir("RestConnection","Received: ",t),t},function(t){throw Ar("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},oc.prototype.Gr=function(t,e,n,r){return this.Kr(t,e,n,r)},oc.prototype.Yc=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.0.1",t["Content-Type"]="text/plain",e)for(var n in e.xs)e.xs.hasOwnProperty(n)&&(t[n]=e.xs[n])},oc.prototype.zc=function(t,e){return t=Zh[t],this.Gc+"/v1/"+e+":"+t},n(ic,jh=oc),ic.prototype.Jc=function(o,e,s,u){return new Promise(function(n,r){var i=new dr;i.listenOnce(fr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case lr.NO_ERROR:var t=i.getResponseJson();Ir("Connection","XHR received:",JSON.stringify(t)),n(t);break;case lr.TIMEOUT:Ir("Connection",'RPC "'+o+'" timed out'),r(new mr(gr.DEADLINE_EXCEEDED,"Request time out"));break;case lr.HTTP_ERROR:var e=i.getStatus();Ir("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(gr).indexOf(e)?e:gr.UNKNOWN,r(new mr(e,t.message))):r(new mr(gr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new mr(gr.UNAVAILABLE,"Connection failed."));break;default:Or()}}finally{Ir("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},ic.prototype.Nr=function(t,e){var n,r=[this.Gc,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new sr,t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this._.projectId+"/databases/"+this._.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.m};this.Yc(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),Ir("Connection","Creating WebChannel: "+(r=r.join("")),t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new Kh({Mc:function(t){u?Ir("Connection","Not sending because WebChannel is closed:",t):(s||(Ir("Connection","Opening WebChannel transport."),o.open(),s=!0),Ir("Connection","WebChannel sending:",t),o.send(t))},Lc:function(){return o.close()}});return(t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})})(pr.EventType.OPEN,function(){u||Ir("Connection","WebChannel transport opened.")}),t(pr.EventType.CLOSE,function(){u||(u=!0,Ir("Connection","WebChannel transport closed"),a.Wc())}),t(pr.EventType.ERROR,function(t){u||(u=!0,Ar("Connection","WebChannel transport errored:",t),a.Wc(new mr(gr.UNAVAILABLE,"The operation could not be completed")))}),t(pr.EventType.MESSAGE,function(t){var e,n,r,i;u||(Sr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Ir("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=gi[r];if(void 0!==t)return Ei(t)}(),i=n.message,void 0===t&&(t=gr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.Wc(new mr(t,i)),o.close()):(Ir("Connection","WebChannel received:",e),a.Qc(e)))}),setTimeout(function(){a.jc()},0),a},ic),tc=(rc.prototype._o=function(t){this.eh.push(t)},rc.prototype.Xo=function(){window.removeEventListener("online",this.Xc),window.removeEventListener("offline",this.th)},rc.prototype.sh=function(){window.addEventListener("online",this.Xc),window.addEventListener("offline",this.th)},rc.prototype.Zc=function(){Ir("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.eh;t<e.length;t++)(0,e[t])(0)},rc.prototype.nh=function(){Ir("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.eh;t<e.length;t++)(0,e[t])(1)},rc.ih=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},rc),ec=(nc.prototype._o=function(t){},nc.prototype.Xo=function(){},nc);function nc(){}function rc(){var t=this;this.Xc=function(){return t.Zc()},this.th=function(){return t.nh()},this.eh=[],this.sh()}function ic(t){var e=this;return(e=jh.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.m=t.m,e}function oc(t){this.Kc=t,this._=t._;var e=t.ssl?"https":"http";this.Gc=e+"://"+t.host,this.Hc="projects/"+this._.projectId+"/databases/"+this._.database+"/documents"}function sc(t){this.Mc=t.Mc,this.Lc=t.Lc}function uc(t){this.persistence=t,this.Nc=new ph,this.xc=null}function ac(t){var e=this;return(e=Fh.call(this)||this).nr=t,e}function hc(){this.Dc=[]}function cc(t){var e=this;this.Ic={},this.Ac=new da(0),this.Rc=!1,this.Rc=!0,this.rr=t(this),this.ki=new Xh(this),this.ti=new Aa,this.Xs=(t=this.ti,new Hh(t,function(t){return e.rr.Pc(t)}))}function lc(t){this.persistence=t,this.hc=new $r(pi,di),this.lastRemoteSnapshotVersion=Kr.min(),this.highestTargetId=0,this.ac=0,this.lc=new ph,this.targetCount=0,this._c=Oa.vi()}function fc(t){var e=this;return(e=Bh.call(this)||this).cc=t,e}function pc(){this.Mu=new $r(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.sc=!1}function dc(t,e){this.ti=t,this.Zu=e,this.docs=new Ii(ei.S),this.size=0}function yc(t,e){this.ti=t,this.rr=e,this.Zs=[],this.Wu=1,this.Qu=new Li(dh.Po)}function vc(){}function gc(t){return new No(t,!0)}var mc=(Tc.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Iu=this.rh(e),this.persistence=this.oh(e),[4,this.persistence.start()];case 1:return t.sent(),this.uh=this.hh(e),this.io=this.ah(e),[2]}})})},Tc.prototype.hh=function(t){return null},Tc.prototype.ah=function(t){return e=this.persistence,n=new Gh,t=t.lh,new Sa(e,n,t);var e,n},Tc.prototype.oh=function(t){return new Qh(Yh.Oc)},Tc.prototype.rh=function(t){return new vh},Tc.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.uh&&this.uh.stop(),[4,this.Iu.Xo()];case 1:return t.sent(),[4,this.persistence.Xo()];case 2:return t.sent(),[2]}})})},Tc),wc=(Ic.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.io?[3,2]:(this.io=n.io,this.Iu=n.Iu,this.ro=this._h(r),this.mu=this.fh(r),this.Tu=this.dh(r),this.wh=this.Eh(r,!n.synchronizeTabs),this.Iu.Hr=function(t){return kh(e.wh,t,1)},this.mu.oo.mh=function(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Ir("SyncEngine","User change. New user:",o.Ds()),[4,Da(n.io,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Cu.forEach(function(t){t.forEach(function(t){t.reject(new mr(gr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Cu.clear(),n.Iu.Yo(o,r.Qi,r.Ki),[4,qh(n,r.Wi)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this.wh),[4,function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.ho.delete(2),[4,Ya(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.ho.add(2),[4,Ka(e)]);case 3:t.sent(),e.fo.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.mu,this.wh.Fu)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Ic.prototype.dh=function(t){return new Yu},Ic.prototype._h=function(t){var e=gc(t.Kc._),n=(n=t.Kc,new Jh(n));return t=t.credentials,new Ga(t,n,e)},Ic.prototype.fh=function(t){var e=this;return new Ua(this.io,this.ro,t.$e,function(t){return kh(e.wh,t,0)},t=new(tc.ih()?tc:ec))},Ic.prototype.Eh=function(t,e){return n=this.io,r=this.mu,i=this.Tu,o=this.Iu,s=t.lh,t=t.Au,e=e,t=new Ih(n,r,i,o,s,t),e&&(t.Du=!0),t;var n,r,i,o,s},Ic.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Ir("RemoteStore","RemoteStore shutting down."),e.ho.add(5),[4,Ka(e)];case 1:return t.sent(),e.lo.Xo(),e.fo.set("Unknown"),[2]}})})}(this.mu)},Ic),bc=(Ec.prototype.next=function(t){this.observer.next&&this.Th(this.observer.next,t)},Ec.prototype.error=function(t){this.observer.error?this.Th(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Ec.prototype.Ih=function(){this.muted=!0},Ec.prototype.Th=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Ec);function Ec(t){this.observer=t,this.muted=!1}function Ic(){}function Tc(){this.synchronizeTabs=!1}function Ac(t,e,n){if(!n)throw new mr(gr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Nc(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new mr(gr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Oc(t,e,n,r){if(!0===e&&!0===r)throw new mr(gr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Sc(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Or();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Pc(t,e){if(e<=0)throw new mr(gr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Lc,Rc,kc=function(t){for(var e=0;e<t.length;++e)if(0===t[e].length)throw new mr(gr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Ah=new ti(t)},Dc=(n(Uc,Rc=kc),Uc.documentId=function(){return new Uc(ti.K().q())},Uc.prototype.isEqual=function(t){return t instanceof Uc&&this.Ah.isEqual(t.Ah)},Uc),_c=new RegExp("[~\\*/\\[\\]]"),Vc=function(t){this.Rh=t},Cc=(n(xc,Lc=Vc),xc.prototype.Ph=function(t){if(2!==t.yh)throw 1===t.yh?t.Vh(this.Rh+"() can only appear at the top level of your update data"):t.Vh(this.Rh+"() cannot be used with set() unless you pass {merge:true}");return t.Qn.push(t.path),null},xc.prototype.isEqual=function(t){return t instanceof xc},xc);function xc(){return null!==Lc&&Lc.apply(this,arguments)||this}function Uc(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Rc.call(this,t)||this}function Mc(t,e,n){return new ul({yh:3,gh:e.settings.gh,methodName:t.Rh,ph:n},e._,e.serializer,e.ignoreUndefinedProperties)}var qc,jc,Fc,Bc,Gc=(n(ol,Bc=Vc),ol.prototype.Ph=function(t){return new os(t.path,new Ho)},ol.prototype.isEqual=function(t){return t instanceof ol},ol),Wc=(n(il,Fc=Vc),il.prototype.Ph=function(t){var e=Mc(this,t,!0),n=this.bh.map(function(t){return yl(t,e)}),n=new zo(n);return new os(t.path,n)},il.prototype.isEqual=function(t){return this===t},il),Hc=(n(rl,jc=Vc),rl.prototype.Ph=function(t){var e=Mc(this,t,!0),n=this.bh.map(function(t){return yl(t,e)}),n=new Ko(n);return new os(t.path,n)},rl.prototype.isEqual=function(t){return this===t},rl),zc=(n(nl,qc=Vc),nl.prototype.Ph=function(t){var e=new es(t.serializer,Po(t.serializer,this.Ch));return new os(t.path,e)},nl.prototype.isEqual=function(t){return this===t},nl),Xc=(Object.defineProperty(el.prototype,"latitude",{get:function(){return this.Sh},enumerable:!1,configurable:!0}),Object.defineProperty(el.prototype,"longitude",{get:function(){return this.Dh},enumerable:!1,configurable:!0}),el.prototype.isEqual=function(t){return this.Sh===t.Sh&&this.Dh===t.Dh},el.prototype.toJSON=function(){return{latitude:this.Sh,longitude:this.Dh}},el.prototype.V=function(t){return Rr(this.Sh,t.Sh)||Rr(this.Dh,t.Dh)},el),Qc=function(t){this.Fh=t},$c=/^__.*__$/,Yc=function(t,e,n){this.Nh=t,this.xh=e,this.Oh=n},Kc=(tl.prototype.kh=function(t,e){var n=[];return null!==this.Qn?n.push(new ms(t,this.data,this.Qn,e)):n.push(new gs(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Ts(t,this.fieldTransforms)),n},tl),Zc=(Jc.prototype.kh=function(t,e){return e=[new ms(t,this.data,this.Qn,e)],0<this.fieldTransforms.length&&e.push(new Ts(t,this.fieldTransforms)),e},Jc);function Jc(t,e,n){this.data=t,this.Qn=e,this.fieldTransforms=n}function tl(t,e,n){this.data=t,this.Qn=e,this.fieldTransforms=n}function el(t,e){if(!isFinite(t)||t<-90||90<t)throw new mr(gr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new mr(gr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Sh=t,this.Dh=e}function nl(t,e){var n=this;return(n=qc.call(this,t)||this).Ch=e,n}function rl(t,e){var n=this;return(n=jc.call(this,t)||this).bh=e,n}function il(t,e){var n=this;return(n=Fc.call(this,t)||this).bh=e,n}function ol(){return null!==Bc&&Bc.apply(this,arguments)||this}function sl(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Or()}}var ul=(Object.defineProperty(cl.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(cl.prototype,"yh",{get:function(){return this.settings.yh},enumerable:!1,configurable:!0}),cl.prototype.Mh=function(t){return new cl(Object.assign(Object.assign({},this.settings),t),this._,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qn)},cl.prototype.Lh=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.Mh({path:e,ph:!1})).qh(t),e},cl.prototype.Uh=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t);return(t=this.Mh({path:t,ph:!1})).$h(),t},cl.prototype.Bh=function(t){return this.Mh({path:void 0,ph:!0})},cl.prototype.Vh=function(t){return El(t,this.settings.methodName,this.settings.jh||!1,this.path,this.settings.gh)},cl.prototype.contains=function(e){return void 0!==this.Qn.find(function(t){return e.$(t)})||void 0!==this.fieldTransforms.find(function(t){return e.$(t.field)})},cl.prototype.$h=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.qh(this.path.get(t))},cl.prototype.qh=function(t){if(0===t.length)throw this.Vh("Document fields must not be empty");if(sl(this.yh)&&$c.test(t))throw this.Vh('Document fields cannot begin and end with "__"')},cl),al=(hl.prototype.Wh=function(t,e,n,r){return void 0===r&&(r=!1),new ul({yh:t,methodName:e,gh:n,path:ti.B(),ph:!1,jh:r},this._,this.serializer,this.ignoreUndefinedProperties)},hl);function hl(t,e,n){this._=t,this.ignoreUndefinedProperties=e,this.serializer=n||gc(t)}function cl(t,e,n,r,i,o){this.settings=t,this._=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.$h(),this.fieldTransforms=i||[],this.Qn=o||[]}function ll(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Wh(o.merge||o.mergeFields?2:0,e,n,i);ml("Data must be an object, but it was:",s,r);var u,a,r=vl(r,s);if(o.merge)u=new ss(s.Qn),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],c=0,l=o.mergeFields;c<l.length;c++){var f=l[c],p=void 0;if(f instanceof kc)p=f.Ah;else{if("string"!=typeof f)throw Or();p=bl(e,f,n)}if(!s.contains(p))throw new mr(gr.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Il(h,p)||h.push(p)}u=new ss(h),a=s.fieldTransforms.filter(function(t){return u.Yn(t.field)})}else u=null,a=s.fieldTransforms;return new Kc(new Rs(r),u,a)}function fl(t,r,i,e){var o=t.Wh(1,r,i);ml("Data must be an object, but it was:",o,e);var s=[],u=new ks;return Hr(e,function(t,e){var n=bl(r,t,i),t=o.Uh(n);e instanceof Cc||e instanceof Qc&&e.Fh instanceof Cc?s.push(n):null!=(t=yl(e,t))&&(s.push(n),u.set(n,t))}),e=new ss(s),new Zc(u.Zn(),e,o.fieldTransforms)}function pl(t,e,n,r,i,o){var s=t.Wh(1,e,n),u=[wl(e,r,n)],a=[i];if(o.length%2!=0)throw new mr(gr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(wl(e,o[h])),a.push(o[h+1]);for(var c,l,f,p=[],d=new ks,y=u.length-1;0<=y;--y)Il(p,u[y])||(c=u[y],l=a[y],f=s.Uh(c),l instanceof Cc||l instanceof Qc&&l.Fh instanceof Cc?p.push(c):null!=(f=yl(l,f))&&(p.push(c),d.set(c,f)));return i=new ss(p),new Zc(d.Zn(),i,s.fieldTransforms)}function dl(t,e,n,r){return void 0===r&&(r=!1),yl(n,t.Wh(r?4:3,e))}function yl(s,t){if(s instanceof Qc&&(s=s.Fh),gl(s))return ml("Unsupported field value:",t,s),vl(s,t);if(s instanceof Vc)return function(t,e){if(!sl(e.yh))throw e.Vh(t.Rh+"() can only be used with update() and set()");if(!e.path)throw e.Vh(t.Rh+"() is not currently supported inside arrays");(t=t.Ph(e))&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.Qn.push(t.path),s instanceof Array){if(t.settings.ph&&4!==t.yh)throw t.Vh("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=yl(i[r],t.Bh(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Po(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Yr.fromDate(t);return{timestampValue:Lo(e.serializer,n)}}if(t instanceof Yr){var r=new Yr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Lo(e.serializer,r)}}if(t instanceof Xc)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Vr)return{bytesValue:Ro(e.serializer,t.l)};if(t instanceof Yc){if(n=e._,!(r=t.Nh).isEqual(n))throw e.Vh("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Do(t.Nh||e._,t.xh.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.Vh("Unsupported field value: "+Sc(t))}(s,t)}function vl(t,n){var r={};return zr(t)?n.path&&0<n.path.length&&n.Qn.push(n.path):Hr(t,function(t,e){null!=(e=yl(e,n.Lh(t)))&&(r[t]=e)}),{mapValue:{fields:r}}}function gl(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Yr||t instanceof Xc||t instanceof Vr||t instanceof Yc||t instanceof Vc)}function ml(t,e,n){if(!gl(n)||"object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))throw"an object"===(n=Sc(n))?e.Vh(t+" a custom object"):e.Vh(t+" "+n);var r}function wl(t,e,n){if(e instanceof kc)return e.Ah;if("string"==typeof e)return bl(t,e);throw El("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function bl(t,e,n){try{return function(e){if(0<=e.search(_c))throw new mr(gr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Dc.bind.apply(Dc,i([void 0],e.split("."))))}catch(t){throw new mr(gr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Ah}catch(e){throw El(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function El(t,e,n,r,i){var o=r&&!r.P(),s=void 0!==i,e="Function "+e+"() called with invalid data";return n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new mr(gr.INVALID_ARGUMENT,(e+=". ")+t+n)}function Il(t,e){return t.some(function(t){return t.isEqual(e)})}var Tl=(Pl.prototype.zh=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.Yh(),0<this.mutations.length)throw new mr(gr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var r,e,n,i,o;return v(this,function(t){switch(t.label){case 0:return e=xo((r=s).serializer)+"/documents",n={documents:u.map(function(t){return _o(r.serializer,t)})},[4,r.Gr("BatchGetDocuments",e,n)];case 1:return n=t.sent(),i=new Map,n.forEach(function(t){var e,n,t=(n=r.serializer,"found"in t?function(t,e){Sr(!!e.found),e.found.name,e.found.updateTime;var n=Vo(t,e.found.name),t=ko(e.found.updateTime),e=new Rs({mapValue:{fields:e.found.fields}});return new qs(n,t,e,{})}(n,t):"missing"in t?(e=n,Sr(!!(n=t).missing),Sr(!!n.readTime),e=Vo(e,n.missing),n=ko(n.readTime),new js(e,n)):Or());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){Sr(!!(t=i.get(t.toString()))),o.push(t)}),o)]}})})}(this.ro,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof js||t instanceof qs?n.Jh(t):Or()}),e)]}})})},Pl.prototype.set=function(t,e){this.write(e.kh(t,this.Hn(t))),this.Hh.add(t.toString())},Pl.prototype.update=function(t,e){try{this.write(e.kh(t,this.Xh(t)))}catch(t){this.Gh=t}this.Hh.add(t.toString())},Pl.prototype.delete=function(t){this.write([new Ps(t,this.Hn(t))]),this.Hh.add(t.toString())},Pl.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.Yh(),this.Gh)throw this.Gh;return e=this.Qh,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=ei.H(e),n.mutations.push(new Ls(e,n.Hn(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=xo((e=i).serializer)+"/documents",r={writes:o.map(function(t){return Mo(e.serializer,t)})},[4,e.Kr("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.ro,this.mutations)];case 1:return t.sent(),this.Kh=!0,[2]}})})},Pl.prototype.Jh=function(t){var e;if(t instanceof qs)e=t.version;else{if(!(t instanceof js))throw Or();e=Kr.min()}var n=this.Qh.get(t.key.toString());if(n){if(!e.isEqual(n))throw new mr(gr.ABORTED,"Document version changed between two reads.")}else this.Qh.set(t.key.toString(),e)},Pl.prototype.Hn=function(t){var e=this.Qh.get(t.toString());return!this.Hh.has(t.toString())&&e?hs.updateTime(e):hs.Jn()},Pl.prototype.Xh=function(t){var e=this.Qh.get(t.toString());if(this.Hh.has(t.toString())||!e)return hs.exists(!0);if(e.isEqual(Kr.min()))throw new mr(gr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return hs.updateTime(e)},Pl.prototype.write=function(t){this.Yh(),this.mutations=this.mutations.concat(t)},Pl.prototype.Yh=function(){},Pl),Al=(Sl.prototype.run=function(){this.ta()},Sl.prototype.ta=function(){var t=this;this.Xe.Pe(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new Tl(this.ro),(n=this.na(e))&&n.then(function(t){r.$e.We(function(){return e.commit().then(function(){r.qe.resolve(t)}).catch(function(t){r.ea(t)})})}).catch(function(t){r.ea(t)}),[2]})})})},Sl.prototype.na=function(t){try{var e=this.updateFunction(t);return!hi(e)&&e.catch&&e.then?e:(this.qe.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.qe.reject(t),null}},Sl.prototype.ea=function(t){var e=this;0<this.Zh&&this.sa(t)?(--this.Zh,this.$e.We(function(){return e.ta(),Promise.resolve()})):this.qe.reject(t)},Sl.prototype.sa=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!bi(t))},Sl),Nl=(Ol.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.qs.promise];case 1:return[2,(t.sent(),{$e:this.$e,Kc:this.Kc,clientId:this.clientId,credentials:this.credentials,lh:this.user,Au:100})]}})})},Ol.prototype.ra=function(t){var e=this;this.ia=t,this.qs.promise.then(function(){return e.ia(e.user)})},Ol.prototype.oa=function(){if(this.$e.ts)throw new mr(gr.FAILED_PRECONDITION,"The client has already been terminated.")},Ol.prototype.terminate=function(){var t=this;this.$e.rs();var n=new Mu;return this.$e.ns(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.ua?[4,this.ua.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.ca?[4,this.ca.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.Ms(),n.resolve(),[3,6];case 5:return e=$u(t.sent(),"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},Ol);function Ol(t,e,n){var r=this;this.credentials=t,this.$e=e,this.Kc=n,this.user=na.UNAUTHENTICATED,this.clientId=Pr.t(),this.ia=function(){},this.qs=new Mu,this.credentials.$s(function(t){Ir("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.ia(t)),r.qs.resolve()})}function Sl(t,e,n,r){this.$e=t,this.ro=e,this.updateFunction=n,this.qe=r,this.Zh=5,this.Xe=new qu(this.$e,"transaction_retry")}function Pl(t){this.ro=t,this.Qh=new Map,this.mutations=[],this.Kh=!1,this.Gh=null,this.Hh=new Set}function Ll(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.ca?[3,2]:(Ir("FirestoreClient","Using default OfflineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return r.$e.hs(),Ir("FirestoreClient","Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return e=t.sent(),[4,i.initialize(e)];case 2:return t.sent(),r.ra(function(e){return r.$e.os(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Da(i.io,e)];case 1:return t.sent(),[2]}})})})}),i.persistence.Vc(function(){return r.terminate()}),r.ca=i,[2]}})})}(e,new mc)]);case 1:t.sent(),t.label=2;case 2:return[2,e.ca]}})})}function Rl(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.ua?[3,2]:(Ir("FirestoreClient","Using default OnlineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.$e.hs(),[4,Ll(r)];case 1:return e=t.sent(),Ir("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.ra(function(t){return r.$e.os(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).$e.hs(),Ir("RemoteStore","RemoteStore received new credentials"),n=ih(e),e.ho.add(3),[4,Ka(e)];case 1:return t.sent(),n&&e.fo.set("Unknown"),[4,e.oo.mh(i)];case 2:return t.sent(),e.ho.delete(3),[4,Ya(e)];case 3:return t.sent(),[2]}})})}(i.mu,t)})}),r.ua=i,[2]}})})}(e,new wc)]);case 1:t.sent(),t.label=2;case 2:return[2,e.ua]}})})}function kl(t){return Ll(t).then(function(t){return t.persistence})}function Dl(t){return Ll(t).then(function(t){return t.io})}function _l(t){return Rl(t).then(function(t){return t.mu})}function Vl(t){return Rl(t).then(function(t){return t.wh})}function Cl(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Rl(r)];case 1:return e=t.sent(),[2,((n=e.Tu).Is=function(h,c){return y(this,void 0,void 0,function(){var n,o,s,u,a;return v(this,function(t){switch(t.label){case 0:return(e=h).mu.oo.Eo=Rh.bind(null,e),e.mu.oo.Bn=function(t,e){var n=t;if((t=n.pu.get(e))&&t.Eu)return Ui().add(t.key);var r=Ui();if(!(e=n.yu.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Pu.get(s),r=r.kt(s.view.iu);return r}.bind(null,e),e.mu.oo.wo=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Iu.Wo(s,"rejected",u),i=e.pu.get(s),(n=i&&i.key)?(r=(r=new Ii(ei.S)).ot(n,new js(n,Kr.min())),i=Ui().add(n),i=new Bi(Kr.min(),new Map,new Li(Rr),r,i),[4,Rh(e,i)]):[3,2];case 1:return t.sent(),e.gu=e.gu.remove(n),e.pu.delete(s),Mh(e),[3,4];case 2:return[4,Va(e.io,s,!1).then(function(){return Ch(e,s,u)}).catch(xa)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.Ru.Or=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query;if(u=n.Es.get(u)){for(var a=0,h=u.listeners;a<h.length;a++)h[a].Rs(s)&&(r=!0);u.ws=s}}r&&ta(n)}.bind(null,e.Tu),e.Ru.Nu=function(t,e,n){var r=t;if(t=r.Es.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.Es.delete(e)}.bind(null,e.Tu),(a=(n=e).Pu.get(c))?(o=a.targetId,n.Iu.jo(o),s=a.view.wu(),[3,4]):[3,1];case 1:return[4,(e=n.io,r=Js(c),(i=e).persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.ki.hr(e,r).next(function(t){return t?(n=t,ju.resolve(n)):i.ki.xu(e).next(function(t){return n=new mi(r,t,0,e.nr),i.ki.Ou(e,n).next(function(){return n})})})}).then(function(t){var e=i.Si.get(t.targetId);return(null===e||0<t.et.u(e.et))&&(i.Si=i.Si.ot(t.targetId,t),i.Di.set(r,t.targetId)),t}))];case 2:return u=t.sent(),a=n.Iu.jo(u.targetId),o=u.targetId,[4,function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.ku=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.ru(o)).cu?[4,Ca(r.io,i.query,!1).then(function(t){return t=t.documents,i.view.ru(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.Ht.get(i.targetId),n=i.view.hu(e,r.Fu,n),[2,(Uh(r,i.targetId,n._u),n.snapshot)]}})})}(i,t,e,n)},[4,Ca(i.io,o,!0)];case 1:return n=t.sent(),r=new wh(o,n.lr),e=r.ru(n.documents),n=Gi.Zt(s,u&&"Offline"!==i.onlineState),n=r.hu(e,i.Fu,n),Uh(i,s,n._u),r=new bh(o,s,r),i.Pu.set(o,r),i.yu.has(s)?i.yu.get(s).push(o):i.yu.set(s,[o]),[2,n.snapshot]}})})}(n,c,o,"current"===a)];case 3:s=t.sent(),n.Fu&&Za(n.mu,u),t.label=4;case 4:return[2,s]}var r,i,e})})}.bind(null,e.wh),n.Ps=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Pu.get(o),1<(r=e.yu.get(n.targetId)).length?[2,(e.yu.set(n.targetId,r.filter(function(t){return!ru(t,o)})),void e.Pu.delete(o))]:e.Fu?(e.Iu.Qo(n.targetId),e.Iu.zo(n.targetId)?[3,2]:[4,Va(e.io,n.targetId,!1).then(function(){e.Iu.Go(n.targetId),Ja(e.mu,n.targetId),Ch(e,n.targetId)}).catch(xa)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Ch(e,n.targetId),[4,Va(e.io,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.wh),n)]}})})}function xl(n,t,e,r){var i=this,o=new bc(r),s=new ea(t,o,e);return n.$e.We(function(){return y(i,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Zu,[4,Cl(n)];case 1:return[2,e.apply(void 0,[t.sent(),s])]}})})}),function(){o.Ih(),n.$e.We(function(){return y(i,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Ju,[4,Cl(n)];case 1:return[2,e.apply(void 0,[t.sent(),s])]}})})})}}function Ul(n,r){var t=this,i=new Mu;return n.$e.We(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Lh,[4,Vl(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}function Ml(n,t){var e=this,r=new bc(t);return n.$e.We(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Ts.add(e),e.next()},[4,Cl(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),function(){r.Ih(),n.$e.We(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Ts.delete(e)},[4,Cl(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}}function ql(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var jl=(Ql.prototype._a=function(t){switch(uo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return yo(t.integerValue||t.doubleValue);case 3:return this.fa(t.timestampValue);case 4:return this.da(t);case 5:return t.stringValue;case 6:return this.la(vo(t.bytesValue));case 7:return this.wa(t.referenceValue);case 8:return this.Ea(t.geoPointValue);case 9:return this.ma(t.arrayValue);case 10:return this.Ta(t.mapValue);default:throw Or()}},Ql.prototype.Ta=function(t){var n=this,r={};return Hr(t.fields||{},function(t,e){r[t]=n._a(e)}),r},Ql.prototype.Ea=function(t){return new Xc(yo(t.latitude),yo(t.longitude))},Ql.prototype.ma=function(t){var e=this;return(t.values||[]).map(function(t){return e._a(t)})},Ql.prototype.da=function(t){switch(this.ha){case"previous":var e=function t(e){return io(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==e?null:this._a(e);case"estimate":return this.fa(oo(t));default:return null}},Ql.prototype.fa=function(t){return t=po(t),new Yr(t.seconds,t.nanos)},Ql.prototype.wa=function(t){var e=Zr.U(t);return Sr(Fo(e)),t=new Fr(e.get(1),e.get(3)),e=new ei(e.F(5)),t.isEqual(this._)||Tr("Document "+e+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+this._.projectId+"/"+this._.database+") instead."),this.aa(e)},Ql),Fl=(Xl.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Xl),Bl="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Gl=(zl.prototype.enableIndexedDbPersistence=function(t,e){throw new mr(gr.FAILED_PRECONDITION,Bl)},zl.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new mr(gr.FAILED_PRECONDITION,Bl)},zl.prototype.clearIndexedDbPersistence=function(t){throw new mr(gr.FAILED_PRECONDITION,Bl)},zl),Wl=(Object.defineProperty(Hl.prototype,"va",{get:function(){return!!this.Pa},enumerable:!1,configurable:!0}),Object.defineProperty(Hl.prototype,"ba",{get:function(){return this.Ra.ts},enumerable:!1,configurable:!0}),Object.defineProperty(Hl.prototype,"Ca",{get:function(){return this.Sa||(this.Sa=new al(this.Nh,this.pa.ignoreUndefinedProperties)),this.Sa},enumerable:!1,configurable:!0}),Hl.prototype.settings=function(t){if(t.merge&&delete(t=Object.assign(Object.assign({},this.pa),t)).merge,t=new Fl(t),this.Pa&&!this.pa.isEqual(t))throw new mr(gr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");void 0!==(this.pa=t).credentials&&(this.ga=function(t){if(!t)return new sa;switch(t.type){case"gapi":var e=t.client;return Sr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new ha(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new mr(gr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Hl.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.pa.host&&Ar("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},Hl.prototype.enableNetwork=function(){return $l(this),function(r){var t=this;return r.$e.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,kl(r)];case 1:return e=t.sent(),[4,_l(r)];case 2:return n=t.sent(),[2,(e.gc(!0),(t=n).ho.delete(0),Ya(t))]}})})})}(this.Pa)},Hl.prototype.disableNetwork=function(){return $l(this),function(r){var t=this;return r.$e.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,kl(r)];case 1:return e=t.sent(),[4,_l(r)];case 2:return n=t.sent(),[2,(e.gc(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).ho.add(0),[4,Ka(e)];case 1:return t.sent(),e.fo.set("Offline"),[2]}})})}(n))]}})})})}(this.Pa)},Hl.prototype.enablePersistence=function(t){if(this.Pa)throw new mr(gr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var e=!1,n=!1;return t&&Oc("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Ia.enableMultiTabIndexedDbPersistence(this):this.Ia.enableIndexedDbPersistence(this,n)},Hl.prototype.clearPersistence=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2,this.Ia.clearIndexedDbPersistence(this)]})})},Hl.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Hl.prototype.waitForPendingWrites=function(){return $l(this),function(n){var t=this,r=new Mu;return n.$e.We(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Dh,[4,Vl(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(this.Pa)},Hl.prototype.onSnapshotsInSync=function(t){return $l(this),ql(t)||(t={next:t}),Ml(this.Pa,t)},Hl.ya=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new mr(gr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e;if(!(t=t.options.projectId)||"string"!=typeof t)throw new mr(gr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Fr(t)},Object.defineProperty(Hl.prototype,"app",{get:function(){if(!this.Aa)throw new mr(gr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Aa},enumerable:!1,configurable:!0}),Hl.prototype.collection=function(t){return Ac("Firestore.collection","path",t),$l(this),new wf(Zr.U(t),this,null)},Hl.prototype.doc=function(t){return Ac("Firestore.doc","path",t),$l(this),ef.Da(Zr.U(t),this,null)},Hl.prototype.collectionGroup=function(t){if(Ac("Firestore.collectionGroup","collectionId",t),0<=t.indexOf("/"))throw new mr(gr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return $l(this),new gf(new Bs(Zr.B(),t),this,null)},Hl.prototype.runTransaction=function(e){var n=this;return function(n,r){var t=this,i=new Mu;return n.$e.We(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,Rl(n).then(function(t){return t.ro})];case 1:return e=t.sent(),new Al(n.$e,e,r,i).run(),[2]}})})}),i.promise}($l(this),function(t){return e(new Jl(n,t))})},Hl.prototype.batch=function(){return $l(this),new tf(this)},Hl.prototype.Fa=function(){return this.pa},Hl);function Hl(t,e,n){var r=this;if(void 0===n&&(n=new Gl),this.Ia=n,this.Aa=null,this.Ra=new zu,this.INTERNAL={delete:function(){return y(r,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Pa||Yl(this),[4,this.Pa.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options)n=t,this.Aa=n,this.Nh=Hl.ya(n),this.Va=n.name,this.ga=new ua(e);else{if(!t.projectId)throw new mr(gr.INVALID_ARGUMENT,"Must provide projectId");this.Nh=new Fr(t.projectId,t.database),this.Va="[DEFAULT]",this.ga=new sa}this.pa=new Fl({})}function zl(){}function Xl(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new mr(gr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new mr(gr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Oc("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function Ql(t,e,n,r){this._=t,this.ha=e,this.aa=n,this.la=r}function $l(t){return t.Pa||Yl(t),t.Pa.oa(),t.Pa}function Yl(t){var e,n,r=t.Fa(),r=(e=t.Nh,n=t.Va,new jr(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.Pa=new Nl(t.ga,t.Ra,r)}var Kl,Zl,Jl=(lf.prototype.get=function(t){var e=this,n=Tf(0,t,this.Na);return this.xa.zh([n.xh]).then(function(t){if(!t||1!==t.length)return Or();if((t=t[0])instanceof js)return new rf(e.Na,n.xh,null,!1,!1,n.Oh);if(t instanceof qs)return new rf(e.Na,n.xh,t,!1,!1,n.Oh);throw Or()})},lf.prototype.set=function(t,e,n){return t=Tf(0,t,this.Na),n=Nc("Transaction.set",n),e=Af(t.Oh,e,n),n=ll(this.Na.Ca,"Transaction.set",t.xh,e,null!==t.Oh,n),this.xa.set(t.xh,n),this},lf.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return e="string"==typeof e||e instanceof Dc?(r=Tf(0,t,this.Na),pl(this.Na.Ca,"Transaction.update",r.xh,e,n,i)):(r=Tf(0,t,this.Na),fl(this.Na.Ca,"Transaction.update",r.xh,e)),this.xa.update(r.xh,e),this},lf.prototype.delete=function(t){return t=Tf(0,t,this.Na),this.xa.delete(t.xh),this},lf),tf=(cf.prototype.set=function(t,e,n){return this.$a(),t=Tf(0,t,this.Na),n=Nc("WriteBatch.set",n),e=Af(t.Oh,e,n),n=ll(this.Na.Ca,"WriteBatch.set",t.xh,e,null!==t.Oh,n),this.Oa=this.Oa.concat(n.kh(t.xh,hs.Jn())),this},cf.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return this.$a(),e="string"==typeof e||e instanceof Dc?(r=Tf(0,t,this.Na),pl(this.Na.Ca,"WriteBatch.update",r.xh,e,n,i)):(r=Tf(0,t,this.Na),fl(this.Na.Ca,"WriteBatch.update",r.xh,e)),this.Oa=this.Oa.concat(e.kh(r.xh,hs.exists(!0))),this},cf.prototype.delete=function(t){return this.$a(),t=Tf(0,t,this.Na),this.Oa=this.Oa.concat(new Ps(t.xh,hs.Jn())),this},cf.prototype.commit=function(){return this.$a(),this.ka=!0,0<this.Oa.length?Ul($l(this.Na),this.Oa):Promise.resolve()},cf.prototype.$a=function(){if(this.ka)throw new mr(gr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},cf),ef=(n(hf,Zl=Yc),hf.Da=function(t,e,n){if(t.length%2!=0)throw new mr(gr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.q()+" has "+t.length);return new hf(new ei(t),e,n)},Object.defineProperty(hf.prototype,"id",{get:function(){return this.xh.path.k()},enumerable:!1,configurable:!0}),Object.defineProperty(hf.prototype,"parent",{get:function(){return new wf(this.xh.path.N(),this.firestore,this.Oh)},enumerable:!1,configurable:!0}),Object.defineProperty(hf.prototype,"path",{get:function(){return this.xh.path.q()},enumerable:!1,configurable:!0}),hf.prototype.collection=function(t){if(Ac("DocumentReference.collection","path",t),!t)throw new mr(gr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");return t=Zr.U(t),new wf(this.xh.path.child(t),this.firestore,null)},hf.prototype.isEqual=function(t){return t instanceof hf&&this.firestore===t.firestore&&this.xh.isEqual(t.xh)&&this.Oh===t.Oh},hf.prototype.set=function(t,e){return e=Nc("DocumentReference.set",e),t=Af(this.Oh,t,e),e=ll(this.firestore.Ca,"DocumentReference.set",this.xh,t,null!==this.Oh,e),Ul(this.Pa,e.kh(this.xh,hs.Jn()))},hf.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return t="string"==typeof t||t instanceof Dc?pl(this.firestore.Ca,"DocumentReference.update",this.xh,t,e,n):fl(this.firestore.Ca,"DocumentReference.update",this.xh,t),Ul(this.Pa,t.kh(this.xh,hs.exists(!0)))},hf.prototype.delete=function(){return Ul(this.Pa,[new Ps(this.xh,hs.Jn())])},hf.prototype.onSnapshot=function(){for(var e=this,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||ql(n[i])||(r=n[i],i++);var o={includeMetadataChanges:r.includeMetadataChanges};ql(n[i])&&(s=n[i],n[i]=null===(r=s.next)||void 0===r?void 0:r.bind(s),n[i+1]=null===(r=s.error)||void 0===r?void 0:r.bind(s),n[i+2]=null===(r=s.complete)||void 0===r?void 0:r.bind(s));var s={next:function(t){n[i]&&n[i](e.Ma(t))},error:n[i+1],complete:n[i+2]};return xl(this.Pa,zs(this.xh.path),o,s)},hf.prototype.get=function(t){var e=this;return t&&"cache"===t.source?function(n,r){var t=this,i=new Mu;return n.$e.We(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.Mi.ni(t,e)}))];case 1:return(r=t.sent())instanceof qs?s.resolve(r):r instanceof js?s.resolve(null):s.reject(new mr(gr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=$u(r=t.sent(),"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})},[4,Dl(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(this.Pa,this.xh).then(function(t){return new rf(e.firestore,e.xh,t,!0,t instanceof qs&&t.Xn,e.Oh)}):function(n,r,i){var t=this;void 0===i&&(i={});var o=new Mu;return n.$e.We(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(n,r,i,o,s){var t=new bc({next:function(t){r.We(function(){return Ju(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new mr(gr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new mr(gr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new ea(zs(i.path),t,{includeMetadataChanges:!0,Cs:!0});return Zu(n,u)},[4,Cl(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.$e,r,i,o])]}})})}),o.promise}(this.Pa,this.xh,t).then(function(t){return e.Ma(t)})},hf.prototype.withConverter=function(t){return new hf(this.xh,this.firestore,t)},hf.prototype.Ma=function(t){var e=t.docs.get(this.xh);return new rf(this.firestore,this.xh,e,t.fromCache,t.hasPendingWrites,this.Oh)},hf),nf=(af.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},af),rf=(uf.prototype.data=function(t){var e=this;if(void 0===t&&(t={}),this.La){if(this.Oh){var n=new of(this.Na,this.xh,this.La,this.qa,this.Ua,null);return this.Oh.fromFirestore(n,t)}return new jl(this.Na.Nh,t.serverTimestamps||"none",function(t){return new ef(t,e.Na,null)},function(t){return new qr(t)})._a(this.La.re())}},uf.prototype.get=function(t,e){var n=this;if(void 0===e&&(e={}),this.La&&null!==(t=this.La.data().field(wl("DocumentSnapshot.get",t,this.xh))))return new jl(this.Na.Nh,e.serverTimestamps||"none",function(t){return new ef(t,n.Na,n.Oh)},function(t){return new qr(t)})._a(t)},Object.defineProperty(uf.prototype,"id",{get:function(){return this.xh.path.k()},enumerable:!1,configurable:!0}),Object.defineProperty(uf.prototype,"ref",{get:function(){return new ef(this.xh,this.Na,this.Oh)},enumerable:!1,configurable:!0}),Object.defineProperty(uf.prototype,"exists",{get:function(){return null!==this.La},enumerable:!1,configurable:!0}),Object.defineProperty(uf.prototype,"metadata",{get:function(){return new nf(this.Ua,this.qa)},enumerable:!1,configurable:!0}),uf.prototype.isEqual=function(t){return t instanceof uf&&this.Na===t.Na&&this.qa===t.qa&&this.xh.isEqual(t.xh)&&(null===this.La?null===t.La:this.La.isEqual(t.La))&&this.Oh===t.Oh},uf),of=(n(sf,Kl=rf),sf.prototype.data=function(t){return Kl.prototype.data.call(this,t)},sf);function sf(){return null!==Kl&&Kl.apply(this,arguments)||this}function uf(t,e,n,r,i,o){this.Na=t,this.xh=e,this.La=n,this.qa=r,this.Ua=i,this.Oh=o}function af(t,e){this.hasPendingWrites=t,this.fromCache=e}function hf(t,e,n){var r=this;return(r=Zl.call(this,e.Nh,t,n)||this).xh=t,r.firestore=e,r.Oh=n,r.Pa=$l(e),r}function cf(t){this.Na=t,this.Oa=[],this.ka=!1}function lf(t,e){this.Na=t,this.xa=e}function ff(t,e,n){if("string"==typeof n){if(""===n)throw new mr(gr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ks(e)&&-1!==n.indexOf("/"))throw new mr(gr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child(Zr.U(n)),!ei.X(e))throw new mr(gr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return go(t,new ei(e))}if(n instanceof Yc)return go(t,n.xh);throw new mr(gr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Sc(n)+".")}function pf(t,e){if(!Array.isArray(t)||0===t.length)throw new mr(gr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new mr(gr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function df(t,e,n){if(!n.isEqual(e))throw new mr(gr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function yf(t){if(Qs(t)&&0===t.oe.length)throw new mr(gr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var vf,gf=(If.prototype.where=function(t,e,n){return t=wl("Query.where",t),e=function(t,e,n,r,i,o){if(r.W()){if("array-contains"===i||"array-contains-any"===i)throw new mr(gr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){pf(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var h=a[u];s.push(ff(n,t,h))}c={arrayValue:{values:s}}}else c=ff(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||pf(o,i),c=dl(e,"Query.where",o,"in"===i||"not-in"===i);var c=hu.create(r,i,c);return function(t,e){if(e.ae()){var n=Ys(t);if(null!==n&&!n.isEqual(e.field))throw new mr(gr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=$s(t))&&df(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new mr(gr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new mr(gr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,c),c}(this.Ba,this.firestore.Ca,this.firestore.Nh,t,e,n),new If((e=(n=this.Ba).filters.concat([e]),new Bs(n.path,n.collectionGroup,n.oe.slice(),e,n.limit,n.ue,n.startAt,n.endAt)),this.firestore,this.Oh)},If.prototype.orderBy=function(t,e){if(void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new mr(gr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var n,t=wl("Query.orderBy",t),t=function(t,e,n){if(null!==t.startAt)throw new mr(gr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new mr(gr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return n=e=new Uu(e,n),null!==$s(t)||null!==(t=Ys(t))&&df(0,t,n.field),e}(this.Ba,t,n);return new If((t=(n=this.Ba).oe.concat([t]),new Bs(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.ue,n.startAt,n.endAt)),this.firestore,this.Oh)},If.prototype.limit=function(t){return Pc("Query.limit",t),new If(tu(this.Ba,t,"F"),this.firestore,this.Oh)},If.prototype.limitToLast=function(t){return Pc("Query.limitToLast",t),new If(tu(this.Ba,t,"L"),this.firestore,this.Oh)},If.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t=this.ja("Query.startAt",t,e,!0),new If(eu(this.Ba,t),this.firestore,this.Oh)},If.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t=this.ja("Query.startAfter",t,e,!1),new If(eu(this.Ba,t),this.firestore,this.Oh)},If.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t=this.ja("Query.endBefore",t,e,!0),new If(nu(this.Ba,t),this.firestore,this.Oh)},If.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t=this.ja("Query.endAt",t,e,!1),new If(nu(this.Ba,t),this.firestore,this.Oh)},If.prototype.isEqual=function(t){return t instanceof If&&this.firestore===t.firestore&&ru(this.Ba,t.Ba)&&this.Oh===t.Oh},If.prototype.withConverter=function(t){return new If(this.Ba,this.firestore,t)},If.prototype.ja=function(h,t,e,n){return t instanceof rf?function(t,e,n,r){if(!n)throw new mr(gr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+h+"().");for(var i=[],o=0,s=Zs(t);o<s.length;o++){var u=s[o];if(u.field.W())i.push(go(e,n.key));else{var a=n.field(u.field);if(io(a))throw new mr(gr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a)throw u=u.field.q(),new mr(gr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.");i.push(a)}}return new Lu(i,r)}(this.Ba,this.firestore.Nh,t.La,n):(e=[t].concat(e),function(t,e,n,r,i,o){var s=t.oe;if(i.length>s.length)throw new mr(gr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var h=i[a];if(s[a].field.W()){if("string"!=typeof h)throw new mr(gr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!Ks(t)&&-1!==h.indexOf("/"))throw new mr(gr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(Zr.U(h));if(!ei.X(c))throw new mr(gr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");c=new ei(c),u.push(go(e,c))}else h=dl(n,r,h),u.push(h)}return new Lu(u,o)}(this.Ba,this.firestore.Nh,this.firestore.Ca,h,e,n))},If.prototype.onSnapshot=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i={},o=0;"object"!=typeof n[o]||ql(n[o])||(i=n[o],o++),ql(n[o])&&(s=n[o],n[o]=null===(t=s.next)||void 0===t?void 0:t.bind(s),n[o+1]=null===(t=s.error)||void 0===t?void 0:t.bind(s),n[o+2]=null===(t=s.complete)||void 0===t?void 0:t.bind(s));var s={next:function(t){n[o]&&n[o](new mf(e.firestore,e.Ba,t,e.Oh))},error:n[o+1],complete:n[o+2]};return yf(this.Ba),xl($l(this.firestore),this.Ba,i,s)},If.prototype.get=function(t){var e=this;yf(this.Ba);var n=$l(this.firestore);return(t&&"cache"===t.source?function(n,r){var t=this,i=new Mu;return n.$e.We(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Ca(r,i,!0)];case 1:return n=t.sent(),e=new wh(i,n.lr),n=e.ru(n.documents),n=e.hu(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=$u(n=t.sent(),"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})},[4,Dl(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(n,this.Ba):function(n,r,i){var t=this;void 0===i&&(i={});var o=new Mu;return n.$e.We(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new bc({next:function(t){n.We(function(){return Ju(e,s)}),t.fromCache&&"server"===r.source?i.reject(new mr(gr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new ea(t,o,{includeMetadataChanges:!0,Cs:!0});return Zu(e,s)},[4,Cl(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.$e,r,i,o])]}})})}),o.promise}(n,this.Ba,t)).then(function(t){return new mf(e.firestore,e.Ba,t,e.Oh)})},If),mf=(Object.defineProperty(Ef.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Ef.prototype,"empty",{get:function(){return this.Qa.docs.P()},enumerable:!1,configurable:!0}),Object.defineProperty(Ef.prototype,"size",{get:function(){return this.Qa.docs.size},enumerable:!1,configurable:!0}),Ef.prototype.forEach=function(e,n){var r=this;this.Qa.docs.forEach(function(t){e.call(n,r.Ha(t,r.metadata.fromCache,r.Qa.Wt.has(t.key)))})},Object.defineProperty(Ef.prototype,"query",{get:function(){return new gf(this.Wa,this.Na,this.Oh)},enumerable:!1,configurable:!0}),Ef.prototype.docChanges=function(t){if((t=!(!t||!t.includeMetadataChanges))&&this.Qa.Kt)throw new mr(gr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Ka&&this.Ga===t||(this.Ka=function(i,e,o){if(i.jt.P()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Wt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.jt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Wt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Or()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.Qa,t,this.Ha.bind(this)),this.Ga=t),this.Ka},Ef.prototype.isEqual=function(t){return t instanceof Ef&&this.Na===t.Na&&ru(this.Wa,t.Wa)&&this.Qa.isEqual(t.Qa)&&this.Oh===t.Oh},Ef.prototype.Ha=function(t,e,n){return new of(this.Na,t.key,t,e,n,this.Oh)},Ef),wf=(n(bf,vf=gf),Object.defineProperty(bf.prototype,"id",{get:function(){return this.Ba.path.k()},enumerable:!1,configurable:!0}),Object.defineProperty(bf.prototype,"parent",{get:function(){var t=this.Ba.path.N();return t.P()?null:new ef(new ei(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(bf.prototype,"path",{get:function(){return this.Ba.path.q()},enumerable:!1,configurable:!0}),bf.prototype.doc=function(t){return 0===arguments.length&&(t=Pr.t()),Ac("CollectionReference.doc","path",t),t=Zr.U(t),ef.Da(this.Ba.path.child(t),this.firestore,this.Oh)},bf.prototype.add=function(t){var t=this.Oh?this.Oh.toFirestore(t):t,e=this.doc();return new ef(e.xh,this.firestore,null).set(t).then(function(){return e})},bf.prototype.withConverter=function(t){return new bf(this.za,this.firestore,t)},bf);function bf(t,e,n){var r=this;if(((r=vf.call(this,zs(t),e,n)||this).za=t).length%2!=1)throw new mr(gr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.q()+" has "+t.length);return r}function Ef(t,e,n,r){this.Na=t,this.Wa=e,this.Qa=n,this.Oh=r,this.Ka=null,this.Ga=null,this.metadata=new nf(n.hasPendingWrites,n.fromCache)}function If(t,e,n){this.Ba=t,this.firestore=e,this.Oh=n}function Tf(t,e,n){if((e=function(t,e){if(t instanceof e)return t;if(e.name===t.constructor.name)throw new mr(gr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");throw t=Sc(t),new mr(gr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}(e,ef)).firestore!==n)throw new mr(gr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function Af(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Nf,l=(n(Of,Nf=Qc),Of.serverTimestamp=function(){var t=new Gc("serverTimestamp");return t.Rh="FieldValue.serverTimestamp",new Of(t)},Of.delete=function(){var t=new Cc("deleteField");return t.Rh="FieldValue.delete",new Of(t)},Of.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Wc("arrayUnion",t)}.apply(void 0,t);return n.Rh="FieldValue.arrayUnion",new Of(n)},Of.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Hc("arrayRemove",t)}.apply(void 0,t);return n.Rh="FieldValue.arrayRemove",new Of(n)},Of.increment=function(t){return(t=new zc("increment",t)).Rh="FieldValue.increment",new Of(t)},Of.prototype.isEqual=function(t){return this.Fh.isEqual(t.Fh)},Of),l={Firestore:Wl,GeoPoint:Xc,Timestamp:Yr,Blob:qr,Transaction:Jl,WriteBatch:tf,DocumentReference:ef,DocumentSnapshot:rf,Query:gf,QueryDocumentSnapshot:of,QuerySnapshot:mf,CollectionReference:wf,FieldPath:Dc,FieldValue:l,setLogLevel:function(t){wr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};function Of(){return null!==Nf&&Nf.apply(this,arguments)||this}(e=e.default).INTERNAL.registerComponent(new me("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new Wl(e,t,new Gl);var e},"PUBLIC").setServiceProps(Object.assign({},l))),e.registerVersion("@firebase/firestore","2.0.1")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});