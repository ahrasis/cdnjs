!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(ad){"use strict";try{(function(){var u,t,e=(t=ad)&&"object"==typeof t&&"default"in t?t:{default:t},r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function a(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function i(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,a(["["+i+"]  "+t.name+":"],n))}}(ge=u=u||{})[ge.DEBUG=0]="DEBUG",ge[ge.VERBOSE=1]="VERBOSE",ge[ge.INFO=2]="INFO",ge[ge.WARN=3]="WARN",ge[ge.ERROR=4]="ERROR",ge[ge.SILENT=5]="SILENT";var o={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},h=u.INFO,c=((me={})[u.DEBUG]="log",me[u.VERBOSE]="log",me[u.INFO]="info",me[u.WARN]="warn",me[u.ERROR]="error",me),l=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.DEBUG],t)),this._logHandler.apply(this,a([this,u.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.VERBOSE],t)),this._logHandler.apply(this,a([this,u.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.INFO],t)),this._logHandler.apply(this,a([this,u.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.WARN],t)),this._logHandler.apply(this,a([this,u.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.ERROR],t)),this._logHandler.apply(this,a([this,u.ERROR],t))},f);function f(t){this.name=t,this._logLevel=h,this._logHandler=i,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e,n){return(e=d.call(this,e)||this).code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=(t=this.errors[t])?(r=i,t.replace(T,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var T=/\{\$([^}]+)}/g,I=function(t,e){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},O=N||self;function R(){}function k(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function D(t){var e=k(t);return"array"==e||"object"==e&&"number"==typeof t.length}function S(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var P="closure_uid_"+(1e9*Math.random()>>>0),_=0;function L(t,e,n){return t.call.apply(t.bind,arguments)}function V(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function C(t,e,n){return(C=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?L:V).apply(null,arguments)}function U(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var j=Date.now;function M(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t}function x(){this.j=this.j,this.i=this.i}x.prototype.j=!1,x.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,P)&&this[P]||(this[P]=++_))},x.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var q=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},F=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function G(){return Array.prototype.concat.apply([],arguments)}function B(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function W(t){return/^[\s\xa0]*$/.test(t)}var z=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function H(t,e){return-1!=t.indexOf(e)}function X(t,e){return t<e?-1:e<t?1:0}var Y=O.navigator;function K(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function $(t){var e,n={};for(e in t)n[e]=t[e];return n}at=(Y=Y&&Y.userAgent)?Y:"";var Q="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function J(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<Q.length;i++)e=Q[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function Z(t){return Z[" "](t),t}Z[" "]=R;var tt,et=H(at,"Opera"),nt=H(at,"Trident")||H(at,"MSIE"),rt=H(at,"Edge"),it=rt||nt,ot=H(at,"Gecko")&&!(H(at.toLowerCase(),"webkit")&&!H(at,"Edge"))&&!(H(at,"Trident")||H(at,"MSIE"))&&!H(at,"Edge"),st=H(at.toLowerCase(),"webkit")&&!H(at,"Edge");function ut(){var t=O.document;return t?t.documentMode:void 0}var Y="",at=(at=at,ot?/rv:([^\);]+)(\)|;)/.exec(at):rt?/Edge\/([\d\.]+)/.exec(at):nt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(at):st?/WebKit\/(\S+)/.exec(at):et?/(?:Version)[ \/]?(\S+)/.exec(at):void 0);at&&(Y=at?at[1]:""),tt=nt&&null!=(at=ut())&&at>parseFloat(Y)?String(at):Y;var ht={};function ct(u){return t=u,e=function(){for(var t=0,e=z(String(tt)).split("."),n=z(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++)for(var o=e[i]||"",s=n[i]||"";o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],(0!=o[0].length||0!=s[0].length)&&(t=X(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||X(0==o[2].length,0==s[2].length)||X(o[2],s[2]),o=o[3],s=s[3],0==t););return 0<=t},n=ht,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var lt=O.document&&nt&&(ut()||parseInt(tt,10))||void 0,ft=!nt||9<=Number(lt),pt=nt&&!ct("9"),dt=function(){if(!O.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{O.addEventListener("test",R,e),O.removeEventListener("test",R,e)}catch(t){}return t}();function yt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function vt(t,e){if(yt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ot){t:{try{Z(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:gt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}yt.prototype.b=function(){this.defaultPrevented=!0},M(vt,yt);var gt={2:"touch",3:"pen",4:"mouse"};vt.prototype.b=function(){vt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,pt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var mt="closure_listenable_"+(1e6*Math.random()|0),wt=0;function bt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++wt,this.Y=this.Z=!1}function Et(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Tt(t){this.src=t,this.a={},this.b=0}function It(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=q(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Et(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function At(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Tt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=At(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new bt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Nt="closure_lm_"+(1e6*Math.random()|0),Ot={};function Rt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Ct(r),e&&e[mt]?e.wa(n,r,S(i)?!!i.capture:!!i,o):kt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Rt(t,e[o],n,r,i);return null}return n=Ct(n),t&&t[mt]?t.va(e,n,S(r)?!!r.capture:!!r,i):kt(t,e,n,!1,r,i)}function kt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=S(i)?!!i.capture:!!i;if(s&&!ft)return null;var u,a,h=Lt(t);if(h||(t[Nt]=h=new Tt(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=_t,r=a=ft?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)dt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(St(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Dt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[mt]?It(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(St(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Lt(e))?(It(n,t),0==n.b&&(n.src=null,e[Nt]=null)):Et(t)))}function St(t){return t in Ot?Ot[t]:Ot[t]="on"+t}function Pt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Dt(t),n.call(r,e)}function _t(t,e){if(t.Y)return!0;if(ft)return Pt(t,new vt(e,this));if(!e)t:{e=["window","event"];for(var n=O,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Pt(t,e=new vt(e,this))}function Lt(t){return(t=t[Nt])instanceof Tt?t:null}var Vt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ct(e){return"function"==k(e)?e:(e[Vt]||(e[Vt]=function(t){return e.handleEvent(t)}),e[Vt])}function Ut(){x.call(this),this.c=new Tt(this),(this.J=this).C=null}function jt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new yt(e,t):e instanceof yt?e.target=e.target||t:(s=e,J(e=new yt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Mt(o,r,!0,e)&&s;if(s=Mt(o=e.a=t,r,!0,e)&&s,s=Mt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Mt(o=e.a=n[i],r,!1,e)&&s}function Mt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&It(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}M(Ut,x),Ut.prototype[mt]=!0,(at=Ut.prototype).addEventListener=function(t,e,n,r){Rt(this,t,e,n,r)},at.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=S(i)?!!i.capture:!!i,r=Ct(r),e&&e[mt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=At(s=e.a[n],r,i,o))&&(Et(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Lt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=At(n,r,i,o)),(r=-1<e?n[e]:null)&&Dt(r))}(this,t,e,n,r)},at.G=function(){if(Ut.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Et(n[r]);delete e.a[t],e.b--}}this.C=null},at.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},at.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var xt=O.JSON.stringify;function qt(){this.b=this.a=null}var Ft,Gt=(Bt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Bt(function(){return new Wt},function(t){t.reset()},100));function Bt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Wt(){this.next=this.b=this.a=null}function zt(t,e){var n;Ft||(n=O.Promise.resolve(void 0),Ft=function(){n.then(Yt)}),Ht||(Ft(),Ht=!0),Xt.add(t,e)}qt.prototype.add=function(t,e){var n=Gt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Wt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Ht=!(Wt.prototype.reset=function(){this.next=this.b=this.a=null}),Xt=new qt;function Yt(){for(var t,e;n=e=void 0,n=null,(e=Xt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){O.setTimeout(function(){throw t},0)}(t)}var n=Gt;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Ht=!1}function Kt(t,e){Ut.call(this),this.b=t||1,this.a=e||O,this.f=C(this.Xa,this),this.g=j()}function $t(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Qt(t,e,n){if("function"==k(t))n&&(t=C(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=C(t.handleEvent,t)}return 2147483647<Number(e)?-1:O.setTimeout(t,e||0)}M(Kt,Ut),(at=Kt.prototype).aa=!1,at.M=null,at.Xa=function(){var t;this.aa&&(0<(t=j()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),jt(this,"tick"),this.aa&&($t(this),this.start())))},at.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=j())},at.G=function(){Kt.X.G.call(this),$t(this),delete this.a};var Jt,Zt,te=(I(Zt=ne,Y=Jt=x),Zt.prototype=null===Y?Object.create(Y):(ee.prototype=Y.prototype,new ee),ne.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=Qt(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ne.prototype.G=function(){Jt.prototype.G.call(this),this.a&&(O.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ne);function ee(){this.constructor=Zt}function ne(t,e,n){var r=Jt.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function re(t){x.call(this),this.b=t,this.a={}}M(re,x);var ie=[];function oe(t,e,n,r){Array.isArray(n)||(n&&(ie[0]=n.toString()),n=ie);for(var i=0;i<n.length;i++){var o=Rt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function se(t){K(t.a,function(t,e){this.a.hasOwnProperty(e)&&Dt(t)},t),t.a={}}function ue(){this.a=!0}function ae(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return xt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}re.prototype.G=function(){re.X.G.call(this),se(this)},re.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ue.prototype.info=function(){};var he=null;function ce(){return he=he||new Ut}function le(t){yt.call(this,"serverreachability",t)}function fe(){var t=ce();jt(t,new le(t))}function pe(t){yt.call(this,"statevent",t)}function de(){var t=ce();jt(t,new pe(t))}function ye(t){yt.call(this,"timingevent",t)}function ve(t,e){if("function"!=k(t))throw Error("Fn must not be null and must be a function");return O.setTimeout(function(){t()},e)}M(le,yt),M(pe,yt),M(ye,yt);var ge={NO_ERROR:0,Ya:1,fb:2,eb:3,ab:4,cb:5,gb:6,Da:7,TIMEOUT:8,jb:9},me={$a:"complete",nb:"success",Ea:"error",Da:"abort",lb:"ready",mb:"readystatechange",TIMEOUT:"timeout",hb:"incrementaldata",kb:"progress",bb:"downloadprogress",ob:"uploadprogress"};function we(){}function be(t){var e;return(e=t.a)||(e=t.a={}),e}function Ee(){}we.prototype.a=null;var Te,N={OPEN:"a",Za:"b",Ea:"c",ib:"d"};function Ie(){yt.call(this,"d")}function Ae(){yt.call(this,"c")}function Ne(){}function Oe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new re(this),this.P=Re,t=it?125:void 0,this.R=new Kt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}M(Ie,yt),M(Ae,yt),M(Ne,we),Te=new Ne;var Re=45e3,ke={},De={};function Se(t,e,n){t.H=1,t.i=Qe(ze(e)),t.j=n,t.I=!0,Pe(t,null)}function Pe(t,e){t.u=j(),Le(t),t.l=ze(t.i);var s,u,a,h,c,l,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),ln(n.b,"t",r),t.D=0,t.a=ir(t.g,t.g.C?e:null),0<t.O&&(t.F=new te(C(t.Ca,t,t.a),t.O)),oe(t.J,t.a,"readystatechange",t.Va),e=t.B?$(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),fe(),s=t.c,u=t.m,a=t.l,h=t.f,c=t.S,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function _e(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?De:(i=Number(u.substring(i,o)),isNaN(i)?ke:(o+=1)+i>u.length?De:(u=u.substr(o,i),r.D=o+i,u)));if(u==De){4==e&&(t.h=4,de(),s=!1),ae(t.c,t.f,null,"[Incomplete Response]");break}if(u==ke){t.h=4,de(),ae(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}ae(t.c,t.f,u,null),Me(t,u)}4==e&&0==n.length&&(t.h=1,de(),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),$n(e),e.F=!0,de())):(ae(t.c,t.f,n,"[Invalid Chunked Response]"),je(t),Ue(t))}function Le(t){t.T=j()+t.P,Ve(t,t.P)}function Ve(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=ve(C(t.Ta,t),e)}function Ce(t){t.o&&(O.clearTimeout(t.o),t.o=null)}function Ue(t){0==t.g.v||t.A||Zn(t.g,t)}function je(t){Ce(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,$t(t.R),se(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Me(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||mn(u.b,t)))if(u.I=t.N,!t.C&&mn(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var h=a;if(0==h[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;Jn(u),Fn(u)}Kn(u),de()}}else u.oa=h[1],0<u.oa-u.P&&h[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=ve(C(u.Qa,u),6e3));if(gn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else er(u,11)}else if(!t.C&&u.a!=t||Jn(u),!W(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)h=e[a],u.P=h[0],h=h[1],2==u.v?"c"==h[0]?(u.J=h[1],u.ga=h[2],null!=(r=h[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=h[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=h[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(H(r,"spdy")||H(r,"quic")||H(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(wn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,$e(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=j()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=rr(n,n.C?n.ga:null,n.fa),i.C?(bn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Ce(o),Le(o)),n.a=i):Yn(n),0<u.g.length&&Wn(u)):"stop"!=h[0]&&"close"!=h[0]||er(u,7):3==u.v&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?er(u,7):qn(u):"noop"!=h[0]&&u.f&&u.f.sa(h),u.o=0);fe()}catch(t){}}function xe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(D(t)||"string"==typeof t)F(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(D(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(D(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function qe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof qe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Fe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ge(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Ge(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Ge(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(at=Oe.prototype).setTimeout=function(t){this.P=t},at.Va=function(t){t=t.target;var e=this.F;e&&3==Un(t)?e.f():this.Ca(t)},at.Ca=function(t){try{if(t==this.a)t:{var e=Un(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!it&&!this.a.$())){this.A||4!=e||7==n||fe(),Ce(this);var i=this.a.W();if(this.N=i,n=this.a.$(),this.b=200==i,r=this.c,u=this.m,a=this.l,h=this.f,c=this.S,l=e,f=i,r.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+c+"]: "+u+"\n"+a+"\n"+l+" "+f}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!W(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,de(),je(this),Ue(this);break t}ae(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Me(this,s)}this.I?(_e(this,e,n),it&&this.b&&3==e&&(oe(this.J,this.R,"tick",this.Ua),this.R.start())):(ae(this.c,this.f,n,null),Me(this,n)),4==e&&je(this),this.b&&!this.A&&(4==e?Zn(this.g,this):(this.b=!1,Le(this)))}else 400==i&&0<n.indexOf("Unknown SID")?this.h=3:this.h=0,de(),je(this),Ue(this)}}}catch(t){}var u,a,h,c,l,f},at.Ua=function(){var t,e;this.a&&(t=Un(this.a),e=this.a.$(),this.D<e.length&&(Ce(this),_e(this,t,e),this.b&&4!=t&&Le(this)))},at.cancel=function(){this.A=!0,je(this)},at.Ta=function(){this.o=null;var t,e,n=j();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(fe(),de()),je(this),this.h=2,Ue(this)):Ve(this,this.T-n)},(at=qe.prototype).K=function(){Fe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},at.L=function(){return Fe(this),this.a.concat()},at.get=function(t,e){return Ge(this.b,t)?this.b[t]:e},at.set=function(t,e){Ge(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},at.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Be=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function We(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof We?(this.a=void 0!==e?e:t.a,He(this,t.f),this.j=t.j,Xe(this,t.c),Ye(this,t.h),this.g=t.g,e=t.b,(n=new un).c=e.c,e.a&&(n.a=new qe(e.a),n.b=e.b),Ke(this,n),this.i=t.i):t&&(n=String(t).match(Be))?(this.a=!!e,He(this,n[1]||"",!0),this.j=Je(n[2]||""),Xe(this,n[3]||"",!0),Ye(this,n[4]),this.g=Je(n[5]||"",!0),Ke(this,n[6]||"",!0),this.i=Je(n[7]||"")):(this.a=!!e,this.b=new un(null,this.a))}function ze(t){return new We(t)}function He(t,e,n){t.f=n?Je(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Xe(t,e,n){t.c=n?Je(e,!0):e}function Ye(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Ke(t,e,n){var r,i;e instanceof un?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(an(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(hn(this,e),ln(this,n,t))},r)),r.f=i):(n||(e=Ze(e,on)),t.b=new un(e,t.a))}function $e(t,e,n){t.b.set(e,n)}function Qe(t){return $e(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^j()).toString(36)),t}function Je(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ze(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,tn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function tn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}We.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Ze(e,en,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(Ze(e,en,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Ze(n,"/"==n.charAt(0)?rn:nn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Ze(n,sn)),t.join("")};var en=/[#\/\?@]/g,nn=/[#\?:]/g,rn=/[#\?]/g,on=/[#\?@]/g,sn=/#/g;function un(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function an(o){o.a||(o.a=new qe,o.b=0,o.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],r=n,i=i?decodeURIComponent(i.replace(/\+/g," ")):"",o.add(decodeURIComponent(r.replace(/\+/g," ")),i)}}}(o.c))}function hn(t,e){an(t),e=fn(t,e),Ge(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ge((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Fe(t)))}function cn(t,e){return an(t),e=fn(t,e),Ge(t.a.b,e)}function ln(t,e,n){hn(t,e),0<n.length&&(t.c=null,t.a.set(fn(t,e),B(n)),t.b+=n.length)}function fn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function pn(t,e){this.b=t,this.a=e}function dn(t){this.g=t||yn,t=O.PerformanceNavigationTiming?0<(t=O.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(O.ia&&O.ia.ya&&O.ia.ya()&&O.ia.ya().pb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(at=un.prototype).add=function(t,e){an(this),this.c=null,t=fn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},at.forEach=function(n,r){an(this),this.a.forEach(function(t,e){F(t,function(t){n.call(r,t,e,this)},this)},this)},at.L=function(){an(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},at.K=function(t){an(this);var e=[];if("string"==typeof t)cn(this,t)&&(e=G(e,this.a.get(fn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=G(e,t[n])}return e},at.set=function(t,e){return an(this),this.c=null,cn(this,t=fn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},at.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},at.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var yn=10;function vn(t){return t.b||t.a&&t.a.size>=t.f}function gn(t){return t.b?1:t.a?t.a.size:0}function mn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function wn(t,e){t.a?t.a.add(e):t.b=e}function bn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function En(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return B(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Tn(){}function In(){this.a=new Tn}function An(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}dn.prototype.cancel=function(){var t,e;if(this.c=En(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Tn.prototype.stringify=function(t){return O.JSON.stringify(t,void 0)},Tn.prototype.parse=function(t){return O.JSON.parse(t,void 0)};var Nn=O.JSON.parse;function On(t){Ut.call(this),this.headers=new qe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Rn,this.D=this.F=!1}M(On,Ut);var Rn="",kn=/^https?$/i,Dn=["POST","PUT"];function Sn(t){return"content-type"==t.toLowerCase()}function Pn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,_n(t),Vn(t)}function _n(t){t.u||(t.u=!0,jt(t,"complete"),jt(t,"error"))}function Ln(t){if(t.b&&(!t.s[1]||4!=Un(t)||2!=t.W()))if(t.l&&4==Un(t))Qt(t.za,0,t);else if(jt(t,"readystatechange"),4==Un(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Be)[1]||null)&&O.self&&O.self.location&&(i=(r=O.self.location.protocol).substr(0,r.length-1)),n=!kn.test(i?i.toLowerCase():"")),e=n),e)jt(t,"complete"),jt(t,"success");else{t.h=6;try{var u=2<Un(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.W()+"]",_n(t)}}finally{Vn(t)}}}function Vn(t,e){if(t.a){Cn(t);var n=t.a,r=t.s[0]?R:null;t.a=null,t.s=null,e||jt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Cn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(O.clearTimeout(t.m),t.m=null)}function Un(t){return t.a?t.a.readyState:0}function jn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",K(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):$e(t,e,n))}function Mn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function xn(t){this.pa=0,this.g=[],this.c=new ue,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Ma=this.R=0,this.Ja=Mn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Fa=Mn("baseRetryDelayMs",5e3,t),this.Pa=Mn("retryDelaySeedMs",1e4,t),this.Ka=Mn("forwardChannelMaxRetries",2,t),this.ma=Mn("forwardChannelRequestTimeoutMs",2e4,t),this.La=t&&t.h||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new dn(t&&t.concurrentRequestLimit),this.ka=new In,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.g&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ia=t&&t.f||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function qn(t){var e,n;Gn(t),3==t.v&&(e=t.R++,$e(n=ze(t.B),"SID",t.J),$e(n,"RID",e),$e(n,"TYPE","terminate"),Hn(t,n),(e=new Oe(t,t.c,e,void 0)).H=2,e.i=Qe(ze(n)),n=!1,O.navigator&&O.navigator.sendBeacon&&(n=O.navigator.sendBeacon(e.i.toString(),"")),!n&&O.Image&&((new Image).src=e.i,n=!0),n||(e.a=ir(e.g,null),e.a.ba(e.i)),e.u=j(),Le(e)),nr(t)}function Fn(t){t.a&&($n(t),t.a.cancel(),t.a=null)}function Gn(t){Fn(t),t.j&&(O.clearTimeout(t.j),t.j=null),Jn(t),t.b.cancel(),t.h&&("number"==typeof t.h&&O.clearTimeout(t.h),t.h=null)}function Bn(t,e){t.g.push(new pn(t.Ma++,e)),3==t.v&&Wn(t)}function Wn(t){vn(t.b)||t.h||(t.h=!0,zt(t.Ba,t),t.u=0)}function zn(t,e){var n=e?e.f:t.R++,r=ze(t.B);$e(r,"SID",t.J),$e(r,"RID",n),$e(r,"AID",t.P),Hn(t,r),t.i&&t.l&&jn(r,t.i,t.l),n=new Oe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Xn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),wn(t.b,n),Se(n,r,e)}function Hn(t,n){t.f&&xe({},function(t,e){$e(n,e,t)})}function Xn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?C(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+h+"_"||"";try{xe(t,function(t,e){var n=t;S(t)&&(n=xt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s)}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Yn(t){t.a||t.j||(t.T=1,zt(t.Aa,t),t.o=0)}function Kn(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=ve(C(t.Aa,t),tr(t,t.o)),t.o++,1)}function $n(t){null!=t.s&&(O.clearTimeout(t.s),t.s=null)}function Qn(t){t.a=new Oe(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=ze(t.la);$e(e,"RID","rpc"),$e(e,"SID",t.J),$e(e,"CI",t.H?"0":"1"),$e(e,"AID",t.P),Hn(t,e),$e(e,"TYPE","xmlhttp"),t.i&&t.l&&jn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=Qe(ze(e)),n.j=null,n.I=!0,Pe(n,t)}function Jn(t){null!=t.m&&(O.clearTimeout(t.m),t.m=null)}function Zn(t,e){var n,r,i,o=null;if(t.a==e){Jn(t),$n(t),t.a=null;var s=2}else{if(!mn(t.b,e))return;o=e.s,bn(t.b,e),s=1}if(t.I=e.N,0!=t.v)if(e.b)1==s?(o=e.j?e.j.length:0,e=j()-e.u,n=t.u,jt(s=ce(),new ye(s)),Wn(t)):Yn(t);else if(3==(n=e.h)||0==n&&0<t.I||(1!=s||(i=e,gn((r=t).b)>=r.b.f-(r.h?1:0)||(r.h?(r.g=i.s.concat(r.g),0):1==r.v||2==r.v||r.u>=(r.Ja?0:r.Ka)||(r.h=ve(C(r.Ba,r,i),tr(r,r.u)),r.u++,0))))&&(2!=s||!Kn(t)))switch(o&&0<o.length&&(e=t.b,e.c=e.c.concat(o)),n){case 1:er(t,5);break;case 4:er(t,10);break;case 3:er(t,6);break;default:er(t,2)}}function tr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Pa);return t.f||(n*=2),n*e}function er(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=C(t.Wa,t),r||(r=new We("//www.google.com/images/cleardot.gif"),O.location&&"http"==O.location.protocol||He(r,"https"),Qe(r)),n=r.toString(),r=o,o=new ue,O.Image?((i=new Image).onload=U(An,o,i,"TestLoadImage: loaded",!0,r),i.onerror=U(An,o,i,"TestLoadImage: error",!1,r),i.onabort=U(An,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=U(An,o,i,"TestLoadImage: timeout",!1,r),O.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):de(),t.v=0,t.f&&t.f.ra(e),nr(t),Gn(t)}function nr(t){t.v=0,t.I=-1,t.f&&(0==En(t.b).length&&0==t.g.length||(t.b.c.length=0,B(t.g),t.g.length=0),t.f.qa())}function rr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof We?ze(s):new We(s,void 0);return""!=a.c?(e&&Xe(a,e+"."+a.c),Ye(a,a.h)):(r=(u=O.location).protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new We(null,void 0),r&&He(u,r),i&&Xe(u,i),o&&Ye(u,o),s&&(u.g=s),a=u),t.V&&K(t.V,function(t,e){$e(a,e,t)}),e=t.A,n=t.na,e&&n&&$e(a,e,n),$e(a,"VER",t.ha),Hn(t,a),a}function ir(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new On(t.La)).F=t.C,e}function or(){}function sr(){if(nt&&!(10<=Number(lt)))throw Error("Environmental error: no available transport.")}function ur(t,e){Ut.call(this),this.a=new xn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!W(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!W(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new cr(this)}function ar(t){Ie.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function hr(){Ae.call(this),this.status=1}function cr(t){this.a=t}(at=On.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?be(this.H):be(Te),this.a.onreadystatechange=C(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Pn(this,t)}t=n||"";var i,o=new qe(this.headers);r&&xe(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Sn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=O.FormData&&t instanceof O.FormData,0<=q(Dn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Cn(this),0<this.o&&((this.D=(i=this.a,nt&&ct(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=C(this.xa,this)):this.m=Qt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Pn(this,t)}},at.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,jt(this,"timeout"),this.abort(8))},at.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,jt(this,"complete"),jt(this,"abort"),Vn(this))},at.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Vn(this,!0)),On.X.G.call(this)},at.za=function(){this.j||(this.A||this.l||this.g?Ln(this):this.Sa())},at.Sa=function(){Ln(this)},at.W=function(){try{return 2<Un(this)?this.a.status:-1}catch(t){return-1}},at.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},at.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Nn(e)}},at.ua=function(){return this.h},at.Oa=function(){return"string"==typeof this.f?this.f:String(this.f)},(at=xn.prototype).ha=8,at.v=1,at.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Oe(this,this.c,t,void 0),r=this.l;if(this.O&&(r?J(r=$(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Xn(this,n,e),$e(i=ze(this.B),"RID",t),$e(i,"CVER",22),this.A&&$e(i,"X-HTTP-Session-Id",this.A),Hn(this,i),this.i&&r&&jn(i,this.i,r),wn(this.b,n),this.Ga&&$e(i,"TYPE","init"),this.da?($e(i,"$req",e),$e(i,"SID","null"),n.U=!0,Se(n,i,null)):Se(n,i,e),this.v=2}}else 3==this.v&&(t?zn(this,t):0==this.g.length||vn(this.b)||zn(this))},at.Aa=function(){var t;this.j=null,Qn(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=ve(C(this.Ra,this),t))},at.Ra=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,de(),Fn(this),Qn(this))},at.Qa=function(){null!=this.m&&(this.m=null,Fn(this),Kn(this),de())},at.Wa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),de()},(at=or.prototype).ta=function(){},at.sa=function(){},at.ra=function(){},at.qa=function(){},at.Ha=function(){},sr.prototype.a=function(t,e){return new ur(t,e)},M(ur,Ut),ur.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;de(),t.fa=e,t.V=n||{},t.H=t.S,t.B=rr(t,null,t.fa),Wn(t)},ur.prototype.close=function(){qn(this.a)},ur.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Bn(this.a,e)):this.l?((e={}).__data__=xt(t),Bn(this.a,e)):Bn(this.a,t)},ur.prototype.G=function(){this.a.f=null,delete this.f,qn(this.a),delete this.a,ur.X.G.call(this)},M(ar,Ie),M(hr,Ae),M(cr,or),cr.prototype.ta=function(){jt(this.a,"a")},cr.prototype.sa=function(t){jt(this.a,new ar(t))},cr.prototype.ra=function(t){jt(this.a,new hr)},cr.prototype.qa=function(){jt(this.a,"b")},sr.prototype.createWebChannel=sr.prototype.a,ur.prototype.send=ur.prototype.h,ur.prototype.open=ur.prototype.g,ge.NO_ERROR=0,ge.TIMEOUT=8,ge.HTTP_ERROR=6,me.COMPLETE="complete",(Ee.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",Ut.prototype.listen=Ut.prototype.va,On.prototype.listenOnce=On.prototype.wa,On.prototype.getLastError=On.prototype.Oa,On.prototype.getLastErrorCode=On.prototype.ua,On.prototype.getStatus=On.prototype.W,On.prototype.getResponseJson=On.prototype.Na,On.prototype.getResponseText=On.prototype.$,On.prototype.send=On.prototype.ba;var lr=ge,fr=me,pr=Ee,dr=On,ge=(yr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},yr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},yr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},yr);function yr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var vr=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},gr=(Object.defineProperty(br.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),br.prototype.isEqual=function(t){return t instanceof br&&t.projectId===this.projectId&&t.database===this.database},br),mr=(wr.prototype.u=function(){return null!=this.uid},wr.prototype.h=function(){return this.u()?"uid:"+this.uid:"anonymous-user"},wr.prototype.isEqual=function(t){return t.uid===this.uid},wr);function wr(t){this.uid=t}function br(t,e){this.projectId=t,this.database=e||"(default)"}mr.UNAUTHENTICATED=new mr(null),mr.l=new mr("google-credentials-uid"),mr._=new mr("first-party-uid");var Er="8.1.0-202010180421",Tr=new l("@firebase/firestore");function Ir(){return Tr.logLevel}function Ar(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Tr.logLevel<=u.DEBUG&&(e=n.map(Rr),Tr.debug.apply(Tr,s(["Firestore ("+Er+"): "+t],e)))}function Nr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Tr.logLevel<=u.ERROR&&(e=n.map(Rr),Tr.error.apply(Tr,s(["Firestore ("+Er+"): "+t],e)))}function Or(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Tr.logLevel<=u.WARN&&(e=n.map(Rr),Tr.warn.apply(Tr,s(["Firestore ("+Er+"): "+t],e)))}function Rr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function kr(t){throw void 0===t&&(t="Unexpected state"),Nr(t="FIRESTORE ("+Er+") INTERNAL ASSERTION FAILED: "+t),new Error(t)}function Dr(t){t||kr()}function Sr(t,e){this.user=e,this.type="OAuth",this.m={},this.m.Authorization="Bearer "+t}var Pr,_r={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Lr=(n(Gr,Pr=Error),Gr),Vr=(Fr.prototype.getToken=function(){return Promise.resolve(null)},Fr.prototype.A=function(){},Fr.prototype.I=function(t){(this.T=t)(mr.UNAUTHENTICATED)},Fr.prototype.R=function(){this.T=null},Fr),Cr=(qr.prototype.getToken=function(){var e=this,n=this.p,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.p!==n?(Ar("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Dr("string"==typeof t.accessToken),new Sr(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},qr.prototype.A=function(){this.forceRefresh=!0},qr.prototype.I=function(t){this.T=t,this.V&&t(this.currentUser)},qr.prototype.R=function(){this.auth&&this.auth.removeAuthTokenListener(this.P),this.P=null,this.T=null},qr.prototype.g=function(){var t=this.auth&&this.auth.getUid();return Dr(null===t||"string"==typeof t),new mr(t)},qr),Ur=(Object.defineProperty(xr.prototype,"m",{get:function(){var t={"X-Goog-AuthUser":this.C},e=this.v.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),xr),jr=(Mr.prototype.getToken=function(){return Promise.resolve(new Ur(this.v,this.C))},Mr.prototype.I=function(t){t(mr._)},Mr.prototype.R=function(){},Mr.prototype.A=function(){},Mr);function Mr(t,e){this.v=t,this.C=e}function xr(t,e){this.v=t,this.C=e,this.type="FirstParty",this.user=mr._}function qr(t){var e=this;this.P=null,this.currentUser=mr.UNAUTHENTICATED,this.V=!1,this.p=0,this.T=null,this.forceRefresh=!1,this.P=function(){e.p++,e.currentUser=e.g(),e.V=!0,e.T&&e.T(e.currentUser)},this.p=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.P):(this.P(null),t.get().then(function(t){e.auth=t,e.P&&e.auth.addAuthTokenListener(e.P)},function(){}))}function Fr(){this.T=null}function Gr(t,e){var n=this;return(n=Pr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}var Br=(Wr.S=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Wr);function Wr(){}function zr(t,e){return t<e?-1:e<t?1:0}function Hr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var Xr,Yr,Kr=(si.now=function(){return si.fromMillis(Date.now())},si.fromDate=function(t){return si.fromMillis(t.getTime())},si.fromMillis=function(t){var e=Math.floor(t/1e3);return new si(e,1e6*(t-1e3*e))},si.prototype.toDate=function(){return new Date(this.toMillis())},si.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},si.prototype.D=function(t){return this.seconds===t.seconds?zr(this.nanoseconds,t.nanoseconds):zr(this.seconds,t.seconds)},si.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},si.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},si.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},si.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},si),$r=(oi.N=function(t){return new oi(t)},oi.min=function(){return new oi(new Kr(0,0))},oi.prototype.F=function(t){return this.timestamp.D(t.timestamp)},oi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},oi.prototype.O=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},oi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},oi.prototype.$=function(){return this.timestamp},oi),me=(Object.defineProperty(ii.prototype,"length",{get:function(){return this.L},enumerable:!1,configurable:!0}),ii.prototype.isEqual=function(t){return 0===ii.k(this,t)},ii.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ii?t.forEach(function(t){e.push(t)}):e.push(t),this.M(e)},ii.prototype.limit=function(){return this.offset+this.length},ii.prototype.U=function(t){return t=void 0===t?1:t,this.M(this.segments,this.offset+t,this.length-t)},ii.prototype.q=function(){return this.M(this.segments,this.offset,this.length-1)},ii.prototype.B=function(){return this.segments[this.offset]},ii.prototype.j=function(){return this.get(this.length-1)},ii.prototype.get=function(t){return this.segments[this.offset+t]},ii.prototype.W=function(){return 0===this.length},ii.prototype.G=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ii.prototype.K=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ii.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ii.prototype.H=function(){return this.segments.slice(this.offset,this.limit())},ii.k=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ii),Qr=(n(ri,Yr=me),ri.prototype.M=function(t,e,n){return new ri(t,e,n)},ri.prototype.Y=function(){return this.H().join("/")},ri.prototype.toString=function(){return this.Y()},ri.J=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Lr(_r.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new ri(n)},ri.X=function(){return new ri([])},ri),Jr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Zr=(n(ni,Xr=me),ni.prototype.M=function(t,e,n){return new ni(t,e,n)},ni.Z=function(t){return Jr.test(t)},ni.prototype.Y=function(){return this.H().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),ni.Z(t)||(t="`"+t+"`"),t}).join(".")},ni.prototype.toString=function(){return this.Y()},ni.prototype.tt=function(){return 1===this.length&&"__name__"===this.get(0)},ni.nt=function(){return new ni(["__name__"])},ni.et=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Lr(_r.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Lr(_r.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Lr(_r.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Lr(_r.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ni(e)},ni.X=function(){return new ni([])},ni),ti=(ei.st=function(t){return new ei(Qr.J(t))},ei.it=function(t){return new ei(Qr.J(t).U(5))},ei.prototype.rt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ei.prototype.isEqual=function(t){return null!==t&&0===Qr.k(this.path,t.path)},ei.prototype.toString=function(){return this.path.toString()},ei.k=function(t,e){return Qr.k(t.path,e.path)},ei.ot=function(t){return t.length%2==0},ei.ut=function(t){return new ei(new Qr(t.slice()))},ei);function ei(t){this.path=t}function ni(){return null!==Xr&&Xr.apply(this,arguments)||this}function ri(){return null!==Yr&&Yr.apply(this,arguments)||this}function ii(t,e,n){void 0===e?e=0:e>t.length&&kr(),void 0===n?n=t.length-e:n>t.length-e&&kr(),this.segments=t,this.offset=e,this.L=n}function oi(t){this.timestamp=t}function si(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Lr(_r.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Lr(_r.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Lr(_r.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Lr(_r.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function ui(t){return null==t}function ai(t){return 0===t&&1/t==-1/0}var hi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.ct=null};function ci(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new hi(t,e,n,r,i,o,s)}function li(t){var e=t;return null===e.ct&&(t=e.path.Y(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return t.field.Y()+t.op.toString()+vo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return t.field.Y()+t.dir}).join(","),ui(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=qu(e.startAt)),e.endAt&&(t+="|ub:",t+=qu(e.endAt)),e.ct=t),e.ct}function fi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!lo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Gu(t.startAt,e.startAt)&&Gu(t.endAt,e.endAt)}function pi(t){return ti.ot(t.path)&&null===t.collectionGroup&&0===t.filters.length}var di=(yi.fromBase64String=function(t){return new yi(atob(t))},yi.fromUint8Array=function(t){return new yi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},yi.prototype.toBase64=function(){return t=this.at,btoa(t);var t},yi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.at)},yi.prototype.ht=function(){return 2*this.at.length},yi.prototype.F=function(t){return zr(this.at,t.at)},yi.prototype.isEqual=function(t){return this.at===t.at},yi);function yi(t){this.at=t}function vi(t){this.count=t}di.lt=new di("");var gi,mi=(wi.prototype.dt=function(t){return new wi(this.target,this.targetId,this._t,t,this.ft,this.lastLimboFreeSnapshotVersion,this.resumeToken)},wi.prototype.wt=function(t,e){return new wi(this.target,this.targetId,this._t,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},wi.prototype.Et=function(t){return new wi(this.target,this.targetId,this._t,this.sequenceNumber,this.ft,t,this.resumeToken)},wi);function wi(t,e,n,r,i,o,s){void 0===i&&(i=$r.min()),void 0===o&&(o=$r.min()),void 0===s&&(s=di.lt),this.target=t,this.targetId=e,this._t=n,this.sequenceNumber=r,this.ft=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function bi(t){switch(t){case _r.OK:return kr(),0;case _r.CANCELLED:case _r.UNKNOWN:case _r.DEADLINE_EXCEEDED:case _r.RESOURCE_EXHAUSTED:case _r.INTERNAL:case _r.UNAVAILABLE:case _r.UNAUTHENTICATED:return;case _r.INVALID_ARGUMENT:case _r.NOT_FOUND:case _r.ALREADY_EXISTS:case _r.PERMISSION_DENIED:case _r.FAILED_PRECONDITION:case _r.ABORTED:case _r.OUT_OF_RANGE:case _r.UNIMPLEMENTED:case _r.DATA_LOSS:return 1;default:return kr(),0}}function Ei(t){if(void 0===t)return Nr("GRPC error has no .code"),_r.UNKNOWN;switch(t){case gi.OK:return _r.OK;case gi.CANCELLED:return _r.CANCELLED;case gi.UNKNOWN:return _r.UNKNOWN;case gi.DEADLINE_EXCEEDED:return _r.DEADLINE_EXCEEDED;case gi.RESOURCE_EXHAUSTED:return _r.RESOURCE_EXHAUSTED;case gi.INTERNAL:return _r.INTERNAL;case gi.UNAVAILABLE:return _r.UNAVAILABLE;case gi.UNAUTHENTICATED:return _r.UNAUTHENTICATED;case gi.INVALID_ARGUMENT:return _r.INVALID_ARGUMENT;case gi.NOT_FOUND:return _r.NOT_FOUND;case gi.ALREADY_EXISTS:return _r.ALREADY_EXISTS;case gi.PERMISSION_DENIED:return _r.PERMISSION_DENIED;case gi.FAILED_PRECONDITION:return _r.FAILED_PRECONDITION;case gi.ABORTED:return _r.ABORTED;case gi.OUT_OF_RANGE:return _r.OUT_OF_RANGE;case gi.UNIMPLEMENTED:return _r.UNIMPLEMENTED;case gi.DATA_LOSS:return _r.DATA_LOSS;default:return kr()}}(l=gi={})[l.OK=0]="OK",l[l.CANCELLED=1]="CANCELLED",l[l.UNKNOWN=2]="UNKNOWN",l[l.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",l[l.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",l[l.NOT_FOUND=5]="NOT_FOUND",l[l.ALREADY_EXISTS=6]="ALREADY_EXISTS",l[l.PERMISSION_DENIED=7]="PERMISSION_DENIED",l[l.UNAUTHENTICATED=16]="UNAUTHENTICATED",l[l.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",l[l.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",l[l.ABORTED=10]="ABORTED",l[l.OUT_OF_RANGE=11]="OUT_OF_RANGE",l[l.UNIMPLEMENTED=12]="UNIMPLEMENTED",l[l.INTERNAL=13]="INTERNAL",l[l.UNAVAILABLE=14]="UNAVAILABLE",l[l.DATA_LOSS=15]="DATA_LOSS";var Ti=(Ri.prototype.Tt=function(t,e){return new Ri(this.k,this.root.Tt(t,e,this.k).copy(null,null,Ai.At,null,null))},Ri.prototype.remove=function(t){return new Ri(this.k,this.root.remove(t,this.k).copy(null,null,Ai.At,null,null))},Ri.prototype.get=function(t){for(var e=this.root;!e.W();){var n=this.k(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Ri.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.W();){var r=this.k(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Ri.prototype.W=function(){return this.root.W()},Object.defineProperty(Ri.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Ri.prototype.It=function(){return this.root.It()},Ri.prototype.Rt=function(){return this.root.Rt()},Ri.prototype.Pt=function(t){return this.root.Pt(t)},Ri.prototype.forEach=function(n){this.Pt(function(t,e){return n(t,e),!1})},Ri.prototype.toString=function(){var n=[];return this.Pt(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Ri.prototype.yt=function(t){return this.root.yt(t)},Ri.prototype.Vt=function(){return new Ii(this.root,null,this.k,!1)},Ri.prototype.gt=function(t){return new Ii(this.root,t,this.k,!1)},Ri.prototype.vt=function(){return new Ii(this.root,null,this.k,!0)},Ri.prototype.bt=function(t){return new Ii(this.root,t,this.k,!0)},Ri),Ii=(Oi.prototype.Dt=function(){var t=this.St.pop(),e={key:t.key,value:t.value};if(this.Ct)for(t=t.left;!t.W();)this.St.push(t),t=t.right;else for(t=t.right;!t.W();)this.St.push(t),t=t.left;return e},Oi.prototype.Nt=function(){return 0<this.St.length},Oi.prototype.xt=function(){if(0===this.St.length)return null;var t=this.St[this.St.length-1];return{key:t.key,value:t.value}},Oi),Ai=(Ni.prototype.copy=function(t,e,n,r,i){return new Ni(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Ni.prototype.W=function(){return!1},Ni.prototype.Pt=function(t){return this.left.Pt(t)||t(this.key,this.value)||this.right.Pt(t)},Ni.prototype.yt=function(t){return this.right.yt(t)||t(this.key,this.value)||this.left.yt(t)},Ni.prototype.min=function(){return this.left.W()?this:this.left.min()},Ni.prototype.It=function(){return this.min().key},Ni.prototype.Rt=function(){return this.right.W()?this.key:this.right.Rt()},Ni.prototype.Tt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Tt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Tt(t,e,n))).Ft()},Ni.prototype.Ot=function(){if(this.left.W())return Ni.EMPTY;var t=this;return t.left.$t()||t.left.left.$t()||(t=t.Lt()),(t=t.copy(null,null,null,t.left.Ot(),null)).Ft()},Ni.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.W()||r.left.$t()||r.left.left.$t()||(r=r.Lt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.$t()&&(r=r.kt()),r.right.W()||r.right.$t()||r.right.left.$t()||(r=r.Mt()),0===e(t,r.key)){if(r.right.W())return Ni.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Ot())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Ft()},Ni.prototype.$t=function(){return this.color},Ni.prototype.Ft=function(){var t=this;return t.right.$t()&&!t.left.$t()&&(t=t.Ut()),t.left.$t()&&t.left.left.$t()&&(t=t.kt()),t.left.$t()&&t.right.$t()&&(t=t.qt()),t},Ni.prototype.Lt=function(){var t=this.qt();return t.right.left.$t()&&(t=(t=(t=t.copy(null,null,null,null,t.right.kt())).Ut()).qt()),t},Ni.prototype.Mt=function(){var t=this.qt();return t.left.left.$t()&&(t=(t=t.kt()).qt()),t},Ni.prototype.Ut=function(){var t=this.copy(null,null,Ni.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Ni.prototype.kt=function(){var t=this.copy(null,null,Ni.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Ni.prototype.qt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Ni.prototype.Bt=function(){var t=this.Qt();return Math.pow(2,t)<=this.size+1},Ni.prototype.Qt=function(){if(this.$t()&&this.left.$t())throw kr();if(this.right.$t())throw kr();var t=this.left.Qt();if(t!==this.right.Qt())throw kr();return t+(this.$t()?0:1)},Ni);function Ni(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Ni.RED,this.left=null!=r?r:Ni.EMPTY,this.right=null!=i?i:Ni.EMPTY,this.size=this.left.size+1+this.right.size}function Oi(t,e,n,r){this.Ct=r,this.St=[];for(var i=1;!t.W();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Ct?t.left:t.right;else{if(0===i){this.St.push(t);break}this.St.push(t),t=this.Ct?t.right:t.left}}function Ri(t,e){this.k=t,this.root=e||Ai.EMPTY}function ki(){this.size=0}Ai.EMPTY=null,Ai.RED=!0,Ai.At=!1,Ai.EMPTY=(Object.defineProperty(ki.prototype,"key",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(ki.prototype,"value",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(ki.prototype,"color",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(ki.prototype,"left",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(ki.prototype,"right",{get:function(){throw kr()},enumerable:!1,configurable:!0}),ki.prototype.copy=function(t,e,n,r,i){return this},ki.prototype.Tt=function(t,e,n){return new Ai(t,e)},ki.prototype.remove=function(t,e){return this},ki.prototype.W=function(){return!0},ki.prototype.Pt=function(t){return!1},ki.prototype.yt=function(t){return!1},ki.prototype.It=function(){return null},ki.prototype.Rt=function(){return null},ki.prototype.$t=function(){return!1},ki.prototype.Bt=function(){return!0},ki.prototype.Qt=function(){return 0},new ki);var Di=(Li.prototype.has=function(t){return null!==this.data.get(t)},Li.prototype.first=function(){return this.data.It()},Li.prototype.last=function(){return this.data.Rt()},Object.defineProperty(Li.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Li.prototype.indexOf=function(t){return this.data.indexOf(t)},Li.prototype.forEach=function(n){this.data.Pt(function(t,e){return n(t),!1})},Li.prototype.jt=function(t,e){for(var n=this.data.gt(t[0]);n.Nt();){var r=n.Dt();if(0<=this.k(r.key,t[1]))return;e(r.key)}},Li.prototype.Wt=function(t,e){for(var n=void 0!==e?this.data.gt(e):this.data.Vt();n.Nt();)if(!t(n.Dt().key))return},Li.prototype.Gt=function(t){return(t=this.data.gt(t)).Nt()?t.Dt().key:null},Li.prototype.Vt=function(){return new Si(this.data.Vt())},Li.prototype.gt=function(t){return new Si(this.data.gt(t))},Li.prototype.add=function(t){return this.copy(this.data.remove(t).Tt(t,!0))},Li.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Li.prototype.W=function(){return this.data.W()},Li.prototype.Kt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Li.prototype.isEqual=function(t){if(!(t instanceof Li))return!1;if(this.size!==t.size)return!1;for(var e=this.data.Vt(),n=t.data.Vt();e.Nt();){var r=e.Dt().key,i=n.Dt().key;if(0!==this.k(r,i))return!1}return!0},Li.prototype.H=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Li.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Li.prototype.copy=function(t){var e=new Li(this.k);return e.data=t,e},Li),Si=(_i.prototype.Dt=function(){return this.zt.Dt().key},_i.prototype.Nt=function(){return this.zt.Nt()},_i),Pi=new Ti(ti.k);function _i(t){this.zt=t}function Li(t){this.k=t,this.data=new Ti(this.k)}var Vi=new Ti(ti.k),Ci=new Ti(ti.k),Ui=new Di(ti.k);function ji(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Ui,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Mi=new Di(zr),xi=(eo.Jt=function(t){return new eo(t.k)},eo.prototype.has=function(t){return null!=this.Ht.get(t)},eo.prototype.get=function(t){return this.Ht.get(t)},eo.prototype.first=function(){return this.Yt.It()},eo.prototype.last=function(){return this.Yt.Rt()},eo.prototype.W=function(){return this.Yt.W()},eo.prototype.indexOf=function(t){return(t=this.Ht.get(t))?this.Yt.indexOf(t):-1},Object.defineProperty(eo.prototype,"size",{get:function(){return this.Yt.size},enumerable:!1,configurable:!0}),eo.prototype.forEach=function(n){this.Yt.Pt(function(t,e){return n(t),!1})},eo.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ht.Tt(t.key,t),e.Yt.Tt(t,null))},eo.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ht.remove(t),this.Yt.remove(e)):this},eo.prototype.isEqual=function(t){if(!(t instanceof eo))return!1;if(this.size!==t.size)return!1;for(var e=this.Yt.Vt(),n=t.Yt.Vt();e.Nt();){var r=e.Dt().key,i=n.Dt().key;if(!r.isEqual(i))return!1}return!0},eo.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},eo.prototype.copy=function(t,e){var n=new eo;return n.k=this.k,n.Ht=t,n.Yt=e,n},eo),qi=(to.prototype.track=function(t){var e=t.doc.key,n=this.Xt.get(e);!n||0!==t.type&&3===n.type?this.Xt=this.Xt.Tt(e,t):3===t.type&&1!==n.type?this.Xt=this.Xt.Tt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Xt=this.Xt.Tt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Xt=this.Xt.remove(e):1===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):kr()},to.prototype.Zt=function(){var n=[];return this.Xt.Pt(function(t,e){n.push(e)}),n},to),Fi=(Zi.rn=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Zi(t,e,xi.Jt(e),i,n,r,!0,!1)},Object.defineProperty(Zi.prototype,"hasPendingWrites",{get:function(){return!this.nn.W()},enumerable:!1,configurable:!0}),Zi.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.en===t.en&&this.nn.isEqual(t.nn)&&hu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.tn.isEqual(t.tn)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Zi),Gi=(Ji.hn=function(t,e){var n=new Map;return n.set(t,Bi.ln(t,e)),new Ji($r.min(),n,Mi,Pi,ji())},Ji),Bi=(Qi.ln=function(t,e){return new Qi(di.lt,e,ji(),ji(),ji())},Qi),Wi=function(t,e,n,r){this.En=t,this.removedTargetIds=e,this.key=n,this.mn=r},zi=function(t,e){this.targetId=t,this.Tn=e},Hi=function(t,e,n,r){void 0===n&&(n=di.lt),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Xi=(Object.defineProperty($i.prototype,"_n",{get:function(){return this.Pn},enumerable:!1,configurable:!0}),Object.defineProperty($i.prototype,"resumeToken",{get:function(){return this.Rn},enumerable:!1,configurable:!0}),Object.defineProperty($i.prototype,"Vn",{get:function(){return 0!==this.An},enumerable:!1,configurable:!0}),Object.defineProperty($i.prototype,"pn",{get:function(){return this.yn},enumerable:!1,configurable:!0}),$i.prototype.gn=function(t){0<t.ht()&&(this.yn=!0,this.Rn=t)},$i.prototype.vn=function(){var n=ji(),r=ji(),i=ji();return this.In.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:kr()}}),new Bi(this.Rn,this.Pn,n,r,i)},$i.prototype.bn=function(){this.yn=!1,this.In=ro()},$i.prototype.Cn=function(t,e){this.yn=!0,this.In=this.In.Tt(t,e)},$i.prototype.Sn=function(t){this.yn=!0,this.In=this.In.remove(t)},$i.prototype.Dn=function(){this.An+=1},$i.prototype.Nn=function(){--this.An},$i.prototype.xn=function(){this.yn=!0,this.Pn=!0},$i),Yi=(Ki.prototype.Mn=function(t){for(var e=0,n=t.En;e<n.length;e++){var r=n[e];t.mn instanceof Xs?this.Un(r,t.mn):t.mn instanceof Ys&&this.qn(r,t.key,t.mn)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.qn(s,t.key,t.mn)}},Ki.prototype.Bn=function(n){var r=this;this.Qn(n,function(t){var e=r.jn(t);switch(n.state){case 0:r.Wn(t)&&e.gn(n.resumeToken);break;case 1:e.Nn(),e.Vn||e.bn(),e.gn(n.resumeToken);break;case 2:e.Nn(),e.Vn||r.removeTarget(t);break;case 3:r.Wn(t)&&(e.xn(),e.gn(n.resumeToken));break;case 4:r.Wn(t)&&(r.Gn(t),e.gn(n.resumeToken));break;default:kr()}})},Ki.prototype.Qn=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.On.forEach(function(t,e){r.Wn(e)&&n(e)})},Ki.prototype.Kn=function(t){var e=t.targetId,n=t.Tn.count;(t=this.zn(e))&&(pi(t=t.target)?0===n?(t=new ti(t.path),this.qn(e,t,new Ys(t,$r.min()))):Dr(1===n):this.Hn(e)!==n&&(this.Gn(e),this.kn=this.kn.add(e)))},Ki.prototype.Yn=function(r){var i=this,o=new Map;this.On.forEach(function(t,e){var n=i.zn(e);n&&(t._n&&pi(n.target)&&(n=new ti(n.target.path),null!==i.$n.get(n)||i.Jn(e,n)||i.qn(e,n,new Ys(n,r))),t.pn&&(o.set(e,t.vn()),t.bn()))});var s=ji();this.Ln.forEach(function(t,e){var n=!0;e.Wt(function(t){return!(t=i.zn(t))||2===t._t||(n=!1)}),n&&(s=s.add(t))});var t=new Gi(r,o,this.kn,this.$n,s);return this.$n=Pi,this.Ln=no(),this.kn=new Di(zr),t},Ki.prototype.Un=function(t,e){var n;this.Wn(t)&&(n=this.Jn(t,e.key)?2:0,this.jn(t).Cn(e.key,n),this.$n=this.$n.Tt(e.key,e),this.Ln=this.Ln.Tt(e.key,this.Xn(e.key).add(t)))},Ki.prototype.qn=function(t,e,n){var r;this.Wn(t)&&(r=this.jn(t),this.Jn(t,e)?r.Cn(e,1):r.Sn(e),this.Ln=this.Ln.Tt(e,this.Xn(e).delete(t)),n&&(this.$n=this.$n.Tt(e,n)))},Ki.prototype.removeTarget=function(t){this.On.delete(t)},Ki.prototype.Hn=function(t){var e=this.jn(t).vn();return this.Fn.Zn(t).size+e.fn.size-e.wn.size},Ki.prototype.Dn=function(t){this.jn(t).Dn()},Ki.prototype.jn=function(t){var e=this.On.get(t);return e||(e=new Xi,this.On.set(t,e)),e},Ki.prototype.Xn=function(t){var e=this.Ln.get(t);return e||(e=new Di(zr),this.Ln=this.Ln.Tt(t,e)),e},Ki.prototype.Wn=function(t){var e=null!==this.zn(t);return e||Ar("WatchChangeAggregator","Detected inactive target",t),e},Ki.prototype.zn=function(t){var e=this.On.get(t);return e&&e.Vn?null:this.Fn.te(t)},Ki.prototype.Gn=function(e){var n=this;this.On.set(e,new Xi),this.Fn.Zn(e).forEach(function(t){n.qn(e,t,null)})},Ki.prototype.Jn=function(t,e){return this.Fn.Zn(t).has(e)},Ki);function Ki(t){this.Fn=t,this.On=new Map,this.$n=Pi,this.Ln=no(),this.kn=new Di(zr)}function $i(){this.An=0,this.In=ro(),this.Rn=di.lt,this.Pn=!1,this.yn=!0}function Qi(t,e,n,r,i){this.resumeToken=t,this._n=e,this.fn=n,this.dn=r,this.wn=i}function Ji(t,e,n,r,i){this.ft=t,this.on=e,this.un=n,this.cn=r,this.an=i}function Zi(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.tn=n,this.docChanges=r,this.nn=i,this.fromCache=o,this.en=s,this.sn=u}function to(){this.Xt=new Ti(ti.k)}function eo(n){this.k=n?function(t,e){return n(t,e)||ti.k(t.key,e.key)}:function(t,e){return ti.k(t.key,e.key)},this.Ht=Vi,this.Yt=new Ti(this.k)}function no(){return new Ti(ti.k)}function ro(){return new Ti(ti.k)}function io(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function oo(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function so(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function uo(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function ao(t){return t=go(t.mapValue.fields.__local_write_time__.timestampValue),new Kr(t.seconds,t.nanos)}var ho=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function co(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?uo(t)?4:10:kr()}function lo(r,i){var t,e=co(r);if(e!==co(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return ao(r).isEqual(ao(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=go(r.timestampValue),t=go(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,wo(r.bytesValue).isEqual(wo(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,mo((t=r).geoPointValue.latitude)===mo(e.geoPointValue.latitude)&&mo(t.geoPointValue.longitude)===mo(e.geoPointValue.longitude);case 2:return t=i,"integerValue"in(e=r)&&"integerValue"in t?mo(e.integerValue)===mo(t.integerValue):"doubleValue"in e&&"doubleValue"in t&&((e=mo(e.doubleValue))===(t=mo(t.doubleValue))?ai(e)===ai(t):isNaN(e)&&isNaN(t));case 9:return Hr(r.arrayValue.values||[],i.arrayValue.values||[],lo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(io(e)!==io(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!lo(e[t],n[t])))return!1;return!0}();default:return kr()}}function fo(t,e){return void 0!==(t.values||[]).find(function(t){return lo(t,e)})}function po(t,e){var n,r,i,o=co(t),s=co(e);if(o!==s)return zr(o,s);switch(o){case 0:return 0;case 1:return zr(t.booleanValue,e.booleanValue);case 2:return n=e,(r=mo(t.integerValue||t.doubleValue))<(n=mo(n.integerValue||n.doubleValue))?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return yo(t.timestampValue,e.timestampValue);case 4:return yo(ao(t),ao(e));case 5:return zr(t.stringValue,e.stringValue);case 6:return i=t.bytesValue,s=e.bytesValue,i=wo(i),s=wo(s),i.F(s);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=zr(n[i],r[i]);if(0!==o)return o}return zr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return o=t.geoPointValue,r=e.geoPointValue,0!==(n=zr(mo(o.latitude),mo(r.latitude)))?n:zr(mo(o.longitude),mo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=po(n[i],r[i]);if(o)return o}return zr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=zr(r[s],o[s]);if(0!==u)return u;if(0!==(u=po(n[r[s]],i[o[s]])))return u}return zr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw kr()}}function yo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return zr(t,e);var n=go(t),t=go(e);return 0!==(e=zr(n.seconds,t.seconds))?e:zr(n.nanos,t.nanos)}function vo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=go(t=i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?wo(i.bytesValue).toBase64():"referenceValue"in i?(e=i.referenceValue,ti.it(e).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):kr();var t,e}(t)}function go(t){if(Dr(!!t),"string"!=typeof t)return{seconds:mo(t.seconds),nanos:mo(t.nanos)};var e=0,n=ho.exec(t);return Dr(!!n),n[1]&&(n=(n[1]+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function mo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function wo(t){return"string"==typeof t?di.fromBase64String(t):di.fromUint8Array(t)}function bo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.Y()}}function Eo(t){return t&&"integerValue"in t}function To(t){return!!t&&"arrayValue"in t}function Io(t){return t&&"nullValue"in t}function Ao(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function No(t){return t&&"mapValue"in t}var Oo={asc:"ASCENDING",desc:"DESCENDING"},Ro={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ko=function(t,e){this.t=t,this.ne=e};function Do(t){return{integerValue:""+t}}function So(t,e){if(t.ne){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ai(e)?"-0":e}}function Po(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!ai(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Do(e):So(t,e);var n}function _o(t,e){return t.ne?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Lo(t,e){return t.ne?e.toBase64():e.toUint8Array()}function Vo(t){return Dr(!!t),$r.N((t=go(t),new Kr(t.seconds,t.nanos)))}function Co(t,e){return new Qr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).Y()}function Uo(t){return Dr(Ko(t=Qr.J(t))),t}function jo(t,e){return Co(t.t,e.path)}function Mo(t,e){if((e=Uo(e)).get(1)!==t.t.projectId)throw new Lr(_r.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.t.projectId);if(e.get(3)!==t.t.database)throw new Lr(_r.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.t.database);return new ti(Fo(e))}function xo(t,e){return Co(t.t,e)}function qo(t){return new Qr(["projects",t.t.projectId,"databases",t.t.database]).Y()}function Fo(t){return Dr(4<t.length&&"documents"===t.get(4)),t.U(5)}function Go(t,e,n){return{name:jo(t,e),fields:n.proto.mapValue.fields}}function Bo(t,e){var n,r,i;if(e instanceof Ns)n={update:Go(t,e.key,e.value)};else if(e instanceof Us)n={delete:jo(t,e.key)};else if(e instanceof Os)n={update:Go(t,e.key,e.data),updateMask:(i=e.ee,r=[],i.fields.forEach(function(t){return r.push(t.Y())}),{fieldPaths:r})};else if(e instanceof Ps)n={transform:{document:jo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Zo)return{fieldPath:t.field.Y(),setToServerValue:"REQUEST_TIME"};if(e instanceof ts)return{fieldPath:t.field.Y(),appendMissingElements:{values:e.elements}};if(e instanceof os)return{fieldPath:t.field.Y(),removeAllFromArray:{values:e.elements}};if(e instanceof hs)return{fieldPath:t.field.Y(),increment:e.se};throw kr()})}};else{if(!(e instanceof js))return kr();n={verify:jo(t,e.key)}}return e.re.ie||(n.currentDocument=void 0!==(i=e.re).updateTime?{updateTime:_o(e=t,(t=i.updateTime).$())}:void 0!==i.exists?{exists:i.exists}:kr()),n}function Wo(t){var e=4===(o=Uo(t.parent)).length?Qr.X():Fo(o),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Dr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Yo(t.unaryFilter.field);return yu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Yo(t.unaryFilter.field);return yu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":return n=Yo(t.unaryFilter.field),yu.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":return t=Yo(t.unaryFilter.field),yu.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return kr()}}(e)]:void 0!==e.fieldFilter?[(n=e,yu.create(Yo(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return kr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):kr():[];var n}(n.where)),t=[],n.orderBy&&(t=n.orderBy.map(function(t){return new Bu(Yo((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e})),r=null,n.limit&&(r=ui(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=Ho(n.startAt));var u=null;return n.endAt&&(u=Ho(n.endAt)),new $s(e,i,t,o,r,"F",s,u)}function zo(t){return{before:t.before,values:t.position}}function Ho(t){var e=!!t.before,t=t.values||[];return new Cu(t,e)}function Xo(t){return{fieldPath:t.Y()}}function Yo(t){return Zr.et(t.fieldPath)}function Ko(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function $o(t,e){return t instanceof hs?Eo(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var Qo,Jo,Zo=(n(ns,Jo=me=function(){this.oe=void 0}),ns),ts=(n(es,Qo=me),es);function es(t){var e=this;return(e=Qo.call(this)||this).elements=t,e}function ns(){return null!==Jo&&Jo.apply(this,arguments)||this}function rs(t,e){for(var n=fs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return lo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var is,os=(n(ss,is=me),ss);function ss(t){var e=this;return(e=is.call(this)||this).elements=t,e}function us(t,e){for(var n=fs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!lo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var as,hs=(n(cs,as=me),cs);function cs(t,e){var n=this;return(n=as.call(this)||this).serializer=t,n.se=e,n}function ls(t){return mo(t.integerValue||t.doubleValue)}function fs(t){return To(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function ps(t,e){this.field=t,this.transform=e}var ds=(ys.prototype.ue=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].G(t))return!0;return!1},ys.prototype.isEqual=function(t){return Hr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},ys);function ys(t){(this.fields=t).sort(Zr.k)}function vs(t,e){this.version=t,this.transformResults=e}var gs=(ms.ce=function(){return new ms},ms.exists=function(t){return new ms(void 0,t)},ms.updateTime=function(t){return new ms(t)},Object.defineProperty(ms.prototype,"ie",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),ms.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},ms);function ms(t,e){this.updateTime=t,this.exists=e}function ws(t,e){return void 0!==t.updateTime?e instanceof Xs&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Xs}function bs(t,e,n,r){return t instanceof Ns?(o=e,ws((i=t).re,o)?(o=Ts(o),new Xs(i.key,o,i.value,{ae:!0})):o):t instanceof Os?function(t,e){if(!ws(t.re,e))return e;var n=Ts(e),e=Ds(t,e);return new Xs(t.key,n,e,{ae:!0})}(t,e):t instanceof Ps?function(t,e,n,r){if(!ws(t.re,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],h=a.transform,c=null;n instanceof Xs&&(c=n.field(a.field)),null===c&&r instanceof Xs&&(c=r.field(a.field)),o.push((i=c,a=e,c=void 0,h instanceof Zo?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(c.fields.__previous_value__=i),{mapValue:c}):h instanceof ts?rs(h,i):h instanceof os?us(h,i):(i=ls(h=$o(c=h,i))+ls(c.se),Eo(h)&&Eo(c.se)?Do(i):So(c.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=Ls(t,i.data(),r);return new Xs(t.key,i.version,r,{ae:!0})}(t,e,r,n):ws(t.re,e)?new Ys(t.key,$r.min()):e;var i,o}function Es(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.re.isEqual(e.re)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.ee.isEqual(e.ee):2!==t.type||Hr(t.fieldTransforms,t.fieldTransforms,function(t,e){return t.field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof ts&&e instanceof ts||t instanceof os&&e instanceof os?Hr(t.elements,e.elements,lo):t instanceof hs&&e instanceof hs?lo(t.se,e.se):t instanceof Zo&&e instanceof Zo)}))}function Ts(t){return t instanceof Xs?t.version:$r.min()}var Is,As,Ns=(n(ks,As=l=function(){}),ks),Os=(n(Rs,Is=l),Rs);function Rs(t,e,n,r){var i=this;return(i=Is.call(this)||this).key=t,i.data=e,i.ee=n,i.re=r,i.type=1,i}function ks(t,e,n){var r=this;return(r=As.call(this)||this).key=t,r.value=e,r.re=n,r.type=0,r}function Ds(t,e){return n=t,e=e instanceof Xs?e.data():Ms.empty(),r=new xs(e),n.ee.fields.forEach(function(t){var e;t.W()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.he();var n,r}var Ss,Ps=(n(_s,Ss=l),_s);function _s(t,e){var n=this;return(n=Ss.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.re=gs.exists(!0),n}function Ls(t,e,n){for(var r=new xs(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.he()}var Vs,Cs,Us=(n(Bs,Cs=l),Bs),js=(n(Gs,Vs=l),Gs),Ms=(Fs.empty=function(){return new Fs({mapValue:{}})},Fs.prototype.field=function(t){if(t.W())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!No(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.j()])||null},Fs.prototype.isEqual=function(t){return lo(this.proto,t.proto)},Fs),xs=(qs.prototype.set=function(t,e){return this.fe(t,e),this},qs.prototype.delete=function(t){return this.fe(t,null),this},qs.prototype.fe=function(t,e){for(var n=this._e,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===co(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.j(),e)},qs.prototype.he=function(){var t=this.de(Zr.X(),this._e);return null!=t?new Ms(t):this.le},qs.prototype.de=function(r,t){var i=this,o=!1,e=this.le.field(r),s=No(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.de(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},qs);function qs(t){void 0===t&&(t=Ms.empty()),this.le=t,this._e=new Map}function Fs(t){this.proto=t}function Gs(t,e){var n=this;return(n=Vs.call(this)||this).key=t,n.re=e,n.type=4,n}function Bs(t,e){var n=this;return(n=Cs.call(this)||this).key=t,n.re=e,n.type=3,n}var Ws,zs,Hs,Xs=(n(Zs,Hs=me=function(t,e){this.key=t,this.version=e}),Zs.prototype.field=function(t){return this.we.field(t)},Zs.prototype.data=function(){return this.we},Zs.prototype.Ee=function(){return this.we.proto},Zs.prototype.isEqual=function(t){return t instanceof Zs&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.ae===t.ae&&this.hasCommittedMutations===t.hasCommittedMutations&&this.we.isEqual(t.we)},Zs.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.we.toString()+", {hasLocalMutations: "+this.ae+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Zs.prototype,"hasPendingWrites",{get:function(){return this.ae||this.hasCommittedMutations},enumerable:!1,configurable:!0}),Zs),Ys=(n(Js,zs=me),Js.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Js.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Js.prototype.isEqual=function(t){return t instanceof Js&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Js),Ks=(n(Qs,Ws=me),Qs.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Qs.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Qs.prototype.isEqual=function(t){return t instanceof Qs&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Qs),$s=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.me=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Te=null,this.Ae=null,this.startAt,this.endAt};function Qs(){return null!==Ws&&Ws.apply(this,arguments)||this}function Js(t,e,n){var r=this;return(r=zs.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function Zs(t,e,n,r){var i=this;return(i=Hs.call(this,t,e)||this).we=n,i.ae=!!r.ae,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function tu(t){return new $s(t)}function eu(t){return!ui(t.limit)&&"F"===t.limitType}function nu(t){return!ui(t.limit)&&"L"===t.limitType}function ru(t){return 0<t.me.length?t.me[0].field:null}function iu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.Ie())return r.field}return null}function ou(t){return null!==t.collectionGroup}function su(t){var e=t;if(null===e.Te){e.Te=[];var n=iu(e),t=ru(e);if(null!==n&&null===t)n.tt()||e.Te.push(new Bu(n)),e.Te.push(new Bu(Zr.nt(),"asc"));else{for(var r=!1,i=0,o=e.me;i<o.length;i++){var s=o[i];e.Te.push(s),s.field.tt()&&(r=!0)}r||(n=0<e.me.length?e.me[e.me.length-1].dir:"asc",e.Te.push(new Bu(Zr.nt(),n)))}}return e.Te}function uu(t){var e=t;if(!e.Ae)if("F"===e.limitType)e.Ae=ci(e.path,e.collectionGroup,su(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=su(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Bu(o.field,s))}var u=e.endAt?new Cu(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Cu(e.startAt.position,!e.startAt.before):null;e.Ae=ci(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.Ae}function au(t,e,n){return new $s(t.path,t.collectionGroup,t.me.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function hu(t,e){return fi(uu(t),uu(e))&&t.limitType===e.limitType}function cu(t){return li(uu(t))+"|lt:"+t.limitType}function lu(t){return"Query(target="+(n=(e=uu(t)).path.Y(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return t.field.Y()+" "+t.op+" "+vo(t.value)}).join(", ")+"]"),ui(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return t.field.Y()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+qu(e.startAt)),e.endAt&&(n+=", endAt: "+qu(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function fu(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.rt(e.collectionGroup)&&e.path.G(n):ti.ot(e.path)?e.path.isEqual(n):e.path.K(n))&&function(t){for(var e=0,n=i.me;e<n.length;e++){var r=n[e];if(!r.field.tt()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||Fu(t.startAt,su(t),n))&&(!t.endAt||!Fu(t.endAt,su(t),n)));var e,n}function pu(u){return function(t,e){for(var n=!1,r=0,i=su(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i;switch(n=t.field.tt()?ti.k(e.key,n.key):(r=t.field,i=n,e=e.field(r),r=i.field(r),null!==e&&null!==r?po(e,r):kr()),t.dir){case"asc":return n;case"desc":return-1*n;default:return kr()}}(o,t,e);if(0!==s)return s;n=n||o.field.tt()}return 0}}var du,yu=(n(vu,du=function(){}),vu.create=function(t,e,n){return t.tt()?"in"===e||"not-in"===e?this.Re(t,e,n):new bu(t,e,n):"array-contains"===e?new Pu(t,n):"in"===e?new _u(t,n):"not-in"===e?new Lu(t,n):"array-contains-any"===e?new Vu(t,n):new vu(t,e,n)},vu.Re=function(t,e,n){return new("in"===e?Eu:Tu)(t,n)},vu.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this.Pe(po(t,this.value)):null!==t&&co(this.value)===co(t)&&this.Pe(po(t,this.value))},vu.prototype.Pe=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return kr()}},vu.prototype.Ie=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},vu);function vu(t,e,n){var r=this;return(r=du.call(this)||this).field=t,r.op=e,r.value=n,r}var gu,mu,wu,bu=(n(Nu,wu=yu),Nu.prototype.matches=function(t){return t=ti.k(t.key,this.key),this.Pe(t)},Nu),Eu=(n(Au,mu=yu),Au.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Au),Tu=(n(Iu,gu=yu),Iu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Iu);function Iu(t,e){var n=this;return(n=gu.call(this,t,"not-in",e)||this).keys=Ou(0,e),n}function Au(t,e){var n=this;return(n=mu.call(this,t,"in",e)||this).keys=Ou(0,e),n}function Nu(t,e,n){var r=this;return(r=wu.call(this,t,e,n)||this).key=ti.it(n.referenceValue),r}function Ou(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return ti.it(t.referenceValue)})}var Ru,ku,Du,Su,Pu=(n(xu,Su=yu),xu.prototype.matches=function(t){return To(t=t.field(this.field))&&fo(t.arrayValue,this.value)},xu),_u=(n(Mu,Du=yu),Mu.prototype.matches=function(t){return null!==(t=t.field(this.field))&&fo(this.value.arrayValue,t)},Mu),Lu=(n(ju,ku=yu),ju.prototype.matches=function(t){return!fo(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&(null!==(t=t.field(this.field))&&!fo(this.value.arrayValue,t))},ju),Vu=(n(Uu,Ru=yu),Uu.prototype.matches=function(t){var e=this;return!(!To(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return fo(e.value.arrayValue,t)})},Uu),Cu=function(t,e){this.position=t,this.before=e};function Uu(t,e){return Ru.call(this,t,"array-contains-any",e)||this}function ju(t,e){return ku.call(this,t,"not-in",e)||this}function Mu(t,e){return Du.call(this,t,"in",e)||this}function xu(t,e){return Su.call(this,t,"array-contains",e)||this}function qu(t){return(t.before?"b":"a")+":"+t.position.map(vo).join(",")}function Fu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.tt()?ti.k(ti.it(s.referenceValue),n.key):po(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Gu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!lo(t.position[n],e.position[n]))return!1;return!0}var Bu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e},Wu=(Ju.prototype.Ve=function(t,e,n){for(var r,i,o,s,u,a=n.pe,h=0;h<this.mutations.length;h++){var c=this.mutations[h];c.key.isEqual(t)&&(r=c,i=e,o=a[h],c=u=s=void 0,e=r instanceof Ns?new Xs(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof Os?(u=i,c=o,ws((s=r).re,u)?(u=Ds(s,u),new Xs(s.key,c.version,u,{hasCommittedMutations:!0})):new Ks(s.key,c.version)):r instanceof Ps?function(t,e,n){if(Dr(null!=n.transformResults),!ws(t.re,e))return new Ks(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Dr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Xs&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof ts?rs(o,s):o instanceof os?us(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=Ls(t,r.data(),e);return new Xs(t.key,n,e,{hasCommittedMutations:!0})}(r,i,o):new Ys(r.key,o.version,{hasCommittedMutations:!0}))}return e},Ju.prototype.ge=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=bs(i,e,e,this.ye))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=bs(a,e,o,this.ye))}return e},Ju.prototype.ve=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.ge(t.key,n.get(t.key));e&&(i=i.Tt(t.key,e))}),i},Ju.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},ji())},Ju.prototype.isEqual=function(t){return this.batchId===t.batchId&&Hr(this.mutations,t.mutations,Es)&&Hr(this.baseMutations,t.baseMutations,Es)},Ju),zu=(Qu.from=function(t,e,n){Dr(t.mutations.length===n.length);for(var r=Ci,i=t.mutations,o=0;o<i.length;o++)r=r.Tt(i[o].key,n[o].version);return new Qu(t,e,n,r)},Qu),Hu=($u.prototype.get=function(t){var e=this.Se(t);if(void 0!==(e=this.Ne[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.De(i,t))return o}},$u.prototype.has=function(t){return void 0!==this.get(t)},$u.prototype.set=function(t,e){var n=this.Se(t),r=this.Ne[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.De(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.Ne[n]=[[t,e]]},$u.prototype.delete=function(t){var e=this.Se(t),n=this.Ne[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.De(n[r][0],t))return 1===n.length?delete this.Ne[e]:n.splice(r,1),!0;return!1},$u.prototype.forEach=function(s){oo(this.Ne,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];s(i,o)}})},$u.prototype.W=function(){return so(this.Ne)},$u),Xu=(Ku.prototype.catch=function(t){return this.next(void 0,t)},Ku.prototype.next=function(r,i){var o=this;return this.$e&&kr(),this.$e=!0,this.Oe?this.error?this.Le(i,this.error):this.ke(r,this.result):new Ku(function(e,n){o.xe=function(t){o.ke(r,t).next(e,n)},o.Fe=function(t){o.Le(i,t).next(e,n)}})},Ku.prototype.Me=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Ku.prototype.Ue=function(t){try{var e=t();return e instanceof Ku?e:Ku.resolve(e)}catch(t){return Ku.reject(t)}},Ku.prototype.ke=function(t,e){return t?this.Ue(function(){return t(e)}):Ku.resolve(e)},Ku.prototype.Le=function(t,e){return t?this.Ue(function(){return t(e)}):Ku.reject(e)},Ku.resolve=function(n){return new Ku(function(t,e){t(n)})},Ku.reject=function(n){return new Ku(function(t,e){e(n)})},Ku.qe=function(t){return new Ku(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Ku.Be=function(t){for(var n=Ku.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Ku.resolve(t):e()})}(r[e]);return n},Ku.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.qe(i)},Ku),Yu=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})};function Ku(t){var e=this;this.xe=null,this.Fe=null,this.result=void 0,this.error=void 0,this.Oe=!1,this.$e=!1,t(function(t){e.Oe=!0,e.result=t,e.xe&&e.xe(t)},function(t){e.Oe=!0,e.error=t,e.Fe&&e.Fe(t)})}function $u(t,e){this.Se=t,this.De=e,this.Ne={}}function Qu(t,e,n,r){this.batch=t,this.be=e,this.pe=n,this.Ce=r}function Ju(t,e,n,r){this.batchId=t,this.ye=e,this.baseMutations=n,this.mutations=r}function Zu(t){return new ko(t,!0)}function ta(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var ea=(sa.prototype.Ge=function(e,n){var r=this;return this.je.Ke(e,n).next(function(t){return r.ze(e,n,t)})},sa.prototype.ze=function(t,r,i){return this.Qe.He(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].ge(r,t);return t})},sa.prototype.Ye=function(t,e,i){var o=Pi;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].ge(t,e);o=o.Tt(t,e)}),o},sa.prototype.Je=function(e,t){var n=this;return this.Qe.getEntries(e,t).next(function(t){return n.Xe(e,t)})},sa.prototype.Xe=function(e,r){var i=this;return this.je.Ze(e,r).next(function(t){var t=i.Ye(e,r,t),n=Pi;return t.forEach(function(t,e){e=e||new Ys(t,$r.min()),n=n.Tt(t,e)}),n})},sa.prototype.ts=function(t,e,n){return r=e,ti.ot(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.ns(t,e.path):ou(e)?this.es(t,e,n):this.ss(t,e,n);var r},sa.prototype.ns=function(t,e){return this.Ge(t,new ti(e)).next(function(t){var e=Vi;return t instanceof Xs&&(e=e.Tt(t.key,t)),e})},sa.prototype.es=function(n,r,i){var o=this,s=r.collectionGroup,u=Vi;return this.We.rs(n,s).next(function(t){return Xu.forEach(t,function(t){var e=(e=r,t=t.child(s),new $s(t,null,e.me.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.ss(n,e,i).next(function(t){t.forEach(function(t,e){u=u.Tt(t,e)})})}).next(function(){return u})})},sa.prototype.ss=function(e,n,t){var a,h,r=this;return this.Qe.ts(e,n,t).next(function(t){return a=t,r.je.os(e,n)}).next(function(t){return h=t,r.us(e,h,a).next(function(t){a=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,s=bs(s,s=a.get(u),s,r.ye);a=s instanceof Xs?a.Tt(u,s):a.remove(u)}})}).next(function(){return a.forEach(function(t,e){fu(n,e)||(a=a.remove(t))}),a})},sa.prototype.us=function(t,e,n){for(var r=ji(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Os&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.Qe.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Xs&&(h=h.Tt(t,e))}),h})},sa),na=(oa.ls=function(t,e){for(var n=ji(),r=ji(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new oa(t,e.fromCache,n,r)},oa),ra=(ia.prototype.fs=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},ia.prototype.next=function(){var t=++this.previousValue;return this.ds&&this.ds(t),t},ia);function ia(t,e){var n=this;this.previousValue=t,e&&(e._s=function(t){return n.fs(t)},this.ds=function(t){return e.ws(t)})}function oa(t,e,n,r){this.targetId=t,this.fromCache=e,this.cs=n,this.hs=r}function sa(t,e,n){this.Qe=t,this.je=e,this.We=n}ra.Es=-1;var ua=(aa.prototype.reset=function(){this.ys=0},aa.prototype.gs=function(){this.ys=this.Ps},aa.prototype.vs=function(t){var e=this;this.cancel();var n=Math.floor(this.ys+this.bs()),r=Math.max(0,Date.now()-this.ps),i=Math.max(0,n-r);0<i&&Ar("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.ys+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Vs=this.Ts.Cs(this.As,i,function(){return e.ps=Date.now(),t()}),this.ys*=this.Rs,this.ys<this.Is&&(this.ys=this.Is),this.ys>this.Ps&&(this.ys=this.Ps)},aa.prototype.Ss=function(){null!==this.Vs&&(this.Vs.Ds(),this.Vs=null)},aa.prototype.cancel=function(){null!==this.Vs&&(this.Vs.cancel(),this.Vs=null)},aa.prototype.bs=function(){return(Math.random()-.5)*this.ys},aa);function aa(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Ts=t,this.As=e,this.Is=n,this.Rs=r,this.Ps=i,this.ys=0,this.Vs=null,this.ps=Date.now(),this.reset()}function ha(t){return"IndexedDbTransactionError"===t.name}function ca(){return"undefined"!=typeof document?document:null}var la=(da.$s=function(t,e,n,r,i){return(i=new da(t,e,Date.now()+n,r,i)).start(n),i},da.prototype.start=function(t){var e=this;this.Ls=setTimeout(function(){return e.ks()},t)},da.prototype.Ds=function(){return this.ks()},da.prototype.cancel=function(t){null!==this.Ls&&(this.clearTimeout(),this.Os.reject(new Lr(_r.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},da.prototype.ks=function(){var e=this;this.Ns.Ms(function(){return null!==e.Ls?(e.clearTimeout(),e.op().then(function(t){return e.Os.resolve(t)})):Promise.resolve()})},da.prototype.clearTimeout=function(){null!==this.Ls&&(this.Fs(this),clearTimeout(this.Ls),this.Ls=null)},da),fa=(Object.defineProperty(pa.prototype,"Hs",{get:function(){return this.Bs},enumerable:!1,configurable:!0}),pa.prototype.Ms=function(t){this.enqueue(t)},pa.prototype.Ys=function(t){this.Js(),this.Xs(t)},pa.prototype.Zs=function(){var t;this.Bs||(this.Bs=!0,(t=ca())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.zs))},pa.prototype.enqueue=function(t){return this.Js(),this.Bs?new Promise(function(t){}):this.Xs(t)},pa.prototype.ti=function(t){var e=this;this.Ms(function(){return e.qs.push(t),e.ni()})},pa.prototype.ni=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.qs.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.qs[0]()];case 2:return t.sent(),this.qs.shift(),this.Ks.reset(),[3,4];case 3:if(!ha(e=t.sent()))throw e;return Ar("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.qs.length&&this.Ks.vs(function(){return n.ni()}),t.label=5;case 5:return[2]}})})},pa.prototype.Xs=function(t){var r=this,e=this.Us.then(function(){return r.Ws=!0,t().catch(function(t){throw r.js=t,r.Ws=!1,Nr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Ws=!1,t})});return this.Us=e},pa.prototype.Cs=function(t,e,n){var r=this;return this.Js(),-1<this.Gs.indexOf(t)&&(e=0),n=la.$s(this,t,e,n,function(t){return r.ei(t)}),this.Qs.push(n),n},pa.prototype.Js=function(){this.js&&kr()},pa.prototype.si=function(){},pa.prototype.ii=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Us];case 1:t.sent(),t.label=2;case 2:if(e!==this.Us)return[3,0];t.label=3;case 3:return[2]}})})},pa.prototype.ri=function(t){for(var e=0,n=this.Qs;e<n.length;e++)if(n[e].As===t)return!0;return!1},pa.prototype.oi=function(r){var i=this;return this.ii().then(function(){i.Qs.sort(function(t,e){return t.xs-e.xs});for(var t=0,e=i.Qs;t<e.length;t++){var n=e[t];if(n.Ds(),"all"!==r&&n.As===r)break}return i.ii()})},pa.prototype.ui=function(t){this.Gs.push(t)},pa.prototype.ei=function(t){t=this.Qs.indexOf(t),this.Qs.splice(t,1)},pa);function pa(){var e=this;this.Us=Promise.resolve(),this.qs=[],this.Bs=!1,this.Qs=[],this.js=null,this.Ws=!1,this.Gs=[],this.Ks=new ua(this,"async_queue_retry"),this.zs=function(){var t=ca();t&&Ar("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Ks.Ss()};var t=ca();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.zs)}function da(t,e,n,r,i){this.Ns=t,this.As=e,this.xs=n,this.op=r,this.Fs=i,this.Os=new Yu,this.then=this.Os.promise.then.bind(this.Os.promise),this.Os.promise.catch(function(t){})}function ya(t,e){if(Nr("AsyncQueue",e+": "+t),ha(t))return new Lr(_r.UNAVAILABLE,e+": "+t);throw t}function va(t){this.ci=t}var ga=(Aa.prototype.hi=function(t,e){return this.ai.add(e),Xu.resolve()},Aa.prototype.rs=function(t,e){return Xu.resolve(this.ai.getEntries(e))},Aa),ma=(Ia.prototype.add=function(t){var e=t.j(),n=t.q(),r=this.index[e]||new Di(Qr.k),t=!r.has(n);return this.index[e]=r.add(n),t},Ia.prototype.has=function(t){var e=t.j(),t=t.q();return(e=this.index[e])&&e.has(t)},Ia.prototype.getEntries=function(t){return(this.index[t]||new Di(Qr.k)).H()},Ia),wa=(Ta.prototype.next=function(){return this.li+=2,this.li},Ta._i=function(){return new Ta(0)},Ta.fi=function(){return new Ta(-1)},Ta),ba=(Ea.prototype.bi=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Ci(t,n.wi)})},Ea);function Ea(t,e,n,r){this.persistence=t,this.di=e,this.serializer=r,this.wi=new Ti(zr),this.Ei=new Hu(li,fi),this.mi=$r.min(),this.je=t.Ti(n),this.Ai=t.Ii(),this.Ri=t.Pi(),this.yi=new ea(this.Ai,this.je,this.persistence.Vi()),this.pi=t.gi(),this.di.vi(this.yi)}function Ta(t){this.li=t}function Ia(){this.index={}}function Aa(){this.ai=new ma}function Na(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).je,m=e.yi,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.je.Si(v).next(function(t){return g=t,n=e.persistence.Ti(o),m=new ea(e.Ai,n,e.persistence.Vi()),n.Si(v)}).next(function(t){for(var e=[],n=[],r=ji(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Je(v,r).next(function(t){return{Di:t,Ni:e,xi:n}})})})];case 1:return r=t.sent(),[2,(e.je=n,e.yi=m,e.di.vi(e.yi),r)]}})})}function Oa(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Ri.Mi(t)})}function Ra(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).wi.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Wi.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!ha(r=t.sent()))throw r;return Ar("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.wi=e.wi.remove(o),e.Ei.delete(n.target),[2]}})})}function ka(t,o,s){var u=t,a=$r.min(),h=ji();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=uu(o),(void 0!==(t=(i=t).Ei.get(r))?Xu.resolve(i.wi.get(t)):i.Ri.Hi(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.Ri.Yi(e,t.targetId).next(function(t){h=t})}).next(function(){return u.di.ts(e,o,s?a:$r.min(),s?h:ji())}).next(function(t){return{documents:t,Ji:h}});var t,n,r,i})}function Da(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==_r.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Ar("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Sa(t,e,n,r,i){var o=this;this.jr=t,this.Wr=e,this.Ns=n,this.Gr={},this.Kr=[],this.zr=new Map,this.Hr=new Set,this.Yr=[],this.Jr=i,this.Jr.Xr(function(t){n.Ms(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Qa(this)?(Ar("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Hr.add(4),[4,Wa(e)];case 1:return t.sent(),e.Zr.set("Unknown"),e.Hr.delete(4),[4,Ba(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Zr=new ja(n,r)}var Pa,_a,La,l=(Ga.prototype.sr=function(){return 1===this.state||2===this.state||4===this.state},Ga.prototype.ir=function(){return 2===this.state},Ga.prototype.start=function(){3!==this.state?this.auth():this.rr()},Ga.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.sr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Ga.prototype.ur=function(){this.state=0,this.Ks.reset()},Ga.prototype.cr=function(){var t=this;this.ir()&&null===this.er&&(this.er=this.Ts.Cs(this.Xi,6e4,function(){return t.ar()}))},Ga.prototype.hr=function(t){this.lr(),this.stream.send(t)},Ga.prototype.ar=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.ir()?[2,this.close(0)]:[2]})})},Ga.prototype.lr=function(){this.er&&(this.er.cancel(),this.er=null)},Ga.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.lr(),this.Ks.cancel(),this.nr++,3!==e?this.Ks.reset():n&&n.code===_r.RESOURCE_EXHAUSTED?(Nr(n.toString()),Nr("Using maximum backoff delay to prevent overloading the backend."),this.Ks.gs()):n&&n.code===_r.UNAUTHENTICATED&&this.tr.A(),null!==this.stream&&(this._r(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.dr(n)];case 1:return t.sent(),[2]}})})},Ga.prototype._r=function(){},Ga.prototype.auth=function(){var n=this;this.state=1;var t=this.wr(this.nr),e=this.nr;this.tr.getToken().then(function(t){n.nr===e&&n.Er(t)},function(e){t(function(){var t=new Lr(_r.UNKNOWN,"Fetching auth token failed: "+e.message);return n.mr(t)})})},Ga.prototype.Er=function(t){var e=this,n=this.wr(this.nr);this.stream=this.Tr(t),this.stream.Ar(function(){n(function(){return e.state=2,e.listener.Ar()})}),this.stream.dr(function(t){n(function(){return e.mr(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Ga.prototype.rr=function(){var t=this;this.state=4,this.Ks.vs(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},Ga.prototype.mr=function(t){return Ar("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Ga.prototype.wr=function(e){var n=this;return function(t){n.Ts.Ms(function(){return n.nr===e?t():(Ar("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Ga),Va=(n(Fa,La=l),Fa.prototype.Tr=function(t){return this.Zi.Ir("Listen",t)},Fa.prototype.onMessage=function(t){this.Ks.reset();var e,n=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:kr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.ne?(Dr(void 0===o||"string"==typeof o),di.fromBase64String(o||"")):(Dr(void 0===o||o instanceof Uint8Array),di.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?_r.UNKNOWN:Ei(s.code),new Lr(o,s.message||"")),r=new Hi(n,r,i,s||null)}else if("documentChange"in e){e.documentChange,(a=e.documentChange).document,a.document.name,a.document.updateTime;var i=Mo(t,a.document.name),u=Vo(a.document.updateTime),s=new Ms({mapValue:{fields:a.document.fields}}),u=new Xs(i,u,s,{}),s=a.targetIds||[],a=a.removedTargetIds||[];r=new Wi(s,a,u.key,u)}else if("documentDelete"in e){e.documentDelete,(a=e.documentDelete).document;var u=Mo(t,a.document),h=a.readTime?Vo(a.readTime):$r.min(),h=new Ys(u,h),a=a.removedTargetIds||[];r=new Wi([],a,h.key,h)}else if("documentRemove"in e){e.documentRemove,(h=e.documentRemove).document;var c=Mo(t,h.document),h=h.removedTargetIds||[];r=new Wi([],h,c,null)}else{if(!("filter"in e))return kr();e.filter,(c=e.filter).targetId,e=new vi(e=c.count||0),c=c.targetId,r=new zi(c,e)}return r}(this.serializer,t),t=!("targetChange"in(e=t))||(e=e.targetChange).targetIds&&e.targetIds.length||!e.readTime?$r.min():Vo(e.readTime);return this.listener.Rr(n,t)},Fa.prototype.Pr=function(t){var e,n,r,i,o,s,u,a,h={};h.database=qo(this.serializer),h.addTarget=(e=this.serializer,(r=pi(r=(n=t).target)?{documents:{documents:[xo(e,r.path)]}}:{query:(i=e,s={structuredQuery:{}},u=(o=r).path,null!==o.collectionGroup?(s.parent=xo(i,u),s.structuredQuery.from=[{collectionId:o.collectionGroup,allDescendants:!0}]):(s.parent=xo(i,u.q()),s.structuredQuery.from=[{collectionId:u.j()}]),(u=function(t){if(0!==t.length)return 1===(t=t.map(function(t){if("=="===t.op){if(Ao(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NAN"}};if(Io(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Ao(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NOT_NAN"}};if(Io(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Xo(t.field),op:(e=t.op,Ro[e]),value:t.value}};var e})).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(o.filters))&&(s.structuredQuery.where=u),(u=function(t){if(0!==t.length)return t.map(function(t){return{field:Xo(t.field),direction:(t=t.dir,Oo[t])}})}(o.orderBy))&&(s.structuredQuery.orderBy=u),u=o.limit,null!==(u=i.ne||ui(u)?u:{value:u})&&(s.structuredQuery.limit=u),o.startAt&&(s.structuredQuery.startAt=zo(o.startAt)),o.endAt&&(s.structuredQuery.endAt=zo(o.endAt)),s)}).targetId=n.targetId,0<n.resumeToken.ht()?r.resumeToken=Lo(e,n.resumeToken):0<n.ft.F($r.min())&&(r.readTime=_o(e,n.ft.$())),r),(t=(this.serializer,a=t,null==(t=function(){switch(a._t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return kr()}}())?null:{"goog-listen-tags":t}))&&(h.labels=t),this.hr(h)},Fa.prototype.yr=function(t){var e={};e.database=qo(this.serializer),e.removeTarget=t,this.hr(e)},Fa),Ca=(n(qa,_a=l),Object.defineProperty(qa.prototype,"pr",{get:function(){return this.Vr},enumerable:!1,configurable:!0}),qa.prototype.start=function(){this.Vr=!1,this.lastStreamToken=void 0,_a.prototype.start.call(this)},qa.prototype._r=function(){this.Vr&&this.gr([])},qa.prototype.Tr=function(t){return this.Zi.Ir("Write",t)},qa.prototype.onMessage=function(t){if(Dr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Vr){this.Ks.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Dr(void 0!==r),n.map(function(t){return n=r,(t=(e=t).updateTime?Vo(e.updateTime):Vo(n)).isEqual($r.min())&&(t=Vo(n)),n=null,e.transformResults&&0<e.transformResults.length&&(n=e.transformResults),new vs(t,n);var e,n})):[]),n=Vo(t.commitTime);return this.listener.vr(n,e)}var r;return Dr(!t.writeResults||0===t.writeResults.length),this.Vr=!0,this.listener.br()},qa.prototype.Cr=function(){var t={};t.database=qo(this.serializer),this.hr(t)},qa.prototype.gr=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return Bo(e.serializer,t)})};this.hr(t)},qa),Ua=(n(xa,Pa=function(){}),xa.prototype.Dr=function(){if(this.Sr)throw new Lr(_r.FAILED_PRECONDITION,"The client has already been terminated.")},xa.prototype.Nr=function(e,n,r){var i=this;return this.Dr(),this.credentials.getToken().then(function(t){return i.Zi.Nr(e,n,r,t)}).catch(function(t){throw t.code===_r.UNAUTHENTICATED&&i.credentials.A(),t})},xa.prototype.Fr=function(e,n,r){var i=this;return this.Dr(),this.credentials.getToken().then(function(t){return i.Zi.Fr(e,n,r,t)}).catch(function(t){throw t.code===_r.UNAUTHENTICATED&&i.credentials.A(),t})},xa.prototype.terminate=function(){this.Sr=!1},xa),ja=(Ma.prototype.Mr=function(){var t=this;0===this.$r&&(this.Ur("Unknown"),this.Lr=this.Ns.Cs("online_state_timeout",1e4,function(){return t.Lr=null,t.qr("Backend didn't respond within 10 seconds."),t.Ur("Offline"),Promise.resolve()}))},Ma.prototype.Br=function(t){"Online"===this.state?this.Ur("Unknown"):(this.$r++,1<=this.$r&&(this.Qr(),this.qr("Connection failed 1 times. Most recent error: "+t.toString()),this.Ur("Offline")))},Ma.prototype.set=function(t){this.Qr(),this.$r=0,"Online"===t&&(this.kr=!1),this.Ur(t)},Ma.prototype.Ur=function(t){t!==this.state&&(this.state=t,this.Or(t))},Ma.prototype.qr=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.kr?(Nr(t),this.kr=!1):Ar("OnlineStateTracker",t)},Ma.prototype.Qr=function(){null!==this.Lr&&(this.Lr.cancel(),this.Lr=null)},Ma);function Ma(t,e){this.Ns=t,this.Or=e,this.state="Unknown",this.$r=0,this.Lr=null,this.kr=!0}function xa(t,e,n){var r=this;return(r=Pa.call(this)||this).credentials=t,r.Zi=e,r.serializer=n,r.Sr=!1,r}function qa(t,e,n,r,i){var o=this;return(o=_a.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Vr=!1,o}function Fa(t,e,n,r,i){var o=this;return(o=La.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Ga(t,e,n,r,i,o){this.Ts=t,this.Xi=n,this.Zi=r,this.tr=i,this.listener=o,this.state=0,this.nr=0,this.er=null,this.stream=null,this.Ks=new ua(t,e)}function Ba(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!Qa(r))return[3,4];e=0,n=r.Yr,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Wa(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.Yr,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function za(t,e){t.zr.has(e.targetId)||(t.zr.set(e.targetId,e),$a(t)?Ka(t):ih(t).ir()&&Xa(t,e))}function Ha(t,e){var n=t,t=ih(n);n.zr.delete(e),t.ir()&&Ya(n,e),0===n.zr.size&&(t.ir()?t.cr():Qa(n)&&n.Zr.set("Unknown"))}function Xa(t,e){t.no.Dn(e.targetId),ih(t).Pr(e)}function Ya(t,e){t.no.Dn(e),ih(t).yr(e)}function Ka(e){e.no=new Yi({Zn:function(t){return e.Gr.Zn(t)},te:function(t){return e.zr.get(t)||null}}),ih(e).start(),e.Zr.Mr()}function $a(t){return Qa(t)&&!ih(t).sr()&&0<t.zr.size}function Qa(t){return 0===t.Hr.size}function Ja(t){t.no=void 0}function Za(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!ha(r))throw r;return n.Hr.add(1),[4,Wa(n)];case 1:return t.sent(),n.Zr.set("Offline"),i=i||function(){return Oa(n.jr)},n.Ns.ti(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Ar("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Hr.delete(1),[4,Ba(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function th(e,n){return n().catch(function(t){return Za(e,t,n)})}function eh(h){return y(this,void 0,void 0,function(){var o,s,u,a;return v(this,function(t){switch(t.label){case 0:s=oh(o=h),u=0<o.Kr.length?o.Kr[o.Kr.length-1].batchId:-1,t.label=1;case 1:if(!(Qa(o)&&o.Kr.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(n=o.jr,r=u,(i=n).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===r&&(r=-1),i.je.zi(t,r)}))];case 3:return null===(a=t.sent())?(0===o.Kr.length&&s.cr(),[3,7]):(u=a.batchId,e=a,(n=o).Kr.push(e),(n=oh(n)).ir()&&n.pr&&n.gr(e.mutations),[3,6]);case 4:return a=t.sent(),[4,Za(o,a)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return nh(o)&&rh(o),[2]}var e,n,r,i})})}function nh(t){return Qa(t)&&!oh(t).sr()&&0<t.Kr.length}function rh(t){oh(t).start()}function ih(n){var t,e,r,i=this;return n.oo||(n.oo=(t=n.Wr,e=n.Ns,r={Ar:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.zr.forEach(function(t,e){Xa(n,t)}),[2]})})}.bind(null,n),dr:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return Ja(e),$a(e)?(e.Zr.Br(n),Ka(e)):e.Zr.set("Unknown"),[2]})})}.bind(null,n),Rr:function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Zr.set("Online"),!(u instanceof Hi&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.zr.has(i)?[4,o.Gr.eo(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.zr.delete(i),o.no.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Ar("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,Za(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof Wi?s.no.Mn(u):u instanceof zi?s.no.Kn(u):s.no.Bn(u),a.isEqual($r.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Oa(s.jr)];case 8:return o=t.sent(),0<=a.F(o)?[4,(i=a,(e=(r=s).no.Yn(i)).on.forEach(function(t,e){var n;0<t.resumeToken.ht()&&(n=r.zr.get(e))&&r.zr.set(e,n.wt(t.resumeToken,i))}),e.un.forEach(function(t){var e=r.zr.get(t);e&&(r.zr.set(t,e.wt(di.lt,e.ft)),Ya(r,t),e=new mi(e.target,t,1,e.sequenceNumber),Xa(r,e))}),r.Gr.so(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Ar("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,Za(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n)},t.Dr(),new Va(e,t.Zi,t.credentials,t.serializer,r)),n.Yr.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.oo.ur(),$a(n)?Ka(n):n.Zr.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.oo.stop()];case 2:t.sent(),Ja(n),t.label=3;case 3:return[2]}})})})),n.oo}function oh(n){var t,e,r,i=this;return n.uo||(n.uo=(t=n.Wr,e=n.Ns,r={Ar:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return oh(e).Cr(),[2]})})}.bind(null,n),dr:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&oh(e).pr?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return bi(n=i.code)&&n!==_r.ABORTED?(e=r.Kr.shift(),oh(r).ur(),[4,th(r,function(){return r.Gr.ro(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,eh(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return nh(e)&&rh(e),[2]}})})}.bind(null,n),br:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=oh(o),n=0,r=o.Kr;n<r.length;n++)i=r[n],e.gr(i.mutations);return[2]})})}.bind(null,n),vr:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Kr.shift(),n=zu.from(e,i,o),[4,th(r,function(){return r.Gr.io(n)})];case 1:return t.sent(),[4,eh(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Dr(),new Ca(e,t.Zi,t.credentials,t.serializer,r)),n.Yr.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.uo.ur(),[4,eh(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.uo.stop()];case 3:t.sent(),0<n.Kr.length&&(Ar("RemoteStore","Stopping write stream with "+n.Kr.length+" pending writes"),n.Kr=[]),t.label=4;case 4:return[2]}})})})),n.uo}function sh(){this.queries=new Hu(cu,hu),this.onlineState="Unknown",this.ao=new Set}var uh=function(){this.co=void 0,this.listeners=[]};function ah(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new uh),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.ho(n)];case 2:return o.co=t.sent(),[3,4];case 3:return o=ya(o=t.sent(),"Initialization of query '"+lu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.lo(e.onlineState),i.co&&u._o(i.co)&&ch(e),[2]}})})}function hh(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.fo(n))]:[2]})})}function ch(t){t.ao.forEach(function(t){t.next()})}var lh=(kh.prototype._o=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Fi(t.query,t.docs,t.tn,e,t.nn,t.fromCache,t.en,!0)}var o=!1;return this.Eo?this.To(t)&&(this.wo.next(t),o=!0):this.Ao(t,this.onlineState)&&(this.Io(t),o=!0),this.mo=t,o},kh.prototype.onError=function(t){this.wo.error(t)},kh.prototype.lo=function(t){this.onlineState=t;var e=!1;return this.mo&&!this.Eo&&this.Ao(this.mo,t)&&(this.Io(this.mo),e=!0),e},kh.prototype.Ao=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Ro&&n||t.docs.W()&&"Offline"!==e)},kh.prototype.To=function(t){if(0<t.docChanges.length)return!0;var e=this.mo&&this.mo.hasPendingWrites!==t.hasPendingWrites;return!(!t.en&&!e)&&!0===this.options.includeMetadataChanges},kh.prototype.Io=function(t){t=Fi.rn(t.query,t.docs,t.nn,t.fromCache),this.Eo=!0,this.wo.next(t)},kh),fh=(Rh.prototype.W=function(){return this.Po.W()},Rh.prototype.vo=function(t,e){e=new ph(t,e),this.Po=this.Po.add(e),this.Vo=this.Vo.add(e)},Rh.prototype.bo=function(t,e){var n=this;t.forEach(function(t){return n.vo(t,e)})},Rh.prototype.Co=function(t,e){this.So(new ph(t,e))},Rh.prototype.Do=function(t,e){var n=this;t.forEach(function(t){return n.Co(t,e)})},Rh.prototype.No=function(t){var e=this,n=new ti(new Qr([])),r=new ph(n,t),t=new ph(n,t+1),i=[];return this.Vo.jt([r,t],function(t){e.So(t),i.push(t.key)}),i},Rh.prototype.xo=function(){var e=this;this.Po.forEach(function(t){return e.So(t)})},Rh.prototype.So=function(t){this.Po=this.Po.delete(t),this.Vo=this.Vo.delete(t)},Rh.prototype.Fo=function(t){var e=new ti(new Qr([])),n=new ph(e,t),t=new ph(e,t+1),r=ji();return this.Vo.jt([n,t],function(t){r=r.add(t.key)}),r},Rh.prototype.Oo=function(t){var e=new ph(t,0);return null!==(e=this.Po.Gt(e))&&t.isEqual(e.key)},Rh),ph=(Oh.yo=function(t,e){return ti.k(t.key,e.key)||zr(t.$o,e.$o)},Oh.po=function(t,e){return zr(t.$o,e.$o)||ti.k(t.key,e.key)},Oh),dh=(Nh.prototype.Lo=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Nh.prototype.ko=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Nh.prototype.Mo=function(){var t={activeTargetIds:this.activeTargetIds.H(),updateTimeMs:Date.now()};return JSON.stringify(t)},Nh),yh=(Ah.prototype.Bo=function(t){},Ah.prototype.Qo=function(t,e,n){},Ah.prototype.jo=function(t){return this.Uo.Lo(t),this.qo[t]||"not-current"},Ah.prototype.Wo=function(t,e,n){this.qo[t]=e},Ah.prototype.Go=function(t){this.Uo.ko(t)},Ah.prototype.Ko=function(t){return this.Uo.activeTargetIds.has(t)},Ah.prototype.zo=function(t){delete this.qo[t]},Ah.prototype.Ho=function(){return this.Uo.activeTargetIds},Ah.prototype.Yo=function(t){return this.Uo.activeTargetIds.has(t)},Ah.prototype.start=function(){return this.Uo=new dh,Promise.resolve()},Ah.prototype.Jo=function(t,e,n){},Ah.prototype.Xo=function(t){},Ah.prototype.Zo=function(){},Ah.prototype.ws=function(t){},Ah.prototype.tu=function(){},Ah),vh=function(t){this.key=t},gh=function(t){this.key=t},mh=(Object.defineProperty(Ih.prototype,"ou",{get:function(){return this.nu},enumerable:!1,configurable:!0}),Ih.prototype.uu=function(t,e){var s=this,u=e?e.cu:new qi,a=(e||this).ru,h=(e||this).nn,c=a,l=!1,f=eu(this.query)&&a.size===this.query.limit?a.last():null,p=nu(this.query)&&a.size===this.query.limit?a.first():null;if(t.Pt(function(t,e){var n=a.get(t),r=(r=e instanceof Xs?e:null)&&(fu(s.query,r)?r:null),i=!!n&&s.nn.has(n.key),o=!!r&&(r.ae||s.nn.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.au(n,r)||(u.track({type:2,doc:r}),e=!0,(f&&0<s.iu(r,f)||p&&s.iu(r,p)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(h=r?(c=c.add(r),o?h.add(t):h.delete(t)):(c=c.delete(t),h.delete(t)))}),eu(this.query)||nu(this.query))for(;c.size>this.query.limit;){var n=eu(this.query)?c.last():c.first(),c=c.delete(n.key),h=h.delete(n.key);u.track({type:1,doc:n})}return{ru:c,cu:u,hu:l,nn:h}},Ih.prototype.au=function(t,e){return t.ae&&e.hasCommittedMutations&&!e.ae},Ih.prototype.lu=function(t,e,n){var o=this,r=this.ru;this.ru=t.ru,this.nn=t.nn;var i=t.cu.Zt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.iu(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return kr()}}var r,i}),this._u(n);var s=e?this.fu():[],e=(n=0===this.su.size&&this._n?1:0)!==this.eu;return this.eu=n,0!==i.length||e?{snapshot:new Fi(this.query,t.ru,r,i,t.nn,0==n,e,!1),du:s}:{du:s}},Ih.prototype.lo=function(t){return this._n&&"Offline"===t?(this._n=!1,this.lu({ru:this.ru,cu:new qi,nn:this.nn,hu:!1},!1)):{du:[]}},Ih.prototype.wu=function(t){return!this.nu.has(t)&&!!this.ru.has(t)&&!this.ru.get(t).ae},Ih.prototype._u=function(t){var e=this;t&&(t.fn.forEach(function(t){return e.nu=e.nu.add(t)}),t.dn.forEach(function(t){}),t.wn.forEach(function(t){return e.nu=e.nu.delete(t)}),this._n=t._n)},Ih.prototype.fu=function(){var e=this;if(!this._n)return[];var n=this.su;this.su=ji(),this.ru.forEach(function(t){e.wu(t.key)&&(e.su=e.su.add(t.key))});var r=[];return n.forEach(function(t){e.su.has(t)||r.push(new gh(t))}),this.su.forEach(function(t){n.has(t)||r.push(new vh(t))}),r},Ih.prototype.Eu=function(t){return this.nu=t.Ji,this.su=ji(),t=this.uu(t.documents),this.lu(t,!0)},Ih.prototype.mu=function(){return Fi.rn(this.query,this.ru,this.nn,0===this.eu)},Ih),wh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},bh=function(t){this.key=t,this.Tu=!1},Eh=(Object.defineProperty(Th.prototype,"Fu",{get:function(){return!0===this.xu},enumerable:!1,configurable:!0}),Th);function Th(t,e,n,r,i,o){this.jr=t,this.Au=e,this.Iu=n,this.Ru=r,this.currentUser=i,this.Pu=o,this.yu={},this.Vu=new Hu(cu,hu),this.pu=new Map,this.gu=[],this.vu=new Ti(ti.k),this.bu=new Map,this.Cu=new fh,this.Su={},this.Du=new Map,this.Nu=wa.fi(),this.onlineState="Unknown",this.xu=void 0}function Ih(t,e){this.query=t,this.nu=e,this.eu=null,this._n=!1,this.su=ji(),this.nn=ji(),this.iu=pu(t),this.ru=new xi(this.iu)}function Ah(){this.Uo=new dh,this.qo={},this.Or=null,this._s=null}function Nh(){this.activeTargetIds=Mi}function Oh(t,e){this.key=t,this.$o=e}function Rh(){this.Po=new Di(ph.yo),this.Vo=new Di(ph.po)}function kh(t,e,n){this.query=t,this.wo=e,this.Eo=!1,this.mo=null,this.onlineState="Unknown",this.options=n||{}}function Dh(f,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:(o=f).Au.Gr.io=function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.jr,c=s,(l=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=c.batch.keys(),n=l.Ai.Fi({Oi:!0}),i=l,o=t,s=n,u=(r=c).batch,a=u.keys(),h=Xu.resolve();return a.forEach(function(n){h=h.next(function(){return s.He(o,n)}).next(function(t){var e=t;Dr(null!==(t=r.Ce.get(n))),(!e||e.version.F(t)<0)&&(e=u.Ve(n,e,r))&&s.$i(e,r.be)})}),h.next(function(){return i.je.Li(o,u)}).next(function(){return n.apply(t)}).next(function(){return l.je.ki(t)}).next(function(){return l.yi.Je(t,e)})}))];case 2:return i=t.sent(),Vh(n,r,null),Lh(n,r),n.Ru.Qo(r,"acknowledged"),[4,xh(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,Da(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,c,l})})}.bind(null,o),o.Au.Gr.ro=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.jr,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.je.qu(e,r).next(function(t){return Dr(null!==t),n=t.keys(),i.je.Li(e,t)}).next(function(){return i.je.ki(e)}).next(function(){return i.yi.Je(e,n)})}))];case 2:return o=t.sent(),Vh(n,u,a),Lh(n,u),n.Ru.Qo(u,"rejected",a),[4,xh(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Da(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.jr,a=p,c=r,l=Kr.now(),i=a.reduce(function(t,e){return t.add(e.key)},ji()),c.persistence.runTransaction("Locally write mutations","readwrite",function(u){return c.yi.Je(u,i).next(function(t){h=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=h.get(i.key),s instanceof Ps?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof Xs?t.field(i.field):void 0;null!=(o=$o(i.transform,o||null))&&(e=(null==e?new xs:e).set(i.field,o))}return e?e.he():null}(o):null);null!=o&&e.push(new Os(i.key,o,function s(t){var u=[];return oo(t.fields||{},function(t,e){var n=new Zr([t]);if(No(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new ds(u)}(o.proto.mapValue),gs.exists(!0)))}return c.je.Mu(u,l,e,a)})}).then(function(t){var e=t.ve(h);return{batchId:t.batchId,Uu:e}}))];case 2:return s=t.sent(),u.Ru.Bo(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.Su[e.currentUser.h()])||new Ti(zr)).Tt(n,o),e.Su[e.currentUser.h()]=r,[4,xh(u,s.Uu)];case 3:return t.sent(),[4,eh(u.Au)];case 4:return t.sent(),[3,6];case 5:return u=ya(u=t.sent(),"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,h,c,l,i,o})})}function Sh(i,s){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:n=i,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.jr,c=e,l=(o=s).ft,f=c.wi,c.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=c.Ai.Fi({Oi:!0});f=c.wi;var u=[];o.on.forEach(function(t,e){var n,r,i,o=f.get(e);o&&(u.push(c.Ri.Ui(s,t.wn,e).next(function(){return c.Ri.qi(s,t.fn,e)})),0<(i=t.resumeToken).ht()&&(n=o.wt(i,l).dt(s.Bi),f=f.Tt(e,n),r=o,i=t,Dr(0<(o=n).resumeToken.ht()),(0===r.resumeToken.ht()||3e8<=o.ft.O()-r.ft.O()||0<i.fn.size+i.dn.size+i.wn.size)&&u.push(c.Ri.Qi(s,n))))});var e,a,n,h,r,i=Pi;return o.cn.forEach(function(t,e){o.an.has(t)&&u.push(c.persistence.Wi.ji(s,t))}),u.push((e=s,a=t,n=o.cn,h=l,r=ji(),n.forEach(function(t){return r=r.add(t)}),a.getEntries(e,r).next(function(i){var o=Pi;return n.forEach(function(t,e){var n=i.get(t),r=h;e instanceof Ys&&e.version.isEqual($r.min())?(a.Gi(t,r),o=o.Tt(t,e)):null==n||0<e.version.F(n.version)||0===e.version.F(n.version)&&n.hasPendingWrites?(a.$i(e,r),o=o.Tt(t,e)):Ar("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o}).next(function(t){i=t}))),l.isEqual($r.min())||(e=c.Ri.Mi(s).next(function(t){return c.Ri.Ki(s,s.Bi,l)}),u.push(e)),Xu.qe(u).next(function(){return t.apply(s)}).next(function(){return c.yi.Xe(s,i)})}).then(function(t){return c.wi=f,t}))];case 2:return r=t.sent(),s.on.forEach(function(t,e){(e=n.bu.get(e))&&(Dr(t.fn.size+t.dn.size+t.wn.size<=1),0<t.fn.size?e.Tu=!0:0<t.dn.size?Dr(e.Tu):0<t.wn.size&&(Dr(e.Tu),e.Tu=!1))}),[4,xh(n,r,s)];case 3:return t.sent(),[3,6];case 4:return[4,Da(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,o,c,l,f})})}function Ph(t,n,e){var r;((t=t).Fu&&0===e||!t.Fu&&1===e)&&(r=[],t.Vu.forEach(function(t,e){(e=e.view.lo(n)).snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].lo(i)&&(o=!0)}),o&&ch(t)}(t.Iu,n),r.length&&t.yu.Rr(r),t.onlineState=n,t.Fu&&t.Ru.Xo(n))}function _h(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:Qa((n=o).Au)||Ar("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.jr).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.je.Bu(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Du.get(r)||[]).push(s),n.Du.set(r,i),[3,4]);case 3:return i=ya(i=t.sent(),"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function Lh(t,e){(t.Du.get(e)||[]).forEach(function(t){t.resolve()}),t.Du.delete(e)}function Vh(t,e,n){var r=t,i=r.Su[r.currentUser.h()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.Su[r.currentUser.h()]=i)}function Ch(e,t,n){void 0===n&&(n=null),e.Ru.Go(t);for(var r=0,i=e.pu.get(t);r<i.length;r++){var o=i[r];e.Vu.delete(o),n&&e.yu.Ou(o,n)}e.pu.delete(t),e.Fu&&e.Cu.No(t).forEach(function(t){e.Cu.Oo(t)||Uh(e,t)})}function Uh(t,e){var n=t.vu.get(e);null!==n&&(Ha(t.Au,n),t.vu=t.vu.remove(e),t.bu.delete(n),Mh(t))}function jh(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var u=s[o];u instanceof vh?(t.Cu.vo(u.key,e),r=t,i=(i=u).key,r.vu.get(i)||(Ar("SyncEngine","New document in limbo: "+i),r.gu.push(i),Mh(r))):u instanceof gh?(Ar("SyncEngine","Document no longer in limbo: "+u.key),t.Cu.Co(u.key,e),t.Cu.Oo(u.key)||Uh(t,u.key)):kr()}}function Mh(t){for(;0<t.gu.length&&t.vu.size<t.Pu;){var e=t.gu.shift(),n=t.Nu.next();t.bu.set(n,new bh(e)),t.vu=t.vu.Tt(e,n),za(t.Au,new mi(uu(tu(e.path)),n,2,ra.Es))}}function xh(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Vu.W()?[3,3]:(n.Vu.forEach(function(t,e){o.push(n.ku(e,s,u).then(function(t){t&&(n.Fu&&n.Ru.Wo(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=na.ls(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.yu.Rr(r),[4,function(a,h){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Xu.forEach(h,function(e){return Xu.forEach(e.cs,function(t){return r.persistence.Wi.vo(n,e.targetId,t)}).next(function(){return Xu.forEach(e.hs,function(t){return r.persistence.Wi.Co(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!ha(e=t.sent()))throw e;return Ar("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=h;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.wi.get(o),u=s.ft,u=s.Et(u),r.wi=r.wi.Tt(o,u));return[2]}})})}(n.jr,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}var qh,Fh,Gh,Bh=(Nc.prototype.vi=function(t){this.Qu=t},Nc.prototype.ts=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.me.length||1===r.me.length&&r.me[0].field.tt())||i.isEqual($r.min())?this.ju(e,r):this.Qu.Je(e,o).next(function(t){var n=s.Wu(r,t);return(eu(r)||nu(r))&&s.hu(r.limitType,n,o,i)?s.ju(e,r):(Ir()<=u.DEBUG&&Ar("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),lu(r)),s.Qu.ts(e,r,i).next(function(e){return n.forEach(function(t){e=e.Tt(t.key,t)}),e}))})},Nc.prototype.Wu=function(n,t){var r=new Di(pu(n));return t.forEach(function(t,e){e instanceof Xs&&fu(n,e)&&(r=r.add(e))}),r},Nc.prototype.hu=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version.F(r))},Nc.prototype.ju=function(t,e){return Ir()<=u.DEBUG&&Ar("IndexFreeQueryEngine","Using full collection scan to execute query:",lu(e)),this.Qu.ts(t,e,$r.min())},Nc),Wh=(Ac.prototype.zu=function(t){return Xu.resolve(0===this.je.length)},Ac.prototype.Mu=function(t,e,n,r){var i=this.Gu;this.Gu++,0<this.je.length&&this.je[this.je.length-1],n=new Wu(i,e,n,r),this.je.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Ku=this.Ku.add(new ph(u.key,i)),this.We.hi(t,u.key.path.q())}return Xu.resolve(n)},Ac.prototype.qu=function(t,e){return Xu.resolve(this.Hu(e))},Ac.prototype.zi=function(t,e){return e+=1,e=(e=this.Yu(e))<0?0:e,Xu.resolve(this.je.length>e?this.je[e]:null)},Ac.prototype.Bu=function(){return Xu.resolve(0===this.je.length?-1:this.Gu-1)},Ac.prototype.Si=function(t){return Xu.resolve(this.je.slice())},Ac.prototype.Ke=function(t,e){var n=this,r=new ph(e,0),e=new ph(e,Number.POSITIVE_INFINITY),i=[];return this.Ku.jt([r,e],function(t){t=n.Hu(t.$o),i.push(t)}),Xu.resolve(i)},Ac.prototype.Ze=function(t,e){var n=this,r=new Di(zr);return e.forEach(function(t){var e=new ph(t,0),t=new ph(t,Number.POSITIVE_INFINITY);n.Ku.jt([e,t],function(t){r=r.add(t.$o)})}),Xu.resolve(this.Ju(r))},Ac.prototype.os=function(t,e){var n=e.path,r=n.length+1,e=n;ti.ot(e)||(e=e.child(""));var e=new ph(new ti(e),0),i=new Di(zr);return this.Ku.Wt(function(t){var e=t.key.path;return!!n.G(e)&&(e.length===r&&(i=i.add(t.$o)),!0)},e),Xu.resolve(this.Ju(i))},Ac.prototype.Ju=function(t){var e=this,n=[];return t.forEach(function(t){null!==(t=e.Hu(t))&&n.push(t)}),n},Ac.prototype.Li=function(n,r){var i=this;Dr(0===this.Xu(r.batchId,"removed")),this.je.shift();var o=this.Ku;return Xu.forEach(r.mutations,function(t){var e=new ph(t.key,r.batchId);return o=o.delete(e),i.Wi.Zu(n,t.key)}).next(function(){i.Ku=o})},Ac.prototype.tc=function(t){},Ac.prototype.Oo=function(t,e){var n=new ph(e,0),n=this.Ku.Gt(n);return Xu.resolve(e.isEqual(n&&n.key))},Ac.prototype.ki=function(t){return this.je.length,Xu.resolve()},Ac.prototype.Xu=function(t,e){return this.Yu(t)},Ac.prototype.Yu=function(t){return 0===this.je.length?0:t-this.je[0].batchId},Ac.prototype.Hu=function(t){return(t=this.Yu(t))<0||t>=this.je.length?null:this.je[t]},Ac),zh=(Ic.prototype.$i=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this.nc(e);return this.docs=this.docs.Tt(r,{ec:e,size:o,readTime:n}),this.size+=o-i,this.We.hi(t,r.path.q())},Ic.prototype.Gi=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Ic.prototype.He=function(t,e){return e=this.docs.get(e),Xu.resolve(e?e.ec:null)},Ic.prototype.getEntries=function(t,e){var n=this,r=Pi;return e.forEach(function(t){var e=n.docs.get(t);r=r.Tt(t,e?e.ec:null)}),Xu.resolve(r)},Ic.prototype.ts=function(t,e,n){for(var r=Vi,i=new ti(e.path.child("")),o=this.docs.gt(i);o.Nt();){var s=(u=o.Dt()).key,u=(a=u.value).ec,a=a.readTime;if(!e.path.G(s.path))break;a.F(n)<=0||u instanceof Xs&&fu(e,u)&&(r=r.Tt(u.key,u))}return Xu.resolve(r)},Ic.prototype.sc=function(t,e){return Xu.forEach(this.docs,function(t){return e(t)})},Ic.prototype.Fi=function(t){return new Hh(this)},Ic.prototype.ic=function(t){return Xu.resolve(this.size)},Ic),Hh=(Tc.prototype.oc=function(t){return(t=this.Uu.get(t))?t.readTime:$r.min()},Tc.prototype.$i=function(t,e){this.uc(),this.Uu.set(t.key,{ec:t,readTime:e})},Tc.prototype.Gi=function(t,e){void 0===e&&(e=null),this.uc(),this.Uu.set(t,{ec:null,readTime:e})},Tc.prototype.He=function(t,e){this.uc();var n=this.Uu.get(e);return void 0!==n?Xu.resolve(n.ec):this.cc(t,e)},Tc.prototype.getEntries=function(t,e){return this.ac(t,e)},Tc.prototype.apply=function(t){return this.uc(),this.rc=!0,this.lu(t)},Tc.prototype.uc=function(){},n(Ec,Gh=Tc),Ec.prototype.lu=function(n){var r=this,i=[];return this.Uu.forEach(function(t,e){e&&e.ec?i.push(r.hc.$i(n,e.ec,r.oc(t))):r.hc.Gi(t)}),Xu.qe(i)},Ec.prototype.cc=function(t,e){return this.hc.He(t,e)},Ec.prototype.ac=function(t,e){return this.hc.getEntries(t,e)},Ec),Xh=(bc.prototype.Qn=function(t,n){return this.lc.forEach(function(t,e){return n(e)}),Xu.resolve()},bc.prototype.Mi=function(t){return Xu.resolve(this.lastRemoteSnapshotVersion)},bc.prototype.wc=function(t){return Xu.resolve(this._c)},bc.prototype.$u=function(t){return this.highestTargetId=this.dc.next(),Xu.resolve(this.highestTargetId)},bc.prototype.Ki=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this._c&&(this._c=e),Xu.resolve()},bc.prototype.Ec=function(t){this.lc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.dc=new wa(e),this.highestTargetId=e),t.sequenceNumber>this._c&&(this._c=t.sequenceNumber)},bc.prototype.Lu=function(t,e){return this.Ec(e),this.targetCount+=1,Xu.resolve()},bc.prototype.Qi=function(t,e){return this.Ec(e),Xu.resolve()},bc.prototype.mc=function(t,e){return this.lc.delete(e.target),this.fc.No(e.targetId),--this.targetCount,Xu.resolve()},bc.prototype.Tc=function(n,r,i){var o=this,s=0,u=[];return this.lc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.lc.delete(t),u.push(o.Ac(n,e.targetId)),s++)}),Xu.qe(u).next(function(){return s})},bc.prototype.Ic=function(t){return Xu.resolve(this.targetCount)},bc.prototype.Hi=function(t,e){return e=this.lc.get(e)||null,Xu.resolve(e)},bc.prototype.qi=function(t,e,n){return this.fc.bo(e,n),Xu.resolve()},bc.prototype.Ui=function(e,t,n){this.fc.Do(t,n);var r=this.persistence.Wi,i=[];return r&&t.forEach(function(t){i.push(r.Zu(e,t))}),Xu.qe(i)},bc.prototype.Ac=function(t,e){return this.fc.No(e),Xu.resolve()},bc.prototype.Yi=function(t,e){return e=this.fc.Fo(e),Xu.resolve(e)},bc.prototype.Oo=function(t,e){return Xu.resolve(this.fc.Oo(e))},bc),Yh=(wc.prototype.yc=function(t,e){return Xu.resolve(this.Rc.get(e))},wc.prototype.Vc=function(t,e){return this.Rc.set(e.id,{id:e.id,version:e.version,createTime:Vo(e.createTime)}),Xu.resolve()},wc.prototype.gc=function(t,e){return Xu.resolve(this.Pc.get(e))},wc.prototype.vc=function(t,e){var n,r;return this.Pc.set(e.name,{name:(n=e).name,query:(e=Wo({parent:(r=n.bundledQuery).parent,structuredQuery:r.structuredQuery}),"LAST"===r.limitType?au(e,e.limit,"L"):e),readTime:Vo(n.readTime)}),Xu.resolve()},wc),Kh=(mc.prototype.start=function(){return Promise.resolve()},mc.prototype.Zo=function(){return this.Sc=!1,Promise.resolve()},Object.defineProperty(mc.prototype,"Nc",{get:function(){return this.Sc},enumerable:!1,configurable:!0}),mc.prototype.xc=function(){},mc.prototype.Fc=function(){},mc.prototype.Vi=function(){return this.We},mc.prototype.Ti=function(t){var e=this.bc[t.h()];return e||(e=new Wh(this.We,this.Wi),this.bc[t.h()]=e),e},mc.prototype.Pi=function(){return this.Ri},mc.prototype.Ii=function(){return this.Qe},mc.prototype.gi=function(){return this.pi},mc.prototype.runTransaction=function(t,e,n){var r=this;Ar("MemoryPersistence","Starting transaction:",t);var i=new $h(this.Cc.next());return this.Wi.Oc(),n(i).next(function(t){return r.Wi.$c(i).next(function(){return t})}).Me().then(function(t){return i.Lc(),t})},mc.prototype.kc=function(e,n){return Xu.Be(Object.values(this.bc).map(function(t){return function(){return t.Oo(e,n)}}))},mc),$h=(gc.prototype.Uc=function(t){this.Mc.push(t)},gc.prototype.Lc=function(){this.Mc.forEach(function(t){return t()})},n(vc,Fh=gc),vc),Qh=(yc.Qc=function(t){return new yc(t)},Object.defineProperty(yc.prototype,"jc",{get:function(){if(this.Bc)return this.Bc;throw kr()},enumerable:!1,configurable:!0}),yc.prototype.vo=function(t,e,n){return this.qc.vo(n,e),this.jc.delete(n.toString()),Xu.resolve()},yc.prototype.Co=function(t,e,n){return this.qc.Co(n,e),this.jc.add(n.toString()),Xu.resolve()},yc.prototype.Zu=function(t,e){return this.jc.add(e.toString()),Xu.resolve()},yc.prototype.removeTarget=function(t,e){var n=this;this.qc.No(e.targetId).forEach(function(t){return n.jc.add(t.toString())});var r=this.persistence.Pi();return r.Yi(t,e.targetId).next(function(t){t.forEach(function(t){return n.jc.add(t.toString())})}).next(function(){return r.mc(t,e)})},yc.prototype.Oc=function(){this.Bc=new Set},yc.prototype.$c=function(n){var r=this,i=this.persistence.Ii().Fi();return Xu.forEach(this.jc,function(t){var e=ti.st(t);return r.Wc(n,e).next(function(t){t||i.Gi(e)})}).next(function(){return r.Bc=null,i.apply(n)})},yc.prototype.ji=function(t,e){var n=this;return this.Wc(t,e).next(function(t){t?n.jc.delete(e.toString()):n.jc.add(e.toString())})},yc.prototype.Dc=function(t){return 0},yc.prototype.Wc=function(t,e){var n=this;return Xu.Be([function(){return Xu.resolve(n.qc.Oo(e))},function(){return n.persistence.Pi().Oo(t,e)},function(){return n.persistence.kc(t,e)}])},yc),Jh=(dc.prototype.Ar=function(t){this.zc=t},dc.prototype.dr=function(t){this.Hc=t},dc.prototype.onMessage=function(t){this.Yc=t},dc.prototype.close=function(){this.Kc()},dc.prototype.send=function(t){this.Gc(t)},dc.prototype.Jc=function(){this.zc()},dc.prototype.Xc=function(t){this.Hc(t)},dc.prototype.Zc=function(t){this.Yc(t)},dc),Zh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},tc=(pc.prototype.Nr=function(e,t,n,r){var i=this.sa(e,t);return Ar("RestConnection","Sending: ",i,n),t={},this.ia(t,r),this.ra(e,i,t,n).then(function(t){return Ar("RestConnection","Received: ",t),t},function(t){throw Or("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},pc.prototype.Fr=function(t,e,n,r){return this.Nr(t,e,n,r)},pc.prototype.ia=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.1.0-202010180421",t["Content-Type"]="text/plain",e)for(var n in e.m)e.m.hasOwnProperty(n)&&(t[n]=e.m[n])},pc.prototype.sa=function(t,e){return t=Zh[t],this.na+"/v1/"+e+":"+t},n(fc,qh=pc),fc.prototype.ra=function(o,e,s,u){return new Promise(function(n,r){var i=new dr;i.listenOnce(fr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case lr.NO_ERROR:var t=i.getResponseJson();Ar("Connection","XHR received:",JSON.stringify(t)),n(t);break;case lr.TIMEOUT:Ar("Connection",'RPC "'+o+'" timed out'),r(new Lr(_r.DEADLINE_EXCEEDED,"Request time out"));break;case lr.HTTP_ERROR:var e=i.getStatus();Ar("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(_r).indexOf(e)?e:_r.UNKNOWN,r(new Lr(e,t.message))):r(new Lr(_r.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Lr(_r.UNAVAILABLE,"Connection failed."));break;default:kr()}}finally{Ar("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},fc.prototype.Ir=function(t,e){var n,r=[this.na,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new sr,t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.ia(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),Ar("Connection","Creating WebChannel: "+(r=r.join("")),t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new Jh({Gc:function(t){u?Ar("Connection","Not sending because WebChannel is closed:",t):(s||(Ar("Connection","Opening WebChannel transport."),o.open(),s=!0),Ar("Connection","WebChannel sending:",t),o.send(t))},Kc:function(){return o.close()}});return(t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})})(pr.EventType.OPEN,function(){u||Ar("Connection","WebChannel transport opened.")}),t(pr.EventType.CLOSE,function(){u||(u=!0,Ar("Connection","WebChannel transport closed"),a.Xc())}),t(pr.EventType.ERROR,function(t){u||(u=!0,Or("Connection","WebChannel transport errored:",t),a.Xc(new Lr(_r.UNAVAILABLE,"The operation could not be completed")))}),t(pr.EventType.MESSAGE,function(t){var e,n,r,i;u||(Dr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Ar("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=gi[r];if(void 0!==t)return Ei(t)}(),i=n.message,void 0===t&&(t=_r.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.Xc(new Lr(t,i)),o.close()):(Ar("Connection","WebChannel received:",e),a.Zc(e)))}),setTimeout(function(){a.Jc()},0),a},fc),ec=(lc.prototype.Xr=function(t){this.ha.push(t)},lc.prototype.Zo=function(){window.removeEventListener("online",this.oa),window.removeEventListener("offline",this.ca)},lc.prototype.la=function(){window.addEventListener("online",this.oa),window.addEventListener("offline",this.ca)},lc.prototype.ua=function(){Ar("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.ha;t<e.length;t++)(0,e[t])(0)},lc.prototype.aa=function(){Ar("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.ha;t<e.length;t++)(0,e[t])(1)},lc._a=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},lc),nc=(cc.prototype.Xr=function(t){},cc.prototype.Zo=function(){},cc),rc=(hc.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.serializer=Zu(e.ta.t),this.Ru=this.fa(e),this.persistence=this.da(e),[4,this.persistence.start()];case 1:return t.sent(),this.wa=this.Ea(e),this.jr=this.ma(e),[2]}})})},hc.prototype.Ea=function(t){return null},hc.prototype.ma=function(t){return e=this.persistence,n=new Bh,r=t.Ta,t=this.serializer,new ba(e,n,r,t);var e,n,r},hc.prototype.da=function(t){return new Kh(Qh.Qc,this.serializer)},hc.prototype.fa=function(t){return new yh},hc.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.wa&&this.wa.stop(),[4,this.Ru.Zo()];case 1:return t.sent(),[4,this.persistence.Zo()];case 2:return t.sent(),[2]}})})},hc),ic=(ac.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.jr?[3,2]:(this.jr=n.jr,this.Ru=n.Ru,this.Wr=this.Aa(r),this.Au=this.Ia(r),this.Iu=this.Ra(r),this.Pa=this.ya(r,!n.synchronizeTabs),this.Ru.Or=function(t){return Ph(e.Pa,t,1)},this.Au.Gr.Va=function(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Ar("SyncEngine","User change. New user:",o.h()),[4,Na(n.jr,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Du.forEach(function(t){t.forEach(function(t){t.reject(new Lr(_r.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Du.clear(),n.Ru.Jo(o,r.Ni,r.xi),[4,xh(n,r.Di)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this.Pa),[4,function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Hr.delete(2),[4,Ba(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Hr.add(2),[4,Wa(e)]);case 3:t.sent(),e.Zr.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.Au,this.Pa.Fu)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},ac.prototype.Ra=function(t){return new sh},ac.prototype.Aa=function(t){var e=Zu(t.ta.t),n=(n=t.ta,new tc(n));return t=t.credentials,new Ua(t,n,e)},ac.prototype.Ia=function(t){var e=this;return new Sa(this.jr,this.Wr,t.Ns,function(t){return Ph(e.Pa,t,0)},t=new(ec._a()?ec:nc))},ac.prototype.ya=function(t,e){return n=this.jr,r=this.Au,i=this.Iu,o=this.Ru,s=t.Ta,t=t.Pu,e=e,t=new Eh(n,r,i,o,s,t),e&&(t.xu=!0),t;var n,r,i,o,s},ac.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Ar("RemoteStore","RemoteStore shutting down."),e.Hr.add(5),[4,Wa(e)];case 1:return t.sent(),e.Jr.Zo(),e.Zr.set("Unknown"),[2]}})})}(this.Au)},ac),oc=(uc.prototype.next=function(t){this.observer.next&&this.pa(this.observer.next,t)},uc.prototype.error=function(t){this.observer.error?this.pa(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},uc.prototype.ga=function(){this.muted=!0},uc.prototype.pa=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},uc),sc=function(t){this.va=t};function uc(t){this.observer=t,this.muted=!1}function ac(){}function hc(){this.synchronizeTabs=!1}function cc(){}function lc(){var t=this;this.oa=function(){return t.ua()},this.ca=function(){return t.aa()},this.ha=[],this.la()}function fc(t){var e=this;return(e=qh.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.i=t.i,e}function pc(t){this.ta=t,this.t=t.t;var e=t.ssl?"https":"http";this.na=e+"://"+t.host,this.ea="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}function dc(t){this.Gc=t.Gc,this.Kc=t.Kc}function yc(t){this.persistence=t,this.qc=new fh,this.Bc=null}function vc(t){var e=this;return(e=Fh.call(this)||this).Bi=t,e}function gc(){this.Mc=[]}function mc(t,e){var n=this;this.bc={},this.Cc=new ra(0),this.Sc=!1,this.Sc=!0,this.Wi=t(this),this.Ri=new Xh(this),this.We=new ga,this.Qe=(t=this.We,new zh(t,function(t){return n.Wi.Dc(t)})),this.serializer=new va(e),this.pi=new Yh(this.serializer)}function wc(t){this.serializer=t,this.Rc=new Map,this.Pc=new Map}function bc(t){this.persistence=t,this.lc=new Hu(li,fi),this.lastRemoteSnapshotVersion=$r.min(),this.highestTargetId=0,this._c=0,this.fc=new fh,this.targetCount=0,this.dc=wa._i()}function Ec(t){var e=this;return(e=Gh.call(this)||this).hc=t,e}function Tc(){this.Uu=new Hu(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.rc=!1}function Ic(t,e){this.We=t,this.nc=e,this.docs=new Ti(ti.k),this.size=0}function Ac(t,e){this.We=t,this.Wi=e,this.je=[],this.Gu=1,this.Ku=new Di(ph.yo)}function Nc(){}function Oc(t,e,n){if(!n)throw new Lr(_r.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Rc(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Lr(_r.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function kc(t,e,n,r){if(!0===e&&!0===r)throw new Lr(_r.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Dc(t){if(!ti.ot(t))throw new Lr(_r.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Sc(t){if(ti.ot(t))throw new Lr(_r.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Pc(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":kr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function _c(t,e){if(t instanceof sc&&(t=t.va),t instanceof e)return t;if(e.name===t.constructor.name)throw new Lr(_r.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");throw t=Pc(t),new Lr(_r.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function Lc(t,e){if(e<=0)throw new Lr(_r.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Vc,Cc=function(t){this.ba=t},Uc=(n(jc,Vc=Cc),jc.prototype.Ca=function(t){if(2!==t.Sa)throw 1===t.Sa?t.Da(this.ba+"() can only appear at the top level of your update data"):t.Da(this.ba+"() cannot be used with set() unless you pass {merge:true}");return t.ee.push(t.path),null},jc.prototype.isEqual=function(t){return t instanceof jc},jc);function jc(){return null!==Vc&&Vc.apply(this,arguments)||this}function Mc(t,e,n){return new Pf({Sa:3,Na:e.settings.Na,methodName:t.ba,xa:n},e.t,e.serializer,e.ignoreUndefinedProperties)}var xc,qc,Fc,Gc,Bc=(n(ol,Gc=Cc),ol.prototype.Ca=function(t){return new ps(t.path,new Zo)},ol.prototype.isEqual=function(t){return t instanceof ol},ol),Wc=(n(il,Fc=Cc),il.prototype.Ca=function(t){var e=Mc(this,t,!0),n=this.Fa.map(function(t){return xf(t,e)}),n=new ts(n);return new ps(t.path,n)},il.prototype.isEqual=function(t){return this===t},il),zc=(n(rl,qc=Cc),rl.prototype.Ca=function(t){var e=Mc(this,t,!0),n=this.Fa.map(function(t){return xf(t,e)}),n=new os(n);return new ps(t.path,n)},rl.prototype.isEqual=function(t){return this===t},rl),Hc=(n(nl,xc=Cc),nl.prototype.Ca=function(t){var e=new hs(t.serializer,Po(t.serializer,this.Oa));return new ps(t.path,e)},nl.prototype.isEqual=function(t){return this===t},nl),Xc=(Object.defineProperty(el.prototype,"latitude",{get:function(){return this.$a},enumerable:!1,configurable:!0}),Object.defineProperty(el.prototype,"longitude",{get:function(){return this.La},enumerable:!1,configurable:!0}),el.prototype.isEqual=function(t){return this.$a===t.$a&&this.La===t.La},el.prototype.toJSON=function(){return{latitude:this.$a,longitude:this.La}},el.prototype.D=function(t){return zr(this.$a,t.$a)||zr(this.La,t.La)},el),Yc=(tl.fromBase64String=function(t){try{return new tl(di.fromBase64String(t))}catch(t){throw new Lr(_r.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},tl.fromUint8Array=function(t){return new tl(di.fromUint8Array(t))},tl.prototype.toBase64=function(){return this.ka.toBase64()},tl.prototype.toUint8Array=function(){return this.ka.toUint8Array()},tl.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},tl.prototype.isEqual=function(t){return this.ka.isEqual(t.ka)},tl),Kc=new Map,$c=(Zc.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Zc),Qc=(Object.defineProperty(Jc.prototype,"app",{get:function(){if(!this.ja)throw new Lr(_r.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.ja},enumerable:!1,configurable:!0}),Object.defineProperty(Jc.prototype,"Wa",{get:function(){return this.qa},enumerable:!1,configurable:!0}),Object.defineProperty(Jc.prototype,"Ga",{get:function(){return void 0!==this.Ka},enumerable:!1,configurable:!0}),Jc.prototype.za=function(t){if(this.qa)throw new Lr(_r.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.Ua=new $c(t),void 0!==t.credentials&&(this.Qa=function(t){if(!t)return new Vr;switch(t.type){case"gapi":var e=t.client;return Dr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new jr(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Lr(_r.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Jc.prototype.Ha=function(){return this.Ua},Jc.prototype.Ya=function(){return this.qa=!0,this.Ua},Jc.prototype._delete=function(){return this.Ka||(this.Ka=this.Ja()),this.Ka},Jc.prototype.Ja=function(){return(t=Kc.get(this))&&(Ar("ComponentProvider","Removing Datastore"),Kc.delete(this),t.terminate()),Promise.resolve();var t},Jc);function Jc(t,e){this.Ma="(lite)",this.Ua=new $c({}),this.qa=!1,t instanceof gr?(this.Ba=t,this.Qa=new Vr):(this.ja=t,this.Ba=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Lr(_r.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new gr(t.options.projectId)}(t),this.Qa=new Cr(e))}function Zc(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Lr(_r.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Lr(_r.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,kc("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function tl(t){this.ka=t}function el(t,e){if(!isFinite(t)||t<-90||90<t)throw new Lr(_r.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Lr(_r.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.$a=t,this.La=e}function nl(t,e){var n=this;return(n=xc.call(this,t)||this).Oa=e,n}function rl(t,e){var n=this;return(n=qc.call(this,t)||this).Fa=e,n}function il(t,e){var n=this;return(n=Fc.call(this,t)||this).Fa=e,n}function ol(){return null!==Gc&&Gc.apply(this,arguments)||this}function sl(){if("undefined"==typeof Uint8Array)throw new Lr(_r.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function ul(){if("undefined"==typeof atob)throw new Lr(_r.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var al,hl,cl,ll=(n(wl,cl=Yc),wl.fromBase64String=function(t){ul();try{return new wl(di.fromBase64String(t))}catch(t){throw new Lr(_r.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},wl.fromUint8Array=function(t){return sl(),new wl(di.fromUint8Array(t))},wl.prototype.toBase64=function(){return ul(),cl.prototype.toBase64.call(this)},wl.prototype.toUint8Array=function(){return sl(),cl.prototype.toUint8Array.call(this)},wl.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},wl),me=(ml.prototype.Xa=function(t,e){switch(void 0===e&&(e="none"),co(t)){case 0:return null;case 1:return t.booleanValue;case 2:return mo(t.integerValue||t.doubleValue);case 3:return this.Za(t.timestampValue);case 4:return this.th(t,e);case 5:return t.stringValue;case 6:return this.nh(wo(t.bytesValue));case 7:return this.eh(t.referenceValue);case 8:return this.sh(t.geoPointValue);case 9:return this.ih(t.arrayValue,e);case 10:return this.rh(t.mapValue,e);default:throw kr()}},ml.prototype.rh=function(t,n){var r=this,i={};return oo(t.fields||{},function(t,e){i[t]=r.Xa(e,n)}),i},ml.prototype.sh=function(t){return new Xc(mo(t.latitude),mo(t.longitude))},ml.prototype.ih=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.Xa(t,e)})},ml.prototype.th=function(t,e){switch(e){case"previous":var n=function t(e){return uo(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==n?null:this.Xa(n,e);case"estimate":return this.Za(ao(t));default:return null}},ml.prototype.Za=function(t){return t=go(t),new Kr(t.seconds,t.nanos)},ml.prototype.oh=function(t,e){var n=Qr.J(t);return Dr(Ko(n)),t=new gr(n.get(1),n.get(3)),n=new ti(n.U(5)),t.isEqual(e)||Nr("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},ml),fl=(n(gl,hl=me),gl.prototype.nh=function(t){return new ll(t)},gl.prototype.eh=function(t){return t=this.oh(t,this.firestore.Ba),Dp.uh(t,this.firestore,null)},gl),pl=(Object.defineProperty(vl.prototype,"id",{get:function(){return this.lh.path.j()},enumerable:!1,configurable:!0}),Object.defineProperty(vl.prototype,"ref",{get:function(){return new Gl(this.ah,this.fh,this.lh)},enumerable:!1,configurable:!0}),vl.prototype.exists=function(){return null!==this._h},vl.prototype.data=function(){if(this._h){if(this.fh){var t=new dl(this.ah,this.hh,this.lh,this._h,null);return this.fh.fromFirestore(t)}return this.hh.Xa(this._h.Ee())}},vl.prototype.get=function(t){if(this._h&&null!==(t=this._h.data().field(bl("DocumentSnapshot.get",t))))return this.hh.Xa(t)},vl),dl=(n(yl,al=pl),yl.prototype.data=function(){return al.prototype.data.call(this)},yl);function yl(){return null!==al&&al.apply(this,arguments)||this}function vl(t,e,n,r,i){this.ah=t,this.hh=e,this.lh=n,this._h=r,this.fh=i}function gl(t){var e=this;return(e=hl.call(this)||this).firestore=t,e}function ml(){}function wl(){return null!==cl&&cl.apply(this,arguments)||this}function bl(t,e){return"string"==typeof e?zf(t,e):(e instanceof sc?e.va:e).dh}var El,Tl=(Nl.prototype.isEqual=function(t){return this.dh.isEqual(t.dh)},Nl),Il=(n(Al,El=Qc),Al.prototype.Ja=function(){return this.Eh||Ip(this),this.Eh.terminate()},Al);function Al(t,e){var n=this;return(n=El.call(this,t,e)||this).wh=new fa,n.Ma="name"in t?t.name:"[DEFAULT]",n}function Nl(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Lr(_r.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.dh=new Zr(t)}var Ol,Rl,kl=(n(Ll,Rl=pl),Ll.prototype.exists=function(){return Rl.prototype.exists.call(this)},Ll.prototype.data=function(t){if(void 0===t&&(t={}),this._h){if(this.fh){var e=new Dl(this.ah,this.hh,this.lh,this._h,this.metadata,null);return this.fh.fromFirestore(e,t)}return this.hh.Xa(this._h.Ee(),t.serverTimestamps)}},Ll.prototype.get=function(t,e){if(void 0===e&&(e={}),this._h&&null!==(t=this._h.data().field(bl("DocumentSnapshot.get",t))))return this.hh.Xa(t,e.serverTimestamps)},Ll),Dl=(n(_l,Ol=kl),_l.prototype.data=function(t){return void 0===t&&(t={}),Ol.prototype.data.call(this,t)},_l),Sl=(Object.defineProperty(Pl.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Pl.prototype,"size",{get:function(){return this.Th.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(Pl.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),Pl.prototype.forEach=function(e,n){var r=this;this.Th.docs.forEach(function(t){e.call(n,new Dl(r.ah,r.hh,t.key,t,new Gp(r.Th.nn.has(t.key),r.Th.fromCache),r.query.fh))})},Pl.prototype.docChanges=function(t){if(void 0===t&&(t={}),(t=!!t.includeMetadataChanges)&&this.Th.sn)throw new Lr(_r.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Ah&&this.Ih===t||(this.Ah=function(i,e){if(i.Th.tn.W()){var n=0;return i.Th.docChanges.map(function(t){var e=new Dl(i.ah,i.hh,t.doc.key,t.doc,new Gp(i.Th.nn.has(t.doc.key),i.Th.fromCache),i.query.fh);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.Th.tn;return i.Th.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new Dl(i.ah,i.hh,t.doc.key,t.doc,new Gp(i.Th.nn.has(t.doc.key),i.Th.fromCache),i.query.fh),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return kr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.Ih=t),this.Ah},Pl);function Pl(t,e,n,r){this.ah=t,this.hh=e,this.Th=r,this.metadata=new Gp(r.hasPendingWrites,r.fromCache),this.query=n}function _l(){return null!==Ol&&Ol.apply(this,arguments)||this}function Ll(t,e,n,r,i,o){var s=this;return(s=Rl.call(this,t,e,n,r,o)||this).ah=t,s.mh=t,s.metadata=i,s}function Vl(t,e){return t instanceof kl&&e instanceof kl?t.ah===e.ah&&t.lh.isEqual(e.lh)&&(null===t._h?null===e._h:t._h.isEqual(e._h))&&t.fh===e.fh:t instanceof Sl&&e instanceof Sl&&t.ah===e.ah&&If(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.Th.isEqual(e.Th)}var Cl,Ul=(n(jl,Cl=me),jl.prototype.nh=function(t){return new Yc(t)},jl.prototype.eh=function(t){return t=this.oh(t,this.firestore.Ba),new Gl(this.firestore,null,t)},jl);function jl(t){var e=this;return(e=Cl.call(this)||this).firestore=t,e}function Ml(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=_c(t.firestore,Il),s=Af(o);return e instanceof sc&&(e=e.va),ql(o,("string"==typeof e||e instanceof Tl?jf(s,"updateDoc",t.lh,e,n,r):Uf(s,"updateDoc",t.lh,e)).Ph(t.lh,gs.exists(!0)))}function xl(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i={includeMetadataChanges:!1},o=0;"object"!=typeof n[o]||ta(n[o])||(i=n[o],o++);var s,u,a,h,c,l={includeMetadataChanges:i.includeMetadataChanges};ta(n[o])&&(a=n[o],n[o]=null===(i=a.next)||void 0===i?void 0:i.bind(a),n[o+1]=null===(i=a.error)||void 0===i?void 0:i.bind(a),n[o+2]=null===(i=a.complete)||void 0===i?void 0:i.bind(a)),e instanceof Gl?(s=_c(e.firestore,Il),u=tu(e.lh.path),c={next:function(t){n[o]&&n[o](Fl(s,e,t))},error:n[o+1],complete:n[o+2]}):(s=_c(e.firestore,Il),u=e.Rh,h=new Ul(s),c={next:function(t){n[o]&&n[o](new Sl(s,h,e,t))},error:n[o+1],complete:n[o+2]},pf(e.Rh));var f=Tp(s),p=new oc(c),d=new lh(u,p,l);return s.wh.Ms(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=ah,[4,sp(f)];case 1:return[2,e.apply(void 0,[t.sent(),d])]}})})}),function(){p.ga(),s.wh.Ms(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=hh,[4,sp(f)];case 1:return[2,e.apply(void 0,[t.sent(),d])]}})})})}}function ql(t,e){return function(n,r){var t=this,i=new Yu;return n.Ns.Ms(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Dh,[4,op(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(Tp(t),e)}function Fl(t,e,n){var r=n.docs.get(e.lh),i=new Ul(t);return new kl(t,i,e.lh,r,new Gp(n.hasPendingWrites,n.fromCache),e.fh)}var Gl=(Object.defineProperty(zl.prototype,"yh",{get:function(){return this.lh.path},enumerable:!1,configurable:!0}),Object.defineProperty(zl.prototype,"id",{get:function(){return this.lh.path.j()},enumerable:!1,configurable:!0}),Object.defineProperty(zl.prototype,"path",{get:function(){return this.lh.path.Y()},enumerable:!1,configurable:!0}),Object.defineProperty(zl.prototype,"parent",{get:function(){return new yf(this.firestore,this.fh,this.lh.path.q())},enumerable:!1,configurable:!0}),zl.prototype.withConverter=function(t){return new zl(this.firestore,t,this.lh)},zl),Bl=(Wl.prototype.withConverter=function(t){return new Wl(this.firestore,t,this.Rh)},Wl);function Wl(t,e,n){this.fh=e,this.Rh=n,this.type="query",this.firestore=t}function zl(t,e,n){this.fh=e,this.lh=n,this.type="document",this.firestore=t}function Hl(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++)t=i[r].Vh(t);return t}var Xl,Yl,Kl,$l,Ql,Jl=(n(af,Ql=l=function(){}),af.prototype.Vh=function(t){var e=Af(t.firestore),e=function(t,e,n,r,i,o){if(r.tt()){if("array-contains"===i||"array-contains-any"===i)throw new Lr(_r.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){lf(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var h=a[u];s.push(cf(n,t,h))}c={arrayValue:{values:s}}}else c=cf(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||lf(o,i),c=Mf(e,"where",o,"in"===i||"not-in"===i);var c=yu.create(r,i,c);return function(t,e){if(e.Ie()){var n=iu(t);if(null!==n&&!n.isEqual(e.field))throw new Lr(_r.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=ru(t))&&ff(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new Lr(_r.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Lr(_r.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,c),c}(t.Rh,e,t.firestore.Ba,this.ph,this.gh,this.bh);return new Bl(t.firestore,t.fh,(e=(t=t.Rh).filters.concat([e]),new $s(t.path,t.collectionGroup,t.me.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},af),Zl=(n(uf,$l=l),uf.prototype.Vh=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Lr(_r.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Lr(_r.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Bu(e,n);return e=r,null!==ru(n=t)||null!==(t=iu(n))&&ff(0,t,e.field),r}(t.Rh,this.ph,this.Ch);return new Bl(t.firestore,t.fh,(e=(t=t.Rh).me.concat([e]),new $s(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},uf),tf=(n(sf,Kl=l),sf.prototype.Vh=function(t){return new Bl(t.firestore,t.fh,au(t.Rh,this.Sh,this.Dh))},sf),ef=(n(of,Yl=l),of.prototype.Vh=function(t){var e=hf(t,this.type,this.Nh,this.xh);return new Bl(t.firestore,t.fh,(t=t.Rh,new $s(t.path,t.collectionGroup,t.me.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},of),nf=(n(rf,Xl=l),rf.prototype.Vh=function(t){var e=hf(t,this.type,this.Nh,this.xh);return new Bl(t.firestore,t.fh,(t=t.Rh,new $s(t.path,t.collectionGroup,t.me.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},rf);function rf(t,e,n){var r=this;return(r=Xl.call(this)||this).type=t,r.Nh=e,r.xh=n,r}function of(t,e,n){var r=this;return(r=Yl.call(this)||this).type=t,r.Nh=e,r.xh=n,r}function sf(t,e,n){var r=this;return(r=Kl.call(this)||this).type=t,r.Sh=e,r.Dh=n,r}function uf(t,e){var n=this;return(n=$l.call(this)||this).ph=t,n.Ch=e,n.type="orderBy",n}function af(t,e,n){var r=this;return(r=Ql.call(this)||this).ph=t,r.gh=e,r.bh=n,r.type="where",r}function hf(t,h,e,n){if(e[0]instanceof sc&&(e[0]=e[0].va),e[0]instanceof pl)return function(t,e,n,r){if(!n)throw new Lr(_r.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+h+"().");for(var i=[],o=0,s=su(t);o<s.length;o++){var u=s[o];if(u.field.tt())i.push(bo(e,n.key));else{var a=n.field(u.field);if(uo(a))throw new Lr(_r.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a)throw u=u.field.Y(),new Lr(_r.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.");i.push(a)}}return new Cu(i,r)}(t.Rh,t.firestore.Ba,e[0]._h,n);var r=Af(t.firestore);return function(t,e,n,r,i,o){var s=t.me;if(i.length>s.length)throw new Lr(_r.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var h=i[a];if(s[a].field.tt()){if("string"!=typeof h)throw new Lr(_r.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!ou(t)&&-1!==h.indexOf("/"))throw new Lr(_r.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(Qr.J(h));if(!ti.ot(c))throw new Lr(_r.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");c=new ti(c),u.push(bo(e,c))}else h=Mf(n,r,h),u.push(h)}return new Cu(u,o)}(t.Rh,t.firestore.Ba,r,h,e,n)}function cf(t,e,n){if(n instanceof sc&&(n=n.va),"string"==typeof n){if(""===n)throw new Lr(_r.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!ou(e)&&-1!==n.indexOf("/"))throw new Lr(_r.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child(Qr.J(n)),!ti.ot(e))throw new Lr(_r.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return bo(t,new ti(e))}if(n instanceof Gl)return bo(t,n.lh);throw new Lr(_r.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Pc(n)+".")}function lf(t,e){if(!Array.isArray(t)||0===t.length)throw new Lr(_r.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Lr(_r.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function ff(t,e,n){if(!n.isEqual(e))throw new Lr(_r.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function pf(t){if(nu(t)&&0===t.me.length)throw new Lr(_r.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var df,yf=(n(vf,df=Bl),Object.defineProperty(vf.prototype,"id",{get:function(){return this.Rh.path.j()},enumerable:!1,configurable:!0}),Object.defineProperty(vf.prototype,"path",{get:function(){return this.Rh.path.Y()},enumerable:!1,configurable:!0}),Object.defineProperty(vf.prototype,"parent",{get:function(){var t=this.yh.q();return t.W()?null:new Gl(this.firestore,null,new ti(t))},enumerable:!1,configurable:!0}),vf.prototype.withConverter=function(t){return new vf(this.firestore,t,this.yh)},vf);function vf(t,e,n){var r=this;return(r=df.call(this,t,e,tu(n))||this).firestore=t,r.yh=n,r.type="collection",r}function gf(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(Oc("collection","path",e),t instanceof Qc){var i=Qr.J.apply(Qr,s([e],n));return Sc(i),new yf(t,null,i)}if(!(t instanceof Gl||t instanceof yf))throw new Lr(_r.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Sc(e=Qr.J.apply(Qr,s([t.path],n)).child(Qr.J(e))),new yf(t.firestore,null,e)}function mf(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(1===arguments.length&&(e=Br.S()),Oc("doc","path",e),t instanceof Qc){var i=Qr.J.apply(Qr,s([e],n));return Dc(i),new Gl(t,null,new ti(i))}if(!(t instanceof Gl||t instanceof yf))throw new Lr(_r.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Dc(e=t.yh.child(Qr.J.apply(Qr,s([e],n)))),new Gl(t.firestore,t instanceof yf?t.fh:null,new ti(e))}var wf,bf=(n(Ef,wf=me),Ef.prototype.nh=function(t){return new Yc(t)},Ef.prototype.eh=function(t){return t=this.oh(t,this.firestore.Ba),new Gl(this.firestore,null,t)},Ef);function Ef(t){var e=this;return(e=wf.call(this)||this).firestore=t,e}function Tf(t,e){return(t instanceof Gl||t instanceof yf)&&(e instanceof Gl||e instanceof yf)&&t.firestore===e.firestore&&t.path===e.path&&t.fh===e.fh}function If(t,e){return t instanceof Bl&&e instanceof Bl&&t.firestore===e.firestore&&hu(t.Rh,e.Rh)&&t.fh===e.fh}function Af(t){var e=t.Ya(),n=Zu(t.Ba);return new _f(t.Ba,!!e.ignoreUndefinedProperties,n)}var Nf=/^__.*__$/,Of=(Df.prototype.Ph=function(t,e){var n=[];return null!==this.ee?n.push(new Os(t,this.data,this.ee,e)):n.push(new Ns(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Ps(t,this.fieldTransforms)),n},Df),Rf=(kf.prototype.Ph=function(t,e){return e=[new Os(t,this.data,this.ee,e)],0<this.fieldTransforms.length&&e.push(new Ps(t,this.fieldTransforms)),e},kf);function kf(t,e,n){this.data=t,this.ee=e,this.fieldTransforms=n}function Df(t,e,n){this.data=t,this.ee=e,this.fieldTransforms=n}function Sf(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw kr()}}var Pf=(Object.defineProperty(Vf.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Vf.prototype,"Sa",{get:function(){return this.settings.Sa},enumerable:!1,configurable:!0}),Vf.prototype.Oh=function(t){return new Vf(Object.assign(Object.assign({},this.settings),t),this.t,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.ee)},Vf.prototype.$h=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.Oh({path:e,xa:!1})).Lh(t),e},Vf.prototype.kh=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t);return(t=this.Oh({path:t,xa:!1})).Fh(),t},Vf.prototype.Mh=function(t){return this.Oh({path:void 0,xa:!0})},Vf.prototype.Da=function(t){return Hf(t,this.settings.methodName,this.settings.Uh||!1,this.path,this.settings.Na)},Vf.prototype.contains=function(e){return void 0!==this.ee.find(function(t){return e.G(t)})||void 0!==this.fieldTransforms.find(function(t){return e.G(t.field)})},Vf.prototype.Fh=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Lh(this.path.get(t))},Vf.prototype.Lh=function(t){if(0===t.length)throw this.Da("Document fields must not be empty");if(Sf(this.Sa)&&Nf.test(t))throw this.Da('Document fields cannot begin and end with "__"')},Vf),_f=(Lf.prototype.qh=function(t,e,n,r){return void 0===r&&(r=!1),new Pf({Sa:t,methodName:e,Na:n,path:Zr.X(),xa:!1,Uh:r},this.t,this.serializer,this.ignoreUndefinedProperties)},Lf);function Lf(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.serializer=n||Zu(t)}function Vf(t,e,n,r,i,o){this.settings=t,this.t=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Fh(),this.fieldTransforms=i||[],this.ee=o||[]}function Cf(t,e,n,r,i,o){void 0===o&&(o={});var s=t.qh(o.merge||o.mergeFields?2:0,e,n,i);Gf("Data must be an object, but it was:",s,r);var u,a,r=qf(r,s);if(o.merge)u=new ds(s.ee),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],c=0,l=o.mergeFields;c<l.length;c++){var f=Bf(e,l[c],n);if(!s.contains(f))throw new Lr(_r.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");Xf(h,f)||h.push(f)}u=new ds(h),a=s.fieldTransforms.filter(function(t){return u.ue(t.field)})}else u=null,a=s.fieldTransforms;return new Of(new Ms(r),u,a)}function Uf(t,r,i,e){var o=t.qh(1,r,i);Gf("Data must be an object, but it was:",o,e);var s=[],u=new xs;return oo(e,function(t,e){var n=zf(r,t,i);e instanceof sc&&(e=e.va),t=o.kh(n),e instanceof Uc?s.push(n):null!=(t=xf(e,t))&&(s.push(n),u.set(n,t))}),e=new ds(s),new Rf(u.he(),e,o.fieldTransforms)}function jf(t,e,n,r,i,o){var s=t.qh(1,e,n),u=[Bf(e,r,n)],a=[i];if(o.length%2!=0)throw new Lr(_r.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(Bf(e,o[h])),a.push(o[h+1]);for(var c,l,f,p=[],d=new xs,y=u.length-1;0<=y;--y)Xf(p,u[y])||(c=u[y],(l=a[y])instanceof sc&&(l=l.va),f=s.kh(c),l instanceof Uc?p.push(c):null!=(f=xf(l,f))&&(p.push(c),d.set(c,f)));return i=new ds(p),new Rf(d.he(),i,s.fieldTransforms)}function Mf(t,e,n,r){return void 0===r&&(r=!1),xf(n,t.qh(r?4:3,e))}function xf(s,t){if(s instanceof sc&&(s=s.va),Ff(s))return Gf("Unsupported field value:",t,s),qf(s,t);if(s instanceof Cc)return function(t,e){if(!Sf(e.Sa))throw e.Da(t.ba+"() can only be used with update() and set()");if(!e.path)throw e.Da(t.ba+"() is not currently supported inside arrays");(t=t.Ca(e))&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.ee.push(t.path),s instanceof Array){if(t.settings.xa&&4!==t.Sa)throw t.Da("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=xf(i[r],t.Mh(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof sc&&(t=t.va),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Po(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Kr.fromDate(t);return{timestampValue:_o(e.serializer,n)}}if(t instanceof Kr){var r=new Kr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:_o(e.serializer,r)}}if(t instanceof Xc)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Yc)return{bytesValue:Lo(e.serializer,t.ka)};if(t instanceof Gl){if(n=e.t,!(r=t.firestore.Ba).isEqual(n))throw e.Da("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Co(t.firestore.Ba||e.t,t.lh.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.Da("Unsupported field value: "+Pc(t))}(s,t)}function qf(t,n){var r={};return so(t)?n.path&&0<n.path.length&&n.ee.push(n.path):oo(t,function(t,e){null!=(e=xf(e,n.$h(t)))&&(r[t]=e)}),{mapValue:{fields:r}}}function Ff(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Kr||t instanceof Xc||t instanceof Yc||t instanceof Gl||t instanceof Cc)}function Gf(t,e,n){if(!Ff(n)||"object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))throw"an object"===(n=Pc(n))?e.Da(t+" a custom object"):e.Da(t+" "+n);var r}function Bf(t,e,n){if(e instanceof sc&&(e=e.va),e instanceof Tl)return e.dh;if("string"==typeof e)return zf(t,e);throw Hf("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Wf=new RegExp("[~\\*/\\[\\]]");function zf(e,n,r){if(0<=n.search(Wf))throw Hf("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(Tl.bind.apply(Tl,s([void 0],n.split("."))))).dh}catch(t){throw Hf("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function Hf(t,e,n,r,i){var o=r&&!r.W(),s=void 0!==i,e="Function "+e+"() called with invalid data";return n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Lr(_r.INVALID_ARGUMENT,(e+=". ")+t+n)}function Xf(t,e){return t.some(function(t){return t.isEqual(e)})}var Yf=(Zf.prototype.Gh=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.Kh(),0<this.mutations.length)throw new Lr(_r.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var r,e,n,i,o;return v(this,function(t){switch(t.label){case 0:return e=qo((r=s).serializer)+"/documents",n={documents:u.map(function(t){return jo(r.serializer,t)})},[4,r.Fr("BatchGetDocuments",e,n)];case 1:return n=t.sent(),i=new Map,n.forEach(function(t){var e,n,t=(n=r.serializer,"found"in t?function(t,e){Dr(!!e.found),e.found.name,e.found.updateTime;var n=Mo(t,e.found.name),t=Vo(e.found.updateTime),e=new Ms({mapValue:{fields:e.found.fields}});return new Xs(n,t,e,{})}(n,t):"missing"in t?(e=n,Dr(!!(n=t).missing),Dr(!!n.readTime),e=Mo(e,n.missing),n=Vo(n.readTime),new Ys(e,n)):kr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){Dr(!!(t=i.get(t.toString()))),o.push(t)}),o)]}})})}(this.Wr,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Ys||t instanceof Xs?n.zh(t):kr()}),e)]}})})},Zf.prototype.set=function(t,e){this.write(e.Ph(t,this.re(t))),this.Wh.add(t.toString())},Zf.prototype.update=function(t,e){try{this.write(e.Ph(t,this.Hh(t)))}catch(t){this.jh=t}this.Wh.add(t.toString())},Zf.prototype.delete=function(t){this.write([new Us(t,this.re(t))]),this.Wh.add(t.toString())},Zf.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.Kh(),this.jh)throw this.jh;return e=this.Bh,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=ti.st(e),n.mutations.push(new js(e,n.re(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=qo((e=i).serializer)+"/documents",r={writes:o.map(function(t){return Bo(e.serializer,t)})},[4,e.Nr("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Wr,this.mutations)];case 1:return t.sent(),this.Qh=!0,[2]}})})},Zf.prototype.zh=function(t){var e;if(t instanceof Xs)e=t.version;else{if(!(t instanceof Ys))throw kr();e=$r.min()}var n=this.Bh.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Lr(_r.ABORTED,"Document version changed between two reads.")}else this.Bh.set(t.key.toString(),e)},Zf.prototype.re=function(t){var e=this.Bh.get(t.toString());return!this.Wh.has(t.toString())&&e?gs.updateTime(e):gs.ce()},Zf.prototype.Hh=function(t){var e=this.Bh.get(t.toString());if(this.Wh.has(t.toString())||!e)return gs.exists(!0);if(e.isEqual($r.min()))throw new Lr(_r.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return gs.updateTime(e)},Zf.prototype.write=function(t){this.Kh(),this.mutations=this.mutations.concat(t)},Zf.prototype.Kh=function(){},Zf),Kf=(Jf.prototype.run=function(){this.Jh()},Jf.prototype.Jh=function(){var t=this;this.Ks.vs(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new Yf(this.Wr),(n=this.Xh(e))&&n.then(function(t){r.Ns.Ms(function(){return e.commit().then(function(){r.Os.resolve(t)}).catch(function(t){r.Zh(t)})})}).catch(function(t){r.Zh(t)}),[2]})})})},Jf.prototype.Xh=function(t){try{var e=this.updateFunction(t);return!ui(e)&&e.catch&&e.then?e:(this.Os.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Os.reject(t),null}},Jf.prototype.Zh=function(t){var e=this;0<this.Yh&&this.tl(t)?(--this.Yh,this.Ns.Ms(function(){return e.Jh(),Promise.resolve()})):this.Os.reject(t)},Jf.prototype.tl=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!bi(t))},Jf),$f=(Qf.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.V.promise];case 1:return[2,(t.sent(),{Ns:this.Ns,ta:this.ta,clientId:this.clientId,credentials:this.credentials,Ta:this.user,Pu:100})]}})})},Qf.prototype.el=function(t){var e=this;this.nl=t,this.V.promise.then(function(){return e.nl(e.user)})},Qf.prototype.sl=function(){if(this.Ns.Hs)throw new Lr(_r.FAILED_PRECONDITION,"The client has already been terminated.")},Qf.prototype.terminate=function(){var t=this;this.Ns.Zs();var n=new Yu;return this.Ns.Ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.il?[4,this.il.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.rl?[4,this.rl.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.R(),n.resolve(),[3,6];case 5:return e=ya(t.sent(),"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},Qf);function Qf(t,e,n){var r=this;this.credentials=t,this.Ns=e,this.ta=n,this.user=mr.UNAUTHENTICATED,this.clientId=Br.S(),this.nl=function(){},this.V=new Yu,this.credentials.I(function(t){Ar("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.nl(t)),r.V.resolve()})}function Jf(t,e,n,r){this.Ns=t,this.Wr=e,this.updateFunction=n,this.Os=r,this.Yh=5,this.Ks=new ua(this.Ns,"transaction_retry")}function Zf(t){this.Wr=t,this.Bh=new Map,this.mutations=[],this.Qh=!1,this.jh=null,this.Wh=new Set}function tp(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.rl?[3,2]:(Ar("FirestoreClient","Using default OfflineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return r.Ns.si(),Ar("FirestoreClient","Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return e=t.sent(),[4,i.initialize(e)];case 2:return t.sent(),r.el(function(e){return r.Ns.ti(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Na(i.jr,e)];case 1:return t.sent(),[2]}})})})}),i.persistence.xc(function(){return r.terminate()}),r.rl=i,[2]}})})}(e,new rc)]);case 1:t.sent(),t.label=2;case 2:return[2,e.rl]}})})}function ep(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.il?[3,2]:(Ar("FirestoreClient","Using default OnlineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.Ns.si(),[4,tp(r)];case 1:return e=t.sent(),Ar("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.el(function(t){return r.Ns.ti(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).Ns.si(),Ar("RemoteStore","RemoteStore received new credentials"),n=Qa(e),e.Hr.add(3),[4,Wa(e)];case 1:return t.sent(),n&&e.Zr.set("Unknown"),[4,e.Gr.Va(i)];case 2:return t.sent(),e.Hr.delete(3),[4,Ba(e)];case 3:return t.sent(),[2]}})})}(i.Au,t)})}),r.il=i,[2]}})})}(e,new ic)]);case 1:t.sent(),t.label=2;case 2:return[2,e.il]}})})}function np(t){return tp(t).then(function(t){return t.persistence})}function rp(t){return tp(t).then(function(t){return t.jr})}function ip(t){return ep(t).then(function(t){return t.Au})}function op(t){return ep(t).then(function(t){return t.Pa})}function sp(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,ep(r)];case 1:return e=t.sent(),[2,((n=e.Iu).ho=function(h,c){return y(this,void 0,void 0,function(){var n,o,s,u,a;return v(this,function(t){switch(t.label){case 0:return(e=h).Au.Gr.so=Sh.bind(null,e),e.Au.Gr.Zn=function(t,e){var n=t;if((t=n.bu.get(e))&&t.Tu)return ji().add(t.key);var r=ji();if(!(e=n.pu.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Vu.get(s),r=r.Kt(s.view.ou);return r}.bind(null,e),e.Au.Gr.eo=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Ru.Wo(s,"rejected",u),i=e.bu.get(s),(n=i&&i.key)?(r=(r=new Ti(ti.k)).Tt(n,new Ys(n,$r.min())),i=ji().add(n),i=new Gi($r.min(),new Map,new Di(zr),r,i),[4,Sh(e,i)]):[3,2];case 1:return t.sent(),e.vu=e.vu.remove(n),e.bu.delete(s),Mh(e),[3,4];case 2:return[4,Ra(e.jr,s,!1).then(function(){return Ch(e,s,u)}).catch(Da)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.yu.Rr=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query;if(u=n.queries.get(u)){for(var a=0,h=u.listeners;a<h.length;a++)h[a]._o(s)&&(r=!0);u.co=s}}r&&ch(n)}.bind(null,e.Iu),e.yu.Ou=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,e.Iu),(a=(n=e).Vu.get(c))?(o=a.targetId,n.Ru.jo(o),s=a.view.mu(),[3,4]):[3,1];case 1:return[4,(e=n.jr,r=uu(c),(i=e).persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Ri.Hi(e,r).next(function(t){return t?(n=t,Xu.resolve(n)):i.Ri.$u(e).next(function(t){return n=new mi(r,t,0,e.Bi),i.Ri.Lu(e,n).next(function(){return n})})})}).then(function(t){var e=i.wi.get(t.targetId);return(null===e||0<t.ft.F(e.ft))&&(i.wi=i.wi.Tt(t.targetId,t),i.Ei.set(r,t.targetId)),t}))];case 2:return u=t.sent(),a=n.Ru.jo(u.targetId),o=u.targetId,[4,function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.ku=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.uu(o)).hu?[4,ka(r.jr,i.query,!1).then(function(t){return t=t.documents,i.view.uu(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.on.get(i.targetId),n=i.view.lu(e,r.Fu,n),[2,(jh(r,i.targetId,n.du),n.snapshot)]}})})}(i,t,e,n)},[4,ka(i.jr,o,!0)];case 1:return n=t.sent(),r=new mh(o,n.Ji),e=r.uu(n.documents),n=Bi.ln(s,u&&"Offline"!==i.onlineState),n=r.lu(e,i.Fu,n),jh(i,s,n.du),r=new wh(o,s,r),i.Vu.set(o,r),i.pu.has(s)?i.pu.get(s).push(o):i.pu.set(s,[o]),[2,n.snapshot]}})})}(n,c,o,"current"===a)];case 3:s=t.sent(),n.Fu&&za(n.Au,u),t.label=4;case 4:return[2,s]}var r,i,e})})}.bind(null,e.Pa),n.fo=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Vu.get(o),1<(r=e.pu.get(n.targetId)).length?[2,(e.pu.set(n.targetId,r.filter(function(t){return!hu(t,o)})),void e.Vu.delete(o))]:e.Fu?(e.Ru.Go(n.targetId),e.Ru.Yo(n.targetId)?[3,2]:[4,Ra(e.jr,n.targetId,!1).then(function(){e.Ru.zo(n.targetId),Ha(e.Au,n.targetId),Ch(e,n.targetId)}).catch(Da)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Ch(e,n.targetId),[4,Ra(e.jr,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.Pa),n)]}})})}function up(n,r,i,o,s){var t=new oc({next:function(t){r.Ms(function(){return hh(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Lr(_r.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Lr(_r.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new lh(tu(i.path),t,{includeMetadataChanges:!0,Ro:!0});return ah(n,u)}function ap(e,n,t,r,i){var o=new oc({next:function(t){n.Ms(function(){return hh(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Lr(_r.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new lh(t,o,{includeMetadataChanges:!0,Ro:!0});return ah(e,s)}var hp=(cp.prototype.set=function(t,e,n){return this.hl(),e=rd((t=lp(t,this.ah)).fh,e,n),n=Cf(this.al,"WriteBatch.set",t.lh,e,null!==t.fh,n),this.ul=this.ul.concat(n.Ph(t.lh,gs.ce())),this},cp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return this.hl(),t=lp(t,this.ah),e instanceof sc&&(e=e.va),e="string"==typeof e||e instanceof Tl?jf(this.al,"WriteBatch.update",t.lh,e,n,r):Uf(this.al,"WriteBatch.update",t.lh,e),this.ul=this.ul.concat(e.Ph(t.lh,gs.exists(!0))),this},cp.prototype.delete=function(t){return this.hl(),t=lp(t,this.ah),this.ul=this.ul.concat(new Us(t.lh,gs.ce())),this},cp.prototype.commit=function(){return this.hl(),this.cl=!0,0<this.ul.length?this.ol(this.ul):Promise.resolve()},cp.prototype.hl=function(){if(this.cl)throw new Lr(_r.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},cp);function cp(t,e){this.ah=t,this.ol=e,this.ul=[],this.cl=!1,this.al=Af(t)}function lp(t,e){if(t instanceof sc&&(t=t.va),t.firestore!==e)throw new Lr(_r.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var fp,pp,dp=(Ep.prototype.get=function(t){var e=this,n=lp(t,this.ah),r=new bf(this.ah);return this.ll.Gh([n.lh]).then(function(t){if(!t||1!==t.length)return kr();if((t=t[0])instanceof Ys)return new pl(e.ah,r,n.lh,null,n.fh);if(t instanceof Xs)return new pl(e.ah,r,t.key,t,n.fh);throw kr()})},Ep.prototype.set=function(t,e,n){return e=rd((t=lp(t,this.ah)).fh,e,n),n=Cf(this.al,"Transaction.set",t.lh,e,null!==t.fh,n),this.ll.set(t.lh,n),this},Ep.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return t=lp(t,this.ah),e instanceof sc&&(e=e.va),e="string"==typeof e||e instanceof Tl?jf(this.al,"Transaction.update",t.lh,e,n,r):Uf(this.al,"Transaction.update",t.lh,e),this.ll.update(t.lh,e),this},Ep.prototype.delete=function(t){return t=lp(t,this.ah),this.ll.delete(t.lh),this},n(bp,pp=Ep),bp.prototype.get=function(t){var e=this,n=lp(t,this.ah),r=new Ul(this.ah);return pp.prototype.get.call(this,t).then(function(t){return new kl(e.ah,r,n.lh,t._h,new Gp(!1,!1),n.fh)})},bp),yp="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",vp=(wp.prototype.enableIndexedDbPersistence=function(t,e){throw new Lr(_r.FAILED_PRECONDITION,yp)},wp.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new Lr(_r.FAILED_PRECONDITION,yp)},wp.prototype.clearIndexedDbPersistence=function(t){throw new Lr(_r.FAILED_PRECONDITION,yp)},wp),gp=(n(mp,fp=sc),Object.defineProperty(mp.prototype,"Ba",{get:function(){return this.va.Ba},enumerable:!1,configurable:!0}),mp.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.va.Ha()),t)).merge,this.va.za(t)},mp.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.va.Ha().host&&Or("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},mp.prototype.enableNetwork=function(){return function(r){var t=this;return r.Ns.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,np(r)];case 1:return e=t.sent(),[4,ip(r)];case 2:return n=t.sent(),[2,(e.Fc(!0),(t=n).Hr.delete(0),Ba(t))]}})})})}(Tp(this.va))},mp.prototype.disableNetwork=function(){return function(r){var t=this;return r.Ns.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,np(r)];case 1:return e=t.sent(),[4,ip(r)];case 2:return n=t.sent(),[2,(e.Fc(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Hr.add(0),[4,Wa(e)];case 1:return t.sent(),e.Zr.set("Offline"),[2]}})})}(n))]}})})})}(Tp(this.va))},mp.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&kc("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this._l.enableMultiTabIndexedDbPersistence(this):this._l.enableIndexedDbPersistence(this,n)},mp.prototype.clearPersistence=function(){return this._l.clearIndexedDbPersistence(this)},mp.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this.va._delete()},mp.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new Yu;return n.Ns.Ms(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=_h,[4,op(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(Tp(this.va))},mp.prototype.onSnapshotsInSync=function(t){return function(t,e){var n=this,r=Tp(t),e=ta(e)?e:{next:e},i=new oc(e);return t.wh.Ms(function(){return y(n,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.ao.add(e),e.next()},[4,sp(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})}),function(){i.ga(),t.wh.Ms(function(){return y(n,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.ao.delete(e)},[4,sp(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})})}}(this.va,t)},Object.defineProperty(mp.prototype,"app",{get:function(){if(!this.fl)throw new Lr(_r.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.fl},enumerable:!1,configurable:!0}),mp.prototype.collection=function(t){try{return new Yp(this,gf(this.va,t))}catch(t){throw Lp(t,"collection()","Firestore.collection()")}},mp.prototype.doc=function(t){try{return new Dp(this,mf(this.va,t))}catch(t){throw Lp(t,"doc()","Firestore.doc()")}},mp.prototype.collectionGroup=function(t){try{return new zp(this,function(t,e){if(Oc("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new Lr(_r.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Bl(t,null,new $s(Qr.X(),e))}(this.va,t))}catch(t){throw Lp(t,"collectionGroup()","Firestore.collectionGroup()")}},mp.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new Yu;return n.Ns.Ms(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,ep(n).then(function(t){return t.Wr})];case 1:return e=t.sent(),new Kf(n.Ns,e,r,i).run(),[2]}})})}),i.promise}(Tp(n=this.va),function(t){return t=new dp(n,t),e(new Rp(r,t))})},mp.prototype.batch=function(){var e=this;return Tp(this.va),new kp(new hp(this.va,function(t){return ql(e.va,t)}))},mp);function mp(t,e,n){var r=this;return(r=fp.call(this,e)||this)._l=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof gr||(r.fl=t),r}function wp(){}function bp(t,e){var n=this;return(n=pp.call(this,t,e)||this).ah=t,n}function Ep(t,e){this.ah=t,this.ll=e,this.al=Af(t)}function Tp(t){return t.Eh||Ip(t),t.Eh.sl(),t.Eh}function Ip(t){var e,n,r=t.Ya(),r=(e=t.Ba,n=t.Ma,new vr(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.Eh=new $f(t.Qa,t.wh,r)}var Ap,Np,Op,Rp=(n(_p,Op=sc),_p.prototype.get=function(t){var e=this,t=nd(t);return this.va.get(t).then(function(t){return new Bp(e.ah,t)})},_p.prototype.set=function(t,e,n){return t=nd(t),n?(Rc("Transaction.set",n),this.va.set(t,e,n)):this.va.set(t,e),this},_p.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=nd(t);return 2===arguments.length?this.va.update(o,e):(t=this.va).update.apply(t,s([o,e,n],r)),this},_p.prototype.delete=function(t){return t=nd(t),this.va.delete(t),this},_p),kp=(n(Pp,Np=sc),Pp.prototype.set=function(t,e,n){return t=nd(t),n?(Rc("WriteBatch.set",n),this.va.set(t,e,n)):this.va.set(t,e),this},Pp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=nd(t);return 2===arguments.length?this.va.update(o,e):(t=this.va).update.apply(t,s([o,e,n],r)),this},Pp.prototype.delete=function(t){return t=nd(t),this.va.delete(t),this},Pp.prototype.commit=function(){return this.va.commit()},Pp),Dp=(n(Sp,Ap=sc),Sp.dl=function(t,e,n){if(t.length%2!=0)throw new Lr(_r.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.Y()+" has "+t.length);return new Sp(e,new Gl(e.va,n,new ti(t)))},Sp.uh=function(t,e,n){return new Sp(e,new Gl(e.va,n,t))},Object.defineProperty(Sp.prototype,"id",{get:function(){return this.va.id},enumerable:!1,configurable:!0}),Object.defineProperty(Sp.prototype,"parent",{get:function(){return new Yp(this.firestore,this.va.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(Sp.prototype,"path",{get:function(){return this.va.path},enumerable:!1,configurable:!0}),Sp.prototype.collection=function(t){try{return new Yp(this.firestore,gf(this.va,t))}catch(t){throw Lp(t,"collection()","DocumentReference.collection()")}},Sp.prototype.isEqual=function(t){return t instanceof sc&&(t=t.va),t instanceof Gl&&Tf(this.va,t)},Sp.prototype.set=function(t,e){e=Rc("DocumentReference.set",e);try{return n=this.va,r=t,i=e,o=_c(n.firestore,Il),r=rd(n.fh,r,i),ql(o,Cf(Af(o),"setDoc",n.lh,r,null!==n.fh,i).Ph(n.lh,gs.ce()))}catch(t){throw Lp(t,"setDoc()","DocumentReference.set()")}var n,r,i,o},Sp.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Ml(this.va,t):Ml.apply(void 0,s([this.va,t,e],n))}catch(t){throw Lp(t,"updateDoc()","DocumentReference.update()")}},Sp.prototype.delete=function(){return ql(_c((t=this.va).firestore,Il),[new Us(t.lh,gs.ce())]);var t},Sp.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Vp(t),i=Cp(t,function(t){return new Bp(e.firestore,new kl(e.firestore.va,e.hh,t.lh,t._h,t.metadata,e.va.fh))});return xl(this.va,r,i)},Sp.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){var t=this,n=_c(e.firestore,Il),r=Tp(n),i=new Ul(n),o=new Yu;return n.wh.Ms(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,rp(r)];case 1:return[4,function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.yi.Ge(t,e)}))];case 1:return(r=t.sent())instanceof Xs?s.resolve(r):r instanceof Ys?s.resolve(null):s.reject(new Lr(_r.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=ya(r=t.sent(),"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(t.sent(),e.lh,o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new kl(n,i,e.lh,t,new Gp(t instanceof Xs&&t.ae,!0),e.fh)})}:"server"===(null==t?void 0:t.source)?function(e){var t=this,n=_c(e.firestore,Il),r=Tp(n),i=new Yu;return n.wh.Ms(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,sp(r)];case 1:return[4,up(t.sent(),n.wh,e.lh,{source:"server"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return Fl(n,e,t)})}:function(e){var t=this,n=_c(e.firestore,Il),r=Tp(n),i=new Yu;return n.wh.Ms(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,sp(r)];case 1:return[4,up(t.sent(),n.wh,e.lh,{source:"default"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return Fl(n,e,t)})})(this.va).then(function(t){return new Bp(e.firestore,new kl(e.firestore.va,e.hh,t.lh,t._h,t.metadata,e.va.fh))})},Sp.prototype.withConverter=function(t){return new Sp(this.firestore,this.va.withConverter(t))},Sp);function Sp(t,e){var n=this;return(n=Ap.call(this,e)||this).firestore=t,n.hh=new fl(t),n}function Pp(){return null!==Np&&Np.apply(this,arguments)||this}function _p(t,e){var n=this;return(n=Op.call(this,e)||this).ah=t,n}function Lp(t,e,n){return t.message=t.message.replace(e,n),t}function Vp(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!ta(r))return r}return{}}function Cp(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=ta(t[0])?t[0]:ta(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var Up,jp,Mp,xp,qp,Fp,Gp=(ed.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},ed),Bp=(n(td,Fp=sc),Object.defineProperty(td.prototype,"ref",{get:function(){return new Dp(this.ah,this.va.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(td.prototype,"id",{get:function(){return this.va.id},enumerable:!1,configurable:!0}),Object.defineProperty(td.prototype,"metadata",{get:function(){return this.va.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(td.prototype,"exists",{get:function(){return this.va.exists()},enumerable:!1,configurable:!0}),td.prototype.data=function(t){return this.va.data(t)},td.prototype.get=function(t,e){return this.va.get(t,e)},td.prototype.isEqual=function(t){return Vl(this.va,t.va)},td),Wp=(n(Zp,qp=Bp),Zp.prototype.data=function(t){return this.va.data(t)},Zp),zp=(n(Jp,xp=sc),Jp.prototype.where=function(t,e,n){try{return new Jp(this.firestore,Hl(this.va,(r=n,i=e,o=bl("where",t),new Jl(o,i,r))))}catch(t){throw Lp(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},Jp.prototype.orderBy=function(n,t){try{return new Jp(this.firestore,Hl(this.va,function(t){void 0===t&&(t="asc");var e=t,t=bl("orderBy",n);return new Zl(t,e)}(t)))}catch(n){throw Lp(n,/(orderBy|where)\(\)/,"Query.$1()")}},Jp.prototype.limit=function(t){try{return new Jp(this.firestore,Hl(this.va,(Lc("limit",e=t),new tf("limit",e,"F"))))}catch(t){throw Lp(t,"limit()","Query.limit()")}var e},Jp.prototype.limitToLast=function(t){try{return new Jp(this.firestore,Hl(this.va,(Lc("limitToLast",e=t),new tf("limitToLast",e,"L"))))}catch(t){throw Lp(t,"limitToLast()","Query.limitToLast()")}var e},Jp.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Jp(this.firestore,Hl(this.va,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ef("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw Lp(t,"startAt()","Query.startAt()")}},Jp.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Jp(this.firestore,Hl(this.va,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ef("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw Lp(t,"startAfter()","Query.startAfter()")}},Jp.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Jp(this.firestore,Hl(this.va,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new nf("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw Lp(t,"endBefore()","Query.endBefore()")}},Jp.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Jp(this.firestore,Hl(this.va,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new nf("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw Lp(t,"endAt()","Query.endAt()")}},Jp.prototype.isEqual=function(t){return If(this.va,t.va)},Jp.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){var t=this,n=_c(e.firestore,Il),r=Tp(n),i=new Ul(n),o=new Yu;return n.wh.Ms(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,rp(r)];case 1:return[4,function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,ka(r,i,!0)];case 1:return n=t.sent(),e=new mh(i,n.Ji),n=e.uu(n.documents),n=e.lu(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=ya(n=t.sent(),"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(t.sent(),e.Rh,o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new Sl(n,i,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){var t=this,n=_c(e.firestore,Il),r=Tp(n),i=new Ul(n),o=new Yu;return n.wh.Ms(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,sp(r)];case 1:return[4,ap(t.sent(),n.wh,e.Rh,{source:"server"},o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new Sl(n,i,e,t)})}:function(e){var t=this,n=_c(e.firestore,Il),r=Tp(n),i=new Ul(n);pf(e.Rh);var o=new Yu;return n.wh.Ms(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,sp(r)];case 1:return[4,ap(t.sent(),n.wh,e.Rh,{source:"default"},o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new Sl(n,i,e,t)})})(this.va).then(function(t){return new Xp(e.firestore,t)})},Jp.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Vp(t),i=Cp(t,function(t){return new Xp(e.firestore,t)});return xl(this.va,r,i)},Jp.prototype.withConverter=function(t){return new Jp(this.firestore,this.va.withConverter(t))},Jp),Hp=(n(Qp,Mp=sc),Object.defineProperty(Qp.prototype,"type",{get:function(){return this.va.type},enumerable:!1,configurable:!0}),Object.defineProperty(Qp.prototype,"doc",{get:function(){return new Wp(this.ah,this.va.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(Qp.prototype,"oldIndex",{get:function(){return this.va.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(Qp.prototype,"newIndex",{get:function(){return this.va.newIndex},enumerable:!1,configurable:!0}),Qp),Xp=(n($p,jp=sc),Object.defineProperty($p.prototype,"query",{get:function(){return new zp(this.ah,this.va.query)},enumerable:!1,configurable:!0}),Object.defineProperty($p.prototype,"metadata",{get:function(){return this.va.metadata},enumerable:!1,configurable:!0}),Object.defineProperty($p.prototype,"size",{get:function(){return this.va.size},enumerable:!1,configurable:!0}),Object.defineProperty($p.prototype,"empty",{get:function(){return this.va.empty},enumerable:!1,configurable:!0}),Object.defineProperty($p.prototype,"docs",{get:function(){var e=this;return this.va.docs.map(function(t){return new Wp(e.ah,t)})},enumerable:!1,configurable:!0}),$p.prototype.docChanges=function(t){var e=this;return this.va.docChanges(t).map(function(t){return new Hp(e.ah,t)})},$p.prototype.forEach=function(e,n){var r=this;this.va.forEach(function(t){e.call(n,new Wp(r.ah,t))})},$p.prototype.isEqual=function(t){return Vl(this.va,t.va)},$p),Yp=(n(Kp,Up=zp),Object.defineProperty(Kp.prototype,"id",{get:function(){return this.va.id},enumerable:!1,configurable:!0}),Object.defineProperty(Kp.prototype,"path",{get:function(){return this.va.path},enumerable:!1,configurable:!0}),Object.defineProperty(Kp.prototype,"parent",{get:function(){var t=this.va.parent;return t?new Dp(this.firestore,t):null},enumerable:!1,configurable:!0}),Kp.prototype.doc=function(t){try{return new Dp(this.firestore,void 0===t?mf(this.va):mf(this.va,t))}catch(t){throw Lp(t,"doc()","CollectionReference.doc()")}},Kp.prototype.add=function(t){var e,n=this,r=this.va,i=t;return t=_c(r.firestore,Il),e=mf(r),i=rd(r.fh,i),ql(t,Cf(Af(r.firestore),"addDoc",e.lh,i,null!==r.fh,{}).Ph(e.lh,gs.exists(!1))).then(function(){return e}).then(function(t){return new Dp(n.firestore,t)})},Kp.prototype.isEqual=function(t){return Tf(this.va,t.va)},Kp.prototype.withConverter=function(t){return new Kp(this.firestore,this.va.withConverter(t))},Kp);function Kp(t,e){var n=this;return(n=Up.call(this,t,e)||this).firestore=t,n.va=e,n}function $p(t,e){var n=this;return(n=jp.call(this,e)||this).ah=t,n}function Qp(t,e){var n=this;return(n=Mp.call(this,e)||this).ah=t,n}function Jp(t,e){var n=this;return(n=xp.call(this,e)||this).firestore=t,n}function Zp(){return null!==qp&&qp.apply(this,arguments)||this}function td(t,e){var n=this;return(n=Fp.call(this,e)||this).ah=t,n}function ed(t,e){this.hasPendingWrites=t,this.fromCache=e}function nd(t){return t instanceof sc&&(t=t.va),_c(t,Gl)}function rd(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var id,od,l=(n(ud,od=sc),ud.documentId=function(){return new ud(Zr.nt().Y())},ud.prototype.isEqual=function(t){return t instanceof sc&&(t=t.va),t instanceof Tl&&this.va.dh.isEqual(t.dh)},ud),me=(n(sd,id=sc),sd.serverTimestamp=function(){var t=new Bc("serverTimestamp");return t.ba="FieldValue.serverTimestamp",new sd(t)},sd.delete=function(){var t=new Uc("deleteField");return t.ba="FieldValue.delete",new sd(t)},sd.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Wc("arrayUnion",t)}.apply(void 0,t);return n.ba="FieldValue.arrayUnion",new sd(n)},sd.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new zc("arrayRemove",t)}.apply(void 0,t);return n.ba="FieldValue.arrayRemove",new sd(n)},sd.increment=function(t){return(t=new Hc("increment",t)).ba="FieldValue.increment",new sd(t)},sd.prototype.isEqual=function(t){return this.va.isEqual(t.va)},sd),me={Firestore:gp,GeoPoint:Xc,Timestamp:Kr,Blob:ll,Transaction:Rp,WriteBatch:kp,DocumentReference:Dp,DocumentSnapshot:Bp,Query:zp,QueryDocumentSnapshot:Wp,QuerySnapshot:Xp,CollectionReference:Yp,FieldPath:l,FieldValue:me,setLogLevel:function(t){Tr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};function sd(){return null!==id&&id.apply(this,arguments)||this}function ud(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return od.call(this,new(Tl.bind.apply(Tl,s([void 0],t))))||this}(e=e.default).INTERNAL.registerComponent(new ge("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new gp(e,new Il(e,t),new vp);var e},"PUBLIC").setServiceProps(Object.assign({},me))),e.registerVersion("@firebase/firestore","2.0.3-202010180421")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});