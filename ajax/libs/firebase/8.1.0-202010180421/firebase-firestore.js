!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(rg){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var l,e=t(rg),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function u(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(Ie=l=l||{})[Ie.DEBUG=0]="DEBUG",Ie[Ie.VERBOSE=1]="VERBOSE",Ie[Ie.INFO=2]="INFO",Ie[Ie.WARN=3]="WARN",Ie[Ie.ERROR=4]="ERROR",Ie[Ie.SILENT=5]="SILENT";function i(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,u(["["+i+"]  "+t.name+":"],n))}}var o={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},a=l.INFO,c=((Ee={})[l.DEBUG]="log",Ee[l.VERBOSE]="log",Ee[l.INFO]="info",Ee[l.WARN]="warn",Ee[l.ERROR]="error",Ee),h=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.DEBUG],t)),this._logHandler.apply(this,u([this,l.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.VERBOSE],t)),this._logHandler.apply(this,u([this,l.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.INFO],t)),this._logHandler.apply(this,u([this,l.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.WARN],t)),this._logHandler.apply(this,u([this,l.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.ERROR],t)),this._logHandler.apply(this,u([this,l.ERROR],t))},f);function f(t){this.name=t,this._logLevel=a,this._logHandler=i,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e,n){e=d.call(this,e)||this;return e.code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(_.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},_);function _(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,E=function(t,e){return(E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function T(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,A="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},O={},S=A||self;function D(){}function x(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function k(t){var e=x(t);return"array"==e||"object"==e&&"number"==typeof t.length}function P(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var R="closure_uid_"+(1e9*Math.random()>>>0),C=0;function L(t,e,n){return t.call.apply(t.bind,arguments)}function V(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function M(t,e,n){return(M=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?L:V).apply(null,arguments)}function U(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var j=Date.now;function q(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t}function F(){this.j=this.j,this.i=this.i}F.prototype.j=!1,F.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,R)&&t[R]||(t[R]=++C))},F.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var B=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},z=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function G(){return Array.prototype.concat.apply([],arguments)}function K(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function W(t){return/^[\s\xa0]*$/.test(t)}var H,Q=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Y(t,e){return-1!=t.indexOf(e)}function X(t,e){return t<e?-1:e<t?1:0}t:{var J=S.navigator;if(J){J=J.userAgent;if(J){H=J;break t}}H=""}function $(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Z(t){var e,n={};for(e in t)n[e]=t[e];return n}var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<tt.length;i++)e=tt[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function nt(t){return nt[" "](t),t}nt[" "]=D;var rt,it=Y(H,"Opera"),ot=Y(H,"Trident")||Y(H,"MSIE"),st=Y(H,"Edge"),ut=st||ot,at=Y(H,"Gecko")&&!(Y(H.toLowerCase(),"webkit")&&!Y(H,"Edge"))&&!(Y(H,"Trident")||Y(H,"MSIE"))&&!Y(H,"Edge"),ct=Y(H.toLowerCase(),"webkit")&&!Y(H,"Edge");function ht(){var t=S.document;return t?t.documentMode:void 0}t:{var ft="",lt=(lt=H,at?/rv:([^\);]+)(\)|;)/.exec(lt):st?/Edge\/([\d\.]+)/.exec(lt):ot?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(lt):ct?/WebKit\/(\S+)/.exec(lt):it?/(?:Version)[ \/]?(\S+)/.exec(lt):void 0);if(lt&&(ft=lt?lt[1]:""),ot){lt=ht();if(null!=lt&&lt>parseFloat(ft)){rt=String(lt);break t}}rt=ft}var pt={};function dt(u){return t=u,e=function(){for(var t=0,e=Q(String(rt)).split("."),n=Q(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=X(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||X(0==o[2].length,0==s[2].length)||X(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=pt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var yt=S.document&&ot?ht()||(parseInt(rt,10)||void 0):void 0,vt=!ot||9<=Number(yt),gt=ot&&!dt("9"),mt=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",D,e),S.removeEventListener("test",D,e)}catch(t){}return t}();function wt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function bt(t,e){if(wt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(at){t:{try{nt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:_t[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}wt.prototype.b=function(){this.defaultPrevented=!0},q(bt,wt);var _t={2:"touch",3:"pen",4:"mouse"};bt.prototype.b=function(){bt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,gt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var It="closure_listenable_"+(1e6*Math.random()|0),Et=0;function Tt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Et,this.Y=this.Z=!1}function Nt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function At(t){this.src=t,this.a={},this.b=0}function Ot(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=B(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Nt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function St(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}At.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=St(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Tt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Dt="closure_lm_"+(1e6*Math.random()|0),xt={};function kt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=jt(r);return e&&e[It]?e.wa(n,r,P(i)?!!i.capture:!!i,o):Pt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)kt(t,e[o],n,r,i);return null}return n=jt(n),t&&t[It]?t.va(e,n,P(r)?!!r.capture:!!r,i):Pt(t,e,n,!1,r,i)}function Pt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=P(i)?!!i.capture:!!i;if(s&&!vt)return null;var u,a,c=Mt(t);if(c||(t[Dt]=c=new At(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Vt,r=a=vt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)mt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ct(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Rt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[It]?Ot(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ct(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Mt(e))?(Ot(n,t),0==n.b&&(n.src=null,e[Dt]=null)):Nt(t)))}function Ct(t){return t in xt?xt[t]:xt[t]="on"+t}function Lt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Rt(t),n.call(r,e)}function Vt(t,e){if(t.Y)return!0;if(vt)return Lt(t,new bt(e,this));if(!e)t:{e=["window","event"];for(var n=S,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Lt(t,e=new bt(e,this))}function Mt(t){return(t=t[Dt])instanceof At?t:null}var Ut="__closure_events_fn_"+(1e9*Math.random()>>>0);function jt(e){return"function"==x(e)?e:(e[Ut]||(e[Ut]=function(t){return e.handleEvent(t)}),e[Ut])}function qt(){F.call(this),this.c=new At(this),(this.J=this).C=null}function Ft(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new wt(e,t):e instanceof wt?e.target=e.target||t:(s=e,et(e=new wt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Bt(o,r,!0,e)&&s;if(s=Bt(o=e.a=t,r,!0,e)&&s,s=Bt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Bt(o=e.a=n[i],r,!1,e)&&s}function Bt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Ot(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}q(qt,F),qt.prototype[It]=!0,(N=qt.prototype).addEventListener=function(t,e,n,r){kt(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=P(i)?!!i.capture:!!i,r=jt(r),e&&e[It]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=St(s=e.a[n],r,i,o))&&(Nt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Mt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=St(n,r,i,o)),(r=-1<e?n[e]:null)&&Rt(r))}(this,t,e,n,r)},N.G=function(){if(qt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Nt(n[r]);delete e.a[t],e.b--}}this.C=null},N.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},N.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var zt=S.JSON.stringify;function Gt(){this.b=this.a=null}var Kt,Wt=(Ht.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Ht(function(){return new Qt},function(t){t.reset()},100));function Ht(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Qt(){this.next=this.b=this.a=null}function Yt(t,e){var n;Kt||(n=S.Promise.resolve(void 0),Kt=function(){n.then($t)}),Xt||(Kt(),Xt=!0),Jt.add(t,e)}Gt.prototype.add=function(t,e){var n=Wt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Qt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Xt=!(Qt.prototype.reset=function(){this.next=this.b=this.a=null}),Jt=new Gt;function $t(){for(var t,e;n=e=void 0,n=null,(e=Jt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){S.setTimeout(function(){throw t},0)}(t)}var n=Wt;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Xt=!1}function Zt(t,e){qt.call(this),this.b=t||1,this.a=e||S,this.f=M(this.Xa,this),this.g=j()}function te(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function ee(t,e,n){if("function"==x(t))n&&(t=M(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=M(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}q(Zt,qt),(N=Zt.prototype).aa=!1,N.M=null,N.Xa=function(){var t;this.aa&&(0<(t=j()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Ft(this,"tick"),this.aa&&(te(this),this.start())))},N.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=j())},N.G=function(){Zt.X.G.call(this),te(this),delete this.a};var ne,re,ie,oe=(E(re=ue,ie=ne=F),re.prototype=null===ie?Object.create(ie):(se.prototype=ie.prototype,new se),ue.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=ee(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ue.prototype.G=function(){ne.prototype.G.call(this),this.a&&(S.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ue);function se(){this.constructor=re}function ue(t,e,n){var r=ne.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function ae(t){F.call(this),this.b=t,this.a={}}q(ae,F);var ce=[];function he(t,e,n,r){Array.isArray(n)||(n&&(ce[0]=n.toString()),n=ce);for(var i=0;i<n.length;i++){var o=kt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function fe(t){$(t.a,function(t,e){this.a.hasOwnProperty(e)&&Rt(t)},t),t.a={}}function le(){this.a=!0}function pe(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return zt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ae.prototype.G=function(){ae.X.G.call(this),fe(this)},ae.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},le.prototype.info=function(){};var de=null;function ye(){return de=de||new qt}function ve(t){wt.call(this,"serverreachability",t)}function ge(t){var e=ye();Ft(e,new ve(e))}function me(t){wt.call(this,"statevent",t)}function we(t){var e=ye();Ft(e,new me(e))}function be(t){wt.call(this,"timingevent",t)}function _e(t,e){if("function"!=x(t))throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}q(ve,wt),q(me,wt),q(be,wt);var Ie={NO_ERROR:0,Ya:1,fb:2,eb:3,ab:4,cb:5,gb:6,Da:7,TIMEOUT:8,jb:9},Ee={$a:"complete",nb:"success",Ea:"error",Da:"abort",lb:"ready",mb:"readystatechange",TIMEOUT:"timeout",hb:"incrementaldata",kb:"progress",bb:"downloadprogress",ob:"uploadprogress"};function Te(){}function Ne(t){var e;return(e=t.a)||(e=t.a={}),e}function Ae(){}Te.prototype.a=null;var Oe,A={OPEN:"a",Za:"b",Ea:"c",ib:"d"};function Se(){wt.call(this,"d")}function De(){wt.call(this,"c")}function xe(){}function ke(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ae(this),this.P=Pe,t=ut?125:void 0,this.R=new Zt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}q(Se,wt),q(De,wt),q(xe,Te),Oe=new xe;var Pe=45e3,Re={},Ce={};function Le(t,e,n){t.H=1,t.i=nn(Xe(e)),t.j=n,t.I=!0,Ve(t,null)}function Ve(t,e){t.u=j(),Ue(t),t.l=Xe(t.i);var s,u,a,c,h,f,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),vn(n.b,"t",r),t.D=0,t.a=cr(t.g,t.g.C?e:null),0<t.O&&(t.F=new oe(M(t.Ca,t,t.a),t.O)),he(t.J,t.a,"readystatechange",t.Va),e=t.B?Z(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ge(1),s=t.c,u=t.m,a=t.l,c=t.f,h=t.S,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Me(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Ce:(i=Number(u.substring(i,o)),isNaN(i)?Re:(o+=1)+i>u.length?Ce:(u=u.substr(o,i),r.D=o+i,u)));if(u==Ce){4==e&&(t.h=4,we(14),s=!1),pe(t.c,t.f,null,"[Incomplete Response]");break}if(u==Re){t.h=4,we(15),pe(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}pe(t.c,t.f,u,null),ze(t,u)}4==e&&0==n.length&&(t.h=1,we(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),er(e),e.F=!0,we(11))):(pe(t.c,t.f,n,"[Invalid Chunked Response]"),Be(t),Fe(t))}function Ue(t){t.T=j()+t.P,je(t,t.P)}function je(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=_e(M(t.Ta,t),e)}function qe(t){t.o&&(S.clearTimeout(t.o),t.o=null)}function Fe(t){0==t.g.v||t.A||ir(t.g,t)}function Be(t){qe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,te(t.R),fe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function ze(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||En(u.b,t)))if(u.I=t.N,!t.C&&En(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;rr(u),Wn(u)}tr(u),we(18)}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=_e(M(u.Qa,u),6e3));if(In(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else sr(u,11)}else if(!t.C&&u.a!=t||rr(u),!W(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++){c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(Y(r,"spdy")||Y(r,"quic")||Y(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(Tn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,en(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=j()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ar(n,n.C?n.ga:null,n.fa),i.C?(Nn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(qe(o),Ue(o)),n.a=i):Zn(n),0<u.g.length&&Yn(u)):"stop"!=c[0]&&"close"!=c[0]||sr(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?sr(u,7):Kn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0)}ge(4)}catch(t){}}function Ge(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(k(t)||"string"==typeof t)z(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(k(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(k(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Ke(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ke)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function We(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];He(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)He(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function He(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=ke.prototype).setTimeout=function(t){this.P=t},N.Va=function(t){t=t.target;var e=this.F;e&&3==Fn(t)?e.f():this.Ca(t)},N.Ca=function(t){try{if(t==this.a)t:{var e=Fn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!ut&&!this.a.$())){this.A||4!=e||7==n||ge(8==n||r<=0?3:2),qe(this);var i=this.a.W();this.N=i;n=this.a.$();if(this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.S,f=e,l=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+f+" "+l}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!W(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,we(12),Be(this),Fe(this);break t}pe(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,ze(this,s)}this.I?(Me(this,e,n),ut&&this.b&&3==e&&(he(this.J,this.R,"tick",this.Ua),this.R.start())):(pe(this.c,this.f,n,null),ze(this,n)),4==e&&Be(this),this.b&&!this.A&&(4==e?ir(this.g,this):(this.b=!1,Ue(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,we(12)):(this.h=0,we(13)),Be(this),Fe(this)}}}catch(t){}var u,a,c,h,f,l},N.Ua=function(){var t,e;this.a&&(t=Fn(this.a),e=this.a.$(),this.D<e.length&&(qe(this),Me(this,t,e),this.b&&4!=t&&Ue(this)))},N.cancel=function(){this.A=!0,Be(this)},N.Ta=function(){this.o=null;var t,e,n=j();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ge(3),we(17)),Be(this),this.h=2,Fe(this)):je(this,this.T-n)},(N=Ke.prototype).K=function(){We(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.L=function(){return We(this),this.a.concat()},N.get=function(t,e){return He(this.b,t)?this.b[t]:e},N.set=function(t,e){He(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Qe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ye(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ye?(this.a=void 0!==e?e:t.a,Je(this,t.f),this.j=t.j,$e(this,t.c),Ze(this,t.h),this.g=t.g,e=t.b,(n=new ln).c=e.c,e.a&&(n.a=new Ke(e.a),n.b=e.b),tn(this,n),this.i=t.i):t&&(n=String(t).match(Qe))?(this.a=!!e,Je(this,n[1]||"",!0),this.j=rn(n[2]||""),$e(this,n[3]||"",!0),Ze(this,n[4]),this.g=rn(n[5]||"",!0),tn(this,n[6]||"",!0),this.i=rn(n[7]||"")):(this.a=!!e,this.b=new ln(null,this.a))}function Xe(t){return new Ye(t)}function Je(t,e,n){t.f=n?rn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function $e(t,e,n){t.c=n?rn(e,!0):e}function Ze(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function tn(t,e,n){var r,i;e instanceof ln?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(pn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(dn(this,e),vn(this,n,t))},r)),r.f=i):(n||(e=on(e,hn)),t.b=new ln(e,t.a))}function en(t,e,n){t.b.set(e,n)}function nn(t){return en(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^j()).toString(36)),t}function rn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function on(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,sn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function sn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ye.prototype.toString=function(){var t=[],e=this.f;e&&t.push(on(e,un,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(on(e,un,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(on(n,"/"==n.charAt(0)?cn:an,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",on(n,fn)),t.join("")};var un=/[#\/\?@]/g,an=/[#\?:]/g,cn=/[#\?]/g,hn=/[#\?@]/g,fn=/#/g;function ln(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function pn(n){n.a||(n.a=new Ke,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function dn(t,e){pn(t),e=gn(t,e),He(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,He((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&We(t)))}function yn(t,e){return pn(t),e=gn(t,e),He(t.a.b,e)}function vn(t,e,n){dn(t,e),0<n.length&&(t.c=null,t.a.set(gn(t,e),K(n)),t.b+=n.length)}function gn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function mn(t,e){this.b=t,this.a=e}function wn(t){this.g=t||bn,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ia&&S.ia.ya&&S.ia.ya()&&S.ia.ya().pb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(N=ln.prototype).add=function(t,e){pn(this),this.c=null,t=gn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(n,r){pn(this),this.a.forEach(function(t,e){z(t,function(t){n.call(r,t,e,this)},this)},this)},N.L=function(){pn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},N.K=function(t){pn(this);var e=[];if("string"==typeof t)yn(this,t)&&(e=G(e,this.a.get(gn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=G(e,t[n])}return e},N.set=function(t,e){return pn(this),this.c=null,yn(this,t=gn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var bn=10;function _n(t){return t.b||t.a&&t.a.size>=t.f}function In(t){return t.b?1:t.a?t.a.size:0}function En(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Tn(t,e){t.a?t.a.add(e):t.b=e}function Nn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function An(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return K(t.c);var r=t.c;try{for(var i=T(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function On(){}function Sn(){this.a=new On}function Dn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}wn.prototype.cancel=function(){var e,t;if(this.c=An(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=T(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},On.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},On.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var xn=S.JSON.parse;function kn(t){qt.call(this),this.headers=new Ke,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Pn,this.D=this.F=!1}q(kn,qt);var Pn="",Rn=/^https?$/i,Cn=["POST","PUT"];function Ln(t){return"content-type"==t.toLowerCase()}function Vn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Mn(t),jn(t)}function Mn(t){t.u||(t.u=!0,Ft(t,"complete"),Ft(t,"error"))}function Un(t){if(t.b&&void 0!==O&&(!t.s[1]||4!=Fn(t)||2!=t.W()))if(t.l&&4==Fn(t))ee(t.za,0,t);else if(Ft(t,"readystatechange"),4==Fn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Qe)[1]||null)&&S.self&&S.self.location&&(i=(r=S.self.location.protocol).substr(0,r.length-1)),n=!Rn.test(i?i.toLowerCase():"")),e=n),e)Ft(t,"complete"),Ft(t,"success");else{t.h=6;try{var u=2<Fn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.W()+"]",Mn(t)}}finally{jn(t)}}}function jn(t,e){if(t.a){qn(t);var n=t.a,r=t.s[0]?D:null;t.a=null,t.s=null,e||Ft(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function qn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function Fn(t){return t.a?t.a.readyState:0}function Bn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",$(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):en(t,e,n))}function zn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Gn(t){this.pa=0,this.g=[],this.c=new le,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Ma=this.R=0,this.Ja=zn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Fa=zn("baseRetryDelayMs",5e3,t),this.Pa=zn("retryDelaySeedMs",1e4,t),this.Ka=zn("forwardChannelMaxRetries",2,t),this.ma=zn("forwardChannelRequestTimeoutMs",2e4,t),this.La=t&&t.h||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new wn(t&&t.concurrentRequestLimit),this.ka=new Sn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.g&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ia=t&&t.f||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Kn(t){var e,n;Hn(t),3==t.v&&(e=t.R++,en(n=Xe(t.B),"SID",t.J),en(n,"RID",e),en(n,"TYPE","terminate"),Jn(t,n),(e=new ke(t,t.c,e,void 0)).H=2,e.i=nn(Xe(n)),n=!1,S.navigator&&S.navigator.sendBeacon&&(n=S.navigator.sendBeacon(e.i.toString(),"")),!n&&S.Image&&((new Image).src=e.i,n=!0),n||(e.a=cr(e.g,null),e.a.ba(e.i)),e.u=j(),Ue(e)),ur(t)}function Wn(t){t.a&&(er(t),t.a.cancel(),t.a=null)}function Hn(t){Wn(t),t.j&&(S.clearTimeout(t.j),t.j=null),rr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&S.clearTimeout(t.h),t.h=null)}function Qn(t,e){t.g.push(new mn(t.Ma++,e)),3==t.v&&Yn(t)}function Yn(t){_n(t.b)||t.h||(t.h=!0,Yt(t.Ba,t),t.u=0)}function Xn(t,e){var n=e?e.f:t.R++,r=Xe(t.B);en(r,"SID",t.J),en(r,"RID",n),en(r,"AID",t.P),Jn(t,r),t.i&&t.l&&Bn(r,t.i,t.l),n=new ke(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=$n(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Tn(t.b,n),Le(n,r,e)}function Jn(t,n){t.f&&Ge({},function(t,e){en(n,e,t)})}function $n(t,e,n){n=Math.min(t.g.length,n);var r=t.f?M(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{Ge(t,function(t,e){var n=t;P(t)&&(n=zt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Zn(t){t.a||t.j||(t.T=1,Yt(t.Aa,t),t.o=0)}function tr(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=_e(M(t.Aa,t),or(t,t.o)),t.o++,1)}function er(t){null!=t.s&&(S.clearTimeout(t.s),t.s=null)}function nr(t){t.a=new ke(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Xe(t.la);en(e,"RID","rpc"),en(e,"SID",t.J),en(e,"CI",t.H?"0":"1"),en(e,"AID",t.P),Jn(t,e),en(e,"TYPE","xmlhttp"),t.i&&t.l&&Bn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=nn(Xe(e)),n.j=null,n.I=!0,Ve(n,t)}function rr(t){null!=t.m&&(S.clearTimeout(t.m),t.m=null)}function ir(t,e){var n,r=null;if(t.a==e){rr(t),er(t),t.a=null;var i=2}else{if(!En(t.b,e))return;r=e.s,Nn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=j()-e.u,n=t.u,Ft(i=ye(),new be(i)),Yn(t)):Zn(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(In(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ja?0:t.Ka)))return t.h=_e(M(t.Ba,t,e),or(t,t.u)),t.u++,1}}(t,e)||2==i&&tr(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:sr(t,5);break;case 4:sr(t,10);break;case 3:sr(t,6);break;default:sr(t,2)}}function or(t,e){var n=t.Fa+Math.floor(Math.random()*t.Pa);return t.f||(n*=2),n*e}function sr(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=M(t.Wa,t),r||(r=new Ye("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||Je(r,"https"),nn(r)),n=r.toString(),r=o,o=new le,S.Image?((i=new Image).onload=U(Dn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=U(Dn,o,i,"TestLoadImage: error",!1,r),i.onabort=U(Dn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=U(Dn,o,i,"TestLoadImage: timeout",!1,r),S.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):we(2),t.v=0,t.f&&t.f.ra(e),ur(t),Hn(t)}function ur(t){t.v=0,t.I=-1,t.f&&(0==An(t.b).length&&0==t.g.length||(t.b.c.length=0,K(t.g),t.g.length=0),t.f.qa())}function ar(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Ye?Xe(s):new Ye(s,void 0);return""!=a.c?(e&&$e(a,e+"."+a.c),Ze(a,a.h)):(u=S.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Ye(null,void 0),r&&Je(u,r),i&&$e(u,i),o&&Ze(u,o),s&&(u.g=s),a=u),t.V&&$(t.V,function(t,e){en(a,e,t)}),e=t.A,n=t.na,e&&n&&en(a,e,n),en(a,"VER",t.ha),Jn(t,a),a}function cr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new kn(t.La)).F=t.C,e}function hr(){}function fr(){if(ot&&!(10<=Number(yt)))throw Error("Environmental error: no available transport.")}function lr(t,e){qt.call(this),this.a=new Gn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!W(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!W(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new yr(this)}function pr(t){Se.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function dr(){De.call(this),this.status=1}function yr(t){this.a=t}(N=kn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ne(this.H):Ne(Oe),this.a.onreadystatechange=M(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Vn(this,t)}t=n||"";var i,o=new Ke(this.headers);r&&Ge(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Ln,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=S.FormData&&t instanceof S.FormData,0<=B(Cn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{qn(this),0<this.o&&((this.D=(i=this.a,ot&&dt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=M(this.xa,this)):this.m=ee(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Vn(this,t)}},N.xa=function(){void 0!==O&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Ft(this,"timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Ft(this,"complete"),Ft(this,"abort"),jn(this))},N.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),jn(this,!0)),kn.X.G.call(this)},N.za=function(){this.j||(this.A||this.l||this.g?Un(this):this.Sa())},N.Sa=function(){Un(this)},N.W=function(){try{return 2<Fn(this)?this.a.status:-1}catch(t){return-1}},N.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},N.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),xn(e)}},N.ua=function(){return this.h},N.Oa=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=Gn.prototype).ha=8,N.v=1,N.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new ke(this,this.c,t,void 0),r=this.l;if(this.O&&(r?et(r=Z(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=$n(this,n,e),en(i=Xe(this.B),"RID",t),en(i,"CVER",22),this.A&&en(i,"X-HTTP-Session-Id",this.A),Jn(this,i),this.i&&r&&Bn(i,this.i,r),Tn(this.b,n),this.Ga&&en(i,"TYPE","init"),this.da?(en(i,"$req",e),en(i,"SID","null"),n.U=!0,Le(n,i,null)):Le(n,i,e),this.v=2}}else 3==this.v&&(t?Xn(this,t):0==this.g.length||_n(this.b)||Xn(this))},N.Aa=function(){var t;this.j=null,nr(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=_e(M(this.Ra,this),t))},N.Ra=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,we(10),Wn(this),nr(this))},N.Qa=function(){null!=this.m&&(this.m=null,Wn(this),tr(this),we(19))},N.Wa=function(t){t?(this.c.info("Successfully pinged google.com"),we(2)):(this.c.info("Failed to ping google.com"),we(1))},(N=hr.prototype).ta=function(){},N.sa=function(){},N.ra=function(){},N.qa=function(){},N.Ha=function(){},fr.prototype.a=function(t,e){return new lr(t,e)},q(lr,qt),lr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;we(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=ar(t,null,t.fa),Yn(t)},lr.prototype.close=function(){Kn(this.a)},lr.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Qn(this.a,e)):this.l?((e={}).__data__=zt(t),Qn(this.a,e)):Qn(this.a,t)},lr.prototype.G=function(){this.a.f=null,delete this.f,Kn(this.a),delete this.a,lr.X.G.call(this)},q(pr,Se),q(dr,De),q(yr,hr),yr.prototype.ta=function(){Ft(this.a,"a")},yr.prototype.sa=function(t){Ft(this.a,new pr(t))},yr.prototype.ra=function(t){Ft(this.a,new dr)},yr.prototype.qa=function(){Ft(this.a,"b")},fr.prototype.createWebChannel=fr.prototype.a,lr.prototype.send=lr.prototype.h,lr.prototype.open=lr.prototype.g,Ie.NO_ERROR=0,Ie.TIMEOUT=8,Ie.HTTP_ERROR=6,Ee.COMPLETE="complete",(Ae.EventType=A).OPEN="a",A.CLOSE="b",A.ERROR="c",A.MESSAGE="d",qt.prototype.listen=qt.prototype.va,kn.prototype.listenOnce=kn.prototype.wa,kn.prototype.getLastError=kn.prototype.Oa,kn.prototype.getLastErrorCode=kn.prototype.ua,kn.prototype.getStatus=kn.prototype.W,kn.prototype.getResponseJson=kn.prototype.Na,kn.prototype.getResponseText=kn.prototype.$,kn.prototype.send=kn.prototype.ba;var vr=Ie,gr=Ee,mr=Ae,wr=kn,br=(_r.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},_r.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},_r.prototype.setServiceProps=function(t){return this.serviceProps=t,this},_r);function _r(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Ir=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},Er=(Object.defineProperty(Ar.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Ar.prototype.isEqual=function(t){return t instanceof Ar&&t.projectId===this.projectId&&t.database===this.database},Ar),Tr=(Nr.prototype.u=function(){return null!=this.uid},Nr.prototype.h=function(){return this.u()?"uid:"+this.uid:"anonymous-user"},Nr.prototype.isEqual=function(t){return t.uid===this.uid},Nr);function Nr(t){this.uid=t}function Ar(t,e){this.projectId=t,this.database=e||"(default)"}Tr.UNAUTHENTICATED=new Tr(null),Tr.l=new Tr("google-credentials-uid"),Tr._=new Tr("first-party-uid");var Or="8.1.0-202010180421",Sr=new h("@firebase/firestore");function Dr(){return Sr.logLevel}function xr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Sr.logLevel<=l.DEBUG&&(e=n.map(Rr),Sr.debug.apply(Sr,s(["Firestore ("+Or+"): "+t],e)))}function kr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Sr.logLevel<=l.ERROR&&(e=n.map(Rr),Sr.error.apply(Sr,s(["Firestore ("+Or+"): "+t],e)))}function Pr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Sr.logLevel<=l.WARN&&(e=n.map(Rr),Sr.warn.apply(Sr,s(["Firestore ("+Or+"): "+t],e)))}function Rr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Cr(t){void 0===t&&(t="Unexpected state");t="FIRESTORE ("+Or+") INTERNAL ASSERTION FAILED: "+t;throw kr(t),new Error(t)}function Lr(t){t||Cr()}function Vr(t,e){this.user=e,this.type="OAuth",this.T={},this.T.Authorization="Bearer "+t}var Mr,Ur={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},jr=(n(Qr,Mr=Error),Qr),qr=(Hr.prototype.getToken=function(){return Promise.resolve(null)},Hr.prototype.m=function(){},Hr.prototype.A=function(t){(this.I=t)(Tr.UNAUTHENTICATED)},Hr.prototype.R=function(){this.I=null},Hr),Fr=(Wr.prototype.getToken=function(){var e=this,n=this.V,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.V!==n?(xr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Lr("string"==typeof t.accessToken),new Vr(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Wr.prototype.m=function(){this.forceRefresh=!0},Wr.prototype.A=function(t){this.I=t,this.g&&t(this.currentUser)},Wr.prototype.R=function(){this.auth&&this.auth.removeAuthTokenListener(this.P),this.P=null,this.I=null},Wr.prototype.p=function(){var t=this.auth&&this.auth.getUid();return Lr(null===t||"string"==typeof t),new Tr(t)},Wr),Br=(Object.defineProperty(Kr.prototype,"T",{get:function(){var t={"X-Goog-AuthUser":this.S},e=this.v.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Kr),zr=(Gr.prototype.getToken=function(){return Promise.resolve(new Br(this.v,this.S))},Gr.prototype.A=function(t){t(Tr._)},Gr.prototype.R=function(){},Gr.prototype.m=function(){},Gr);function Gr(t,e){this.v=t,this.S=e}function Kr(t,e){this.v=t,this.S=e,this.type="FirstParty",this.user=Tr._}function Wr(t){var e=this;this.P=null,this.currentUser=Tr.UNAUTHENTICATED,this.g=!1,this.V=0,this.I=null,this.forceRefresh=!1,this.P=function(){e.V++,e.currentUser=e.p(),e.g=!0,e.I&&e.I(e.currentUser)},this.V=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.P):(this.P(null),t.get().then(function(t){e.auth=t,e.P&&e.auth.addAuthTokenListener(e.P)},function(){}))}function Hr(){this.I=null}function Qr(t,e){var n=this;return(n=Mr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}var Yr=(Xr.D=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Xr);function Xr(){}function Jr(t,e){return t<e?-1:e<t?1:0}function $r(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Zr(t){return t+"\0"}var ti,ei,ni=(pi.now=function(){return pi.fromMillis(Date.now())},pi.fromDate=function(t){return pi.fromMillis(t.getTime())},pi.fromMillis=function(t){var e=Math.floor(t/1e3);return new pi(e,1e6*(t-1e3*e))},pi.prototype.toDate=function(){return new Date(this.toMillis())},pi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},pi.prototype.C=function(t){return this.seconds===t.seconds?Jr(this.nanoseconds,t.nanoseconds):Jr(this.seconds,t.seconds)},pi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},pi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},pi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},pi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},pi),ri=(li.N=function(t){return new li(t)},li.min=function(){return new li(new ni(0,0))},li.prototype.F=function(t){return this.timestamp.C(t.timestamp)},li.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},li.prototype.O=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},li.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},li.prototype.M=function(){return this.timestamp},li),Ie=(Object.defineProperty(fi.prototype,"length",{get:function(){return this.k},enumerable:!1,configurable:!0}),fi.prototype.isEqual=function(t){return 0===fi.$(this,t)},fi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof fi?t.forEach(function(t){e.push(t)}):e.push(t),this.L(e)},fi.prototype.limit=function(){return this.offset+this.length},fi.prototype.B=function(t){return t=void 0===t?1:t,this.L(this.segments,this.offset+t,this.length-t)},fi.prototype.q=function(){return this.L(this.segments,this.offset,this.length-1)},fi.prototype.U=function(){return this.segments[this.offset]},fi.prototype.K=function(){return this.get(this.length-1)},fi.prototype.get=function(t){return this.segments[this.offset+t]},fi.prototype.W=function(){return 0===this.length},fi.prototype.j=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},fi.prototype.G=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},fi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},fi.prototype.H=function(){return this.segments.slice(this.offset,this.limit())},fi.$=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},fi),ii=(n(hi,ei=Ie),hi.prototype.L=function(t,e,n){return new hi(t,e,n)},hi.prototype.J=function(){return this.H().join("/")},hi.prototype.toString=function(){return this.J()},hi.Y=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new jr(Ur.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new hi(n)},hi.X=function(){return new hi([])},hi),oi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,si=(n(ci,ti=Ie),ci.prototype.L=function(t,e,n){return new ci(t,e,n)},ci.Z=function(t){return oi.test(t)},ci.prototype.J=function(){return this.H().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),ci.Z(t)||(t="`"+t+"`"),t}).join(".")},ci.prototype.toString=function(){return this.J()},ci.prototype.tt=function(){return 1===this.length&&"__name__"===this.get(0)},ci.et=function(){return new ci(["__name__"])},ci.nt=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new jr(Ur.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new jr(Ur.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new jr(Ur.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new jr(Ur.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ci(e)},ci.X=function(){return new ci([])},ci),ui=(ai.st=function(t){return new ai(ii.Y(t))},ai.it=function(t){return new ai(ii.Y(t).B(5))},ai.prototype.rt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ai.prototype.isEqual=function(t){return null!==t&&0===ii.$(this.path,t.path)},ai.prototype.toString=function(){return this.path.toString()},ai.$=function(t,e){return ii.$(t.path,e.path)},ai.ot=function(t){return t.length%2==0},ai.ct=function(t){return new ai(new ii(t.slice()))},ai);function ai(t){this.path=t}function ci(){return null!==ti&&ti.apply(this,arguments)||this}function hi(){return null!==ei&&ei.apply(this,arguments)||this}function fi(t,e,n){void 0===e?e=0:e>t.length&&Cr(),void 0===n?n=t.length-e:n>t.length-e&&Cr(),this.segments=t,this.offset=e,this.k=n}function li(t){this.timestamp=t}function pi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new jr(Ur.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new jr(Ur.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new jr(Ur.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new jr(Ur.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function di(t){return null==t}function yi(t){return 0===t&&1/t==-1/0}function vi(t){return"number"==typeof t&&Number.isInteger(t)&&!yi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var gi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.ut=null};function mi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new gi(t,e,n,r,i,o,s)}function wi(t){var e=t;return null===e.ut&&(t=e.path.J(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.J()+t.op.toString()+To(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.J()+t.dir}).join(","),di(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=ea(e.startAt)),e.endAt&&(t+="|ub:",t+=ea(e.endAt)),e.ut=t),e.ut}function bi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!bo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ra(t.startAt,e.startAt)&&ra(t.endAt,e.endAt)}function _i(t){return ui.ot(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Ii=(Ei.fromBase64String=function(t){return new Ei(atob(t))},Ei.fromUint8Array=function(t){return new Ei(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Ei.prototype.toBase64=function(){return t=this.at,btoa(t);var t},Ei.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.at)},Ei.prototype.ht=function(){return 2*this.at.length},Ei.prototype.F=function(t){return Jr(this.at,t.at)},Ei.prototype.isEqual=function(t){return this.at===t.at},Ei);function Ei(t){this.at=t}Ii.lt=new Ii("");function Ti(t){this.count=t}var Ni,Ai=(Oi.prototype.dt=function(t){return new Oi(this.target,this.targetId,this._t,t,this.ft,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Oi.prototype.wt=function(t,e){return new Oi(this.target,this.targetId,this._t,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Oi.prototype.Et=function(t){return new Oi(this.target,this.targetId,this._t,this.sequenceNumber,this.ft,t,this.resumeToken)},Oi);function Oi(t,e,n,r,i,o,s){void 0===i&&(i=ri.min()),void 0===o&&(o=ri.min()),void 0===s&&(s=Ii.lt),this.target=t,this.targetId=e,this._t=n,this.sequenceNumber=r,this.ft=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Si(t){switch(t){case Ur.OK:return Cr(),0;case Ur.CANCELLED:case Ur.UNKNOWN:case Ur.DEADLINE_EXCEEDED:case Ur.RESOURCE_EXHAUSTED:case Ur.INTERNAL:case Ur.UNAVAILABLE:case Ur.UNAUTHENTICATED:return;case Ur.INVALID_ARGUMENT:case Ur.NOT_FOUND:case Ur.ALREADY_EXISTS:case Ur.PERMISSION_DENIED:case Ur.FAILED_PRECONDITION:case Ur.ABORTED:case Ur.OUT_OF_RANGE:case Ur.UNIMPLEMENTED:case Ur.DATA_LOSS:return 1;default:return Cr(),0}}function Di(t){if(void 0===t)return kr("GRPC error has no .code"),Ur.UNKNOWN;switch(t){case Ni.OK:return Ur.OK;case Ni.CANCELLED:return Ur.CANCELLED;case Ni.UNKNOWN:return Ur.UNKNOWN;case Ni.DEADLINE_EXCEEDED:return Ur.DEADLINE_EXCEEDED;case Ni.RESOURCE_EXHAUSTED:return Ur.RESOURCE_EXHAUSTED;case Ni.INTERNAL:return Ur.INTERNAL;case Ni.UNAVAILABLE:return Ur.UNAVAILABLE;case Ni.UNAUTHENTICATED:return Ur.UNAUTHENTICATED;case Ni.INVALID_ARGUMENT:return Ur.INVALID_ARGUMENT;case Ni.NOT_FOUND:return Ur.NOT_FOUND;case Ni.ALREADY_EXISTS:return Ur.ALREADY_EXISTS;case Ni.PERMISSION_DENIED:return Ur.PERMISSION_DENIED;case Ni.FAILED_PRECONDITION:return Ur.FAILED_PRECONDITION;case Ni.ABORTED:return Ur.ABORTED;case Ni.OUT_OF_RANGE:return Ur.OUT_OF_RANGE;case Ni.UNIMPLEMENTED:return Ur.UNIMPLEMENTED;case Ni.DATA_LOSS:return Ur.DATA_LOSS;default:return Cr()}}(Ee=Ni=Ni||{})[Ee.OK=0]="OK",Ee[Ee.CANCELLED=1]="CANCELLED",Ee[Ee.UNKNOWN=2]="UNKNOWN",Ee[Ee.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ee[Ee.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ee[Ee.NOT_FOUND=5]="NOT_FOUND",Ee[Ee.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ee[Ee.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ee[Ee.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ee[Ee.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ee[Ee.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ee[Ee.ABORTED=10]="ABORTED",Ee[Ee.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ee[Ee.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ee[Ee.INTERNAL=13]="INTERNAL",Ee[Ee.UNAVAILABLE=14]="UNAVAILABLE",Ee[Ee.DATA_LOSS=15]="DATA_LOSS";var xi=(Li.prototype.Tt=function(t,e){return new Li(this.$,this.root.Tt(t,e,this.$).copy(null,null,Pi.It,null,null))},Li.prototype.remove=function(t){return new Li(this.$,this.root.remove(t,this.$).copy(null,null,Pi.It,null,null))},Li.prototype.get=function(t){for(var e=this.root;!e.W();){var n=this.$(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Li.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.W();){var r=this.$(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Li.prototype.W=function(){return this.root.W()},Object.defineProperty(Li.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Li.prototype.At=function(){return this.root.At()},Li.prototype.Rt=function(){return this.root.Rt()},Li.prototype.Pt=function(t){return this.root.Pt(t)},Li.prototype.forEach=function(n){this.Pt(function(t,e){return n(t,e),!1})},Li.prototype.toString=function(){var n=[];return this.Pt(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Li.prototype.gt=function(t){return this.root.gt(t)},Li.prototype.yt=function(){return new ki(this.root,null,this.$,!1)},Li.prototype.Vt=function(t){return new ki(this.root,t,this.$,!1)},Li.prototype.vt=function(){return new ki(this.root,null,this.$,!0)},Li.prototype.bt=function(t){return new ki(this.root,t,this.$,!0)},Li),ki=(Ci.prototype.Ct=function(){var t=this.Dt.pop(),e={key:t.key,value:t.value};if(this.St)for(t=t.left;!t.W();)this.Dt.push(t),t=t.right;else for(t=t.right;!t.W();)this.Dt.push(t),t=t.left;return e},Ci.prototype.Nt=function(){return 0<this.Dt.length},Ci.prototype.xt=function(){if(0===this.Dt.length)return null;var t=this.Dt[this.Dt.length-1];return{key:t.key,value:t.value}},Ci),Pi=(Ri.prototype.copy=function(t,e,n,r,i){return new Ri(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Ri.prototype.W=function(){return!1},Ri.prototype.Pt=function(t){return this.left.Pt(t)||t(this.key,this.value)||this.right.Pt(t)},Ri.prototype.gt=function(t){return this.right.gt(t)||t(this.key,this.value)||this.left.gt(t)},Ri.prototype.min=function(){return this.left.W()?this:this.left.min()},Ri.prototype.At=function(){return this.min().key},Ri.prototype.Rt=function(){return this.right.W()?this.key:this.right.Rt()},Ri.prototype.Tt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Tt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Tt(t,e,n))).Ft()},Ri.prototype.Ot=function(){if(this.left.W())return Ri.EMPTY;var t=this;return t.left.Mt()||t.left.left.Mt()||(t=t.kt()),(t=t.copy(null,null,null,t.left.Ot(),null)).Ft()},Ri.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.W()||r.left.Mt()||r.left.left.Mt()||(r=r.kt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Mt()&&(r=r.$t()),r.right.W()||r.right.Mt()||r.right.left.Mt()||(r=r.Lt()),0===e(t,r.key)){if(r.right.W())return Ri.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Ot())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Ft()},Ri.prototype.Mt=function(){return this.color},Ri.prototype.Ft=function(){var t=this;return t.right.Mt()&&!t.left.Mt()&&(t=t.Bt()),t.left.Mt()&&t.left.left.Mt()&&(t=t.$t()),t.left.Mt()&&t.right.Mt()&&(t=t.qt()),t},Ri.prototype.kt=function(){var t=this.qt();return t.right.left.Mt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.$t())).Bt()).qt()),t},Ri.prototype.Lt=function(){var t=this.qt();return t.left.left.Mt()&&(t=(t=t.$t()).qt()),t},Ri.prototype.Bt=function(){var t=this.copy(null,null,Ri.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Ri.prototype.$t=function(){var t=this.copy(null,null,Ri.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Ri.prototype.qt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Ri.prototype.Ut=function(){var t=this.Qt();return Math.pow(2,t)<=this.size+1},Ri.prototype.Qt=function(){if(this.Mt()&&this.left.Mt())throw Cr();if(this.right.Mt())throw Cr();var t=this.left.Qt();if(t!==this.right.Qt())throw Cr();return t+(this.Mt()?0:1)},Ri);function Ri(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Ri.RED,this.left=null!=r?r:Ri.EMPTY,this.right=null!=i?i:Ri.EMPTY,this.size=this.left.size+1+this.right.size}function Ci(t,e,n,r){this.St=r,this.Dt=[];for(var i=1;!t.W();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.St?t.left:t.right;else{if(0===i){this.Dt.push(t);break}this.Dt.push(t),t=this.St?t.right:t.left}}function Li(t,e){this.$=t,this.root=e||Pi.EMPTY}function Vi(){this.size=0}Pi.EMPTY=null,Pi.RED=!0,Pi.It=!1,Pi.EMPTY=(Object.defineProperty(Vi.prototype,"key",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Object.defineProperty(Vi.prototype,"value",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Object.defineProperty(Vi.prototype,"color",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Object.defineProperty(Vi.prototype,"left",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Object.defineProperty(Vi.prototype,"right",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Vi.prototype.copy=function(t,e,n,r,i){return this},Vi.prototype.Tt=function(t,e,n){return new Pi(t,e)},Vi.prototype.remove=function(t,e){return this},Vi.prototype.W=function(){return!0},Vi.prototype.Pt=function(t){return!1},Vi.prototype.gt=function(t){return!1},Vi.prototype.At=function(){return null},Vi.prototype.Rt=function(){return null},Vi.prototype.Mt=function(){return!1},Vi.prototype.Ut=function(){return!0},Vi.prototype.Qt=function(){return 0},new Vi);var Mi=(Fi.prototype.has=function(t){return null!==this.data.get(t)},Fi.prototype.first=function(){return this.data.At()},Fi.prototype.last=function(){return this.data.Rt()},Object.defineProperty(Fi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Fi.prototype.indexOf=function(t){return this.data.indexOf(t)},Fi.prototype.forEach=function(n){this.data.Pt(function(t,e){return n(t),!1})},Fi.prototype.Kt=function(t,e){for(var n=this.data.Vt(t[0]);n.Nt();){var r=n.Ct();if(0<=this.$(r.key,t[1]))return;e(r.key)}},Fi.prototype.Wt=function(t,e){for(var n=void 0!==e?this.data.Vt(e):this.data.yt();n.Nt();)if(!t(n.Ct().key))return},Fi.prototype.jt=function(t){t=this.data.Vt(t);return t.Nt()?t.Ct().key:null},Fi.prototype.yt=function(){return new Ui(this.data.yt())},Fi.prototype.Vt=function(t){return new Ui(this.data.Vt(t))},Fi.prototype.add=function(t){return this.copy(this.data.remove(t).Tt(t,!0))},Fi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Fi.prototype.W=function(){return this.data.W()},Fi.prototype.Gt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Fi.prototype.isEqual=function(t){if(!(t instanceof Fi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.yt(),n=t.data.yt();e.Nt();){var r=e.Ct().key,i=n.Ct().key;if(0!==this.$(r,i))return!1}return!0},Fi.prototype.H=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Fi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Fi.prototype.copy=function(t){var e=new Fi(this.$);return e.data=t,e},Fi),Ui=(qi.prototype.Ct=function(){return this.zt.Ct().key},qi.prototype.Nt=function(){return this.zt.Nt()},qi),ji=new xi(ui.$);function qi(t){this.zt=t}function Fi(t){this.$=t,this.data=new xi(this.$)}var Bi=new xi(ui.$);var zi=new xi(ui.$),Gi=new Mi(ui.$);function Ki(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Gi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Wi=new Mi(Jr);var Hi=(co.Yt=function(t){return new co(t.$)},co.prototype.has=function(t){return null!=this.Ht.get(t)},co.prototype.get=function(t){return this.Ht.get(t)},co.prototype.first=function(){return this.Jt.At()},co.prototype.last=function(){return this.Jt.Rt()},co.prototype.W=function(){return this.Jt.W()},co.prototype.indexOf=function(t){t=this.Ht.get(t);return t?this.Jt.indexOf(t):-1},Object.defineProperty(co.prototype,"size",{get:function(){return this.Jt.size},enumerable:!1,configurable:!0}),co.prototype.forEach=function(n){this.Jt.Pt(function(t,e){return n(t),!1})},co.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ht.Tt(t.key,t),e.Jt.Tt(t,null))},co.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ht.remove(t),this.Jt.remove(e)):this},co.prototype.isEqual=function(t){if(!(t instanceof co))return!1;if(this.size!==t.size)return!1;for(var e=this.Jt.yt(),n=t.Jt.yt();e.Nt();){var r=e.Ct().key,i=n.Ct().key;if(!r.isEqual(i))return!1}return!0},co.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},co.prototype.copy=function(t,e){var n=new co;return n.$=this.$,n.Ht=t,n.Jt=e,n},co),Qi=(ao.prototype.track=function(t){var e=t.doc.key,n=this.Xt.get(e);!n||0!==t.type&&3===n.type?this.Xt=this.Xt.Tt(e,t):3===t.type&&1!==n.type?this.Xt=this.Xt.Tt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Xt=this.Xt.Tt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Xt=this.Xt.remove(e):1===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):Cr()},ao.prototype.Zt=function(){var n=[];return this.Xt.Pt(function(t,e){n.push(e)}),n},ao),Yi=(uo.ie=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new uo(t,e,Hi.Yt(e),i,n,r,!0,!1)},Object.defineProperty(uo.prototype,"hasPendingWrites",{get:function(){return!this.ee.W()},enumerable:!1,configurable:!0}),uo.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.ne===t.ne&&this.ee.isEqual(t.ee)&&Tu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.te.isEqual(t.te)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},uo),Xi=(so.ae=function(t,e){var n=new Map;return n.set(t,Ji.he(t,e)),new so(ri.min(),n,Wi,ji,Ki())},so),Ji=(oo.he=function(t,e){return new oo(Ii.lt,e,Ki(),Ki(),Ki())},oo),$i=function(t,e,n,r){this.we=t,this.removedTargetIds=e,this.key=n,this.Ee=r},Zi=function(t,e){this.targetId=t,this.Te=e},to=function(t,e,n,r){void 0===n&&(n=Ii.lt),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},eo=(Object.defineProperty(io.prototype,"le",{get:function(){return this.Re},enumerable:!1,configurable:!0}),Object.defineProperty(io.prototype,"resumeToken",{get:function(){return this.Ae},enumerable:!1,configurable:!0}),Object.defineProperty(io.prototype,"ge",{get:function(){return 0!==this.Ie},enumerable:!1,configurable:!0}),Object.defineProperty(io.prototype,"ye",{get:function(){return this.Pe},enumerable:!1,configurable:!0}),io.prototype.Ve=function(t){0<t.ht()&&(this.Pe=!0,this.Ae=t)},io.prototype.pe=function(){var n=Ki(),r=Ki(),i=Ki();return this.me.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Cr()}}),new Ji(this.Ae,this.Re,n,r,i)},io.prototype.ve=function(){this.Pe=!1,this.me=fo()},io.prototype.be=function(t,e){this.Pe=!0,this.me=this.me.Tt(t,e)},io.prototype.Se=function(t){this.Pe=!0,this.me=this.me.remove(t)},io.prototype.De=function(){this.Ie+=1},io.prototype.Ce=function(){--this.Ie},io.prototype.Ne=function(){this.Pe=!0,this.Re=!0},io),no=(ro.prototype.$e=function(t){for(var e=0,n=t.we;e<n.length;e++){var r=n[e];t.Ee instanceof uu?this.Le(r,t.Ee):t.Ee instanceof au&&this.Be(r,t.key,t.Ee)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Be(s,t.key,t.Ee)}},ro.prototype.qe=function(n){var r=this;this.Ue(n,function(t){var e=r.Qe(t);switch(n.state){case 0:r.Ke(t)&&e.Ve(n.resumeToken);break;case 1:e.Ce(),e.ge||e.ve(),e.Ve(n.resumeToken);break;case 2:e.Ce(),e.ge||r.removeTarget(t);break;case 3:r.Ke(t)&&(e.Ne(),e.Ve(n.resumeToken));break;case 4:r.Ke(t)&&(r.We(t),e.Ve(n.resumeToken));break;default:Cr()}})},ro.prototype.Ue=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Fe.forEach(function(t,e){r.Ke(e)&&n(e)})},ro.prototype.je=function(t){var e=t.targetId,n=t.Te.count,t=this.Ge(e);t&&(_i(t=t.target)?0===n?(t=new ui(t.path),this.Be(e,t,new au(t,ri.min()))):Lr(1===n):this.ze(e)!==n&&(this.We(e),this.ke=this.ke.add(e)))},ro.prototype.He=function(r){var i=this,o=new Map;this.Fe.forEach(function(t,e){var n=i.Ge(e);n&&(t.le&&_i(n.target)&&(n=new ui(n.target.path),null!==i.Oe.get(n)||i.Je(e,n)||i.Be(e,n,new au(n,r))),t.ye&&(o.set(e,t.pe()),t.ve()))});var s=Ki();this.Me.forEach(function(t,e){var n=!0;e.Wt(function(t){t=i.Ge(t);return!t||2===t._t||(n=!1)}),n&&(s=s.add(t))});var t=new Xi(r,o,this.ke,this.Oe,s);return this.Oe=ji,this.Me=ho(),this.ke=new Mi(Jr),t},ro.prototype.Le=function(t,e){var n;this.Ke(t)&&(n=this.Je(t,e.key)?2:0,this.Qe(t).be(e.key,n),this.Oe=this.Oe.Tt(e.key,e),this.Me=this.Me.Tt(e.key,this.Ye(e.key).add(t)))},ro.prototype.Be=function(t,e,n){var r;this.Ke(t)&&(r=this.Qe(t),this.Je(t,e)?r.be(e,1):r.Se(e),this.Me=this.Me.Tt(e,this.Ye(e).delete(t)),n&&(this.Oe=this.Oe.Tt(e,n)))},ro.prototype.removeTarget=function(t){this.Fe.delete(t)},ro.prototype.ze=function(t){var e=this.Qe(t).pe();return this.xe.Xe(t).size+e._e.size-e.de.size},ro.prototype.De=function(t){this.Qe(t).De()},ro.prototype.Qe=function(t){var e=this.Fe.get(t);return e||(e=new eo,this.Fe.set(t,e)),e},ro.prototype.Ye=function(t){var e=this.Me.get(t);return e||(e=new Mi(Jr),this.Me=this.Me.Tt(t,e)),e},ro.prototype.Ke=function(t){var e=null!==this.Ge(t);return e||xr("WatchChangeAggregator","Detected inactive target",t),e},ro.prototype.Ge=function(t){var e=this.Fe.get(t);return e&&e.ge?null:this.xe.Ze(t)},ro.prototype.We=function(e){var n=this;this.Fe.set(e,new eo),this.xe.Xe(e).forEach(function(t){n.Be(e,t,null)})},ro.prototype.Je=function(t,e){return this.xe.Xe(t).has(e)},ro);function ro(t){this.xe=t,this.Fe=new Map,this.Oe=ji,this.Me=ho(),this.ke=new Mi(Jr)}function io(){this.Ie=0,this.me=fo(),this.Ae=Ii.lt,this.Re=!1,this.Pe=!0}function oo(t,e,n,r,i){this.resumeToken=t,this.le=e,this._e=n,this.fe=r,this.de=i}function so(t,e,n,r,i){this.ft=t,this.re=e,this.oe=n,this.ce=r,this.ue=i}function uo(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.te=n,this.docChanges=r,this.ee=i,this.fromCache=o,this.ne=s,this.se=u}function ao(){this.Xt=new xi(ui.$)}function co(n){this.$=n?function(t,e){return n(t,e)||ui.$(t.key,e.key)}:function(t,e){return ui.$(t.key,e.key)},this.Ht=Bi,this.Jt=new xi(this.$)}function ho(){return new xi(ui.$)}function fo(){return new xi(ui.$)}function lo(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function po(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function yo(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function vo(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function go(t){t=No(t.mapValue.fields.__local_write_time__.timestampValue);return new ni(t.seconds,t.nanos)}var mo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function wo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?vo(t)?4:10:Cr()}function bo(r,i){var t,e=wo(r);if(e!==wo(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return go(r).isEqual(go(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=No(r.timestampValue),t=No(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,Oo(r.bytesValue).isEqual(Oo(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Ao((t=r).geoPointValue.latitude)===Ao(e.geoPointValue.latitude)&&Ao(t.geoPointValue.longitude)===Ao(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Ao(t.integerValue)===Ao(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=Ao(t.doubleValue),e=Ao(e.doubleValue);return t===e?yi(t)===yi(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return $r(r.arrayValue.values||[],i.arrayValue.values||[],bo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(lo(e)!==lo(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!bo(e[t],n[t])))return!1;return!0}();default:return Cr()}}function _o(t,e){return void 0!==(t.values||[]).find(function(t){return bo(t,e)})}function Io(t,e){var n,r,i=wo(t),o=wo(e);if(i!==o)return Jr(i,o);switch(i){case 0:return 0;case 1:return Jr(t.booleanValue,e.booleanValue);case 2:return n=e,r=Ao(t.integerValue||t.doubleValue),n=Ao(n.integerValue||n.doubleValue),r<n?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return Eo(t.timestampValue,e.timestampValue);case 4:return Eo(go(t),go(e));case 5:return Jr(t.stringValue,e.stringValue);case 6:return function(t,e){t=Oo(t),e=Oo(e);return t.F(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Jr(n[i],r[i]);if(0!==o)return o}return Jr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=Jr(Ao(i.latitude),Ao(r.latitude)))?n:Jr(Ao(i.longitude),Ao(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Io(n[i],r[i]);if(o)return o}return Jr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Jr(r[s],o[s]);if(0!==u)return u;u=Io(n[r[s]],i[o[s]]);if(0!==u)return u}return Jr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Cr()}}function Eo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Jr(t,e);var n=No(t),t=No(e),e=Jr(n.seconds,t.seconds);return 0!==e?e:Jr(n.nanos,t.nanos)}function To(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=No(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Oo(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,ui.it(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):Cr();var e}(t)}function No(t){if(Lr(!!t),"string"!=typeof t)return{seconds:Ao(t.seconds),nanos:Ao(t.nanos)};var e=0,n=mo.exec(t);Lr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Ao(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Oo(t){return"string"==typeof t?Ii.fromBase64String(t):Ii.fromUint8Array(t)}function So(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.J()}}function Do(t){return t&&"integerValue"in t}function xo(t){return!!t&&"arrayValue"in t}function ko(t){return t&&"nullValue"in t}function Po(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ro(t){return t&&"mapValue"in t}var Co={asc:"ASCENDING",desc:"DESCENDING"},Lo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Vo=function(t,e){this.t=t,this.tn=e};function Mo(t){return{integerValue:""+t}}function Uo(t,e){if(t.tn){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:yi(e)?"-0":e}}function jo(t,e){return vi(e)?Mo(e):Uo(t,e)}function qo(t,e){return t.tn?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Fo(t,e){return t.tn?e.toBase64():e.toUint8Array()}function Bo(t){return Lr(!!t),ri.N((t=No(t),new ni(t.seconds,t.nanos)))}function zo(t,e){return new ii(["projects",t.projectId,"databases",t.database]).child("documents").child(e).J()}function Go(t){t=ii.Y(t);return Lr(as(t)),t}function Ko(t,e){return zo(t.t,e.path)}function Wo(t,e){e=Go(e);if(e.get(1)!==t.t.projectId)throw new jr(Ur.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.t.projectId);if(e.get(3)!==t.t.database)throw new jr(Ur.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.t.database);return new ui(Xo(e))}function Ho(t,e){return zo(t.t,e)}function Qo(t){t=Go(t);return 4===t.length?ii.X():Xo(t)}function Yo(t){return new ii(["projects",t.t.projectId,"databases",t.t.database]).J()}function Xo(t){return Lr(4<t.length&&"documents"===t.get(4)),t.B(5)}function Jo(t,e,n){return{name:Ko(t,e),fields:n.proto.mapValue.fields}}function $o(t,e){var n,r,i;if(e instanceof js)n={update:Jo(t,e.key,e.value)};else if(e instanceof Xs)n={delete:Ko(t,e.key)};else if(e instanceof qs)n={update:Jo(t,e.key,e.data),updateMask:(i=e.en,r=[],i.fields.forEach(function(t){return r.push(t.J())}),{fieldPaths:r})};else if(e instanceof Ks)n={transform:{document:Ko(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof ls)return{fieldPath:t.field.J(),setToServerValue:"REQUEST_TIME"};if(e instanceof ps)return{fieldPath:t.field.J(),appendMissingElements:{values:e.elements}};if(e instanceof ms)return{fieldPath:t.field.J(),removeAllFromArray:{values:e.elements}};if(e instanceof Is)return{fieldPath:t.field.J(),increment:e.nn};throw Cr()})}};else{if(!(e instanceof Js))return Cr();n={verify:Ko(t,e.key)}}return e.rn.sn||(n.currentDocument=void 0!==(i=e.rn).updateTime?{updateTime:(e=t,t=i.updateTime,qo(e,t.M()))}:void 0!==i.exists?{exists:i.exists}:Cr()),n}function Zo(e,t){var n=t.currentDocument?void 0!==(o=t.currentDocument).updateTime?xs.updateTime(Bo(o.updateTime)):void 0!==o.exists?xs.exists(o.exists):xs.on():xs.on();if(t.update){t.update.name;var r=Wo(e,t.update.name),i=new $s({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=(o=t.updateMask.fieldPaths||[],new As(o.map(function(t){return si.nt(t)})));return new qs(r,i,o,n)}return new js(r,i,n)}if(t.delete){var s=Wo(e,t.delete);return new Xs(s,n)}if(t.transform){i=Wo(e,t.transform.document),s=t.transform.fieldTransforms.map(function(t){return function(t,e){var n,r=null;"setToServerValue"in e?(Lr("REQUEST_TIME"===e.setToServerValue),r=new ls):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],r=new ps(n)):"removeAllFromArray"in e?(n=e.removeAllFromArray.values||[],r=new ms(n)):"increment"in e?r=new Is(t,e.increment):Cr();e=si.nt(e.fieldPath);return new Os(e,r)}(e,t)});return Lr(!0===n.exists),new Ks(i,s)}if(t.verify){t=Wo(e,t.verify);return new Js(t,n)}return Cr()}function ts(t,e){return{documents:[Ho(t,e.path)]}}function es(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Ho(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Ho(t,r.q()),n.structuredQuery.from=[{collectionId:r.K()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(Po(t.value))return{unaryFilter:{field:os(t.field),op:"IS_NAN"}};if(ko(t.value))return{unaryFilter:{field:os(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Po(t.value))return{unaryFilter:{field:os(t.field),op:"IS_NOT_NAN"}};if(ko(t.value))return{unaryFilter:{field:os(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:os(t.field),op:(e=t.op,Lo[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:os((t=t).field),direction:(t=t.dir,Co[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.tn||di(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=rs(e.startAt)),e.endAt&&(n.structuredQuery.endAt=rs(e.endAt)),n}function ns(t){var e=Qo(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Lr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[us(t)]:void 0!==t.fieldFilter?[(n=t,xu.create(ss(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Cr()}}(),n.fieldFilter.value))]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):Cr():[];var n}(n.where));t=[];n.orderBy&&(t=n.orderBy.map(function(t){return new ia(ss((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));r=null;n.limit&&(r=di(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=is(n.startAt));var u=null;return n.endAt&&(u=is(n.endAt)),du(e,i,t,o,r,"F",s,u)}function rs(t){return{before:t.before,values:t.position}}function is(t){var e=!!t.before,t=t.values||[];return new Xu(t,e)}function os(t){return{fieldPath:t.J()}}function ss(t){return si.nt(t.fieldPath)}function us(t){switch(t.unaryFilter.op){case"IS_NAN":var e=ss(t.unaryFilter.field);return xu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=ss(t.unaryFilter.field);return xu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":n=ss(t.unaryFilter.field);return xu.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":t=ss(t.unaryFilter.field);return xu.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Cr()}}function as(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}h=function(){this.cn=void 0};function cs(t,e){return t instanceof Is?Do(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var hs,fs,ls=(n(ys,fs=h),ys),ps=(n(ds,hs=h),ds);function ds(t){var e=this;return(e=hs.call(this)||this).elements=t,e}function ys(){return null!==fs&&fs.apply(this,arguments)||this}function vs(t,e){for(var n=Ns(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return bo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var gs,ms=(n(ws,gs=h),ws);function ws(t){var e=this;return(e=gs.call(this)||this).elements=t,e}function bs(t,e){for(var n=Ns(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!bo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var _s,Is=(n(Es,_s=h),Es);function Es(t,e){var n=this;return(n=_s.call(this)||this).serializer=t,n.nn=e,n}function Ts(t){return Ao(t.integerValue||t.doubleValue)}function Ns(t){return xo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var As=(Ss.prototype.un=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].j(t))return!0;return!1},Ss.prototype.isEqual=function(t){return $r(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Ss),Os=function(t,e){this.field=t,this.transform=e};function Ss(t){(this.fields=t).sort(si.$)}function Ds(t,e){this.version=t,this.transformResults=e}var xs=(ks.on=function(){return new ks},ks.exists=function(t){return new ks(void 0,t)},ks.updateTime=function(t){return new ks(t)},Object.defineProperty(ks.prototype,"sn",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),ks.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},ks);function ks(t,e){this.updateTime=t,this.exists=e}function Ps(t,e){return void 0!==t.updateTime?e instanceof uu&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof uu}Ie=function(){};function Rs(t,e,n){return t instanceof js?new uu(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof qs?function(t,e,n){if(!Ps(t.rn,e))return new cu(t.key,n.version);e=zs(t,e);return new uu(t.key,n.version,e,{hasCommittedMutations:!0})}(t,e,n):t instanceof Ks?function(t,e,n){if(Lr(null!=n.transformResults),!Ps(t.rn,e))return new cu(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Lr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof uu&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof ps?vs(o,s):o instanceof ms?bs(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=Hs(t,r.data(),e);return new uu(t.key,n,e,{hasCommittedMutations:!0})}(t,e,n):new au(t.key,n.version,{hasCommittedMutations:!0})}function Cs(t,e,n,r){return t instanceof js?function(t,e){if(!Ps(t.rn,e))return e;e=Vs(e);return new uu(t.key,e,t.value,{an:!0})}(t,e):t instanceof qs?function(t,e){if(!Ps(t.rn,e))return e;var n=Vs(e),e=zs(t,e);return new uu(t.key,n,e,{an:!0})}(t,e):t instanceof Ks?function(t,e,n,r){if(!Ps(t.rn,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],c=a.transform,h=null;n instanceof uu&&(h=n.field(a.field)),null===h&&r instanceof uu&&(h=r.field(a.field)),o.push((i=h,a=e,h=void 0,(c=c)instanceof ls?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(h.fields.__previous_value__=i),{mapValue:h}):c instanceof ps?vs(c,i):c instanceof ms?bs(c,i):(c=cs(h=c,i),i=Ts(c)+Ts(h.nn),Do(c)&&Do(h.nn)?Mo(i):Uo(h.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=Hs(t,i.data(),r);return new uu(t.key,i.version,r,{an:!0})}(t,e,r,n):(e=e,Ps((t=t).rn,e)?new au(t.key,ri.min()):e)}function Ls(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.rn.isEqual(e.rn)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.en.isEqual(e.en):2!==t.type||$r(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof ps&&e instanceof ps||t instanceof ms&&e instanceof ms?$r(t.elements,e.elements,bo):t instanceof Is&&e instanceof Is?bo(t.nn,e.nn):t instanceof ls&&e instanceof ls)}))}function Vs(t){return t instanceof uu?t.version:ri.min()}var Ms,Us,js=(n(Bs,Us=Ie),Bs),qs=(n(Fs,Ms=Ie),Fs);function Fs(t,e,n,r){var i=this;return(i=Ms.call(this)||this).key=t,i.data=e,i.en=n,i.rn=r,i.type=1,i}function Bs(t,e,n){var r=this;return(r=Us.call(this)||this).key=t,r.value=e,r.rn=n,r.type=0,r}function zs(t,e){return n=t,e=e instanceof uu?e.data():$s.empty(),r=new Zs(e),n.en.fields.forEach(function(t){var e;t.W()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.hn();var n,r}var Gs,Ks=(n(Ws,Gs=Ie),Ws);function Ws(t,e){var n=this;return(n=Gs.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.rn=xs.exists(!0),n}function Hs(t,e,n){for(var r=new Zs(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.hn()}var Qs,Ys,Xs=(n(ru,Ys=Ie),ru),Js=(n(nu,Qs=Ie),nu),$s=(eu.empty=function(){return new eu({mapValue:{}})},eu.prototype.field=function(t){if(t.W())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Ro(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.K()])||null},eu.prototype.isEqual=function(t){return bo(this.proto,t.proto)},eu),Zs=(tu.prototype.set=function(t,e){return this.fn(t,e),this},tu.prototype.delete=function(t){return this.fn(t,null),this},tu.prototype.fn=function(t,e){for(var n=this._n,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===wo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.K(),e)},tu.prototype.hn=function(){var t=this.dn(si.X(),this._n);return null!=t?new $s(t):this.ln},tu.prototype.dn=function(r,t){var i=this,o=!1,e=this.ln.field(r),s=Ro(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.dn(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},tu);function tu(t){void 0===t&&(t=$s.empty()),this.ln=t,this._n=new Map}function eu(t){this.proto=t}function nu(t,e){var n=this;return(n=Qs.call(this)||this).key=t,n.rn=e,n.type=4,n}function ru(t,e){var n=this;return(n=Ys.call(this)||this).key=t,n.rn=e,n.type=3,n}var iu,ou,su,Ee=function(t,e){this.key=t,this.version=e},uu=(n(pu,su=Ee),pu.prototype.field=function(t){return this.wn.field(t)},pu.prototype.data=function(){return this.wn},pu.prototype.En=function(){return this.wn.proto},pu.prototype.isEqual=function(t){return t instanceof pu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.an===t.an&&this.hasCommittedMutations===t.hasCommittedMutations&&this.wn.isEqual(t.wn)},pu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.wn.toString()+", {hasLocalMutations: "+this.an+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(pu.prototype,"hasPendingWrites",{get:function(){return this.an||this.hasCommittedMutations},enumerable:!1,configurable:!0}),pu),au=(n(lu,ou=Ee),lu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(lu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),lu.prototype.isEqual=function(t){return t instanceof lu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},lu),cu=(n(fu,iu=Ee),fu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(fu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),fu.prototype.isEqual=function(t){return t instanceof fu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},fu),hu=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Tn=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.In=null,this.mn=null,this.startAt,this.endAt};function fu(){return null!==iu&&iu.apply(this,arguments)||this}function lu(t,e,n){var r=this;return(r=ou.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function pu(t,e,n,r){var i=this;return(i=su.call(this,t,e)||this).wn=n,i.an=!!r.an,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function du(t,e,n,r,i,o,s,u){return new hu(t,e,n,r,i,o,s,u)}function yu(t){return new hu(t)}function vu(t){return!di(t.limit)&&"F"===t.limitType}function gu(t){return!di(t.limit)&&"L"===t.limitType}function mu(t){return 0<t.Tn.length?t.Tn[0].field:null}function wu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.An())return r.field}return null}function bu(t){return null!==t.collectionGroup}function _u(t){var e=t;if(null===e.In){e.In=[];var n=wu(e),t=mu(e);if(null!==n&&null===t)n.tt()||e.In.push(new ia(n)),e.In.push(new ia(si.et(),"asc"));else{for(var r=!1,i=0,o=e.Tn;i<o.length;i++){var s=o[i];e.In.push(s),s.field.tt()&&(r=!0)}r||(n=0<e.Tn.length?e.Tn[e.Tn.length-1].dir:"asc",e.In.push(new ia(si.et(),n)))}}return e.In}function Iu(t){var e=t;if(!e.mn)if("F"===e.limitType)e.mn=mi(e.path,e.collectionGroup,_u(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=_u(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new ia(o.field,s))}var u=e.endAt?new Xu(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Xu(e.startAt.position,!e.startAt.before):null;e.mn=mi(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.mn}function Eu(t,e,n){return new hu(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Tu(t,e){return bi(Iu(t),Iu(e))&&t.limitType===e.limitType}function Nu(t){return wi(Iu(t))+"|lt:"+t.limitType}function Au(t){return"Query(target="+(e=Iu(t),n=e.path.J(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.J()+" "+t.op+" "+To(t.value)}).join(", ")+"]"),di(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.J()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+ea(e.startAt)),e.endAt&&(n+=", endAt: "+ea(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function Ou(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.rt(e.collectionGroup)&&e.path.j(n):ui.ot(e.path)?e.path.isEqual(n):e.path.G(n))&&function(t){for(var e=0,n=i.Tn;e<n.length;e++){var r=n[e];if(!r.field.tt()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||na(t.startAt,_u(t),n))&&(!t.endAt||!na(t.endAt,_u(t),n)));var e,n}function Su(u){return function(t,e){for(var n=!1,r=0,i=_u(u);r<i.length;r++){var o=i[r],s=function(t,r,e){e=t.field.tt()?ui.$(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?Io(n,t):Cr()}(t.field,e);switch(t.dir){case"asc":return e;case"desc":return-1*e;default:return Cr()}}(o,t,e);if(0!==s)return s;n=n||o.field.tt()}return 0}}var Du,xu=(n(ku,Du=function(){}),ku.create=function(t,e,n){return t.tt()?"in"===e||"not-in"===e?this.Rn(t,e,n):new Lu(t,e,n):"array-contains"===e?new Wu(t,n):"in"===e?new Hu(t,n):"not-in"===e?new Qu(t,n):"array-contains-any"===e?new Yu(t,n):new ku(t,e,n)},ku.Rn=function(t,e,n){return new("in"===e?Vu:Mu)(t,n)},ku.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this.Pn(Io(t,this.value)):null!==t&&wo(this.value)===wo(t)&&this.Pn(Io(t,this.value))},ku.prototype.Pn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Cr()}},ku.prototype.An=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},ku);function ku(t,e,n){var r=this;return(r=Du.call(this)||this).field=t,r.op=e,r.value=n,r}var Pu,Ru,Cu,Lu=(n(qu,Cu=xu),qu.prototype.matches=function(t){t=ui.$(t.key,this.key);return this.Pn(t)},qu),Vu=(n(ju,Ru=xu),ju.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},ju),Mu=(n(Uu,Pu=xu),Uu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Uu);function Uu(t,e){var n=this;return(n=Pu.call(this,t,"not-in",e)||this).keys=Fu(0,e),n}function ju(t,e){var n=this;return(n=Ru.call(this,t,"in",e)||this).keys=Fu(0,e),n}function qu(t,e,n){var r=this;return(r=Cu.call(this,t,e,n)||this).key=ui.it(n.referenceValue),r}function Fu(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return ui.it(t.referenceValue)})}var Bu,zu,Gu,Ku,Wu=(n(ta,Ku=xu),ta.prototype.matches=function(t){t=t.field(this.field);return xo(t)&&_o(t.arrayValue,this.value)},ta),Hu=(n(Zu,Gu=xu),Zu.prototype.matches=function(t){t=t.field(this.field);return null!==t&&_o(this.value.arrayValue,t)},Zu),Qu=(n($u,zu=xu),$u.prototype.matches=function(t){if(_o(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!_o(this.value.arrayValue,t)},$u),Yu=(n(Ju,Bu=xu),Ju.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!xo(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return _o(e.value.arrayValue,t)})},Ju),Xu=function(t,e){this.position=t,this.before=e};function Ju(t,e){return Bu.call(this,t,"array-contains-any",e)||this}function $u(t,e){return zu.call(this,t,"not-in",e)||this}function Zu(t,e){return Gu.call(this,t,"in",e)||this}function ta(t,e){return Ku.call(this,t,"array-contains",e)||this}function ea(t){return(t.before?"b":"a")+":"+t.position.map(To).join(",")}function na(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.tt()?ui.$(ui.it(s.referenceValue),n.key):Io(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function ra(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!bo(t.position[n],e.position[n]))return!1;return!0}var ia=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};var oa=(da.prototype.yn=function(t,e,n){for(var r=n.Vn,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Rs(o,e,r[i]))}return e},da.prototype.pn=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Cs(i,e,e,this.gn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Cs(a,e,o,this.gn))}return e},da.prototype.vn=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.pn(t.key,n.get(t.key));e&&(i=i.Tt(t.key,e))}),i},da.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Ki())},da.prototype.isEqual=function(t){return this.batchId===t.batchId&&$r(this.mutations,t.mutations,Ls)&&$r(this.baseMutations,t.baseMutations,Ls)},da),sa=(pa.from=function(t,e,n){Lr(t.mutations.length===n.length);for(var r=zi,i=t.mutations,o=0;o<i.length;o++)r=r.Tt(i[o].key,n[o].version);return new pa(t,e,n,r)},pa),ua=(la.prototype.get=function(t){var e=this.Dn(t),e=this.Nn[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.Cn(o,t))return i}},la.prototype.has=function(t){return void 0!==this.get(t)},la.prototype.set=function(t,e){var n=this.Dn(t),r=this.Nn[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.Cn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.Nn[n]=[[t,e]]},la.prototype.delete=function(t){var e=this.Dn(t),n=this.Nn[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.Cn(n[r][0],t))return 1===n.length?delete this.Nn[e]:n.splice(r,1),!0;return!1},la.prototype.forEach=function(s){po(this.Nn,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},la.prototype.W=function(){return yo(this.Nn)},la),aa=(fa.prototype.catch=function(t){return this.next(void 0,t)},fa.prototype.next=function(r,i){var o=this;return this.Mn&&Cr(),this.Mn=!0,this.On?this.error?this.kn(i,this.error):this.$n(r,this.result):new fa(function(e,n){o.xn=function(t){o.$n(r,t).next(e,n)},o.Fn=function(t){o.kn(i,t).next(e,n)}})},fa.prototype.Ln=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},fa.prototype.Bn=function(t){try{var e=t();return e instanceof fa?e:fa.resolve(e)}catch(t){return fa.reject(t)}},fa.prototype.$n=function(t,e){return t?this.Bn(function(){return t(e)}):fa.resolve(e)},fa.prototype.kn=function(t,e){return t?this.Bn(function(){return t(e)}):fa.reject(e)},fa.resolve=function(n){return new fa(function(t,e){t(n)})},fa.reject=function(n){return new fa(function(t,e){e(n)})},fa.qn=function(t){return new fa(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},fa.Un=function(t){for(var n=fa.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?fa.resolve(t):e()})}(r[e]);return n},fa.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.qn(i)},fa),h=(ha.prototype.Wn=function(t){t=this.Qn.get(t);return t?t.readTime:ri.min()},ha.prototype.jn=function(t,e){this.Gn(),this.Qn.set(t.key,{zn:t,readTime:e})},ha.prototype.Hn=function(t,e){void 0===e&&(e=null),this.Gn(),this.Qn.set(t,{zn:null,readTime:e})},ha.prototype.Jn=function(t,e){this.Gn();var n=this.Qn.get(e);return void 0!==n?aa.resolve(n.zn):this.Yn(t,e)},ha.prototype.getEntries=function(t,e){return this.Xn(t,e)},ha.prototype.apply=function(t){return this.Gn(),this.Kn=!0,this.Zn(t)},ha.prototype.Gn=function(){},ha),ca=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})};function ha(){this.Qn=new ua(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Kn=!1}function fa(t){var e=this;this.xn=null,this.Fn=null,this.result=void 0,this.error=void 0,this.On=!1,this.Mn=!1,t(function(t){e.On=!0,e.result=t,e.xn&&e.xn(t)},function(t){e.On=!0,e.error=t,e.Fn&&e.Fn(t)})}function la(t,e){this.Dn=t,this.Cn=e,this.Nn={}}function pa(t,e,n,r){this.batch=t,this.bn=e,this.Vn=n,this.Sn=r}function da(t,e,n,r){this.batchId=t,this.gn=e,this.baseMutations=n,this.mutations=r}function ya(t){return new Vo(t,!0)}function va(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var ga="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ie=(Ta.prototype.es=function(t){this.ts.push(t)},Ta.prototype.ns=function(){this.ts.forEach(function(t){return t()})},Ta),ma=(Ea.prototype.cs=function(e,n){var r=this;return this.rs.us(e,n).next(function(t){return r.hs(e,n,t)})},Ea.prototype.hs=function(t,r,i){return this.ss.Jn(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].pn(r,t);return t})},Ea.prototype.ls=function(t,e,i){var o=ji;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].pn(t,e);o=o.Tt(t,e)}),o},Ea.prototype._s=function(e,t){var n=this;return this.ss.getEntries(e,t).next(function(t){return n.fs(e,t)})},Ea.prototype.fs=function(e,r){var i=this;return this.rs.ds(e,r).next(function(t){var t=i.ls(e,r,t),n=ji;return t.forEach(function(t,e){e=e||new au(t,ri.min()),n=n.Tt(t,e)}),n})},Ea.prototype.ws=function(t,e,n){return r=e,ui.ot(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Es(t,e.path):bu(e)?this.Ts(t,e,n):this.Is(t,e,n);var r},Ea.prototype.Es=function(t,e){return this.cs(t,new ui(e)).next(function(t){var e=Bi;return t instanceof uu&&(e=e.Tt(t.key,t)),e})},Ea.prototype.Ts=function(n,r,i){var o=this,s=r.collectionGroup,u=Bi;return this.os.As(n,s).next(function(t){return aa.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new hu(t,null,e.Tn.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.Is(n,e,i).next(function(t){t.forEach(function(t,e){u=u.Tt(t,e)})})}).next(function(){return u})})},Ea.prototype.Is=function(e,n,t){var c,h,r=this;return this.ss.ws(e,n,t).next(function(t){return c=t,r.rs.Rs(e,n)}).next(function(t){return h=t,r.Ps(e,h,c).next(function(t){c=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),a=Cs(s,a,a,r.gn);c=a instanceof uu?c.Tt(u,a):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){Ou(n,e)||(c=c.remove(t))}),c})},Ea.prototype.Ps=function(t,e,n){for(var r=Ki(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof qs&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.ss.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof uu&&(c=c.Tt(t,e))}),c})},Ea),wa=(Ia.Vs=function(t,e){for(var n=Ki(),r=Ki(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Ia(t,e.fromCache,n,r)},Ia),ba=(_a.prototype.vs=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},_a.prototype.next=function(){var t=++this.previousValue;return this.bs&&this.bs(t),t},_a);function _a(t,e){var n=this;this.previousValue=t,e&&(e.ps=function(t){return n.vs(t)},this.bs=function(t){return e.Ss(t)})}function Ia(t,e,n,r){this.targetId=t,this.fromCache=e,this.gs=n,this.ys=r}function Ea(t,e,n){this.ss=t,this.rs=e,this.os=n}function Ta(){this.ts=[]}ba.Ds=-1;var Na,Aa=(Ra.prototype.reset=function(){this.Ms=0},Ra.prototype.Ls=function(){this.Ms=this.Os},Ra.prototype.Bs=function(t){var e=this;this.cancel();var n=Math.floor(this.Ms+this.qs()),r=Math.max(0,Date.now()-this.$s),i=Math.max(0,n-r);0<i&&xr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Ms+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.ks=this.Cs.Us(this.Ns,i,function(){return e.$s=Date.now(),t()}),this.Ms*=this.Fs,this.Ms<this.xs&&(this.Ms=this.xs),this.Ms>this.Os&&(this.Ms=this.Os)},Ra.prototype.Qs=function(){null!==this.ks&&(this.ks.Ks(),this.ks=null)},Ra.prototype.cancel=function(){null!==this.ks&&(this.ks.cancel(),this.ks=null)},Ra.prototype.qs=function(){return(Math.random()-.5)*this.Ms},Ra),Oa=(Pa.delete=function(t){return xr("SimpleDb","Removing database:",t),ja(window.indexedDB.deleteDatabase(t)).Ln()},Pa.Gs=function(){if("undefined"==typeof indexedDB)return!1;if(Pa.zs())return!0;var t=p(),e=Pa.js(t),n=0<e&&e<10,e=Pa.Hs(t),e=0<e&&e<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||e)},Pa.zs=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Js)},Pa.Ys=function(t,e){return t.store(e)},Pa.js=function(t){t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),t=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(t)},Pa.Hs=function(t){t=t.match(/Android ([\d.]+)/i),t=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(t)},Pa.prototype.Xs=function(o){return y(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(xr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(t){t=t.target.result;e(t)},r.onblocked=function(){n(new Da(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){t=t.target.error;"VersionError"===t.name?n(new jr(Ur.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new Da(o,t))},r.onupgradeneeded=function(t){xr("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;i.Ws.createOrUpgrade(e,r.transaction,t.oldVersion,i.version).next(function(){xr("SimpleDb","Database upgrade to version "+i.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.Zs&&(this.db.onversionchange=function(t){return i.Zs(t)}),this.db)]}})})},Pa.prototype.ti=function(e){this.Zs=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},Pa.prototype.runTransaction=function(u,n,a,c){return y(this,void 0,void 0,function(){var i,o,s,e;return v(this,function(t){switch(t.label){case 0:i="readonly"===n,o=0,e=function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.Xs(u)];case 2:return s.db=t.sent(),e=La.open(s.db,u,i?"readonly":"readwrite",a),n=c(e).catch(function(t){return e.abort(t),aa.reject(t)}).Ln(),r={},n.catch(function(){}),[4,e.ei];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return n=t.sent(),r="FirebaseError"!==n.name&&o<3,xr("SimpleDb","Transaction failed with error:",n.message,"Retrying:",r),s.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},s=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(e=t.sent()))return[2,e.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},Pa.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},Pa),Sa=(Object.defineProperty(ka.prototype,"On",{get:function(){return this.si},enumerable:!1,configurable:!0}),Object.defineProperty(ka.prototype,"ri",{get:function(){return this.ii},enumerable:!1,configurable:!0}),Object.defineProperty(ka.prototype,"cursor",{set:function(t){this.ni=t},enumerable:!1,configurable:!0}),ka.prototype.done=function(){this.si=!0},ka.prototype.oi=function(t){this.ii=t},ka.prototype.delete=function(){return ja(this.ni.delete())},ka),Da=(n(xa,Na=jr),xa);function xa(t,e){var n=this;return(n=Na.call(this,Ur.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function ka(t){this.ni=t,this.si=!1,this.ii=null}function Pa(t,e,n){this.name=t,this.version=e,this.Ws=n,12.2===Pa.js(p())&&kr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function Ra(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Cs=t,this.Ns=e,this.xs=n,this.Fs=r,this.Os=i,this.Ms=0,this.ks=null,this.$s=Date.now(),this.reset()}function Ca(t){return"IndexedDbTransactionError"===t.name}var La=(Ua.open=function(t,e,n,r){try{return new Ua(e,t.transaction(r,n))}catch(t){throw new Da(e,t)}},Object.defineProperty(Ua.prototype,"ei",{get:function(){return this.ci.promise},enumerable:!1,configurable:!0}),Ua.prototype.abort=function(t){t&&this.ci.reject(t),this.aborted||(xr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Ua.prototype.store=function(t){t=this.transaction.objectStore(t);return new Va(t)},Ua),Va=(Ma.prototype.put=function(t,e){t=void 0!==e?(xr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(xr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t));return ja(t)},Ma.prototype.add=function(t){return xr("SimpleDb","ADD",this.store.name,t,t),ja(this.store.add(t))},Ma.prototype.get=function(e){var n=this;return ja(this.store.get(e)).next(function(t){return void 0===t&&(t=null),xr("SimpleDb","GET",n.store.name,e,t),t})},Ma.prototype.delete=function(t){return xr("SimpleDb","DELETE",this.store.name,t),ja(this.store.delete(t))},Ma.prototype.count=function(){return xr("SimpleDb","COUNT",this.store.name),ja(this.store.count())},Ma.prototype.ui=function(t,e){var e=this.cursor(this.options(t,e)),n=[];return this.ai(e,function(t,e){n.push(e)}).next(function(){return n})},Ma.prototype.hi=function(t,e){xr("SimpleDb","DELETE ALL",this.store.name);e=this.options(t,e);e.li=!1;e=this.cursor(e);return this.ai(e,function(t,e,n){return n.delete()})},Ma.prototype._i=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.ai(n,e)},Ma.prototype.fi=function(r){var t=this.cursor({});return new aa(function(n,e){t.onerror=function(t){t=Fa(t.target.error);e(t)},t.onsuccess=function(t){var e=t.target.result;e?r(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},Ma.prototype.ai=function(t,i){var o=[];return new aa(function(r,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n=t.target.result;n?(e=new Sa(n),(t=i(n.primaryKey,n.value,e))instanceof aa&&(t=t.catch(function(t){return e.done(),aa.reject(t)}),o.push(t)),e.On?r():null===e.ri?n.continue():n.continue(e.ri)):r()}}).next(function(){return aa.qn(o)})},Ma.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},Ma.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.li?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},Ma);function Ma(t){this.store=t}function Ua(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.ci=new ca,this.transaction.oncomplete=function(){n.ci.resolve()},this.transaction.onabort=function(){t.error?n.ci.reject(new Da(e,t.error)):n.ci.resolve()},this.transaction.onerror=function(t){t=Fa(t.target.error);n.ci.reject(new Da(e,t))}}function ja(t){return new aa(function(e,n){t.onsuccess=function(t){t=t.target.result;e(t)},t.onerror=function(t){t=Fa(t.target.error);n(t)}})}var qa=!1;function Fa(t){var e=Oa.js(p());if(12.2<=e&&e<13){e="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(e)){var n=new jr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return qa||(qa=!0,setTimeout(function(){throw n},0)),n}}return t}function Ba(){return"undefined"!=typeof window?window:null}function za(){return"undefined"!=typeof document?document:null}var Ga=(Ha.Ii=function(t,e,n,r,i){i=new Ha(t,e,Date.now()+n,r,i);return i.start(n),i},Ha.prototype.start=function(t){var e=this;this.mi=setTimeout(function(){return e.Ai()},t)},Ha.prototype.Ks=function(){return this.Ai()},Ha.prototype.cancel=function(t){null!==this.mi&&(this.clearTimeout(),this.Ti.reject(new jr(Ur.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Ha.prototype.Ai=function(){var e=this;this.di.Ri(function(){return null!==e.mi?(e.clearTimeout(),e.op().then(function(t){return e.Ti.resolve(t)})):Promise.resolve()})},Ha.prototype.clearTimeout=function(){null!==this.mi&&(this.Ei(this),clearTimeout(this.mi),this.mi=null)},Ha),Ka=(Object.defineProperty(Wa.prototype,"Ci",{get:function(){return this.yi},enumerable:!1,configurable:!0}),Wa.prototype.Ri=function(t){this.enqueue(t)},Wa.prototype.Ni=function(t){this.xi(),this.Fi(t)},Wa.prototype.Oi=function(){var t;this.yi||(this.yi=!0,(t=za())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Di))},Wa.prototype.enqueue=function(t){return this.xi(),this.yi?new Promise(function(t){}):this.Fi(t)},Wa.prototype.Mi=function(t){var e=this;this.Ri(function(){return e.gi.push(t),e.ki()})},Wa.prototype.ki=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.gi.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.gi[0]()];case 2:return t.sent(),this.gi.shift(),this.Si.reset(),[3,4];case 3:if(!Ca(e=t.sent()))throw e;return xr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.gi.length&&this.Si.Bs(function(){return n.ki()}),t.label=5;case 5:return[2]}})})},Wa.prototype.Fi=function(t){var r=this,e=this.Pi.then(function(){return r.vi=!0,t().catch(function(t){throw r.pi=t,r.vi=!1,kr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.vi=!1,t})});return this.Pi=e},Wa.prototype.Us=function(t,e,n){var r=this;this.xi(),-1<this.bi.indexOf(t)&&(e=0);n=Ga.Ii(this,t,e,n,function(t){return r.$i(t)});return this.Vi.push(n),n},Wa.prototype.xi=function(){this.pi&&Cr()},Wa.prototype.Li=function(){},Wa.prototype.Bi=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Pi];case 1:t.sent(),t.label=2;case 2:if(e!==this.Pi)return[3,0];t.label=3;case 3:return[2]}})})},Wa.prototype.qi=function(t){for(var e=0,n=this.Vi;e<n.length;e++)if(n[e].Ns===t)return!0;return!1},Wa.prototype.Ui=function(r){var i=this;return this.Bi().then(function(){i.Vi.sort(function(t,e){return t.wi-e.wi});for(var t=0,e=i.Vi;t<e.length;t++){var n=e[t];if(n.Ks(),"all"!==r&&n.Ns===r)break}return i.Bi()})},Wa.prototype.Qi=function(t){this.bi.push(t)},Wa.prototype.$i=function(t){t=this.Vi.indexOf(t);this.Vi.splice(t,1)},Wa);function Wa(){var e=this;this.Pi=Promise.resolve(),this.gi=[],this.yi=!1,this.Vi=[],this.pi=null,this.vi=!1,this.bi=[],this.Si=new Aa(this,"async_queue_retry"),this.Di=function(){var t=za();t&&xr("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Si.Qs()};var t=za();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Di)}function Ha(t,e,n,r,i){this.di=t,this.Ns=e,this.wi=n,this.op=r,this.Ei=i,this.Ti=new ca,this.then=this.Ti.promise.then.bind(this.Ti.promise),this.Ti.promise.catch(function(t){})}function Qa(t,e){if(kr("AsyncQueue",e+": "+t),Ca(t))return new jr(Ur.UNAVAILABLE,e+": "+t);throw t}function Ya(t,e){var n=t[0],r=t[1],t=e[0],e=e[1],t=Jr(n,t);return 0===t?Jr(r,e):t}var Xa=(tc.prototype.ji=function(){return++this.Wi},tc.prototype.Gi=function(t){var e=[t,this.ji()];this.buffer.size<this.Ki?this.buffer=this.buffer.add(e):Ya(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(tc.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),tc),Ja={zi:!1,Hi:0,Ji:0,Yi:0},$a=(Za.er=function(t){return new Za(t,Za.nr,Za.sr)},Za);function Za(t,e,n){this.Xi=t,this.Zi=e,this.tr=n}function tc(t){this.Ki=t,this.buffer=new Mi(Ya),this.Wi=0}$a.nr=10,$a.sr=1e3,$a.ir=new $a(41943040,$a.nr,$a.sr),$a.rr=new $a(-1,0,0);var ec=(ic.prototype.start=function(t){-1!==this.cr.params.Xi&&this.hr(t)},ic.prototype.stop=function(){this.ar&&(this.ar.cancel(),this.ar=null)},Object.defineProperty(ic.prototype,"lr",{get:function(){return null!==this.ar},enumerable:!1,configurable:!0}),ic.prototype.hr=function(n){var t=this,e=this.ur?3e5:6e4;xr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.ar=this.di.Us("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.ar=null,this.ur=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n._r(this.cr)];case 2:return t.sent(),[3,7];case 3:return Ca(e=t.sent())?(xr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Kh(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.hr(n)];case 8:return t.sent(),[2]}})})})},ic),nc=(rc.prototype.wr=function(t,e){return this.dr.Er(t).next(function(t){return Math.floor(e/100*t)})},rc.prototype.Tr=function(t,e){var n=this;if(0===e)return aa.resolve(ba.Ds);var r=new Xa(e);return this.dr.Ue(t,function(t){return r.Gi(t.sequenceNumber)}).next(function(){return n.dr.Ir(t,function(t){return r.Gi(t)})}).next(function(){return r.maxValue})},rc.prototype.mr=function(t,e,n){return this.dr.mr(t,e,n)},rc.prototype.Ar=function(t,e){return this.dr.Ar(t,e)},rc.prototype.Rr=function(e,n){var r=this;return-1===this.params.Xi?(xr("LruGarbageCollector","Garbage collection skipped; disabled"),aa.resolve(Ja)):this.Pr(e).next(function(t){return t<r.params.Xi?(xr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.Xi),Ja):r.gr(e,n)})},rc.prototype.Pr=function(t){return this.dr.Pr(t)},rc.prototype.gr=function(e,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.wr(e,this.params.Zi).next(function(t){return i=t>h.params.tr?(xr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.tr+" from "+t),h.params.tr):t,s=Date.now(),h.Tr(e,i)}).next(function(t){return r=t,u=Date.now(),h.mr(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.Ar(e,r)}).next(function(t){return c=Date.now(),Dr()<=l.DEBUG&&xr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),aa.resolve({zi:!0,Hi:i,Ji:o,Yi:t})})},rc);function rc(t,e){this.dr=t,this.params=e}function ic(t,e){this.cr=t,this.di=e,this.ur=!1,this.ar=null}function oc(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=sc(e)),e=function(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}(t.get(n),e);return sc(e)}function sc(t){return t+"\x01\x01"}function uc(t){var e=t.length;if(Lr(2<=e),2===e)return Lr("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),ii.X();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||n<s)&&Cr(),t.charAt(s+1)){case"\x01":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:Cr()}o=s+2}return new ii(r)}var ac=function(t){this.yr=t};function cc(t,e){if(e.document)return n=t.yr,r=e.document,i=!!e.hasCommittedMutations,t=Wo(n,r.name),n=Bo(r.updateTime),r=new $s({mapValue:{fields:r.fields}}),new uu(t,n,r,{hasCommittedMutations:!!i});var n,r;if(e.noDocument){var i=ui.ct(e.noDocument.path),o=dc(e.noDocument.readTime);return new au(i,o,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){o=ui.ct(e.unknownDocument.path),e=dc(e.unknownDocument.version);return new cu(o,e)}return Cr()}function hc(t,e,n){var r=fc(n),n=e.key.path.q().H();if(e instanceof uu){var i={name:Ko(i=t.yr,(o=e).key),fields:o.En().mapValue.fields,updateTime:qo(i,o.version.M())},o=e.hasCommittedMutations;return new Yc(null,null,i,o,r,n)}if(e instanceof au){var i=e.key.path.H(),o=pc(e.version),s=e.hasCommittedMutations;return new Yc(null,new Hc(i,o),null,s,r,n)}if(e instanceof cu){s=e.key.path.H(),e=pc(e.version);return new Yc(new Qc(s,e),null,null,!0,r,n)}return Cr()}function fc(t){t=t.M();return[t.seconds,t.nanoseconds]}function lc(t){t=new ni(t[0],t[1]);return ri.N(t)}function pc(t){t=t.M();return new Uc(t.seconds,t.nanoseconds)}function dc(t){t=new ni(t.seconds,t.nanoseconds);return ri.N(t)}function yc(e,t){var n=(t.baseMutations||[]).map(function(t){return Zo(e.yr,t)}),r=t.mutations.map(function(t){return Zo(e.yr,t)}),i=ni.fromMillis(t.localWriteTimeMs);return new oa(t.batchId,i,n,r)}function vc(t){var e=dc(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?dc(t.lastLimboFreeSnapshotVersion):ri.min(),r=void 0!==t.query.documents?(Lr(1===(r=t.query).documents.length),Iu(yu(Qo(r.documents[0])))):Iu(ns(t.query));return new Ai(r,t.targetId,0,t.lastListenSequenceNumber,e,n,Ii.fromBase64String(t.resumeToken))}function gc(t,e){var n=pc(e.ft),r=pc(e.lastLimboFreeSnapshotVersion),i=(_i(e.target)?ts:es)(t.yr,e.target),t=e.resumeToken.toBase64();return new Jc(e.targetId,wi(e.target),n,t,e.sequenceNumber,r,i)}function mc(t){var e=ns({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Eu(e,e.limit,"L"):e}var wc=(bc.vr=function(t,e,n,r){return Lr(""!==t.uid),new bc(t.u()?t.uid:"",e,n,r)},bc.prototype.br=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ec(t)._i({index:Gc.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},bc.prototype.Sr=function(d,y,v,g){var m=this,w=Tc(d),b=Ec(d);return b.add({}).next(function(t){Lr("number"==typeof t);for(var e,n,r,i,o,s=new oa(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return $o(e.yr,t)}),o=r.mutations.map(function(t){return $o(e.yr,t)}),new Gc(n,r.batchId,r.gn.toMillis(),i,o)),a=[],c=new Mi(function(t,e){return Jr(t.J(),e.J())}),h=0,f=g;h<f.length;h++){var l=f[h],p=Kc.key(m.userId,l.key.path,t),c=c.add(l.key.path.q());a.push(b.put(u)),a.push(w.put(p,Kc.PLACEHOLDER))}return c.forEach(function(t){a.push(m.os.Dr(d,t))}),d.es(function(){m.pr[t]=s.keys()}),aa.qn(a).next(function(){return s})})},bc.prototype.Cr=function(t,e){var n=this;return Ec(t).get(e).next(function(t){return t?(Lr(t.userId===n.userId),yc(n.serializer,t)):null})},bc.prototype.Nr=function(t,e){var n=this;return this.pr[e]?aa.resolve(this.pr[e]):this.Cr(t,e).next(function(t){if(t){t=t.keys();return n.pr[e]=t}return null})},bc.prototype.Fr=function(t,e){var r=this,i=e+1,e=IDBKeyRange.lowerBound([this.userId,i]),o=null;return Ec(t)._i({index:Gc.userMutationsIndex,range:e},function(t,e,n){e.userId===r.userId&&(Lr(e.batchId>=i),o=yc(r.serializer,e)),n.done()}).next(function(){return o})},bc.prototype.Or=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Ec(t)._i({index:Gc.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},bc.prototype.Mr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ec(t).ui(Gc.userMutationsIndex,n).next(function(t){return t.map(function(t){return yc(e.serializer,t)})})},bc.prototype.us=function(o,s){var u=this,t=Kc.prefixForPath(this.userId,s.path),t=IDBKeyRange.lowerBound(t),a=[];return Tc(o)._i({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=uc(i);if(r===u.userId&&s.path.isEqual(i))return Ec(o).get(t).next(function(t){if(!t)throw Cr();Lr(t.userId===u.userId),a.push(yc(u.serializer,t))});n.done()}).next(function(){return a})},bc.prototype.ds=function(e,t){var s=this,u=new Mi(Jr),n=[];return t.forEach(function(o){var t=Kc.prefixForPath(s.userId,o.path),t=IDBKeyRange.lowerBound(t),t=Tc(e)._i({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=uc(i);r===s.userId&&o.path.isEqual(i)?u=u.add(t):n.done()});n.push(t)}),aa.qn(n).next(function(){return s.kr(e,u)})},bc.prototype.Rs=function(t,e){var o=this,s=e.path,u=s.length+1,e=Kc.prefixForPath(this.userId,s),e=IDBKeyRange.lowerBound(e),a=new Mi(Jr);return Tc(t)._i({range:e},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=uc(i);r===o.userId&&s.j(i)?i.length===u&&(a=a.add(t)):n.done()}).next(function(){return o.kr(t,a)})},bc.prototype.kr=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(Ec(e).get(t).next(function(t){if(null===t)throw Cr();Lr(t.userId===n.userId),r.push(yc(n.serializer,t))}))}),aa.qn(i).next(function(){return r})},bc.prototype.$r=function(e,n){var r=this;return Ic(e.Lr,this.userId,n).next(function(t){return e.es(function(){r.Br(n.batchId)}),aa.forEach(t,function(t){return r.Vr.qr(e,t)})})},bc.prototype.Br=function(t){delete this.pr[t]},bc.prototype.Ur=function(e){var i=this;return this.br(e).next(function(t){if(!t)return aa.resolve();var t=IDBKeyRange.lowerBound(Kc.prefixForUser(i.userId)),r=[];return Tc(e)._i({range:t},function(t,e,n){t[0]===i.userId?(t=uc(t[1]),r.push(t)):n.done()}).next(function(){Lr(0===r.length)})})},bc.prototype.Qr=function(t,e){return _c(t,this.userId,e)},bc.prototype.Kr=function(t){var e=this;return Nc(t).get(this.userId).next(function(t){return t||new zc(e.userId,-1,"")})},bc);function bc(t,e,n,r){this.userId=t,this.serializer=e,this.os=n,this.Vr=r,this.pr={}}function _c(t,o,e){var e=Kc.prefixForPath(o,e.path),s=e[1],e=IDBKeyRange.lowerBound(e),u=!1;return Tc(t)._i({range:e,li:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function Ic(t,e,n){var r=t.store(Gc.store),i=t.store(Kc.store),o=[],t=IDBKeyRange.only(n.batchId),s=0,t=r._i({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){Lr(1===s)}));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],f=Kc.key(e,h.key.path,n.batchId);o.push(i.delete(f)),u.push(h.key)}return aa.qn(o).next(function(){return u})}function Ec(t){return Eh.Ys(t,Gc.store)}function Tc(t){return Eh.Ys(t,Kc.store)}function Nc(t){return Eh.Ys(t,zc.store)}var Ac,Oc=(xc.prototype.jn=function(t,e,n){return Pc(t).put(Rc(e),n)},xc.prototype.Hn=function(t,e){t=Pc(t),e=Rc(e);return t.delete(e)},xc.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.Wr(e,t)})},xc.prototype.Jn=function(t,e){var n=this;return Pc(t).get(Rc(e)).next(function(t){return n.jr(t)})},xc.prototype.Gr=function(t,e){var n=this;return Pc(t).get(Rc(e)).next(function(t){var e=n.jr(t);return e?{zn:e,size:Cc(t)}:null})},xc.prototype.getEntries=function(t,e){var n=this,r=ji;return this.zr(t,e,function(t,e){e=n.jr(e);r=r.Tt(t,e)}).next(function(){return r})},xc.prototype.Hr=function(t,e){var r=this,i=ji,o=new xi(ui.$);return this.zr(t,e,function(t,e){var n=r.jr(e);o=n?(i=i.Tt(t,n),o.Tt(t,Cc(e))):(i=i.Tt(t,null),o.Tt(t,0))}).next(function(){return{Jr:i,Yr:o}})},xc.prototype.zr=function(t,e,i){if(e.W())return aa.resolve();var n=IDBKeyRange.bound(e.first().path.H(),e.last().path.H()),o=e.yt(),s=o.Ct();return Pc(t)._i({range:n},function(t,e,n){for(var r=ui.ct(t);s&&ui.$(s,r)<0;)i(s,null),s=o.Ct();s&&s.isEqual(r)&&(i(s,e),s=o.Nt()?o.Ct():null),s?n.oi(s.path.H()):n.done()}).next(function(){for(;s;)i(s,null),s=o.Nt()?o.Ct():null})},xc.prototype.ws=function(t,r,e){var n,i=this,o=Bi,s=r.path.length+1,u={};return e.isEqual(ri.min())?(n=r.path.H(),u.range=IDBKeyRange.lowerBound(n)):(n=r.path.H(),e=fc(e),u.range=IDBKeyRange.lowerBound([n,e],!0),u.index=Yc.collectionReadTimeIndex),Pc(t)._i(u,function(t,e,n){t.length===s&&(e=cc(i.serializer,e),r.path.j(e.key.path)?e instanceof uu&&Ou(r,e)&&(o=o.Tt(e.key,e)):n.done())}).next(function(){return o})},xc.prototype.Xr=function(t){return new Sc(this,!!t&&t.Zr)},xc.prototype.eo=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},xc.prototype.getMetadata=function(t){return kc(t).get(Xc.key).next(function(t){return Lr(!!t),t})},xc.prototype.Wr=function(t,e){return kc(t).put(Xc.key,e)},xc.prototype.jr=function(t){if(t){t=cc(this.serializer,t);return t instanceof au&&t.version.isEqual(ri.min())?null:t}return null},xc),Sc=(n(Dc,Ac=h),Dc.prototype.Zn=function(i){var o=this,s=[],u=0,a=new Mi(function(t,e){return Jr(t.J(),e.J())});return this.Qn.forEach(function(t,e){var n,r=o.so.get(t);e.zn?(n=hc(o.no.serializer,e.zn,o.Wn(t)),a=a.add(t.path.q()),e=Cc(n),u+=e-r,s.push(o.no.jn(i,t,n))):(u-=r,o.Zr?(r=hc(o.no.serializer,new au(t,ri.min()),o.Wn(t)),s.push(o.no.jn(i,t,r))):s.push(o.no.Hn(i,t)))}),a.forEach(function(t){s.push(o.no.os.Dr(i,t))}),s.push(this.no.updateMetadata(i,u)),aa.qn(s)},Dc.prototype.Yn=function(t,e){var n=this;return this.no.Gr(t,e).next(function(t){return null===t?(n.so.set(e,0),null):(n.so.set(e,t.size),t.zn)})},Dc.prototype.Xn=function(t,e){var n=this;return this.no.Hr(t,e).next(function(t){var e=t.Jr;return t.Yr.forEach(function(t,e){n.so.set(t,e)}),e})},Dc);function Dc(t,e){var n=this;return(n=Ac.call(this)||this).no=t,n.Zr=e,n.so=new ua(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function xc(t,e){this.serializer=t,this.os=e}function kc(t){return Eh.Ys(t,Xc.store)}function Pc(t){return Eh.Ys(t,Yc.store)}function Rc(t){return t.path.H()}function Cc(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Cr();e=t.noDocument}return JSON.stringify(e).length}var Lc=(Bc.prototype.Dr=function(t,e){return this.io.add(e),aa.resolve()},Bc.prototype.As=function(t,e){return aa.resolve(this.io.getEntries(e))},Bc),Vc=(Fc.prototype.add=function(t){var e=t.K(),n=t.q(),r=this.index[e]||new Mi(ii.$),t=!r.has(n);return this.index[e]=r.add(n),t},Fc.prototype.has=function(t){var e=t.K(),t=t.q(),e=this.index[e];return e&&e.has(t)},Fc.prototype.getEntries=function(t){return(this.index[t]||new Mi(ii.$)).H()},Fc),Mc=(qc.prototype.createOrUpgrade=function(e,n,t,r){var i=this;Lr(t<r&&0<=t&&r<=11);var o=new La("createOrUpgrade",n);t<1&&1<=r&&(e.createObjectStore(jc.store),(s=e).createObjectStore(zc.store,{keyPath:zc.keyPath}),s.createObjectStore(Gc.store,{keyPath:Gc.keyPath,autoIncrement:!0}).createIndex(Gc.userMutationsIndex,Gc.userMutationsKeyPath,{unique:!0}),s.createObjectStore(Kc.store),eh(e),e.createObjectStore(Yc.store));var s,u=aa.resolve();return t<3&&3<=r&&(0!==t&&((s=e).deleteObjectStore($c.store),s.deleteObjectStore(Jc.store),s.deleteObjectStore(Zc.store),eh(e)),u=u.next(function(){return t=o.store(Zc.store),e=new Zc(0,0,ri.min().M(),0),t.put(Zc.key,e);var t,e})),t<4&&4<=r&&(0!==t&&(u=u.next(function(){return n=e,(r=o).store(Gc.store).ui().next(function(t){n.deleteObjectStore(Gc.store),n.createObjectStore(Gc.store,{keyPath:Gc.keyPath,autoIncrement:!0}).createIndex(Gc.userMutationsIndex,Gc.userMutationsKeyPath,{unique:!0});var e=r.store(Gc.store),t=t.map(function(t){return e.put(t)});return aa.qn(t)});var n,r})),u=u.next(function(){e.createObjectStore(nh.store,{keyPath:nh.keyPath})})),t<5&&5<=r&&(u=u.next(function(){return i.removeAcknowledgedMutations(o)})),t<6&&6<=r&&(u=u.next(function(){return e.createObjectStore(Xc.store),i.addDocumentGlobal(o)})),t<7&&7<=r&&(u=u.next(function(){return i.ensureSequenceNumbers(o)})),t<8&&8<=r&&(u=u.next(function(){return i.createCollectionParentIndex(e,o)})),t<9&&9<=r&&(u=u.next(function(){var t;(t=e).objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(t=n.objectStore(Yc.store)).createIndex(Yc.readTimeIndex,Yc.readTimeIndexPath,{unique:!1}),t.createIndex(Yc.collectionReadTimeIndex,Yc.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=r&&(u=u.next(function(){return i.rewriteCanonicalIds(o)})),t<11&&11<=r&&(u=u.next(function(){e.createObjectStore(rh.store,{keyPath:rh.keyPath}),e.createObjectStore(ih.store,{keyPath:ih.keyPath})})),u},qc.prototype.addDocumentGlobal=function(e){var n=0;return e.store(Yc.store)._i(function(t,e){n+=Cc(e)}).next(function(){var t=new Xc(n);return e.store(Xc.store).put(Xc.key,t)})},qc.prototype.removeAcknowledgedMutations=function(n){var r=this,t=n.store(zc.store),i=n.store(Gc.store);return t.ui().next(function(t){return aa.forEach(t,function(e){var t=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return i.ui(Gc.userMutationsIndex,t).next(function(t){return aa.forEach(t,function(t){Lr(t.userId===e.userId);t=yc(r.serializer,t);return Ic(n,e.userId,t).next(function(){})})})})})},qc.prototype.ensureSequenceNumbers=function(t){var o=t.store($c.store),e=t.store(Yc.store);return t.store(Zc.store).get(Zc.key).next(function(r){var i=[];return e._i(function(t,e){var n=new ii(t),t=[0,oc(n)];i.push(o.get(t).next(function(t){return t?aa.resolve():o.put(new $c(0,oc(n),r.highestListenSequenceNumber))}))}).next(function(){return aa.qn(i)})})},qc.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(th.store,{keyPath:th.keyPath});function r(t){if(i.add(t)){var e=t.K(),t=t.q();return n.put({collectionId:e,parent:oc(t)})}}var n=e.store(th.store),i=new Vc;return e.store(Yc.store)._i({li:!0},function(t,e){t=new ii(t);return r(t.q())}).next(function(){return e.store(Kc.store)._i({li:!0},function(t,e){t[0];var n=t[1],n=(t[2],uc(n));return r(n.q())})})},qc.prototype.rewriteCanonicalIds=function(t){var n=this,r=t.store(Jc.store);return r._i(function(t,e){e=vc(e),e=gc(n.serializer,e);return r.put(e)})},qc),Uc=function(t,e){this.seconds=t,this.nanoseconds=e},jc=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function qc(t){this.serializer=t}function Fc(){this.index={}}function Bc(){this.io=new Vc}jc.store="owner",jc.key="owner";var zc=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};zc.store="mutationQueues",zc.keyPath="userId";var Gc=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Gc.store="mutations",Gc.keyPath="batchId",Gc.userMutationsIndex="userMutationsIndex",Gc.userMutationsKeyPath=["userId","batchId"];var Kc=(Wc.prefixForUser=function(t){return[t]},Wc.prefixForPath=function(t,e){return[t,oc(e)]},Wc.key=function(t,e,n){return[t,oc(e),n]},Wc);function Wc(){}Kc.store="documentMutations",Kc.PLACEHOLDER=new Kc;var Hc=function(t,e){this.path=t,this.readTime=e},Qc=function(t,e){this.path=t,this.version=e},Yc=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Yc.store="remoteDocuments",Yc.readTimeIndex="readTimeIndex",Yc.readTimeIndexPath="readTime",Yc.collectionReadTimeIndex="collectionReadTimeIndex",Yc.collectionReadTimeIndexPath=["parentPath","readTime"];var Xc=function(t){this.byteSize=t};Xc.store="remoteDocumentGlobal",Xc.key="remoteDocumentGlobalKey";var Jc=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Jc.store="targets",Jc.keyPath="targetId",Jc.queryTargetsIndexName="queryTargetsIndex",Jc.queryTargetsKeyPath=["canonicalId","targetId"];var $c=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};$c.store="targetDocuments",$c.keyPath=["targetId","path"],$c.documentTargetsIndex="documentTargetsIndex",$c.documentTargetsKeyPath=["path","targetId"];var Zc=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Zc.key="targetGlobalKey",Zc.store="targetGlobal";var th=function(t,e){this.collectionId=t,this.parent=e};function eh(t){t.createObjectStore($c.store,{keyPath:$c.keyPath}).createIndex($c.documentTargetsIndex,$c.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Jc.store,{keyPath:Jc.keyPath}).createIndex(Jc.queryTargetsIndexName,Jc.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Zc.store)}th.store="collectionParents",th.keyPath=["collectionId","parent"];var nh=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};nh.store="clientMetadata",nh.keyPath="clientId";var rh=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};rh.store="bundles",rh.keyPath="bundleId";var ih=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};ih.store="namedQueries",ih.keyPath="name";var oh=s(s(s(s([zc.store,Gc.store,Kc.store,Yc.store,Jc.store,jc.store,Zc.store,$c.store],[nh.store]),[Xc.store]),[th.store]),[rh.store,ih.store]),sh=(uh.prototype.ro=function(t,e){return ah(t).get(e).next(function(t){if(t)return{id:(t=t).bundleId,createTime:dc(t.createTime),version:t.version}})},uh.prototype.oo=function(t,e){return ah(t).put({bundleId:(e=e).id,createTime:pc(Bo(e.createTime)),version:e.version})},uh.prototype.co=function(t,e){return ch(t).get(e).next(function(t){if(t)return{name:(t=t).name,query:mc(t.bundledQuery),readTime:dc(t.readTime)}})},uh.prototype.uo=function(t,e){return ch(t).put({name:(e=e).name,readTime:pc(Bo(e.readTime)),bundledQuery:e.bundledQuery})},uh);function uh(t){this.serializer=t}function ah(t){return Eh.Ys(t,rh.store)}function ch(t){return Eh.Ys(t,ih.store)}var hh=(fh.prototype.Dr=function(t,e){var n=this;if(this.ao.has(e))return aa.resolve();var r=e.K(),i=e.q();t.es(function(){n.ao.add(e)});i={collectionId:r,parent:oc(i)};return lh(t).put(i)},fh.prototype.As=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Zr(i),""],!1,!0);return lh(t).ui(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(uc(r.parent))}return o})},fh);function fh(){this.ao=new Vc}function lh(t){return Eh.Ys(t,th.store)}var ph=(vh.prototype.next=function(){return this.ho+=2,this.ho},vh.lo=function(){return new vh(0)},vh._o=function(){return new vh(-1)},vh),dh=(yh.prototype.fo=function(n){var r=this;return this.wo(n).next(function(t){var e=new ph(t.highestTargetId);return t.highestTargetId=e.next(),r.Eo(n,t).next(function(){return t.highestTargetId})})},yh.prototype.To=function(t){return this.wo(t).next(function(t){return ri.N(new ni(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},yh.prototype.Io=function(t){return this.wo(t).next(function(t){return t.highestListenSequenceNumber})},yh.prototype.mo=function(e,n,r){var i=this;return this.wo(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.M()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.Eo(e,t)})},yh.prototype.Ao=function(e,n){var r=this;return this.Ro(e,n).next(function(){return r.wo(e).next(function(t){return t.targetCount+=1,r.Po(n,t),r.Eo(e,t)})})},yh.prototype.yo=function(t,e){return this.Ro(t,e)},yh.prototype.Vo=function(e,t){var n=this;return this.po(e,t.targetId).next(function(){return gh(e).delete(t.targetId)}).next(function(){return n.wo(e)}).next(function(t){return Lr(0<t.targetCount),--t.targetCount,n.Eo(e,t)})},yh.prototype.mr=function(n,r,i){var o=this,s=0,u=[];return gh(n)._i(function(t,e){e=vc(e);e.sequenceNumber<=r&&null===i.get(e.targetId)&&(s++,u.push(o.Vo(n,e)))}).next(function(){return aa.qn(u)}).next(function(){return s})},yh.prototype.Ue=function(t,n){return gh(t)._i(function(t,e){e=vc(e);n(e)})},yh.prototype.wo=function(t){return mh(t).get(Zc.key).next(function(t){return Lr(null!==t),t})},yh.prototype.Eo=function(t,e){return mh(t).put(Zc.key,e)},yh.prototype.Ro=function(t,e){return gh(t).put(gc(this.serializer,e))},yh.prototype.Po=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},yh.prototype.vo=function(t){return this.wo(t).next(function(t){return t.targetCount})},yh.prototype.bo=function(t,r){var e=wi(r),e=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),i=null;return gh(t)._i({range:e,index:Jc.queryTargetsIndexName},function(t,e,n){e=vc(e);bi(r,e.target)&&(i=e,n.done())}).next(function(){return i})},yh.prototype.So=function(n,t,r){var i=this,o=[],s=wh(n);return t.forEach(function(t){var e=oc(t.path);o.push(s.put(new $c(r,e))),o.push(i.Vr.Do(n,r,t))}),aa.qn(o)},yh.prototype.Co=function(n,t,r){var i=this,o=wh(n);return aa.forEach(t,function(t){var e=oc(t.path);return aa.qn([o.delete([r,e]),i.Vr.No(n,r,t)])})},yh.prototype.po=function(t,e){t=wh(t),e=IDBKeyRange.bound([e],[e+1],!1,!0);return t.delete(e)},yh.prototype.xo=function(t,e){var e=IDBKeyRange.bound([e],[e+1],!1,!0),t=wh(t),r=Ki();return t._i({range:e,li:!0},function(t,e,n){t=uc(t[1]),t=new ui(t);r=r.add(t)}).next(function(){return r})},yh.prototype.Qr=function(t,e){var e=oc(e.path),e=IDBKeyRange.bound([e],[Zr(e)],!1,!0),i=0;return wh(t)._i({index:$c.documentTargetsIndex,li:!0,range:e},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},yh.prototype.Ze=function(t,e){return gh(t).get(e).next(function(t){return t?vc(t):null})},yh);function yh(t,e){this.Vr=t,this.serializer=e}function vh(t){this.ho=t}function gh(t){return Eh.Ys(t,Jc.store)}function mh(t){return Eh.Ys(t,Zc.store)}function wh(t){return Eh.Ys(t,$c.store)}var bh,_h="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Ih=(n(Nh,bh=Ie),Nh),Eh=(Th.Ys=function(t,e){if(t instanceof Ih)return Oa.Ys(t.Lr,e);throw Cr()},Th.prototype.start=function(){var e=this;return this.Ho().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new jr(Ur.FAILED_PRECONDITION,_h);return e.Jo(),e.Yo(),e.Xo(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.jo.Io(t)})}).then(function(t){e.ko=new ba(t,e.Oo)}).then(function(){e.$o=!0}).catch(function(t){return e.Wo&&e.Wo.close(),Promise.reject(t)})},Th.prototype.Zo=function(n){var t=this;return this.Qo=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.lr?[2,n(e)]:[2]})})},n(this.isPrimary)},Th.prototype.tc=function(n){var t=this;this.Wo.ti(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},Th.prototype.ec=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Cs.Ri(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.lr?[4,this.Ho()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},Th.prototype.Ho=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return Oh(e).put(new nh(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.nc(e).next(function(t){t||(n.isPrimary=!1,n.Cs.Mi(function(){return n.Qo(!1)}))})}).next(function(){return n.sc(e)}).next(function(t){return n.isPrimary&&!t?n.ic(e).next(function(){return!1}):!!t&&n.rc(e).next(function(){return!0})})}).catch(function(t){if(Ca(t))return xr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return xr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.Cs.Mi(function(){return n.Qo(t)}),n.isPrimary=t})},Th.prototype.nc=function(t){var e=this;return Ah(t).get(jc.key).next(function(t){return aa.resolve(e.oc(t))})},Th.prototype.cc=function(t){return Oh(t).delete(this.clientId)},Th.prototype.uc=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.ac(this.Uo,18e5)?[3,2]:(this.Uo=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=Th.Ys(t,nh.store);return r.ui().next(function(t){var e=o.hc(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return aa.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.zo)for(n=0,r=e;n<r.length;n++)i=r[n],this.zo.removeItem(this.lc(i.clientId));t.label=2;case 2:return[2]}})})},Th.prototype.Xo=function(){var t=this;this.qo=this.Cs.Us("client_metadata_refresh",4e3,function(){return t.Ho().then(function(){return t.uc()}).then(function(){return t.Xo()})})},Th.prototype.oc=function(t){return!!t&&t.ownerId===this.clientId},Th.prototype.sc=function(e){var r=this;return this.Mo?aa.resolve(!0):Ah(e).get(jc.key).next(function(t){if(null!==t&&r.ac(t.leaseTimestampMs,5e3)&&!r._c(t.ownerId)){if(r.oc(t)&&r.networkEnabled)return!0;if(!r.oc(t)){if(!t.allowTabSynchronization)throw new jr(Ur.FAILED_PRECONDITION,_h);return!1}}return!(!r.networkEnabled||!r.inForeground)||Oh(e).ui().next(function(t){return void 0===r.hc(t,5e3).find(function(t){if(r.clientId!==t.clientId){var e=!r.networkEnabled&&t.networkEnabled,n=!r.inForeground&&t.inForeground,t=r.networkEnabled===t.networkEnabled;if(e||n&&t)return!0}return!1})})}).next(function(t){return r.isPrimary!==t&&xr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},Th.prototype.fc=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return this.$o=!1,this.dc(),this.qo&&(this.qo.cancel(),this.qo=null),this.wc(),this.Ec(),[4,this.Wo.runTransaction("shutdown","readwrite",[jc.store,nh.store],function(t){var e=new Ih(t,ba.Ds);return n.ic(e).next(function(){return n.cc(e)})})];case 1:return t.sent(),this.Wo.close(),this.Tc(),[2]}})})},Th.prototype.hc=function(t,e){var n=this;return t.filter(function(t){return n.ac(t.updateTimeMs,e)&&!n._c(t.clientId)})},Th.prototype.Ic=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return Oh(t).ui().next(function(t){return e.hc(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(Th.prototype,"lr",{get:function(){return this.$o},enumerable:!1,configurable:!0}),Th.prototype.mc=function(t){return wc.vr(t,this.serializer,this.os,this.Vr)},Th.prototype.Ac=function(){return this.jo},Th.prototype.Rc=function(){return this.ss},Th.prototype.Pc=function(){return this.os},Th.prototype.gc=function(){return this.Go},Th.prototype.runTransaction=function(e,n,r){var i=this;xr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Wo.runTransaction(e,t,oh,function(t){return o=new Ih(t,i.ko?i.ko.next():ba.Ds),"readwrite-primary"===n?i.nc(o).next(function(t){return!!t||i.sc(o)}).next(function(t){if(!t)throw kr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.Cs.Mi(function(){return i.Qo(!1)}),new jr(Ur.FAILED_PRECONDITION,ga);return r(o)}).next(function(t){return i.rc(o).next(function(){return t})}):i.yc(o).next(function(){return r(o)})}).then(function(t){return o.ns(),t})},Th.prototype.yc=function(t){var e=this;return Ah(t).get(jc.key).next(function(t){if(null!==t&&e.ac(t.leaseTimestampMs,5e3)&&!e._c(t.ownerId)&&!e.oc(t)&&!(e.Mo||e.allowTabSynchronization&&t.allowTabSynchronization))throw new jr(Ur.FAILED_PRECONDITION,_h)})},Th.prototype.rc=function(t){var e=new jc(this.clientId,this.allowTabSynchronization,Date.now());return Ah(t).put(jc.key,e)},Th.Gs=function(){return Oa.Gs()},Th.prototype.ic=function(t){var e=this,n=Ah(t);return n.get(jc.key).next(function(t){return e.oc(t)?(xr("IndexedDbPersistence","Releasing primary lease."),n.delete(jc.key)):aa.resolve()})},Th.prototype.ac=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(kr("Detected an update time that is in the future: "+t+" > "+n),1))},Th.prototype.Jo=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Bo=function(){t.Cs.Ri(function(){return t.inForeground="visible"===t.document.visibilityState,t.Ho()})},this.document.addEventListener("visibilitychange",this.Bo),this.inForeground="visible"===this.document.visibilityState)},Th.prototype.wc=function(){this.Bo&&(this.document.removeEventListener("visibilitychange",this.Bo),this.Bo=null)},Th.prototype.Yo=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Lo=function(){e.dc(),e.Cs.Ri(function(){return e.fc()})},this.window.addEventListener("unload",this.Lo))},Th.prototype.Ec=function(){this.Lo&&(this.window.removeEventListener("unload",this.Lo),this.Lo=null)},Th.prototype._c=function(t){try{var e=null!==(null===(e=this.zo)||void 0===e?void 0:e.getItem(this.lc(t)));return xr("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return kr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},Th.prototype.dc=function(){if(this.zo)try{this.zo.setItem(this.lc(this.clientId),String(Date.now()))}catch(t){kr("Failed to set zombie client id.",t)}},Th.prototype.Tc=function(){if(this.zo)try{this.zo.removeItem(this.lc(this.clientId))}catch(t){}},Th.prototype.lc=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},Th);function Th(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Cs=i,this.window=o,this.document=s,this.Oo=a,this.Mo=c,this.ko=null,this.$o=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Lo=null,this.inForeground=!1,this.Bo=null,this.qo=null,this.Uo=Number.NEGATIVE_INFINITY,this.Qo=function(t){return Promise.resolve()},!Th.Gs())throw new jr(Ur.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Vr=new Sh(this,r),this.Ko=e+"main",this.serializer=new ac(u),this.Wo=new Oa(this.Ko,11,new Mc(this.serializer)),this.jo=new dh(this.Vr,this.serializer),this.os=new hh,this.ss=(e=this.serializer,u=this.os,new Oc(e,u)),this.Go=new sh(this.serializer),this.window&&this.window.localStorage?this.zo=this.window.localStorage:(this.zo=null,!1===c&&kr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function Nh(t,e){var n=this;return(n=bh.call(this)||this).Lr=t,n.Fo=e,n}function Ah(t){return Eh.Ys(t,jc.store)}function Oh(t){return Eh.Ys(t,nh.store)}var Sh=(Dh.prototype.Er=function(t){var n=this.Vc(t);return this.db.Ac().vo(t).next(function(e){return n.next(function(t){return e+t})})},Dh.prototype.Vc=function(t){var e=0;return this.Ir(t,function(t){e++}).next(function(){return e})},Dh.prototype.Ue=function(t,e){return this.db.Ac().Ue(t,e)},Dh.prototype.Ir=function(t,n){return this.vc(t,function(t,e){return n(e)})},Dh.prototype.Do=function(t,e,n){return xh(t,n)},Dh.prototype.No=function(t,e,n){return xh(t,n)},Dh.prototype.mr=function(t,e,n){return this.db.Ac().mr(t,e,n)},Dh.prototype.qr=xh,Dh.prototype.bc=function(t,e){return r=e,i=!1,Nc(n=t).fi(function(t){return _c(n,t,r).next(function(t){return t&&(i=!0),aa.resolve(!t)})}).next(function(){return i});var n,r,i},Dh.prototype.Ar=function(n,r){var i=this,o=this.db.Rc().Xr(),s=[],u=0;return this.vc(n,function(e,t){t<=r&&(t=i.bc(n,e).next(function(t){if(!t)return u++,o.Jn(n,e).next(function(){return o.Hn(e),wh(n).delete([0,oc(e.path)])})}),s.push(t))}).next(function(){return aa.qn(s)}).next(function(){return o.apply(n)}).next(function(){return u})},Dh.prototype.removeTarget=function(t,e){e=e.dt(t.Fo);return this.db.Ac().yo(t,e)},Dh.prototype.Sc=xh,Dh.prototype.vc=function(t,r){var i,t=wh(t),o=ba.Ds;return t._i({index:$c.documentTargetsIndex},function(t,e){var n=t[0],t=(t[1],e.path),e=e.sequenceNumber;0===n?(o!==ba.Ds&&r(new ui(uc(i)),o),o=e,i=t):o=ba.Ds}).next(function(){o!==ba.Ds&&r(new ui(uc(i)),o)})},Dh.prototype.Pr=function(t){return this.db.Rc().eo(t)},Dh);function Dh(t,e){this.db=t,this.cr=new nc(this,e)}function xh(t,e){return wh(t).put((t=t.Fo,new $c(0,oc(e.path),t)))}function kh(t,e){var n=t.projectId;return t.o||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Ph=(Rh.prototype._r=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Rr(t,n.Cc)})},Rh);function Rh(t,e,n,r){this.persistence=t,this.Dc=e,this.serializer=r,this.Cc=new xi(Jr),this.Nc=new ua(wi,bi),this.xc=ri.min(),this.rs=t.mc(n),this.Fc=t.Rc(),this.jo=t.Ac(),this.Oc=new ma(this.Fc,this.rs,this.persistence.Pc()),this.Go=t.gc(),this.Dc.Mc(this.Oc)}function Ch(t,e,n,r){return new Ph(t,e,n,r)}function Lh(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).rs,m=e.Oc,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.rs.Mr(v).next(function(t){return g=t,n=e.persistence.mc(o),m=new ma(e.Fc,n,e.persistence.Pc()),n.Mr(v)}).next(function(t){for(var e=[],n=[],r=Ki(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m._s(v,r).next(function(t){return{kc:t,$c:e,Lc:n}})})})];case 1:return r=t.sent(),[2,(e.rs=n,e.Oc=m,e.Dc.Mc(e.Oc),r)]}})})}function Vh(t,h){var f=t;return f.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=h.batch.keys(),c=f.Fc.Xr({Zr:!0});return e=f,r=t,o=c,s=(i=h).batch,n=s.keys(),u=aa.resolve(),n.forEach(function(n){u=u.next(function(){return o.Jn(r,n)}).next(function(t){var e=t,t=i.Sn.get(n);Lr(null!==t),(!e||e.version.F(t)<0)&&(e=s.yn(n,e,i))&&o.jn(e,i.bn)})}),u.next(function(){return e.rs.$r(r,s)}).next(function(){return c.apply(t)}).next(function(){return f.rs.Ur(t)}).next(function(){return f.Oc._s(t,a)})})}function Mh(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.jo.To(t)})}function Uh(t,o){var h=t,f=o.ft,l=h.Cc;return h.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=h.Fc.Xr({Zr:!0});l=h.Cc;var u=[];o.re.forEach(function(t,e){var n,r,i,o=l.get(e);o&&(u.push(h.jo.Co(s,t.de,e).next(function(){return h.jo.So(s,t._e,e)})),0<(i=t.resumeToken).ht()&&(n=o.wt(i,f).dt(s.Fo),l=l.Tt(e,n),r=o,i=t,Lr(0<(o=n).resumeToken.ht()),(0===r.resumeToken.ht()||3e8<=o.ft.O()-r.ft.O()||0<i._e.size+i.fe.size+i.de.size)&&u.push(h.jo.yo(s,n))))});var e,a,n,c,r,i=ji;return o.ce.forEach(function(t,e){o.ue.has(t)&&u.push(h.persistence.Vr.Sc(s,t))}),u.push((e=s,a=t,n=o.ce,c=f,r=Ki(),n.forEach(function(t){return r=r.add(t)}),a.getEntries(e,r).next(function(i){var o=ji;return n.forEach(function(t,e){var n=i.get(t),r=c;e instanceof au&&e.version.isEqual(ri.min())?(a.Hn(t,r),o=o.Tt(t,e)):null==n||0<e.version.F(n.version)||0===e.version.F(n.version)&&n.hasPendingWrites?(a.jn(e,r),o=o.Tt(t,e)):xr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o}).next(function(t){i=t}))),f.isEqual(ri.min())||(e=h.jo.To(s).next(function(t){return h.jo.mo(s,s.Fo,f)}),u.push(e)),aa.qn(u).next(function(){return t.apply(s)}).next(function(){return h.Oc.fs(s,i)})}).then(function(t){return h.Cc=l,t})}function jh(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.jo.bo(e,r).next(function(t){return t?(n=t,aa.resolve(n)):i.jo.fo(e).next(function(t){return n=new Ai(r,t,0,e.Fo),i.jo.Ao(e,n).next(function(){return n})})})}).then(function(t){var e=i.Cc.get(t.targetId);return(null===e||0<t.ft.F(e.ft))&&(i.Cc=i.Cc.Tt(t.targetId,t),i.Nc.set(r,t.targetId)),t})}function qh(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).Cc.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Vr.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Ca(r=t.sent()))throw r;return xr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.Cc=e.Cc.remove(o),e.Nc.delete(n.target),[2]}})})}function Fh(t,o,s){var u=t,a=ri.min(),c=Ki();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=Iu(o),(void 0!==(t=(i=t).Nc.get(r))?aa.resolve(i.Cc.get(t)):i.jo.bo(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.jo.xo(e,t.targetId).next(function(t){c=t})}).next(function(){return u.Dc.ws(e,o,s?a:ri.min(),s?c:Ki())}).next(function(t){return{documents:t,Bc:c}});var t,n,r,i})}function Bh(t,e){var n=t,r=n.jo,t=n.Cc.get(e);return t?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Ze(t,e).next(function(t){return t?t.target:null})})}function zh(t){var s=t;return s.persistence.runTransaction("Get new document changes","readonly",function(t){return e=s.Fc,n=t,t=s.xc,r=e,i=ji,o=fc(t),t=Pc(n),n=IDBKeyRange.lowerBound(o,!0),t._i({index:Yc.readTimeIndex,range:n},function(t,e){var n=cc(r.serializer,e);i=i.Tt(n.key,n),o=e.readTime}).next(function(){return{qc:i,readTime:lc(o)}});var e,n,r,i,o}).then(function(t){var e=t.qc,t=t.readTime;return s.xc=t,e})}function Gh(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=Pc(t),r=ri.min(),t._i({index:Yc.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=lc(e.readTime)),n.done()}).next(function(){return r});var r}).then(function(t){e.xc=t})]})})}function Kh(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Ur.FAILED_PRECONDITION||e.message!==ga)throw e;return xr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Wh(t,e,n,r,i){var o=this;this.Cu=t,this.Nu=e,this.di=n,this.xu={},this.Fu=[],this.Ou=new Map,this.Mu=new Set,this.ku=[],this.$u=i,this.$u.Lu(function(t){n.Ri(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return df(this)?(xr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Mu.add(4),[4,uf(e)];case 1:return t.sent(),e.Bu.set("Unknown"),e.Mu.delete(4),[4,sf(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Bu=new Zh(n,r)}var Hh,Qh,Yh,Ee=(of.prototype.Gc=function(){return 1===this.state||2===this.state||4===this.state},of.prototype.zc=function(){return 2===this.state},of.prototype.start=function(){3!==this.state?this.auth():this.Hc()},of.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Gc()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},of.prototype.Jc=function(){this.state=0,this.Si.reset()},of.prototype.Yc=function(){var t=this;this.zc()&&null===this.jc&&(this.jc=this.Cs.Us(this.Uc,6e4,function(){return t.Xc()}))},of.prototype.Zc=function(t){this.tu(),this.stream.send(t)},of.prototype.Xc=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.zc()?[2,this.close(0)]:[2]})})},of.prototype.tu=function(){this.jc&&(this.jc.cancel(),this.jc=null)},of.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.tu(),this.Si.cancel(),this.Wc++,3!==e?this.Si.reset():n&&n.code===Ur.RESOURCE_EXHAUSTED?(kr(n.toString()),kr("Using maximum backoff delay to prevent overloading the backend."),this.Si.Ls()):n&&n.code===Ur.UNAUTHENTICATED&&this.Kc.m(),null!==this.stream&&(this.eu(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.nu(n)];case 1:return t.sent(),[2]}})})},of.prototype.eu=function(){},of.prototype.auth=function(){var n=this;this.state=1;var t=this.su(this.Wc),e=this.Wc;this.Kc.getToken().then(function(t){n.Wc===e&&n.iu(t)},function(e){t(function(){var t=new jr(Ur.UNKNOWN,"Fetching auth token failed: "+e.message);return n.ru(t)})})},of.prototype.iu=function(t){var e=this,n=this.su(this.Wc);this.stream=this.ou(t),this.stream.cu(function(){n(function(){return e.state=2,e.listener.cu()})}),this.stream.nu(function(t){n(function(){return e.ru(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},of.prototype.Hc=function(){var t=this;this.state=4,this.Si.Bs(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},of.prototype.ru=function(t){return xr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},of.prototype.su=function(e){var n=this;return function(t){n.Cs.Ri(function(){return n.Wc===e?t():(xr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},of),Xh=(n(rf,Yh=Ee),rf.prototype.ou=function(t){return this.Qc.uu("Listen",t)},rf.prototype.onMessage=function(t){this.Si.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:Cr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.tn?(Lr(void 0===o||"string"==typeof o),Ii.fromBase64String(o||"")):(Lr(void 0===o||o instanceof Uint8Array),Ii.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Ur.UNKNOWN:Di(s.code),new jr(o,s.message||"")),r=new to(n,r,i,s||null)}else if("documentChange"in e){e.documentChange;var u=e.documentChange;u.document,u.document.name,u.document.updateTime;var i=Wo(t,u.document.name),a=Bo(u.document.updateTime),s=new $s({mapValue:{fields:u.document.fields}}),a=new uu(i,a,s,{}),s=u.targetIds||[],u=u.removedTargetIds||[];r=new $i(s,u,a.key,a)}else if("documentDelete"in e){e.documentDelete;u=e.documentDelete;u.document;var a=Wo(t,u.document),c=u.readTime?Bo(u.readTime):ri.min(),c=new au(a,c),u=u.removedTargetIds||[];r=new $i([],u,c.key,c)}else if("documentRemove"in e){e.documentRemove;c=e.documentRemove;c.document;var h=Wo(t,c.document),c=c.removedTargetIds||[];r=new $i([],c,h,null)}else{if(!("filter"in e))return Cr();e.filter;h=e.filter;h.targetId;e=h.count||0,e=new Ti(e),h=h.targetId;r=new Zi(h,e)}return r}(this.serializer,t),t=function(t){if(!("targetChange"in t))return ri.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?Bo(t.readTime):ri.min()}(t);return this.listener.au(e,t)},rf.prototype.hu=function(t){var e,n,r,i={};i.database=Yo(this.serializer),i.addTarget=(e=this.serializer,(r=_i(r=(n=t).target)?{documents:ts(e,r)}:{query:es(e,r)}).targetId=n.targetId,0<n.resumeToken.ht()?r.resumeToken=Fo(e,n.resumeToken):0<n.ft.F(ri.min())&&(r.readTime=qo(e,n.ft.M())),r);var o,t=(this.serializer,o=t,null==(t=function(){switch(o._t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Cr()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.Zc(i)},rf.prototype.lu=function(t){var e={};e.database=Yo(this.serializer),e.removeTarget=t,this.Zc(e)},rf),Jh=(n(nf,Qh=Ee),Object.defineProperty(nf.prototype,"fu",{get:function(){return this._u},enumerable:!1,configurable:!0}),nf.prototype.start=function(){this._u=!1,this.lastStreamToken=void 0,Qh.prototype.start.call(this)},nf.prototype.eu=function(){this._u&&this.du([])},nf.prototype.ou=function(t){return this.Qc.uu("Write",t)},nf.prototype.onMessage=function(t){if(Lr(!!t.streamToken),this.lastStreamToken=t.streamToken,this._u){this.Si.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Lr(void 0!==r),n.map(function(t){return function(t,e){var n=t.updateTime?Bo(t.updateTime):Bo(e);n.isEqual(ri.min())&&(n=Bo(e));e=null;return t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new Ds(n,e)}(t,r)})):[]),n=Bo(t.commitTime);return this.listener.wu(n,e)}var n,r;return Lr(!t.writeResults||0===t.writeResults.length),this._u=!0,this.listener.Eu()},nf.prototype.Tu=function(){var t={};t.database=Yo(this.serializer),this.Zc(t)},nf.prototype.du=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return $o(e.serializer,t)})};this.Zc(t)},nf),$h=(n(ef,Hh=function(){}),ef.prototype.mu=function(){if(this.Iu)throw new jr(Ur.FAILED_PRECONDITION,"The client has already been terminated.")},ef.prototype.Au=function(e,n,r){var i=this;return this.mu(),this.credentials.getToken().then(function(t){return i.Qc.Au(e,n,r,t)}).catch(function(t){throw t.code===Ur.UNAUTHENTICATED&&i.credentials.m(),t})},ef.prototype.Ru=function(e,n,r){var i=this;return this.mu(),this.credentials.getToken().then(function(t){return i.Qc.Ru(e,n,r,t)}).catch(function(t){throw t.code===Ur.UNAUTHENTICATED&&i.credentials.m(),t})},ef.prototype.terminate=function(){this.Iu=!1},ef),Zh=(tf.prototype.pu=function(){var t=this;0===this.gu&&(this.vu("Unknown"),this.yu=this.di.Us("online_state_timeout",1e4,function(){return t.yu=null,t.bu("Backend didn't respond within 10 seconds."),t.vu("Offline"),Promise.resolve()}))},tf.prototype.Su=function(t){"Online"===this.state?this.vu("Unknown"):(this.gu++,1<=this.gu&&(this.Du(),this.bu("Connection failed 1 times. Most recent error: "+t.toString()),this.vu("Offline")))},tf.prototype.set=function(t){this.Du(),this.gu=0,"Online"===t&&(this.Vu=!1),this.vu(t)},tf.prototype.vu=function(t){t!==this.state&&(this.state=t,this.Pu(t))},tf.prototype.bu=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vu?(kr(t),this.Vu=!1):xr("OnlineStateTracker",t)},tf.prototype.Du=function(){null!==this.yu&&(this.yu.cancel(),this.yu=null)},tf);function tf(t,e){this.di=t,this.Pu=e,this.state="Unknown",this.gu=0,this.yu=null,this.Vu=!0}function ef(t,e,n){var r=this;return(r=Hh.call(this)||this).credentials=t,r.Qc=e,r.serializer=n,r.Iu=!1,r}function nf(t,e,n,r,i){var o=this;return(o=Qh.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o._u=!1,o}function rf(t,e,n,r,i){var o=this;return(o=Yh.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function of(t,e,n,r,i,o){this.Cs=t,this.Uc=n,this.Qc=r,this.Kc=i,this.listener=o,this.state=0,this.Wc=0,this.jc=null,this.stream=null,this.Si=new Aa(t,e)}function sf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!df(r))return[3,4];e=0,n=r.ku,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function uf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.ku,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function af(t,e){t.Ou.has(e.targetId)||(t.Ou.set(e.targetId,e),pf(t)?lf(t):Ef(t).zc()&&hf(t,e))}function cf(t,e){var n=t,t=Ef(n);n.Ou.delete(e),t.zc()&&ff(n,e),0===n.Ou.size&&(t.zc()?t.Yc():df(n)&&n.Bu.set("Unknown"))}function hf(t,e){t.qu.De(e.targetId),Ef(t).hu(e)}function ff(t,e){t.qu.De(e),Ef(t).lu(e)}function lf(e){e.qu=new no({Xe:function(t){return e.xu.Xe(t)},Ze:function(t){return e.Ou.get(t)||null}}),Ef(e).start(),e.Bu.pu()}function pf(t){return df(t)&&!Ef(t).Gc()&&0<t.Ou.size}function df(t){return 0===t.Mu.size}function yf(t){t.qu=void 0}function vf(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Bu.set("Online"),!(u instanceof to&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Ou.has(i)?[4,o.xu.Uu(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Ou.delete(i),o.qu.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),xr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,gf(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof $i?s.qu.$e(u):u instanceof Zi?s.qu.je(u):s.qu.qe(u),a.isEqual(ri.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Mh(s.Cu)];case 8:return o=t.sent(),0<=a.F(o)?[4,(i=a,(e=(r=s).qu.He(i)).re.forEach(function(t,e){var n;0<t.resumeToken.ht()&&((n=r.Ou.get(e))&&r.Ou.set(e,n.wt(t.resumeToken,i)))}),e.oe.forEach(function(t){var e=r.Ou.get(t);e&&(r.Ou.set(t,e.wt(Ii.lt,e.ft)),ff(r,t),e=new Ai(e.target,t,1,e.sequenceNumber),hf(r,e))}),r.xu.Qu(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return xr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,gf(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function gf(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!Ca(r))throw r;return n.Mu.add(1),[4,uf(n)];case 1:return t.sent(),n.Bu.set("Offline"),i=i||function(){return Mh(n.Cu)},n.di.Mi(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return xr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Mu.delete(1),[4,sf(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function mf(e,n){return n().catch(function(t){return gf(e,t,n)})}function wf(a){return y(this,void 0,void 0,function(){var i,o,s,u;return v(this,function(t){switch(t.label){case 0:o=Tf(i=a),s=0<i.Fu.length?i.Fu[i.Fu.length-1].batchId:-1,t.label=1;case 1:if(!(df(i)&&i.Fu.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.Cu,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.rs.Fr(t,n)}))];case 3:return null===(u=t.sent())?(0===i.Fu.length&&o.Yc(),[3,7]):(s=u.batchId,function(t,e){t.Fu.push(e);t=Tf(t);t.zc()&&t.fu&&t.du(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,gf(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return bf(i)&&_f(i),[2]}var e,n,r})})}function bf(t){return df(t)&&!Tf(t).Gc()&&0<t.Fu.length}function _f(t){Tf(t).start()}function If(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Mu.delete(2),[4,sf(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Mu.add(2),[4,uf(e)]);case 3:t.sent(),e.Bu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function Ef(n){var t,e,r,i=this;return n.ju||(n.ju=(t=n.Nu,e=n.di,r={cu:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.Ou.forEach(function(t,e){hf(n,t)}),[2]})})}.bind(null,n),nu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return yf(e),pf(e)?(e.Bu.Su(n),lf(e)):e.Bu.set("Unknown"),[2]})})}.bind(null,n),au:vf.bind(null,n)},t.mu(),new Xh(e,t.Qc,t.credentials,t.serializer,r)),n.ku.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.ju.Jc(),pf(n)?lf(n):n.Bu.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.ju.stop()];case 2:t.sent(),yf(n),t.label=3;case 3:return[2]}})})})),n.ju}function Tf(n){var t,e,r,i=this;return n.Gu||(n.Gu=(t=n.Nu,e=n.di,r={cu:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return Tf(e).Tu(),[2]})})}.bind(null,n),nu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&Tf(e).fu?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Si(n=i.code)&&n!==Ur.ABORTED?(e=r.Fu.shift(),Tf(r).Jc(),[4,mf(r,function(){return r.xu.Wu(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,wf(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return bf(e)&&_f(e),[2]}})})}.bind(null,n),Eu:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=Tf(o),n=0,r=o.Fu;n<r.length;n++)i=r[n],e.du(i.mutations);return[2]})})}.bind(null,n),wu:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Fu.shift(),n=sa.from(e,i,o),[4,mf(r,function(){return r.xu.Ku(n)})];case 1:return t.sent(),[4,wf(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.mu(),new Jh(e,t.Qc,t.credentials,t.serializer,r)),n.ku.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Gu.Jc(),[4,wf(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.Gu.stop()];case 3:t.sent(),0<n.Fu.length&&(xr("RemoteStore","Stopping write stream with "+n.Fu.length+" pending writes"),n.Fu=[]),t.label=4;case 4:return[2]}})})})),n.Gu}function Nf(){this.queries=new ua(Nu,Tu),this.onlineState="Unknown",this.Hu=new Set}var Af=function(){this.zu=void 0,this.listeners=[]};function Of(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new Af),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Ju(n)];case 2:return o.zu=t.sent(),[3,4];case 3:return o=t.sent(),o=Qa(o,"Initialization of query '"+Au(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.Yu(e.onlineState),i.zu&&u.Xu(i.zu)&&Df(e),[2]}})})}function Sf(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.Zu(n))]:[2]})})}function Df(t){t.Hu.forEach(function(t){t.next()})}var xf=(Lf.prototype.Xu=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Yi(t.query,t.docs,t.te,e,t.ee,t.fromCache,t.ne,!0)}var o=!1;return this.ea?this.sa(t)&&(this.ta.next(t),o=!0):this.ia(t,this.onlineState)&&(this.ra(t),o=!0),this.na=t,o},Lf.prototype.onError=function(t){this.ta.error(t)},Lf.prototype.Yu=function(t){this.onlineState=t;var e=!1;return this.na&&!this.ea&&this.ia(this.na,t)&&(this.ra(this.na),e=!0),e},Lf.prototype.ia=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.oa&&n||t.docs.W()&&"Offline"!==e)},Lf.prototype.sa=function(t){if(0<t.docChanges.length)return!0;var e=this.na&&this.na.hasPendingWrites!==t.hasPendingWrites;return!(!t.ne&&!e)&&!0===this.options.includeMetadataChanges},Lf.prototype.ra=function(t){t=Yi.ie(t.query,t.docs,t.ee,t.fromCache),this.ea=!0,this.ta.next(t)},Lf),kf=(Cf.prototype.W=function(){return this.ca.W()},Cf.prototype.Do=function(t,e){e=new Pf(t,e);this.ca=this.ca.add(e),this.aa=this.aa.add(e)},Cf.prototype.la=function(t,e){var n=this;t.forEach(function(t){return n.Do(t,e)})},Cf.prototype.No=function(t,e){this._a(new Pf(t,e))},Cf.prototype.fa=function(t,e){var n=this;t.forEach(function(t){return n.No(t,e)})},Cf.prototype.da=function(t){var e=this,n=new ui(new ii([])),r=new Pf(n,t),t=new Pf(n,t+1),i=[];return this.aa.Kt([r,t],function(t){e._a(t),i.push(t.key)}),i},Cf.prototype.wa=function(){var e=this;this.ca.forEach(function(t){return e._a(t)})},Cf.prototype._a=function(t){this.ca=this.ca.delete(t),this.aa=this.aa.delete(t)},Cf.prototype.Ea=function(t){var e=new ui(new ii([])),n=new Pf(e,t),t=new Pf(e,t+1),r=Ki();return this.aa.Kt([n,t],function(t){r=r.add(t.key)}),r},Cf.prototype.Qr=function(t){var e=new Pf(t,0),e=this.ca.jt(e);return null!==e&&t.isEqual(e.key)},Cf),Pf=(Rf.ua=function(t,e){return ui.$(t.key,e.key)||Jr(t.Ta,e.Ta)},Rf.ha=function(t,e){return Jr(t.Ta,e.Ta)||ui.$(t.key,e.key)},Rf);function Rf(t,e){this.key=t,this.Ta=e}function Cf(){this.ca=new Mi(Pf.ua),this.aa=new Mi(Pf.ha)}function Lf(t,e,n){this.query=t,this.ta=e,this.ea=!1,this.na=null,this.onlineState="Unknown",this.options=n||{}}function Vf(t,e){return"firestore_clients_"+t+"_"+e}function Mf(t,e,n){n="firestore_mutations_"+t+"_"+n;return e.u()&&(n+="_"+e.uid),n}function Uf(t,e){return"firestore_targets_"+t+"_"+e}var jf=(sl.Ia=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new jr(r.error.code,r.error.message)),i?new sl(t,e,r.state,o):(kr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},sl.prototype.ma=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},sl),qf=(ol.Ia=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new jr(n.error.code,n.error.message)),r?new ol(t,n.state,i):(kr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},ol.prototype.ma=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},ol),Ff=(il.Ia=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Wi,o=0;r&&o<n.activeTargetIds.length;++o)r=vi(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new il(t,i):(kr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},il),Bf=(rl.Ia=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new rl(e.clientId,e.onlineState):(kr("SharedClientState","Failed to parse online state: "+t),null)},rl),zf=(nl.prototype.Aa=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},nl.prototype.Ra=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},nl.prototype.ma=function(){var t={activeTargetIds:this.activeTargetIds.H(),updateTimeMs:Date.now()};return JSON.stringify(t)},nl),Gf=(el.Gs=function(t){return!(!t||!t.localStorage)},el.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f=this;return v(this,function(t){switch(t.label){case 0:return[4,this.ga.Ic()];case 1:for(s=t.sent(),e=0,n=s;e<n.length;e++)(r=n[e])!==this.Pa&&(i=this.getItem(Vf(this.persistenceKey,r)))&&(o=Ff.Ia(r,i))&&(this.pa=this.pa.Tt(o.clientId,o));for(this.Oa(),(s=this.storage.getItem(this.xa))&&(u=this.Ma(s))&&this.ka(u),a=0,c=this.va;a<c.length;a++)h=c[a],this.Va(h);return this.va=[],this.window.addEventListener("unload",function(){return f.fc()}),this.lr=!0,[2]}})})},el.prototype.Ss=function(t){this.setItem(this.Sa,JSON.stringify(t))},el.prototype.$a=function(){return this.La(this.pa)},el.prototype.Ba=function(n){var r=!1;return this.pa.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},el.prototype.qa=function(t){this.Ua(t,"pending")},el.prototype.Qa=function(t,e,n){this.Ua(t,e,n),this.Ka(t)},el.prototype.Wa=function(t){var e,n="not-current";return this.Ba(t)&&(!(e=this.storage.getItem(Uf(this.persistenceKey,t)))||(e=qf.Ia(t,e))&&(n=e.state)),this.ja.Aa(t),this.Oa(),n},el.prototype.Ga=function(t){this.ja.Ra(t),this.Oa()},el.prototype.za=function(t){return this.ja.activeTargetIds.has(t)},el.prototype.Ha=function(t){this.removeItem(Uf(this.persistenceKey,t))},el.prototype.Ja=function(t,e,n){this.Ya(t,e,n)},el.prototype.Xa=function(t,e,n){var r=this;e.forEach(function(t){r.Ka(t)}),this.currentUser=t,n.forEach(function(t){r.qa(t)})},el.prototype.Za=function(t){this.th(t)},el.prototype.eh=function(){this.nh()},el.prototype.fc=function(){this.lr&&(this.window.removeEventListener("storage",this.ya),this.removeItem(this.ba),this.lr=!1)},el.prototype.getItem=function(t){var e=this.storage.getItem(t);return xr("SharedClientState","READ",t,e),e},el.prototype.setItem=function(t,e){xr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},el.prototype.removeItem=function(t){xr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},el.prototype.Va=function(t){var e=this,o=t;if(o.storageArea===this.storage){if(xr("SharedClientState","EVENT",o.key,o.newValue),o.key===this.ba)return void kr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Cs.Mi(function(){return y(e,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){if(this.lr){if(null!==o.key)if(this.Da.test(o.key)){if(null==o.newValue)return e=this.sh(o.key),[2,this.ih(e,null)];if(e=this.rh(o.key,o.newValue))return[2,this.ih(e.clientId,e)]}else if(this.Ca.test(o.key)){if(null!==o.newValue&&(n=this.oh(o.key,o.newValue)))return[2,this.uh(n)]}else if(this.Na.test(o.key)){if(null!==o.newValue&&(r=this.ah(o.key,o.newValue)))return[2,this.hh(r)]}else if(o.key===this.xa){if(null!==o.newValue&&(i=this.Ma(o.newValue)))return[2,this.ka(i)]}else if(o.key===this.Sa)(i=function(t){var e=ba.Ds;if(null!=t)try{var n=JSON.parse(t);Lr("number"==typeof n),e=n}catch(t){kr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(o.newValue))!==ba.Ds&&this.ps(i);else if(o.key===this.Fa)return[2,this.ga.lh()]}else this.va.push(o);return[2]})})})}},Object.defineProperty(el.prototype,"ja",{get:function(){return this.pa.get(this.Pa)},enumerable:!1,configurable:!0}),el.prototype.Oa=function(){this.setItem(this.ba,this.ja.ma())},el.prototype.Ua=function(t,e,n){n=new jf(this.currentUser,t,e,n),t=Mf(this.persistenceKey,this.currentUser,t);this.setItem(t,n.ma())},el.prototype.Ka=function(t){t=Mf(this.persistenceKey,this.currentUser,t);this.removeItem(t)},el.prototype.th=function(t){t={clientId:this.Pa,onlineState:t};this.storage.setItem(this.xa,JSON.stringify(t))},el.prototype.Ya=function(t,e,n){var r=Uf(this.persistenceKey,t),n=new qf(t,e,n);this.setItem(r,n.ma())},el.prototype.nh=function(){this.setItem(this.Fa,"value-not-used")},el.prototype.sh=function(t){t=this.Da.exec(t);return t?t[1]:null},el.prototype.rh=function(t,e){t=this.sh(t);return Ff.Ia(t,e)},el.prototype.oh=function(t,e){var n=this.Ca.exec(t),t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return jf.Ia(new Tr(n),t,e)},el.prototype.ah=function(t,e){t=this.Na.exec(t),t=Number(t[1]);return qf.Ia(t,e)},el.prototype.Ma=function(t){return Bf.Ia(t)},el.prototype.uh=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.ga._h(e.batchId,e.state,e.error)]:(xr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},el.prototype.hh=function(t){return this.ga.fh(t.targetId,t.state,t.error)},el.prototype.ih=function(t,e){var n=this,r=e?this.pa.Tt(t,e):this.pa.remove(t),i=this.La(this.pa),o=this.La(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.ga.dh(s,u).then(function(){n.pa=r})},el.prototype.ka=function(t){this.pa.get(t.clientId)&&this.Pu(t.onlineState)},el.prototype.La=function(t){var n=Wi;return t.forEach(function(t,e){n=n.Gt(e.activeTargetIds)}),n},el),Kf=(tl.prototype.qa=function(t){},tl.prototype.Qa=function(t,e,n){},tl.prototype.Wa=function(t){return this.wh.Aa(t),this.Eh[t]||"not-current"},tl.prototype.Ja=function(t,e,n){this.Eh[t]=e},tl.prototype.Ga=function(t){this.wh.Ra(t)},tl.prototype.za=function(t){return this.wh.activeTargetIds.has(t)},tl.prototype.Ha=function(t){delete this.Eh[t]},tl.prototype.$a=function(){return this.wh.activeTargetIds},tl.prototype.Ba=function(t){return this.wh.activeTargetIds.has(t)},tl.prototype.start=function(){return this.wh=new zf,Promise.resolve()},tl.prototype.Xa=function(t,e,n){},tl.prototype.Za=function(t){},tl.prototype.fc=function(){},tl.prototype.Ss=function(t){},tl.prototype.eh=function(){},tl),Wf=function(t){this.key=t},Hf=function(t){this.key=t},Qf=(Object.defineProperty(Zf.prototype,"Ph",{get:function(){return this.Th},enumerable:!1,configurable:!0}),Zf.prototype.gh=function(t,e){var s=this,u=e?e.yh:new Qi,a=(e||this).Rh,c=(e||this).ee,h=a,f=!1,l=vu(this.query)&&a.size===this.query.limit?a.last():null,p=gu(this.query)&&a.size===this.query.limit?a.first():null;if(t.Pt(function(t,e){var n=a.get(t),r=(r=e instanceof uu?e:null)&&(Ou(s.query,r)?r:null),i=!!n&&s.ee.has(n.key),o=!!r&&(r.an||s.ee.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.Vh(n,r)||(u.track({type:2,doc:r}),e=!0,(l&&0<s.Ah(r,l)||p&&s.Ah(r,p)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(l||p)&&(f=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),vu(this.query)||gu(this.query))for(;h.size>this.query.limit;){var n=vu(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{Rh:h,yh:u,ph:f,ee:c}},Zf.prototype.Vh=function(t,e){return t.an&&e.hasCommittedMutations&&!e.an},Zf.prototype.Zn=function(t,e,n){var o=this,r=this.Rh;this.Rh=t.Rh,this.ee=t.ee;var i=t.yh.Zt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.Ah(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Cr()}}var r,i}),this.bh(n);var s=e?this.Sh():[],n=0===this.mh.size&&this.le?1:0,e=n!==this.Ih;return this.Ih=n,0!==i.length||e?{snapshot:new Yi(this.query,t.Rh,r,i,t.ee,0==n,e,!1),Dh:s}:{Dh:s}},Zf.prototype.Yu=function(t){return this.le&&"Offline"===t?(this.le=!1,this.Zn({Rh:this.Rh,yh:new Qi,ee:this.ee,ph:!1},!1)):{Dh:[]}},Zf.prototype.Ch=function(t){return!this.Th.has(t)&&!!this.Rh.has(t)&&!this.Rh.get(t).an},Zf.prototype.bh=function(t){var e=this;t&&(t._e.forEach(function(t){return e.Th=e.Th.add(t)}),t.fe.forEach(function(t){}),t.de.forEach(function(t){return e.Th=e.Th.delete(t)}),this.le=t.le)},Zf.prototype.Sh=function(){var e=this;if(!this.le)return[];var n=this.mh;this.mh=Ki(),this.Rh.forEach(function(t){e.Ch(t.key)&&(e.mh=e.mh.add(t.key))});var r=[];return n.forEach(function(t){e.mh.has(t)||r.push(new Hf(t))}),this.mh.forEach(function(t){n.has(t)||r.push(new Wf(t))}),r},Zf.prototype.Nh=function(t){this.Th=t.Bc,this.mh=Ki();t=this.gh(t.documents);return this.Zn(t,!0)},Zf.prototype.xh=function(){return Yi.ie(this.query,this.Rh,this.ee,0===this.Ih)},Zf),Yf=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Xf=function(t){this.key=t,this.Fh=!1},Jf=(Object.defineProperty($f.prototype,"Jh",{get:function(){return!0===this.Hh},enumerable:!1,configurable:!0}),$f);function $f(t,e,n,r,i,o){this.Cu=t,this.Oh=e,this.Mh=n,this.kh=r,this.currentUser=i,this.$h=o,this.Lh={},this.Bh=new ua(Nu,Tu),this.qh=new Map,this.Uh=[],this.Qh=new xi(ui.$),this.Kh=new Map,this.Wh=new kf,this.jh={},this.Gh=new Map,this.zh=ph._o(),this.onlineState="Unknown",this.Hh=void 0}function Zf(t,e){this.query=t,this.Th=e,this.Ih=null,this.le=!1,this.mh=Ki(),this.ee=Ki(),this.Ah=Su(t),this.Rh=new Hi(this.Ah)}function tl(){this.wh=new zf,this.Eh={},this.Pu=null,this.ps=null}function el(t,e,n,r,i){this.window=t,this.Cs=e,this.persistenceKey=n,this.Pa=r,this.ga=null,this.Pu=null,this.ps=null,this.ya=this.Va.bind(this),this.pa=new xi(Jr),this.lr=!1,this.va=[];n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.ba=Vf(this.persistenceKey,this.Pa),this.Sa="firestore_sequence_number_"+this.persistenceKey,this.pa=this.pa.Tt(this.Pa,new zf),this.Da=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.Ca=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.Na=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.xa="firestore_online_state_"+this.persistenceKey,this.Fa="firestore_bundle_loaded_"+this.persistenceKey,this.window.addEventListener("storage",this.ya)}function nl(){this.activeTargetIds=Wi}function rl(t,e){this.clientId=t,this.onlineState=e}function il(t,e){this.clientId=t,this.activeTargetIds=e}function ol(t,e,n){this.targetId=t,this.state=e,this.error=n}function sl(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function ul(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Yh=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.gh(o)).ph?[4,Fh(r.Cu,i.query,!1).then(function(t){t=t.documents;return i.view.gh(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.re.get(i.targetId),n=i.view.Zn(e,r.Jh,n),[2,(gl(r,i.targetId,n.Dh),n.snapshot)]}})})}(i,t,e,n)},[4,Fh(i.Cu,o,!0)];case 1:return n=t.sent(),r=new Qf(o,n.Bc),e=r.gh(n.documents),n=Ji.he(s,u&&"Offline"!==i.onlineState),n=r.Zn(e,i.Jh,n),gl(i,s,n.Dh),r=new Yf(o,s,r),[2,(i.Bh.set(o,r),i.qh.has(s)?i.qh.get(s).push(o):i.qh.set(s,[o]),n.snapshot)]}})})}function al(l,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:u=Al(l),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(i=u.Cu,a=p,h=i,f=ni.now(),o=a.reduce(function(t,e){return t.add(e.key)},Ki()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.Oc._s(u,o).next(function(t){c=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=c.get(i.key),s instanceof Ks?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof uu?t.field(i.field):void 0,o=cs(i.transform,o||null);null!=o&&(e=(null==e?new Zs:e).set(i.field,o))}return e?e.hn():null}(o):null);null!=o&&e.push(new qs(i.key,o,function s(t){var u=[];return po(t.fields||{},function(t,e){var n=new si([t]);if(Ro(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new As(u)}(o.proto.mapValue),xs.exists(!0)))}return h.rs.Sr(u,f,e,a)})}).then(function(t){var e=t.vn(c);return{batchId:t.batchId,Qn:e}}))];case 2:return s=t.sent(),u.kh.qa(s.batchId),e=u,n=s.batchId,r=d,i=(i=(i=e.jh[e.currentUser.h()])||new xi(Jr)).Tt(n,r),e.jh[e.currentUser.h()]=i,[4,wl(u,s.Qn)];case 3:return t.sent(),[4,wf(u.Oh)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=Qa(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,i,a,c,h,f,o})})}function cl(r,i){return y(this,void 0,void 0,function(){var n,e;return v(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Uh(n.Cu,i)];case 2:return e=t.sent(),i.re.forEach(function(t,e){e=n.Kh.get(e);e&&(Lr(t._e.size+t.fe.size+t.de.size<=1),0<t._e.size?e.Fh=!0:0<t.fe.size?Lr(e.Fh):0<t.de.size&&(Lr(e.Fh),e.Fh=!1))}),[4,wl(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,Kh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function hl(t,n,e){var r,t=t;(t.Jh&&0===e||!t.Jh&&1===e)&&(r=[],t.Bh.forEach(function(t,e){e=e.view.Yu(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Yu(i)&&(o=!0)}),o&&Df(t)}(t.Mh,n),r.length&&t.Lh.au(r),t.onlineState=n,t.Jh&&t.kh.Za(n))}function fl(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Cu,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.rs.Cr(e,r).next(function(t){return Lr(null!==t),n=t.keys(),i.rs.$r(e,t)}).next(function(){return i.rs.Ur(e)}).next(function(){return i.Oc._s(e,n)})}))];case 2:return o=t.sent(),dl(n,u,a),pl(n,u),n.kh.Qa(u,"rejected",a),[4,wl(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Kh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}function ll(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:df((n=o).Oh)||xr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Cu).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.rs.Or(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Gh.get(r)||[]).push(s),n.Gh.set(r,i),[3,4]);case 3:return i=t.sent(),i=Qa(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function pl(t,e){(t.Gh.get(e)||[]).forEach(function(t){t.resolve()}),t.Gh.delete(e)}function dl(t,e,n){var r=t,i=r.jh[r.currentUser.h()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.jh[r.currentUser.h()]=i)}function yl(e,t,n){void 0===n&&(n=null),e.kh.Ga(t);for(var r=0,i=e.qh.get(t);r<i.length;r++){var o=i[r];e.Bh.delete(o),n&&e.Lh.Xh(o,n)}e.qh.delete(t),e.Jh&&e.Wh.da(t).forEach(function(t){e.Wh.Qr(t)||vl(e,t)})}function vl(t,e){var n=t.Qh.get(e);null!==n&&(cf(t.Oh,n),t.Qh=t.Qh.remove(e),t.Kh.delete(n),ml(t))}function gl(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Wf?(t.Wh.Do(o.key,e),function(t,e){e=e.key;t.Qh.get(e)||(xr("SyncEngine","New document in limbo: "+e),t.Uh.push(e),ml(t))}(t,o)):o instanceof Hf?(xr("SyncEngine","Document no longer in limbo: "+o.key),t.Wh.No(o.key,e),t.Wh.Qr(o.key)||vl(t,o.key)):Cr()}}function ml(t){for(;0<t.Uh.length&&t.Qh.size<t.$h;){var e=t.Uh.shift(),n=t.zh.next();t.Kh.set(n,new Xf(e)),t.Qh=t.Qh.Tt(e,n),af(t.Oh,new Ai(Iu(yu(e.path)),n,2,ba.Ds))}}function wl(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Bh.W()?[3,3]:(n.Bh.forEach(function(t,e){o.push(n.Yh(e,s,u).then(function(t){t&&(n.Jh&&n.kh.Ja(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=wa.Vs(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.Lh.au(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return aa.forEach(c,function(e){return aa.forEach(e.gs,function(t){return r.persistence.Vr.Do(n,e.targetId,t)}).next(function(){return aa.forEach(e.ys,function(t){return r.persistence.Vr.No(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Ca(e=t.sent()))throw e;return xr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.Cc.get(o),u=s.ft,u=s.Et(u),r.Cc=r.Cc.Tt(o,u));return[2]}})})}(n.Cu,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function bl(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(xr("SyncEngine","User change. New user:",o.h()),[4,Lh(n.Cu,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Gh.forEach(function(t){t.forEach(function(t){t.reject(new jr(Ur.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Gh.clear(),n.kh.Xa(o,r.$c,r.Lc),[4,wl(n,r.kc)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}function _l(u,a,c,h){return y(this,void 0,void 0,function(){var o,s;return v(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).Cu,n=a,i=(r=e).rs,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Nr(e,n).next(function(t){return t?r.Oc._s(e,t):aa.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,wf(o.Oh)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(dl(o,a,h||null),pl(o,a),o.Cu.rs.Br(a)):Cr(),t.label=4;case 4:return[4,wl(o,s)];case 5:return t.sent(),[3,7];case 6:xr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}function Il(h,f){return y(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return v(this,function(t){switch(t.label){case 0:return Nl(r=h),Al(r),!0!==f||!0===r.Hh?[3,3]:(e=r.kh.$a(),[4,El(r,e.H())]);case 1:return i=t.sent(),r.Hh=!0,[4,If(r.Oh,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],af(r.Oh,u);return[3,7];case 3:return!1!==f||!1===r.Hh?[3,7]:(a=[],c=Promise.resolve(),r.qh.forEach(function(t,e){r.kh.za(e)?a.push(e):c=c.then(function(){return yl(r,e),qh(r.Cu,e,!0)}),cf(r.Oh,e)}),[4,c]);case 4:return t.sent(),[4,El(r,a)];case 5:return t.sent(),(n=r).Kh.forEach(function(t,e){cf(n.Oh,e)}),n.Wh.wa(),n.Kh=new Map,n.Qh=new xi(ui.$),r.Hh=!1,[4,If(r.Oh,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}function El(p,d){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l;return v(this,function(t){switch(t.label){case 0:e=p,n=[],r=[],i=0,o=d,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.qh.get(s))&&0!==a.length?[4,jh(e.Cu,Iu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(f=h[c],f=e.Bh.get(f),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Fh((e=r).Cu,i.query,!0)];case 1:return n=t.sent(),n=i.view.Nh(n),[2,(e.Jh&&gl(e,i.targetId,n.Dh),n)]}})})}(e,f)]):[3,6];case 4:(f=t.sent()).snapshot&&r.push(f.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,Bh(e.Cu,s)];case 8:return l=t.sent(),[4,jh(e.Cu,l)];case 9:return u=t.sent(),[4,ul(e,Tl(l),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.Lh.au(r),n)]}})})}function Tl(t){return du(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Nl(t){return t.Oh.xu.Qu=cl.bind(null,t),t.Oh.xu.Xe=function(t,e){var n=t;if((t=n.Kh.get(e))&&t.Fh)return Ki().add(t.key);var r=Ki();if(!(e=n.qh.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Bh.get(s),r=r.Gt(s.view.Ph);return r}.bind(null,t),t.Oh.xu.Uu=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).kh.Ja(s,"rejected",u),i=e.Kh.get(s),(n=i&&i.key)?(r=(r=new xi(ui.$)).Tt(n,new au(n,ri.min())),i=Ki().add(n),i=new Xi(ri.min(),new Map,new Mi(Jr),r,i),[4,cl(e,i)]):[3,2];case 1:return t.sent(),e.Qh=e.Qh.remove(n),e.Kh.delete(s),ml(e),[3,4];case 2:return[4,qh(e.Cu,s,!1).then(function(){return yl(e,s,u)}).catch(Kh)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,t),t.Lh.au=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.queries.get(u);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Xu(s)&&(r=!0);u.zu=s}}r&&Df(n)}.bind(null,t.Mh),t.Lh.Xh=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,t.Mh),t}function Al(t){return t.Oh.xu.Ku=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Vh(e.Cu,o)];case 2:return r=t.sent(),dl(e,n,null),pl(e,n),e.kh.Qa(n,"acknowledged"),[4,wl(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,Kh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,t),t.Oh.xu.Wu=fl.bind(null,t),t}var Ol,Sl,Dl,xl,kl,Pl=(vp.prototype.Mc=function(t){this.Zh=t},vp.prototype.ws=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.Tn.length||1===r.Tn.length&&r.Tn[0].field.tt())||i.isEqual(ri.min())?this.tl(e,r):this.Zh._s(e,o).next(function(t){var n=s.el(r,t);return(vu(r)||gu(r))&&s.ph(r.limitType,n,o,i)?s.tl(e,r):(Dr()<=l.DEBUG&&xr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Au(r)),s.Zh.ws(e,r,i).next(function(e){return n.forEach(function(t){e=e.Tt(t.key,t)}),e}))})},vp.prototype.el=function(n,t){var r=new Mi(Su(n));return t.forEach(function(t,e){e instanceof uu&&Ou(n,e)&&(r=r.add(e))}),r},vp.prototype.ph=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.F(r))},vp.prototype.tl=function(t,e){return Dr()<=l.DEBUG&&xr("IndexFreeQueryEngine","Using full collection scan to execute query:",Au(e)),this.Zh.ws(t,e,ri.min())},vp),Rl=(yp.prototype.br=function(t){return aa.resolve(0===this.rs.length)},yp.prototype.Sr=function(t,e,n,r){var i=this.nl;this.nl++,0<this.rs.length&&this.rs[this.rs.length-1];n=new oa(i,e,n,r);this.rs.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.sl=this.sl.add(new Pf(u.key,i)),this.os.Dr(t,u.key.path.q())}return aa.resolve(n)},yp.prototype.Cr=function(t,e){return aa.resolve(this.il(e))},yp.prototype.Fr=function(t,e){e+=1,e=this.rl(e),e=e<0?0:e;return aa.resolve(this.rs.length>e?this.rs[e]:null)},yp.prototype.Or=function(){return aa.resolve(0===this.rs.length?-1:this.nl-1)},yp.prototype.Mr=function(t){return aa.resolve(this.rs.slice())},yp.prototype.us=function(t,e){var n=this,r=new Pf(e,0),e=new Pf(e,Number.POSITIVE_INFINITY),i=[];return this.sl.Kt([r,e],function(t){t=n.il(t.Ta);i.push(t)}),aa.resolve(i)},yp.prototype.ds=function(t,e){var n=this,r=new Mi(Jr);return e.forEach(function(t){var e=new Pf(t,0),t=new Pf(t,Number.POSITIVE_INFINITY);n.sl.Kt([e,t],function(t){r=r.add(t.Ta)})}),aa.resolve(this.ol(r))},yp.prototype.Rs=function(t,e){var n=e.path,r=n.length+1,e=n;ui.ot(e)||(e=e.child(""));var e=new Pf(new ui(e),0),i=new Mi(Jr);return this.sl.Wt(function(t){var e=t.key.path;return!!n.j(e)&&(e.length===r&&(i=i.add(t.Ta)),!0)},e),aa.resolve(this.ol(i))},yp.prototype.ol=function(t){var e=this,n=[];return t.forEach(function(t){t=e.il(t);null!==t&&n.push(t)}),n},yp.prototype.$r=function(n,r){var i=this;Lr(0===this.cl(r.batchId,"removed")),this.rs.shift();var o=this.sl;return aa.forEach(r.mutations,function(t){var e=new Pf(t.key,r.batchId);return o=o.delete(e),i.Vr.qr(n,t.key)}).next(function(){i.sl=o})},yp.prototype.Br=function(t){},yp.prototype.Qr=function(t,e){var n=new Pf(e,0),n=this.sl.jt(n);return aa.resolve(e.isEqual(n&&n.key))},yp.prototype.Ur=function(t){return this.rs.length,aa.resolve()},yp.prototype.cl=function(t,e){return this.rl(t)},yp.prototype.rl=function(t){return 0===this.rs.length?0:t-this.rs[0].batchId},yp.prototype.il=function(t){t=this.rl(t);return t<0||t>=this.rs.length?null:this.rs[t]},yp),Cl=(dp.prototype.jn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.ul(e);return this.docs=this.docs.Tt(r,{zn:e,size:i,readTime:n}),this.size+=i-o,this.os.Dr(t,r.path.q())},dp.prototype.Hn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},dp.prototype.Jn=function(t,e){e=this.docs.get(e);return aa.resolve(e?e.zn:null)},dp.prototype.getEntries=function(t,e){var n=this,r=ji;return e.forEach(function(t){var e=n.docs.get(t);r=r.Tt(t,e?e.zn:null)}),aa.resolve(r)},dp.prototype.ws=function(t,e,n){for(var r=Bi,i=new ui(e.path.child("")),o=this.docs.Vt(i);o.Nt();){var s=o.Ct(),u=s.key,a=s.value,s=a.zn,a=a.readTime;if(!e.path.j(u.path))break;a.F(n)<=0||s instanceof uu&&Ou(e,s)&&(r=r.Tt(s.key,s))}return aa.resolve(r)},dp.prototype.al=function(t,e){return aa.forEach(this.docs,function(t){return e(t)})},dp.prototype.Xr=function(t){return new Ll(this)},dp.prototype.eo=function(t){return aa.resolve(this.size)},dp),Ll=(n(pp,kl=h),pp.prototype.Zn=function(n){var r=this,i=[];return this.Qn.forEach(function(t,e){e&&e.zn?i.push(r.no.jn(n,e.zn,r.Wn(t))):r.no.Hn(t)}),aa.qn(i)},pp.prototype.Yn=function(t,e){return this.no.Jn(t,e)},pp.prototype.Xn=function(t,e){return this.no.getEntries(t,e)},pp),Vl=(lp.prototype.Ue=function(t,n){return this.hl.forEach(function(t,e){return n(e)}),aa.resolve()},lp.prototype.To=function(t){return aa.resolve(this.lastRemoteSnapshotVersion)},lp.prototype.Io=function(t){return aa.resolve(this.ll)},lp.prototype.fo=function(t){return this.highestTargetId=this.fl.next(),aa.resolve(this.highestTargetId)},lp.prototype.mo=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ll&&(this.ll=e),aa.resolve()},lp.prototype.Ro=function(t){this.hl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.fl=new ph(e),this.highestTargetId=e),t.sequenceNumber>this.ll&&(this.ll=t.sequenceNumber)},lp.prototype.Ao=function(t,e){return this.Ro(e),this.targetCount+=1,aa.resolve()},lp.prototype.yo=function(t,e){return this.Ro(e),aa.resolve()},lp.prototype.Vo=function(t,e){return this.hl.delete(e.target),this._l.da(e.targetId),--this.targetCount,aa.resolve()},lp.prototype.mr=function(n,r,i){var o=this,s=0,u=[];return this.hl.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.hl.delete(t),u.push(o.po(n,e.targetId)),s++)}),aa.qn(u).next(function(){return s})},lp.prototype.vo=function(t){return aa.resolve(this.targetCount)},lp.prototype.bo=function(t,e){e=this.hl.get(e)||null;return aa.resolve(e)},lp.prototype.So=function(t,e,n){return this._l.la(e,n),aa.resolve()},lp.prototype.Co=function(e,t,n){this._l.fa(t,n);var r=this.persistence.Vr,i=[];return r&&t.forEach(function(t){i.push(r.qr(e,t))}),aa.qn(i)},lp.prototype.po=function(t,e){return this._l.da(e),aa.resolve()},lp.prototype.xo=function(t,e){e=this._l.Ea(e);return aa.resolve(e)},lp.prototype.Qr=function(t,e){return aa.resolve(this._l.Qr(e))},lp),Ml=(fp.prototype.ro=function(t,e){return aa.resolve(this.dl.get(e))},fp.prototype.oo=function(t,e){return this.dl.set(e.id,{id:e.id,version:e.version,createTime:Bo(e.createTime)}),aa.resolve()},fp.prototype.co=function(t,e){return aa.resolve(this.wl.get(e))},fp.prototype.uo=function(t,e){return this.wl.set(e.name,{name:(e=e).name,query:mc(e.bundledQuery),readTime:Bo(e.readTime)}),aa.resolve()},fp),Ul=(hp.prototype.start=function(){return Promise.resolve()},hp.prototype.fc=function(){return this.$o=!1,Promise.resolve()},Object.defineProperty(hp.prototype,"lr",{get:function(){return this.$o},enumerable:!1,configurable:!0}),hp.prototype.tc=function(){},hp.prototype.ec=function(){},hp.prototype.Pc=function(){return this.os},hp.prototype.mc=function(t){var e=this.El[t.h()];return e||(e=new Rl(this.os,this.Vr),this.El[t.h()]=e),e},hp.prototype.Ac=function(){return this.jo},hp.prototype.Rc=function(){return this.ss},hp.prototype.gc=function(){return this.Go},hp.prototype.runTransaction=function(t,e,n){var r=this;xr("MemoryPersistence","Starting transaction:",t);var i=new jl(this.ko.next());return this.Vr.Il(),n(i).next(function(t){return r.Vr.ml(i).next(function(){return t})}).Ln().then(function(t){return i.ns(),t})},hp.prototype.Al=function(e,n){return aa.Un(Object.values(this.El).map(function(t){return function(){return t.Qr(e,n)}}))},hp),jl=(n(cp,xl=Ie),cp),ql=(ap.gl=function(t){return new ap(t)},Object.defineProperty(ap.prototype,"yl",{get:function(){if(this.Pl)return this.Pl;throw Cr()},enumerable:!1,configurable:!0}),ap.prototype.Do=function(t,e,n){return this.Rl.Do(n,e),this.yl.delete(n.toString()),aa.resolve()},ap.prototype.No=function(t,e,n){return this.Rl.No(n,e),this.yl.add(n.toString()),aa.resolve()},ap.prototype.qr=function(t,e){return this.yl.add(e.toString()),aa.resolve()},ap.prototype.removeTarget=function(t,e){var n=this;this.Rl.da(e.targetId).forEach(function(t){return n.yl.add(t.toString())});var r=this.persistence.Ac();return r.xo(t,e.targetId).next(function(t){t.forEach(function(t){return n.yl.add(t.toString())})}).next(function(){return r.Vo(t,e)})},ap.prototype.Il=function(){this.Pl=new Set},ap.prototype.ml=function(n){var r=this,i=this.persistence.Rc().Xr();return aa.forEach(this.yl,function(t){var e=ui.st(t);return r.Vl(n,e).next(function(t){t||i.Hn(e)})}).next(function(){return r.Pl=null,i.apply(n)})},ap.prototype.Sc=function(t,e){var n=this;return this.Vl(t,e).next(function(t){t?n.yl.delete(e.toString()):n.yl.add(e.toString())})},ap.prototype.Tl=function(t){return 0},ap.prototype.Vl=function(t,e){var n=this;return aa.Un([function(){return aa.resolve(n.Rl.Qr(e))},function(){return n.persistence.Ac().Qr(t,e)},function(){return n.persistence.Al(t,e)}])},ap),Fl=(up.prototype.cu=function(t){this.bl=t},up.prototype.nu=function(t){this.Sl=t},up.prototype.onMessage=function(t){this.Dl=t},up.prototype.close=function(){this.vl()},up.prototype.send=function(t){this.pl(t)},up.prototype.Cl=function(){this.bl()},up.prototype.Nl=function(t){this.Sl(t)},up.prototype.xl=function(t){this.Dl(t)},up),Bl={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},zl=(sp.prototype.Au=function(e,t,n,r){var i=this.kl(e,t);xr("RestConnection","Sending: ",i,n);t={};return this.$l(t,r),this.Ll(e,i,t,n).then(function(t){return xr("RestConnection","Received: ",t),t},function(t){throw Pr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},sp.prototype.Ru=function(t,e,n,r){return this.Au(t,e,n,r)},sp.prototype.$l=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.1.0-202010180421",t["Content-Type"]="text/plain",e)for(var n in e.T)e.T.hasOwnProperty(n)&&(t[n]=e.T[n])},sp.prototype.kl=function(t,e){t=Bl[t];return this.Ol+"/v1/"+e+":"+t},n(op,Dl=sp),op.prototype.Ll=function(o,e,s,u){return new Promise(function(n,r){var i=new wr;i.listenOnce(gr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case vr.NO_ERROR:var t=i.getResponseJson();xr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case vr.TIMEOUT:xr("Connection",'RPC "'+o+'" timed out'),r(new jr(Ur.DEADLINE_EXCEEDED,"Request time out"));break;case vr.HTTP_ERROR:var e=i.getStatus();xr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Ur).indexOf(e)?e:Ur.UNKNOWN,r(new jr(e,t.message))):r(new jr(Ur.UNKNOWN,"Server responded with status "+i.getStatus())):r(new jr(Ur.UNAVAILABLE,"Connection failed."));break;default:Cr()}}finally{xr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},op.prototype.uu=function(t,e){var n,r=[this.Ol,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new fr,t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.$l(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||(0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");xr("Connection","Creating WebChannel: "+r,t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new Fl({pl:function(t){u?xr("Connection","Not sending because WebChannel is closed:",t):(s||(xr("Connection","Opening WebChannel transport."),o.open(),s=!0),xr("Connection","WebChannel sending:",t),o.send(t))},vl:function(){return o.close()}}),t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(mr.EventType.OPEN,function(){u||xr("Connection","WebChannel transport opened.")}),t(mr.EventType.CLOSE,function(){u||(u=!0,xr("Connection","WebChannel transport closed"),a.Nl())}),t(mr.EventType.ERROR,function(t){u||(u=!0,Pr("Connection","WebChannel transport errored:",t),a.Nl(new jr(Ur.UNAVAILABLE,"The operation could not be completed")))}),t(mr.EventType.MESSAGE,function(t){var e,n,r,i;u||(Lr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(xr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Ni[r];if(void 0!==t)return Di(t)}(),i=n.message,void 0===t&&(t=Ur.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.Nl(new jr(t,i)),o.close()):(xr("Connection","WebChannel received:",e),a.xl(e)))}),setTimeout(function(){a.Cl()},0),a},op),Gl=(ip.prototype.Lu=function(t){this.Kl.push(t)},ip.prototype.fc=function(){window.removeEventListener("online",this.Bl),window.removeEventListener("offline",this.Ul)},ip.prototype.Wl=function(){window.addEventListener("online",this.Bl),window.addEventListener("offline",this.Ul)},ip.prototype.ql=function(){xr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Kl;t<e.length;t++)(0,e[t])(0)},ip.prototype.Ql=function(){xr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Kl;t<e.length;t++)(0,e[t])(1)},ip.Gs=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},ip),Kl=(rp.prototype.Lu=function(t){},rp.prototype.fc=function(){},rp),Wl=(np.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.serializer=ya(e.Fl.t),this.kh=this.jl(e),this.persistence=this.Gl(e),[4,this.persistence.start()];case 1:return t.sent(),this.zl=this.Hl(e),this.Cu=this.Jl(e),[2]}})})},np.prototype.Hl=function(t){return null},np.prototype.Jl=function(t){return Ch(this.persistence,new Pl,t.Yl,this.serializer)},np.prototype.Gl=function(t){return new Ul(ql.gl,this.serializer)},np.prototype.jl=function(t){return new Kf},np.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.zl&&this.zl.stop(),[4,this.kh.fc()];case 1:return t.sent(),[4,this.persistence.fc()];case 2:return t.sent(),[2]}})})},np),Hl=(n(ep,Sl=Wl),ep.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Sl.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,Gh(this.Cu)];case 2:return t.sent(),[4,this.Xl.initialize(this,e)];case 3:return t.sent(),[4,Al(this.Xl.ga)];case 4:return t.sent(),[4,wf(this.Xl.Oh)];case 5:return t.sent(),[2]}})})},ep.prototype.Jl=function(t){return Ch(this.persistence,new Pl,t.Yl,this.serializer)},ep.prototype.Hl=function(t){var e=this.persistence.Vr.cr;return new ec(e,t.di)},ep.prototype.Gl=function(t){var e=kh(t.Fl.t,t.Fl.persistenceKey),n=void 0!==this.cacheSizeBytes?$a.er(this.cacheSizeBytes):$a.ir;return new Eh(this.synchronizeTabs,e,t.clientId,n,t.di,Ba(),za(),this.serializer,this.kh,!!this.forceOwnership)},ep.prototype.jl=function(t){return new Kf},ep),Ql=(n(tp,Ol=Hl),tp.prototype.initialize=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,Ol.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.Xl.ga,this.kh instanceof Gf?(this.kh.ga={_h:_l.bind(null,e),fh:function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return(e=i).Hh?(xr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!e.qh.has(o))return[3,8];switch(s){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,zh(e.Cu)];case 3:return n=t.sent(),r=Xi.ae(o,"current"===s),[4,wl(e,n,r)];case 4:return t.sent(),[3,8];case 5:return[4,qh(e.Cu,o,!0)];case 6:return t.sent(),yl(e,o,u),[3,8];case 7:Cr(),t.label=8;case 8:return[2]}})})}.bind(null,e),dh:function(c,h,f){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a;return v(this,function(t){switch(t.label){case 0:if(!(n=Nl(c)).Hh)return[3,10];e=0,r=h,t.label=1;case 1:return e<r.length?(r=r[e],n.qh.has(r)?(xr("SyncEngine","Adding an already active target "+r),[3,5]):[4,Bh(n.Cu,r)]):[3,6];case 2:return i=t.sent(),[4,jh(n.Cu,i)];case 3:return o=t.sent(),[4,ul(n,Tl(i),o.targetId,!1)];case 4:t.sent(),af(n.Oh,o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return n.qh.has(e)?[4,qh(n.Cu,e,!1).then(function(){cf(n.Oh,e),yl(n,e)}).catch(Kh)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=0,a=f,t.label=7;case 7:return u<a.length?(a=a[u],[5,s(a)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})}.bind(null,e),Ic:function(t){return t.Cu.persistence.Ic()}.bind(null,e),lh:function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,zh((e=n).Cu).then(function(t){return wl(e,t)})]})})}.bind(null,e)},[4,this.kh.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence.Zo(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Il(this.Xl.ga,e)];case 1:return t.sent(),this.zl&&(e&&!this.zl.lr?this.zl.start(this.Cu):e||this.zl.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},tp.prototype.jl=function(t){var e=Ba();if(!Gf.Gs(e))throw new jr(Ur.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=kh(t.Fl.t,t.Fl.persistenceKey);return new Gf(e,t.di,n,t.clientId,t.Yl)},tp),Yl=(Zl.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Cu?[3,2]:(this.Cu=n.Cu,this.kh=n.kh,this.Nu=this.Zl(r),this.Oh=this.t_(r),this.Mh=this.e_(r),this.ga=this.n_(r,!n.synchronizeTabs),this.kh.Pu=function(t){return hl(e.ga,t,1)},this.Oh.xu.s_=bl.bind(null,this.ga),[4,If(this.Oh,this.ga.Jh)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Zl.prototype.e_=function(t){return new Nf},Zl.prototype.Zl=function(t){var e=ya(t.Fl.t),n=(n=t.Fl,new zl(n));return t=t.credentials,new $h(t,n,e)},Zl.prototype.t_=function(t){var e=this,n=this.Cu,r=this.Nu,i=t.di,o=function(t){return hl(e.ga,t,0)},t=new(Gl.Gs()?Gl:Kl);return new Wh(n,r,i,o,t)},Zl.prototype.n_=function(t,e){return function(t,e,n,r,i,o,s){o=new Jf(t,e,n,r,i,o);return s&&(o.Hh=!0),o}(this.Cu,this.Oh,this.Mh,this.kh,t.Yl,t.$h,e)},Zl.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,xr("RemoteStore","RemoteStore shutting down."),e.Mu.add(5),[4,uf(e)];case 1:return t.sent(),e.$u.fc(),e.Bu.set("Unknown"),[2]}})})}(this.Oh)},Zl),Xl=($l.prototype.next=function(t){this.observer.next&&this.i_(this.observer.next,t)},$l.prototype.error=function(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},$l.prototype.r_=function(){this.muted=!0},$l.prototype.i_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},$l),Jl=function(t){this.o_=t};function $l(t){this.observer=t,this.muted=!1}function Zl(){}function tp(t,e){var n=this;return(n=Ol.call(this,t,e,!1)||this).Xl=t,n.cacheSizeBytes=e,n.synchronizeTabs=!0,n}function ep(t,e,n){var r=this;return(r=Sl.call(this)||this).Xl=t,r.cacheSizeBytes=e,r.forceOwnership=n,r.synchronizeTabs=!1,r}function np(){this.synchronizeTabs=!1}function rp(){}function ip(){var t=this;this.Bl=function(){return t.ql()},this.Ul=function(){return t.Ql()},this.Kl=[],this.Wl()}function op(t){var e=this;return(e=Dl.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.i=t.i,e}function sp(t){this.Fl=t,this.t=t.t;var e=t.ssl?"https":"http";this.Ol=e+"://"+t.host,this.Ml="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}function up(t){this.pl=t.pl,this.vl=t.vl}function ap(t){this.persistence=t,this.Rl=new kf,this.Pl=null}function cp(t){var e=this;return(e=xl.call(this)||this).Fo=t,e}function hp(t,e){var n=this;this.El={},this.ko=new ba(0),this.$o=!1,this.$o=!0,this.Vr=t(this),this.jo=new Vl(this),this.os=new Lc,this.ss=(t=this.os,new Cl(t,function(t){return n.Vr.Tl(t)})),this.serializer=new ac(e),this.Go=new Ml(this.serializer)}function fp(t){this.serializer=t,this.dl=new Map,this.wl=new Map}function lp(t){this.persistence=t,this.hl=new ua(wi,bi),this.lastRemoteSnapshotVersion=ri.min(),this.highestTargetId=0,this.ll=0,this._l=new kf,this.targetCount=0,this.fl=ph.lo()}function pp(t){var e=this;return(e=kl.call(this)||this).no=t,e}function dp(t,e){this.os=t,this.ul=e,this.docs=new xi(ui.$),this.size=0}function yp(t,e){this.os=t,this.Vr=e,this.rs=[],this.nl=1,this.sl=new Mi(Pf.ua)}function vp(){}function gp(t,e,n){if(!n)throw new jr(Ur.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function mp(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new jr(Ur.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function wp(t,e,n,r){if(!0===e&&!0===r)throw new jr(Ur.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function bp(t){if(!ui.ot(t))throw new jr(Ur.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function _p(t){if(ui.ot(t))throw new jr(Ur.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Ip(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Cr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Ep(t,e){if(t instanceof Jl&&(t=t.o_),t instanceof e)return t;if(e.name===t.constructor.name)throw new jr(Ur.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");t=Ip(t);throw new jr(Ur.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function Tp(t,e){if(e<=0)throw new jr(Ur.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Np,Ap=function(t){this.c_=t},Op=(n(Sp,Np=Ap),Sp.prototype.u_=function(t){if(2!==t.a_)throw 1===t.a_?t.h_(this.c_+"() can only appear at the top level of your update data"):t.h_(this.c_+"() cannot be used with set() unless you pass {merge:true}");return t.en.push(t.path),null},Sp.prototype.isEqual=function(t){return t instanceof Sp},Sp);function Sp(){return null!==Np&&Np.apply(this,arguments)||this}function Dp(t,e,n){return new Ey({a_:3,l_:e.settings.l_,methodName:t.c_,__:n},e.t,e.serializer,e.ignoreUndefinedProperties)}var xp,kp,Pp,Rp,Cp=(n(Xp,Rp=Ap),Xp.prototype.u_=function(t){return new Os(t.path,new ls)},Xp.prototype.isEqual=function(t){return t instanceof Xp},Xp),Lp=(n(Yp,Pp=Ap),Yp.prototype.u_=function(t){var e=Dp(this,t,!0),n=this.f_.map(function(t){return ky(t,e)}),n=new ps(n);return new Os(t.path,n)},Yp.prototype.isEqual=function(t){return this===t},Yp),Vp=(n(Qp,kp=Ap),Qp.prototype.u_=function(t){var e=Dp(this,t,!0),n=this.f_.map(function(t){return ky(t,e)}),n=new ms(n);return new Os(t.path,n)},Qp.prototype.isEqual=function(t){return this===t},Qp),Mp=(n(Hp,xp=Ap),Hp.prototype.u_=function(t){var e=new Is(t.serializer,jo(t.serializer,this.d_));return new Os(t.path,e)},Hp.prototype.isEqual=function(t){return this===t},Hp),Up=(Object.defineProperty(Wp.prototype,"latitude",{get:function(){return this.w_},enumerable:!1,configurable:!0}),Object.defineProperty(Wp.prototype,"longitude",{get:function(){return this.E_},enumerable:!1,configurable:!0}),Wp.prototype.isEqual=function(t){return this.w_===t.w_&&this.E_===t.E_},Wp.prototype.toJSON=function(){return{latitude:this.w_,longitude:this.E_}},Wp.prototype.C=function(t){return Jr(this.w_,t.w_)||Jr(this.E_,t.E_)},Wp),jp=(Kp.fromBase64String=function(t){try{return new Kp(Ii.fromBase64String(t))}catch(t){throw new jr(Ur.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},Kp.fromUint8Array=function(t){return new Kp(Ii.fromUint8Array(t))},Kp.prototype.toBase64=function(){return this.T_.toBase64()},Kp.prototype.toUint8Array=function(){return this.T_.toUint8Array()},Kp.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Kp.prototype.isEqual=function(t){return this.T_.isEqual(t.T_)},Kp),qp=new Map,Fp=(Gp.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Gp),Bp=(Object.defineProperty(zp.prototype,"app",{get:function(){if(!this.g_)throw new jr(Ur.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.g_},enumerable:!1,configurable:!0}),Object.defineProperty(zp.prototype,"y_",{get:function(){return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(zp.prototype,"V_",{get:function(){return void 0!==this.p_},enumerable:!1,configurable:!0}),zp.prototype.v_=function(t){if(this.A_)throw new jr(Ur.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.m_=new Fp(t),void 0!==t.credentials&&(this.P_=function(t){if(!t)return new qr;switch(t.type){case"gapi":var e=t.client;return Lr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new zr(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new jr(Ur.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},zp.prototype.b_=function(){return this.m_},zp.prototype.S_=function(){return this.A_=!0,this.m_},zp.prototype._delete=function(){return this.p_||(this.p_=this.D_()),this.p_},zp.prototype.D_=function(){return t=this,(e=qp.get(t))&&(xr("ComponentProvider","Removing Datastore"),qp.delete(t),e.terminate()),Promise.resolve();var t,e},zp);function zp(t,e){this.I_="(lite)",this.m_=new Fp({}),this.A_=!1,t instanceof Er?(this.R_=t,this.P_=new qr):(this.g_=t,this.R_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new jr(Ur.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Er(t.options.projectId)}(t),this.P_=new Fr(e))}function Gp(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new jr(Ur.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new jr(Ur.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,wp("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function Kp(t){this.T_=t}function Wp(t,e){if(!isFinite(t)||t<-90||90<t)throw new jr(Ur.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new jr(Ur.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.w_=t,this.E_=e}function Hp(t,e){var n=this;return(n=xp.call(this,t)||this).d_=e,n}function Qp(t,e){var n=this;return(n=kp.call(this,t)||this).f_=e,n}function Yp(t,e){var n=this;return(n=Pp.call(this,t)||this).f_=e,n}function Xp(){return null!==Rp&&Rp.apply(this,arguments)||this}function Jp(){if("undefined"==typeof Uint8Array)throw new jr(Ur.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function $p(){if("undefined"==typeof atob)throw new jr(Ur.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Zp,td,ed,nd=(n(hd,ed=jp),hd.fromBase64String=function(t){$p();try{return new hd(Ii.fromBase64String(t))}catch(t){throw new jr(Ur.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},hd.fromUint8Array=function(t){return Jp(),new hd(Ii.fromUint8Array(t))},hd.prototype.toBase64=function(){return $p(),ed.prototype.toBase64.call(this)},hd.prototype.toUint8Array=function(){return Jp(),ed.prototype.toUint8Array.call(this)},hd.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},hd),h=(cd.prototype.C_=function(t,e){switch(void 0===e&&(e="none"),wo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ao(t.integerValue||t.doubleValue);case 3:return this.N_(t.timestampValue);case 4:return this.x_(t,e);case 5:return t.stringValue;case 6:return this.F_(Oo(t.bytesValue));case 7:return this.O_(t.referenceValue);case 8:return this.M_(t.geoPointValue);case 9:return this.k_(t.arrayValue,e);case 10:return this.L_(t.mapValue,e);default:throw Cr()}},cd.prototype.L_=function(t,n){var r=this,i={};return po(t.fields||{},function(t,e){i[t]=r.C_(e,n)}),i},cd.prototype.M_=function(t){return new Up(Ao(t.latitude),Ao(t.longitude))},cd.prototype.k_=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.C_(t,e)})},cd.prototype.x_=function(t,e){switch(e){case"previous":var n=function t(e){e=e.mapValue.fields.__previous_value__;return vo(e)?t(e):e}(t);return null==n?null:this.C_(n,e);case"estimate":return this.N_(go(t));default:return null}},cd.prototype.N_=function(t){t=No(t);return new ni(t.seconds,t.nanos)},cd.prototype.B_=function(t,e){var n=ii.Y(t);Lr(as(n));t=new Er(n.get(1),n.get(3)),n=new ui(n.B(5));return t.isEqual(e)||kr("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},cd),rd=(n(ad,td=h),ad.prototype.F_=function(t){return new nd(t)},ad.prototype.O_=function(t){t=this.B_(t,this.firestore.R_);return Iv.q_(t,this.firestore,null)},ad),id=(Object.defineProperty(ud.prototype,"id",{get:function(){return this.K_.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(ud.prototype,"ref",{get:function(){return new Ld(this.U_,this.j_,this.K_)},enumerable:!1,configurable:!0}),ud.prototype.exists=function(){return null!==this.W_},ud.prototype.data=function(){if(this.W_){if(this.j_){var t=new od(this.U_,this.Q_,this.K_,this.W_,null);return this.j_.fromFirestore(t)}return this.Q_.C_(this.W_.En())}},ud.prototype.get=function(t){if(this.W_){t=this.W_.data().field(fd("DocumentSnapshot.get",t));if(null!==t)return this.Q_.C_(t)}},ud),od=(n(sd,Zp=id),sd.prototype.data=function(){return Zp.prototype.data.call(this)},sd);function sd(){return null!==Zp&&Zp.apply(this,arguments)||this}function ud(t,e,n,r,i){this.U_=t,this.Q_=e,this.K_=n,this.W_=r,this.j_=i}function ad(t){var e=this;return(e=td.call(this)||this).firestore=t,e}function cd(){}function hd(){return null!==ed&&ed.apply(this,arguments)||this}function fd(t,e){return"string"==typeof e?My(t,e):(e instanceof Jl?e.o_:e).G_}var ld,pd=(vd.prototype.isEqual=function(t){return this.G_.isEqual(t.G_)},vd),dd=(n(yd,ld=Bp),yd.prototype.D_=function(){return this.H_||vv(this),this.H_.terminate()},yd);function yd(t,e){var n=this;return(n=ld.call(this,t,e)||this).z_=new Ka,n.I_="name"in t?t.name:"[DEFAULT]",n}function vd(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new jr(Ur.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.G_=new si(t)}function gd(n,r,i){var t=this,o=new ca;return n.di.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,Wy(n,i)];case 1:return t.sent(),[4,Hy(n,r)];case 2:return t.sent(),o.resolve(),[3,4];case 3:if(!("FirebaseError"===(t=e=t.sent()).name?t.code===Ur.FAILED_PRECONDITION||t.code===Ur.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code))throw e;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),o.reject(e),[3,4];case 4:return[2]}})})}).then(function(){return o.promise})}function md(t){if(t.y_||t.V_)throw new jr(Ur.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var wd,bd,_d=(n(Ad,bd=id),Ad.prototype.exists=function(){return bd.prototype.exists.call(this)},Ad.prototype.data=function(t){if(void 0===t&&(t={}),this.W_){if(this.j_){var e=new Id(this.U_,this.Q_,this.K_,this.W_,this.metadata,null);return this.j_.fromFirestore(e,t)}return this.Q_.C_(this.W_.En(),t.serverTimestamps)}},Ad.prototype.get=function(t,e){if(void 0===e&&(e={}),this.W_){t=this.W_.data().field(fd("DocumentSnapshot.get",t));if(null!==t)return this.Q_.C_(t,e.serverTimestamps)}},Ad),Id=(n(Nd,wd=_d),Nd.prototype.data=function(t){return void 0===t&&(t={}),wd.prototype.data.call(this,t)},Nd),Ed=(Object.defineProperty(Td.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Td.prototype,"size",{get:function(){return this.Y_.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(Td.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),Td.prototype.forEach=function(e,n){var r=this;this.Y_.docs.forEach(function(t){e.call(n,new Id(r.U_,r.Q_,t.key,t,new Lv(r.Y_.ee.has(t.key),r.Y_.fromCache),r.query.j_))})},Td.prototype.docChanges=function(t){void 0===t&&(t={});t=!!t.includeMetadataChanges;if(t&&this.Y_.se)throw new jr(Ur.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.X_&&this.Z_===t||(this.X_=function(i,e){if(i.Y_.te.W()){var n=0;return i.Y_.docChanges.map(function(t){var e=new Id(i.U_,i.Q_,t.doc.key,t.doc,new Lv(i.Y_.ee.has(t.doc.key),i.Y_.fromCache),i.query.j_);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.Y_.te;return i.Y_.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new Id(i.U_,i.Q_,t.doc.key,t.doc,new Lv(i.Y_.ee.has(t.doc.key),i.Y_.fromCache),i.query.j_),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Cr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.Z_=t),this.X_},Td);function Td(t,e,n,r){this.U_=t,this.Q_=e,this.Y_=r,this.metadata=new Lv(r.hasPendingWrites,r.fromCache),this.query=n}function Nd(){return null!==wd&&wd.apply(this,arguments)||this}function Ad(t,e,n,r,i,o){var s=this;return(s=bd.call(this,t,e,n,r,o)||this).U_=t,s.J_=t,s.metadata=i,s}function Od(t,e){return t instanceof _d&&e instanceof _d?t.U_===e.U_&&t.K_.isEqual(e.K_)&&(null===t.W_?null===e.W_:t.W_.isEqual(e.W_))&&t.j_===e.j_:t instanceof Ed&&e instanceof Ed&&t.U_===e.U_&&yy(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.Y_.isEqual(e.Y_)}var Sd,Dd=(n(xd,Sd=h),xd.prototype.F_=function(t){return new jp(t)},xd.prototype.O_=function(t){t=this.B_(t,this.firestore.R_);return new Ld(this.firestore,null,t)},xd);function xd(t){var e=this;return(e=Sd.call(this)||this).firestore=t,e}function kd(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Ep(t.firestore,dd),s=vy(o);return e instanceof Jl&&(e=e.o_),Rd(o,("string"==typeof e||e instanceof pd?Dy(s,"updateDoc",t.K_,e,n,r):Sy(s,"updateDoc",t.K_,e)).ef(t.K_,xs.exists(!0)))}function Pd(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i={includeMetadataChanges:!1},o=0;"object"!=typeof n[o]||va(n[o])||(i=n[o],o++);var s,u,a,c,h,f={includeMetadataChanges:i.includeMetadataChanges};va(n[o])&&(a=n[o],n[o]=null===(i=a.next)||void 0===i?void 0:i.bind(a),n[o+1]=null===(i=a.error)||void 0===i?void 0:i.bind(a),n[o+2]=null===(i=a.complete)||void 0===i?void 0:i.bind(a)),e instanceof Ld?(s=Ep(e.firestore,dd),u=yu(e.K_.path),h={next:function(t){n[o]&&n[o](Cd(s,e,t))},error:n[o+1],complete:n[o+2]}):(s=Ep(e.firestore,dd),u=e.tf,c=new Dd(s),h={next:function(t){n[o]&&n[o](new Ed(s,c,e,t))},error:n[o+1],complete:n[o+2]},oy(e.tf));var l=yv(s),p=new Xl(h),d=new xf(u,p,f);return s.z_.Ri(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Of,[4,tv(l)];case 1:return[2,e.apply(void 0,[t.sent(),d])]}})})}),function(){p.r_(),s.z_.Ri(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Sf,[4,tv(l)];case 1:return[2,e.apply(void 0,[t.sent(),d])]}})})})}}function Rd(t,e){return function(n,r){var t=this,i=new ca;return n.di.Ri(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=al,[4,Zy(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(yv(t),e)}function Cd(t,e,n){var r=n.docs.get(e.K_),i=new Dd(t);return new _d(t,i,e.K_,r,new Lv(n.hasPendingWrites,n.fromCache),e.j_)}var Ld=(Object.defineProperty(Ud.prototype,"nf",{get:function(){return this.K_.path},enumerable:!1,configurable:!0}),Object.defineProperty(Ud.prototype,"id",{get:function(){return this.K_.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(Ud.prototype,"path",{get:function(){return this.K_.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(Ud.prototype,"parent",{get:function(){return new uy(this.firestore,this.j_,this.K_.path.q())},enumerable:!1,configurable:!0}),Ud.prototype.withConverter=function(t){return new Ud(this.firestore,t,this.K_)},Ud),Vd=(Md.prototype.withConverter=function(t){return new Md(this.firestore,t,this.tf)},Md),Ie=function(){};function Md(t,e,n){this.j_=e,this.tf=n,this.type="query",this.firestore=t}function Ud(t,e,n){this.j_=e,this.K_=n,this.type="document",this.firestore=t}function jd(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){t=i[r].sf(t)}return t}var qd,Fd,Bd,zd,Gd,Kd=(n(ty,Gd=Ie),ty.prototype.sf=function(t){var e=vy(t.firestore),e=function(t,e,n,r,i,o){if(r.tt()){if("array-contains"===i||"array-contains-any"===i)throw new jr(Ur.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){ry(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(ny(n,t,c))}h={arrayValue:{values:s}}}else h=ny(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||ry(o,i),h=xy(e,"where",o,"in"===i||"not-in"===i);var h=xu.create(r,i,h);return function(t,e){if(e.An()){var n=wu(t);if(null!==n&&!n.isEqual(e.field))throw new jr(Ur.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=mu(t);null!==n&&iy(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new jr(Ur.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new jr(Ur.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(t.tf,e,t.firestore.R_,this.rf,this.cf,this.uf);return new Vd(t.firestore,t.j_,(t=t.tf,e=t.filters.concat([e]),new hu(t.path,t.collectionGroup,t.Tn.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},ty),Wd=(n(Zd,zd=Ie),Zd.prototype.sf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new jr(Ur.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new jr(Ur.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new ia(e,n);return e=r,null!==mu(n=t)||null!==(t=wu(n))&&iy(0,t,e.field),r}(t.tf,this.rf,this.af);return new Vd(t.firestore,t.j_,(t=t.tf,e=t.Tn.concat([e]),new hu(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},Zd),Hd=(n($d,Bd=Ie),$d.prototype.sf=function(t){return new Vd(t.firestore,t.j_,Eu(t.tf,this.hf,this.lf))},$d),Qd=(n(Jd,Fd=Ie),Jd.prototype.sf=function(t){var e=ey(t,this.type,this._f,this.ff);return new Vd(t.firestore,t.j_,(t=t.tf,e=e,new hu(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},Jd),Yd=(n(Xd,qd=Ie),Xd.prototype.sf=function(t){var e=ey(t,this.type,this._f,this.ff);return new Vd(t.firestore,t.j_,(t=t.tf,e=e,new hu(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},Xd);function Xd(t,e,n){var r=this;return(r=qd.call(this)||this).type=t,r._f=e,r.ff=n,r}function Jd(t,e,n){var r=this;return(r=Fd.call(this)||this).type=t,r._f=e,r.ff=n,r}function $d(t,e,n){var r=this;return(r=Bd.call(this)||this).type=t,r.hf=e,r.lf=n,r}function Zd(t,e){var n=this;return(n=zd.call(this)||this).rf=t,n.af=e,n.type="orderBy",n}function ty(t,e,n){var r=this;return(r=Gd.call(this)||this).rf=t,r.cf=e,r.uf=n,r.type="where",r}function ey(t,c,e,n){if(e[0]instanceof Jl&&(e[0]=e[0].o_),e[0]instanceof id)return function(t,e,n,r){if(!n)throw new jr(Ur.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=_u(t);o<s.length;o++){var u=s[o];if(u.field.tt())i.push(So(e,n.key));else{var a=n.field(u.field);if(vo(a))throw new jr(Ur.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.J();throw new jr(Ur.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Xu(i,r)}(t.tf,t.firestore.R_,e[0].W_,n);var r=vy(t.firestore);return function(t,e,n,r,i,o){var s=t.Tn;if(i.length>s.length)throw new jr(Ur.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.tt()){if("string"!=typeof c)throw new jr(Ur.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!bu(t)&&-1!==c.indexOf("/"))throw new jr(Ur.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(ii.Y(c));if(!ui.ot(h))throw new jr(Ur.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new ui(h);u.push(So(e,h))}else{c=xy(n,r,c);u.push(c)}}return new Xu(u,o)}(t.tf,t.firestore.R_,r,c,e,n)}function ny(t,e,n){if(n instanceof Jl&&(n=n.o_),"string"==typeof n){if(""===n)throw new jr(Ur.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!bu(e)&&-1!==n.indexOf("/"))throw new jr(Ur.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(ii.Y(n));if(!ui.ot(e))throw new jr(Ur.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return So(t,new ui(e))}if(n instanceof Ld)return So(t,n.K_);throw new jr(Ur.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Ip(n)+".")}function ry(t,e){if(!Array.isArray(t)||0===t.length)throw new jr(Ur.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new jr(Ur.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function iy(t,e,n){if(!n.isEqual(e))throw new jr(Ur.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function oy(t){if(gu(t)&&0===t.Tn.length)throw new jr(Ur.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var sy,uy=(n(ay,sy=Vd),Object.defineProperty(ay.prototype,"id",{get:function(){return this.tf.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(ay.prototype,"path",{get:function(){return this.tf.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(ay.prototype,"parent",{get:function(){var t=this.nf.q();return t.W()?null:new Ld(this.firestore,null,new ui(t))},enumerable:!1,configurable:!0}),ay.prototype.withConverter=function(t){return new ay(this.firestore,t,this.nf)},ay);function ay(t,e,n){var r=this;return(r=sy.call(this,t,e,yu(n))||this).firestore=t,r.nf=n,r.type="collection",r}function cy(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(gp("collection","path",e),t instanceof Bp){var i=ii.Y.apply(ii,s([e],n));return _p(i),new uy(t,null,i)}if(!(t instanceof Ld||t instanceof uy))throw new jr(Ur.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");e=ii.Y.apply(ii,s([t.path],n)).child(ii.Y(e));return _p(e),new uy(t.firestore,null,e)}function hy(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(1===arguments.length&&(e=Yr.D()),gp("doc","path",e),t instanceof Bp){var i=ii.Y.apply(ii,s([e],n));return bp(i),new Ld(t,null,new ui(i))}if(!(t instanceof Ld||t instanceof uy))throw new jr(Ur.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");e=t.nf.child(ii.Y.apply(ii,s([e],n)));return bp(e),new Ld(t.firestore,t instanceof uy?t.j_:null,new ui(e))}var fy,ly=(n(py,fy=h),py.prototype.F_=function(t){return new jp(t)},py.prototype.O_=function(t){t=this.B_(t,this.firestore.R_);return new Ld(this.firestore,null,t)},py);function py(t){var e=this;return(e=fy.call(this)||this).firestore=t,e}function dy(t,e){return(t instanceof Ld||t instanceof uy)&&(e instanceof Ld||e instanceof uy)&&t.firestore===e.firestore&&t.path===e.path&&t.j_===e.j_}function yy(t,e){return t instanceof Vd&&e instanceof Vd&&t.firestore===e.firestore&&Tu(t.tf,e.tf)&&t.j_===e.j_}function vy(t){var e=t.S_(),n=ya(t.R_);return new Ty(t.R_,!!e.ignoreUndefinedProperties,n)}var gy=/^__.*__$/,my=(_y.prototype.ef=function(t,e){var n=[];return null!==this.en?n.push(new qs(t,this.data,this.en,e)):n.push(new js(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Ks(t,this.fieldTransforms)),n},_y),wy=(by.prototype.ef=function(t,e){e=[new qs(t,this.data,this.en,e)];return 0<this.fieldTransforms.length&&e.push(new Ks(t,this.fieldTransforms)),e},by);function by(t,e,n){this.data=t,this.en=e,this.fieldTransforms=n}function _y(t,e,n){this.data=t,this.en=e,this.fieldTransforms=n}function Iy(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Cr()}}var Ey=(Object.defineProperty(Ay.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Ay.prototype,"a_",{get:function(){return this.settings.a_},enumerable:!1,configurable:!0}),Ay.prototype.wf=function(t){return new Ay(Object.assign(Object.assign({},this.settings),t),this.t,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.en)},Ay.prototype.Ef=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.wf({path:e,__:!1});return e.Tf(t),e},Ay.prototype.If=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.wf({path:t,__:!1});return t.df(),t},Ay.prototype.mf=function(t){return this.wf({path:void 0,__:!0})},Ay.prototype.h_=function(t){return Uy(t,this.settings.methodName,this.settings.Af||!1,this.path,this.settings.l_)},Ay.prototype.contains=function(e){return void 0!==this.en.find(function(t){return e.j(t)})||void 0!==this.fieldTransforms.find(function(t){return e.j(t.field)})},Ay.prototype.df=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Tf(this.path.get(t))},Ay.prototype.Tf=function(t){if(0===t.length)throw this.h_("Document fields must not be empty");if(Iy(this.a_)&&gy.test(t))throw this.h_('Document fields cannot begin and end with "__"')},Ay),Ty=(Ny.prototype.Rf=function(t,e,n,r){return void 0===r&&(r=!1),new Ey({a_:t,methodName:e,l_:n,path:si.X(),__:!1,Af:r},this.t,this.serializer,this.ignoreUndefinedProperties)},Ny);function Ny(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.serializer=n||ya(t)}function Ay(t,e,n,r,i,o){this.settings=t,this.t=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.df(),this.fieldTransforms=i||[],this.en=o||[]}function Oy(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Rf(o.merge||o.mergeFields?2:0,e,n,i);Cy("Data must be an object, but it was:",s,r);var u,a,r=Py(r,s);if(o.merge)u=new As(s.en),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=Ly(e,f[h],n);if(!s.contains(l))throw new jr(Ur.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");jy(c,l)||c.push(l)}u=new As(c),a=s.fieldTransforms.filter(function(t){return u.un(t.field)})}else u=null,a=s.fieldTransforms;return new my(new $s(r),u,a)}function Sy(t,r,i,e){var o=t.Rf(1,r,i);Cy("Data must be an object, but it was:",o,e);var s=[],u=new Zs;po(e,function(t,e){var n=My(r,t,i);e instanceof Jl&&(e=e.o_);t=o.If(n);e instanceof Op?s.push(n):null!=(t=ky(e,t))&&(s.push(n),u.set(n,t))});e=new As(s);return new wy(u.hn(),e,o.fieldTransforms)}function Dy(t,e,n,r,i,o){var s=t.Rf(1,e,n),u=[Ly(e,r,n)],a=[i];if(o.length%2!=0)throw new jr(Ur.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Ly(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new Zs,y=u.length-1;0<=y;--y){jy(p,u[y])||(h=u[y],(f=a[y])instanceof Jl&&(f=f.o_),l=s.If(h),f instanceof Op?p.push(h):null!=(l=ky(f,l))&&(p.push(h),d.set(h,l)))}i=new As(p);return new wy(d.hn(),i,s.fieldTransforms)}function xy(t,e,n,r){return void 0===r&&(r=!1),ky(n,t.Rf(r?4:3,e))}function ky(s,t){if(s instanceof Jl&&(s=s.o_),Ry(s))return Cy("Unsupported field value:",t,s),Py(s,t);if(s instanceof Ap)return function(t,e){if(!Iy(e.a_))throw e.h_(t.c_+"() can only be used with update() and set()");if(!e.path)throw e.h_(t.c_+"() is not currently supported inside arrays");t=t.u_(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.en.push(t.path),s instanceof Array){if(t.settings.__&&4!==t.a_)throw t.h_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=ky(i[r],t.mf(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof Jl&&(t=t.o_),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return jo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ni.fromDate(t);return{timestampValue:qo(e.serializer,n)}}if(t instanceof ni){var r=new ni(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:qo(e.serializer,r)}}if(t instanceof Up)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof jp)return{bytesValue:Fo(e.serializer,t.T_)};if(t instanceof Ld){n=e.t,r=t.firestore.R_;if(!r.isEqual(n))throw e.h_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:zo(t.firestore.R_||e.t,t.K_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.h_("Unsupported field value: "+Ip(t))}(s,t)}function Py(t,n){var r={};return yo(t)?n.path&&0<n.path.length&&n.en.push(n.path):po(t,function(t,e){e=ky(e,n.Ef(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function Ry(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ni||t instanceof Up||t instanceof jp||t instanceof Ld||t instanceof Ap)}function Cy(t,e,n){if(!Ry(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){n=Ip(n);throw"an object"===n?e.h_(t+" a custom object"):e.h_(t+" "+n)}var r}function Ly(t,e,n){if(e instanceof Jl&&(e=e.o_),e instanceof pd)return e.G_;if("string"==typeof e)return My(t,e);throw Uy("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Vy=new RegExp("[~\\*/\\[\\]]");function My(e,n,r){if(0<=n.search(Vy))throw Uy("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(pd.bind.apply(pd,s([void 0],n.split("."))))).G_}catch(t){throw Uy("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function Uy(t,e,n,r,i){var o=r&&!r.W(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new jr(Ur.INVALID_ARGUMENT,(e+=". ")+t+n)}function jy(t,e){return t.some(function(t){return t.isEqual(e)})}var qy=(Ky.prototype.pf=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.vf(),0<this.mutations.length)throw new jr(Ur.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var n,e,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=Yo((n=s).serializer)+"/documents",r={documents:u.map(function(t){return Ko(n.serializer,t)})},[4,n.Ru("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.serializer,"found"in(t=t)?function(t,e){Lr(!!e.found),e.found.name,e.found.updateTime;var n=Wo(t,e.found.name),t=Bo(e.found.updateTime),e=new $s({mapValue:{fields:e.found.fields}});return new uu(n,t,e,{})}(e,t):"missing"in t?function(t,e){Lr(!!e.missing),Lr(!!e.readTime);t=Wo(t,e.missing),e=Bo(e.readTime);return new au(t,e)}(e,t):Cr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());Lr(!!t),o.push(t)}),o)]}})})}(this.Nu,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof au||t instanceof uu?n.bf(t):Cr()}),e)]}})})},Ky.prototype.set=function(t,e){this.write(e.ef(t,this.rn(t))),this.Vf.add(t.toString())},Ky.prototype.update=function(t,e){try{this.write(e.ef(t,this.Sf(t)))}catch(t){this.yf=t}this.Vf.add(t.toString())},Ky.prototype.delete=function(t){this.write([new Xs(t,this.rn(t))]),this.Vf.add(t.toString())},Ky.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.vf(),this.yf)throw this.yf;return e=this.Pf,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=ui.st(e);n.mutations.push(new Js(e,n.rn(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=Yo((e=i).serializer)+"/documents",r={writes:o.map(function(t){return $o(e.serializer,t)})},[4,e.Au("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Nu,this.mutations)];case 1:return t.sent(),this.gf=!0,[2]}})})},Ky.prototype.bf=function(t){var e;if(t instanceof uu)e=t.version;else{if(!(t instanceof au))throw Cr();e=ri.min()}var n=this.Pf.get(t.key.toString());if(n){if(!e.isEqual(n))throw new jr(Ur.ABORTED,"Document version changed between two reads.")}else this.Pf.set(t.key.toString(),e)},Ky.prototype.rn=function(t){var e=this.Pf.get(t.toString());return!this.Vf.has(t.toString())&&e?xs.updateTime(e):xs.on()},Ky.prototype.Sf=function(t){var e=this.Pf.get(t.toString());if(this.Vf.has(t.toString())||!e)return xs.exists(!0);if(e.isEqual(ri.min()))throw new jr(Ur.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return xs.updateTime(e)},Ky.prototype.write=function(t){this.vf(),this.mutations=this.mutations.concat(t)},Ky.prototype.vf=function(){},Ky),Fy=(Gy.prototype.run=function(){this.Cf()},Gy.prototype.Cf=function(){var t=this;this.Si.Bs(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new qy(this.Nu),(n=this.Nf(e))&&n.then(function(t){r.di.Ri(function(){return e.commit().then(function(){r.Ti.resolve(t)}).catch(function(t){r.xf(t)})})}).catch(function(t){r.xf(t)}),[2]})})})},Gy.prototype.Nf=function(t){try{var e=this.updateFunction(t);return!di(e)&&e.catch&&e.then?e:(this.Ti.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ti.reject(t),null}},Gy.prototype.xf=function(t){var e=this;0<this.Df&&this.Ff(t)?(--this.Df,this.di.Ri(function(){return e.Cf(),Promise.resolve()})):this.Ti.reject(t)},Gy.prototype.Ff=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!Si(t)},Gy),By=(zy.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.g.promise];case 1:return[2,(t.sent(),{di:this.di,Fl:this.Fl,clientId:this.clientId,credentials:this.credentials,Yl:this.user,$h:100})]}})})},zy.prototype.Mf=function(t){var e=this;this.Of=t,this.g.promise.then(function(){return e.Of(e.user)})},zy.prototype.kf=function(){if(this.di.Ci)throw new jr(Ur.FAILED_PRECONDITION,"The client has already been terminated.")},zy.prototype.terminate=function(){var t=this;this.di.Oi();var n=new ca;return this.di.Ni(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.$f?[4,this.$f.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.Lf?[4,this.Lf.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.R(),n.resolve(),[3,6];case 5:return e=t.sent(),e=Qa(e,"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},zy);function zy(t,e,n){var r=this;this.credentials=t,this.di=e,this.Fl=n,this.user=Tr.UNAUTHENTICATED,this.clientId=Yr.D(),this.Of=function(){},this.g=new ca,this.credentials.A(function(t){xr("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.Of(t)),r.g.resolve()})}function Gy(t,e,n,r){this.di=t,this.Nu=e,this.updateFunction=n,this.Ti=r,this.Df=5,this.Si=new Aa(this.di,"transaction_retry")}function Ky(t){this.Nu=t,this.Pf=new Map,this.mutations=[],this.gf=!1,this.yf=null,this.Vf=new Set}function Wy(r,i){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return r.di.Li(),xr("FirestoreClient","Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return e=t.sent(),[4,i.initialize(e)];case 2:return t.sent(),r.Mf(function(e){return r.di.Mi(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Lh(i.Cu,e)];case 1:return t.sent(),[2]}})})})}),i.persistence.tc(function(){return r.terminate()}),r.Lf=i,[2]}})})}function Hy(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.di.Li(),[4,Qy(r)];case 1:return e=t.sent(),xr("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.Mf(function(t){return r.di.Mi(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).di.Li(),xr("RemoteStore","RemoteStore received new credentials"),n=df(e),e.Mu.add(3),[4,uf(e)];case 1:return t.sent(),n&&e.Bu.set("Unknown"),[4,e.xu.s_(i)];case 2:return t.sent(),e.Mu.delete(3),[4,sf(e)];case 3:return t.sent(),[2]}})})}(i.Oh,t)})}),r.$f=i,[2]}})})}function Qy(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.Lf?[3,2]:(xr("FirestoreClient","Using default OfflineComponentProvider"),[4,Wy(e,new Wl)]);case 1:t.sent(),t.label=2;case 2:return[2,e.Lf]}})})}function Yy(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.$f?[3,2]:(xr("FirestoreClient","Using default OnlineComponentProvider"),[4,Hy(e,new Yl)]);case 1:t.sent(),t.label=2;case 2:return[2,e.$f]}})})}function Xy(t){return Qy(t).then(function(t){return t.persistence})}function Jy(t){return Qy(t).then(function(t){return t.Cu})}function $y(t){return Yy(t).then(function(t){return t.Oh})}function Zy(t){return Yy(t).then(function(t){return t.ga})}function tv(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Yy(r)];case 1:return e=t.sent(),[2,((n=e.Mh).Ju=function(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=Nl(s),(o=e.Bh.get(u))?(n=o.targetId,e.kh.Wa(n),r=o.view.xh(),[3,4]):[3,1];case 1:return[4,jh(e.Cu,Iu(u))];case 2:return i=t.sent(),o=e.kh.Wa(i.targetId),n=i.targetId,[4,ul(e,u,n,"current"===o)];case 3:r=t.sent(),e.Jh&&af(e.Oh,i),t.label=4;case 4:return[2,r]}})})}.bind(null,e.ga),n.Zu=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Bh.get(o),1<(r=e.qh.get(n.targetId)).length?[2,(e.qh.set(n.targetId,r.filter(function(t){return!Tu(t,o)})),void e.Bh.delete(o))]:e.Jh?(e.kh.Ga(n.targetId),e.kh.Ba(n.targetId)?[3,2]:[4,qh(e.Cu,n.targetId,!1).then(function(){e.kh.Ha(n.targetId),cf(e.Oh,n.targetId),yl(e,n.targetId)}).catch(Kh)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return yl(e,n.targetId),[4,qh(e.Cu,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.ga),n)]}})})}function ev(n,r,i,o,s){var t=new Xl({next:function(t){r.Ri(function(){return Sf(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new jr(Ur.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new jr(Ur.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new xf(yu(i.path),t,{includeMetadataChanges:!0,oa:!0});return Of(n,u)}function nv(e,n,t,r,i){var o=new Xl({next:function(t){n.Ri(function(){return Sf(e,s)}),t.fromCache&&"server"===r.source?i.reject(new jr(Ur.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new xf(t,o,{includeMetadataChanges:!0,oa:!0});return Of(e,s)}var rv=(iv.prototype.set=function(t,e,n){this.Kf();t=ov(t,this.U_),e=Xv(t.j_,e,n),n=Oy(this.Qf,"WriteBatch.set",t.K_,e,null!==t.j_,n);return this.qf=this.qf.concat(n.ef(t.K_,xs.on())),this},iv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.Kf();t=ov(t,this.U_);return e instanceof Jl&&(e=e.o_),e="string"==typeof e||e instanceof pd?Dy(this.Qf,"WriteBatch.update",t.K_,e,n,r):Sy(this.Qf,"WriteBatch.update",t.K_,e),this.qf=this.qf.concat(e.ef(t.K_,xs.exists(!0))),this},iv.prototype.delete=function(t){this.Kf();t=ov(t,this.U_);return this.qf=this.qf.concat(new Xs(t.K_,xs.on())),this},iv.prototype.commit=function(){return this.Kf(),this.Uf=!0,0<this.qf.length?this.Bf(this.qf):Promise.resolve()},iv.prototype.Kf=function(){if(this.Uf)throw new jr(Ur.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},iv);function iv(t,e){this.U_=t,this.Bf=e,this.qf=[],this.Uf=!1,this.Qf=vy(t)}function ov(t,e){if(t instanceof Jl&&(t=t.o_),t.firestore!==e)throw new jr(Ur.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var sv,uv,av=(dv.prototype.get=function(t){var e=this,n=ov(t,this.U_),r=new ly(this.U_);return this.Wf.pf([n.K_]).then(function(t){if(!t||1!==t.length)return Cr();t=t[0];if(t instanceof au)return new id(e.U_,r,n.K_,null,n.j_);if(t instanceof uu)return new id(e.U_,r,t.key,t,n.j_);throw Cr()})},dv.prototype.set=function(t,e,n){t=ov(t,this.U_),e=Xv(t.j_,e,n),n=Oy(this.Qf,"Transaction.set",t.K_,e,null!==t.j_,n);return this.Wf.set(t.K_,n),this},dv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=ov(t,this.U_);return e instanceof Jl&&(e=e.o_),e="string"==typeof e||e instanceof pd?Dy(this.Qf,"Transaction.update",t.K_,e,n,r):Sy(this.Qf,"Transaction.update",t.K_,e),this.Wf.update(t.K_,e),this},dv.prototype.delete=function(t){t=ov(t,this.U_);return this.Wf.delete(t.K_),this},n(pv,uv=dv),pv.prototype.get=function(t){var e=this,n=ov(t,this.U_),r=new Dd(this.U_);return uv.prototype.get.call(this,t).then(function(t){return new _d(e.U_,r,n.K_,t.W_,new Lv(!1,!1),n.j_)})},pv),cv=(lv.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){md(t);var n=yv(t),r=t.S_(),t=new Yl;return gd(n,t,new Hl(t,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t.o_,{forceOwnership:e})},lv.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){md(t);var e=yv(t),n=t.S_(),t=new Yl;return gd(e,t,new Ql(t,n.cacheSizeBytes))}(t.o_)},lv.prototype.clearIndexedDbPersistence=function(t){return function(n){var t=this;if(n.y_&&!n.V_)throw new jr(Ur.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var r=new ca;return n.z_.Ni(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return Oa.Gs()?(e=n+"main",[4,Oa.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(kh(n.R_,n.I_))];case 1:return t.sent(),r.resolve(),[3,3];case 2:return e=t.sent(),r.reject(e),[3,3];case 3:return[2]}})})}),r.promise}(t.o_)},lv),hv=(n(fv,sv=Jl),Object.defineProperty(fv.prototype,"R_",{get:function(){return this.o_.R_},enumerable:!1,configurable:!0}),fv.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.o_.b_()),t)).merge,this.o_.v_(t)},fv.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.o_.b_().host&&Pr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},fv.prototype.enableNetwork=function(){return function(r){var t=this;return r.di.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Xy(r)];case 1:return e=t.sent(),[4,$y(r)];case 2:return n=t.sent(),[2,(e.ec(!0),(t=n).Mu.delete(0),sf(t))]}})})})}(yv(this.o_))},fv.prototype.disableNetwork=function(){return function(r){var t=this;return r.di.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Xy(r)];case 1:return e=t.sent(),[4,$y(r)];case 2:return n=t.sent(),[2,(e.ec(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Mu.add(0),[4,uf(e)];case 1:return t.sent(),e.Bu.set("Offline"),[2]}})})}(n))]}})})})}(yv(this.o_))},fv.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&wp("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.jf.enableMultiTabIndexedDbPersistence(this):this.jf.enableIndexedDbPersistence(this,n)},fv.prototype.clearPersistence=function(){return this.jf.clearIndexedDbPersistence(this)},fv.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this.o_._delete()},fv.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new ca;return n.di.Ri(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=ll,[4,Zy(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(yv(this.o_))},fv.prototype.onSnapshotsInSync=function(t){return function(t,e){var n=this,r=yv(t),e=va(e)?e:{next:e},i=new Xl(e);return t.z_.Ri(function(){return y(n,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Hu.add(e),e.next()},[4,tv(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})}),function(){i.r_(),t.z_.Ri(function(){return y(n,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Hu.delete(e)},[4,tv(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})})}}(this.o_,t)},Object.defineProperty(fv.prototype,"app",{get:function(){if(!this.Gf)throw new jr(Ur.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Gf},enumerable:!1,configurable:!0}),fv.prototype.collection=function(t){try{return new Fv(this,cy(this.o_,t))}catch(t){throw Av(t,"collection()","Firestore.collection()")}},fv.prototype.doc=function(t){try{return new Iv(this,hy(this.o_,t))}catch(t){throw Av(t,"doc()","Firestore.doc()")}},fv.prototype.collectionGroup=function(t){try{return new Uv(this,function(t,e){if(gp("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new jr(Ur.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Vd(t,null,(e=e,new hu(ii.X(),e)))}(this.o_,t))}catch(t){throw Av(t,"collectionGroup()","Firestore.collectionGroup()")}},fv.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new ca;return n.di.Ri(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,Yy(n).then(function(t){return t.Nu})];case 1:return e=t.sent(),new Fy(n.di,e,r,i).run(),[2]}})})}),i.promise}(yv(n=this.o_),function(t){return t=new av(n,t),e(new bv(r,t))})},fv.prototype.batch=function(){var e=this;return yv(this.o_),new _v(new rv(this.o_,function(t){return Rd(e.o_,t)}))},fv);function fv(t,e,n){var r=this;return(r=sv.call(this,e)||this).jf=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof Er||(r.Gf=t),r}function lv(){}function pv(t,e){var n=this;return(n=uv.call(this,t,e)||this).U_=t,n}function dv(t,e){this.U_=t,this.Wf=e,this.Qf=vy(t)}function yv(t){return t.H_||vv(t),t.H_.kf(),t.H_}function vv(t){var e,n,r=t.S_(),r=(e=t.R_,n=t.I_,new Ir(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.H_=new By(t.P_,t.z_,r)}var gv,mv,wv,bv=(n(Nv,wv=Jl),Nv.prototype.get=function(t){var e=this,t=Yv(t);return this.o_.get(t).then(function(t){return new Vv(e.U_,t)})},Nv.prototype.set=function(t,e,n){t=Yv(t);return n?(mp("Transaction.set",n),this.o_.set(t,e,n)):this.o_.set(t,e),this},Nv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Yv(t);return 2===arguments.length?this.o_.update(o,e):(t=this.o_).update.apply(t,s([o,e,n],r)),this},Nv.prototype.delete=function(t){t=Yv(t);return this.o_.delete(t),this},Nv),_v=(n(Tv,mv=Jl),Tv.prototype.set=function(t,e,n){t=Yv(t);return n?(mp("WriteBatch.set",n),this.o_.set(t,e,n)):this.o_.set(t,e),this},Tv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Yv(t);return 2===arguments.length?this.o_.update(o,e):(t=this.o_).update.apply(t,s([o,e,n],r)),this},Tv.prototype.delete=function(t){t=Yv(t);return this.o_.delete(t),this},Tv.prototype.commit=function(){return this.o_.commit()},Tv),Iv=(n(Ev,gv=Jl),Ev.zf=function(t,e,n){if(t.length%2!=0)throw new jr(Ur.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.J()+" has "+t.length);return new Ev(e,new Ld(e.o_,n,new ui(t)))},Ev.q_=function(t,e,n){return new Ev(e,new Ld(e.o_,n,t))},Object.defineProperty(Ev.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(Ev.prototype,"parent",{get:function(){return new Fv(this.firestore,this.o_.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(Ev.prototype,"path",{get:function(){return this.o_.path},enumerable:!1,configurable:!0}),Ev.prototype.collection=function(t){try{return new Fv(this.firestore,cy(this.o_,t))}catch(t){throw Av(t,"collection()","DocumentReference.collection()")}},Ev.prototype.isEqual=function(t){return t instanceof Jl&&(t=t.o_),t instanceof Ld&&dy(this.o_,t)},Ev.prototype.set=function(t,e){e=mp("DocumentReference.set",e);try{return n=this.o_,r=t,i=e,o=Ep(n.firestore,dd),r=Xv(n.j_,r,i),Rd(o,Oy(vy(o),"setDoc",n.K_,r,null!==n.j_,i).ef(n.K_,xs.on()))}catch(t){throw Av(t,"setDoc()","DocumentReference.set()")}var n,r,i,o},Ev.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?kd(this.o_,t):kd.apply(void 0,s([this.o_,t,e],n))}catch(t){throw Av(t,"updateDoc()","DocumentReference.update()")}},Ev.prototype.delete=function(){return Rd(Ep((t=this.o_).firestore,dd),[new Xs(t.K_,xs.on())]);var t},Ev.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Ov(t),i=Sv(t,function(t){return new Vv(e.firestore,new _d(e.firestore.o_,e.Q_,t.K_,t.W_,t.metadata,e.o_.j_))});return Pd(this.o_,r,i)},Ev.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){var t=this,n=Ep(e.firestore,dd),r=yv(n),i=new Dd(n),o=new ca;return n.z_.Ri(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Jy(r)];case 1:return[4,function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.Oc.cs(t,e)}))];case 1:return(r=t.sent())instanceof uu?s.resolve(r):r instanceof au?s.resolve(null):s.reject(new jr(Ur.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),r=Qa(r,"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(t.sent(),e.K_,o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new _d(n,i,e.K_,t,new Lv(t instanceof uu&&t.an,!0),e.j_)})}:"server"===(null==t?void 0:t.source)?function(e){var t=this,n=Ep(e.firestore,dd),r=yv(n),i=new ca;return n.z_.Ri(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,tv(r)];case 1:return[4,ev(t.sent(),n.z_,e.K_,{source:"server"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return Cd(n,e,t)})}:function(e){var t=this,n=Ep(e.firestore,dd),r=yv(n),i=new ca;return n.z_.Ri(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,tv(r)];case 1:return[4,ev(t.sent(),n.z_,e.K_,{source:"default"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return Cd(n,e,t)})})(this.o_).then(function(t){return new Vv(e.firestore,new _d(e.firestore.o_,e.Q_,t.K_,t.W_,t.metadata,e.o_.j_))})},Ev.prototype.withConverter=function(t){return new Ev(this.firestore,this.o_.withConverter(t))},Ev);function Ev(t,e){var n=this;return(n=gv.call(this,e)||this).firestore=t,n.Q_=new rd(t),n}function Tv(){return null!==mv&&mv.apply(this,arguments)||this}function Nv(t,e){var n=this;return(n=wv.call(this,e)||this).U_=t,n}function Av(t,e,n){return t.message=t.message.replace(e,n),t}function Ov(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!va(r))return r}return{}}function Sv(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=va(t[0])?t[0]:va(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var Dv,xv,kv,Pv,Rv,Cv,Lv=(Qv.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Qv),Vv=(n(Hv,Cv=Jl),Object.defineProperty(Hv.prototype,"ref",{get:function(){return new Iv(this.U_,this.o_.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(Hv.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(Hv.prototype,"metadata",{get:function(){return this.o_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Hv.prototype,"exists",{get:function(){return this.o_.exists()},enumerable:!1,configurable:!0}),Hv.prototype.data=function(t){return this.o_.data(t)},Hv.prototype.get=function(t,e){return this.o_.get(t,e)},Hv.prototype.isEqual=function(t){return Od(this.o_,t.o_)},Hv),Mv=(n(Wv,Rv=Vv),Wv.prototype.data=function(t){return this.o_.data(t)},Wv),Uv=(n(Kv,Pv=Jl),Kv.prototype.where=function(t,e,n){try{return new Kv(this.firestore,jd(this.o_,(r=n,i=e,o=fd("where",t),new Kd(o,i,r))))}catch(t){throw Av(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},Kv.prototype.orderBy=function(n,t){try{return new Kv(this.firestore,jd(this.o_,function(t){void 0===t&&(t="asc");var e=t,t=fd("orderBy",n);return new Wd(t,e)}(t)))}catch(n){throw Av(n,/(orderBy|where)\(\)/,"Query.$1()")}},Kv.prototype.limit=function(t){try{return new Kv(this.firestore,jd(this.o_,(Tp("limit",e=t),new Hd("limit",e,"F"))))}catch(t){throw Av(t,"limit()","Query.limit()")}var e},Kv.prototype.limitToLast=function(t){try{return new Kv(this.firestore,jd(this.o_,(Tp("limitToLast",e=t),new Hd("limitToLast",e,"L"))))}catch(t){throw Av(t,"limitToLast()","Query.limitToLast()")}var e},Kv.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Kv(this.firestore,jd(this.o_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Qd("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw Av(t,"startAt()","Query.startAt()")}},Kv.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Kv(this.firestore,jd(this.o_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Qd("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw Av(t,"startAfter()","Query.startAfter()")}},Kv.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Kv(this.firestore,jd(this.o_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Yd("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw Av(t,"endBefore()","Query.endBefore()")}},Kv.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Kv(this.firestore,jd(this.o_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Yd("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw Av(t,"endAt()","Query.endAt()")}},Kv.prototype.isEqual=function(t){return yy(this.o_,t.o_)},Kv.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){var t=this,n=Ep(e.firestore,dd),r=yv(n),i=new Dd(n),o=new ca;return n.z_.Ri(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Jy(r)];case 1:return[4,function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Fh(r,i,!0)];case 1:return n=t.sent(),e=new Qf(i,n.Bc),n=e.gh(n.documents),n=e.Zn(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),n=Qa(n,"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(t.sent(),e.tf,o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new Ed(n,i,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){var t=this,n=Ep(e.firestore,dd),r=yv(n),i=new Dd(n),o=new ca;return n.z_.Ri(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,tv(r)];case 1:return[4,nv(t.sent(),n.z_,e.tf,{source:"server"},o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new Ed(n,i,e,t)})}:function(e){var t=this,n=Ep(e.firestore,dd),r=yv(n),i=new Dd(n);oy(e.tf);var o=new ca;return n.z_.Ri(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,tv(r)];case 1:return[4,nv(t.sent(),n.z_,e.tf,{source:"default"},o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new Ed(n,i,e,t)})})(this.o_).then(function(t){return new qv(e.firestore,t)})},Kv.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Ov(t),i=Sv(t,function(t){return new qv(e.firestore,t)});return Pd(this.o_,r,i)},Kv.prototype.withConverter=function(t){return new Kv(this.firestore,this.o_.withConverter(t))},Kv),jv=(n(Gv,kv=Jl),Object.defineProperty(Gv.prototype,"type",{get:function(){return this.o_.type},enumerable:!1,configurable:!0}),Object.defineProperty(Gv.prototype,"doc",{get:function(){return new Mv(this.U_,this.o_.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(Gv.prototype,"oldIndex",{get:function(){return this.o_.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(Gv.prototype,"newIndex",{get:function(){return this.o_.newIndex},enumerable:!1,configurable:!0}),Gv),qv=(n(zv,xv=Jl),Object.defineProperty(zv.prototype,"query",{get:function(){return new Uv(this.U_,this.o_.query)},enumerable:!1,configurable:!0}),Object.defineProperty(zv.prototype,"metadata",{get:function(){return this.o_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(zv.prototype,"size",{get:function(){return this.o_.size},enumerable:!1,configurable:!0}),Object.defineProperty(zv.prototype,"empty",{get:function(){return this.o_.empty},enumerable:!1,configurable:!0}),Object.defineProperty(zv.prototype,"docs",{get:function(){var e=this;return this.o_.docs.map(function(t){return new Mv(e.U_,t)})},enumerable:!1,configurable:!0}),zv.prototype.docChanges=function(t){var e=this;return this.o_.docChanges(t).map(function(t){return new jv(e.U_,t)})},zv.prototype.forEach=function(e,n){var r=this;this.o_.forEach(function(t){e.call(n,new Mv(r.U_,t))})},zv.prototype.isEqual=function(t){return Od(this.o_,t.o_)},zv),Fv=(n(Bv,Dv=Uv),Object.defineProperty(Bv.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(Bv.prototype,"path",{get:function(){return this.o_.path},enumerable:!1,configurable:!0}),Object.defineProperty(Bv.prototype,"parent",{get:function(){var t=this.o_.parent;return t?new Iv(this.firestore,t):null},enumerable:!1,configurable:!0}),Bv.prototype.doc=function(t){try{return new Iv(this.firestore,void 0===t?hy(this.o_):hy(this.o_,t))}catch(t){throw Av(t,"doc()","CollectionReference.doc()")}},Bv.prototype.add=function(t){var e,n,r,i=this;return e=this.o_,n=t,t=Ep(e.firestore,dd),r=hy(e),n=Xv(e.j_,n),Rd(t,Oy(vy(e.firestore),"addDoc",r.K_,n,null!==e.j_,{}).ef(r.K_,xs.exists(!1))).then(function(){return r}).then(function(t){return new Iv(i.firestore,t)})},Bv.prototype.isEqual=function(t){return dy(this.o_,t.o_)},Bv.prototype.withConverter=function(t){return new Bv(this.firestore,this.o_.withConverter(t))},Bv);function Bv(t,e){var n=this;return(n=Dv.call(this,t,e)||this).firestore=t,n.o_=e,n}function zv(t,e){var n=this;return(n=xv.call(this,e)||this).U_=t,n}function Gv(t,e){var n=this;return(n=kv.call(this,e)||this).U_=t,n}function Kv(t,e){var n=this;return(n=Pv.call(this,e)||this).firestore=t,n}function Wv(){return null!==Rv&&Rv.apply(this,arguments)||this}function Hv(t,e){var n=this;return(n=Cv.call(this,e)||this).U_=t,n}function Qv(t,e){this.hasPendingWrites=t,this.fromCache=e}function Yv(t){return t instanceof Jl&&(t=t.o_),Ep(t,Ld)}function Xv(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Jv,$v,Zv,Ie=(n(ng,$v=Jl),ng.documentId=function(){return new ng(si.et().J())},ng.prototype.isEqual=function(t){return t instanceof Jl&&(t=t.o_),t instanceof pd&&this.o_.G_.isEqual(t.G_)},ng),h=(n(eg,Jv=Jl),eg.serverTimestamp=function(){var t=new Cp("serverTimestamp");return t.c_="FieldValue.serverTimestamp",new eg(t)},eg.delete=function(){var t=new Op("deleteField");return t.c_="FieldValue.delete",new eg(t)},eg.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Lp("arrayUnion",t)}.apply(void 0,t);return n.c_="FieldValue.arrayUnion",new eg(n)},eg.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Vp("arrayRemove",t)}.apply(void 0,t);return n.c_="FieldValue.arrayRemove",new eg(n)},eg.increment=function(t){t=new Mp("increment",t);return t.c_="FieldValue.increment",new eg(t)},eg.prototype.isEqual=function(t){return this.o_.isEqual(t.o_)},eg),tg={Firestore:hv,GeoPoint:Up,Timestamp:ni,Blob:nd,Transaction:bv,WriteBatch:_v,DocumentReference:Iv,DocumentSnapshot:Vv,Query:Uv,QueryDocumentSnapshot:Mv,QuerySnapshot:qv,CollectionReference:Fv,FieldPath:Ie,FieldValue:h,setLogLevel:function(t){Sr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};function eg(){return null!==Jv&&Jv.apply(this,arguments)||this}function ng(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return $v.call(this,new(pd.bind.apply(pd,s([void 0],t))))||this}(Zv=e.default).INTERNAL.registerComponent(new br("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new hv(e,new dd(e,t),new cv);var e},"PUBLIC").setServiceProps(Object.assign({},tg))),Zv.registerVersion("@firebase/firestore","2.0.3-202010180421")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.js.map
