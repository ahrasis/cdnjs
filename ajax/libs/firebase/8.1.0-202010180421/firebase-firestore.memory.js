!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Ad){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var u,e=t(Ad),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function v(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function y(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function a(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(Te=u=u||{})[Te.DEBUG=0]="DEBUG",Te[Te.VERBOSE=1]="VERBOSE",Te[Te.INFO=2]="INFO",Te[Te.WARN=3]="WARN",Te[Te.ERROR=4]="ERROR",Te[Te.SILENT=5]="SILENT";function i(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,a(["["+i+"]  "+t.name+":"],n))}}var o={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},h=u.INFO,c=((Ie={})[u.DEBUG]="log",Ie[u.VERBOSE]="log",Ie[u.INFO]="info",Ie[u.WARN]="warn",Ie[u.ERROR]="error",Ie),l=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.DEBUG],t)),this._logHandler.apply(this,a([this,u.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.VERBOSE],t)),this._logHandler.apply(this,a([this,u.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.INFO],t)),this._logHandler.apply(this,a([this,u.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.WARN],t)),this._logHandler.apply(this,a([this,u.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.ERROR],t)),this._logHandler.apply(this,a([this,u.ERROR],t))},f);function f(t){this.name=t,this._logLevel=h,this._logHandler=i,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e,n){e=d.call(this,e)||this;return e.code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(T,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var T=/\{\$([^}]+)}/g,I=function(t,e){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,O="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},R={},k=O||self;function D(){}function S(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function P(t){var e=S(t);return"array"==e||"object"==e&&"number"==typeof t.length}function _(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var L="closure_uid_"+(1e9*Math.random()>>>0),V=0;function C(t,e,n){return t.call.apply(t.bind,arguments)}function U(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function j(t,e,n){return(j=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?C:U).apply(null,arguments)}function M(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var x=Date.now;function q(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t}function F(){this.j=this.j,this.i=this.i}F.prototype.j=!1,F.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,L)&&t[L]||(t[L]=++V))},F.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var G=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},B=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function W(){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function H(t){return/^[\s\xa0]*$/.test(t)}var X,Y=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function K(t,e){return-1!=t.indexOf(e)}function $(t,e){return t<e?-1:e<t?1:0}t:{var Q=k.navigator;if(Q){Q=Q.userAgent;if(Q){X=Q;break t}}X=""}function J(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Z(t){var e,n={};for(e in t)n[e]=t[e];return n}var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<tt.length;i++)e=tt[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function nt(t){return nt[" "](t),t}nt[" "]=D;var rt,it=K(X,"Opera"),ot=K(X,"Trident")||K(X,"MSIE"),st=K(X,"Edge"),ut=st||ot,at=K(X,"Gecko")&&!(K(X.toLowerCase(),"webkit")&&!K(X,"Edge"))&&!(K(X,"Trident")||K(X,"MSIE"))&&!K(X,"Edge"),ht=K(X.toLowerCase(),"webkit")&&!K(X,"Edge");function ct(){var t=k.document;return t?t.documentMode:void 0}t:{var lt="",ft=(ft=X,at?/rv:([^\);]+)(\)|;)/.exec(ft):st?/Edge\/([\d\.]+)/.exec(ft):ot?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ft):ht?/WebKit\/(\S+)/.exec(ft):it?/(?:Version)[ \/]?(\S+)/.exec(ft):void 0);if(ft&&(lt=ft?ft[1]:""),ot){ft=ct();if(null!=ft&&ft>parseFloat(lt)){rt=String(ft);break t}}rt=lt}var pt={};function dt(u){return t=u,e=function(){for(var t=0,e=Y(String(rt)).split("."),n=Y(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=$(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||$(0==o[2].length,0==s[2].length)||$(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=pt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var vt=k.document&&ot?ct()||(parseInt(rt,10)||void 0):void 0,yt=!ot||9<=Number(vt),gt=ot&&!dt("9"),mt=function(){if(!k.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{k.addEventListener("test",D,e),k.removeEventListener("test",D,e)}catch(t){}return t}();function wt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function bt(t,e){if(wt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(at){t:{try{nt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Et[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}wt.prototype.b=function(){this.defaultPrevented=!0},q(bt,wt);var Et={2:"touch",3:"pen",4:"mouse"};bt.prototype.b=function(){bt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,gt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Tt="closure_listenable_"+(1e6*Math.random()|0),It=0;function At(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++It,this.Y=this.Z=!1}function Nt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Ot(t){this.src=t,this.a={},this.b=0}function Rt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=G(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Nt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function kt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Ot.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=kt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new At(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Dt="closure_lm_"+(1e6*Math.random()|0),St={};function Pt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=xt(r);return e&&e[Tt]?e.wa(n,r,_(i)?!!i.capture:!!i,o):_t(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Pt(t,e[o],n,r,i);return null}return n=xt(n),t&&t[Tt]?t.va(e,n,_(r)?!!r.capture:!!r,i):_t(t,e,n,!1,r,i)}function _t(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=_(i)?!!i.capture:!!i;if(s&&!yt)return null;var u,a,h=jt(t);if(h||(t[Dt]=h=new Ot(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=Ut,r=a=yt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)mt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Vt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Lt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Tt]?Rt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Vt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=jt(e))?(Rt(n,t),0==n.b&&(n.src=null,e[Dt]=null)):Nt(t)))}function Vt(t){return t in St?St[t]:St[t]="on"+t}function Ct(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Lt(t),n.call(r,e)}function Ut(t,e){if(t.Y)return!0;if(yt)return Ct(t,new bt(e,this));if(!e)t:{e=["window","event"];for(var n=k,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ct(t,e=new bt(e,this))}function jt(t){return(t=t[Dt])instanceof Ot?t:null}var Mt="__closure_events_fn_"+(1e9*Math.random()>>>0);function xt(e){return"function"==S(e)?e:(e[Mt]||(e[Mt]=function(t){return e.handleEvent(t)}),e[Mt])}function qt(){F.call(this),this.c=new Ot(this),(this.J=this).C=null}function Ft(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new wt(e,t):e instanceof wt?e.target=e.target||t:(s=e,et(e=new wt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Gt(o,r,!0,e)&&s;if(s=Gt(o=e.a=t,r,!0,e)&&s,s=Gt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Gt(o=e.a=n[i],r,!1,e)&&s}function Gt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Rt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}q(qt,F),qt.prototype[Tt]=!0,(N=qt.prototype).addEventListener=function(t,e,n,r){Pt(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=_(i)?!!i.capture:!!i,r=xt(r),e&&e[Tt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=kt(s=e.a[n],r,i,o))&&(Nt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&jt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=kt(n,r,i,o)),(r=-1<e?n[e]:null)&&Lt(r))}(this,t,e,n,r)},N.G=function(){if(qt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Nt(n[r]);delete e.a[t],e.b--}}this.C=null},N.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},N.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Bt=k.JSON.stringify;function Wt(){this.b=this.a=null}var zt,Ht=(Xt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Xt(function(){return new Yt},function(t){t.reset()},100));function Xt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Yt(){this.next=this.b=this.a=null}function Kt(t,e){var n;zt||(n=k.Promise.resolve(void 0),zt=function(){n.then(Jt)}),$t||(zt(),$t=!0),Qt.add(t,e)}Wt.prototype.add=function(t,e){var n=Ht.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Yt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var $t=!(Yt.prototype.reset=function(){this.next=this.b=this.a=null}),Qt=new Wt;function Jt(){for(var t,e;n=e=void 0,n=null,(e=Qt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){k.setTimeout(function(){throw t},0)}(t)}var n=Ht;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}$t=!1}function Zt(t,e){qt.call(this),this.b=t||1,this.a=e||k,this.f=j(this.Xa,this),this.g=x()}function te(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function ee(t,e,n){if("function"==S(t))n&&(t=j(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=j(t.handleEvent,t)}return 2147483647<Number(e)?-1:k.setTimeout(t,e||0)}q(Zt,qt),(N=Zt.prototype).aa=!1,N.M=null,N.Xa=function(){var t;this.aa&&(0<(t=x()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Ft(this,"tick"),this.aa&&(te(this),this.start())))},N.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=x())},N.G=function(){Zt.X.G.call(this),te(this),delete this.a};var ne,re,ie,oe=(I(re=ue,ie=ne=F),re.prototype=null===ie?Object.create(ie):(se.prototype=ie.prototype,new se),ue.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=ee(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ue.prototype.G=function(){ne.prototype.G.call(this),this.a&&(k.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ue);function se(){this.constructor=re}function ue(t,e,n){var r=ne.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function ae(t){F.call(this),this.b=t,this.a={}}q(ae,F);var he=[];function ce(t,e,n,r){Array.isArray(n)||(n&&(he[0]=n.toString()),n=he);for(var i=0;i<n.length;i++){var o=Pt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function le(t){J(t.a,function(t,e){this.a.hasOwnProperty(e)&&Lt(t)},t),t.a={}}function fe(){this.a=!0}function pe(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return Bt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ae.prototype.G=function(){ae.X.G.call(this),le(this)},ae.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},fe.prototype.info=function(){};var de=null;function ve(){return de=de||new qt}function ye(t){wt.call(this,"serverreachability",t)}function ge(t){var e=ve();Ft(e,new ye(e))}function me(t){wt.call(this,"statevent",t)}function we(t){var e=ve();Ft(e,new me(e))}function be(t){wt.call(this,"timingevent",t)}function Ee(t,e){if("function"!=S(t))throw Error("Fn must not be null and must be a function");return k.setTimeout(function(){t()},e)}q(ye,wt),q(me,wt),q(be,wt);var Te={NO_ERROR:0,Ya:1,fb:2,eb:3,ab:4,cb:5,gb:6,Da:7,TIMEOUT:8,jb:9},Ie={$a:"complete",nb:"success",Ea:"error",Da:"abort",lb:"ready",mb:"readystatechange",TIMEOUT:"timeout",hb:"incrementaldata",kb:"progress",bb:"downloadprogress",ob:"uploadprogress"};function Ae(){}function Ne(t){var e;return(e=t.a)||(e=t.a={}),e}function Oe(){}Ae.prototype.a=null;var Re,O={OPEN:"a",Za:"b",Ea:"c",ib:"d"};function ke(){wt.call(this,"d")}function De(){wt.call(this,"c")}function Se(){}function Pe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ae(this),this.P=_e,t=ut?125:void 0,this.R=new Zt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}q(ke,wt),q(De,wt),q(Se,Ae),Re=new Se;var _e=45e3,Le={},Ve={};function Ce(t,e,n){t.H=1,t.i=nn($e(e)),t.j=n,t.I=!0,Ue(t,null)}function Ue(t,e){t.u=x(),Me(t),t.l=$e(t.i);var s,u,a,h,c,l,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),yn(n.b,"t",r),t.D=0,t.a=hr(t.g,t.g.C?e:null),0<t.O&&(t.F=new oe(j(t.Ca,t,t.a),t.O)),ce(t.J,t.a,"readystatechange",t.Va),e=t.B?Z(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ge(1),s=t.c,u=t.m,a=t.l,h=t.f,c=t.S,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function je(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Ve:(i=Number(u.substring(i,o)),isNaN(i)?Le:(o+=1)+i>u.length?Ve:(u=u.substr(o,i),r.D=o+i,u)));if(u==Ve){4==e&&(t.h=4,we(14),s=!1),pe(t.c,t.f,null,"[Incomplete Response]");break}if(u==Le){t.h=4,we(15),pe(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}pe(t.c,t.f,u,null),Be(t,u)}4==e&&0==n.length&&(t.h=1,we(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),er(e),e.F=!0,we(11))):(pe(t.c,t.f,n,"[Invalid Chunked Response]"),Ge(t),Fe(t))}function Me(t){t.T=x()+t.P,xe(t,t.P)}function xe(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ee(j(t.Ta,t),e)}function qe(t){t.o&&(k.clearTimeout(t.o),t.o=null)}function Fe(t){0==t.g.v||t.A||ir(t.g,t)}function Ge(t){qe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,te(t.R),le(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Be(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||In(u.b,t)))if(u.I=t.N,!t.C&&In(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var h=a;if(0==h[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;rr(u),Hn(u)}tr(u),we(18)}}else u.oa=h[1],0<u.oa-u.P&&h[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=Ee(j(u.Qa,u),6e3));if(Tn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else sr(u,11)}else if(!t.C&&u.a!=t||rr(u),!H(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++){h=e[a],u.P=h[0],h=h[1],2==u.v?"c"==h[0]?(u.J=h[1],u.ga=h[2],null!=(r=h[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=h[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=h[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(K(r,"spdy")||K(r,"quic")||K(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(An(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,en(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=x()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ar(n,n.C?n.ga:null,n.fa),i.C?(Nn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(qe(o),Me(o)),n.a=i):Zn(n),0<u.g.length&&Kn(u)):"stop"!=h[0]&&"close"!=h[0]||sr(u,7):3==u.v&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?sr(u,7):zn(u):"noop"!=h[0]&&u.f&&u.f.sa(h),u.o=0)}ge(4)}catch(t){}}function We(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(P(t)||"string"==typeof t)B(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(P(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(P(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function ze(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof ze)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function He(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Xe(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Xe(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Xe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=Pe.prototype).setTimeout=function(t){this.P=t},N.Va=function(t){t=t.target;var e=this.F;e&&3==Fn(t)?e.f():this.Ca(t)},N.Ca=function(t){try{if(t==this.a)t:{var e=Fn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!ut&&!this.a.$())){this.A||4!=e||7==n||ge(8==n||r<=0?3:2),qe(this);var i=this.a.W();this.N=i;n=this.a.$();if(this.b=200==i,r=this.c,u=this.m,a=this.l,h=this.f,c=this.S,l=e,f=i,r.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+c+"]: "+u+"\n"+a+"\n"+l+" "+f}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,we(12),Ge(this),Fe(this);break t}pe(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Be(this,s)}this.I?(je(this,e,n),ut&&this.b&&3==e&&(ce(this.J,this.R,"tick",this.Ua),this.R.start())):(pe(this.c,this.f,n,null),Be(this,n)),4==e&&Ge(this),this.b&&!this.A&&(4==e?ir(this.g,this):(this.b=!1,Me(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,we(12)):(this.h=0,we(13)),Ge(this),Fe(this)}}}catch(t){}var u,a,h,c,l,f},N.Ua=function(){var t,e;this.a&&(t=Fn(this.a),e=this.a.$(),this.D<e.length&&(qe(this),je(this,t,e),this.b&&4!=t&&Me(this)))},N.cancel=function(){this.A=!0,Ge(this)},N.Ta=function(){this.o=null;var t,e,n=x();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ge(3),we(17)),Ge(this),this.h=2,Fe(this)):xe(this,this.T-n)},(N=ze.prototype).K=function(){He(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.L=function(){return He(this),this.a.concat()},N.get=function(t,e){return Xe(this.b,t)?this.b[t]:e},N.set=function(t,e){Xe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ye=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ke(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ke?(this.a=void 0!==e?e:t.a,Qe(this,t.f),this.j=t.j,Je(this,t.c),Ze(this,t.h),this.g=t.g,e=t.b,(n=new fn).c=e.c,e.a&&(n.a=new ze(e.a),n.b=e.b),tn(this,n),this.i=t.i):t&&(n=String(t).match(Ye))?(this.a=!!e,Qe(this,n[1]||"",!0),this.j=rn(n[2]||""),Je(this,n[3]||"",!0),Ze(this,n[4]),this.g=rn(n[5]||"",!0),tn(this,n[6]||"",!0),this.i=rn(n[7]||"")):(this.a=!!e,this.b=new fn(null,this.a))}function $e(t){return new Ke(t)}function Qe(t,e,n){t.f=n?rn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Je(t,e,n){t.c=n?rn(e,!0):e}function Ze(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function tn(t,e,n){var r,i;e instanceof fn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(pn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(dn(this,e),yn(this,n,t))},r)),r.f=i):(n||(e=on(e,cn)),t.b=new fn(e,t.a))}function en(t,e,n){t.b.set(e,n)}function nn(t){return en(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^x()).toString(36)),t}function rn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function on(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,sn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function sn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ke.prototype.toString=function(){var t=[],e=this.f;e&&t.push(on(e,un,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(on(e,un,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(on(n,"/"==n.charAt(0)?hn:an,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",on(n,ln)),t.join("")};var un=/[#\/\?@]/g,an=/[#\?:]/g,hn=/[#\?]/g,cn=/[#\?@]/g,ln=/#/g;function fn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function pn(n){n.a||(n.a=new ze,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function dn(t,e){pn(t),e=gn(t,e),Xe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Xe((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&He(t)))}function vn(t,e){return pn(t),e=gn(t,e),Xe(t.a.b,e)}function yn(t,e,n){dn(t,e),0<n.length&&(t.c=null,t.a.set(gn(t,e),z(n)),t.b+=n.length)}function gn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function mn(t,e){this.b=t,this.a=e}function wn(t){this.g=t||bn,t=k.PerformanceNavigationTiming?0<(t=k.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(k.ia&&k.ia.ya&&k.ia.ya()&&k.ia.ya().pb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(N=fn.prototype).add=function(t,e){pn(this),this.c=null,t=gn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(n,r){pn(this),this.a.forEach(function(t,e){B(t,function(t){n.call(r,t,e,this)},this)},this)},N.L=function(){pn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},N.K=function(t){pn(this);var e=[];if("string"==typeof t)vn(this,t)&&(e=W(e,this.a.get(gn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=W(e,t[n])}return e},N.set=function(t,e){return pn(this),this.c=null,vn(this,t=gn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var bn=10;function En(t){return t.b||t.a&&t.a.size>=t.f}function Tn(t){return t.b?1:t.a?t.a.size:0}function In(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function An(t,e){t.a?t.a.add(e):t.b=e}function Nn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function On(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return z(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Rn(){}function kn(){this.a=new Rn}function Dn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}wn.prototype.cancel=function(){var e,t;if(this.c=On(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},Rn.prototype.stringify=function(t){return k.JSON.stringify(t,void 0)},Rn.prototype.parse=function(t){return k.JSON.parse(t,void 0)};var Sn=k.JSON.parse;function Pn(t){qt.call(this),this.headers=new ze,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=_n,this.D=this.F=!1}q(Pn,qt);var _n="",Ln=/^https?$/i,Vn=["POST","PUT"];function Cn(t){return"content-type"==t.toLowerCase()}function Un(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,jn(t),xn(t)}function jn(t){t.u||(t.u=!0,Ft(t,"complete"),Ft(t,"error"))}function Mn(t){if(t.b&&void 0!==R&&(!t.s[1]||4!=Fn(t)||2!=t.W()))if(t.l&&4==Fn(t))ee(t.za,0,t);else if(Ft(t,"readystatechange"),4==Fn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Ye)[1]||null)&&k.self&&k.self.location&&(i=(r=k.self.location.protocol).substr(0,r.length-1)),n=!Ln.test(i?i.toLowerCase():"")),e=n),e)Ft(t,"complete"),Ft(t,"success");else{t.h=6;try{var u=2<Fn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.W()+"]",jn(t)}}finally{xn(t)}}}function xn(t,e){if(t.a){qn(t);var n=t.a,r=t.s[0]?D:null;t.a=null,t.s=null,e||Ft(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function qn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(k.clearTimeout(t.m),t.m=null)}function Fn(t){return t.a?t.a.readyState:0}function Gn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",J(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):en(t,e,n))}function Bn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Wn(t){this.pa=0,this.g=[],this.c=new fe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Ma=this.R=0,this.Ja=Bn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Fa=Bn("baseRetryDelayMs",5e3,t),this.Pa=Bn("retryDelaySeedMs",1e4,t),this.Ka=Bn("forwardChannelMaxRetries",2,t),this.ma=Bn("forwardChannelRequestTimeoutMs",2e4,t),this.La=t&&t.h||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new wn(t&&t.concurrentRequestLimit),this.ka=new kn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.g&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ia=t&&t.f||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function zn(t){var e,n;Xn(t),3==t.v&&(e=t.R++,en(n=$e(t.B),"SID",t.J),en(n,"RID",e),en(n,"TYPE","terminate"),Qn(t,n),(e=new Pe(t,t.c,e,void 0)).H=2,e.i=nn($e(n)),n=!1,k.navigator&&k.navigator.sendBeacon&&(n=k.navigator.sendBeacon(e.i.toString(),"")),!n&&k.Image&&((new Image).src=e.i,n=!0),n||(e.a=hr(e.g,null),e.a.ba(e.i)),e.u=x(),Me(e)),ur(t)}function Hn(t){t.a&&(er(t),t.a.cancel(),t.a=null)}function Xn(t){Hn(t),t.j&&(k.clearTimeout(t.j),t.j=null),rr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&k.clearTimeout(t.h),t.h=null)}function Yn(t,e){t.g.push(new mn(t.Ma++,e)),3==t.v&&Kn(t)}function Kn(t){En(t.b)||t.h||(t.h=!0,Kt(t.Ba,t),t.u=0)}function $n(t,e){var n=e?e.f:t.R++,r=$e(t.B);en(r,"SID",t.J),en(r,"RID",n),en(r,"AID",t.P),Qn(t,r),t.i&&t.l&&Gn(r,t.i,t.l),n=new Pe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Jn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),An(t.b,n),Ce(n,r,e)}function Qn(t,n){t.f&&We({},function(t,e){en(n,e,t)})}function Jn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?j(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{We(t,function(t,e){var n=t;_(t)&&(n=Bt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s,"req"+h+"_")}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Zn(t){t.a||t.j||(t.T=1,Kt(t.Aa,t),t.o=0)}function tr(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=Ee(j(t.Aa,t),or(t,t.o)),t.o++,1)}function er(t){null!=t.s&&(k.clearTimeout(t.s),t.s=null)}function nr(t){t.a=new Pe(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=$e(t.la);en(e,"RID","rpc"),en(e,"SID",t.J),en(e,"CI",t.H?"0":"1"),en(e,"AID",t.P),Qn(t,e),en(e,"TYPE","xmlhttp"),t.i&&t.l&&Gn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=nn($e(e)),n.j=null,n.I=!0,Ue(n,t)}function rr(t){null!=t.m&&(k.clearTimeout(t.m),t.m=null)}function ir(t,e){var n,r=null;if(t.a==e){rr(t),er(t),t.a=null;var i=2}else{if(!In(t.b,e))return;r=e.s,Nn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=x()-e.u,n=t.u,Ft(i=ve(),new be(i)),Kn(t)):Zn(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(Tn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ja?0:t.Ka)))return t.h=Ee(j(t.Ba,t,e),or(t,t.u)),t.u++,1}}(t,e)||2==i&&tr(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:sr(t,5);break;case 4:sr(t,10);break;case 3:sr(t,6);break;default:sr(t,2)}}function or(t,e){var n=t.Fa+Math.floor(Math.random()*t.Pa);return t.f||(n*=2),n*e}function sr(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=j(t.Wa,t),r||(r=new Ke("//www.google.com/images/cleardot.gif"),k.location&&"http"==k.location.protocol||Qe(r,"https"),nn(r)),n=r.toString(),r=o,o=new fe,k.Image?((i=new Image).onload=M(Dn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=M(Dn,o,i,"TestLoadImage: error",!1,r),i.onabort=M(Dn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=M(Dn,o,i,"TestLoadImage: timeout",!1,r),k.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):we(2),t.v=0,t.f&&t.f.ra(e),ur(t),Xn(t)}function ur(t){t.v=0,t.I=-1,t.f&&(0==On(t.b).length&&0==t.g.length||(t.b.c.length=0,z(t.g),t.g.length=0),t.f.qa())}function ar(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Ke?$e(s):new Ke(s,void 0);return""!=a.c?(e&&Je(a,e+"."+a.c),Ze(a,a.h)):(u=k.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Ke(null,void 0),r&&Qe(u,r),i&&Je(u,i),o&&Ze(u,o),s&&(u.g=s),a=u),t.V&&J(t.V,function(t,e){en(a,e,t)}),e=t.A,n=t.na,e&&n&&en(a,e,n),en(a,"VER",t.ha),Qn(t,a),a}function hr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Pn(t.La)).F=t.C,e}function cr(){}function lr(){if(ot&&!(10<=Number(vt)))throw Error("Environmental error: no available transport.")}function fr(t,e){qt.call(this),this.a=new Wn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!H(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!H(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new vr(this)}function pr(t){ke.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function dr(){De.call(this),this.status=1}function vr(t){this.a=t}(N=Pn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ne(this.H):Ne(Re),this.a.onreadystatechange=j(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Un(this,t)}t=n||"";var i,o=new ze(this.headers);r&&We(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Cn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=k.FormData&&t instanceof k.FormData,0<=G(Vn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{qn(this),0<this.o&&((this.D=(i=this.a,ot&&dt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=j(this.xa,this)):this.m=ee(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Un(this,t)}},N.xa=function(){void 0!==R&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Ft(this,"timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Ft(this,"complete"),Ft(this,"abort"),xn(this))},N.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),xn(this,!0)),Pn.X.G.call(this)},N.za=function(){this.j||(this.A||this.l||this.g?Mn(this):this.Sa())},N.Sa=function(){Mn(this)},N.W=function(){try{return 2<Fn(this)?this.a.status:-1}catch(t){return-1}},N.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},N.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Sn(e)}},N.ua=function(){return this.h},N.Oa=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=Wn.prototype).ha=8,N.v=1,N.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Pe(this,this.c,t,void 0),r=this.l;if(this.O&&(r?et(r=Z(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Jn(this,n,e),en(i=$e(this.B),"RID",t),en(i,"CVER",22),this.A&&en(i,"X-HTTP-Session-Id",this.A),Qn(this,i),this.i&&r&&Gn(i,this.i,r),An(this.b,n),this.Ga&&en(i,"TYPE","init"),this.da?(en(i,"$req",e),en(i,"SID","null"),n.U=!0,Ce(n,i,null)):Ce(n,i,e),this.v=2}}else 3==this.v&&(t?$n(this,t):0==this.g.length||En(this.b)||$n(this))},N.Aa=function(){var t;this.j=null,nr(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Ee(j(this.Ra,this),t))},N.Ra=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,we(10),Hn(this),nr(this))},N.Qa=function(){null!=this.m&&(this.m=null,Hn(this),tr(this),we(19))},N.Wa=function(t){t?(this.c.info("Successfully pinged google.com"),we(2)):(this.c.info("Failed to ping google.com"),we(1))},(N=cr.prototype).ta=function(){},N.sa=function(){},N.ra=function(){},N.qa=function(){},N.Ha=function(){},lr.prototype.a=function(t,e){return new fr(t,e)},q(fr,qt),fr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;we(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=ar(t,null,t.fa),Kn(t)},fr.prototype.close=function(){zn(this.a)},fr.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Yn(this.a,e)):this.l?((e={}).__data__=Bt(t),Yn(this.a,e)):Yn(this.a,t)},fr.prototype.G=function(){this.a.f=null,delete this.f,zn(this.a),delete this.a,fr.X.G.call(this)},q(pr,ke),q(dr,De),q(vr,cr),vr.prototype.ta=function(){Ft(this.a,"a")},vr.prototype.sa=function(t){Ft(this.a,new pr(t))},vr.prototype.ra=function(t){Ft(this.a,new dr)},vr.prototype.qa=function(){Ft(this.a,"b")},lr.prototype.createWebChannel=lr.prototype.a,fr.prototype.send=fr.prototype.h,fr.prototype.open=fr.prototype.g,Te.NO_ERROR=0,Te.TIMEOUT=8,Te.HTTP_ERROR=6,Ie.COMPLETE="complete",(Oe.EventType=O).OPEN="a",O.CLOSE="b",O.ERROR="c",O.MESSAGE="d",qt.prototype.listen=qt.prototype.va,Pn.prototype.listenOnce=Pn.prototype.wa,Pn.prototype.getLastError=Pn.prototype.Oa,Pn.prototype.getLastErrorCode=Pn.prototype.ua,Pn.prototype.getStatus=Pn.prototype.W,Pn.prototype.getResponseJson=Pn.prototype.Na,Pn.prototype.getResponseText=Pn.prototype.$,Pn.prototype.send=Pn.prototype.ba;var yr=Te,gr=Ie,mr=Oe,wr=Pn,br=(Er.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Er.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Er.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Er);function Er(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Tr=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},Ir=(Object.defineProperty(Or.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Or.prototype.isEqual=function(t){return t instanceof Or&&t.projectId===this.projectId&&t.database===this.database},Or),Ar=(Nr.prototype.u=function(){return null!=this.uid},Nr.prototype.h=function(){return this.u()?"uid:"+this.uid:"anonymous-user"},Nr.prototype.isEqual=function(t){return t.uid===this.uid},Nr);function Nr(t){this.uid=t}function Or(t,e){this.projectId=t,this.database=e||"(default)"}Ar.UNAUTHENTICATED=new Ar(null),Ar.l=new Ar("google-credentials-uid"),Ar._=new Ar("first-party-uid");var Rr="8.1.0-202010180421",kr=new l("@firebase/firestore");function Dr(){return kr.logLevel}function Sr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];kr.logLevel<=u.DEBUG&&(e=n.map(Lr),kr.debug.apply(kr,s(["Firestore ("+Rr+"): "+t],e)))}function Pr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];kr.logLevel<=u.ERROR&&(e=n.map(Lr),kr.error.apply(kr,s(["Firestore ("+Rr+"): "+t],e)))}function _r(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];kr.logLevel<=u.WARN&&(e=n.map(Lr),kr.warn.apply(kr,s(["Firestore ("+Rr+"): "+t],e)))}function Lr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Vr(t){void 0===t&&(t="Unexpected state");t="FIRESTORE ("+Rr+") INTERNAL ASSERTION FAILED: "+t;throw Pr(t),new Error(t)}function Cr(t){t||Vr()}function Ur(t,e){this.user=e,this.type="OAuth",this.m={},this.m.Authorization="Bearer "+t}var jr,Mr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},xr=(n(Yr,jr=Error),Yr),qr=(Xr.prototype.getToken=function(){return Promise.resolve(null)},Xr.prototype.A=function(){},Xr.prototype.I=function(t){(this.T=t)(Ar.UNAUTHENTICATED)},Xr.prototype.R=function(){this.T=null},Xr),Fr=(Hr.prototype.getToken=function(){var e=this,n=this.p,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.p!==n?(Sr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Cr("string"==typeof t.accessToken),new Ur(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Hr.prototype.A=function(){this.forceRefresh=!0},Hr.prototype.I=function(t){this.T=t,this.V&&t(this.currentUser)},Hr.prototype.R=function(){this.auth&&this.auth.removeAuthTokenListener(this.P),this.P=null,this.T=null},Hr.prototype.g=function(){var t=this.auth&&this.auth.getUid();return Cr(null===t||"string"==typeof t),new Ar(t)},Hr),Gr=(Object.defineProperty(zr.prototype,"m",{get:function(){var t={"X-Goog-AuthUser":this.C},e=this.v.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),zr),Br=(Wr.prototype.getToken=function(){return Promise.resolve(new Gr(this.v,this.C))},Wr.prototype.I=function(t){t(Ar._)},Wr.prototype.R=function(){},Wr.prototype.A=function(){},Wr);function Wr(t,e){this.v=t,this.C=e}function zr(t,e){this.v=t,this.C=e,this.type="FirstParty",this.user=Ar._}function Hr(t){var e=this;this.P=null,this.currentUser=Ar.UNAUTHENTICATED,this.V=!1,this.p=0,this.T=null,this.forceRefresh=!1,this.P=function(){e.p++,e.currentUser=e.g(),e.V=!0,e.T&&e.T(e.currentUser)},this.p=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.P):(this.P(null),t.get().then(function(t){e.auth=t,e.P&&e.auth.addAuthTokenListener(e.P)},function(){}))}function Xr(){this.T=null}function Yr(t,e){var n=this;return(n=jr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}var Kr=($r.S=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},$r);function $r(){}function Qr(t,e){return t<e?-1:e<t?1:0}function Jr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var Zr,ti,ei=(fi.now=function(){return fi.fromMillis(Date.now())},fi.fromDate=function(t){return fi.fromMillis(t.getTime())},fi.fromMillis=function(t){var e=Math.floor(t/1e3);return new fi(e,1e6*(t-1e3*e))},fi.prototype.toDate=function(){return new Date(this.toMillis())},fi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},fi.prototype.D=function(t){return this.seconds===t.seconds?Qr(this.nanoseconds,t.nanoseconds):Qr(this.seconds,t.seconds)},fi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},fi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},fi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},fi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},fi),ni=(li.N=function(t){return new li(t)},li.min=function(){return new li(new ei(0,0))},li.prototype.F=function(t){return this.timestamp.D(t.timestamp)},li.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},li.prototype.O=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},li.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},li.prototype.$=function(){return this.timestamp},li),Ie=(Object.defineProperty(ci.prototype,"length",{get:function(){return this.L},enumerable:!1,configurable:!0}),ci.prototype.isEqual=function(t){return 0===ci.k(this,t)},ci.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ci?t.forEach(function(t){e.push(t)}):e.push(t),this.M(e)},ci.prototype.limit=function(){return this.offset+this.length},ci.prototype.U=function(t){return t=void 0===t?1:t,this.M(this.segments,this.offset+t,this.length-t)},ci.prototype.q=function(){return this.M(this.segments,this.offset,this.length-1)},ci.prototype.B=function(){return this.segments[this.offset]},ci.prototype.j=function(){return this.get(this.length-1)},ci.prototype.get=function(t){return this.segments[this.offset+t]},ci.prototype.W=function(){return 0===this.length},ci.prototype.G=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ci.prototype.K=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ci.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ci.prototype.H=function(){return this.segments.slice(this.offset,this.limit())},ci.k=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ci),ri=(n(hi,ti=Ie),hi.prototype.M=function(t,e,n){return new hi(t,e,n)},hi.prototype.Y=function(){return this.H().join("/")},hi.prototype.toString=function(){return this.Y()},hi.J=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new xr(Mr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new hi(n)},hi.X=function(){return new hi([])},hi),ii=/^[_a-zA-Z][_a-zA-Z0-9]*$/,oi=(n(ai,Zr=Ie),ai.prototype.M=function(t,e,n){return new ai(t,e,n)},ai.Z=function(t){return ii.test(t)},ai.prototype.Y=function(){return this.H().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),ai.Z(t)||(t="`"+t+"`"),t}).join(".")},ai.prototype.toString=function(){return this.Y()},ai.prototype.tt=function(){return 1===this.length&&"__name__"===this.get(0)},ai.nt=function(){return new ai(["__name__"])},ai.et=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new xr(Mr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new xr(Mr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new xr(Mr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new xr(Mr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ai(e)},ai.X=function(){return new ai([])},ai),si=(ui.st=function(t){return new ui(ri.J(t))},ui.it=function(t){return new ui(ri.J(t).U(5))},ui.prototype.rt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ui.prototype.isEqual=function(t){return null!==t&&0===ri.k(this.path,t.path)},ui.prototype.toString=function(){return this.path.toString()},ui.k=function(t,e){return ri.k(t.path,e.path)},ui.ot=function(t){return t.length%2==0},ui.ut=function(t){return new ui(new ri(t.slice()))},ui);function ui(t){this.path=t}function ai(){return null!==Zr&&Zr.apply(this,arguments)||this}function hi(){return null!==ti&&ti.apply(this,arguments)||this}function ci(t,e,n){void 0===e?e=0:e>t.length&&Vr(),void 0===n?n=t.length-e:n>t.length-e&&Vr(),this.segments=t,this.offset=e,this.L=n}function li(t){this.timestamp=t}function fi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new xr(Mr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new xr(Mr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new xr(Mr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new xr(Mr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function pi(t){return null==t}function di(t){return 0===t&&1/t==-1/0}var vi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.ct=null};function yi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new vi(t,e,n,r,i,o,s)}function gi(t){var e=t;return null===e.ct&&(t=e.path.Y(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.Y()+t.op.toString()+To(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.Y()+t.dir}).join(","),pi(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=Ku(e.startAt)),e.endAt&&(t+="|ub:",t+=Ku(e.endAt)),e.ct=t),e.ct}function mi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!mo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Qu(t.startAt,e.startAt)&&Qu(t.endAt,e.endAt)}function wi(t){return si.ot(t.path)&&null===t.collectionGroup&&0===t.filters.length}var bi=(Ei.fromBase64String=function(t){return new Ei(atob(t))},Ei.fromUint8Array=function(t){return new Ei(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Ei.prototype.toBase64=function(){return t=this.at,btoa(t);var t},Ei.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.at)},Ei.prototype.ht=function(){return 2*this.at.length},Ei.prototype.F=function(t){return Qr(this.at,t.at)},Ei.prototype.isEqual=function(t){return this.at===t.at},Ei);function Ei(t){this.at=t}bi.lt=new bi("");function Ti(t){this.count=t}var Ii,Ai=(Ni.prototype.dt=function(t){return new Ni(this.target,this.targetId,this._t,t,this.ft,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Ni.prototype.wt=function(t,e){return new Ni(this.target,this.targetId,this._t,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Ni.prototype.Et=function(t){return new Ni(this.target,this.targetId,this._t,this.sequenceNumber,this.ft,t,this.resumeToken)},Ni);function Ni(t,e,n,r,i,o,s){void 0===i&&(i=ni.min()),void 0===o&&(o=ni.min()),void 0===s&&(s=bi.lt),this.target=t,this.targetId=e,this._t=n,this.sequenceNumber=r,this.ft=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Oi(t){switch(t){case Mr.OK:return Vr(),0;case Mr.CANCELLED:case Mr.UNKNOWN:case Mr.DEADLINE_EXCEEDED:case Mr.RESOURCE_EXHAUSTED:case Mr.INTERNAL:case Mr.UNAVAILABLE:case Mr.UNAUTHENTICATED:return;case Mr.INVALID_ARGUMENT:case Mr.NOT_FOUND:case Mr.ALREADY_EXISTS:case Mr.PERMISSION_DENIED:case Mr.FAILED_PRECONDITION:case Mr.ABORTED:case Mr.OUT_OF_RANGE:case Mr.UNIMPLEMENTED:case Mr.DATA_LOSS:return 1;default:return Vr(),0}}function Ri(t){if(void 0===t)return Pr("GRPC error has no .code"),Mr.UNKNOWN;switch(t){case Ii.OK:return Mr.OK;case Ii.CANCELLED:return Mr.CANCELLED;case Ii.UNKNOWN:return Mr.UNKNOWN;case Ii.DEADLINE_EXCEEDED:return Mr.DEADLINE_EXCEEDED;case Ii.RESOURCE_EXHAUSTED:return Mr.RESOURCE_EXHAUSTED;case Ii.INTERNAL:return Mr.INTERNAL;case Ii.UNAVAILABLE:return Mr.UNAVAILABLE;case Ii.UNAUTHENTICATED:return Mr.UNAUTHENTICATED;case Ii.INVALID_ARGUMENT:return Mr.INVALID_ARGUMENT;case Ii.NOT_FOUND:return Mr.NOT_FOUND;case Ii.ALREADY_EXISTS:return Mr.ALREADY_EXISTS;case Ii.PERMISSION_DENIED:return Mr.PERMISSION_DENIED;case Ii.FAILED_PRECONDITION:return Mr.FAILED_PRECONDITION;case Ii.ABORTED:return Mr.ABORTED;case Ii.OUT_OF_RANGE:return Mr.OUT_OF_RANGE;case Ii.UNIMPLEMENTED:return Mr.UNIMPLEMENTED;case Ii.DATA_LOSS:return Mr.DATA_LOSS;default:return Vr()}}(l=Ii=Ii||{})[l.OK=0]="OK",l[l.CANCELLED=1]="CANCELLED",l[l.UNKNOWN=2]="UNKNOWN",l[l.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",l[l.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",l[l.NOT_FOUND=5]="NOT_FOUND",l[l.ALREADY_EXISTS=6]="ALREADY_EXISTS",l[l.PERMISSION_DENIED=7]="PERMISSION_DENIED",l[l.UNAUTHENTICATED=16]="UNAUTHENTICATED",l[l.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",l[l.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",l[l.ABORTED=10]="ABORTED",l[l.OUT_OF_RANGE=11]="OUT_OF_RANGE",l[l.UNIMPLEMENTED=12]="UNIMPLEMENTED",l[l.INTERNAL=13]="INTERNAL",l[l.UNAVAILABLE=14]="UNAVAILABLE",l[l.DATA_LOSS=15]="DATA_LOSS";var ki=(Li.prototype.Tt=function(t,e){return new Li(this.k,this.root.Tt(t,e,this.k).copy(null,null,Si.At,null,null))},Li.prototype.remove=function(t){return new Li(this.k,this.root.remove(t,this.k).copy(null,null,Si.At,null,null))},Li.prototype.get=function(t){for(var e=this.root;!e.W();){var n=this.k(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Li.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.W();){var r=this.k(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Li.prototype.W=function(){return this.root.W()},Object.defineProperty(Li.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Li.prototype.It=function(){return this.root.It()},Li.prototype.Rt=function(){return this.root.Rt()},Li.prototype.Pt=function(t){return this.root.Pt(t)},Li.prototype.forEach=function(n){this.Pt(function(t,e){return n(t,e),!1})},Li.prototype.toString=function(){var n=[];return this.Pt(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Li.prototype.yt=function(t){return this.root.yt(t)},Li.prototype.Vt=function(){return new Di(this.root,null,this.k,!1)},Li.prototype.gt=function(t){return new Di(this.root,t,this.k,!1)},Li.prototype.vt=function(){return new Di(this.root,null,this.k,!0)},Li.prototype.bt=function(t){return new Di(this.root,t,this.k,!0)},Li),Di=(_i.prototype.Dt=function(){var t=this.St.pop(),e={key:t.key,value:t.value};if(this.Ct)for(t=t.left;!t.W();)this.St.push(t),t=t.right;else for(t=t.right;!t.W();)this.St.push(t),t=t.left;return e},_i.prototype.Nt=function(){return 0<this.St.length},_i.prototype.xt=function(){if(0===this.St.length)return null;var t=this.St[this.St.length-1];return{key:t.key,value:t.value}},_i),Si=(Pi.prototype.copy=function(t,e,n,r,i){return new Pi(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Pi.prototype.W=function(){return!1},Pi.prototype.Pt=function(t){return this.left.Pt(t)||t(this.key,this.value)||this.right.Pt(t)},Pi.prototype.yt=function(t){return this.right.yt(t)||t(this.key,this.value)||this.left.yt(t)},Pi.prototype.min=function(){return this.left.W()?this:this.left.min()},Pi.prototype.It=function(){return this.min().key},Pi.prototype.Rt=function(){return this.right.W()?this.key:this.right.Rt()},Pi.prototype.Tt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Tt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Tt(t,e,n))).Ft()},Pi.prototype.Ot=function(){if(this.left.W())return Pi.EMPTY;var t=this;return t.left.$t()||t.left.left.$t()||(t=t.Lt()),(t=t.copy(null,null,null,t.left.Ot(),null)).Ft()},Pi.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.W()||r.left.$t()||r.left.left.$t()||(r=r.Lt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.$t()&&(r=r.kt()),r.right.W()||r.right.$t()||r.right.left.$t()||(r=r.Mt()),0===e(t,r.key)){if(r.right.W())return Pi.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Ot())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Ft()},Pi.prototype.$t=function(){return this.color},Pi.prototype.Ft=function(){var t=this;return t.right.$t()&&!t.left.$t()&&(t=t.Ut()),t.left.$t()&&t.left.left.$t()&&(t=t.kt()),t.left.$t()&&t.right.$t()&&(t=t.qt()),t},Pi.prototype.Lt=function(){var t=this.qt();return t.right.left.$t()&&(t=(t=(t=t.copy(null,null,null,null,t.right.kt())).Ut()).qt()),t},Pi.prototype.Mt=function(){var t=this.qt();return t.left.left.$t()&&(t=(t=t.kt()).qt()),t},Pi.prototype.Ut=function(){var t=this.copy(null,null,Pi.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Pi.prototype.kt=function(){var t=this.copy(null,null,Pi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Pi.prototype.qt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Pi.prototype.Bt=function(){var t=this.Qt();return Math.pow(2,t)<=this.size+1},Pi.prototype.Qt=function(){if(this.$t()&&this.left.$t())throw Vr();if(this.right.$t())throw Vr();var t=this.left.Qt();if(t!==this.right.Qt())throw Vr();return t+(this.$t()?0:1)},Pi);function Pi(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Pi.RED,this.left=null!=r?r:Pi.EMPTY,this.right=null!=i?i:Pi.EMPTY,this.size=this.left.size+1+this.right.size}function _i(t,e,n,r){this.Ct=r,this.St=[];for(var i=1;!t.W();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Ct?t.left:t.right;else{if(0===i){this.St.push(t);break}this.St.push(t),t=this.Ct?t.right:t.left}}function Li(t,e){this.k=t,this.root=e||Si.EMPTY}function Vi(){this.size=0}Si.EMPTY=null,Si.RED=!0,Si.At=!1,Si.EMPTY=(Object.defineProperty(Vi.prototype,"key",{get:function(){throw Vr()},enumerable:!1,configurable:!0}),Object.defineProperty(Vi.prototype,"value",{get:function(){throw Vr()},enumerable:!1,configurable:!0}),Object.defineProperty(Vi.prototype,"color",{get:function(){throw Vr()},enumerable:!1,configurable:!0}),Object.defineProperty(Vi.prototype,"left",{get:function(){throw Vr()},enumerable:!1,configurable:!0}),Object.defineProperty(Vi.prototype,"right",{get:function(){throw Vr()},enumerable:!1,configurable:!0}),Vi.prototype.copy=function(t,e,n,r,i){return this},Vi.prototype.Tt=function(t,e,n){return new Si(t,e)},Vi.prototype.remove=function(t,e){return this},Vi.prototype.W=function(){return!0},Vi.prototype.Pt=function(t){return!1},Vi.prototype.yt=function(t){return!1},Vi.prototype.It=function(){return null},Vi.prototype.Rt=function(){return null},Vi.prototype.$t=function(){return!1},Vi.prototype.Bt=function(){return!0},Vi.prototype.Qt=function(){return 0},new Vi);var Ci=(xi.prototype.has=function(t){return null!==this.data.get(t)},xi.prototype.first=function(){return this.data.It()},xi.prototype.last=function(){return this.data.Rt()},Object.defineProperty(xi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),xi.prototype.indexOf=function(t){return this.data.indexOf(t)},xi.prototype.forEach=function(n){this.data.Pt(function(t,e){return n(t),!1})},xi.prototype.jt=function(t,e){for(var n=this.data.gt(t[0]);n.Nt();){var r=n.Dt();if(0<=this.k(r.key,t[1]))return;e(r.key)}},xi.prototype.Wt=function(t,e){for(var n=void 0!==e?this.data.gt(e):this.data.Vt();n.Nt();)if(!t(n.Dt().key))return},xi.prototype.Gt=function(t){t=this.data.gt(t);return t.Nt()?t.Dt().key:null},xi.prototype.Vt=function(){return new Ui(this.data.Vt())},xi.prototype.gt=function(t){return new Ui(this.data.gt(t))},xi.prototype.add=function(t){return this.copy(this.data.remove(t).Tt(t,!0))},xi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},xi.prototype.W=function(){return this.data.W()},xi.prototype.Kt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},xi.prototype.isEqual=function(t){if(!(t instanceof xi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.Vt(),n=t.data.Vt();e.Nt();){var r=e.Dt().key,i=n.Dt().key;if(0!==this.k(r,i))return!1}return!0},xi.prototype.H=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},xi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},xi.prototype.copy=function(t){var e=new xi(this.k);return e.data=t,e},xi),Ui=(Mi.prototype.Dt=function(){return this.zt.Dt().key},Mi.prototype.Nt=function(){return this.zt.Nt()},Mi),ji=new ki(si.k);function Mi(t){this.zt=t}function xi(t){this.k=t,this.data=new ki(this.k)}var qi=new ki(si.k);var Fi=new ki(si.k),Gi=new Ci(si.k);function Bi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Gi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Wi=new Ci(Qr);var zi=(uo.Jt=function(t){return new uo(t.k)},uo.prototype.has=function(t){return null!=this.Ht.get(t)},uo.prototype.get=function(t){return this.Ht.get(t)},uo.prototype.first=function(){return this.Yt.It()},uo.prototype.last=function(){return this.Yt.Rt()},uo.prototype.W=function(){return this.Yt.W()},uo.prototype.indexOf=function(t){t=this.Ht.get(t);return t?this.Yt.indexOf(t):-1},Object.defineProperty(uo.prototype,"size",{get:function(){return this.Yt.size},enumerable:!1,configurable:!0}),uo.prototype.forEach=function(n){this.Yt.Pt(function(t,e){return n(t),!1})},uo.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ht.Tt(t.key,t),e.Yt.Tt(t,null))},uo.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ht.remove(t),this.Yt.remove(e)):this},uo.prototype.isEqual=function(t){if(!(t instanceof uo))return!1;if(this.size!==t.size)return!1;for(var e=this.Yt.Vt(),n=t.Yt.Vt();e.Nt();){var r=e.Dt().key,i=n.Dt().key;if(!r.isEqual(i))return!1}return!0},uo.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},uo.prototype.copy=function(t,e){var n=new uo;return n.k=this.k,n.Ht=t,n.Yt=e,n},uo),Hi=(so.prototype.track=function(t){var e=t.doc.key,n=this.Xt.get(e);!n||0!==t.type&&3===n.type?this.Xt=this.Xt.Tt(e,t):3===t.type&&1!==n.type?this.Xt=this.Xt.Tt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Xt=this.Xt.Tt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Xt=this.Xt.remove(e):1===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):Vr()},so.prototype.Zt=function(){var n=[];return this.Xt.Pt(function(t,e){n.push(e)}),n},so),Xi=(oo.rn=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new oo(t,e,zi.Jt(e),i,n,r,!0,!1)},Object.defineProperty(oo.prototype,"hasPendingWrites",{get:function(){return!this.nn.W()},enumerable:!1,configurable:!0}),oo.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.en===t.en&&this.nn.isEqual(t.nn)&&mu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.tn.isEqual(t.tn)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},oo),Yi=(io.hn=function(t,e){var n=new Map;return n.set(t,Ki.ln(t,e)),new io(ni.min(),n,Wi,ji,Bi())},io),Ki=(ro.ln=function(t,e){return new ro(bi.lt,e,Bi(),Bi(),Bi())},ro),$i=function(t,e,n,r){this.En=t,this.removedTargetIds=e,this.key=n,this.mn=r},Qi=function(t,e){this.targetId=t,this.Tn=e},Ji=function(t,e,n,r){void 0===n&&(n=bi.lt),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Zi=(Object.defineProperty(no.prototype,"_n",{get:function(){return this.Pn},enumerable:!1,configurable:!0}),Object.defineProperty(no.prototype,"resumeToken",{get:function(){return this.Rn},enumerable:!1,configurable:!0}),Object.defineProperty(no.prototype,"Vn",{get:function(){return 0!==this.An},enumerable:!1,configurable:!0}),Object.defineProperty(no.prototype,"pn",{get:function(){return this.yn},enumerable:!1,configurable:!0}),no.prototype.gn=function(t){0<t.ht()&&(this.yn=!0,this.Rn=t)},no.prototype.vn=function(){var n=Bi(),r=Bi(),i=Bi();return this.In.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Vr()}}),new Ki(this.Rn,this.Pn,n,r,i)},no.prototype.bn=function(){this.yn=!1,this.In=ho()},no.prototype.Cn=function(t,e){this.yn=!0,this.In=this.In.Tt(t,e)},no.prototype.Sn=function(t){this.yn=!0,this.In=this.In.remove(t)},no.prototype.Dn=function(){this.An+=1},no.prototype.Nn=function(){--this.An},no.prototype.xn=function(){this.yn=!0,this.Pn=!0},no),to=(eo.prototype.Mn=function(t){for(var e=0,n=t.En;e<n.length;e++){var r=n[e];t.mn instanceof nu?this.Un(r,t.mn):t.mn instanceof ru&&this.qn(r,t.key,t.mn)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.qn(s,t.key,t.mn)}},eo.prototype.Bn=function(n){var r=this;this.Qn(n,function(t){var e=r.jn(t);switch(n.state){case 0:r.Wn(t)&&e.gn(n.resumeToken);break;case 1:e.Nn(),e.Vn||e.bn(),e.gn(n.resumeToken);break;case 2:e.Nn(),e.Vn||r.removeTarget(t);break;case 3:r.Wn(t)&&(e.xn(),e.gn(n.resumeToken));break;case 4:r.Wn(t)&&(r.Gn(t),e.gn(n.resumeToken));break;default:Vr()}})},eo.prototype.Qn=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.On.forEach(function(t,e){r.Wn(e)&&n(e)})},eo.prototype.Kn=function(t){var e=t.targetId,n=t.Tn.count,t=this.zn(e);t&&(wi(t=t.target)?0===n?(t=new si(t.path),this.qn(e,t,new ru(t,ni.min()))):Cr(1===n):this.Hn(e)!==n&&(this.Gn(e),this.kn=this.kn.add(e)))},eo.prototype.Yn=function(r){var i=this,o=new Map;this.On.forEach(function(t,e){var n=i.zn(e);n&&(t._n&&wi(n.target)&&(n=new si(n.target.path),null!==i.$n.get(n)||i.Jn(e,n)||i.qn(e,n,new ru(n,r))),t.pn&&(o.set(e,t.vn()),t.bn()))});var s=Bi();this.Ln.forEach(function(t,e){var n=!0;e.Wt(function(t){t=i.zn(t);return!t||2===t._t||(n=!1)}),n&&(s=s.add(t))});var t=new Yi(r,o,this.kn,this.$n,s);return this.$n=ji,this.Ln=ao(),this.kn=new Ci(Qr),t},eo.prototype.Un=function(t,e){var n;this.Wn(t)&&(n=this.Jn(t,e.key)?2:0,this.jn(t).Cn(e.key,n),this.$n=this.$n.Tt(e.key,e),this.Ln=this.Ln.Tt(e.key,this.Xn(e.key).add(t)))},eo.prototype.qn=function(t,e,n){var r;this.Wn(t)&&(r=this.jn(t),this.Jn(t,e)?r.Cn(e,1):r.Sn(e),this.Ln=this.Ln.Tt(e,this.Xn(e).delete(t)),n&&(this.$n=this.$n.Tt(e,n)))},eo.prototype.removeTarget=function(t){this.On.delete(t)},eo.prototype.Hn=function(t){var e=this.jn(t).vn();return this.Fn.Zn(t).size+e.fn.size-e.wn.size},eo.prototype.Dn=function(t){this.jn(t).Dn()},eo.prototype.jn=function(t){var e=this.On.get(t);return e||(e=new Zi,this.On.set(t,e)),e},eo.prototype.Xn=function(t){var e=this.Ln.get(t);return e||(e=new Ci(Qr),this.Ln=this.Ln.Tt(t,e)),e},eo.prototype.Wn=function(t){var e=null!==this.zn(t);return e||Sr("WatchChangeAggregator","Detected inactive target",t),e},eo.prototype.zn=function(t){var e=this.On.get(t);return e&&e.Vn?null:this.Fn.te(t)},eo.prototype.Gn=function(e){var n=this;this.On.set(e,new Zi),this.Fn.Zn(e).forEach(function(t){n.qn(e,t,null)})},eo.prototype.Jn=function(t,e){return this.Fn.Zn(t).has(e)},eo);function eo(t){this.Fn=t,this.On=new Map,this.$n=ji,this.Ln=ao(),this.kn=new Ci(Qr)}function no(){this.An=0,this.In=ho(),this.Rn=bi.lt,this.Pn=!1,this.yn=!0}function ro(t,e,n,r,i){this.resumeToken=t,this._n=e,this.fn=n,this.dn=r,this.wn=i}function io(t,e,n,r,i){this.ft=t,this.on=e,this.un=n,this.cn=r,this.an=i}function oo(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.tn=n,this.docChanges=r,this.nn=i,this.fromCache=o,this.en=s,this.sn=u}function so(){this.Xt=new ki(si.k)}function uo(n){this.k=n?function(t,e){return n(t,e)||si.k(t.key,e.key)}:function(t,e){return si.k(t.key,e.key)},this.Ht=qi,this.Yt=new ki(this.k)}function ao(){return new ki(si.k)}function ho(){return new ki(si.k)}function co(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function lo(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function fo(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function po(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function vo(t){t=Io(t.mapValue.fields.__local_write_time__.timestampValue);return new ei(t.seconds,t.nanos)}var yo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function go(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?po(t)?4:10:Vr()}function mo(r,i){var t,e=go(r);if(e!==go(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return vo(r).isEqual(vo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Io(r.timestampValue),t=Io(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,No(r.bytesValue).isEqual(No(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Ao((t=r).geoPointValue.latitude)===Ao(e.geoPointValue.latitude)&&Ao(t.geoPointValue.longitude)===Ao(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Ao(t.integerValue)===Ao(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=Ao(t.doubleValue),e=Ao(e.doubleValue);return t===e?di(t)===di(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return Jr(r.arrayValue.values||[],i.arrayValue.values||[],mo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(co(e)!==co(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!mo(e[t],n[t])))return!1;return!0}();default:return Vr()}}function wo(t,e){return void 0!==(t.values||[]).find(function(t){return mo(t,e)})}function bo(t,e){var n,r,i=go(t),o=go(e);if(i!==o)return Qr(i,o);switch(i){case 0:return 0;case 1:return Qr(t.booleanValue,e.booleanValue);case 2:return n=e,r=Ao(t.integerValue||t.doubleValue),n=Ao(n.integerValue||n.doubleValue),r<n?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return Eo(t.timestampValue,e.timestampValue);case 4:return Eo(vo(t),vo(e));case 5:return Qr(t.stringValue,e.stringValue);case 6:return function(t,e){t=No(t),e=No(e);return t.F(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Qr(n[i],r[i]);if(0!==o)return o}return Qr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=Qr(Ao(i.latitude),Ao(r.latitude)))?n:Qr(Ao(i.longitude),Ao(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=bo(n[i],r[i]);if(o)return o}return Qr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Qr(r[s],o[s]);if(0!==u)return u;u=bo(n[r[s]],i[o[s]]);if(0!==u)return u}return Qr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Vr()}}function Eo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Qr(t,e);var n=Io(t),t=Io(e),e=Qr(n.seconds,t.seconds);return 0!==e?e:Qr(n.nanos,t.nanos)}function To(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=Io(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?No(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,si.it(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):Vr();var e}(t)}function Io(t){if(Cr(!!t),"string"!=typeof t)return{seconds:Ao(t.seconds),nanos:Ao(t.nanos)};var e=0,n=yo.exec(t);Cr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Ao(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function No(t){return"string"==typeof t?bi.fromBase64String(t):bi.fromUint8Array(t)}function Oo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.Y()}}function Ro(t){return t&&"integerValue"in t}function ko(t){return!!t&&"arrayValue"in t}function Do(t){return t&&"nullValue"in t}function So(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Po(t){return t&&"mapValue"in t}var _o={asc:"ASCENDING",desc:"DESCENDING"},Lo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Vo=function(t,e){this.t=t,this.ne=e};function Co(t){return{integerValue:""+t}}function Uo(t,e){if(t.ne){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:di(e)?"-0":e}}function jo(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!di(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Co(e):Uo(t,e);var n}function Mo(t,e){return t.ne?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function xo(t,e){return t.ne?e.toBase64():e.toUint8Array()}function qo(t){return Cr(!!t),ni.N((t=Io(t),new ei(t.seconds,t.nanos)))}function Fo(t,e){return new ri(["projects",t.projectId,"databases",t.database]).child("documents").child(e).Y()}function Go(t){t=ri.J(t);return Cr(rs(t)),t}function Bo(t,e){return Fo(t.t,e.path)}function Wo(t,e){e=Go(e);if(e.get(1)!==t.t.projectId)throw new xr(Mr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.t.projectId);if(e.get(3)!==t.t.database)throw new xr(Mr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.t.database);return new si(Xo(e))}function zo(t,e){return Fo(t.t,e)}function Ho(t){return new ri(["projects",t.t.projectId,"databases",t.t.database]).Y()}function Xo(t){return Cr(4<t.length&&"documents"===t.get(4)),t.U(5)}function Yo(t,e,n){return{name:Bo(t,e),fields:n.proto.mapValue.fields}}function Ko(t,e){var n,r,i;if(e instanceof Vs)n={update:Yo(t,e.key,e.value)};else if(e instanceof zs)n={delete:Bo(t,e.key)};else if(e instanceof Cs)n={update:Yo(t,e.key,e.data),updateMask:(i=e.ee,r=[],i.fields.forEach(function(t){return r.push(t.Y())}),{fieldPaths:r})};else if(e instanceof qs)n={transform:{document:Bo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof us)return{fieldPath:t.field.Y(),setToServerValue:"REQUEST_TIME"};if(e instanceof as)return{fieldPath:t.field.Y(),appendMissingElements:{values:e.elements}};if(e instanceof ps)return{fieldPath:t.field.Y(),removeAllFromArray:{values:e.elements}};if(e instanceof gs)return{fieldPath:t.field.Y(),increment:e.se};throw Vr()})}};else{if(!(e instanceof Hs))return Vr();n={verify:Bo(t,e.key)}}return e.re.ie||(n.currentDocument=void 0!==(i=e.re).updateTime?{updateTime:(e=t,t=i.updateTime,Mo(e,t.$()))}:void 0!==i.exists?{exists:i.exists}:Vr()),n}function $o(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=zo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=zo(t,r.q()),n.structuredQuery.from=[{collectionId:r.j()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(So(t.value))return{unaryFilter:{field:ts(t.field),op:"IS_NAN"}};if(Do(t.value))return{unaryFilter:{field:ts(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(So(t.value))return{unaryFilter:{field:ts(t.field),op:"IS_NOT_NAN"}};if(Do(t.value))return{unaryFilter:{field:ts(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ts(t.field),op:(e=t.op,Lo[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:ts((t=t).field),direction:(t=t.dir,_o[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.ne||pi(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=Jo(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Jo(e.endAt)),n}function Qo(t){var e=4===(o=Go(t.parent)).length?ri.X():Xo(o),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Cr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[ns(t)]:void 0!==t.fieldFilter?[(n=t,Au.create(es(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Vr()}}(),n.fieldFilter.value))]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):Vr():[];var n}(n.where));t=[];n.orderBy&&(t=n.orderBy.map(function(t){return new Ju(es((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));r=null;n.limit&&(r=pi(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=Zo(n.startAt));var u=null;return n.endAt&&(u=Zo(n.endAt)),new ou(e,i,t,o,r,"F",s,u)}function Jo(t){return{before:t.before,values:t.position}}function Zo(t){var e=!!t.before,t=t.values||[];return new Wu(t,e)}function ts(t){return{fieldPath:t.Y()}}function es(t){return oi.et(t.fieldPath)}function ns(t){switch(t.unaryFilter.op){case"IS_NAN":var e=es(t.unaryFilter.field);return Au.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=es(t.unaryFilter.field);return Au.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":n=es(t.unaryFilter.field);return Au.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":t=es(t.unaryFilter.field);return Au.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Vr()}}function rs(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}Ie=function(){this.oe=void 0};function is(t,e){return t instanceof gs?Ro(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var os,ss,us=(n(cs,ss=Ie),cs),as=(n(hs,os=Ie),hs);function hs(t){var e=this;return(e=os.call(this)||this).elements=t,e}function cs(){return null!==ss&&ss.apply(this,arguments)||this}function ls(t,e){for(var n=bs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return mo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var fs,ps=(n(ds,fs=Ie),ds);function ds(t){var e=this;return(e=fs.call(this)||this).elements=t,e}function vs(t,e){for(var n=bs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!mo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var ys,gs=(n(ms,ys=Ie),ms);function ms(t,e){var n=this;return(n=ys.call(this)||this).serializer=t,n.se=e,n}function ws(t){return Ao(t.integerValue||t.doubleValue)}function bs(t){return ko(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Es(t,e){this.field=t,this.transform=e}var Ts=(Is.prototype.ue=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].G(t))return!0;return!1},Is.prototype.isEqual=function(t){return Jr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Is);function Is(t){(this.fields=t).sort(oi.k)}function As(t,e){this.version=t,this.transformResults=e}var Ns=(Os.ce=function(){return new Os},Os.exists=function(t){return new Os(void 0,t)},Os.updateTime=function(t){return new Os(t)},Object.defineProperty(Os.prototype,"ie",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Os.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Os);function Os(t,e){this.updateTime=t,this.exists=e}function Rs(t,e){return void 0!==t.updateTime?e instanceof nu&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof nu}l=function(){};function ks(t,e,n){return t instanceof Vs?new nu(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof Cs?function(t,e,n){if(!Rs(t.re,e))return new iu(t.key,n.version);e=Ms(t,e);return new nu(t.key,n.version,e,{hasCommittedMutations:!0})}(t,e,n):t instanceof qs?function(t,e,n){if(Cr(null!=n.transformResults),!Rs(t.re,e))return new iu(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Cr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof nu&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof as?ls(o,s):o instanceof ps?vs(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=Gs(t,r.data(),e);return new nu(t.key,n,e,{hasCommittedMutations:!0})}(t,e,n):new ru(t.key,n.version,{hasCommittedMutations:!0})}function Ds(t,e,n,r){return t instanceof Vs?function(t,e){if(!Rs(t.re,e))return e;e=Ps(e);return new nu(t.key,e,t.value,{ae:!0})}(t,e):t instanceof Cs?function(t,e){if(!Rs(t.re,e))return e;var n=Ps(e),e=Ms(t,e);return new nu(t.key,n,e,{ae:!0})}(t,e):t instanceof qs?function(t,e,n,r){if(!Rs(t.re,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],h=a.transform,c=null;n instanceof nu&&(c=n.field(a.field)),null===c&&r instanceof nu&&(c=r.field(a.field)),o.push((i=c,a=e,c=void 0,(h=h)instanceof us?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(c.fields.__previous_value__=i),{mapValue:c}):h instanceof as?ls(h,i):h instanceof ps?vs(h,i):(h=is(c=h,i),i=ws(h)+ws(c.se),Ro(h)&&Ro(c.se)?Co(i):Uo(c.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=Gs(t,i.data(),r);return new nu(t.key,i.version,r,{ae:!0})}(t,e,r,n):(e=e,Rs((t=t).re,e)?new ru(t.key,ni.min()):e)}function Ss(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.re.isEqual(e.re)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.ee.isEqual(e.ee):2!==t.type||Jr(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof as&&e instanceof as||t instanceof ps&&e instanceof ps?Jr(t.elements,e.elements,mo):t instanceof gs&&e instanceof gs?mo(t.se,e.se):t instanceof us&&e instanceof us)}))}function Ps(t){return t instanceof nu?t.version:ni.min()}var _s,Ls,Vs=(n(js,Ls=l),js),Cs=(n(Us,_s=l),Us);function Us(t,e,n,r){var i=this;return(i=_s.call(this)||this).key=t,i.data=e,i.ee=n,i.re=r,i.type=1,i}function js(t,e,n){var r=this;return(r=Ls.call(this)||this).key=t,r.value=e,r.re=n,r.type=0,r}function Ms(t,e){return n=t,e=e instanceof nu?e.data():Xs.empty(),r=new Ys(e),n.ee.fields.forEach(function(t){var e;t.W()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.he();var n,r}var xs,qs=(n(Fs,xs=l),Fs);function Fs(t,e){var n=this;return(n=xs.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.re=Ns.exists(!0),n}function Gs(t,e,n){for(var r=new Ys(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.he()}var Bs,Ws,zs=(n(Js,Ws=l),Js),Hs=(n(Qs,Bs=l),Qs),Xs=($s.empty=function(){return new $s({mapValue:{}})},$s.prototype.field=function(t){if(t.W())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Po(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.j()])||null},$s.prototype.isEqual=function(t){return mo(this.proto,t.proto)},$s),Ys=(Ks.prototype.set=function(t,e){return this.fe(t,e),this},Ks.prototype.delete=function(t){return this.fe(t,null),this},Ks.prototype.fe=function(t,e){for(var n=this._e,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===go(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.j(),e)},Ks.prototype.he=function(){var t=this.de(oi.X(),this._e);return null!=t?new Xs(t):this.le},Ks.prototype.de=function(r,t){var i=this,o=!1,e=this.le.field(r),s=Po(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.de(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Ks);function Ks(t){void 0===t&&(t=Xs.empty()),this.le=t,this._e=new Map}function $s(t){this.proto=t}function Qs(t,e){var n=this;return(n=Bs.call(this)||this).key=t,n.re=e,n.type=4,n}function Js(t,e){var n=this;return(n=Ws.call(this)||this).key=t,n.re=e,n.type=3,n}var Zs,tu,eu,Ie=function(t,e){this.key=t,this.version=e},nu=(n(au,eu=Ie),au.prototype.field=function(t){return this.we.field(t)},au.prototype.data=function(){return this.we},au.prototype.Ee=function(){return this.we.proto},au.prototype.isEqual=function(t){return t instanceof au&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.ae===t.ae&&this.hasCommittedMutations===t.hasCommittedMutations&&this.we.isEqual(t.we)},au.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.we.toString()+", {hasLocalMutations: "+this.ae+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(au.prototype,"hasPendingWrites",{get:function(){return this.ae||this.hasCommittedMutations},enumerable:!1,configurable:!0}),au),ru=(n(uu,tu=Ie),uu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(uu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),uu.prototype.isEqual=function(t){return t instanceof uu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},uu),iu=(n(su,Zs=Ie),su.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(su.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),su.prototype.isEqual=function(t){return t instanceof su&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},su),ou=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.me=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Te=null,this.Ae=null,this.startAt,this.endAt};function su(){return null!==Zs&&Zs.apply(this,arguments)||this}function uu(t,e,n){var r=this;return(r=tu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function au(t,e,n,r){var i=this;return(i=eu.call(this,t,e)||this).we=n,i.ae=!!r.ae,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function hu(t){return new ou(t)}function cu(t){return!pi(t.limit)&&"F"===t.limitType}function lu(t){return!pi(t.limit)&&"L"===t.limitType}function fu(t){return 0<t.me.length?t.me[0].field:null}function pu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.Ie())return r.field}return null}function du(t){return null!==t.collectionGroup}function vu(t){var e=t;if(null===e.Te){e.Te=[];var n=pu(e),t=fu(e);if(null!==n&&null===t)n.tt()||e.Te.push(new Ju(n)),e.Te.push(new Ju(oi.nt(),"asc"));else{for(var r=!1,i=0,o=e.me;i<o.length;i++){var s=o[i];e.Te.push(s),s.field.tt()&&(r=!0)}r||(n=0<e.me.length?e.me[e.me.length-1].dir:"asc",e.Te.push(new Ju(oi.nt(),n)))}}return e.Te}function yu(t){var e=t;if(!e.Ae)if("F"===e.limitType)e.Ae=yi(e.path,e.collectionGroup,vu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=vu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Ju(o.field,s))}var u=e.endAt?new Wu(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Wu(e.startAt.position,!e.startAt.before):null;e.Ae=yi(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.Ae}function gu(t,e,n){return new ou(t.path,t.collectionGroup,t.me.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function mu(t,e){return mi(yu(t),yu(e))&&t.limitType===e.limitType}function wu(t){return gi(yu(t))+"|lt:"+t.limitType}function bu(t){return"Query(target="+(e=yu(t),n=e.path.Y(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.Y()+" "+t.op+" "+To(t.value)}).join(", ")+"]"),pi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.Y()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Ku(e.startAt)),e.endAt&&(n+=", endAt: "+Ku(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function Eu(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.rt(e.collectionGroup)&&e.path.G(n):si.ot(e.path)?e.path.isEqual(n):e.path.K(n))&&function(t){for(var e=0,n=i.me;e<n.length;e++){var r=n[e];if(!r.field.tt()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||$u(t.startAt,vu(t),n))&&(!t.endAt||!$u(t.endAt,vu(t),n)));var e,n}function Tu(u){return function(t,e){for(var n=!1,r=0,i=vu(u);r<i.length;r++){var o=i[r],s=function(t,r,e){e=t.field.tt()?si.k(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?bo(n,t):Vr()}(t.field,e);switch(t.dir){case"asc":return e;case"desc":return-1*e;default:return Vr()}}(o,t,e);if(0!==s)return s;n=n||o.field.tt()}return 0}}var Iu,Au=(n(Nu,Iu=function(){}),Nu.create=function(t,e,n){return t.tt()?"in"===e||"not-in"===e?this.Re(t,e,n):new Du(t,e,n):"array-contains"===e?new qu(t,n):"in"===e?new Fu(t,n):"not-in"===e?new Gu(t,n):"array-contains-any"===e?new Bu(t,n):new Nu(t,e,n)},Nu.Re=function(t,e,n){return new("in"===e?Su:Pu)(t,n)},Nu.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this.Pe(bo(t,this.value)):null!==t&&go(this.value)===go(t)&&this.Pe(bo(t,this.value))},Nu.prototype.Pe=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Vr()}},Nu.prototype.Ie=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Nu);function Nu(t,e,n){var r=this;return(r=Iu.call(this)||this).field=t,r.op=e,r.value=n,r}var Ou,Ru,ku,Du=(n(Vu,ku=Au),Vu.prototype.matches=function(t){t=si.k(t.key,this.key);return this.Pe(t)},Vu),Su=(n(Lu,Ru=Au),Lu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Lu),Pu=(n(_u,Ou=Au),_u.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},_u);function _u(t,e){var n=this;return(n=Ou.call(this,t,"not-in",e)||this).keys=Cu(0,e),n}function Lu(t,e){var n=this;return(n=Ru.call(this,t,"in",e)||this).keys=Cu(0,e),n}function Vu(t,e,n){var r=this;return(r=ku.call(this,t,e,n)||this).key=si.it(n.referenceValue),r}function Cu(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return si.it(t.referenceValue)})}var Uu,ju,Mu,xu,qu=(n(Yu,xu=Au),Yu.prototype.matches=function(t){t=t.field(this.field);return ko(t)&&wo(t.arrayValue,this.value)},Yu),Fu=(n(Xu,Mu=Au),Xu.prototype.matches=function(t){t=t.field(this.field);return null!==t&&wo(this.value.arrayValue,t)},Xu),Gu=(n(Hu,ju=Au),Hu.prototype.matches=function(t){if(wo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!wo(this.value.arrayValue,t)},Hu),Bu=(n(zu,Uu=Au),zu.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!ko(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return wo(e.value.arrayValue,t)})},zu),Wu=function(t,e){this.position=t,this.before=e};function zu(t,e){return Uu.call(this,t,"array-contains-any",e)||this}function Hu(t,e){return ju.call(this,t,"not-in",e)||this}function Xu(t,e){return Mu.call(this,t,"in",e)||this}function Yu(t,e){return xu.call(this,t,"array-contains",e)||this}function Ku(t){return(t.before?"b":"a")+":"+t.position.map(To).join(",")}function $u(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.tt()?si.k(si.it(s.referenceValue),n.key):bo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Qu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!mo(t.position[n],e.position[n]))return!1;return!0}var Ju=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};var Zu=(ua.prototype.Ve=function(t,e,n){for(var r=n.pe,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=ks(o,e,r[i]))}return e},ua.prototype.ge=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Ds(i,e,e,this.ye))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Ds(a,e,o,this.ye))}return e},ua.prototype.ve=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.ge(t.key,n.get(t.key));e&&(i=i.Tt(t.key,e))}),i},ua.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Bi())},ua.prototype.isEqual=function(t){return this.batchId===t.batchId&&Jr(this.mutations,t.mutations,Ss)&&Jr(this.baseMutations,t.baseMutations,Ss)},ua),ta=(sa.from=function(t,e,n){Cr(t.mutations.length===n.length);for(var r=Fi,i=t.mutations,o=0;o<i.length;o++)r=r.Tt(i[o].key,n[o].version);return new sa(t,e,n,r)},sa),ea=(oa.prototype.get=function(t){var e=this.Se(t),e=this.Ne[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.De(o,t))return i}},oa.prototype.has=function(t){return void 0!==this.get(t)},oa.prototype.set=function(t,e){var n=this.Se(t),r=this.Ne[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.De(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.Ne[n]=[[t,e]]},oa.prototype.delete=function(t){var e=this.Se(t),n=this.Ne[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.De(n[r][0],t))return 1===n.length?delete this.Ne[e]:n.splice(r,1),!0;return!1},oa.prototype.forEach=function(s){lo(this.Ne,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},oa.prototype.W=function(){return fo(this.Ne)},oa),na=(ia.prototype.catch=function(t){return this.next(void 0,t)},ia.prototype.next=function(r,i){var o=this;return this.$e&&Vr(),this.$e=!0,this.Oe?this.error?this.Le(i,this.error):this.ke(r,this.result):new ia(function(e,n){o.xe=function(t){o.ke(r,t).next(e,n)},o.Fe=function(t){o.Le(i,t).next(e,n)}})},ia.prototype.Me=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ia.prototype.Ue=function(t){try{var e=t();return e instanceof ia?e:ia.resolve(e)}catch(t){return ia.reject(t)}},ia.prototype.ke=function(t,e){return t?this.Ue(function(){return t(e)}):ia.resolve(e)},ia.prototype.Le=function(t,e){return t?this.Ue(function(){return t(e)}):ia.reject(e)},ia.resolve=function(n){return new ia(function(t,e){t(n)})},ia.reject=function(n){return new ia(function(t,e){e(n)})},ia.qe=function(t){return new ia(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},ia.Be=function(t){for(var n=ia.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?ia.resolve(t):e()})}(r[e]);return n},ia.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.qe(i)},ia),ra=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})};function ia(t){var e=this;this.xe=null,this.Fe=null,this.result=void 0,this.error=void 0,this.Oe=!1,this.$e=!1,t(function(t){e.Oe=!0,e.result=t,e.xe&&e.xe(t)},function(t){e.Oe=!0,e.error=t,e.Fe&&e.Fe(t)})}function oa(t,e){this.Se=t,this.De=e,this.Ne={}}function sa(t,e,n,r){this.batch=t,this.be=e,this.pe=n,this.Ce=r}function ua(t,e,n,r){this.batchId=t,this.ye=e,this.baseMutations=n,this.mutations=r}function aa(t){return new Vo(t,!0)}function ha(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var ca=(va.prototype.Ge=function(e,n){var r=this;return this.je.Ke(e,n).next(function(t){return r.ze(e,n,t)})},va.prototype.ze=function(t,r,i){return this.Qe.He(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].ge(r,t);return t})},va.prototype.Ye=function(t,e,i){var o=ji;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].ge(t,e);o=o.Tt(t,e)}),o},va.prototype.Je=function(e,t){var n=this;return this.Qe.getEntries(e,t).next(function(t){return n.Xe(e,t)})},va.prototype.Xe=function(e,r){var i=this;return this.je.Ze(e,r).next(function(t){var t=i.Ye(e,r,t),n=ji;return t.forEach(function(t,e){e=e||new ru(t,ni.min()),n=n.Tt(t,e)}),n})},va.prototype.ts=function(t,e,n){return r=e,si.ot(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.ns(t,e.path):du(e)?this.es(t,e,n):this.ss(t,e,n);var r},va.prototype.ns=function(t,e){return this.Ge(t,new si(e)).next(function(t){var e=qi;return t instanceof nu&&(e=e.Tt(t.key,t)),e})},va.prototype.es=function(n,r,i){var o=this,s=r.collectionGroup,u=qi;return this.We.rs(n,s).next(function(t){return na.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new ou(t,null,e.me.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.ss(n,e,i).next(function(t){t.forEach(function(t,e){u=u.Tt(t,e)})})}).next(function(){return u})})},va.prototype.ss=function(e,n,t){var h,c,r=this;return this.Qe.ts(e,n,t).next(function(t){return h=t,r.je.os(e,n)}).next(function(t){return c=t,r.us(e,c,h).next(function(t){h=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=h.get(u),a=Ds(s,a,a,r.ye);h=a instanceof nu?h.Tt(u,a):h.remove(u)}})}).next(function(){return h.forEach(function(t,e){Eu(n,e)||(h=h.remove(t))}),h})},va.prototype.us=function(t,e,n){for(var r=Bi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Cs&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.Qe.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof nu&&(h=h.Tt(t,e))}),h})},va),la=(da.ls=function(t,e){for(var n=Bi(),r=Bi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new da(t,e.fromCache,n,r)},da),fa=(pa.prototype.fs=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},pa.prototype.next=function(){var t=++this.previousValue;return this.ds&&this.ds(t),t},pa);function pa(t,e){var n=this;this.previousValue=t,e&&(e._s=function(t){return n.fs(t)},this.ds=function(t){return e.ws(t)})}function da(t,e,n,r){this.targetId=t,this.fromCache=e,this.cs=n,this.hs=r}function va(t,e,n){this.Qe=t,this.je=e,this.We=n}fa.Es=-1;var ya=(ga.prototype.reset=function(){this.ys=0},ga.prototype.gs=function(){this.ys=this.Ps},ga.prototype.vs=function(t){var e=this;this.cancel();var n=Math.floor(this.ys+this.bs()),r=Math.max(0,Date.now()-this.ps),i=Math.max(0,n-r);0<i&&Sr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.ys+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Vs=this.Ts.Cs(this.As,i,function(){return e.ps=Date.now(),t()}),this.ys*=this.Rs,this.ys<this.Is&&(this.ys=this.Is),this.ys>this.Ps&&(this.ys=this.Ps)},ga.prototype.Ss=function(){null!==this.Vs&&(this.Vs.Ds(),this.Vs=null)},ga.prototype.cancel=function(){null!==this.Vs&&(this.Vs.cancel(),this.Vs=null)},ga.prototype.bs=function(){return(Math.random()-.5)*this.ys},ga);function ga(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Ts=t,this.As=e,this.Is=n,this.Rs=r,this.Ps=i,this.ys=0,this.Vs=null,this.ps=Date.now(),this.reset()}function ma(t){return"IndexedDbTransactionError"===t.name}function wa(){return"undefined"!=typeof document?document:null}var ba=(Ia.$s=function(t,e,n,r,i){i=new Ia(t,e,Date.now()+n,r,i);return i.start(n),i},Ia.prototype.start=function(t){var e=this;this.Ls=setTimeout(function(){return e.ks()},t)},Ia.prototype.Ds=function(){return this.ks()},Ia.prototype.cancel=function(t){null!==this.Ls&&(this.clearTimeout(),this.Os.reject(new xr(Mr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Ia.prototype.ks=function(){var e=this;this.Ns.Ms(function(){return null!==e.Ls?(e.clearTimeout(),e.op().then(function(t){return e.Os.resolve(t)})):Promise.resolve()})},Ia.prototype.clearTimeout=function(){null!==this.Ls&&(this.Fs(this),clearTimeout(this.Ls),this.Ls=null)},Ia),Ea=(Object.defineProperty(Ta.prototype,"Hs",{get:function(){return this.Bs},enumerable:!1,configurable:!0}),Ta.prototype.Ms=function(t){this.enqueue(t)},Ta.prototype.Ys=function(t){this.Js(),this.Xs(t)},Ta.prototype.Zs=function(){var t;this.Bs||(this.Bs=!0,(t=wa())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.zs))},Ta.prototype.enqueue=function(t){return this.Js(),this.Bs?new Promise(function(t){}):this.Xs(t)},Ta.prototype.ti=function(t){var e=this;this.Ms(function(){return e.qs.push(t),e.ni()})},Ta.prototype.ni=function(){return v(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(0===this.qs.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.qs[0]()];case 2:return t.sent(),this.qs.shift(),this.Ks.reset(),[3,4];case 3:if(!ma(e=t.sent()))throw e;return Sr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.qs.length&&this.Ks.vs(function(){return n.ni()}),t.label=5;case 5:return[2]}})})},Ta.prototype.Xs=function(t){var r=this,e=this.Us.then(function(){return r.Ws=!0,t().catch(function(t){throw r.js=t,r.Ws=!1,Pr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Ws=!1,t})});return this.Us=e},Ta.prototype.Cs=function(t,e,n){var r=this;this.Js(),-1<this.Gs.indexOf(t)&&(e=0);n=ba.$s(this,t,e,n,function(t){return r.ei(t)});return this.Qs.push(n),n},Ta.prototype.Js=function(){this.js&&Vr()},Ta.prototype.si=function(){},Ta.prototype.ii=function(){return v(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return[4,e=this.Us];case 1:t.sent(),t.label=2;case 2:if(e!==this.Us)return[3,0];t.label=3;case 3:return[2]}})})},Ta.prototype.ri=function(t){for(var e=0,n=this.Qs;e<n.length;e++)if(n[e].As===t)return!0;return!1},Ta.prototype.oi=function(r){var i=this;return this.ii().then(function(){i.Qs.sort(function(t,e){return t.xs-e.xs});for(var t=0,e=i.Qs;t<e.length;t++){var n=e[t];if(n.Ds(),"all"!==r&&n.As===r)break}return i.ii()})},Ta.prototype.ui=function(t){this.Gs.push(t)},Ta.prototype.ei=function(t){t=this.Qs.indexOf(t);this.Qs.splice(t,1)},Ta);function Ta(){var e=this;this.Us=Promise.resolve(),this.qs=[],this.Bs=!1,this.Qs=[],this.js=null,this.Ws=!1,this.Gs=[],this.Ks=new ya(this,"async_queue_retry"),this.zs=function(){var t=wa();t&&Sr("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Ks.Ss()};var t=wa();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.zs)}function Ia(t,e,n,r,i){this.Ns=t,this.As=e,this.xs=n,this.op=r,this.Fs=i,this.Os=new ra,this.then=this.Os.promise.then.bind(this.Os.promise),this.Os.promise.catch(function(t){})}function Aa(t,e){if(Pr("AsyncQueue",e+": "+t),ma(t))return new xr(Mr.UNAVAILABLE,e+": "+t);throw t}function Na(t){this.ci=t}var Oa=(La.prototype.hi=function(t,e){return this.ai.add(e),na.resolve()},La.prototype.rs=function(t,e){return na.resolve(this.ai.getEntries(e))},La),Ra=(_a.prototype.add=function(t){var e=t.j(),n=t.q(),r=this.index[e]||new Ci(ri.k),t=!r.has(n);return this.index[e]=r.add(n),t},_a.prototype.has=function(t){var e=t.j(),t=t.q(),e=this.index[e];return e&&e.has(t)},_a.prototype.getEntries=function(t){return(this.index[t]||new Ci(ri.k)).H()},_a),ka=(Pa.prototype.next=function(){return this.li+=2,this.li},Pa._i=function(){return new Pa(0)},Pa.fi=function(){return new Pa(-1)},Pa),Da=(Sa.prototype.bi=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Ci(t,n.wi)})},Sa);function Sa(t,e,n,r){this.persistence=t,this.di=e,this.serializer=r,this.wi=new ki(Qr),this.Ei=new ea(gi,mi),this.mi=ni.min(),this.je=t.Ti(n),this.Ai=t.Ii(),this.Ri=t.Pi(),this.yi=new ca(this.Ai,this.je,this.persistence.Vi()),this.pi=t.gi(),this.di.vi(this.yi)}function Pa(t){this.li=t}function _a(){this.index={}}function La(){this.ai=new Ra}function Va(i,o){return v(this,void 0,void 0,function(){var e,n,m,r;return y(this,function(t){switch(t.label){case 0:return n=(e=i).je,m=e.yi,[4,e.persistence.runTransaction("Handle user change","readonly",function(y){var g;return e.je.Si(y).next(function(t){return g=t,n=e.persistence.Ti(o),m=new ca(e.Ai,n,e.persistence.Vi()),n.Si(y)}).next(function(t){for(var e=[],n=[],r=Bi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var v=d[p];r=r.add(v.key)}}return m.Je(y,r).next(function(t){return{Di:t,Ni:e,xi:n}})})})];case 1:return r=t.sent(),[2,(e.je=n,e.yi=m,e.di.vi(e.yi),r)]}})})}function Ca(t,c){var l=t;return l.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=c.batch.keys(),h=l.Ai.Fi({Oi:!0});return e=l,r=t,o=h,s=(i=c).batch,n=s.keys(),u=na.resolve(),n.forEach(function(n){u=u.next(function(){return o.He(r,n)}).next(function(t){var e=t,t=i.Ce.get(n);Cr(null!==t),(!e||e.version.F(t)<0)&&(e=s.Ve(n,e,i))&&o.$i(e,i.be)})}),u.next(function(){return e.je.Li(r,s)}).next(function(){return h.apply(t)}).next(function(){return l.je.ki(t)}).next(function(){return l.yi.Je(t,a)})})}function Ua(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Ri.Mi(t)})}function ja(t,o){var c=t,l=o.ft,f=c.wi;return c.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=c.Ai.Fi({Oi:!0});f=c.wi;var u=[];o.on.forEach(function(t,e){var n,r,i,o=f.get(e);o&&(u.push(c.Ri.Ui(s,t.wn,e).next(function(){return c.Ri.qi(s,t.fn,e)})),0<(i=t.resumeToken).ht()&&(n=o.wt(i,l).dt(s.Bi),f=f.Tt(e,n),r=o,i=t,Cr(0<(o=n).resumeToken.ht()),(0===r.resumeToken.ht()||3e8<=o.ft.O()-r.ft.O()||0<i.fn.size+i.dn.size+i.wn.size)&&u.push(c.Ri.Qi(s,n))))});var e,a,n,h,r,i=ji;return o.cn.forEach(function(t,e){o.an.has(t)&&u.push(c.persistence.Wi.ji(s,t))}),u.push((e=s,a=t,n=o.cn,h=l,r=Bi(),n.forEach(function(t){return r=r.add(t)}),a.getEntries(e,r).next(function(i){var o=ji;return n.forEach(function(t,e){var n=i.get(t),r=h;e instanceof ru&&e.version.isEqual(ni.min())?(a.Gi(t,r),o=o.Tt(t,e)):null==n||0<e.version.F(n.version)||0===e.version.F(n.version)&&n.hasPendingWrites?(a.$i(e,r),o=o.Tt(t,e)):Sr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o}).next(function(t){i=t}))),l.isEqual(ni.min())||(e=c.Ri.Mi(s).next(function(t){return c.Ri.Ki(s,s.Bi,l)}),u.push(e)),na.qe(u).next(function(){return t.apply(s)}).next(function(){return c.yi.Xe(s,i)})}).then(function(t){return c.wi=f,t})}function Ma(i,o,s){return v(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:n=(e=i).wi.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Wi.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!ma(r=t.sent()))throw r;return Sr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.wi=e.wi.remove(o),e.Ei.delete(n.target),[2]}})})}function xa(t,o,s){var u=t,a=ni.min(),h=Bi();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=yu(o),(void 0!==(t=(i=t).Ei.get(r))?na.resolve(i.wi.get(t)):i.Ri.Hi(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.Ri.Yi(e,t.targetId).next(function(t){h=t})}).next(function(){return u.di.ts(e,o,s?a:ni.min(),s?h:Bi())}).next(function(t){return{documents:t,Ji:h}});var t,n,r,i})}function qa(e){return v(this,void 0,void 0,function(){return y(this,function(t){if(e.code!==Mr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Sr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Fa(t,e,n,r,i){var o=this;this.jr=t,this.Wr=e,this.Ns=n,this.Gr={},this.Kr=[],this.zr=new Map,this.Hr=new Set,this.Yr=[],this.Jr=i,this.Jr.Xr(function(t){n.Ms(function(){return v(o,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return ah(this)?(Sr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return v(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return(e=n).Hr.add(4),[4,eh(e)];case 1:return t.sent(),e.Zr.set("Unknown"),e.Hr.delete(4),[4,th(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Zr=new Ya(n,r)}var Ga,Ba,Wa,l=(Za.prototype.sr=function(){return 1===this.state||2===this.state||4===this.state},Za.prototype.ir=function(){return 2===this.state},Za.prototype.start=function(){3!==this.state?this.auth():this.rr()},Za.prototype.stop=function(){return v(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.sr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Za.prototype.ur=function(){this.state=0,this.Ks.reset()},Za.prototype.cr=function(){var t=this;this.ir()&&null===this.er&&(this.er=this.Ts.Cs(this.Xi,6e4,function(){return t.ar()}))},Za.prototype.hr=function(t){this.lr(),this.stream.send(t)},Za.prototype.ar=function(){return v(this,void 0,void 0,function(){return y(this,function(t){return this.ir()?[2,this.close(0)]:[2]})})},Za.prototype.lr=function(){this.er&&(this.er.cancel(),this.er=null)},Za.prototype.close=function(e,n){return v(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.lr(),this.Ks.cancel(),this.nr++,3!==e?this.Ks.reset():n&&n.code===Mr.RESOURCE_EXHAUSTED?(Pr(n.toString()),Pr("Using maximum backoff delay to prevent overloading the backend."),this.Ks.gs()):n&&n.code===Mr.UNAUTHENTICATED&&this.tr.A(),null!==this.stream&&(this._r(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.dr(n)];case 1:return t.sent(),[2]}})})},Za.prototype._r=function(){},Za.prototype.auth=function(){var n=this;this.state=1;var t=this.wr(this.nr),e=this.nr;this.tr.getToken().then(function(t){n.nr===e&&n.Er(t)},function(e){t(function(){var t=new xr(Mr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.mr(t)})})},Za.prototype.Er=function(t){var e=this,n=this.wr(this.nr);this.stream=this.Tr(t),this.stream.Ar(function(){n(function(){return e.state=2,e.listener.Ar()})}),this.stream.dr(function(t){n(function(){return e.mr(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Za.prototype.rr=function(){var t=this;this.state=4,this.Ks.vs(function(){return v(t,void 0,void 0,function(){return y(this,function(t){return this.state=0,this.start(),[2]})})})},Za.prototype.mr=function(t){return Sr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Za.prototype.wr=function(e){var n=this;return function(t){n.Ts.Ms(function(){return n.nr===e?t():(Sr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Za),za=(n(Ja,Wa=l),Ja.prototype.Tr=function(t){return this.Zi.Ir("Listen",t)},Ja.prototype.onMessage=function(t){this.Ks.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:Vr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.ne?(Cr(void 0===o||"string"==typeof o),bi.fromBase64String(o||"")):(Cr(void 0===o||o instanceof Uint8Array),bi.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Mr.UNKNOWN:Ri(s.code),new xr(o,s.message||"")),r=new Ji(n,r,i,s||null)}else if("documentChange"in e){e.documentChange;var u=e.documentChange;u.document,u.document.name,u.document.updateTime;var i=Wo(t,u.document.name),a=qo(u.document.updateTime),s=new Xs({mapValue:{fields:u.document.fields}}),a=new nu(i,a,s,{}),s=u.targetIds||[],u=u.removedTargetIds||[];r=new $i(s,u,a.key,a)}else if("documentDelete"in e){e.documentDelete;u=e.documentDelete;u.document;var a=Wo(t,u.document),h=u.readTime?qo(u.readTime):ni.min(),h=new ru(a,h),u=u.removedTargetIds||[];r=new $i([],u,h.key,h)}else if("documentRemove"in e){e.documentRemove;h=e.documentRemove;h.document;var c=Wo(t,h.document),h=h.removedTargetIds||[];r=new $i([],h,c,null)}else{if(!("filter"in e))return Vr();e.filter;c=e.filter;c.targetId;e=c.count||0,e=new Ti(e),c=c.targetId;r=new Qi(c,e)}return r}(this.serializer,t),t=function(t){if(!("targetChange"in t))return ni.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?qo(t.readTime):ni.min()}(t);return this.listener.Rr(e,t)},Ja.prototype.Pr=function(t){var e,n,r,i={};i.database=Ho(this.serializer),i.addTarget=(e=this.serializer,(r=wi(r=(n=t).target)?{documents:{documents:[zo(e,r.path)]}}:{query:$o(e,r)}).targetId=n.targetId,0<n.resumeToken.ht()?r.resumeToken=xo(e,n.resumeToken):0<n.ft.F(ni.min())&&(r.readTime=Mo(e,n.ft.$())),r);var o,t=(this.serializer,o=t,null==(t=function(){switch(o._t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Vr()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.hr(i)},Ja.prototype.yr=function(t){var e={};e.database=Ho(this.serializer),e.removeTarget=t,this.hr(e)},Ja),Ha=(n(Qa,Ba=l),Object.defineProperty(Qa.prototype,"pr",{get:function(){return this.Vr},enumerable:!1,configurable:!0}),Qa.prototype.start=function(){this.Vr=!1,this.lastStreamToken=void 0,Ba.prototype.start.call(this)},Qa.prototype._r=function(){this.Vr&&this.gr([])},Qa.prototype.Tr=function(t){return this.Zi.Ir("Write",t)},Qa.prototype.onMessage=function(t){if(Cr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Vr){this.Ks.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Cr(void 0!==r),n.map(function(t){return function(t,e){var n=t.updateTime?qo(t.updateTime):qo(e);n.isEqual(ni.min())&&(n=qo(e));e=null;return t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new As(n,e)}(t,r)})):[]),n=qo(t.commitTime);return this.listener.vr(n,e)}var n,r;return Cr(!t.writeResults||0===t.writeResults.length),this.Vr=!0,this.listener.br()},Qa.prototype.Cr=function(){var t={};t.database=Ho(this.serializer),this.hr(t)},Qa.prototype.gr=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return Ko(e.serializer,t)})};this.hr(t)},Qa),Xa=(n($a,Ga=function(){}),$a.prototype.Dr=function(){if(this.Sr)throw new xr(Mr.FAILED_PRECONDITION,"The client has already been terminated.")},$a.prototype.Nr=function(e,n,r){var i=this;return this.Dr(),this.credentials.getToken().then(function(t){return i.Zi.Nr(e,n,r,t)}).catch(function(t){throw t.code===Mr.UNAUTHENTICATED&&i.credentials.A(),t})},$a.prototype.Fr=function(e,n,r){var i=this;return this.Dr(),this.credentials.getToken().then(function(t){return i.Zi.Fr(e,n,r,t)}).catch(function(t){throw t.code===Mr.UNAUTHENTICATED&&i.credentials.A(),t})},$a.prototype.terminate=function(){this.Sr=!1},$a),Ya=(Ka.prototype.Mr=function(){var t=this;0===this.$r&&(this.Ur("Unknown"),this.Lr=this.Ns.Cs("online_state_timeout",1e4,function(){return t.Lr=null,t.qr("Backend didn't respond within 10 seconds."),t.Ur("Offline"),Promise.resolve()}))},Ka.prototype.Br=function(t){"Online"===this.state?this.Ur("Unknown"):(this.$r++,1<=this.$r&&(this.Qr(),this.qr("Connection failed 1 times. Most recent error: "+t.toString()),this.Ur("Offline")))},Ka.prototype.set=function(t){this.Qr(),this.$r=0,"Online"===t&&(this.kr=!1),this.Ur(t)},Ka.prototype.Ur=function(t){t!==this.state&&(this.state=t,this.Or(t))},Ka.prototype.qr=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.kr?(Pr(t),this.kr=!1):Sr("OnlineStateTracker",t)},Ka.prototype.Qr=function(){null!==this.Lr&&(this.Lr.cancel(),this.Lr=null)},Ka);function Ka(t,e){this.Ns=t,this.Or=e,this.state="Unknown",this.$r=0,this.Lr=null,this.kr=!0}function $a(t,e,n){var r=this;return(r=Ga.call(this)||this).credentials=t,r.Zi=e,r.serializer=n,r.Sr=!1,r}function Qa(t,e,n,r,i){var o=this;return(o=Ba.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Vr=!1,o}function Ja(t,e,n,r,i){var o=this;return(o=Wa.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Za(t,e,n,r,i,o){this.Ts=t,this.Xi=n,this.Zi=r,this.tr=i,this.listener=o,this.state=0,this.nr=0,this.er=null,this.stream=null,this.Ks=new ya(t,e)}function th(r){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:if(!ah(r))return[3,4];e=0,n=r.Yr,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function eh(r){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:e=0,n=r.Yr,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function nh(t,e){t.zr.has(e.targetId)||(t.zr.set(e.targetId,e),uh(t)?sh(t):yh(t).ir()&&ih(t,e))}function rh(t,e){var n=t,t=yh(n);n.zr.delete(e),t.ir()&&oh(n,e),0===n.zr.size&&(t.ir()?t.cr():ah(n)&&n.Zr.set("Unknown"))}function ih(t,e){t.no.Dn(e.targetId),yh(t).Pr(e)}function oh(t,e){t.no.Dn(e),yh(t).yr(e)}function sh(e){e.no=new to({Zn:function(t){return e.Gr.Zn(t)},te:function(t){return e.zr.get(t)||null}}),yh(e).start(),e.Zr.Mr()}function uh(t){return ah(t)&&!yh(t).sr()&&0<t.zr.size}function ah(t){return 0===t.Hr.size}function hh(t){t.no=void 0}function ch(s,u,a){return v(this,void 0,void 0,function(){var n,o;return y(this,function(t){switch(t.label){case 0:if(s.Zr.set("Online"),!(u instanceof Ji&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return v(this,void 0,void 0,function(){var e,n,r,i;return y(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.zr.has(i)?[4,o.Gr.eo(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.zr.delete(i),o.no.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Sr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,lh(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof $i?s.no.Mn(u):u instanceof Qi?s.no.Kn(u):s.no.Bn(u),a.isEqual(ni.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Ua(s.jr)];case 8:return o=t.sent(),0<=a.F(o)?[4,(i=a,(e=(r=s).no.Yn(i)).on.forEach(function(t,e){var n;0<t.resumeToken.ht()&&((n=r.zr.get(e))&&r.zr.set(e,n.wt(t.resumeToken,i)))}),e.un.forEach(function(t){var e=r.zr.get(t);e&&(r.zr.set(t,e.wt(bi.lt,e.ft)),oh(r,t),e=new Ai(e.target,t,1,e.sequenceNumber),ih(r,e))}),r.Gr.so(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Sr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,lh(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function lh(n,r,i){return v(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:if(!ma(r))throw r;return n.Hr.add(1),[4,eh(n)];case 1:return t.sent(),n.Zr.set("Offline"),i=i||function(){return Ua(n.jr)},n.Ns.ti(function(){return v(e,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return Sr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Hr.delete(1),[4,th(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function fh(e,n){return n().catch(function(t){return lh(e,t,n)})}function ph(a){return v(this,void 0,void 0,function(){var i,o,s,u;return y(this,function(t){switch(t.label){case 0:o=gh(i=a),s=0<i.Kr.length?i.Kr[i.Kr.length-1].batchId:-1,t.label=1;case 1:if(!(ah(i)&&i.Kr.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.jr,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.je.zi(t,n)}))];case 3:return null===(u=t.sent())?(0===i.Kr.length&&o.cr(),[3,7]):(s=u.batchId,function(t,e){t.Kr.push(e);t=gh(t);t.ir()&&t.pr&&t.gr(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,lh(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return dh(i)&&vh(i),[2]}var e,n,r})})}function dh(t){return ah(t)&&!gh(t).sr()&&0<t.Kr.length}function vh(t){gh(t).start()}function yh(n){var t,e,r,i=this;return n.oo||(n.oo=(t=n.Wr,e=n.Ns,r={Ar:function(n){return v(this,void 0,void 0,function(){return y(this,function(t){return n.zr.forEach(function(t,e){ih(n,t)}),[2]})})}.bind(null,n),dr:function(e,n){return v(this,void 0,void 0,function(){return y(this,function(t){return hh(e),uh(e)?(e.Zr.Br(n),sh(e)):e.Zr.set("Unknown"),[2]})})}.bind(null,n),Rr:ch.bind(null,n)},t.Dr(),new za(e,t.Zi,t.credentials,t.serializer,r)),n.Yr.push(function(e){return v(i,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e?(n.oo.ur(),uh(n)?sh(n):n.Zr.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.oo.stop()];case 2:t.sent(),hh(n),t.label=3;case 3:return[2]}})})})),n.oo}function gh(n){var t,e,r,i=this;return n.uo||(n.uo=(t=n.Wr,e=n.Ns,r={Ar:function(e){return v(this,void 0,void 0,function(){return y(this,function(t){return gh(e).Cr(),[2]})})}.bind(null,n),dr:function(e,n){return v(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return n&&gh(e).pr?[4,function(r,i){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return Oi(n=i.code)&&n!==Mr.ABORTED?(e=r.Kr.shift(),gh(r).ur(),[4,fh(r,function(){return r.Gr.ro(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,ph(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return dh(e)&&vh(e),[2]}})})}.bind(null,n),br:function(o){return v(this,void 0,void 0,function(){var e,n,r,i;return y(this,function(t){for(e=gh(o),n=0,r=o.Kr;n<r.length;n++)i=r[n],e.gr(i.mutations);return[2]})})}.bind(null,n),vr:function(r,i,o){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return e=r.Kr.shift(),n=ta.from(e,i,o),[4,fh(r,function(){return r.Gr.io(n)})];case 1:return t.sent(),[4,ph(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Dr(),new Ha(e,t.Zi,t.credentials,t.serializer,r)),n.Yr.push(function(e){return v(i,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e?(n.uo.ur(),[4,ph(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.uo.stop()];case 3:t.sent(),0<n.Kr.length&&(Sr("RemoteStore","Stopping write stream with "+n.Kr.length+" pending writes"),n.Kr=[]),t.label=4;case 4:return[2]}})})})),n.uo}function mh(){this.queries=new ea(wu,mu),this.onlineState="Unknown",this.ao=new Set}var wh=function(){this.co=void 0,this.listeners=[]};function bh(s,u){return v(this,void 0,void 0,function(){var e,n,r,i,o;return y(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new wh),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.ho(n)];case 2:return o.co=t.sent(),[3,4];case 3:return o=t.sent(),o=Aa(o,"Initialization of query '"+bu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.lo(e.onlineState),i.co&&u._o(i.co)&&Th(e),[2]}})})}function Eh(s,u){return v(this,void 0,void 0,function(){var e,n,r,i,o;return y(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.fo(n))]:[2]})})}function Th(t){t.ao.forEach(function(t){t.next()})}var Ih=(qh.prototype._o=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Xi(t.query,t.docs,t.tn,e,t.nn,t.fromCache,t.en,!0)}var o=!1;return this.Eo?this.To(t)&&(this.wo.next(t),o=!0):this.Ao(t,this.onlineState)&&(this.Io(t),o=!0),this.mo=t,o},qh.prototype.onError=function(t){this.wo.error(t)},qh.prototype.lo=function(t){this.onlineState=t;var e=!1;return this.mo&&!this.Eo&&this.Ao(this.mo,t)&&(this.Io(this.mo),e=!0),e},qh.prototype.Ao=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Ro&&n||t.docs.W()&&"Offline"!==e)},qh.prototype.To=function(t){if(0<t.docChanges.length)return!0;var e=this.mo&&this.mo.hasPendingWrites!==t.hasPendingWrites;return!(!t.en&&!e)&&!0===this.options.includeMetadataChanges},qh.prototype.Io=function(t){t=Xi.rn(t.query,t.docs,t.nn,t.fromCache),this.Eo=!0,this.wo.next(t)},qh),Ah=(xh.prototype.W=function(){return this.Po.W()},xh.prototype.vo=function(t,e){e=new Nh(t,e);this.Po=this.Po.add(e),this.Vo=this.Vo.add(e)},xh.prototype.bo=function(t,e){var n=this;t.forEach(function(t){return n.vo(t,e)})},xh.prototype.Co=function(t,e){this.So(new Nh(t,e))},xh.prototype.Do=function(t,e){var n=this;t.forEach(function(t){return n.Co(t,e)})},xh.prototype.No=function(t){var e=this,n=new si(new ri([])),r=new Nh(n,t),t=new Nh(n,t+1),i=[];return this.Vo.jt([r,t],function(t){e.So(t),i.push(t.key)}),i},xh.prototype.xo=function(){var e=this;this.Po.forEach(function(t){return e.So(t)})},xh.prototype.So=function(t){this.Po=this.Po.delete(t),this.Vo=this.Vo.delete(t)},xh.prototype.Fo=function(t){var e=new si(new ri([])),n=new Nh(e,t),t=new Nh(e,t+1),r=Bi();return this.Vo.jt([n,t],function(t){r=r.add(t.key)}),r},xh.prototype.Oo=function(t){var e=new Nh(t,0),e=this.Po.Gt(e);return null!==e&&t.isEqual(e.key)},xh),Nh=(Mh.yo=function(t,e){return si.k(t.key,e.key)||Qr(t.$o,e.$o)},Mh.po=function(t,e){return Qr(t.$o,e.$o)||si.k(t.key,e.key)},Mh),Oh=(jh.prototype.Lo=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},jh.prototype.ko=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},jh.prototype.Mo=function(){var t={activeTargetIds:this.activeTargetIds.H(),updateTimeMs:Date.now()};return JSON.stringify(t)},jh),Rh=(Uh.prototype.Bo=function(t){},Uh.prototype.Qo=function(t,e,n){},Uh.prototype.jo=function(t){return this.Uo.Lo(t),this.qo[t]||"not-current"},Uh.prototype.Wo=function(t,e,n){this.qo[t]=e},Uh.prototype.Go=function(t){this.Uo.ko(t)},Uh.prototype.Ko=function(t){return this.Uo.activeTargetIds.has(t)},Uh.prototype.zo=function(t){delete this.qo[t]},Uh.prototype.Ho=function(){return this.Uo.activeTargetIds},Uh.prototype.Yo=function(t){return this.Uo.activeTargetIds.has(t)},Uh.prototype.start=function(){return this.Uo=new Oh,Promise.resolve()},Uh.prototype.Jo=function(t,e,n){},Uh.prototype.Xo=function(t){},Uh.prototype.Zo=function(){},Uh.prototype.ws=function(t){},Uh.prototype.tu=function(){},Uh),kh=function(t){this.key=t},Dh=function(t){this.key=t},Sh=(Object.defineProperty(Ch.prototype,"ou",{get:function(){return this.nu},enumerable:!1,configurable:!0}),Ch.prototype.uu=function(t,e){var s=this,u=e?e.cu:new Hi,a=(e||this).ru,h=(e||this).nn,c=a,l=!1,f=cu(this.query)&&a.size===this.query.limit?a.last():null,p=lu(this.query)&&a.size===this.query.limit?a.first():null;if(t.Pt(function(t,e){var n=a.get(t),r=(r=e instanceof nu?e:null)&&(Eu(s.query,r)?r:null),i=!!n&&s.nn.has(n.key),o=!!r&&(r.ae||s.nn.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.au(n,r)||(u.track({type:2,doc:r}),e=!0,(f&&0<s.iu(r,f)||p&&s.iu(r,p)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(h=r?(c=c.add(r),o?h.add(t):h.delete(t)):(c=c.delete(t),h.delete(t)))}),cu(this.query)||lu(this.query))for(;c.size>this.query.limit;){var n=cu(this.query)?c.last():c.first(),c=c.delete(n.key),h=h.delete(n.key);u.track({type:1,doc:n})}return{ru:c,cu:u,hu:l,nn:h}},Ch.prototype.au=function(t,e){return t.ae&&e.hasCommittedMutations&&!e.ae},Ch.prototype.lu=function(t,e,n){var o=this,r=this.ru;this.ru=t.ru,this.nn=t.nn;var i=t.cu.Zt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.iu(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Vr()}}var r,i}),this._u(n);var s=e?this.fu():[],n=0===this.su.size&&this._n?1:0,e=n!==this.eu;return this.eu=n,0!==i.length||e?{snapshot:new Xi(this.query,t.ru,r,i,t.nn,0==n,e,!1),du:s}:{du:s}},Ch.prototype.lo=function(t){return this._n&&"Offline"===t?(this._n=!1,this.lu({ru:this.ru,cu:new Hi,nn:this.nn,hu:!1},!1)):{du:[]}},Ch.prototype.wu=function(t){return!this.nu.has(t)&&!!this.ru.has(t)&&!this.ru.get(t).ae},Ch.prototype._u=function(t){var e=this;t&&(t.fn.forEach(function(t){return e.nu=e.nu.add(t)}),t.dn.forEach(function(t){}),t.wn.forEach(function(t){return e.nu=e.nu.delete(t)}),this._n=t._n)},Ch.prototype.fu=function(){var e=this;if(!this._n)return[];var n=this.su;this.su=Bi(),this.ru.forEach(function(t){e.wu(t.key)&&(e.su=e.su.add(t.key))});var r=[];return n.forEach(function(t){e.su.has(t)||r.push(new Dh(t))}),this.su.forEach(function(t){n.has(t)||r.push(new kh(t))}),r},Ch.prototype.Eu=function(t){this.nu=t.Ji,this.su=Bi();t=this.uu(t.documents);return this.lu(t,!0)},Ch.prototype.mu=function(){return Xi.rn(this.query,this.ru,this.nn,0===this.eu)},Ch),Ph=function(t,e,n){this.query=t,this.targetId=e,this.view=n},_h=function(t){this.key=t,this.Tu=!1},Lh=(Object.defineProperty(Vh.prototype,"Fu",{get:function(){return!0===this.xu},enumerable:!1,configurable:!0}),Vh);function Vh(t,e,n,r,i,o){this.jr=t,this.Au=e,this.Iu=n,this.Ru=r,this.currentUser=i,this.Pu=o,this.yu={},this.Vu=new ea(wu,mu),this.pu=new Map,this.gu=[],this.vu=new ki(si.k),this.bu=new Map,this.Cu=new Ah,this.Su={},this.Du=new Map,this.Nu=ka.fi(),this.onlineState="Unknown",this.xu=void 0}function Ch(t,e){this.query=t,this.nu=e,this.eu=null,this._n=!1,this.su=Bi(),this.nn=Bi(),this.iu=Tu(t),this.ru=new zi(this.iu)}function Uh(){this.Uo=new Oh,this.qo={},this.Or=null,this._s=null}function jh(){this.activeTargetIds=Wi}function Mh(t,e){this.key=t,this.$o=e}function xh(){this.Po=new Ci(Nh.yo),this.Vo=new Ci(Nh.po)}function qh(t,e,n){this.query=t,this.wo=e,this.Eo=!1,this.mo=null,this.onlineState="Unknown",this.options=n||{}}function Fh(h,c){return v(this,void 0,void 0,function(){var n,o,s,u,a;return y(this,function(t){switch(t.label){case 0:return(e=h).Au.Gr.so=Bh.bind(null,e),e.Au.Gr.Zn=function(t,e){var n=t,t=n.bu.get(e);if(t&&t.Tu)return Bi().add(t.key);var r=Bi(),e=n.pu.get(e);if(!e)return r;for(var i=0,o=e;i<o.length;i++){var s=o[i],s=n.Vu.get(s);r=r.Kt(s.view.ou)}return r}.bind(null,e),e.Au.Gr.eo=function(o,s,u){return v(this,void 0,void 0,function(){var e,n,r,i;return y(this,function(t){switch(t.label){case 0:return(e=o).Ru.Wo(s,"rejected",u),i=e.bu.get(s),(n=i&&i.key)?(r=(r=new ki(si.k)).Tt(n,new ru(n,ni.min())),i=Bi().add(n),i=new Yi(ni.min(),new Map,new Ci(Qr),r,i),[4,Bh(e,i)]):[3,2];case 1:return t.sent(),e.vu=e.vu.remove(n),e.bu.delete(s),Qh(e),[3,4];case 2:return[4,Ma(e.jr,s,!1).then(function(){return Yh(e,s,u)}).catch(qa)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.yu.Rr=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.queries.get(u);if(u){for(var a=0,h=u.listeners;a<h.length;a++)h[a]._o(s)&&(r=!0);u.co=s}}r&&Th(n)}.bind(null,e.Iu),e.yu.Ou=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,e.Iu),(a=(n=e).Vu.get(c))?(o=a.targetId,n.Ru.jo(o),s=a.view.mu(),[3,4]):[3,1];case 1:return[4,(e=n.jr,r=yu(c),(i=e).persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Ri.Hi(e,r).next(function(t){return t?(n=t,na.resolve(n)):i.Ri.$u(e).next(function(t){return n=new Ai(r,t,0,e.Bi),i.Ri.Lu(e,n).next(function(){return n})})})}).then(function(t){var e=i.wi.get(t.targetId);return(null===e||0<t.ft.F(e.ft))&&(i.wi=i.wi.Tt(t.targetId,t),i.Ei.set(r,t.targetId)),t}))];case 2:return u=t.sent(),a=n.Ru.jo(u.targetId),o=u.targetId,[4,function(i,o,s,u){return v(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:return i.ku=function(t,e,n){return function(r,i,o,s){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return(e=i.view.uu(o)).hu?[4,xa(r.jr,i.query,!1).then(function(t){t=t.documents;return i.view.uu(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.on.get(i.targetId),n=i.view.lu(e,r.Fu,n),[2,($h(r,i.targetId,n.du),n.snapshot)]}})})}(i,t,e,n)},[4,xa(i.jr,o,!0)];case 1:return n=t.sent(),r=new Sh(o,n.Ji),e=r.uu(n.documents),n=Ki.ln(s,u&&"Offline"!==i.onlineState),n=r.lu(e,i.Fu,n),$h(i,s,n.du),r=new Ph(o,s,r),i.Vu.set(o,r),i.pu.has(s)?i.pu.get(s).push(o):i.pu.set(s,[o]),[2,n.snapshot]}})})}(n,c,o,"current"===a)];case 3:s=t.sent(),n.Fu&&nh(n.Au,u),t.label=4;case 4:return[2,s]}var r,i,e})})}function Gh(f,p,d){return v(this,void 0,void 0,function(){var s,u;return y(this,function(t){switch(t.label){case 0:(o=f).Au.Gr.io=function(i,o){return v(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Ca(e.jr,o)];case 2:return r=t.sent(),Xh(e,n,null),Hh(e,n),e.Ru.Qo(n,"acknowledged"),[4,Jh(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,qa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,o),o.Au.Gr.ro=function(s,u,a){return v(this,void 0,void 0,function(){var n,o;return y(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.jr,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.je.qu(e,r).next(function(t){return Cr(null!==t),n=t.keys(),i.je.Li(e,t)}).next(function(){return i.je.ki(e)}).next(function(){return i.yi.Je(e,n)})}))];case 2:return o=t.sent(),Xh(n,u,a),Hh(n,u),n.Ru.Qo(u,"rejected",a),[4,Jh(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,qa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.jr,a=p,c=r,l=ei.now(),i=a.reduce(function(t,e){return t.add(e.key)},Bi()),c.persistence.runTransaction("Locally write mutations","readwrite",function(u){return c.yi.Je(u,i).next(function(t){h=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=h.get(i.key),s instanceof qs?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof nu?t.field(i.field):void 0,o=is(i.transform,o||null);null!=o&&(e=(null==e?new Ys:e).set(i.field,o))}return e?e.he():null}(o):null);null!=o&&e.push(new Cs(i.key,o,function s(t){var u=[];return lo(t.fields||{},function(t,e){var n=new oi([t]);if(Po(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Ts(u)}(o.proto.mapValue),Ns.exists(!0)))}return c.je.Mu(u,l,e,a)})}).then(function(t){var e=t.ve(h);return{batchId:t.batchId,Uu:e}}))];case 2:return s=t.sent(),u.Ru.Bo(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.Su[e.currentUser.h()])||new ki(Qr)).Tt(n,o),e.Su[e.currentUser.h()]=r,[4,Jh(u,s.Uu)];case 3:return t.sent(),[4,ph(u.Au)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=Aa(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,h,c,l,i,o})})}function Bh(r,i){return v(this,void 0,void 0,function(){var n,e;return y(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,ja(n.jr,i)];case 2:return e=t.sent(),i.on.forEach(function(t,e){e=n.bu.get(e);e&&(Cr(t.fn.size+t.dn.size+t.wn.size<=1),0<t.fn.size?e.Tu=!0:0<t.dn.size?Cr(e.Tu):0<t.wn.size&&(Cr(e.Tu),e.Tu=!1))}),[4,Jh(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,qa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function Wh(t,n,e){var r,t=t;(t.Fu&&0===e||!t.Fu&&1===e)&&(r=[],t.Vu.forEach(function(t,e){e=e.view.lo(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].lo(i)&&(o=!0)}),o&&Th(t)}(t.Iu,n),r.length&&t.yu.Rr(r),t.onlineState=n,t.Fu&&t.Ru.Xo(n))}function zh(o,s){return v(this,void 0,void 0,function(){var n,r,i;return y(this,function(t){switch(t.label){case 0:ah((n=o).Au)||Sr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.jr).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.je.Bu(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Du.get(r)||[]).push(s),n.Du.set(r,i),[3,4]);case 3:return i=t.sent(),i=Aa(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function Hh(t,e){(t.Du.get(e)||[]).forEach(function(t){t.resolve()}),t.Du.delete(e)}function Xh(t,e,n){var r=t,i=r.Su[r.currentUser.h()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.Su[r.currentUser.h()]=i)}function Yh(e,t,n){void 0===n&&(n=null),e.Ru.Go(t);for(var r=0,i=e.pu.get(t);r<i.length;r++){var o=i[r];e.Vu.delete(o),n&&e.yu.Ou(o,n)}e.pu.delete(t),e.Fu&&e.Cu.No(t).forEach(function(t){e.Cu.Oo(t)||Kh(e,t)})}function Kh(t,e){var n=t.vu.get(e);null!==n&&(rh(t.Au,n),t.vu=t.vu.remove(e),t.bu.delete(n),Qh(t))}function $h(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof kh?(t.Cu.vo(o.key,e),function(t,e){e=e.key;t.vu.get(e)||(Sr("SyncEngine","New document in limbo: "+e),t.gu.push(e),Qh(t))}(t,o)):o instanceof Dh?(Sr("SyncEngine","Document no longer in limbo: "+o.key),t.Cu.Co(o.key,e),t.Cu.Oo(o.key)||Kh(t,o.key)):Vr()}}function Qh(t){for(;0<t.gu.length&&t.vu.size<t.Pu;){var e=t.gu.shift(),n=t.Nu.next();t.bu.set(n,new _h(e)),t.vu=t.vu.Tt(e,n),nh(t.Au,new Ai(yu(hu(e.path)),n,2,fa.Es))}}function Jh(e,s,u){return v(this,void 0,void 0,function(){var n,r,i,o;return y(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Vu.W()?[3,3]:(n.Vu.forEach(function(t,e){o.push(n.ku(e,s,u).then(function(t){t&&(n.Fu&&n.Ru.Wo(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=la.ls(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.yu.Rr(r),[4,function(a,h){return v(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return y(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return na.forEach(h,function(e){return na.forEach(e.cs,function(t){return r.persistence.Wi.vo(n,e.targetId,t)}).next(function(){return na.forEach(e.hs,function(t){return r.persistence.Wi.Co(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!ma(e=t.sent()))throw e;return Sr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=h;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.wi.get(o),u=s.ft,u=s.Et(u),r.wi=r.wi.Tt(o,u));return[2]}})})}(n.jr,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function Zh(i,o){return v(this,void 0,void 0,function(){var n,r;return y(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Sr("SyncEngine","User change. New user:",o.h()),[4,Va(n.jr,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Du.forEach(function(t){t.forEach(function(t){t.reject(new xr(Mr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Du.clear(),n.Ru.Jo(o,r.Ni,r.xi),[4,Jh(n,r.Di)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}var tc,ec,nc,rc=(xc.prototype.vi=function(t){this.Qu=t},xc.prototype.ts=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.me.length||1===r.me.length&&r.me[0].field.tt())||i.isEqual(ni.min())?this.ju(e,r):this.Qu.Je(e,o).next(function(t){var n=s.Wu(r,t);return(cu(r)||lu(r))&&s.hu(r.limitType,n,o,i)?s.ju(e,r):(Dr()<=u.DEBUG&&Sr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),bu(r)),s.Qu.ts(e,r,i).next(function(e){return n.forEach(function(t){e=e.Tt(t.key,t)}),e}))})},xc.prototype.Wu=function(n,t){var r=new Ci(Tu(n));return t.forEach(function(t,e){e instanceof nu&&Eu(n,e)&&(r=r.add(e))}),r},xc.prototype.hu=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.F(r))},xc.prototype.ju=function(t,e){return Dr()<=u.DEBUG&&Sr("IndexFreeQueryEngine","Using full collection scan to execute query:",bu(e)),this.Qu.ts(t,e,ni.min())},xc),ic=(Mc.prototype.zu=function(t){return na.resolve(0===this.je.length)},Mc.prototype.Mu=function(t,e,n,r){var i=this.Gu;this.Gu++,0<this.je.length&&this.je[this.je.length-1];n=new Zu(i,e,n,r);this.je.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Ku=this.Ku.add(new Nh(u.key,i)),this.We.hi(t,u.key.path.q())}return na.resolve(n)},Mc.prototype.qu=function(t,e){return na.resolve(this.Hu(e))},Mc.prototype.zi=function(t,e){e+=1,e=this.Yu(e),e=e<0?0:e;return na.resolve(this.je.length>e?this.je[e]:null)},Mc.prototype.Bu=function(){return na.resolve(0===this.je.length?-1:this.Gu-1)},Mc.prototype.Si=function(t){return na.resolve(this.je.slice())},Mc.prototype.Ke=function(t,e){var n=this,r=new Nh(e,0),e=new Nh(e,Number.POSITIVE_INFINITY),i=[];return this.Ku.jt([r,e],function(t){t=n.Hu(t.$o);i.push(t)}),na.resolve(i)},Mc.prototype.Ze=function(t,e){var n=this,r=new Ci(Qr);return e.forEach(function(t){var e=new Nh(t,0),t=new Nh(t,Number.POSITIVE_INFINITY);n.Ku.jt([e,t],function(t){r=r.add(t.$o)})}),na.resolve(this.Ju(r))},Mc.prototype.os=function(t,e){var n=e.path,r=n.length+1,e=n;si.ot(e)||(e=e.child(""));var e=new Nh(new si(e),0),i=new Ci(Qr);return this.Ku.Wt(function(t){var e=t.key.path;return!!n.G(e)&&(e.length===r&&(i=i.add(t.$o)),!0)},e),na.resolve(this.Ju(i))},Mc.prototype.Ju=function(t){var e=this,n=[];return t.forEach(function(t){t=e.Hu(t);null!==t&&n.push(t)}),n},Mc.prototype.Li=function(n,r){var i=this;Cr(0===this.Xu(r.batchId,"removed")),this.je.shift();var o=this.Ku;return na.forEach(r.mutations,function(t){var e=new Nh(t.key,r.batchId);return o=o.delete(e),i.Wi.Zu(n,t.key)}).next(function(){i.Ku=o})},Mc.prototype.tc=function(t){},Mc.prototype.Oo=function(t,e){var n=new Nh(e,0),n=this.Ku.Gt(n);return na.resolve(e.isEqual(n&&n.key))},Mc.prototype.ki=function(t){return this.je.length,na.resolve()},Mc.prototype.Xu=function(t,e){return this.Yu(t)},Mc.prototype.Yu=function(t){return 0===this.je.length?0:t-this.je[0].batchId},Mc.prototype.Hu=function(t){t=this.Yu(t);return t<0||t>=this.je.length?null:this.je[t]},Mc),oc=(jc.prototype.$i=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.nc(e);return this.docs=this.docs.Tt(r,{ec:e,size:i,readTime:n}),this.size+=i-o,this.We.hi(t,r.path.q())},jc.prototype.Gi=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},jc.prototype.He=function(t,e){e=this.docs.get(e);return na.resolve(e?e.ec:null)},jc.prototype.getEntries=function(t,e){var n=this,r=ji;return e.forEach(function(t){var e=n.docs.get(t);r=r.Tt(t,e?e.ec:null)}),na.resolve(r)},jc.prototype.ts=function(t,e,n){for(var r=qi,i=new si(e.path.child("")),o=this.docs.gt(i);o.Nt();){var s=o.Dt(),u=s.key,a=s.value,s=a.ec,a=a.readTime;if(!e.path.G(u.path))break;a.F(n)<=0||s instanceof nu&&Eu(e,s)&&(r=r.Tt(s.key,s))}return na.resolve(r)},jc.prototype.sc=function(t,e){return na.forEach(this.docs,function(t){return e(t)})},jc.prototype.Fi=function(t){return new sc(this)},jc.prototype.ic=function(t){return na.resolve(this.size)},jc),sc=(Uc.prototype.oc=function(t){t=this.Uu.get(t);return t?t.readTime:ni.min()},Uc.prototype.$i=function(t,e){this.uc(),this.Uu.set(t.key,{ec:t,readTime:e})},Uc.prototype.Gi=function(t,e){void 0===e&&(e=null),this.uc(),this.Uu.set(t,{ec:null,readTime:e})},Uc.prototype.He=function(t,e){this.uc();var n=this.Uu.get(e);return void 0!==n?na.resolve(n.ec):this.cc(t,e)},Uc.prototype.getEntries=function(t,e){return this.ac(t,e)},Uc.prototype.apply=function(t){return this.uc(),this.rc=!0,this.lu(t)},Uc.prototype.uc=function(){},n(Cc,nc=Uc),Cc.prototype.lu=function(n){var r=this,i=[];return this.Uu.forEach(function(t,e){e&&e.ec?i.push(r.hc.$i(n,e.ec,r.oc(t))):r.hc.Gi(t)}),na.qe(i)},Cc.prototype.cc=function(t,e){return this.hc.He(t,e)},Cc.prototype.ac=function(t,e){return this.hc.getEntries(t,e)},Cc),uc=(Vc.prototype.Qn=function(t,n){return this.lc.forEach(function(t,e){return n(e)}),na.resolve()},Vc.prototype.Mi=function(t){return na.resolve(this.lastRemoteSnapshotVersion)},Vc.prototype.wc=function(t){return na.resolve(this._c)},Vc.prototype.$u=function(t){return this.highestTargetId=this.dc.next(),na.resolve(this.highestTargetId)},Vc.prototype.Ki=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this._c&&(this._c=e),na.resolve()},Vc.prototype.Ec=function(t){this.lc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.dc=new ka(e),this.highestTargetId=e),t.sequenceNumber>this._c&&(this._c=t.sequenceNumber)},Vc.prototype.Lu=function(t,e){return this.Ec(e),this.targetCount+=1,na.resolve()},Vc.prototype.Qi=function(t,e){return this.Ec(e),na.resolve()},Vc.prototype.mc=function(t,e){return this.lc.delete(e.target),this.fc.No(e.targetId),--this.targetCount,na.resolve()},Vc.prototype.Tc=function(n,r,i){var o=this,s=0,u=[];return this.lc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.lc.delete(t),u.push(o.Ac(n,e.targetId)),s++)}),na.qe(u).next(function(){return s})},Vc.prototype.Ic=function(t){return na.resolve(this.targetCount)},Vc.prototype.Hi=function(t,e){e=this.lc.get(e)||null;return na.resolve(e)},Vc.prototype.qi=function(t,e,n){return this.fc.bo(e,n),na.resolve()},Vc.prototype.Ui=function(e,t,n){this.fc.Do(t,n);var r=this.persistence.Wi,i=[];return r&&t.forEach(function(t){i.push(r.Zu(e,t))}),na.qe(i)},Vc.prototype.Ac=function(t,e){return this.fc.No(e),na.resolve()},Vc.prototype.Yi=function(t,e){e=this.fc.Fo(e);return na.resolve(e)},Vc.prototype.Oo=function(t,e){return na.resolve(this.fc.Oo(e))},Vc),ac=(Lc.prototype.yc=function(t,e){return na.resolve(this.Rc.get(e))},Lc.prototype.Vc=function(t,e){return this.Rc.set(e.id,{id:e.id,version:e.version,createTime:qo(e.createTime)}),na.resolve()},Lc.prototype.gc=function(t,e){return na.resolve(this.Pc.get(e))},Lc.prototype.vc=function(t,e){var n,r;return this.Pc.set(e.name,{name:(n=e).name,query:(r=n.bundledQuery,e=Qo({parent:r.parent,structuredQuery:r.structuredQuery}),"LAST"===r.limitType?gu(e,e.limit,"L"):e),readTime:qo(n.readTime)}),na.resolve()},Lc),hc=(_c.prototype.start=function(){return Promise.resolve()},_c.prototype.Zo=function(){return this.Sc=!1,Promise.resolve()},Object.defineProperty(_c.prototype,"Nc",{get:function(){return this.Sc},enumerable:!1,configurable:!0}),_c.prototype.xc=function(){},_c.prototype.Fc=function(){},_c.prototype.Vi=function(){return this.We},_c.prototype.Ti=function(t){var e=this.bc[t.h()];return e||(e=new ic(this.We,this.Wi),this.bc[t.h()]=e),e},_c.prototype.Pi=function(){return this.Ri},_c.prototype.Ii=function(){return this.Qe},_c.prototype.gi=function(){return this.pi},_c.prototype.runTransaction=function(t,e,n){var r=this;Sr("MemoryPersistence","Starting transaction:",t);var i=new cc(this.Cc.next());return this.Wi.Oc(),n(i).next(function(t){return r.Wi.$c(i).next(function(){return t})}).Me().then(function(t){return i.Lc(),t})},_c.prototype.kc=function(e,n){return na.Be(Object.values(this.bc).map(function(t){return function(){return t.Oo(e,n)}}))},_c),cc=(Pc.prototype.Uc=function(t){this.Mc.push(t)},Pc.prototype.Lc=function(){this.Mc.forEach(function(t){return t()})},n(Sc,ec=Pc),Sc),lc=(Dc.Qc=function(t){return new Dc(t)},Object.defineProperty(Dc.prototype,"jc",{get:function(){if(this.Bc)return this.Bc;throw Vr()},enumerable:!1,configurable:!0}),Dc.prototype.vo=function(t,e,n){return this.qc.vo(n,e),this.jc.delete(n.toString()),na.resolve()},Dc.prototype.Co=function(t,e,n){return this.qc.Co(n,e),this.jc.add(n.toString()),na.resolve()},Dc.prototype.Zu=function(t,e){return this.jc.add(e.toString()),na.resolve()},Dc.prototype.removeTarget=function(t,e){var n=this;this.qc.No(e.targetId).forEach(function(t){return n.jc.add(t.toString())});var r=this.persistence.Pi();return r.Yi(t,e.targetId).next(function(t){t.forEach(function(t){return n.jc.add(t.toString())})}).next(function(){return r.mc(t,e)})},Dc.prototype.Oc=function(){this.Bc=new Set},Dc.prototype.$c=function(n){var r=this,i=this.persistence.Ii().Fi();return na.forEach(this.jc,function(t){var e=si.st(t);return r.Wc(n,e).next(function(t){t||i.Gi(e)})}).next(function(){return r.Bc=null,i.apply(n)})},Dc.prototype.ji=function(t,e){var n=this;return this.Wc(t,e).next(function(t){t?n.jc.delete(e.toString()):n.jc.add(e.toString())})},Dc.prototype.Dc=function(t){return 0},Dc.prototype.Wc=function(t,e){var n=this;return na.Be([function(){return na.resolve(n.qc.Oo(e))},function(){return n.persistence.Pi().Oo(t,e)},function(){return n.persistence.kc(t,e)}])},Dc),fc=(kc.prototype.Ar=function(t){this.zc=t},kc.prototype.dr=function(t){this.Hc=t},kc.prototype.onMessage=function(t){this.Yc=t},kc.prototype.close=function(){this.Kc()},kc.prototype.send=function(t){this.Gc(t)},kc.prototype.Jc=function(){this.zc()},kc.prototype.Xc=function(t){this.Hc(t)},kc.prototype.Zc=function(t){this.Yc(t)},kc),pc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},dc=(Rc.prototype.Nr=function(e,t,n,r){var i=this.sa(e,t);Sr("RestConnection","Sending: ",i,n);t={};return this.ia(t,r),this.ra(e,i,t,n).then(function(t){return Sr("RestConnection","Received: ",t),t},function(t){throw _r("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Rc.prototype.Fr=function(t,e,n,r){return this.Nr(t,e,n,r)},Rc.prototype.ia=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.1.0-202010180421",t["Content-Type"]="text/plain",e)for(var n in e.m)e.m.hasOwnProperty(n)&&(t[n]=e.m[n])},Rc.prototype.sa=function(t,e){t=pc[t];return this.na+"/v1/"+e+":"+t},n(Oc,tc=Rc),Oc.prototype.ra=function(o,e,s,u){return new Promise(function(n,r){var i=new wr;i.listenOnce(gr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case yr.NO_ERROR:var t=i.getResponseJson();Sr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case yr.TIMEOUT:Sr("Connection",'RPC "'+o+'" timed out'),r(new xr(Mr.DEADLINE_EXCEEDED,"Request time out"));break;case yr.HTTP_ERROR:var e=i.getStatus();Sr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Mr).indexOf(e)?e:Mr.UNKNOWN,r(new xr(e,t.message))):r(new xr(Mr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new xr(Mr.UNAVAILABLE,"Connection failed."));break;default:Vr()}}finally{Sr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},Oc.prototype.Ir=function(t,e){var n,r=[this.na,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new lr,t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.ia(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||(0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");Sr("Connection","Creating WebChannel: "+r,t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new fc({Gc:function(t){u?Sr("Connection","Not sending because WebChannel is closed:",t):(s||(Sr("Connection","Opening WebChannel transport."),o.open(),s=!0),Sr("Connection","WebChannel sending:",t),o.send(t))},Kc:function(){return o.close()}}),t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(mr.EventType.OPEN,function(){u||Sr("Connection","WebChannel transport opened.")}),t(mr.EventType.CLOSE,function(){u||(u=!0,Sr("Connection","WebChannel transport closed"),a.Xc())}),t(mr.EventType.ERROR,function(t){u||(u=!0,_r("Connection","WebChannel transport errored:",t),a.Xc(new xr(Mr.UNAVAILABLE,"The operation could not be completed")))}),t(mr.EventType.MESSAGE,function(t){var e,n,r,i;u||(Cr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Sr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Ii[r];if(void 0!==t)return Ri(t)}(),i=n.message,void 0===t&&(t=Mr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.Xc(new xr(t,i)),o.close()):(Sr("Connection","WebChannel received:",e),a.Zc(e)))}),setTimeout(function(){a.Jc()},0),a},Oc),vc=(Nc.prototype.Xr=function(t){this.ha.push(t)},Nc.prototype.Zo=function(){window.removeEventListener("online",this.oa),window.removeEventListener("offline",this.ca)},Nc.prototype.la=function(){window.addEventListener("online",this.oa),window.addEventListener("offline",this.ca)},Nc.prototype.ua=function(){Sr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.ha;t<e.length;t++)(0,e[t])(0)},Nc.prototype.aa=function(){Sr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.ha;t<e.length;t++)(0,e[t])(1)},Nc._a=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Nc),yc=(Ac.prototype.Xr=function(t){},Ac.prototype.Zo=function(){},Ac),gc=(Ic.prototype.initialize=function(e){return v(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.serializer=aa(e.ta.t),this.Ru=this.fa(e),this.persistence=this.da(e),[4,this.persistence.start()];case 1:return t.sent(),this.wa=this.Ea(e),this.jr=this.ma(e),[2]}})})},Ic.prototype.Ea=function(t){return null},Ic.prototype.ma=function(t){return e=this.persistence,n=new rc,r=t.Ta,t=this.serializer,new Da(e,n,r,t);var e,n,r},Ic.prototype.da=function(t){return new hc(lc.Qc,this.serializer)},Ic.prototype.fa=function(t){return new Rh},Ic.prototype.terminate=function(){return v(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.wa&&this.wa.stop(),[4,this.Ru.Zo()];case 1:return t.sent(),[4,this.persistence.Zo()];case 2:return t.sent(),[2]}})})},Ic),mc=(Tc.prototype.initialize=function(n,r){return v(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:return this.jr?[3,2]:(this.jr=n.jr,this.Ru=n.Ru,this.Wr=this.Aa(r),this.Au=this.Ia(r),this.Iu=this.Ra(r),this.Pa=this.ya(r,!n.synchronizeTabs),this.Ru.Or=function(t){return Wh(e.Pa,t,1)},this.Au.Gr.Va=Zh.bind(null,this.Pa),[4,function(n,r){return v(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=n,r?(e.Hr.delete(2),[4,th(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Hr.add(2),[4,eh(e)]);case 3:t.sent(),e.Zr.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.Au,this.Pa.Fu)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Tc.prototype.Ra=function(t){return new mh},Tc.prototype.Aa=function(t){var e=aa(t.ta.t),n=(n=t.ta,new dc(n));return t=t.credentials,new Xa(t,n,e)},Tc.prototype.Ia=function(t){var e=this,n=this.jr,r=this.Wr,i=t.Ns,o=function(t){return Wh(e.Pa,t,0)},t=new(vc._a()?vc:yc);return new Fa(n,r,i,o,t)},Tc.prototype.ya=function(t,e){return function(t,e,n,r,i,o,s){o=new Lh(t,e,n,r,i,o);return s&&(o.xu=!0),o}(this.jr,this.Au,this.Iu,this.Ru,t.Ta,t.Pu,e)},Tc.prototype.terminate=function(){return function(n){return v(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=n,Sr("RemoteStore","RemoteStore shutting down."),e.Hr.add(5),[4,eh(e)];case 1:return t.sent(),e.Jr.Zo(),e.Zr.set("Unknown"),[2]}})})}(this.Au)},Tc),wc=(Ec.prototype.next=function(t){this.observer.next&&this.pa(this.observer.next,t)},Ec.prototype.error=function(t){this.observer.error?this.pa(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Ec.prototype.ga=function(){this.muted=!0},Ec.prototype.pa=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Ec),bc=function(t){this.va=t};function Ec(t){this.observer=t,this.muted=!1}function Tc(){}function Ic(){this.synchronizeTabs=!1}function Ac(){}function Nc(){var t=this;this.oa=function(){return t.ua()},this.ca=function(){return t.aa()},this.ha=[],this.la()}function Oc(t){var e=this;return(e=tc.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.i=t.i,e}function Rc(t){this.ta=t,this.t=t.t;var e=t.ssl?"https":"http";this.na=e+"://"+t.host,this.ea="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}function kc(t){this.Gc=t.Gc,this.Kc=t.Kc}function Dc(t){this.persistence=t,this.qc=new Ah,this.Bc=null}function Sc(t){var e=this;return(e=ec.call(this)||this).Bi=t,e}function Pc(){this.Mc=[]}function _c(t,e){var n=this;this.bc={},this.Cc=new fa(0),this.Sc=!1,this.Sc=!0,this.Wi=t(this),this.Ri=new uc(this),this.We=new Oa,this.Qe=(t=this.We,new oc(t,function(t){return n.Wi.Dc(t)})),this.serializer=new Na(e),this.pi=new ac(this.serializer)}function Lc(t){this.serializer=t,this.Rc=new Map,this.Pc=new Map}function Vc(t){this.persistence=t,this.lc=new ea(gi,mi),this.lastRemoteSnapshotVersion=ni.min(),this.highestTargetId=0,this._c=0,this.fc=new Ah,this.targetCount=0,this.dc=ka._i()}function Cc(t){var e=this;return(e=nc.call(this)||this).hc=t,e}function Uc(){this.Uu=new ea(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.rc=!1}function jc(t,e){this.We=t,this.nc=e,this.docs=new ki(si.k),this.size=0}function Mc(t,e){this.We=t,this.Wi=e,this.je=[],this.Gu=1,this.Ku=new Ci(Nh.yo)}function xc(){}function qc(t,e,n){if(!n)throw new xr(Mr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Fc(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new xr(Mr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Gc(t,e,n,r){if(!0===e&&!0===r)throw new xr(Mr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Bc(t){if(!si.ot(t))throw new xr(Mr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Wc(t){if(si.ot(t))throw new xr(Mr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function zc(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Vr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Hc(t,e){if(t instanceof bc&&(t=t.va),t instanceof e)return t;if(e.name===t.constructor.name)throw new xr(Mr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");t=zc(t);throw new xr(Mr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function Xc(t,e){if(e<=0)throw new xr(Mr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Yc,Kc=function(t){this.ba=t},$c=(n(Qc,Yc=Kc),Qc.prototype.Ca=function(t){if(2!==t.Sa)throw 1===t.Sa?t.Da(this.ba+"() can only appear at the top level of your update data"):t.Da(this.ba+"() cannot be used with set() unless you pass {merge:true}");return t.ee.push(t.path),null},Qc.prototype.isEqual=function(t){return t instanceof Qc},Qc);function Qc(){return null!==Yc&&Yc.apply(this,arguments)||this}function Jc(t,e,n){return new zf({Sa:3,Na:e.settings.Na,methodName:t.ba,xa:n},e.t,e.serializer,e.ignoreUndefinedProperties)}var Zc,tl,el,nl,rl=(n(wl,nl=Kc),wl.prototype.Ca=function(t){return new Es(t.path,new us)},wl.prototype.isEqual=function(t){return t instanceof wl},wl),il=(n(ml,el=Kc),ml.prototype.Ca=function(t){var e=Jc(this,t,!0),n=this.Fa.map(function(t){return Zf(t,e)}),n=new as(n);return new Es(t.path,n)},ml.prototype.isEqual=function(t){return this===t},ml),ol=(n(gl,tl=Kc),gl.prototype.Ca=function(t){var e=Jc(this,t,!0),n=this.Fa.map(function(t){return Zf(t,e)}),n=new ps(n);return new Es(t.path,n)},gl.prototype.isEqual=function(t){return this===t},gl),sl=(n(yl,Zc=Kc),yl.prototype.Ca=function(t){var e=new gs(t.serializer,jo(t.serializer,this.Oa));return new Es(t.path,e)},yl.prototype.isEqual=function(t){return this===t},yl),ul=(Object.defineProperty(vl.prototype,"latitude",{get:function(){return this.$a},enumerable:!1,configurable:!0}),Object.defineProperty(vl.prototype,"longitude",{get:function(){return this.La},enumerable:!1,configurable:!0}),vl.prototype.isEqual=function(t){return this.$a===t.$a&&this.La===t.La},vl.prototype.toJSON=function(){return{latitude:this.$a,longitude:this.La}},vl.prototype.D=function(t){return Qr(this.$a,t.$a)||Qr(this.La,t.La)},vl),al=(dl.fromBase64String=function(t){try{return new dl(bi.fromBase64String(t))}catch(t){throw new xr(Mr.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},dl.fromUint8Array=function(t){return new dl(bi.fromUint8Array(t))},dl.prototype.toBase64=function(){return this.ka.toBase64()},dl.prototype.toUint8Array=function(){return this.ka.toUint8Array()},dl.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},dl.prototype.isEqual=function(t){return this.ka.isEqual(t.ka)},dl),hl=new Map,cl=(pl.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},pl),ll=(Object.defineProperty(fl.prototype,"app",{get:function(){if(!this.ja)throw new xr(Mr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.ja},enumerable:!1,configurable:!0}),Object.defineProperty(fl.prototype,"Wa",{get:function(){return this.qa},enumerable:!1,configurable:!0}),Object.defineProperty(fl.prototype,"Ga",{get:function(){return void 0!==this.Ka},enumerable:!1,configurable:!0}),fl.prototype.za=function(t){if(this.qa)throw new xr(Mr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.Ua=new cl(t),void 0!==t.credentials&&(this.Qa=function(t){if(!t)return new qr;switch(t.type){case"gapi":var e=t.client;return Cr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Br(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new xr(Mr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},fl.prototype.Ha=function(){return this.Ua},fl.prototype.Ya=function(){return this.qa=!0,this.Ua},fl.prototype._delete=function(){return this.Ka||(this.Ka=this.Ja()),this.Ka},fl.prototype.Ja=function(){return t=this,(e=hl.get(t))&&(Sr("ComponentProvider","Removing Datastore"),hl.delete(t),e.terminate()),Promise.resolve();var t,e},fl);function fl(t,e){this.Ma="(lite)",this.Ua=new cl({}),this.qa=!1,t instanceof Ir?(this.Ba=t,this.Qa=new qr):(this.ja=t,this.Ba=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new xr(Mr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ir(t.options.projectId)}(t),this.Qa=new Fr(e))}function pl(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new xr(Mr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new xr(Mr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Gc("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function dl(t){this.ka=t}function vl(t,e){if(!isFinite(t)||t<-90||90<t)throw new xr(Mr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new xr(Mr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.$a=t,this.La=e}function yl(t,e){var n=this;return(n=Zc.call(this,t)||this).Oa=e,n}function gl(t,e){var n=this;return(n=tl.call(this,t)||this).Fa=e,n}function ml(t,e){var n=this;return(n=el.call(this,t)||this).Fa=e,n}function wl(){return null!==nl&&nl.apply(this,arguments)||this}function bl(){if("undefined"==typeof Uint8Array)throw new xr(Mr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function El(){if("undefined"==typeof atob)throw new xr(Mr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Tl,Il,Al,Nl=(n(Ll,Al=al),Ll.fromBase64String=function(t){El();try{return new Ll(bi.fromBase64String(t))}catch(t){throw new xr(Mr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Ll.fromUint8Array=function(t){return bl(),new Ll(bi.fromUint8Array(t))},Ll.prototype.toBase64=function(){return El(),Al.prototype.toBase64.call(this)},Ll.prototype.toUint8Array=function(){return bl(),Al.prototype.toUint8Array.call(this)},Ll.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Ll),Ie=(_l.prototype.Xa=function(t,e){switch(void 0===e&&(e="none"),go(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ao(t.integerValue||t.doubleValue);case 3:return this.Za(t.timestampValue);case 4:return this.th(t,e);case 5:return t.stringValue;case 6:return this.nh(No(t.bytesValue));case 7:return this.eh(t.referenceValue);case 8:return this.sh(t.geoPointValue);case 9:return this.ih(t.arrayValue,e);case 10:return this.rh(t.mapValue,e);default:throw Vr()}},_l.prototype.rh=function(t,n){var r=this,i={};return lo(t.fields||{},function(t,e){i[t]=r.Xa(e,n)}),i},_l.prototype.sh=function(t){return new ul(Ao(t.latitude),Ao(t.longitude))},_l.prototype.ih=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.Xa(t,e)})},_l.prototype.th=function(t,e){switch(e){case"previous":var n=function t(e){e=e.mapValue.fields.__previous_value__;return po(e)?t(e):e}(t);return null==n?null:this.Xa(n,e);case"estimate":return this.Za(vo(t));default:return null}},_l.prototype.Za=function(t){t=Io(t);return new ei(t.seconds,t.nanos)},_l.prototype.oh=function(t,e){var n=ri.J(t);Cr(rs(n));t=new Ir(n.get(1),n.get(3)),n=new si(n.U(5));return t.isEqual(e)||Pr("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},_l),Ol=(n(Pl,Il=Ie),Pl.prototype.nh=function(t){return new Nl(t)},Pl.prototype.eh=function(t){t=this.oh(t,this.firestore.Ba);return Bp.uh(t,this.firestore,null)},Pl),Rl=(Object.defineProperty(Sl.prototype,"id",{get:function(){return this.lh.path.j()},enumerable:!1,configurable:!0}),Object.defineProperty(Sl.prototype,"ref",{get:function(){return new nf(this.ah,this.fh,this.lh)},enumerable:!1,configurable:!0}),Sl.prototype.exists=function(){return null!==this._h},Sl.prototype.data=function(){if(this._h){if(this.fh){var t=new kl(this.ah,this.hh,this.lh,this._h,null);return this.fh.fromFirestore(t)}return this.hh.Xa(this._h.Ee())}},Sl.prototype.get=function(t){if(this._h){t=this._h.data().field(Vl("DocumentSnapshot.get",t));if(null!==t)return this.hh.Xa(t)}},Sl),kl=(n(Dl,Tl=Rl),Dl.prototype.data=function(){return Tl.prototype.data.call(this)},Dl);function Dl(){return null!==Tl&&Tl.apply(this,arguments)||this}function Sl(t,e,n,r,i){this.ah=t,this.hh=e,this.lh=n,this._h=r,this.fh=i}function Pl(t){var e=this;return(e=Il.call(this)||this).firestore=t,e}function _l(){}function Ll(){return null!==Al&&Al.apply(this,arguments)||this}function Vl(t,e){return"string"==typeof e?op(t,e):(e instanceof bc?e.va:e).dh}var Cl,Ul=(xl.prototype.isEqual=function(t){return this.dh.isEqual(t.dh)},xl),jl=(n(Ml,Cl=ll),Ml.prototype.Ja=function(){return this.Eh||jp(this),this.Eh.terminate()},Ml);function Ml(t,e){var n=this;return(n=Cl.call(this,t,e)||this).wh=new Ea,n.Ma="name"in t?t.name:"[DEFAULT]",n}function xl(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new xr(Mr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.dh=new oi(t)}var ql,Fl,Gl=(n(Xl,Fl=Rl),Xl.prototype.exists=function(){return Fl.prototype.exists.call(this)},Xl.prototype.data=function(t){if(void 0===t&&(t={}),this._h){if(this.fh){var e=new Bl(this.ah,this.hh,this.lh,this._h,this.metadata,null);return this.fh.fromFirestore(e,t)}return this.hh.Xa(this._h.Ee(),t.serverTimestamps)}},Xl.prototype.get=function(t,e){if(void 0===e&&(e={}),this._h){t=this._h.data().field(Vl("DocumentSnapshot.get",t));if(null!==t)return this.hh.Xa(t,e.serverTimestamps)}},Xl),Bl=(n(Hl,ql=Gl),Hl.prototype.data=function(t){return void 0===t&&(t={}),ql.prototype.data.call(this,t)},Hl),Wl=(Object.defineProperty(zl.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(zl.prototype,"size",{get:function(){return this.Th.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(zl.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),zl.prototype.forEach=function(e,n){var r=this;this.Th.docs.forEach(function(t){e.call(n,new Bl(r.ah,r.hh,t.key,t,new nd(r.Th.nn.has(t.key),r.Th.fromCache),r.query.fh))})},zl.prototype.docChanges=function(t){void 0===t&&(t={});t=!!t.includeMetadataChanges;if(t&&this.Th.sn)throw new xr(Mr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Ah&&this.Ih===t||(this.Ah=function(i,e){if(i.Th.tn.W()){var n=0;return i.Th.docChanges.map(function(t){var e=new Bl(i.ah,i.hh,t.doc.key,t.doc,new nd(i.Th.nn.has(t.doc.key),i.Th.fromCache),i.query.fh);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.Th.tn;return i.Th.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new Bl(i.ah,i.hh,t.doc.key,t.doc,new nd(i.Th.nn.has(t.doc.key),i.Th.fromCache),i.query.fh),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Vr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.Ih=t),this.Ah},zl);function zl(t,e,n,r){this.ah=t,this.hh=e,this.Th=r,this.metadata=new nd(r.hasPendingWrites,r.fromCache),this.query=n}function Hl(){return null!==ql&&ql.apply(this,arguments)||this}function Xl(t,e,n,r,i,o){var s=this;return(s=Fl.call(this,t,e,n,r,o)||this).ah=t,s.mh=t,s.metadata=i,s}function Yl(t,e){return t instanceof Gl&&e instanceof Gl?t.ah===e.ah&&t.lh.isEqual(e.lh)&&(null===t._h?null===e._h:t._h.isEqual(e._h))&&t.fh===e.fh:t instanceof Wl&&e instanceof Wl&&t.ah===e.ah&&jf(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.Th.isEqual(e.Th)}var Kl,$l=(n(Ql,Kl=Ie),Ql.prototype.nh=function(t){return new al(t)},Ql.prototype.eh=function(t){t=this.oh(t,this.firestore.Ba);return new nf(this.firestore,null,t)},Ql);function Ql(t){var e=this;return(e=Kl.call(this)||this).firestore=t,e}function Jl(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Hc(t.firestore,jl),s=Mf(o);return e instanceof bc&&(e=e.va),tf(o,("string"==typeof e||e instanceof Ul?Qf(s,"updateDoc",t.lh,e,n,r):$f(s,"updateDoc",t.lh,e)).Ph(t.lh,Ns.exists(!0)))}function Zl(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i={includeMetadataChanges:!1},o=0;"object"!=typeof n[o]||ha(n[o])||(i=n[o],o++);var s,u,a,h,c,l={includeMetadataChanges:i.includeMetadataChanges};ha(n[o])&&(a=n[o],n[o]=null===(i=a.next)||void 0===i?void 0:i.bind(a),n[o+1]=null===(i=a.error)||void 0===i?void 0:i.bind(a),n[o+2]=null===(i=a.complete)||void 0===i?void 0:i.bind(a)),e instanceof nf?(s=Hc(e.firestore,jl),u=hu(e.lh.path),c={next:function(t){n[o]&&n[o](ef(s,e,t))},error:n[o+1],complete:n[o+2]}):(s=Hc(e.firestore,jl),u=e.Rh,h=new $l(s),c={next:function(t){n[o]&&n[o](new Wl(s,h,e,t))},error:n[o+1],complete:n[o+2]},Rf(e.Rh));var f=Up(s),p=new wc(c),d=new Ih(u,p,l);return s.wh.Ms(function(){return v(t,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=bh,[4,bp(f)];case 1:return[2,e.apply(void 0,[t.sent(),d])]}})})}),function(){p.ga(),s.wh.Ms(function(){return v(t,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=Eh,[4,bp(f)];case 1:return[2,e.apply(void 0,[t.sent(),d])]}})})})}}function tf(t,e){return function(n,r){var t=this,i=new ra;return n.Ns.Ms(function(){return v(t,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=Gh,[4,wp(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(Up(t),e)}function ef(t,e,n){var r=n.docs.get(e.lh),i=new $l(t);return new Gl(t,i,e.lh,r,new nd(n.hasPendingWrites,n.fromCache),e.fh)}var nf=(Object.defineProperty(sf.prototype,"yh",{get:function(){return this.lh.path},enumerable:!1,configurable:!0}),Object.defineProperty(sf.prototype,"id",{get:function(){return this.lh.path.j()},enumerable:!1,configurable:!0}),Object.defineProperty(sf.prototype,"path",{get:function(){return this.lh.path.Y()},enumerable:!1,configurable:!0}),Object.defineProperty(sf.prototype,"parent",{get:function(){return new Df(this.firestore,this.fh,this.lh.path.q())},enumerable:!1,configurable:!0}),sf.prototype.withConverter=function(t){return new sf(this.firestore,t,this.lh)},sf),rf=(of.prototype.withConverter=function(t){return new of(this.firestore,t,this.Rh)},of),l=function(){};function of(t,e,n){this.fh=e,this.Rh=n,this.type="query",this.firestore=t}function sf(t,e,n){this.fh=e,this.lh=n,this.type="document",this.firestore=t}function uf(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){t=i[r].Vh(t)}return t}var af,hf,cf,lf,ff,pf=(n(Tf,ff=l),Tf.prototype.Vh=function(t){var e=Mf(t.firestore),e=function(t,e,n,r,i,o){if(r.tt()){if("array-contains"===i||"array-contains-any"===i)throw new xr(Mr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){Nf(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var h=a[u];s.push(Af(n,t,h))}c={arrayValue:{values:s}}}else c=Af(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Nf(o,i),c=Jf(e,"where",o,"in"===i||"not-in"===i);var c=Au.create(r,i,c);return function(t,e){if(e.Ie()){var n=pu(t);if(null!==n&&!n.isEqual(e.field))throw new xr(Mr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=fu(t);null!==n&&Of(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new xr(Mr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new xr(Mr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,c),c}(t.Rh,e,t.firestore.Ba,this.ph,this.gh,this.bh);return new rf(t.firestore,t.fh,(t=t.Rh,e=t.filters.concat([e]),new ou(t.path,t.collectionGroup,t.me.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},Tf),df=(n(Ef,lf=l),Ef.prototype.Vh=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new xr(Mr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new xr(Mr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Ju(e,n);return e=r,null!==fu(n=t)||null!==(t=pu(n))&&Of(0,t,e.field),r}(t.Rh,this.ph,this.Ch);return new rf(t.firestore,t.fh,(t=t.Rh,e=t.me.concat([e]),new ou(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},Ef),vf=(n(bf,cf=l),bf.prototype.Vh=function(t){return new rf(t.firestore,t.fh,gu(t.Rh,this.Sh,this.Dh))},bf),yf=(n(wf,hf=l),wf.prototype.Vh=function(t){var e=If(t,this.type,this.Nh,this.xh);return new rf(t.firestore,t.fh,(t=t.Rh,e=e,new ou(t.path,t.collectionGroup,t.me.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},wf),gf=(n(mf,af=l),mf.prototype.Vh=function(t){var e=If(t,this.type,this.Nh,this.xh);return new rf(t.firestore,t.fh,(t=t.Rh,e=e,new ou(t.path,t.collectionGroup,t.me.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},mf);function mf(t,e,n){var r=this;return(r=af.call(this)||this).type=t,r.Nh=e,r.xh=n,r}function wf(t,e,n){var r=this;return(r=hf.call(this)||this).type=t,r.Nh=e,r.xh=n,r}function bf(t,e,n){var r=this;return(r=cf.call(this)||this).type=t,r.Sh=e,r.Dh=n,r}function Ef(t,e){var n=this;return(n=lf.call(this)||this).ph=t,n.Ch=e,n.type="orderBy",n}function Tf(t,e,n){var r=this;return(r=ff.call(this)||this).ph=t,r.gh=e,r.bh=n,r.type="where",r}function If(t,h,e,n){if(e[0]instanceof bc&&(e[0]=e[0].va),e[0]instanceof Rl)return function(t,e,n,r){if(!n)throw new xr(Mr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+h+"().");for(var i=[],o=0,s=vu(t);o<s.length;o++){var u=s[o];if(u.field.tt())i.push(Oo(e,n.key));else{var a=n.field(u.field);if(po(a))throw new xr(Mr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.Y();throw new xr(Mr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Wu(i,r)}(t.Rh,t.firestore.Ba,e[0]._h,n);var r=Mf(t.firestore);return function(t,e,n,r,i,o){var s=t.me;if(i.length>s.length)throw new xr(Mr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var h=i[a];if(s[a].field.tt()){if("string"!=typeof h)throw new xr(Mr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!du(t)&&-1!==h.indexOf("/"))throw new xr(Mr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(ri.J(h));if(!si.ot(c))throw new xr(Mr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");c=new si(c);u.push(Oo(e,c))}else{h=Jf(n,r,h);u.push(h)}}return new Wu(u,o)}(t.Rh,t.firestore.Ba,r,h,e,n)}function Af(t,e,n){if(n instanceof bc&&(n=n.va),"string"==typeof n){if(""===n)throw new xr(Mr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!du(e)&&-1!==n.indexOf("/"))throw new xr(Mr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(ri.J(n));if(!si.ot(e))throw new xr(Mr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Oo(t,new si(e))}if(n instanceof nf)return Oo(t,n.lh);throw new xr(Mr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+zc(n)+".")}function Nf(t,e){if(!Array.isArray(t)||0===t.length)throw new xr(Mr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new xr(Mr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Of(t,e,n){if(!n.isEqual(e))throw new xr(Mr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Rf(t){if(lu(t)&&0===t.me.length)throw new xr(Mr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var kf,Df=(n(Sf,kf=rf),Object.defineProperty(Sf.prototype,"id",{get:function(){return this.Rh.path.j()},enumerable:!1,configurable:!0}),Object.defineProperty(Sf.prototype,"path",{get:function(){return this.Rh.path.Y()},enumerable:!1,configurable:!0}),Object.defineProperty(Sf.prototype,"parent",{get:function(){var t=this.yh.q();return t.W()?null:new nf(this.firestore,null,new si(t))},enumerable:!1,configurable:!0}),Sf.prototype.withConverter=function(t){return new Sf(this.firestore,t,this.yh)},Sf);function Sf(t,e,n){var r=this;return(r=kf.call(this,t,e,hu(n))||this).firestore=t,r.yh=n,r.type="collection",r}function Pf(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(qc("collection","path",e),t instanceof ll){var i=ri.J.apply(ri,s([e],n));return Wc(i),new Df(t,null,i)}if(!(t instanceof nf||t instanceof Df))throw new xr(Mr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");e=ri.J.apply(ri,s([t.path],n)).child(ri.J(e));return Wc(e),new Df(t.firestore,null,e)}function _f(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(1===arguments.length&&(e=Kr.S()),qc("doc","path",e),t instanceof ll){var i=ri.J.apply(ri,s([e],n));return Bc(i),new nf(t,null,new si(i))}if(!(t instanceof nf||t instanceof Df))throw new xr(Mr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");e=t.yh.child(ri.J.apply(ri,s([e],n)));return Bc(e),new nf(t.firestore,t instanceof Df?t.fh:null,new si(e))}var Lf,Vf=(n(Cf,Lf=Ie),Cf.prototype.nh=function(t){return new al(t)},Cf.prototype.eh=function(t){t=this.oh(t,this.firestore.Ba);return new nf(this.firestore,null,t)},Cf);function Cf(t){var e=this;return(e=Lf.call(this)||this).firestore=t,e}function Uf(t,e){return(t instanceof nf||t instanceof Df)&&(e instanceof nf||e instanceof Df)&&t.firestore===e.firestore&&t.path===e.path&&t.fh===e.fh}function jf(t,e){return t instanceof rf&&e instanceof rf&&t.firestore===e.firestore&&mu(t.Rh,e.Rh)&&t.fh===e.fh}function Mf(t){var e=t.Ya(),n=aa(t.Ba);return new Hf(t.Ba,!!e.ignoreUndefinedProperties,n)}var xf=/^__.*__$/,qf=(Bf.prototype.Ph=function(t,e){var n=[];return null!==this.ee?n.push(new Cs(t,this.data,this.ee,e)):n.push(new Vs(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new qs(t,this.fieldTransforms)),n},Bf),Ff=(Gf.prototype.Ph=function(t,e){e=[new Cs(t,this.data,this.ee,e)];return 0<this.fieldTransforms.length&&e.push(new qs(t,this.fieldTransforms)),e},Gf);function Gf(t,e,n){this.data=t,this.ee=e,this.fieldTransforms=n}function Bf(t,e,n){this.data=t,this.ee=e,this.fieldTransforms=n}function Wf(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Vr()}}var zf=(Object.defineProperty(Yf.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Yf.prototype,"Sa",{get:function(){return this.settings.Sa},enumerable:!1,configurable:!0}),Yf.prototype.Oh=function(t){return new Yf(Object.assign(Object.assign({},this.settings),t),this.t,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.ee)},Yf.prototype.$h=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.Oh({path:e,xa:!1});return e.Lh(t),e},Yf.prototype.kh=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.Oh({path:t,xa:!1});return t.Fh(),t},Yf.prototype.Mh=function(t){return this.Oh({path:void 0,xa:!0})},Yf.prototype.Da=function(t){return sp(t,this.settings.methodName,this.settings.Uh||!1,this.path,this.settings.Na)},Yf.prototype.contains=function(e){return void 0!==this.ee.find(function(t){return e.G(t)})||void 0!==this.fieldTransforms.find(function(t){return e.G(t.field)})},Yf.prototype.Fh=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Lh(this.path.get(t))},Yf.prototype.Lh=function(t){if(0===t.length)throw this.Da("Document fields must not be empty");if(Wf(this.Sa)&&xf.test(t))throw this.Da('Document fields cannot begin and end with "__"')},Yf),Hf=(Xf.prototype.qh=function(t,e,n,r){return void 0===r&&(r=!1),new zf({Sa:t,methodName:e,Na:n,path:oi.X(),xa:!1,Uh:r},this.t,this.serializer,this.ignoreUndefinedProperties)},Xf);function Xf(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.serializer=n||aa(t)}function Yf(t,e,n,r,i,o){this.settings=t,this.t=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Fh(),this.fieldTransforms=i||[],this.ee=o||[]}function Kf(t,e,n,r,i,o){void 0===o&&(o={});var s=t.qh(o.merge||o.mergeFields?2:0,e,n,i);np("Data must be an object, but it was:",s,r);var u,a,r=tp(r,s);if(o.merge)u=new Ts(s.ee),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],c=0,l=o.mergeFields;c<l.length;c++){var f=rp(e,l[c],n);if(!s.contains(f))throw new xr(Mr.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");up(h,f)||h.push(f)}u=new Ts(h),a=s.fieldTransforms.filter(function(t){return u.ue(t.field)})}else u=null,a=s.fieldTransforms;return new qf(new Xs(r),u,a)}function $f(t,r,i,e){var o=t.qh(1,r,i);np("Data must be an object, but it was:",o,e);var s=[],u=new Ys;lo(e,function(t,e){var n=op(r,t,i);e instanceof bc&&(e=e.va);t=o.kh(n);e instanceof $c?s.push(n):null!=(t=Zf(e,t))&&(s.push(n),u.set(n,t))});e=new Ts(s);return new Ff(u.he(),e,o.fieldTransforms)}function Qf(t,e,n,r,i,o){var s=t.qh(1,e,n),u=[rp(e,r,n)],a=[i];if(o.length%2!=0)throw new xr(Mr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(rp(e,o[h])),a.push(o[h+1]);for(var c,l,f,p=[],d=new Ys,v=u.length-1;0<=v;--v){up(p,u[v])||(c=u[v],(l=a[v])instanceof bc&&(l=l.va),f=s.kh(c),l instanceof $c?p.push(c):null!=(f=Zf(l,f))&&(p.push(c),d.set(c,f)))}i=new Ts(p);return new Ff(d.he(),i,s.fieldTransforms)}function Jf(t,e,n,r){return void 0===r&&(r=!1),Zf(n,t.qh(r?4:3,e))}function Zf(s,t){if(s instanceof bc&&(s=s.va),ep(s))return np("Unsupported field value:",t,s),tp(s,t);if(s instanceof Kc)return function(t,e){if(!Wf(e.Sa))throw e.Da(t.ba+"() can only be used with update() and set()");if(!e.path)throw e.Da(t.ba+"() is not currently supported inside arrays");t=t.Ca(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.ee.push(t.path),s instanceof Array){if(t.settings.xa&&4!==t.Sa)throw t.Da("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Zf(i[r],t.Mh(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof bc&&(t=t.va),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return jo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ei.fromDate(t);return{timestampValue:Mo(e.serializer,n)}}if(t instanceof ei){var r=new ei(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Mo(e.serializer,r)}}if(t instanceof ul)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof al)return{bytesValue:xo(e.serializer,t.ka)};if(t instanceof nf){n=e.t,r=t.firestore.Ba;if(!r.isEqual(n))throw e.Da("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Fo(t.firestore.Ba||e.t,t.lh.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.Da("Unsupported field value: "+zc(t))}(s,t)}function tp(t,n){var r={};return fo(t)?n.path&&0<n.path.length&&n.ee.push(n.path):lo(t,function(t,e){e=Zf(e,n.$h(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function ep(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ei||t instanceof ul||t instanceof al||t instanceof nf||t instanceof Kc)}function np(t,e,n){if(!ep(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){n=zc(n);throw"an object"===n?e.Da(t+" a custom object"):e.Da(t+" "+n)}var r}function rp(t,e,n){if(e instanceof bc&&(e=e.va),e instanceof Ul)return e.dh;if("string"==typeof e)return op(t,e);throw sp("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var ip=new RegExp("[~\\*/\\[\\]]");function op(e,n,r){if(0<=n.search(ip))throw sp("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(Ul.bind.apply(Ul,s([void 0],n.split("."))))).dh}catch(t){throw sp("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function sp(t,e,n,r,i){var o=r&&!r.W(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new xr(Mr.INVALID_ARGUMENT,(e+=". ")+t+n)}function up(t,e){return t.some(function(t){return t.isEqual(e)})}var ap=(pp.prototype.Gh=function(r){return v(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.Kh(),0<this.mutations.length)throw new xr(Mr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return v(this,void 0,void 0,function(){var n,e,r,i,o;return y(this,function(t){switch(t.label){case 0:return e=Ho((n=s).serializer)+"/documents",r={documents:u.map(function(t){return Bo(n.serializer,t)})},[4,n.Fr("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.serializer,"found"in(t=t)?function(t,e){Cr(!!e.found),e.found.name,e.found.updateTime;var n=Wo(t,e.found.name),t=qo(e.found.updateTime),e=new Xs({mapValue:{fields:e.found.fields}});return new nu(n,t,e,{})}(e,t):"missing"in t?function(t,e){Cr(!!e.missing),Cr(!!e.readTime);t=Wo(t,e.missing),e=qo(e.readTime);return new ru(t,e)}(e,t):Vr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());Cr(!!t),o.push(t)}),o)]}})})}(this.Wr,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof ru||t instanceof nu?n.zh(t):Vr()}),e)]}})})},pp.prototype.set=function(t,e){this.write(e.Ph(t,this.re(t))),this.Wh.add(t.toString())},pp.prototype.update=function(t,e){try{this.write(e.Ph(t,this.Hh(t)))}catch(t){this.jh=t}this.Wh.add(t.toString())},pp.prototype.delete=function(t){this.write([new zs(t,this.re(t))]),this.Wh.add(t.toString())},pp.prototype.commit=function(){return v(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.Kh(),this.jh)throw this.jh;return e=this.Bh,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=si.st(e);n.mutations.push(new Hs(e,n.re(e)))}),[4,function(i,o){return v(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:return n=Ho((e=i).serializer)+"/documents",r={writes:o.map(function(t){return Ko(e.serializer,t)})},[4,e.Nr("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Wr,this.mutations)];case 1:return t.sent(),this.Qh=!0,[2]}})})},pp.prototype.zh=function(t){var e;if(t instanceof nu)e=t.version;else{if(!(t instanceof ru))throw Vr();e=ni.min()}var n=this.Bh.get(t.key.toString());if(n){if(!e.isEqual(n))throw new xr(Mr.ABORTED,"Document version changed between two reads.")}else this.Bh.set(t.key.toString(),e)},pp.prototype.re=function(t){var e=this.Bh.get(t.toString());return!this.Wh.has(t.toString())&&e?Ns.updateTime(e):Ns.ce()},pp.prototype.Hh=function(t){var e=this.Bh.get(t.toString());if(this.Wh.has(t.toString())||!e)return Ns.exists(!0);if(e.isEqual(ni.min()))throw new xr(Mr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ns.updateTime(e)},pp.prototype.write=function(t){this.Kh(),this.mutations=this.mutations.concat(t)},pp.prototype.Kh=function(){},pp),hp=(fp.prototype.run=function(){this.Jh()},fp.prototype.Jh=function(){var t=this;this.Ks.vs(function(){return v(t,void 0,void 0,function(){var e,n,r=this;return y(this,function(t){return e=new ap(this.Wr),(n=this.Xh(e))&&n.then(function(t){r.Ns.Ms(function(){return e.commit().then(function(){r.Os.resolve(t)}).catch(function(t){r.Zh(t)})})}).catch(function(t){r.Zh(t)}),[2]})})})},fp.prototype.Xh=function(t){try{var e=this.updateFunction(t);return!pi(e)&&e.catch&&e.then?e:(this.Os.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Os.reject(t),null}},fp.prototype.Zh=function(t){var e=this;0<this.Yh&&this.tl(t)?(--this.Yh,this.Ns.Ms(function(){return e.Jh(),Promise.resolve()})):this.Os.reject(t)},fp.prototype.tl=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!Oi(t)},fp),cp=(lp.prototype.getConfiguration=function(){return v(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.V.promise];case 1:return[2,(t.sent(),{Ns:this.Ns,ta:this.ta,clientId:this.clientId,credentials:this.credentials,Ta:this.user,Pu:100})]}})})},lp.prototype.el=function(t){var e=this;this.nl=t,this.V.promise.then(function(){return e.nl(e.user)})},lp.prototype.sl=function(){if(this.Ns.Hs)throw new xr(Mr.FAILED_PRECONDITION,"The client has already been terminated.")},lp.prototype.terminate=function(){var t=this;this.Ns.Zs();var n=new ra;return this.Ns.Ys(function(){return v(t,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.il?[4,this.il.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.rl?[4,this.rl.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.R(),n.resolve(),[3,6];case 5:return e=t.sent(),e=Aa(e,"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},lp);function lp(t,e,n){var r=this;this.credentials=t,this.Ns=e,this.ta=n,this.user=Ar.UNAUTHENTICATED,this.clientId=Kr.S(),this.nl=function(){},this.V=new ra,this.credentials.I(function(t){Sr("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.nl(t)),r.V.resolve()})}function fp(t,e,n,r){this.Ns=t,this.Wr=e,this.updateFunction=n,this.Os=r,this.Yh=5,this.Ks=new ya(this.Ns,"transaction_retry")}function pp(t){this.Wr=t,this.Bh=new Map,this.mutations=[],this.Qh=!1,this.jh=null,this.Wh=new Set}function dp(e){return v(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e.rl?[3,2]:(Sr("FirestoreClient","Using default OfflineComponentProvider"),[4,function(r,i){return v(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:return r.Ns.si(),Sr("FirestoreClient","Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return e=t.sent(),[4,i.initialize(e)];case 2:return t.sent(),r.el(function(e){return r.Ns.ti(function(){return v(n,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,Va(i.jr,e)];case 1:return t.sent(),[2]}})})})}),i.persistence.xc(function(){return r.terminate()}),r.rl=i,[2]}})})}(e,new gc)]);case 1:t.sent(),t.label=2;case 2:return[2,e.rl]}})})}function vp(e){return v(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e.il?[3,2]:(Sr("FirestoreClient","Using default OnlineComponentProvider"),[4,function(r,i){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return r.Ns.si(),[4,dp(r)];case 1:return e=t.sent(),Sr("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.el(function(t){return r.Ns.ti(function(){return function(r,i){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return(e=r).Ns.si(),Sr("RemoteStore","RemoteStore received new credentials"),n=ah(e),e.Hr.add(3),[4,eh(e)];case 1:return t.sent(),n&&e.Zr.set("Unknown"),[4,e.Gr.Va(i)];case 2:return t.sent(),e.Hr.delete(3),[4,th(e)];case 3:return t.sent(),[2]}})})}(i.Au,t)})}),r.il=i,[2]}})})}(e,new mc)]);case 1:t.sent(),t.label=2;case 2:return[2,e.il]}})})}function yp(t){return dp(t).then(function(t){return t.persistence})}function gp(t){return dp(t).then(function(t){return t.jr})}function mp(t){return vp(t).then(function(t){return t.Au})}function wp(t){return vp(t).then(function(t){return t.Pa})}function bp(r){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return[4,vp(r)];case 1:return e=t.sent(),[2,((n=e.Iu).ho=Fh.bind(null,e.Pa),n.fo=function(i,o){return v(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:return n=(e=i).Vu.get(o),1<(r=e.pu.get(n.targetId)).length?[2,(e.pu.set(n.targetId,r.filter(function(t){return!mu(t,o)})),void e.Vu.delete(o))]:e.Fu?(e.Ru.Go(n.targetId),e.Ru.Yo(n.targetId)?[3,2]:[4,Ma(e.jr,n.targetId,!1).then(function(){e.Ru.zo(n.targetId),rh(e.Au,n.targetId),Yh(e,n.targetId)}).catch(qa)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Yh(e,n.targetId),[4,Ma(e.jr,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.Pa),n)]}})})}function Ep(n,r,i,o,s){var t=new wc({next:function(t){r.Ms(function(){return Eh(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new xr(Mr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new xr(Mr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Ih(hu(i.path),t,{includeMetadataChanges:!0,Ro:!0});return bh(n,u)}function Tp(e,n,t,r,i){var o=new wc({next:function(t){n.Ms(function(){return Eh(e,s)}),t.fromCache&&"server"===r.source?i.reject(new xr(Mr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Ih(t,o,{includeMetadataChanges:!0,Ro:!0});return bh(e,s)}var Ip=(Ap.prototype.set=function(t,e,n){this.hl();t=Np(t,this.ah),e=gd(t.fh,e,n),n=Kf(this.al,"WriteBatch.set",t.lh,e,null!==t.fh,n);return this.ul=this.ul.concat(n.Ph(t.lh,Ns.ce())),this},Ap.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.hl();t=Np(t,this.ah);return e instanceof bc&&(e=e.va),e="string"==typeof e||e instanceof Ul?Qf(this.al,"WriteBatch.update",t.lh,e,n,r):$f(this.al,"WriteBatch.update",t.lh,e),this.ul=this.ul.concat(e.Ph(t.lh,Ns.exists(!0))),this},Ap.prototype.delete=function(t){this.hl();t=Np(t,this.ah);return this.ul=this.ul.concat(new zs(t.lh,Ns.ce())),this},Ap.prototype.commit=function(){return this.hl(),this.cl=!0,0<this.ul.length?this.ol(this.ul):Promise.resolve()},Ap.prototype.hl=function(){if(this.cl)throw new xr(Mr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Ap);function Ap(t,e){this.ah=t,this.ol=e,this.ul=[],this.cl=!1,this.al=Mf(t)}function Np(t,e){if(t instanceof bc&&(t=t.va),t.firestore!==e)throw new xr(Mr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var Op,Rp,kp=(Cp.prototype.get=function(t){var e=this,n=Np(t,this.ah),r=new Vf(this.ah);return this.ll.Gh([n.lh]).then(function(t){if(!t||1!==t.length)return Vr();t=t[0];if(t instanceof ru)return new Rl(e.ah,r,n.lh,null,n.fh);if(t instanceof nu)return new Rl(e.ah,r,t.key,t,n.fh);throw Vr()})},Cp.prototype.set=function(t,e,n){t=Np(t,this.ah),e=gd(t.fh,e,n),n=Kf(this.al,"Transaction.set",t.lh,e,null!==t.fh,n);return this.ll.set(t.lh,n),this},Cp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Np(t,this.ah);return e instanceof bc&&(e=e.va),e="string"==typeof e||e instanceof Ul?Qf(this.al,"Transaction.update",t.lh,e,n,r):$f(this.al,"Transaction.update",t.lh,e),this.ll.update(t.lh,e),this},Cp.prototype.delete=function(t){t=Np(t,this.ah);return this.ll.delete(t.lh),this},n(Vp,Rp=Cp),Vp.prototype.get=function(t){var e=this,n=Np(t,this.ah),r=new $l(this.ah);return Rp.prototype.get.call(this,t).then(function(t){return new Gl(e.ah,r,n.lh,t._h,new nd(!1,!1),n.fh)})},Vp),Dp="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Sp=(Lp.prototype.enableIndexedDbPersistence=function(t,e){throw new xr(Mr.FAILED_PRECONDITION,Dp)},Lp.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new xr(Mr.FAILED_PRECONDITION,Dp)},Lp.prototype.clearIndexedDbPersistence=function(t){throw new xr(Mr.FAILED_PRECONDITION,Dp)},Lp),Pp=(n(_p,Op=bc),Object.defineProperty(_p.prototype,"Ba",{get:function(){return this.va.Ba},enumerable:!1,configurable:!0}),_p.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.va.Ha()),t)).merge,this.va.za(t)},_p.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.va.Ha().host&&_r("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},_p.prototype.enableNetwork=function(){return function(r){var t=this;return r.Ns.enqueue(function(){return v(t,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return[4,yp(r)];case 1:return e=t.sent(),[4,mp(r)];case 2:return n=t.sent(),[2,(e.Fc(!0),(t=n).Hr.delete(0),th(t))]}})})})}(Up(this.va))},_p.prototype.disableNetwork=function(){return function(r){var t=this;return r.Ns.enqueue(function(){return v(t,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return[4,yp(r)];case 1:return e=t.sent(),[4,mp(r)];case 2:return n=t.sent(),[2,(e.Fc(!1),function(n){return v(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return(e=n).Hr.add(0),[4,eh(e)];case 1:return t.sent(),e.Zr.set("Offline"),[2]}})})}(n))]}})})})}(Up(this.va))},_p.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Gc("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this._l.enableMultiTabIndexedDbPersistence(this):this._l.enableIndexedDbPersistence(this,n)},_p.prototype.clearPersistence=function(){return this._l.clearIndexedDbPersistence(this)},_p.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this.va._delete()},_p.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new ra;return n.Ns.Ms(function(){return v(t,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=zh,[4,wp(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(Up(this.va))},_p.prototype.onSnapshotsInSync=function(t){return function(t,e){var n=this,r=Up(t),e=ha(e)?e:{next:e},i=new wc(e);return t.wh.Ms(function(){return v(n,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=function(t,e){t.ao.add(e),e.next()},[4,bp(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})}),function(){i.ga(),t.wh.Ms(function(){return v(n,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=function(t,e){t.ao.delete(e)},[4,bp(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})})}}(this.va,t)},Object.defineProperty(_p.prototype,"app",{get:function(){if(!this.fl)throw new xr(Mr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.fl},enumerable:!1,configurable:!0}),_p.prototype.collection=function(t){try{return new ad(this,Pf(this.va,t))}catch(t){throw Xp(t,"collection()","Firestore.collection()")}},_p.prototype.doc=function(t){try{return new Bp(this,_f(this.va,t))}catch(t){throw Xp(t,"doc()","Firestore.doc()")}},_p.prototype.collectionGroup=function(t){try{return new od(this,function(t,e){if(qc("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new xr(Mr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new rf(t,null,(e=e,new ou(ri.X(),e)))}(this.va,t))}catch(t){throw Xp(t,"collectionGroup()","Firestore.collectionGroup()")}},_p.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new ra;return n.Ns.Ms(function(){return v(t,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return[4,vp(n).then(function(t){return t.Wr})];case 1:return e=t.sent(),new hp(n.Ns,e,r,i).run(),[2]}})})}),i.promise}(Up(n=this.va),function(t){return t=new kp(n,t),e(new Fp(r,t))})},_p.prototype.batch=function(){var e=this;return Up(this.va),new Gp(new Ip(this.va,function(t){return tf(e.va,t)}))},_p);function _p(t,e,n){var r=this;return(r=Op.call(this,e)||this)._l=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof Ir||(r.fl=t),r}function Lp(){}function Vp(t,e){var n=this;return(n=Rp.call(this,t,e)||this).ah=t,n}function Cp(t,e){this.ah=t,this.ll=e,this.al=Mf(t)}function Up(t){return t.Eh||jp(t),t.Eh.sl(),t.Eh}function jp(t){var e,n,r=t.Ya(),r=(e=t.Ba,n=t.Ma,new Tr(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.Eh=new cp(t.Qa,t.wh,r)}var Mp,xp,qp,Fp=(n(Hp,qp=bc),Hp.prototype.get=function(t){var e=this,t=yd(t);return this.va.get(t).then(function(t){return new rd(e.ah,t)})},Hp.prototype.set=function(t,e,n){t=yd(t);return n?(Fc("Transaction.set",n),this.va.set(t,e,n)):this.va.set(t,e),this},Hp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=yd(t);return 2===arguments.length?this.va.update(o,e):(t=this.va).update.apply(t,s([o,e,n],r)),this},Hp.prototype.delete=function(t){t=yd(t);return this.va.delete(t),this},Hp),Gp=(n(zp,xp=bc),zp.prototype.set=function(t,e,n){t=yd(t);return n?(Fc("WriteBatch.set",n),this.va.set(t,e,n)):this.va.set(t,e),this},zp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=yd(t);return 2===arguments.length?this.va.update(o,e):(t=this.va).update.apply(t,s([o,e,n],r)),this},zp.prototype.delete=function(t){t=yd(t);return this.va.delete(t),this},zp.prototype.commit=function(){return this.va.commit()},zp),Bp=(n(Wp,Mp=bc),Wp.dl=function(t,e,n){if(t.length%2!=0)throw new xr(Mr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.Y()+" has "+t.length);return new Wp(e,new nf(e.va,n,new si(t)))},Wp.uh=function(t,e,n){return new Wp(e,new nf(e.va,n,t))},Object.defineProperty(Wp.prototype,"id",{get:function(){return this.va.id},enumerable:!1,configurable:!0}),Object.defineProperty(Wp.prototype,"parent",{get:function(){return new ad(this.firestore,this.va.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(Wp.prototype,"path",{get:function(){return this.va.path},enumerable:!1,configurable:!0}),Wp.prototype.collection=function(t){try{return new ad(this.firestore,Pf(this.va,t))}catch(t){throw Xp(t,"collection()","DocumentReference.collection()")}},Wp.prototype.isEqual=function(t){return t instanceof bc&&(t=t.va),t instanceof nf&&Uf(this.va,t)},Wp.prototype.set=function(t,e){e=Fc("DocumentReference.set",e);try{return n=this.va,r=t,i=e,o=Hc(n.firestore,jl),r=gd(n.fh,r,i),tf(o,Kf(Mf(o),"setDoc",n.lh,r,null!==n.fh,i).Ph(n.lh,Ns.ce()))}catch(t){throw Xp(t,"setDoc()","DocumentReference.set()")}var n,r,i,o},Wp.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Jl(this.va,t):Jl.apply(void 0,s([this.va,t,e],n))}catch(t){throw Xp(t,"updateDoc()","DocumentReference.update()")}},Wp.prototype.delete=function(){return tf(Hc((t=this.va).firestore,jl),[new zs(t.lh,Ns.ce())]);var t},Wp.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Yp(t),i=Kp(t,function(t){return new rd(e.firestore,new Gl(e.firestore.va,e.hh,t.lh,t._h,t.metadata,e.va.fh))});return Zl(this.va,r,i)},Wp.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){var t=this,n=Hc(e.firestore,jl),r=Up(n),i=new $l(n),o=new ra;return n.wh.Ms(function(){return v(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,gp(r)];case 1:return[4,function(i,o,s){return v(this,void 0,void 0,function(){var r;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.yi.Ge(t,e)}))];case 1:return(r=t.sent())instanceof nu?s.resolve(r):r instanceof ru?s.resolve(null):s.reject(new xr(Mr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),r=Aa(r,"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(t.sent(),e.lh,o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new Gl(n,i,e.lh,t,new nd(t instanceof nu&&t.ae,!0),e.fh)})}:"server"===(null==t?void 0:t.source)?function(e){var t=this,n=Hc(e.firestore,jl),r=Up(n),i=new ra;return n.wh.Ms(function(){return v(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,bp(r)];case 1:return[4,Ep(t.sent(),n.wh,e.lh,{source:"server"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return ef(n,e,t)})}:function(e){var t=this,n=Hc(e.firestore,jl),r=Up(n),i=new ra;return n.wh.Ms(function(){return v(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,bp(r)];case 1:return[4,Ep(t.sent(),n.wh,e.lh,{source:"default"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return ef(n,e,t)})})(this.va).then(function(t){return new rd(e.firestore,new Gl(e.firestore.va,e.hh,t.lh,t._h,t.metadata,e.va.fh))})},Wp.prototype.withConverter=function(t){return new Wp(this.firestore,this.va.withConverter(t))},Wp);function Wp(t,e){var n=this;return(n=Mp.call(this,e)||this).firestore=t,n.hh=new Ol(t),n}function zp(){return null!==xp&&xp.apply(this,arguments)||this}function Hp(t,e){var n=this;return(n=qp.call(this,e)||this).ah=t,n}function Xp(t,e,n){return t.message=t.message.replace(e,n),t}function Yp(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!ha(r))return r}return{}}function Kp(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=ha(t[0])?t[0]:ha(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var $p,Qp,Jp,Zp,td,ed,nd=(vd.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},vd),rd=(n(dd,ed=bc),Object.defineProperty(dd.prototype,"ref",{get:function(){return new Bp(this.ah,this.va.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"id",{get:function(){return this.va.id},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"metadata",{get:function(){return this.va.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"exists",{get:function(){return this.va.exists()},enumerable:!1,configurable:!0}),dd.prototype.data=function(t){return this.va.data(t)},dd.prototype.get=function(t,e){return this.va.get(t,e)},dd.prototype.isEqual=function(t){return Yl(this.va,t.va)},dd),id=(n(pd,td=rd),pd.prototype.data=function(t){return this.va.data(t)},pd),od=(n(fd,Zp=bc),fd.prototype.where=function(t,e,n){try{return new fd(this.firestore,uf(this.va,(r=n,i=e,o=Vl("where",t),new pf(o,i,r))))}catch(t){throw Xp(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},fd.prototype.orderBy=function(n,t){try{return new fd(this.firestore,uf(this.va,function(t){void 0===t&&(t="asc");var e=t,t=Vl("orderBy",n);return new df(t,e)}(t)))}catch(n){throw Xp(n,/(orderBy|where)\(\)/,"Query.$1()")}},fd.prototype.limit=function(t){try{return new fd(this.firestore,uf(this.va,(Xc("limit",e=t),new vf("limit",e,"F"))))}catch(t){throw Xp(t,"limit()","Query.limit()")}var e},fd.prototype.limitToLast=function(t){try{return new fd(this.firestore,uf(this.va,(Xc("limitToLast",e=t),new vf("limitToLast",e,"L"))))}catch(t){throw Xp(t,"limitToLast()","Query.limitToLast()")}var e},fd.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new fd(this.firestore,uf(this.va,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new yf("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw Xp(t,"startAt()","Query.startAt()")}},fd.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new fd(this.firestore,uf(this.va,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new yf("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw Xp(t,"startAfter()","Query.startAfter()")}},fd.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new fd(this.firestore,uf(this.va,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new gf("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw Xp(t,"endBefore()","Query.endBefore()")}},fd.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new fd(this.firestore,uf(this.va,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new gf("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw Xp(t,"endAt()","Query.endAt()")}},fd.prototype.isEqual=function(t){return jf(this.va,t.va)},fd.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){var t=this,n=Hc(e.firestore,jl),r=Up(n),i=new $l(n),o=new ra;return n.wh.Ms(function(){return v(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,gp(r)];case 1:return[4,function(r,i,o){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,xa(r,i,!0)];case 1:return n=t.sent(),e=new Sh(i,n.Ji),n=e.uu(n.documents),n=e.lu(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),n=Aa(n,"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(t.sent(),e.Rh,o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new Wl(n,i,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){var t=this,n=Hc(e.firestore,jl),r=Up(n),i=new $l(n),o=new ra;return n.wh.Ms(function(){return v(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,bp(r)];case 1:return[4,Tp(t.sent(),n.wh,e.Rh,{source:"server"},o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new Wl(n,i,e,t)})}:function(e){var t=this,n=Hc(e.firestore,jl),r=Up(n),i=new $l(n);Rf(e.Rh);var o=new ra;return n.wh.Ms(function(){return v(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,bp(r)];case 1:return[4,Tp(t.sent(),n.wh,e.Rh,{source:"default"},o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new Wl(n,i,e,t)})})(this.va).then(function(t){return new ud(e.firestore,t)})},fd.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Yp(t),i=Kp(t,function(t){return new ud(e.firestore,t)});return Zl(this.va,r,i)},fd.prototype.withConverter=function(t){return new fd(this.firestore,this.va.withConverter(t))},fd),sd=(n(ld,Jp=bc),Object.defineProperty(ld.prototype,"type",{get:function(){return this.va.type},enumerable:!1,configurable:!0}),Object.defineProperty(ld.prototype,"doc",{get:function(){return new id(this.ah,this.va.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(ld.prototype,"oldIndex",{get:function(){return this.va.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(ld.prototype,"newIndex",{get:function(){return this.va.newIndex},enumerable:!1,configurable:!0}),ld),ud=(n(cd,Qp=bc),Object.defineProperty(cd.prototype,"query",{get:function(){return new od(this.ah,this.va.query)},enumerable:!1,configurable:!0}),Object.defineProperty(cd.prototype,"metadata",{get:function(){return this.va.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(cd.prototype,"size",{get:function(){return this.va.size},enumerable:!1,configurable:!0}),Object.defineProperty(cd.prototype,"empty",{get:function(){return this.va.empty},enumerable:!1,configurable:!0}),Object.defineProperty(cd.prototype,"docs",{get:function(){var e=this;return this.va.docs.map(function(t){return new id(e.ah,t)})},enumerable:!1,configurable:!0}),cd.prototype.docChanges=function(t){var e=this;return this.va.docChanges(t).map(function(t){return new sd(e.ah,t)})},cd.prototype.forEach=function(e,n){var r=this;this.va.forEach(function(t){e.call(n,new id(r.ah,t))})},cd.prototype.isEqual=function(t){return Yl(this.va,t.va)},cd),ad=(n(hd,$p=od),Object.defineProperty(hd.prototype,"id",{get:function(){return this.va.id},enumerable:!1,configurable:!0}),Object.defineProperty(hd.prototype,"path",{get:function(){return this.va.path},enumerable:!1,configurable:!0}),Object.defineProperty(hd.prototype,"parent",{get:function(){var t=this.va.parent;return t?new Bp(this.firestore,t):null},enumerable:!1,configurable:!0}),hd.prototype.doc=function(t){try{return new Bp(this.firestore,void 0===t?_f(this.va):_f(this.va,t))}catch(t){throw Xp(t,"doc()","CollectionReference.doc()")}},hd.prototype.add=function(t){var e,n,r,i=this;return e=this.va,n=t,t=Hc(e.firestore,jl),r=_f(e),n=gd(e.fh,n),tf(t,Kf(Mf(e.firestore),"addDoc",r.lh,n,null!==e.fh,{}).Ph(r.lh,Ns.exists(!1))).then(function(){return r}).then(function(t){return new Bp(i.firestore,t)})},hd.prototype.isEqual=function(t){return Uf(this.va,t.va)},hd.prototype.withConverter=function(t){return new hd(this.firestore,this.va.withConverter(t))},hd);function hd(t,e){var n=this;return(n=$p.call(this,t,e)||this).firestore=t,n.va=e,n}function cd(t,e){var n=this;return(n=Qp.call(this,e)||this).ah=t,n}function ld(t,e){var n=this;return(n=Jp.call(this,e)||this).ah=t,n}function fd(t,e){var n=this;return(n=Zp.call(this,e)||this).firestore=t,n}function pd(){return null!==td&&td.apply(this,arguments)||this}function dd(t,e){var n=this;return(n=ed.call(this,e)||this).ah=t,n}function vd(t,e){this.hasPendingWrites=t,this.fromCache=e}function yd(t){return t instanceof bc&&(t=t.va),Hc(t,nf)}function gd(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var md,wd,bd,l=(n(Id,wd=bc),Id.documentId=function(){return new Id(oi.nt().Y())},Id.prototype.isEqual=function(t){return t instanceof bc&&(t=t.va),t instanceof Ul&&this.va.dh.isEqual(t.dh)},Id),Ie=(n(Td,md=bc),Td.serverTimestamp=function(){var t=new rl("serverTimestamp");return t.ba="FieldValue.serverTimestamp",new Td(t)},Td.delete=function(){var t=new $c("deleteField");return t.ba="FieldValue.delete",new Td(t)},Td.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new il("arrayUnion",t)}.apply(void 0,t);return n.ba="FieldValue.arrayUnion",new Td(n)},Td.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ol("arrayRemove",t)}.apply(void 0,t);return n.ba="FieldValue.arrayRemove",new Td(n)},Td.increment=function(t){t=new sl("increment",t);return t.ba="FieldValue.increment",new Td(t)},Td.prototype.isEqual=function(t){return this.va.isEqual(t.va)},Td),Ed={Firestore:Pp,GeoPoint:ul,Timestamp:ei,Blob:Nl,Transaction:Fp,WriteBatch:Gp,DocumentReference:Bp,DocumentSnapshot:rd,Query:od,QueryDocumentSnapshot:id,QuerySnapshot:ud,CollectionReference:ad,FieldPath:l,FieldValue:Ie,setLogLevel:function(t){kr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};function Td(){return null!==md&&md.apply(this,arguments)||this}function Id(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return wd.call(this,new(Ul.bind.apply(Ul,s([void 0],t))))||this}(bd=e.default).INTERNAL.registerComponent(new br("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new Pp(e,new jl(e,t),new Sp);var e},"PUBLIC").setServiceProps(Object.assign({},Ed))),bd.registerVersion("@firebase/firestore","2.0.3-202010180421")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map
