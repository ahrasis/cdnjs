!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(oy){"use strict";try{(function(){var l,t,e=(t=oy)&&"object"==typeof t&&"default"in t?t:{default:t},r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(be=l=l||{})[be.DEBUG=0]="DEBUG",be[be.VERBOSE=1]="VERBOSE",be[be.INFO=2]="INFO",be[be.WARN=3]="WARN",be[be.ERROR=4]="ERROR",be[be.SILENT=5]="SILENT";var u={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},a=l.INFO,c=((Ee={})[l.DEBUG]="log",Ee[l.VERBOSE]="log",Ee[l.INFO]="info",Ee[l.WARN]="warn",Ee[l.ERROR]="error",Ee),h=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?u[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.DEBUG],t)),this._logHandler.apply(this,s([this,l.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.VERBOSE],t)),this._logHandler.apply(this,s([this,l.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.INFO],t)),this._logHandler.apply(this,s([this,l.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.WARN],t)),this._logHandler.apply(this,s([this,l.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.ERROR],t)),this._logHandler.apply(this,s([this,l.ERROR],t))},f);function f(t){this.name=t,this._logLevel=a,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e){return(e=d.call(this,e)||this).code=t,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,t=(t=this.errors[t])?(r=i,t.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").",s=new m(o,t),u=0,a=Object.keys(i);u<a.length;u++){var c=a[u];"_"!==c.slice(-1)&&(c in s&&console.warn('Overwriting FirebaseError base field "'+c+'" can cause unexpected behavior.'),s[c]=i[c])}return s},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function _(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S=N||self;function D(){}function L(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function x(t){var e=L(t);return"array"==e||"object"==e&&"number"==typeof t.length}function k(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var O="closure_uid_"+(1e9*Math.random()>>>0),R=0;function P(t,e,n){return t.call.apply(t.bind,arguments)}function C(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function U(t,e,n){return(U=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?P:C).apply(null,arguments)}function V(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var M=Date.now;function F(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function j(){this.j=this.j,this.i=this.i}j.prototype.j=!1,j.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,O)&&this[O]||(this[O]=++R))},j.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var q=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function B(){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function H(t){return/^[\s\xa0]*$/.test(t)}var K,W=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Q(t,e){return-1!=t.indexOf(e)}function X(t,e){return t<e?-1:e<t?1:0}var Y=S.navigator;function J(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function $(t){var e,n={};for(e in t)n[e]=t[e];return n}K=(Y=Y&&Y.userAgent)?Y:"";var Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<Z.length;i++)e=Z[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function et(t){return et[" "](t),t}et[" "]=D;var nt,rt=Q(K,"Opera"),it=Q(K,"Trident")||Q(K,"MSIE"),ot=Q(K,"Edge"),st=ot||it,ut=Q(K,"Gecko")&&!(Q(K.toLowerCase(),"webkit")&&!Q(K,"Edge"))&&!(Q(K,"Trident")||Q(K,"MSIE"))&&!Q(K,"Edge"),at=Q(K.toLowerCase(),"webkit")&&!Q(K,"Edge");function ct(){var t=S.document;return t?t.documentMode:void 0}var ht="",ft=(ft=K,ut?/rv:([^\);]+)(\)|;)/.exec(ft):ot?/Edge\/([\d\.]+)/.exec(ft):it?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ft):at?/WebKit\/(\S+)/.exec(ft):rt?/(?:Version)[ \/]?(\S+)/.exec(ft):void 0);ft&&(ht=ft?ft[1]:""),nt=it&&null!=(ft=ct())&&ft>parseFloat(ht)?String(ft):ht;var lt={};function pt(u){return t=u,e=function(){for(var t=0,e=W(String(nt)).split("."),n=W(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=X(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||X(0==o[2].length,0==s[2].length)||X(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=lt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var dt=S.document&&it&&(ct()||parseInt(nt,10))||void 0,yt=!it||9<=Number(dt),vt=it&&!pt("9"),gt=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",D,e),S.removeEventListener("test",D,e)}catch(t){}return t}();function mt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function wt(t,e){if(mt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ut){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:bt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}mt.prototype.b=function(){this.defaultPrevented=!0},F(wt,mt);var bt={2:"touch",3:"pen",4:"mouse"};wt.prototype.b=function(){wt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,vt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Et="closure_listenable_"+(1e6*Math.random()|0),It=0;function Tt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++It,this.Y=this.Z=!1}function _t(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function At(t){this.src=t,this.a={},this.b=0}function Nt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=q(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(_t(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function St(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}At.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=St(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Tt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Dt="closure_lm_"+(1e6*Math.random()|0),Lt={};function xt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Mt(r),e&&e[Et]?e.wa(n,r,k(i)?!!i.capture:!!i,o):kt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)xt(t,e[o],n,r,i);return null}return n=Mt(n),t&&t[Et]?t.va(e,n,k(r)?!!r.capture:!!r,i):kt(t,e,n,!1,r,i)}function kt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=k(i)?!!i.capture:!!i;if(s&&!yt)return null;var u,a,c=Ut(t);if(c||(t[Dt]=c=new At(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Ct,r=a=yt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)gt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Rt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ot(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Et]?Nt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Rt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ut(e))?(Nt(n,t),0==n.b&&(n.src=null,e[Dt]=null)):_t(t)))}function Rt(t){return t in Lt?Lt[t]:Lt[t]="on"+t}function Pt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Ot(t),n.call(r,e)}function Ct(t,e){if(t.Y)return!0;if(yt)return Pt(t,new wt(e,this));if(!e)t:{e=["window","event"];for(var n=S,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Pt(t,e=new wt(e,this))}function Ut(t){return(t=t[Dt])instanceof At?t:null}var Vt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Mt(e){return"function"==L(e)?e:(e[Vt]||(e[Vt]=function(t){return e.handleEvent(t)}),e[Vt])}function Ft(){j.call(this),this.c=new At(this),(this.J=this).C=null}function jt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Nt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}F(Ft,j),Ft.prototype[Et]=!0,(A=Ft.prototype).addEventListener=function(t,e,n,r){xt(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=k(i)?!!i.capture:!!i,r=Mt(r),e&&e[Et]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=St(s=e.a[n],r,i,o))&&(_t(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Ut(e))&&(n=e.a[n.toString()],e=-1,n&&(e=St(n,r,i,o)),(r=-1<e?n[e]:null)&&Ot(r))}(this,t,e,n,r)},A.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new mt(t,n):t instanceof mt?t.target=t.target||n:(s=t,tt(t=new mt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=jt(o,r,!0,t)&&s;if(s=jt(o=t.a=n,r,!0,t)&&s,s=jt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=jt(o=t.a=e[i],r,!1,t)&&s;return s},A.G=function(){if(Ft.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)_t(n[r]);delete e.a[t],e.b--}}this.C=null},A.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},A.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var qt=S.JSON.stringify;function Gt(){this.b=this.a=null}var Bt,zt=(Ht.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Ht(function(){return new Kt},function(t){t.reset()},100));function Ht(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Kt(){this.next=this.b=this.a=null}function Wt(t,e){var n;Bt||(n=S.Promise.resolve(void 0),Bt=function(){n.then(Yt)}),Qt||(Bt(),Qt=!0),Xt.add(t,e)}Gt.prototype.add=function(t,e){var n=zt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Kt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Qt=!(Kt.prototype.reset=function(){this.next=this.b=this.a=null}),Xt=new Gt;function Yt(){for(var t,e;n=e=void 0,n=null,(e=Xt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){S.setTimeout(function(){throw t},0)}(t)}var n=zt;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Qt=!1}function Jt(t,e){Ft.call(this),this.b=t||1,this.a=e||S,this.f=U(this.Ya,this),this.g=M()}function $t(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Zt(t,e,n){if("function"==L(t))n&&(t=U(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=U(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}F(Jt,Ft),(A=Jt.prototype).aa=!1,A.M=null,A.Ya=function(){var t;this.aa&&(0<(t=M()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&($t(this),this.start())))},A.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=M())},A.G=function(){Jt.S.G.call(this),$t(this),delete this.a};var te,ee,ne,re=(T(ee=oe,ne=te=j),ee.prototype=null===ne?Object.create(ne):(ie.prototype=ne.prototype,new ie),oe.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=Zt(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},oe.prototype.G=function(){te.prototype.G.call(this),this.a&&(S.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},oe);function ie(){this.constructor=ee}function oe(t,e,n){var r=te.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function se(t){j.call(this),this.b=t,this.a={}}F(se,j);var ue=[];function ae(t,e,n,r){Array.isArray(n)||(n&&(ue[0]=n.toString()),n=ue);for(var i=0;i<n.length;i++){var o=xt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ce(t){J(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ot(t)},t),t.a={}}function he(){this.a=!0}function fe(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return qt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}se.prototype.G=function(){se.S.G.call(this),ce(this)},se.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},he.prototype.info=function(){};var le=null;function pe(){return le=le||new Ft}function de(t){mt.call(this,"serverreachability",t)}function ye(){var t=pe();t.dispatchEvent(new de(t))}function ve(t){mt.call(this,"statevent",t)}function ge(){var t=pe();t.dispatchEvent(new ve(t))}function me(t){mt.call(this,"timingevent",t)}function we(t,e){if("function"!=L(t))throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}F(de,mt),F(ve,mt),F(me,mt);var be={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ee={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Ie(){}function Te(t){var e;return(e=t.a)||(e=t.a={}),e}function _e(){}Ie.prototype.a=null;var Ae,N={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Ne(){mt.call(this,"d")}function Se(){mt.call(this,"c")}function De(){}function Le(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new se(this),this.P=xe,t=st?125:void 0,this.R=new Jt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}F(Ne,mt),F(Se,mt),F(De,Ie),Ae=new De;var xe=45e3,ke={},Oe={};function Re(t,e,n){t.H=1,t.i=tn(Qe(e)),t.j=n,t.I=!0,Pe(t,null)}function Pe(t,e){t.u=M(),Ue(t),t.l=Qe(t.i);var s,u,a,c,h,f,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),dn(n.b,"t",r),t.D=0,t.a=ur(t.g,t.g.C?e:null),0<t.O&&(t.F=new re(U(t.Ca,t,t.a),t.O)),ae(t.J,t.a,"readystatechange",t.Wa),e=t.B?$(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ye(),s=t.c,u=t.m,a=t.l,c=t.f,h=t.T,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Ce(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Oe:(i=Number(u.substring(i,o)),isNaN(i)?ke:(o+=1)+i>u.length?Oe:(u=u.substr(o,i),r.D=o+i,u)));if(u==Oe){4==e&&(t.h=4,ge(),s=!1),fe(t.c,t.f,null,"[Incomplete Response]");break}if(u==ke){t.h=4,ge(),fe(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}fe(t.c,t.f,u,null),qe(t,u)}4==e&&0==n.length&&(t.h=1,ge(),s=!1),t.b=t.b&&s,s?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Zn(e),e.F=!0)):(fe(t.c,t.f,n,"[Invalid Chunked Response]"),je(t),Fe(t))}function Ue(t){t.U=M()+t.P,Ve(t,t.P)}function Ve(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=we(U(t.Ua,t),e)}function Me(t){t.o&&(S.clearTimeout(t.o),t.o=null)}function Fe(t){0==t.g.v||t.A||nr(t.g,t)}function je(t){Me(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,$t(t.R),ce(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function qe(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||En(u.b,t)))if(u.I=t.N,!t.C&&En(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;er(u),zn(u)}$n(u),ge()}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=we(U(u.Ra,u),6e3));if(bn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else ir(u,11)}else if(!t.C&&u.a!=t||er(u),!H(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(Q(r,"spdy")||Q(r,"quic")||Q(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(In(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,Ze(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.V&&(u.N=M()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=sr(n,n.C?n.ga:null,n.fa),i.C?(Tn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Me(o),Ue(o)),n.a=i):Jn(n),0<u.g.length&&Wn(u)):"stop"!=c[0]&&"close"!=c[0]||ir(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?ir(u,7):Bn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0);ye()}catch(t){}}function Ge(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(x(t)||"string"==typeof t)G(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(x(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(x(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Be(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Be)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function ze(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];He(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)He(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function He(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=Le.prototype).setTimeout=function(t){this.P=t},A.Wa=function(t){t=t.target;var e=this.F;e&&3==Fn(t)?e.f():this.Ca(t)},A.Ca=function(t){try{if(t==this.a)t:{var e=Fn(this.a),n=this.a.ua(),r=this.a.X();if(!(e<3||3==e&&!st&&!this.a.$())){this.A||4!=e||7==n||ye(),Me(this);var i=this.a.X();if(this.N=i,n=this.a.$(),this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.T,f=e,l=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+f+" "+l}),this.b){if(this.V&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,ge(),je(this),Fe(this);break t}fe(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,qe(this,s)}this.I?(Ce(this,e,n),st&&this.b&&3==e&&(ae(this.J,this.R,"tick",this.Va),this.R.start())):(fe(this.c,this.f,n,null),qe(this,n)),4==e&&je(this),this.b&&!this.A&&(4==e?nr(this.g,this):(this.b=!1,Ue(this)))}else 400==i&&0<n.indexOf("Unknown SID")?this.h=3:this.h=0,ge(),je(this),Fe(this)}}}catch(t){}var u,a,c,h,f,l},A.Va=function(){var t,e;this.a&&(t=Fn(this.a),e=this.a.$(),this.D<e.length&&(Me(this),Ce(this,t,e),this.b&&4!=t&&Ue(this)))},A.cancel=function(){this.A=!0,je(this)},A.Ua=function(){this.o=null;var t,e,n=M();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ye(),ge()),je(this),this.h=2,Fe(this)):Ve(this,this.U-n)},(A=Be.prototype).K=function(){ze(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.L=function(){return ze(this),this.a.concat()},A.get=function(t,e){return He(this.b,t)?this.b[t]:e},A.set=function(t,e){He(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ke=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function We(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof We?(this.a=void 0!==e?e:t.a,Xe(this,t.f),this.j=t.j,Ye(this,t.c),Je(this,t.h),this.g=t.g,e=t.b,(n=new hn).c=e.c,e.a&&(n.a=new Be(e.a),n.b=e.b),$e(this,n),this.i=t.i):t&&(n=String(t).match(Ke))?(this.a=!!e,Xe(this,n[1]||"",!0),this.j=en(n[2]||""),Ye(this,n[3]||"",!0),Je(this,n[4]),this.g=en(n[5]||"",!0),$e(this,n[6]||"",!0),this.i=en(n[7]||"")):(this.a=!!e,this.b=new hn(null,this.a))}function Qe(t){return new We(t)}function Xe(t,e,n){t.f=n?en(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ye(t,e,n){t.c=n?en(e,!0):e}function Je(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function $e(t,e,n){var r,i;e instanceof hn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(fn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(ln(this,e),dn(this,n,t))},r)),r.f=i):(n||(e=nn(e,an)),t.b=new hn(e,t.a))}function Ze(t,e,n){t.b.set(e,n)}function tn(t){return Ze(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^M()).toString(36)),t}function en(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function nn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,rn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function rn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}We.prototype.toString=function(){var t=[],e=this.f;e&&t.push(nn(e,on,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(nn(e,on,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(nn(n,"/"==n.charAt(0)?un:sn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",nn(n,cn)),t.join("")};var on=/[#\/\?@]/g,sn=/[#\?:]/g,un=/[#\?]/g,an=/[#\?@]/g,cn=/#/g;function hn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function fn(u){u.a||(u.a=new Be,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],o=n,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function ln(t,e){fn(t),e=yn(t,e),He(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,He((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&ze(t)))}function pn(t,e){return fn(t),e=yn(t,e),He(t.a.b,e)}function dn(t,e,n){ln(t,e),0<n.length&&(t.c=null,t.a.set(yn(t,e),z(n)),t.b+=n.length)}function yn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function vn(t,e){this.b=t,this.a=e}function gn(t){this.g=t||mn,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ia&&S.ia.ya&&S.ia.ya()&&S.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(A=hn.prototype).add=function(t,e){fn(this),this.c=null,t=yn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,r){fn(this),this.a.forEach(function(t,e){G(t,function(t){n.call(r,t,e,this)},this)},this)},A.L=function(){fn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},A.K=function(t){fn(this);var e=[];if("string"==typeof t)pn(this,t)&&(e=B(e,this.a.get(yn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=B(e,t[n])}return e},A.set=function(t,e){return fn(this),this.c=null,pn(this,t=yn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var mn=10;function wn(t){return t.b||t.a&&t.a.size>=t.f}function bn(t){return t.b?1:t.a?t.a.size:0}function En(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function In(t,e){t.a?t.a.add(e):t.b=e}function Tn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function _n(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return z(t.c);var r=t.c;try{for(var i=_(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function An(){}function Nn(){this.a=new An}function Sn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}gn.prototype.cancel=function(){var t,e;if(this.c=_n(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=_(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},An.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},An.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var Dn=S.JSON.parse;function Ln(t){Ft.call(this),this.headers=new Be,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=xn,this.D=this.F=!1}F(Ln,Ft);var xn="",kn=/^https?$/i,On=["POST","PUT"];function Rn(t){return"content-type"==t.toLowerCase()}function Pn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Cn(t),Vn(t)}function Cn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Un(t){if(t.b&&(!t.s[1]||4!=Fn(t)||2!=t.X()))if(t.l&&4==Fn(t))Zt(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==Fn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Ke)[1]||null)&&S.self&&S.self.location&&(i=(r=S.self.location.protocol).substr(0,r.length-1)),n=!kn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Fn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",Cn(t)}}finally{Vn(t)}}}function Vn(t,e){if(t.a){Mn(t);var n=t.a,r=t.s[0]?D:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Mn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function Fn(t){return t.a?t.a.readyState:0}function jn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",J(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Ze(t,e,n))}function qn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Gn(t){this.pa=0,this.g=[],this.c=new he,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=qn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=qn("baseRetryDelayMs",5e3,t),this.Ma=qn("retryDelaySeedMs",1e4,t),this.Ja=qn("forwardChannelMaxRetries",2,t),this.ma=qn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new gn(t&&t.concurrentRequestLimit),this.ka=new Nn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Bn(t){var e,n;Hn(t),3==t.v&&(e=t.R++,Ze(n=Qe(t.B),"SID",t.J),Ze(n,"RID",e),Ze(n,"TYPE","terminate"),Xn(t,n),(e=new Le(t,t.c,e,void 0)).H=2,e.i=tn(Qe(n)),n=!1,S.navigator&&S.navigator.sendBeacon&&(n=S.navigator.sendBeacon(e.i.toString(),"")),!n&&S.Image&&((new Image).src=e.i,n=!0),n||(e.a=ur(e.g,null),e.a.ba(e.i)),e.u=M(),Ue(e)),or(t)}function zn(t){t.a&&(Zn(t),t.a.cancel(),t.a=null)}function Hn(t){zn(t),t.j&&(S.clearTimeout(t.j),t.j=null),er(t),t.b.cancel(),t.h&&("number"==typeof t.h&&S.clearTimeout(t.h),t.h=null)}function Kn(t,e){t.g.push(new vn(t.La++,e)),3==t.v&&Wn(t)}function Wn(t){wn(t.b)||t.h||(t.h=!0,Wt(t.Ba,t),t.u=0)}function Qn(t,e){var n=e?e.f:t.R++,r=Qe(t.B);Ze(r,"SID",t.J),Ze(r,"RID",n),Ze(r,"AID",t.P),Xn(t,r),t.i&&t.l&&jn(r,t.i,t.l),n=new Le(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Yn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),In(t.b,n),Re(n,r,e)}function Xn(t,n){t.f&&Ge({},function(t,e){Ze(n,e,t)})}function Yn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?U(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+c+"_"||"";try{Ge(t,function(t,e){var n=t;k(t)&&(n=qt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s)}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Jn(t){t.a||t.j||(t.U=1,Wt(t.Aa,t),t.o=0)}function $n(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=we(U(t.Aa,t),rr(t,t.o)),t.o++,1)}function Zn(t){null!=t.s&&(S.clearTimeout(t.s),t.s=null)}function tr(t){t.a=new Le(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Qe(t.la);Ze(e,"RID","rpc"),Ze(e,"SID",t.J),Ze(e,"CI",t.H?"0":"1"),Ze(e,"AID",t.P),Xn(t,e),Ze(e,"TYPE","xmlhttp"),t.i&&t.l&&jn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=tn(Qe(e)),n.j=null,n.I=!0,Pe(n,t)}function er(t){null!=t.m&&(S.clearTimeout(t.m),t.m=null)}function nr(t,e){var n,r=null;if(t.a==e){er(t),Zn(t),t.a=null;var i=2}else{if(!En(t.b,e))return;r=e.s,Tn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b)1==i?(r=e.j?e.j.length:0,e=M()-e.u,n=t.u,(i=pe()).dispatchEvent(new me(i)),Wn(t)):Jn(t);else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(bn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=we(U(t.Ba,t,e),rr(t,t.u)),t.u++,1}}(t,e)||2==i&&$n(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:ir(t,5);break;case 4:ir(t,10);break;case 3:ir(t,6);break;default:ir(t,2)}}function rr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function ir(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=U(t.Xa,t),r||(r=new We("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||Xe(r,"https"),tn(r)),n=r.toString(),r=o,o=new he,S.Image?((i=new Image).onload=V(Sn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=V(Sn,o,i,"TestLoadImage: error",!1,r),i.onabort=V(Sn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=V(Sn,o,i,"TestLoadImage: timeout",!1,r),S.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):ge(),t.v=0,t.f&&t.f.ra(e),or(t),Hn(t)}function or(t){t.v=0,t.I=-1,t.f&&(0==_n(t.b).length&&0==t.g.length||(t.b.c.length=0,z(t.g),t.g.length=0),t.f.qa())}function sr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof We?Qe(s):new We(s,void 0);return""!=a.c?(e&&Ye(a,e+"."+a.c),Je(a,a.h)):(r=(u=S.location).protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new We(null,void 0),r&&Xe(u,r),i&&Ye(u,i),o&&Je(u,o),s&&(u.g=s),a=u),t.W&&J(t.W,function(t,e){Ze(a,e,t)}),e=t.A,n=t.na,e&&n&&Ze(a,e,n),Ze(a,"VER",t.ha),Xn(t,a),a}function ur(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Ln(t.Ka)).F=t.C,e}function ar(){}function cr(){if(it&&!(10<=Number(dt)))throw Error("Environmental error: no available transport.")}function hr(t,e){Ft.call(this),this.a=new Gn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!H(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!H(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new pr(this)}function fr(t){Ne.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function lr(){Se.call(this),this.status=1}function pr(t){this.a=t}(A=Ln.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Te(this.H):Te(Ae),this.a.onreadystatechange=U(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Pn(this,t)}t=n||"";var i,o=new Be(this.headers);r&&Ge(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Rn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=S.FormData&&t instanceof S.FormData,0<=q(On,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Mn(this),0<this.o&&((this.D=(i=this.a,it&&pt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=U(this.xa,this)):this.m=Zt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Pn(this,t)}},A.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Vn(this))},A.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Vn(this,!0)),Ln.S.G.call(this)},A.za=function(){this.j||(this.A||this.l||this.g?Un(this):this.Ta())},A.Ta=function(){Un(this)},A.X=function(){try{return 2<Fn(this)?this.a.status:-1}catch(t){return-1}},A.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},A.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Dn(e)}},A.ua=function(){return this.h},A.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=Gn.prototype).ha=8,A.v=1,A.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Le(this,this.c,t,void 0),r=this.l;if(this.O&&(r?tt(r=$(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Yn(this,n,e),Ze(i=Qe(this.B),"RID",t),Ze(i,"CVER",22),this.A&&Ze(i,"X-HTTP-Session-Id",this.A),Xn(this,i),this.i&&r&&jn(i,this.i,r),In(this.b,n),this.Ga&&Ze(i,"TYPE","init"),this.da?(Ze(i,"$req",e),Ze(i,"SID","null"),n.V=!0,Re(n,i,null)):Re(n,i,e),this.v=2}}else 3==this.v&&(t?Qn(this,t):0==this.g.length||wn(this.b)||Qn(this))},A.Aa=function(){var t;this.j=null,tr(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=we(U(this.Sa,this),t))},A.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,zn(this),tr(this))},A.Ra=function(){null!=this.m&&(this.m=null,zn(this),$n(this),ge())},A.Xa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),ge()},(A=ar.prototype).ta=function(){},A.sa=function(){},A.ra=function(){},A.qa=function(){},A.Ha=function(){},cr.prototype.a=function(t,e){return new hr(t,e)},F(hr,Ft),(A=hr.prototype).addEventListener=function(t,e,n,r){hr.S.addEventListener.call(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){hr.S.removeEventListener.call(this,t,e,n,r)},A.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;ge(),t.fa=e,t.W=n||{},t.H=t.T,t.B=sr(t,null,t.fa),Wn(t)},A.close=function(){Bn(this.a)},A.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Kn(this.a,e)):this.g?((e={}).__data__=qt(t),Kn(this.a,e)):Kn(this.a,t)},A.G=function(){this.a.f=null,delete this.f,Bn(this.a),delete this.a,hr.S.G.call(this)},F(fr,Ne),F(lr,Se),F(pr,ar),pr.prototype.ta=function(){this.a.dispatchEvent("a")},pr.prototype.sa=function(t){this.a.dispatchEvent(new fr(t))},pr.prototype.ra=function(t){this.a.dispatchEvent(new lr)},pr.prototype.qa=function(){this.a.dispatchEvent("b")},cr.prototype.createWebChannel=cr.prototype.a,hr.prototype.send=hr.prototype.Pa,hr.prototype.open=hr.prototype.Oa,be.NO_ERROR=0,be.TIMEOUT=8,be.HTTP_ERROR=6,Ee.COMPLETE="complete",(_e.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",Ft.prototype.listen=Ft.prototype.va,Ln.prototype.listenOnce=Ln.prototype.wa,Ln.prototype.getLastError=Ln.prototype.Qa,Ln.prototype.getLastErrorCode=Ln.prototype.ua,Ln.prototype.getStatus=Ln.prototype.X,Ln.prototype.getResponseJson=Ln.prototype.Na,Ln.prototype.getResponseText=Ln.prototype.$,Ln.prototype.send=Ln.prototype.ba;var dr=be,yr=Ee,vr=_e,gr=Ln,mr=(wr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},wr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},wr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},wr);function wr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var br,Er={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ir=(n(_r,br=Error),_r),Tr=new h("@firebase/firestore");function _r(t,e){var n=this;return(n=br.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Ar(){return Tr.logLevel}function Nr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Tr.logLevel<=l.DEBUG&&(e=n.map(Lr),Tr.debug.apply(Tr,i(["Firestore (7.24.0): "+t],e)))}function Sr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Tr.logLevel<=l.ERROR&&(e=n.map(Lr),Tr.error.apply(Tr,i(["Firestore (7.24.0): "+t],e)))}function Dr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Tr.logLevel<=l.WARN&&(e=n.map(Lr),Tr.warn.apply(Tr,i(["Firestore (7.24.0): "+t],e)))}function Lr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function xr(t){throw void 0===t&&(t="Unexpected state"),Sr(t="FIRESTORE (7.24.0) INTERNAL ASSERTION FAILED: "+t),new Error(t)}function kr(t){t||xr()}function Or(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Rr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Pr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Cr,Ur,be=(Object.defineProperty(zr.prototype,"length",{get:function(){return this.t},enumerable:!1,configurable:!0}),zr.prototype.isEqual=function(t){return 0===zr.i(this,t)},zr.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof zr?t.forEach(function(t){e.push(t)}):e.push(t),this.o(e)},zr.prototype.limit=function(){return this.offset+this.length},zr.prototype.u=function(t){return t=void 0===t?1:t,this.o(this.segments,this.offset+t,this.length-t)},zr.prototype.h=function(){return this.o(this.segments,this.offset,this.length-1)},zr.prototype.l=function(){return this.segments[this.offset]},zr.prototype._=function(){return this.get(this.length-1)},zr.prototype.get=function(t){return this.segments[this.offset+t]},zr.prototype.m=function(){return 0===this.length},zr.prototype.T=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},zr.prototype.I=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},zr.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},zr.prototype.A=function(){return this.segments.slice(this.offset,this.limit())},zr.i=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},zr),Vr=(n(Br,Ur=be),Br.prototype.o=function(t,e,n){return new Br(t,e,n)},Br.prototype.R=function(){return this.A().join("/")},Br.prototype.toString=function(){return this.R()},Br.g=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Ir(Er.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new Br(n)},Br.P=function(){return new Br([])},Br),Mr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Fr=(n(Gr,Cr=be),Gr.prototype.o=function(t,e,n){return new Gr(t,e,n)},Gr.V=function(t){return Mr.test(t)},Gr.prototype.R=function(){return this.A().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),Gr.V(t)||(t="`"+t+"`"),t}).join(".")},Gr.prototype.toString=function(){return this.R()},Gr.prototype.p=function(){return 1===this.length&&"__name__"===this.get(0)},Gr.v=function(){return new Gr(["__name__"])},Gr.S=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Ir(Er.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Ir(Er.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Ir(Er.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Ir(Er.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Gr(e)},Gr.P=function(){return new Gr([])},Gr),jr=(qr.D=function(t){return new qr(Vr.g(t))},qr.C=function(t){return new qr(Vr.g(t).u(5))},qr.prototype.N=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},qr.prototype.isEqual=function(t){return null!==t&&0===Vr.i(this.path,t.path)},qr.prototype.toString=function(){return this.path.toString()},qr.i=function(t,e){return Vr.i(t.path,e.path)},qr.F=function(t){return t.length%2==0},qr.$=function(t){return new qr(new Vr(t.slice()))},qr);function qr(t){this.path=t}function Gr(){return null!==Cr&&Cr.apply(this,arguments)||this}function Br(){return null!==Ur&&Ur.apply(this,arguments)||this}function zr(t,e,n){void 0===e?e=0:e>t.length&&xr(),void 0===n?n=t.length-e:n>t.length-e&&xr(),this.segments=t,this.offset=e,this.t=n}function Hr(t,e){if(0!==e.length)throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+ci(e.length,"argument")+".")}function Kr(t,e,n){if(e.length!==n)throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires "+ci(n,"argument")+", but was called with "+ci(e.length,"argument")+".")}function Wr(t,e,n){if(e.length<n)throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires at least "+ci(n,"argument")+", but was called with "+ci(e.length,"argument")+".")}function Qr(t,e,n,r){if(e.length<n||e.length>r)throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+ci(e.length,"argument")+".")}function Xr(t,e,n,r){ei(t,e,ai(n)+" argument",r)}function Yr(t,e,n,r){void 0!==r&&Xr(t,e,n,r)}function Jr(t,e,n,r){ei(t,e,n+" option",r)}function $r(t,e,n,r){void 0!==r&&Jr(t,e,n,r)}function Zr(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(ri(s))}var u=ri(n);throw new Ir(Er.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function ti(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Ir(Er.INVALID_ARGUMENT,"Invalid value "+ri(r)+" provided to function "+t+"() for its "+ai(n)+" argument. Acceptable values: "+e.join(", "));return r}function ei(t,e,n,r){if(!("object"===e?ni(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e))throw r=ri(r),new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}function ni(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function ri(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":xr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function ii(t,e,n){if(void 0===n)throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+ai(e)+" argument, but it was undefined.")}function oi(n,t,r){Rr(t,function(t,e){if(r.indexOf(t)<0)throw new Ir(Er.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function si(t,e,n,r){return r=ri(r),new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires its "+ai(n)+" argument to be a "+e+", but it was: "+r)}function ui(t,e,n){if(n<=0)throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires its "+ai(e)+" argument to be a positive number, but it was: "+n+".")}function ai(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function ci(t,e){return t+" "+e+(1===t?"":"s")}var hi=(fi.k=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},fi);function fi(){}function li(t,e){return t<e?-1:e<t?1:0}function pi(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function di(t){return t+"\0"}var yi=(vi.fromBase64String=function(t){return new vi(atob(t))},vi.fromUint8Array=function(t){return new vi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},vi.prototype.toBase64=function(){return t=this.M,btoa(t);var t},vi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.M)},vi.prototype.O=function(){return 2*this.M.length},vi.prototype.L=function(t){return li(this.M,t.M)},vi.prototype.isEqual=function(t){return this.M===t.M},vi);function vi(t){this.M=t}yi.B=new yi("");var gi=(mi.fromBase64String=function(t){try{return new mi(yi.fromBase64String(t))}catch(t){throw new Ir(Er.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},mi.fromUint8Array=function(t){return new mi(yi.fromUint8Array(t))},mi.prototype.toBase64=function(){return this.q.toBase64()},mi.prototype.toUint8Array=function(){return this.q.toUint8Array()},mi.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},mi.prototype.isEqual=function(t){return this.q.isEqual(t.q)},mi);function mi(t){this.q=t}function wi(){if("undefined"==typeof Uint8Array)throw new Ir(Er.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function bi(){if("undefined"==typeof atob)throw new Ir(Er.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function Ei(t,e,n,r,i,o){this.U=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.W=o}var Ii,Ti=(n(Oi,Ii=gi),Oi.fromBase64String=function(t){Kr("Blob.fromBase64String",arguments,1),Xr("Blob.fromBase64String","string",1,t),bi();try{return new Oi(yi.fromBase64String(t))}catch(t){throw new Ir(Er.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Oi.fromUint8Array=function(t){if(Kr("Blob.fromUint8Array",arguments,1),wi(),!(t instanceof Uint8Array))throw si("Blob.fromUint8Array","Uint8Array",1,t);return new Oi(yi.fromUint8Array(t))},Oi.prototype.toBase64=function(){return Kr("Blob.toBase64",arguments,0),bi(),Ii.prototype.toBase64.call(this)},Oi.prototype.toUint8Array=function(){return Kr("Blob.toUint8Array",arguments,0),wi(),Ii.prototype.toUint8Array.call(this)},Oi.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Oi),_i=(Object.defineProperty(ki.prototype,"j",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),ki.prototype.isEqual=function(t){return t instanceof ki&&t.projectId===this.projectId&&t.database===this.database},ki.prototype.L=function(t){return li(this.projectId,t.projectId)||li(this.database,t.database)},ki),Ai=(xi.prototype.get=function(t){var e=this.K(t);if(void 0!==(e=this.H[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.G(i,t))return o}},xi.prototype.has=function(t){return void 0!==this.get(t)},xi.prototype.set=function(t,e){var n=this.K(t),r=this.H[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.G(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.H[n]=[[t,e]]},xi.prototype.delete=function(t){var e=this.K(t),n=this.H[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.G(n[r][0],t))return 1===n.length?delete this.H[e]:n.splice(r,1),!0;return!1},xi.prototype.forEach=function(s){Rr(this.H,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];s(i,o)}})},xi.prototype.m=function(){return Pr(this.H)},xi),Ni=(Li.now=function(){return Li.fromMillis(Date.now())},Li.fromDate=function(t){return Li.fromMillis(t.getTime())},Li.fromMillis=function(t){var e=Math.floor(t/1e3);return new Li(e,1e6*(t-1e3*e))},Li.prototype.toDate=function(){return new Date(this.toMillis())},Li.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Li.prototype.Y=function(t){return this.seconds===t.seconds?li(this.nanoseconds,t.nanoseconds):li(this.seconds,t.seconds)},Li.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Li.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Li.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},Li.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Li),Si=(Di.J=function(t){return new Di(t)},Di.min=function(){return new Di(new Ni(0,0))},Di.prototype.L=function(t){return this.timestamp.Y(t.timestamp)},Di.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Di.prototype.X=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Di.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Di.prototype.Z=function(){return this.timestamp},Di);function Di(t){this.timestamp=t}function Li(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Ir(Er.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Ir(Er.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Ir(Er.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Ir(Er.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function xi(t,e){this.K=t,this.G=e,this.H={}}function ki(t,e){this.projectId=t,this.database=e||"(default)"}function Oi(){return null!==Ii&&Ii.apply(this,arguments)||this}function Ri(t){return null==t}function Pi(t){return 0===t&&1/t==-1/0}function Ci(t){return"number"==typeof t&&Number.isInteger(t)&&!Pi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var Ui=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.tt=null};function Vi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Ui(t,e,n,r,i,o,s)}function Mi(t){var e=t;return null===e.tt&&(t=e.path.R(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.R()+t.op.toString()+Mo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.R()+t.dir}).join(","),Ri(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=ya(e.startAt)),e.endAt&&(t+="|ub:",t+=ya(e.endAt)),e.tt=t),e.tt}function Fi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!Po(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ga(t.startAt,e.startAt)&&ga(t.endAt,e.endAt)}function ji(t){return jr.F(t.path)&&null===t.collectionGroup&&0===t.filters.length}function qi(t){this.count=t}var Gi,Bi=(zi.prototype.st=function(t){return new zi(this.target,this.targetId,this.et,t,this.nt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},zi.prototype.it=function(t,e){return new zi(this.target,this.targetId,this.et,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},zi.prototype.rt=function(t){return new zi(this.target,this.targetId,this.et,this.sequenceNumber,this.nt,t,this.resumeToken)},zi);function zi(t,e,n,r,i,o,s){void 0===i&&(i=Si.min()),void 0===o&&(o=Si.min()),void 0===s&&(s=yi.B),this.target=t,this.targetId=e,this.et=n,this.sequenceNumber=r,this.nt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Hi(t){switch(t){case Er.OK:return xr(),0;case Er.CANCELLED:case Er.UNKNOWN:case Er.DEADLINE_EXCEEDED:case Er.RESOURCE_EXHAUSTED:case Er.INTERNAL:case Er.UNAVAILABLE:case Er.UNAUTHENTICATED:return;case Er.INVALID_ARGUMENT:case Er.NOT_FOUND:case Er.ALREADY_EXISTS:case Er.PERMISSION_DENIED:case Er.FAILED_PRECONDITION:case Er.ABORTED:case Er.OUT_OF_RANGE:case Er.UNIMPLEMENTED:case Er.DATA_LOSS:return 1;default:return xr(),0}}function Ki(t){if(void 0===t)return Sr("GRPC error has no .code"),Er.UNKNOWN;switch(t){case Gi.OK:return Er.OK;case Gi.CANCELLED:return Er.CANCELLED;case Gi.UNKNOWN:return Er.UNKNOWN;case Gi.DEADLINE_EXCEEDED:return Er.DEADLINE_EXCEEDED;case Gi.RESOURCE_EXHAUSTED:return Er.RESOURCE_EXHAUSTED;case Gi.INTERNAL:return Er.INTERNAL;case Gi.UNAVAILABLE:return Er.UNAVAILABLE;case Gi.UNAUTHENTICATED:return Er.UNAUTHENTICATED;case Gi.INVALID_ARGUMENT:return Er.INVALID_ARGUMENT;case Gi.NOT_FOUND:return Er.NOT_FOUND;case Gi.ALREADY_EXISTS:return Er.ALREADY_EXISTS;case Gi.PERMISSION_DENIED:return Er.PERMISSION_DENIED;case Gi.FAILED_PRECONDITION:return Er.FAILED_PRECONDITION;case Gi.ABORTED:return Er.ABORTED;case Gi.OUT_OF_RANGE:return Er.OUT_OF_RANGE;case Gi.UNIMPLEMENTED:return Er.UNIMPLEMENTED;case Gi.DATA_LOSS:return Er.DATA_LOSS;default:return xr()}}(Ee=Gi=Gi||{})[Ee.OK=0]="OK",Ee[Ee.CANCELLED=1]="CANCELLED",Ee[Ee.UNKNOWN=2]="UNKNOWN",Ee[Ee.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ee[Ee.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ee[Ee.NOT_FOUND=5]="NOT_FOUND",Ee[Ee.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ee[Ee.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ee[Ee.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ee[Ee.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ee[Ee.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ee[Ee.ABORTED=10]="ABORTED",Ee[Ee.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ee[Ee.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ee[Ee.INTERNAL=13]="INTERNAL",Ee[Ee.UNAVAILABLE=14]="UNAVAILABLE",Ee[Ee.DATA_LOSS=15]="DATA_LOSS";var Wi=($i.prototype.ot=function(t,e){return new $i(this.i,this.root.ot(t,e,this.i).copy(null,null,Xi.at,null,null))},$i.prototype.remove=function(t){return new $i(this.i,this.root.remove(t,this.i).copy(null,null,Xi.at,null,null))},$i.prototype.get=function(t){for(var e=this.root;!e.m();){var n=this.i(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},$i.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.m();){var r=this.i(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},$i.prototype.m=function(){return this.root.m()},Object.defineProperty($i.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),$i.prototype.ct=function(){return this.root.ct()},$i.prototype.ut=function(){return this.root.ut()},$i.prototype.ht=function(t){return this.root.ht(t)},$i.prototype.forEach=function(n){this.ht(function(t,e){return n(t,e),!1})},$i.prototype.toString=function(){var n=[];return this.ht(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},$i.prototype.lt=function(t){return this.root.lt(t)},$i.prototype._t=function(){return new Qi(this.root,null,this.i,!1)},$i.prototype.ft=function(t){return new Qi(this.root,t,this.i,!1)},$i.prototype.dt=function(){return new Qi(this.root,null,this.i,!0)},$i.prototype.wt=function(t){return new Qi(this.root,t,this.i,!0)},$i),Qi=(Ji.prototype.It=function(){var t=this.Et.pop(),e={key:t.key,value:t.value};if(this.Tt)for(t=t.left;!t.m();)this.Et.push(t),t=t.right;else for(t=t.right;!t.m();)this.Et.push(t),t=t.left;return e},Ji.prototype.At=function(){return 0<this.Et.length},Ji.prototype.Rt=function(){if(0===this.Et.length)return null;var t=this.Et[this.Et.length-1];return{key:t.key,value:t.value}},Ji),Xi=(Yi.prototype.copy=function(t,e,n,r,i){return new Yi(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Yi.prototype.m=function(){return!1},Yi.prototype.ht=function(t){return this.left.ht(t)||t(this.key,this.value)||this.right.ht(t)},Yi.prototype.lt=function(t){return this.right.lt(t)||t(this.key,this.value)||this.left.lt(t)},Yi.prototype.min=function(){return this.left.m()?this:this.left.min()},Yi.prototype.ct=function(){return this.min().key},Yi.prototype.ut=function(){return this.right.m()?this.key:this.right.ut()},Yi.prototype.ot=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.ot(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.ot(t,e,n))).gt()},Yi.prototype.Pt=function(){if(this.left.m())return Yi.EMPTY;var t=this;return t.left.yt()||t.left.left.yt()||(t=t.Vt()),(t=t.copy(null,null,null,t.left.Pt(),null)).gt()},Yi.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.m()||r.left.yt()||r.left.left.yt()||(r=r.Vt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.yt()&&(r=r.bt()),r.right.m()||r.right.yt()||r.right.left.yt()||(r=r.vt()),0===e(t,r.key)){if(r.right.m())return Yi.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Pt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.gt()},Yi.prototype.yt=function(){return this.color},Yi.prototype.gt=function(){var t=this;return t.right.yt()&&!t.left.yt()&&(t=t.St()),t.left.yt()&&t.left.left.yt()&&(t=t.bt()),t.left.yt()&&t.right.yt()&&(t=t.Dt()),t},Yi.prototype.Vt=function(){var t=this.Dt();return t.right.left.yt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.bt())).St()).Dt()),t},Yi.prototype.vt=function(){var t=this.Dt();return t.left.left.yt()&&(t=(t=t.bt()).Dt()),t},Yi.prototype.St=function(){var t=this.copy(null,null,Yi.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Yi.prototype.bt=function(){var t=this.copy(null,null,Yi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Yi.prototype.Dt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Yi.prototype.Ct=function(){var t=this.Nt();return Math.pow(2,t)<=this.size+1},Yi.prototype.Nt=function(){if(this.yt()&&this.left.yt())throw xr();if(this.right.yt())throw xr();var t=this.left.Nt();if(t!==this.right.Nt())throw xr();return t+(this.yt()?0:1)},Yi);function Yi(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Yi.RED,this.left=null!=r?r:Yi.EMPTY,this.right=null!=i?i:Yi.EMPTY,this.size=this.left.size+1+this.right.size}function Ji(t,e,n,r){this.Tt=r,this.Et=[];for(var i=1;!t.m();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Tt?t.left:t.right;else{if(0===i){this.Et.push(t);break}this.Et.push(t),t=this.Tt?t.right:t.left}}function $i(t,e){this.i=t,this.root=e||Xi.EMPTY}function Zi(){this.size=0}Xi.EMPTY=null,Xi.RED=!0,Xi.at=!1,Xi.EMPTY=(Object.defineProperty(Zi.prototype,"key",{get:function(){throw xr()},enumerable:!1,configurable:!0}),Object.defineProperty(Zi.prototype,"value",{get:function(){throw xr()},enumerable:!1,configurable:!0}),Object.defineProperty(Zi.prototype,"color",{get:function(){throw xr()},enumerable:!1,configurable:!0}),Object.defineProperty(Zi.prototype,"left",{get:function(){throw xr()},enumerable:!1,configurable:!0}),Object.defineProperty(Zi.prototype,"right",{get:function(){throw xr()},enumerable:!1,configurable:!0}),Zi.prototype.copy=function(t,e,n,r,i){return this},Zi.prototype.ot=function(t,e,n){return new Xi(t,e)},Zi.prototype.remove=function(t,e){return this},Zi.prototype.m=function(){return!0},Zi.prototype.ht=function(t){return!1},Zi.prototype.lt=function(t){return!1},Zi.prototype.ct=function(){return null},Zi.prototype.ut=function(){return null},Zi.prototype.yt=function(){return!1},Zi.prototype.Ct=function(){return!0},Zi.prototype.Nt=function(){return 0},new Zi);var to=(io.prototype.has=function(t){return null!==this.data.get(t)},io.prototype.first=function(){return this.data.ct()},io.prototype.last=function(){return this.data.ut()},Object.defineProperty(io.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),io.prototype.indexOf=function(t){return this.data.indexOf(t)},io.prototype.forEach=function(n){this.data.ht(function(t,e){return n(t),!1})},io.prototype.Ft=function(t,e){for(var n=this.data.ft(t[0]);n.At();){var r=n.It();if(0<=this.i(r.key,t[1]))return;e(r.key)}},io.prototype.xt=function(t,e){for(var n=void 0!==e?this.data.ft(e):this.data._t();n.At();)if(!t(n.It().key))return},io.prototype.$t=function(t){return(t=this.data.ft(t)).At()?t.It().key:null},io.prototype._t=function(){return new eo(this.data._t())},io.prototype.ft=function(t){return new eo(this.data.ft(t))},io.prototype.add=function(t){return this.copy(this.data.remove(t).ot(t,!0))},io.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},io.prototype.m=function(){return this.data.m()},io.prototype.kt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},io.prototype.isEqual=function(t){if(!(t instanceof io))return!1;if(this.size!==t.size)return!1;for(var e=this.data._t(),n=t.data._t();e.At();){var r=e.It().key,i=n.It().key;if(0!==this.i(r,i))return!1}return!0},io.prototype.A=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},io.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},io.prototype.copy=function(t){var e=new io(this.i);return e.data=t,e},io),eo=(ro.prototype.It=function(){return this.Mt.It().key},ro.prototype.At=function(){return this.Mt.At()},ro),no=new Wi(jr.i);function ro(t){this.Mt=t}function io(t){this.i=t,this.data=new Wi(this.i)}var oo=new Wi(jr.i),so=new Wi(jr.i),uo=new to(jr.i);function ao(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=uo,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var co=new to(li),ho=(So.Bt=function(t){return new So(t.i)},So.prototype.has=function(t){return null!=this.Ot.get(t)},So.prototype.get=function(t){return this.Ot.get(t)},So.prototype.first=function(){return this.Lt.ct()},So.prototype.last=function(){return this.Lt.ut()},So.prototype.m=function(){return this.Lt.m()},So.prototype.indexOf=function(t){return(t=this.Ot.get(t))?this.Lt.indexOf(t):-1},Object.defineProperty(So.prototype,"size",{get:function(){return this.Lt.size},enumerable:!1,configurable:!0}),So.prototype.forEach=function(n){this.Lt.ht(function(t,e){return n(t),!1})},So.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ot.ot(t.key,t),e.Lt.ot(t,null))},So.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ot.remove(t),this.Lt.remove(e)):this},So.prototype.isEqual=function(t){if(!(t instanceof So))return!1;if(this.size!==t.size)return!1;for(var e=this.Lt._t(),n=t.Lt._t();e.At();){var r=e.It().key,i=n.It().key;if(!r.isEqual(i))return!1}return!0},So.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},So.prototype.copy=function(t,e){var n=new So;return n.i=this.i,n.Ot=t,n.Lt=e,n},So),fo=(No.prototype.track=function(t){var e=t.doc.key,n=this.qt.get(e);!n||0!==t.type&&3===n.type?this.qt=this.qt.ot(e,t):3===t.type&&1!==n.type?this.qt=this.qt.ot(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.qt=this.qt.ot(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.qt=this.qt.ot(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.qt=this.qt.remove(e):1===t.type&&2===n.type?this.qt=this.qt.ot(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.qt=this.qt.ot(e,{type:2,doc:t.doc}):xr()},No.prototype.Ut=function(){var n=[];return this.qt.ht(function(t,e){n.push(e)}),n},No),lo=(Ao.Gt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Ao(t,e,ho.Bt(e),i,n,r,!0,!1)},Object.defineProperty(Ao.prototype,"hasPendingWrites",{get:function(){return!this.Wt.m()},enumerable:!1,configurable:!0}),Ao.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.jt===t.jt&&this.Wt.isEqual(t.Wt)&&Mu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Qt.isEqual(t.Qt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Ao),po=(_o.Xt=function(t,e){var n=new Map;return n.set(t,yo.Zt(t,e)),new _o(Si.min(),n,co,no,ao())},_o),yo=(To.Zt=function(t,e){return new To(yi.B,e,ao(),ao(),ao())},To),vo=function(t,e,n,r){this.ie=t,this.removedTargetIds=e,this.key=n,this.re=r},go=function(t,e){this.targetId=t,this.oe=e},mo=function(t,e,n,r){void 0===n&&(n=yi.B),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},wo=(Object.defineProperty(Io.prototype,"te",{get:function(){return this.he},enumerable:!1,configurable:!0}),Object.defineProperty(Io.prototype,"resumeToken",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(Io.prototype,"_e",{get:function(){return 0!==this.ae},enumerable:!1,configurable:!0}),Object.defineProperty(Io.prototype,"fe",{get:function(){return this.le},enumerable:!1,configurable:!0}),Io.prototype.de=function(t){0<t.O()&&(this.le=!0,this.ue=t)},Io.prototype.we=function(){var n=ao(),r=ao(),i=ao();return this.ce.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:xr()}}),new yo(this.ue,this.he,n,r,i)},Io.prototype.me=function(){this.le=!1,this.ce=Lo()},Io.prototype.Te=function(t,e){this.le=!0,this.ce=this.ce.ot(t,e)},Io.prototype.Ee=function(t){this.le=!0,this.ce=this.ce.remove(t)},Io.prototype.Ie=function(){this.ae+=1},Io.prototype.Ae=function(){--this.ae},Io.prototype.Re=function(){this.le=!0,this.he=!0},Io),bo=(Eo.prototype.be=function(t){for(var e=0,n=t.ie;e<n.length;e++){var r=n[e];t.re instanceof wu?this.ve(r,t.re):t.re instanceof bu&&this.Se(r,t.key,t.re)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Se(s,t.key,t.re)}},Eo.prototype.De=function(n){var r=this;this.Ce(n,function(t){var e=r.Ne(t);switch(n.state){case 0:r.Fe(t)&&e.de(n.resumeToken);break;case 1:e.Ae(),e._e||e.me(),e.de(n.resumeToken);break;case 2:e.Ae(),e._e||r.removeTarget(t);break;case 3:r.Fe(t)&&(e.Re(),e.de(n.resumeToken));break;case 4:r.Fe(t)&&(r.xe(t),e.de(n.resumeToken));break;default:xr()}})},Eo.prototype.Ce=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Pe.forEach(function(t,e){r.Fe(e)&&n(e)})},Eo.prototype.$e=function(t){var e=t.targetId,n=t.oe.count;(t=this.ke(e))&&(ji(t=t.target)?0===n?(t=new jr(t.path),this.Se(e,t,new bu(t,Si.min()))):kr(1===n):this.Me(e)!==n&&(this.xe(e),this.pe=this.pe.add(e)))},Eo.prototype.Oe=function(r){var i=this,o=new Map;this.Pe.forEach(function(t,e){var n=i.ke(e);n&&(t.te&&ji(n.target)&&(n=new jr(n.target.path),null!==i.ye.get(n)||i.Le(e,n)||i.Se(e,n,new bu(n,r))),t.fe&&(o.set(e,t.we()),t.me()))});var s=ao();this.Ve.forEach(function(t,e){var n=!0;e.xt(function(t){return!(t=i.ke(t))||2===t.et||(n=!1)}),n&&(s=s.add(t))});var t=new po(r,o,this.pe,this.ye,s);return this.ye=no,this.Ve=Do(),this.pe=new to(li),t},Eo.prototype.ve=function(t,e){var n;this.Fe(t)&&(n=this.Le(t,e.key)?2:0,this.Ne(t).Te(e.key,n),this.ye=this.ye.ot(e.key,e),this.Ve=this.Ve.ot(e.key,this.Be(e.key).add(t)))},Eo.prototype.Se=function(t,e,n){var r;this.Fe(t)&&(r=this.Ne(t),this.Le(t,e)?r.Te(e,1):r.Ee(e),this.Ve=this.Ve.ot(e,this.Be(e).delete(t)),n&&(this.ye=this.ye.ot(e,n)))},Eo.prototype.removeTarget=function(t){this.Pe.delete(t)},Eo.prototype.Me=function(t){var e=this.Ne(t).we();return this.ge.qe(t).size+e.ee.size-e.se.size},Eo.prototype.Ie=function(t){this.Ne(t).Ie()},Eo.prototype.Ne=function(t){var e=this.Pe.get(t);return e||(e=new wo,this.Pe.set(t,e)),e},Eo.prototype.Be=function(t){var e=this.Ve.get(t);return e||(e=new to(li),this.Ve=this.Ve.ot(t,e)),e},Eo.prototype.Fe=function(t){var e=null!==this.ke(t);return e||Nr("WatchChangeAggregator","Detected inactive target",t),e},Eo.prototype.ke=function(t){var e=this.Pe.get(t);return e&&e._e?null:this.ge.Ue(t)},Eo.prototype.xe=function(e){var n=this;this.Pe.set(e,new wo),this.ge.qe(e).forEach(function(t){n.Se(e,t,null)})},Eo.prototype.Le=function(t,e){return this.ge.qe(t).has(e)},Eo);function Eo(t){this.ge=t,this.Pe=new Map,this.ye=no,this.Ve=Do(),this.pe=new to(li)}function Io(){this.ae=0,this.ce=Lo(),this.ue=yi.B,this.he=!1,this.le=!0}function To(t,e,n,r,i){this.resumeToken=t,this.te=e,this.ee=n,this.ne=r,this.se=i}function _o(t,e,n,r,i){this.nt=t,this.zt=e,this.Ht=n,this.Yt=r,this.Jt=i}function Ao(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Qt=n,this.docChanges=r,this.Wt=i,this.fromCache=o,this.jt=s,this.Kt=u}function No(){this.qt=new Wi(jr.i)}function So(n){this.i=n?function(t,e){return n(t,e)||jr.i(t.key,e.key)}:function(t,e){return jr.i(t.key,e.key)},this.Ot=oo,this.Lt=new Wi(this.i)}function Do(){return new Wi(jr.i)}function Lo(){return new Wi(jr.i)}function xo(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function ko(t){return t=Fo(t.mapValue.fields.__local_write_time__.timestampValue),new Ni(t.seconds,t.nanos)}var Oo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ro(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?xo(t)?4:10:xr()}function Po(r,i){var t,e,n,o=Ro(r);if(o!==Ro(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return ko(r).isEqual(ko(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Fo(r.timestampValue),t=Fo(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,qo(r.bytesValue).isEqual(qo(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return o=i,jo((t=r).geoPointValue.latitude)===jo(o.geoPointValue.latitude)&&jo(t.geoPointValue.longitude)===jo(o.geoPointValue.longitude);case 2:return n=i,"integerValue"in(e=r)&&"integerValue"in n?jo(e.integerValue)===jo(n.integerValue):"doubleValue"in e&&"doubleValue"in n&&((e=jo(e.doubleValue))===(n=jo(n.doubleValue))?Pi(e)===Pi(n):isNaN(e)&&isNaN(n));case 9:return pi(r.arrayValue.values||[],i.arrayValue.values||[],Po);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Or(e)!==Or(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!Po(e[t],n[t])))return!1;return!0}();default:return xr()}}function Co(t,e){return void 0!==(t.values||[]).find(function(t){return Po(t,e)})}function Uo(t,e){var n,r,i,o,s=Ro(t),u=Ro(e);if(s!==u)return li(s,u);switch(s){case 0:return 0;case 1:return li(t.booleanValue,e.booleanValue);case 2:return n=e,(r=jo(t.integerValue||t.doubleValue))<(n=jo(n.integerValue||n.doubleValue))?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return Vo(t.timestampValue,e.timestampValue);case 4:return Vo(ko(t),ko(e));case 5:return li(t.stringValue,e.stringValue);case 6:return i=t.bytesValue,o=e.bytesValue,i=qo(i),o=qo(o),i.L(o);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=li(n[i],r[i]);if(0!==o)return o}return li(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return s=t.geoPointValue,r=e.geoPointValue,0!==(n=li(jo(s.latitude),jo(r.latitude)))?n:li(jo(s.longitude),jo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Uo(n[i],r[i]);if(o)return o}return li(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=li(r[s],o[s]);if(0!==u)return u;if(0!==(u=Uo(n[r[s]],i[o[s]])))return u}return li(r.length,o.length)}(t.mapValue,e.mapValue);default:throw xr()}}function Vo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return li(t,e);var n=Fo(t),t=Fo(e);return 0!==(e=li(n.seconds,t.seconds))?e:li(n.nanos,t.nanos)}function Mo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=Fo(t=i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?qo(i.bytesValue).toBase64():"referenceValue"in i?(e=i.referenceValue,jr.C(e).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):xr();var t,e}(t)}function Fo(t){if(kr(!!t),"string"!=typeof t)return{seconds:jo(t.seconds),nanos:jo(t.nanos)};var e=0,n=Oo.exec(t);return kr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function jo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function qo(t){return"string"==typeof t?yi.fromBase64String(t):yi.fromUint8Array(t)}function Go(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.R()}}function Bo(t){return t&&"integerValue"in t}function zo(t){return!!t&&"arrayValue"in t}function Ho(t){return t&&"nullValue"in t}function Ko(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Wo(t){return t&&"mapValue"in t}var Qo={asc:"ASCENDING",desc:"DESCENDING"},Xo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Yo=function(t,e){this.U=t,this.Qe=e};function Jo(t){return{integerValue:""+t}}function $o(t,e){if(t.Qe){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Pi(e)?"-0":e}}function Zo(t,e){return Ci(e)?Jo(e):$o(t,e)}function ts(t,e){return t.Qe?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function es(t,e){return t.Qe?e.toBase64():e.toUint8Array()}function ns(t){return kr(!!t),Si.J((t=Fo(t),new Ni(t.seconds,t.nanos)))}function rs(t,e){return new Vr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).R()}function is(t){return kr(Es(t=Vr.g(t))),t}function os(t,e){return rs(t.U,e.path)}function ss(t,e){return kr((e=is(e)).get(1)===t.U.projectId),kr(!e.get(3)&&!t.U.database||e.get(3)===t.U.database),new jr(hs(e))}function us(t,e){return rs(t.U,e)}function as(t){return 4===(t=is(t)).length?Vr.P():hs(t)}function cs(t){return new Vr(["projects",t.U.projectId,"databases",t.U.database]).R()}function hs(t){return kr(4<t.length&&"documents"===t.get(4)),t.u(5)}function fs(t,e,n){return{name:os(t,e),fields:n.proto.mapValue.fields}}function ls(t,e){var n,r,i;if(e instanceof Js)n={update:fs(t,e.key,e.value)};else if(e instanceof au)n={delete:os(t,e.key)};else if(e instanceof $s)n={update:fs(t,e.key,e.data),updateMask:(i=e.We,r=[],i.fields.forEach(function(t){return r.push(t.R())}),{fieldPaths:r})};else if(e instanceof ru)n={transform:{document:os(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof As)return{fieldPath:t.field.R(),setToServerValue:"REQUEST_TIME"};if(e instanceof Ns)return{fieldPath:t.field.R(),appendMissingElements:{values:e.elements}};if(e instanceof ks)return{fieldPath:t.field.R(),removeAllFromArray:{values:e.elements}};if(e instanceof Cs)return{fieldPath:t.field.R(),increment:e.je};throw xr()})}};else{if(!(e instanceof cu))return xr();n={verify:os(t,e.key)}}return e.Ge.Ke||(n.currentDocument=void 0!==(i=e.Ge).updateTime?{updateTime:ts(e=t,(t=i.updateTime).Z())}:void 0!==i.exists?{exists:i.exists}:xr()),n}function ps(o,t){var e=t.currentDocument?void 0!==(i=t.currentDocument).updateTime?Bs.updateTime(ns(i.updateTime)):void 0!==i.exists?Bs.exists(i.exists):Bs.ze():Bs.ze();if(t.update){t.update.name;var n=ss(o,t.update.name),r=new hu({mapValue:{fields:t.update.fields}});if(t.updateMask){var i=(i=t.updateMask.fieldPaths||[],new Fs(i.map(function(t){return Fr.S(t)})));return new $s(n,r,i,e)}return new Js(n,r,e)}if(t.delete){var s=ss(o,t.delete);return new au(s,e)}return t.transform?(r=ss(o,t.transform.document),s=t.transform.fieldTransforms.map(function(t){return e=o,i=null,"setToServerValue"in(n=t)?(kr("REQUEST_TIME"===n.setToServerValue),i=new As):"appendMissingElements"in n?(r=n.appendMissingElements.values||[],i=new Ns(r)):"removeAllFromArray"in n?(r=n.removeAllFromArray.values||[],i=new ks(r)):"increment"in n?i=new Cs(e,n.increment):xr(),n=Fr.S(n.fieldPath),new js(n,i);var e,n,r,i}),kr(!0===e.exists),new ru(r,s)):t.verify?(t=ss(o,t.verify),new cu(t,e)):xr()}function ds(t,e){return{documents:[us(t,e.path)]}}function ys(t,e){var n={structuredQuery:{}},r=e.path;return null!==e.collectionGroup?(n.parent=us(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=us(t,r.h()),n.structuredQuery.from=[{collectionId:r._()}]),(r=function(t){if(0!==t.length)return 1===(t=t.map(function(t){if("=="===t.op){if(Ko(t.value))return{unaryFilter:{field:ws(t.field),op:"IS_NAN"}};if(Ho(t.value))return{unaryFilter:{field:ws(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Ko(t.value))return{unaryFilter:{field:ws(t.field),op:"IS_NOT_NAN"}};if(Ho(t.value))return{unaryFilter:{field:ws(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ws(t.field),op:(e=t.op,Xo[e]),value:t.value}};var e})).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(e.filters))&&(n.structuredQuery.where=r),(r=function(t){if(0!==t.length)return t.map(function(t){return{field:ws((t=t).field),direction:(t=t.dir,Qo[t])}})}(e.orderBy))&&(n.structuredQuery.orderBy=r),r=e.limit,null!==(r=t.Qe||Ri(r)?r:{value:r})&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=gs(e.startAt)),e.endAt&&(n.structuredQuery.endAt=gs(e.endAt)),n}function vs(t){var e=as(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(kr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=bs(t.unaryFilter.field);return zu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=bs(t.unaryFilter.field);return zu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":return n=bs(t.unaryFilter.field),zu.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":return t=bs(t.unaryFilter.field),zu.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return xr()}}(e)]:void 0!==e.fieldFilter?[(n=e,zu.create(bs(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return xr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):xr():[];var n}(n.where)),t=[],n.orderBy&&(t=n.orderBy.map(function(t){return new ma(bs((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e})),r=null,n.limit&&(r=Ri(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=ms(n.startAt));var u=null;return n.endAt&&(u=ms(n.endAt)),Pu(Nu(e,i,t,o,r,"F",s,u))}function gs(t){return{before:t.before,values:t.position}}function ms(t){var e=!!t.before,t=t.values||[];return new ha(t,e)}function ws(t){return{fieldPath:t.R()}}function bs(t){return Fr.S(t.fieldPath)}function Es(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function Is(t,e){return t instanceof Cs?Bo(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var Ts,_s,As=(n(Ds,_s=h=function(){this.He=void 0}),Ds),Ns=(n(Ss,Ts=h),Ss);function Ss(t){var e=this;return(e=Ts.call(this)||this).elements=t,e}function Ds(){return null!==_s&&_s.apply(this,arguments)||this}function Ls(t,e){for(var n=Ms(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return Po(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var xs,ks=(n(Os,xs=h),Os);function Os(t){var e=this;return(e=xs.call(this)||this).elements=t,e}function Rs(t,e){for(var n=Ms(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!Po(t,e)})}(i[r]);return{arrayValue:{values:n}}}var Ps,Cs=(n(Us,Ps=h),Us);function Us(t,e){var n=this;return(n=Ps.call(this)||this).serializer=t,n.je=e,n}function Vs(t){return jo(t.integerValue||t.doubleValue)}function Ms(t){return zo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Fs=(qs.prototype.Ye=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].T(t))return!0;return!1},qs.prototype.isEqual=function(t){return pi(this.fields,t.fields,function(t,e){return t.isEqual(e)})},qs),js=function(t,e){this.field=t,this.transform=e};function qs(t){(this.fields=t).sort(Fr.i)}function Gs(t,e){this.version=t,this.transformResults=e}var Bs=(zs.ze=function(){return new zs},zs.exists=function(t){return new zs(void 0,t)},zs.updateTime=function(t){return new zs(t)},Object.defineProperty(zs.prototype,"Ke",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),zs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},zs);function zs(t,e){this.updateTime=t,this.exists=e}function Hs(t,e){return void 0!==t.updateTime?e instanceof wu&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof wu}function Ks(t,e,n,r){return t instanceof Js?(o=e,Hs((i=t).Ge,o)?(o=Qs(o),new wu(i.key,o,i.value,{Je:!0})):o):t instanceof $s?function(t,e){if(!Hs(t.Ge,e))return e;var n=Qs(e),e=eu(t,e);return new wu(t.key,n,e,{Je:!0})}(t,e):t instanceof ru?function(t,e,n,r){if(!Hs(t.Ge,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],c=a.transform,h=null;n instanceof wu&&(h=n.field(a.field)),null===h&&r instanceof wu&&(h=r.field(a.field)),o.push((i=h,a=e,h=void 0,(c=c)instanceof As?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(h.fields.__previous_value__=i),{mapValue:h}):c instanceof Ns?Ls(c,i):c instanceof ks?Rs(c,i):(i=Vs(c=Is(h=c,i))+Vs(h.je),Bo(c)&&Bo(h.je)?Jo(i):$o(h.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=ou(t,i.data(),r);return new wu(t.key,i.version,r,{Je:!0})}(t,e,r,n):(e=e,Hs((t=t).Ge,e)?new bu(t.key,Si.min()):e);var i,o}function Ws(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ge.isEqual(e.Ge)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.We.isEqual(e.We):2!==t.type||pi(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof Ns&&e instanceof Ns||t instanceof ks&&e instanceof ks?pi(t.elements,e.elements,Po):t instanceof Cs&&e instanceof Cs?Po(t.je,e.je):t instanceof As&&e instanceof As)}))}function Qs(t){return t instanceof wu?t.version:Si.min()}var Xs,Ys,Js=(n(tu,Ys=be=function(){}),tu),$s=(n(Zs,Xs=be),Zs);function Zs(t,e,n,r){var i=this;return(i=Xs.call(this)||this).key=t,i.data=e,i.We=n,i.Ge=r,i.type=1,i}function tu(t,e,n){var r=this;return(r=Ys.call(this)||this).key=t,r.value=e,r.Ge=n,r.type=0,r}function eu(t,e){return n=t,e=e instanceof wu?e.data():hu.empty(),r=new fu(e),n.We.fields.forEach(function(t){var e;t.m()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Xe();var n,r}var nu,ru=(n(iu,nu=be),iu);function iu(t,e){var n=this;return(n=nu.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ge=Bs.exists(!0),n}function ou(t,e,n){for(var r=new fu(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Xe()}var su,uu,au=(n(yu,uu=be),yu),cu=(n(du,su=be),du),hu=(pu.empty=function(){return new pu({mapValue:{}})},pu.prototype.field=function(t){if(t.m())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Wo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t._()])||null},pu.prototype.isEqual=function(t){return Po(this.proto,t.proto)},pu),fu=(lu.prototype.set=function(t,e){return this.en(t,e),this},lu.prototype.delete=function(t){return this.en(t,null),this},lu.prototype.en=function(t,e){for(var n=this.tn,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===Ro(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t._(),e)},lu.prototype.Xe=function(){var t=this.nn(Fr.P(),this.tn);return null!=t?new hu(t):this.Ze},lu.prototype.nn=function(r,t){var i=this,o=!1,e=this.Ze.field(r),s=Wo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.nn(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},lu);function lu(t){void 0===t&&(t=hu.empty()),this.Ze=t,this.tn=new Map}function pu(t){this.proto=t}function du(t,e){var n=this;return(n=su.call(this)||this).key=t,n.Ge=e,n.type=4,n}function yu(t,e){var n=this;return(n=uu.call(this)||this).key=t,n.Ge=e,n.type=3,n}var vu,gu,mu,wu=(n(Au,mu=Ee=function(t,e){this.key=t,this.version=e}),Au.prototype.field=function(t){return this.sn.field(t)},Au.prototype.data=function(){return this.sn},Au.prototype.rn=function(){return this.sn.proto},Au.prototype.isEqual=function(t){return t instanceof Au&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Je===t.Je&&this.hasCommittedMutations===t.hasCommittedMutations&&this.sn.isEqual(t.sn)},Au.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.sn.toString()+", {hasLocalMutations: "+this.Je+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Au.prototype,"hasPendingWrites",{get:function(){return this.Je||this.hasCommittedMutations},enumerable:!1,configurable:!0}),Au),bu=(n(_u,gu=Ee),_u.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(_u.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),_u.prototype.isEqual=function(t){return t instanceof _u&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},_u),Eu=(n(Tu,vu=Ee),Tu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Tu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Tu.prototype.isEqual=function(t){return t instanceof Tu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Tu),Iu=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.on=n,this.filters=r,this.limit=i,this.an=o,this.startAt=s,this.endAt=u,this.cn=null,this.un=null,this.startAt,this.endAt};function Tu(){return null!==vu&&vu.apply(this,arguments)||this}function _u(t,e,n){var r=this;return(r=gu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function Au(t,e,n,r){var i=this;return(i=mu.call(this,t,e)||this).sn=n,i.Je=!!r.Je,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function Nu(t,e,n,r,i,o,s,u){return new Iu(t,e,n,r,i,o,s,u)}function Su(t){return new Iu(t)}function Du(t){return!Ri(t.limit)&&"F"===t.an}function Lu(t){return!Ri(t.limit)&&"L"===t.an}function xu(t){return 0<t.on.length?t.on[0].field:null}function ku(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.hn())return r.field}return null}function Ou(t){return null!==t.collectionGroup}function Ru(t){var e=t;if(null===e.cn){e.cn=[];var n=ku(e),t=xu(e);if(null!==n&&null===t)n.p()||e.cn.push(new ma(n)),e.cn.push(new ma(Fr.v(),"asc"));else{for(var r=!1,i=0,o=e.on;i<o.length;i++){var s=o[i];e.cn.push(s),s.field.p()&&(r=!0)}r||(n=0<e.on.length?e.on[e.on.length-1].dir:"asc",e.cn.push(new ma(Fr.v(),n)))}}return e.cn}function Pu(t){var e=t;if(!e.un)if("F"===e.an)e.un=Vi(e.path,e.collectionGroup,Ru(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Ru(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new ma(o.field,s))}var u=e.endAt?new ha(e.endAt.position,!e.endAt.before):null,t=e.startAt?new ha(e.startAt.position,!e.startAt.before):null;e.un=Vi(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.un}function Cu(t,e,n){return new Iu(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Uu(t,e){return new Iu(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.an,e,t.endAt)}function Vu(t,e){return new Iu(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.an,t.startAt,e)}function Mu(t,e){return Fi(Pu(t),Pu(e))&&t.an===e.an}function Fu(t){return Mi(Pu(t))+"|lt:"+t.an}function ju(t){return"Query(target="+(n=(e=Pu(t)).path.R(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.R()+" "+t.op+" "+Mo(t.value)}).join(", ")+"]"),Ri(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.R()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+ya(e.startAt)),e.endAt&&(n+=", endAt: "+ya(e.endAt)),"Target("+n+")")+"; limitType="+t.an+")";var e,n}function qu(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.N(e.collectionGroup)&&e.path.T(n):jr.F(e.path)?e.path.isEqual(n):e.path.I(n))&&function(t){for(var e=0,n=i.on;e<n.length;e++){var r=n[e];if(!r.field.p()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||va(t.startAt,Ru(t),n))&&(!t.endAt||!va(t.endAt,Ru(t),n)));var e,n}function Gu(u){return function(t,e){for(var n=!1,r=0,i=Ru(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i,o;switch(n=t.field.p()?jr.i(e.key,n.key):(r=t.field,i=n,o=e.field(r),r=i.field(r),null!==o&&null!==r?Uo(o,r):xr()),t.dir){case"asc":return n;case"desc":return-1*n;default:return xr()}}(o,t,e);if(0!==s)return s;n=n||o.field.p()}return 0}}var Bu,zu=(n(Hu,Bu=function(){}),Hu.create=function(t,e,n){if(t.p())return"in"===e||"not-in"===e?this.ln(t,e,n):new Xu(t,e,n);if(Ho(n)){if("=="!==e&&"!="!==e)throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. Null only supports '==' and '!=' comparisons.");return new Hu(t,e,n)}if(Ko(n)){if("=="!==e&&"!="!==e)throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. NaN only supports '==' and '!=' comparisons.");return new Hu(t,e,n)}return"array-contains"===e?new sa(t,n):"in"===e?new ua(t,n):"not-in"===e?new aa(t,n):"array-contains-any"===e?new ca(t,n):new Hu(t,e,n)},Hu.ln=function(t,e,n){return new("in"===e?Yu:Ju)(t,n)},Hu.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this._n(Uo(t,this.value)):null!==t&&Ro(this.value)===Ro(t)&&this._n(Uo(t,this.value))},Hu.prototype._n=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return xr()}},Hu.prototype.hn=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Hu);function Hu(t,e,n){var r=this;return(r=Bu.call(this)||this).field=t,r.op=e,r.value=n,r}var Ku,Wu,Qu,Xu=(n(ta,Qu=zu),ta.prototype.matches=function(t){return t=jr.i(t.key,this.key),this._n(t)},ta),Yu=(n(Zu,Wu=zu),Zu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Zu),Ju=(n($u,Ku=zu),$u.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},$u);function $u(t,e){var n=this;return(n=Ku.call(this,t,"not-in",e)||this).keys=ea(0,e),n}function Zu(t,e){var n=this;return(n=Wu.call(this,t,"in",e)||this).keys=ea(0,e),n}function ta(t,e,n){var r=this;return(r=Qu.call(this,t,e,n)||this).key=jr.C(n.referenceValue),r}function ea(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return jr.C(t.referenceValue)})}var na,ra,ia,oa,sa=(n(da,oa=zu),da.prototype.matches=function(t){return zo(t=t.field(this.field))&&Co(t.arrayValue,this.value)},da),ua=(n(pa,ia=zu),pa.prototype.matches=function(t){return null!==(t=t.field(this.field))&&Co(this.value.arrayValue,t)},pa),aa=(n(la,ra=zu),la.prototype.matches=function(t){return!Co(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&(null!==(t=t.field(this.field))&&!Co(this.value.arrayValue,t))},la),ca=(n(fa,na=zu),fa.prototype.matches=function(t){var e=this;return!(!zo(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return Co(e.value.arrayValue,t)})},fa),ha=function(t,e){this.position=t,this.before=e};function fa(t,e){return na.call(this,t,"array-contains-any",e)||this}function la(t,e){return ra.call(this,t,"not-in",e)||this}function pa(t,e){return ia.call(this,t,"in",e)||this}function da(t,e){return oa.call(this,t,"array-contains",e)||this}function ya(t){return(t.before?"b":"a")+":"+t.position.map(Mo).join(",")}function va(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.p()?jr.i(jr.C(s.referenceValue),n.key):Uo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function ga(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Po(t.position[n],e.position[n]))return!1;return!0}var ma=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function wa(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var ba,Ea=(xa.prototype.reset=function(){this.En=0},xa.prototype.Rn=function(){this.En=this.Tn},xa.prototype.gn=function(t){var e=this;this.cancel();var n=Math.floor(this.En+this.Pn()),r=Math.max(0,Date.now()-this.An),i=Math.max(0,n-r);0<i&&Nr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.En+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.In=this.fn.yn(this.dn,i,function(){return e.An=Date.now(),t()}),this.En*=this.mn,this.En<this.wn&&(this.En=this.wn),this.En>this.Tn&&(this.En=this.Tn)},xa.prototype.Vn=function(){null!==this.In&&(this.In.pn(),this.In=null)},xa.prototype.cancel=function(){null!==this.In&&(this.In.cancel(),this.In=null)},xa.prototype.Pn=function(){return(Math.random()-.5)*this.En},xa),Ia=(La.prototype.catch=function(t){return this.next(void 0,t)},La.prototype.next=function(r,i){var o=this;return this.Dn&&xr(),this.Dn=!0,this.Sn?this.error?this.Cn(i,this.error):this.Nn(r,this.result):new La(function(e,n){o.bn=function(t){o.Nn(r,t).next(e,n)},o.vn=function(t){o.Cn(i,t).next(e,n)}})},La.prototype.Fn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},La.prototype.xn=function(t){try{var e=t();return e instanceof La?e:La.resolve(e)}catch(t){return La.reject(t)}},La.prototype.Nn=function(t,e){return t?this.xn(function(){return t(e)}):La.resolve(e)},La.prototype.Cn=function(t,e){return t?this.xn(function(){return t(e)}):La.reject(e)},La.resolve=function(n){return new La(function(t,e){t(n)})},La.reject=function(n){return new La(function(t,e){e(n)})},La.$n=function(t){return new La(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},La.kn=function(t){for(var n=La.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?La.resolve(t):e()})}(r[e]);return n},La.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.$n(i)},La),Ta=(Da.delete=function(t){return Nr("SimpleDb","Removing database:",t),Ua(window.indexedDB.deleteDatabase(t)).Fn()},Da.Ln=function(){if("undefined"==typeof indexedDB)return!1;if(Da.Bn())return!0;var t=p(),e=0<(n=Da.On(t))&&n<10,n=0<(n=Da.qn(t))&&n<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||e||n)},Da.Bn=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Un)},Da.Qn=function(t,e){return t.store(e)},Da.On=function(t){return t=(t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i))?t[1].split("_").slice(0,2).join("."):"-1",Number(t)},Da.qn=function(t){return t=(t=t.match(/Android ([\d.]+)/i))?t[1].split(".").slice(0,2).join("."):"-1",Number(t)},Da.prototype.Wn=function(o){return y(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(Nr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(t){t=t.target.result,e(t)},r.onblocked=function(){n(new Aa(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){"VersionError"===(t=t.target.error).name?n(new Ir(Er.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new Aa(o,t))},r.onupgradeneeded=function(t){Nr("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;i.Mn.createOrUpgrade(e,r.transaction,t.oldVersion,i.version).next(function(){Nr("SimpleDb","Database upgrade to version "+i.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.jn&&(this.db.onversionchange=function(t){return i.jn(t)}),this.db)]}})})},Da.prototype.Kn=function(e){this.jn=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},Da.prototype.runTransaction=function(u,n,a,c){return y(this,void 0,void 0,function(){var i,o,s,e;return v(this,function(t){switch(t.label){case 0:i="readonly"===n,o=0,e=function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.Wn(u)];case 2:return s.db=t.sent(),e=Oa.open(s.db,u,i?"readonly":"readwrite",a),n=c(e).catch(function(t){return e.abort(t),Ia.reject(t)}).Fn(),r={},n.catch(function(){}),[4,e.Gn];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return n=t.sent(),r="FirebaseError"!==n.name&&o<3,Nr("SimpleDb","Transaction failed with error:",n.message,"Retrying:",r),s.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},s=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(e=t.sent()))return[2,e.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},Da.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},Da),_a=(Object.defineProperty(Sa.prototype,"Sn",{get:function(){return this.Hn},enumerable:!1,configurable:!0}),Object.defineProperty(Sa.prototype,"Jn",{get:function(){return this.Yn},enumerable:!1,configurable:!0}),Object.defineProperty(Sa.prototype,"cursor",{set:function(t){this.zn=t},enumerable:!1,configurable:!0}),Sa.prototype.done=function(){this.Hn=!0},Sa.prototype.Xn=function(t){this.Yn=t},Sa.prototype.delete=function(){return Ua(this.zn.delete())},Sa),Aa=(n(Na,ba=Ir),Na);function Na(t,e){var n=this;return(n=ba.call(this,Er.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function Sa(t){this.zn=t,this.Hn=!1,this.Yn=null}function Da(t,e,n){this.name=t,this.version=e,this.Mn=n,12.2===Da.On(p())&&Sr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function La(t){var e=this;this.bn=null,this.vn=null,this.result=void 0,this.error=void 0,this.Sn=!1,this.Dn=!1,t(function(t){e.Sn=!0,e.result=t,e.bn&&e.bn(t)},function(t){e.Sn=!0,e.error=t,e.vn&&e.vn(t)})}function xa(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.fn=t,this.dn=e,this.wn=n,this.mn=r,this.Tn=i,this.En=0,this.In=null,this.An=Date.now(),this.reset()}function ka(t){return"IndexedDbTransactionError"===t.name}var Oa=(Ca.open=function(t,e,n,r){try{return new Ca(e,t.transaction(r,n))}catch(t){throw new Aa(e,t)}},Object.defineProperty(Ca.prototype,"Gn",{get:function(){return this.Zn.promise},enumerable:!1,configurable:!0}),Ca.prototype.abort=function(t){t&&this.Zn.reject(t),this.aborted||(Nr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Ca.prototype.store=function(t){return t=this.transaction.objectStore(t),new Ra(t)},Ca),Ra=(Pa.prototype.put=function(t,e){return Ua(t=void 0!==e?(Nr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Nr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},Pa.prototype.add=function(t){return Nr("SimpleDb","ADD",this.store.name,t,t),Ua(this.store.add(t))},Pa.prototype.get=function(e){var n=this;return Ua(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Nr("SimpleDb","GET",n.store.name,e,t),t})},Pa.prototype.delete=function(t){return Nr("SimpleDb","DELETE",this.store.name,t),Ua(this.store.delete(t))},Pa.prototype.count=function(){return Nr("SimpleDb","COUNT",this.store.name),Ua(this.store.count())},Pa.prototype.ts=function(t,e){var e=this.cursor(this.options(t,e)),n=[];return this.es(e,function(t,e){n.push(e)}).next(function(){return n})},Pa.prototype.ns=function(t,e){return Nr("SimpleDb","DELETE ALL",this.store.name),(e=this.options(t,e)).ss=!1,e=this.cursor(e),this.es(e,function(t,e,n){return n.delete()})},Pa.prototype.rs=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.es(n,e)},Pa.prototype.os=function(r){var t=this.cursor({});return new Ia(function(n,e){t.onerror=function(t){t=Ma(t.target.error),e(t)},t.onsuccess=function(t){var e=t.target.result;e?r(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},Pa.prototype.es=function(t,i){var o=[];return new Ia(function(r,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n=t.target.result;n?(e=new _a(n),(t=i(n.primaryKey,n.value,e))instanceof Ia&&(t=t.catch(function(t){return e.done(),Ia.reject(t)}),o.push(t)),e.Sn?r():null===e.Jn?n.continue():n.continue(e.Jn)):r()}}).next(function(){return Ia.$n(o)})},Pa.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},Pa.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.ss?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},Pa);function Pa(t){this.store=t}function Ca(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.Zn=new wa,this.transaction.oncomplete=function(){n.Zn.resolve()},this.transaction.onabort=function(){t.error?n.Zn.reject(new Aa(e,t.error)):n.Zn.resolve()},this.transaction.onerror=function(t){t=Ma(t.target.error),n.Zn.reject(new Aa(e,t))}}function Ua(t){return new Ia(function(e,n){t.onsuccess=function(t){t=t.target.result,e(t)},t.onerror=function(t){t=Ma(t.target.error),n(t)}})}var Va=!1;function Ma(t){var e=Ta.On(p());if(12.2<=e&&e<13&&(e="An internal error was encountered in the Indexed Database server",0<=t.message.indexOf(e))){var n=new Ir("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Va||(Va=!0,setTimeout(function(){throw n},0)),n}return t}function Fa(){return"undefined"!=typeof window?window:null}function ja(){return"undefined"!=typeof document?document:null}var qa=(za._s=function(t,e,n,r,i){return(i=new za(t,e,Date.now()+n,r,i)).start(n),i},za.prototype.start=function(t){var e=this;this.fs=setTimeout(function(){return e.ds()},t)},za.prototype.pn=function(){return this.ds()},za.prototype.cancel=function(t){null!==this.fs&&(this.clearTimeout(),this.ls.reject(new Ir(Er.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},za.prototype.ds=function(){var e=this;this.cs.ws(function(){return null!==e.fs?(e.clearTimeout(),e.op().then(function(t){return e.ls.resolve(t)})):Promise.resolve()})},za.prototype.clearTimeout=function(){null!==this.fs&&(this.hs(this),clearTimeout(this.fs),this.fs=null)},za),Ga=(Object.defineProperty(Ba.prototype,"ps",{get:function(){return this.Is},enumerable:!1,configurable:!0}),Ba.prototype.ws=function(t){this.enqueue(t)},Ba.prototype.bs=function(t){this.vs(),this.Ss(t)},Ba.prototype.Ds=function(){var t;this.Is||(this.Is=!0,(t=ja())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Vs))},Ba.prototype.enqueue=function(t){return this.vs(),this.Is?new Promise(function(t){}):this.Ss(t)},Ba.prototype.Cs=function(t){var e=this;this.ws(function(){return e.Es.push(t),e.Ns()})},Ba.prototype.Ns=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Es.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Es[0]()];case 2:return t.sent(),this.Es.shift(),this.ys.reset(),[3,4];case 3:if(!ka(e=t.sent()))throw e;return Nr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Es.length&&this.ys.gn(function(){return n.Ns()}),t.label=5;case 5:return[2]}})})},Ba.prototype.Ss=function(t){var r=this,e=this.Ts.then(function(){return r.gs=!0,t().catch(function(t){throw r.Rs=t,r.gs=!1,Sr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.gs=!1,t})});return this.Ts=e},Ba.prototype.yn=function(t,e,n){var r=this;return this.vs(),-1<this.Ps.indexOf(t)&&(e=0),n=qa._s(this,t,e,n,function(t){return r.Fs(t)}),this.As.push(n),n},Ba.prototype.vs=function(){this.Rs&&xr()},Ba.prototype.xs=function(){},Ba.prototype.$s=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Ts];case 1:t.sent(),t.label=2;case 2:if(e!==this.Ts)return[3,0];t.label=3;case 3:return[2]}})})},Ba.prototype.ks=function(t){for(var e=0,n=this.As;e<n.length;e++)if(n[e].dn===t)return!0;return!1},Ba.prototype.Ms=function(r){var i=this;return this.$s().then(function(){i.As.sort(function(t,e){return t.us-e.us});for(var t=0,e=i.As;t<e.length;t++){var n=e[t];if(n.pn(),"all"!==r&&n.dn===r)break}return i.$s()})},Ba.prototype.Os=function(t){this.Ps.push(t)},Ba.prototype.Fs=function(t){t=this.As.indexOf(t),this.As.splice(t,1)},Ba);function Ba(){var e=this;this.Ts=Promise.resolve(),this.Es=[],this.Is=!1,this.As=[],this.Rs=null,this.gs=!1,this.Ps=[],this.ys=new Ea(this,"async_queue_retry"),this.Vs=function(){var t=ja();t&&Nr("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.ys.Vn()};var t=ja();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Vs)}function za(t,e,n,r,i){this.cs=t,this.dn=e,this.us=n,this.op=r,this.hs=i,this.ls=new wa,this.then=this.ls.promise.then.bind(this.ls.promise),this.ls.promise.catch(function(t){})}function Ha(t,e){if(Sr("AsyncQueue",e+": "+t),ka(t))return new Ir(Er.UNAVAILABLE,e+": "+t);throw t}function Ka(){this.Ls=void 0,this.listeners=[]}function Wa(){this.Bs=new Ai(Fu,Mu),this.onlineState="Unknown",this.qs=new Set}function Qa(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.Bs.get(n))||(r=!0,i=new Ka),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Us(n)];case 2:return o.Ls=t.sent(),[3,4];case 3:return o=Ha(o=t.sent(),"Initialization of query '"+ju(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.Bs.set(n,i),i.listeners.push(u),u.Qs(e.onlineState),i.Ls&&u.Ws(i.Ls)&&Ya(e),[2]}})})}function Xa(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.Bs.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.Bs.delete(n),e.js(n))]:[2]})})}function Ya(t){t.qs.forEach(function(t){t.next()})}var Ja=(tc.prototype.Ws=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new lo(t.query,t.docs,t.Qt,e,t.Wt,t.fromCache,t.jt,!0)}var o=!1;return this.Gs?this.Hs(t)&&(this.Ks.next(t),o=!0):this.Ys(t,this.onlineState)&&(this.Js(t),o=!0),this.zs=t,o},tc.prototype.onError=function(t){this.Ks.error(t)},tc.prototype.Qs=function(t){this.onlineState=t;var e=!1;return this.zs&&!this.Gs&&this.Ys(this.zs,t)&&(this.Js(this.zs),e=!0),e},tc.prototype.Ys=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Xs&&n||t.docs.m()&&"Offline"!==e)},tc.prototype.Hs=function(t){if(0<t.docChanges.length)return!0;var e=this.zs&&this.zs.hasPendingWrites!==t.hasPendingWrites;return!(!t.jt&&!e)&&!0===this.options.includeMetadataChanges},tc.prototype.Js=function(t){t=lo.Gt(t.query,t.docs,t.Wt,t.fromCache),this.Gs=!0,this.Ks.next(t)},tc),$a=(Za.prototype.Zs=function(){return null!=this.uid},Za.prototype.ti=function(){return this.Zs()?"uid:"+this.uid:"anonymous-user"},Za.prototype.isEqual=function(t){return t.uid===this.uid},Za);function Za(t){this.uid=t}function tc(t,e,n){this.query=t,this.Ks=e,this.Gs=!1,this.zs=null,this.onlineState="Unknown",this.options=n||{}}$a.UNAUTHENTICATED=new $a(null),$a.ei=new $a("google-credentials-uid"),$a.ni=new $a("first-party-uid");var ec=(nc.prototype.ii=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},nc.prototype.next=function(){var t=++this.previousValue;return this.ri&&this.ri(t),t},nc);function nc(t,e){var n=this;this.previousValue=t,e&&(e.si=function(t){return n.ii(t)},this.ri=function(t){return e.oi(t)})}function rc(t,e){return"firestore_clients_"+t+"_"+e}function ic(t,e,n){return n="firestore_mutations_"+t+"_"+n,e.Zs()&&(n+="_"+e.uid),n}function oc(t,e){return"firestore_targets_"+t+"_"+e}ec.ai=-1;var sc=(xc.ci=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Ir(r.error.code,r.error.message)),i?new xc(t,e,r.state,o):(Sr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},xc.prototype.ui=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},xc),uc=(Lc.ci=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Ir(n.error.code,n.error.message)),r?new Lc(t,n.state,i):(Sr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},Lc.prototype.ui=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Lc),ac=(Dc.ci=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=co,o=0;r&&o<n.activeTargetIds.length;++o)r=Ci(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new Dc(t,i):(Sr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},Dc),cc=(Sc.ci=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new Sc(e.clientId,e.onlineState):(Sr("SharedClientState","Failed to parse online state: "+t),null)},Sc),hc=(Nc.prototype.hi=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Nc.prototype.li=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Nc.prototype.ui=function(){var t={activeTargetIds:this.activeTargetIds.A(),updateTimeMs:Date.now()};return JSON.stringify(t)},Nc),fc=(Ac.Ln=function(t){return!(!t||!t.localStorage)},Ac.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f=this;return v(this,function(t){switch(t.label){case 0:return[4,this.fi.pi()];case 1:for(s=t.sent(),e=0,n=s;e<n.length;e++)(r=n[e])!==this._i&&(i=this.getItem(rc(this.persistenceKey,r)))&&(o=ac.ci(r,i))&&(this.Ti=this.Ti.ot(o.clientId,o));for(this.bi(),(s=this.storage.getItem(this.Vi))&&(u=this.vi(s))&&this.Si(u),a=0,c=this.Ii;a<c.length;a++)h=c[a],this.mi(h);return this.Ii=[],this.window.addEventListener("unload",function(){return f.Di()}),this.Ei=!0,[2]}})})},Ac.prototype.oi=function(t){this.setItem(this.Ri,JSON.stringify(t))},Ac.prototype.Ci=function(){return this.Ni(this.Ti)},Ac.prototype.Fi=function(n){var r=!1;return this.Ti.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},Ac.prototype.xi=function(t){this.$i(t,"pending")},Ac.prototype.ki=function(t,e,n){this.$i(t,e,n),this.Mi(t)},Ac.prototype.Oi=function(t){var e,n="not-current";return this.Fi(t)&&(!(e=this.storage.getItem(oc(this.persistenceKey,t)))||(e=uc.ci(t,e))&&(n=e.state)),this.Li.hi(t),this.bi(),n},Ac.prototype.Bi=function(t){this.Li.li(t),this.bi()},Ac.prototype.qi=function(t){return this.Li.activeTargetIds.has(t)},Ac.prototype.Ui=function(t){this.removeItem(oc(this.persistenceKey,t))},Ac.prototype.Qi=function(t,e,n){this.Wi(t,e,n)},Ac.prototype.ji=function(t,e,n){var r=this;e.forEach(function(t){r.Mi(t)}),this.currentUser=t,n.forEach(function(t){r.xi(t)})},Ac.prototype.Ki=function(t){this.Gi(t)},Ac.prototype.Di=function(){this.Ei&&(this.window.removeEventListener("storage",this.wi),this.removeItem(this.Ai),this.Ei=!1)},Ac.prototype.getItem=function(t){var e=this.storage.getItem(t);return Nr("SharedClientState","READ",t,e),e},Ac.prototype.setItem=function(t,e){Nr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},Ac.prototype.removeItem=function(t){Nr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},Ac.prototype.mi=function(t){var e=this,s=t;if(s.storageArea===this.storage){if(Nr("SharedClientState","EVENT",s.key,s.newValue),s.key===this.Ai)return void Sr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.fn.Cs(function(){return y(e,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){if(this.Ei){if(null!==s.key)if(this.gi.test(s.key)){if(null==s.newValue)return e=this.zi(s.key),[2,this.Hi(e,null)];if(e=this.Yi(s.key,s.newValue))return[2,this.Hi(e.clientId,e)]}else if(this.Pi.test(s.key)){if(null!==s.newValue&&(n=this.Ji(s.key,s.newValue)))return[2,this.Xi(n)]}else if(this.yi.test(s.key)){if(null!==s.newValue&&(r=this.Zi(s.key,s.newValue)))return[2,this.tr(r)]}else if(s.key===this.Vi){if(null!==s.newValue&&(i=this.vi(s.newValue)))return[2,this.Si(i)]}else s.key===this.Ri&&(o=function(t){var e=ec.ai;if(null!=t)try{var n=JSON.parse(t);kr("number"==typeof n),e=n}catch(t){Sr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(s.newValue))!==ec.ai&&this.si(o)}else this.Ii.push(s);return[2]})})})}},Object.defineProperty(Ac.prototype,"Li",{get:function(){return this.Ti.get(this._i)},enumerable:!1,configurable:!0}),Ac.prototype.bi=function(){this.setItem(this.Ai,this.Li.ui())},Ac.prototype.$i=function(t,e,n){n=new sc(this.currentUser,t,e,n),t=ic(this.persistenceKey,this.currentUser,t),this.setItem(t,n.ui())},Ac.prototype.Mi=function(t){t=ic(this.persistenceKey,this.currentUser,t),this.removeItem(t)},Ac.prototype.Gi=function(t){t={clientId:this._i,onlineState:t},this.storage.setItem(this.Vi,JSON.stringify(t))},Ac.prototype.Wi=function(t,e,n){var r=oc(this.persistenceKey,t),n=new uc(t,e,n);this.setItem(r,n.ui())},Ac.prototype.zi=function(t){return(t=this.gi.exec(t))?t[1]:null},Ac.prototype.Yi=function(t,e){return t=this.zi(t),ac.ci(t,e)},Ac.prototype.Ji=function(t,e){var n=this.Pi.exec(t),t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return sc.ci(new $a(n),t,e)},Ac.prototype.Zi=function(t,e){return t=this.yi.exec(t),t=Number(t[1]),uc.ci(t,e)},Ac.prototype.vi=function(t){return cc.ci(t)},Ac.prototype.Xi=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.fi.er(e.batchId,e.state,e.error)]:(Nr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},Ac.prototype.tr=function(t){return this.fi.nr(t.targetId,t.state,t.error)},Ac.prototype.Hi=function(t,e){var n=this,r=e?this.Ti.ot(t,e):this.Ti.remove(t),i=this.Ni(this.Ti),o=this.Ni(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.fi.sr(s,u).then(function(){n.Ti=r})},Ac.prototype.Si=function(t){this.Ti.get(t.clientId)&&this.di(t.onlineState)},Ac.prototype.Ni=function(t){var n=co;return t.forEach(function(t,e){n=n.kt(e.activeTargetIds)}),n},Ac),lc=(_c.prototype.xi=function(t){},_c.prototype.ki=function(t,e,n){},_c.prototype.Oi=function(t){return this.ir.hi(t),this.rr[t]||"not-current"},_c.prototype.Qi=function(t,e,n){this.rr[t]=e},_c.prototype.Bi=function(t){this.ir.li(t)},_c.prototype.qi=function(t){return this.ir.activeTargetIds.has(t)},_c.prototype.Ui=function(t){delete this.rr[t]},_c.prototype.Ci=function(){return this.ir.activeTargetIds},_c.prototype.Fi=function(t){return this.ir.activeTargetIds.has(t)},_c.prototype.start=function(){return this.ir=new hc,Promise.resolve()},_c.prototype.ji=function(t,e,n){},_c.prototype.Ki=function(t){},_c.prototype.Di=function(){},_c.prototype.oi=function(t){},_c),pc=(Tc.prototype.cr=function(t,e,n){for(var r,i,o,s,u,a,c=n.ur,h=0;h<this.mutations.length;h++){var f=this.mutations[h];f.key.isEqual(t)&&(r=f,i=e,o=c[h],a=u=s=void 0,e=r instanceof Js?new wu(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof $s?(u=i,a=o,Hs((s=r).Ge,u)?(u=eu(s,u),new wu(s.key,a.version,u,{hasCommittedMutations:!0})):new Eu(s.key,a.version)):r instanceof ru?function(t,e,n){if(kr(null!=n.transformResults),!Hs(t.Ge,e))return new Eu(t.key,n.version);var r=e,e=function(t,e,n){var r=[];kr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof wu&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof Ns?Ls(o,s):o instanceof ks?Rs(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=ou(t,r.data(),e);return new wu(t.key,n,e,{hasCommittedMutations:!0})}(r,i,o):new bu(r.key,o.version,{hasCommittedMutations:!0}))}return e},Tc.prototype.hr=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Ks(i,e,e,this.ar))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Ks(a,e,o,this.ar))}return e},Tc.prototype.lr=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.hr(t.key,n.get(t.key));e&&(i=i.ot(t.key,e))}),i},Tc.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},ao())},Tc.prototype.isEqual=function(t){return this.batchId===t.batchId&&pi(this.mutations,t.mutations,Ws)&&pi(this.baseMutations,t.baseMutations,Ws)},Tc),dc=(Ic.from=function(t,e,n){kr(t.mutations.length===n.length);for(var r=so,i=t.mutations,o=0;o<i.length;o++)r=r.ot(i[o].key,n[o].version);return new Ic(t,e,n,r)},Ic),h=(Object.defineProperty(Ec.prototype,"readTime",{get:function(){return this.Tr},set:function(t){this.Tr=t},enumerable:!1,configurable:!0}),Ec.prototype.Er=function(t,e){this.Ir(),this.readTime=e,this.wr.set(t.key,t)},Ec.prototype.Ar=function(t,e){this.Ir(),e&&(this.readTime=e),this.wr.set(t,null)},Ec.prototype.Rr=function(t,e){this.Ir();var n=this.wr.get(e);return void 0!==n?Ia.resolve(n):this.gr(t,e)},Ec.prototype.getEntries=function(t,e){return this.Pr(t,e)},Ec.prototype.apply=function(t){return this.Ir(),this.mr=!0,this.yr(t)},Ec.prototype.Ir=function(){},Ec),yc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",be=(bc.prototype.pr=function(t){this.Vr.push(t)},bc.prototype.br=function(){this.Vr.forEach(function(t){return t()})},bc),vc=(wc.prototype.Cr=function(e,n){var r=this;return this.Sr.Nr(e,n).next(function(t){return r.Fr(e,n,t)})},wc.prototype.Fr=function(t,r,i){return this.vr.Rr(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].hr(r,t);return t})},wc.prototype.$r=function(t,e,i){var o=no;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].hr(t,e);o=o.ot(t,e)}),o},wc.prototype.kr=function(e,t){var n=this;return this.vr.getEntries(e,t).next(function(t){return n.Mr(e,t)})},wc.prototype.Mr=function(e,r){var i=this;return this.Sr.Or(e,r).next(function(t){var t=i.$r(e,r,t),n=no;return t.forEach(function(t,e){e=e||new bu(t,Si.min()),n=n.ot(t,e)}),n})},wc.prototype.Lr=function(t,e,n){return r=e,jr.F(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Br(t,e.path):Ou(e)?this.qr(t,e,n):this.Ur(t,e,n);var r},wc.prototype.Br=function(t,e){return this.Cr(t,new jr(e)).next(function(t){var e=oo;return t instanceof wu&&(e=e.ot(t.key,t)),e})},wc.prototype.qr=function(n,r,i){var o=this,s=r.collectionGroup,u=oo;return this.Dr.Qr(n,s).next(function(t){return Ia.forEach(t,function(t){var e=(e=r,t=t.child(s),new Iu(t,null,e.on.slice(),e.filters.slice(),e.limit,e.an,e.startAt,e.endAt));return o.Ur(n,e,i).next(function(t){t.forEach(function(t,e){u=u.ot(t,e)})})}).next(function(){return u})})},wc.prototype.Ur=function(e,n,t){var c,h,r=this;return this.vr.Lr(e,n,t).next(function(t){return c=t,r.Sr.Wr(e,n)}).next(function(t){return h=t,r.jr(e,h,c).next(function(t){c=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=Ks(s,a=c.get(u),a,r.ar);c=a instanceof wu?c.ot(u,a):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){qu(n,e)||(c=c.remove(t))}),c})},wc.prototype.jr=function(t,e,n){for(var r=ao(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof $s&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.vr.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof wu&&(c=c.ot(t,e))}),c})},wc),gc=(mc.zr=function(t,e){for(var n=ao(),r=ao(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new mc(t,e.fromCache,n,r)},mc);function mc(t,e,n,r){this.targetId=t,this.fromCache=e,this.Kr=n,this.Gr=r}function wc(t,e,n){this.vr=t,this.Sr=e,this.Dr=n}function bc(){this.Vr=[]}function Ec(){this.wr=new Ai(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.mr=!1}function Ic(t,e,n,r){this.batch=t,this._r=e,this.ur=n,this.dr=r}function Tc(t,e,n,r){this.batchId=t,this.ar=e,this.baseMutations=n,this.mutations=r}function _c(){this.ir=new hc,this.rr={},this.di=null,this.si=null}function Ac(t,e,n,r,i){this.window=t,this.fn=e,this.persistenceKey=n,this._i=r,this.fi=null,this.di=null,this.si=null,this.wi=this.mi.bind(this),this.Ti=new Wi(li),this.Ei=!1,this.Ii=[],n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),this.storage=this.window.localStorage,this.currentUser=i,this.Ai=rc(this.persistenceKey,this._i),this.Ri="firestore_sequence_number_"+this.persistenceKey,this.Ti=this.Ti.ot(this._i,new hc),this.gi=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.Pi=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.yi=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.Vi="firestore_online_state_"+this.persistenceKey,this.window.addEventListener("storage",this.wi)}function Nc(){this.activeTargetIds=co}function Sc(t,e){this.clientId=t,this.onlineState=e}function Dc(t,e){this.clientId=t,this.activeTargetIds=e}function Lc(t,e,n){this.targetId=t,this.state=e,this.error=n}function xc(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function kc(t,e){var n=t[0],r=t[1],t=e[0],e=e[1];return 0===(t=li(n,t))?li(r,e):t}var Oc=(Uc.prototype.Jr=function(){return++this.Yr},Uc.prototype.Xr=function(t){var e=[t,this.Jr()];this.buffer.size<this.Hr?this.buffer=this.buffer.add(e):kc(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(Uc.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),Uc),Rc={Zr:!1,eo:0,no:0,so:0},Pc=(Cc.ao=function(t){return new Cc(t,Cc.co,Cc.uo)},Cc);function Cc(t,e,n){this.io=t,this.ro=e,this.oo=n}function Uc(t){this.Hr=t,this.buffer=new to(kc),this.Yr=0}Pc.ho=-1,Pc.lo=1048576,Pc._o=41943040,Pc.co=10,Pc.uo=1e3,Pc.fo=new Pc(Pc._o,Pc.co,Pc.uo),Pc.do=new Pc(Pc.ho,0,0);var Vc=(jc.prototype.start=function(t){this.wo.params.io!==Pc.ho&&this.Eo(t)},jc.prototype.stop=function(){this.To&&(this.To.cancel(),this.To=null)},Object.defineProperty(jc.prototype,"Ei",{get:function(){return null!==this.To},enumerable:!1,configurable:!0}),jc.prototype.Eo=function(n){var t=this,e=this.mo?3e5:6e4;Nr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.To=this.cs.yn("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.To=null,this.mo=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.Io(this.wo)];case 2:return t.sent(),[3,7];case 3:return ka(e=t.sent())?(Nr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,yf(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.Eo(n)];case 8:return t.sent(),[2]}})})})},jc),Mc=(Fc.prototype.Ro=function(t,e){return this.Ao.Po(t).next(function(t){return Math.floor(e/100*t)})},Fc.prototype.yo=function(t,e){var n=this;if(0===e)return Ia.resolve(ec.ai);var r=new Oc(e);return this.Ao.Ce(t,function(t){return r.Xr(t.sequenceNumber)}).next(function(){return n.Ao.Vo(t,function(t){return r.Xr(t)})}).next(function(){return r.maxValue})},Fc.prototype.po=function(t,e,n){return this.Ao.po(t,e,n)},Fc.prototype.bo=function(t,e){return this.Ao.bo(t,e)},Fc.prototype.vo=function(e,n){var r=this;return this.params.io===Pc.ho?(Nr("LruGarbageCollector","Garbage collection skipped; disabled"),Ia.resolve(Rc)):this.So(e).next(function(t){return t<r.params.io?(Nr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.io),Rc):r.Do(e,n)})},Fc.prototype.So=function(t){return this.Ao.So(t)},Fc.prototype.Do=function(e,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.Ro(e,this.params.ro).next(function(t){return i=t>h.params.oo?(Nr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.oo+" from "+t),h.params.oo):t,s=Date.now(),h.yo(e,i)}).next(function(t){return r=t,u=Date.now(),h.po(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.bo(e,r)}).next(function(t){return c=Date.now(),Ar()<=l.DEBUG&&Nr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),Ia.resolve({Zr:!0,eo:i,no:o,so:t})})},Fc);function Fc(t,e){this.Ao=t,this.params=e}function jc(t,e){this.wo=t,this.cs=e,this.mo=!1,this.To=null}function qc(t){for(var o="",e=0;e<t.length;e++)0<o.length&&(o=Gc(o)),o=function(t){for(var e=o,n=t.length,r=0;r<n;r++){var i=t.charAt(r);switch(i){case"\0":e+="";break;case"":e+="";break;default:e+=i}}return e}(t.get(e));return Gc(o)}function Gc(t){return t+""}function Bc(t){var e=t.length;if(kr(2<=e),2===e)return kr(""===t.charAt(0)&&""===t.charAt(1)),Vr.P();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&xr(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:xr()}o=s+2}return new Vr(r)}var zc=function(t){this.Co=t};function Hc(t,e){if(e.document)return n=t.Co,r=e.document,i=!!e.hasCommittedMutations,t=ss(n,r.name),n=ns(r.updateTime),r=new hu({mapValue:{fields:r.fields}}),new wu(t,n,r,{hasCommittedMutations:!!i});var n,r;if(e.noDocument){var i=jr.$(e.noDocument.path),o=Yc(e.noDocument.readTime);return new bu(i,o,{hasCommittedMutations:!!e.hasCommittedMutations})}return e.unknownDocument?(o=jr.$(e.unknownDocument.path),e=Yc(e.unknownDocument.version),new Eu(o,e)):xr()}function Kc(t,e,n){var r=Wc(n),n=e.key.path.h().A();if(e instanceof wu){var i={name:os(i=t.Co,(o=e).key),fields:o.rn().mapValue.fields,updateTime:ts(i,o.version.Z())},o=e.hasCommittedMutations;return new xh(null,null,i,o,r,n)}if(e instanceof bu){var i=e.key.path.A(),o=Xc(e.version),s=e.hasCommittedMutations;return new xh(null,new Dh(i,o),null,s,r,n)}return e instanceof Eu?(s=e.key.path.A(),e=Xc(e.version),new xh(new Lh(s,e),null,null,!0,r,n)):xr()}function Wc(t){return[(t=t.Z()).seconds,t.nanoseconds]}function Qc(t){return t=new Ni(t[0],t[1]),Si.J(t)}function Xc(t){return t=t.Z(),new wh(t.seconds,t.nanoseconds)}function Yc(t){return t=new Ni(t.seconds,t.nanoseconds),Si.J(t)}function Jc(e,t){var n=(t.baseMutations||[]).map(function(t){return ps(e.Co,t)}),r=t.mutations.map(function(t){return ps(e.Co,t)}),i=Ni.fromMillis(t.localWriteTimeMs);return new pc(t.batchId,i,n,r)}function $c(t){var e=Yc(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?Yc(t.lastLimboFreeSnapshotVersion):Si.min(),r=void 0!==t.query.documents?(kr(1===(r=t.query).documents.length),Pu(Su(as(r.documents[0])))):vs(t.query);return new Bi(r,t.targetId,0,t.lastListenSequenceNumber,e,n,yi.fromBase64String(t.resumeToken))}function Zc(t,e){var n=Xc(e.nt),r=Xc(e.lastLimboFreeSnapshotVersion),i=(ji(e.target)?ds:ys)(t.Co,e.target),t=e.resumeToken.toBase64();return new Oh(e.targetId,Mi(e.target),n,t,e.sequenceNumber,r,i)}var th=(eh.xo=function(t,e,n,r){return kr(""!==t.uid),new eh(t.Zs()?t.uid:"",e,n,r)},eh.prototype.$o=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ih(t).rs({index:Ah.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},eh.prototype.ko=function(d,y,v,g){var m=this,w=oh(d),b=ih(d);return b.add({}).next(function(t){kr("number"==typeof t);for(var e,n,r,i,o,s=new pc(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return ls(e.Co,t)}),o=r.mutations.map(function(t){return ls(e.Co,t)}),new Ah(n,r.batchId,r.ar.toMillis(),i,o)),a=[],c=new to(function(t,e){return li(t.R(),e.R())}),h=0,f=g;h<f.length;h++){var l=f[h],p=Nh.key(m.userId,l.key.path,t),c=c.add(l.key.path.h());a.push(b.put(u)),a.push(w.put(p,Nh.PLACEHOLDER))}return c.forEach(function(t){a.push(m.Dr.Mo(d,t))}),d.pr(function(){m.Fo[t]=s.keys()}),Ia.$n(a).next(function(){return s})})},eh.prototype.Oo=function(t,e){var n=this;return ih(t).get(e).next(function(t){return t?(kr(t.userId===n.userId),Jc(n.serializer,t)):null})},eh.prototype.Lo=function(t,e){var n=this;return this.Fo[e]?Ia.resolve(this.Fo[e]):this.Oo(t,e).next(function(t){return t?(t=t.keys(),n.Fo[e]=t):null})},eh.prototype.Bo=function(t,e){var r=this,i=e+1,e=IDBKeyRange.lowerBound([this.userId,i]),o=null;return ih(t).rs({index:Ah.userMutationsIndex,range:e},function(t,e,n){e.userId===r.userId&&(kr(e.batchId>=i),o=Jc(r.serializer,e)),n.done()}).next(function(){return o})},eh.prototype.qo=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return ih(t).rs({index:Ah.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},eh.prototype.Uo=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ih(t).ts(Ah.userMutationsIndex,n).next(function(t){return t.map(function(t){return Jc(e.serializer,t)})})},eh.prototype.Nr=function(o,s){var u=this,t=Nh.prefixForPath(this.userId,s.path),t=IDBKeyRange.lowerBound(t),a=[];return oh(o).rs({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Bc(i);if(r===u.userId&&s.path.isEqual(i))return ih(o).get(t).next(function(t){if(!t)throw xr();kr(t.userId===u.userId),a.push(Jc(u.serializer,t))});n.done()}).next(function(){return a})},eh.prototype.Or=function(e,t){var s=this,u=new to(li),n=[];return t.forEach(function(o){var t=Nh.prefixForPath(s.userId,o.path),t=IDBKeyRange.lowerBound(t),t=oh(e).rs({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Bc(i);r===s.userId&&o.path.isEqual(i)?u=u.add(t):n.done()});n.push(t)}),Ia.$n(n).next(function(){return s.Qo(e,u)})},eh.prototype.Wr=function(t,e){var o=this,s=e.path,u=s.length+1,e=Nh.prefixForPath(this.userId,s),e=IDBKeyRange.lowerBound(e),a=new to(li);return oh(t).rs({range:e},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Bc(i);r===o.userId&&s.T(i)?i.length===u&&(a=a.add(t)):n.done()}).next(function(){return o.Qo(t,a)})},eh.prototype.Qo=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(ih(e).get(t).next(function(t){if(null===t)throw xr();kr(t.userId===n.userId),r.push(Jc(n.serializer,t))}))}),Ia.$n(i).next(function(){return r})},eh.prototype.Wo=function(e,n){var r=this;return rh(e.jo,this.userId,n).next(function(t){return e.pr(function(){r.Ko(n.batchId)}),Ia.forEach(t,function(t){return r.No.Go(e,t)})})},eh.prototype.Ko=function(t){delete this.Fo[t]},eh.prototype.zo=function(e){var i=this;return this.$o(e).next(function(t){if(!t)return Ia.resolve();var t=IDBKeyRange.lowerBound(Nh.prefixForUser(i.userId)),r=[];return oh(e).rs({range:t},function(t,e,n){t[0]===i.userId?(t=Bc(t[1]),r.push(t)):n.done()}).next(function(){kr(0===r.length)})})},eh.prototype.Ho=function(t,e){return nh(t,this.userId,e)},eh.prototype.Yo=function(t){var e=this;return sh(t).get(this.userId).next(function(t){return t||new _h(e.userId,-1,"")})},eh);function eh(t,e,n,r){this.userId=t,this.serializer=e,this.Dr=n,this.No=r,this.Fo={}}function nh(t,o,e){var s=(e=Nh.prefixForPath(o,e.path))[1],e=IDBKeyRange.lowerBound(e),u=!1;return oh(t).rs({range:e,ss:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function rh(t,e,n){var r=t.store(Ah.store),i=t.store(Nh.store),o=[],t=IDBKeyRange.only(n.batchId),s=0,t=r.rs({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){kr(1===s)}));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],f=Nh.key(e,h.key.path,n.batchId);o.push(i.delete(f)),u.push(h.key)}return Ia.$n(o).next(function(){return u})}function ih(t){return $h.Qn(t,Ah.store)}function oh(t){return $h.Qn(t,Nh.store)}function sh(t){return $h.Qn(t,_h.store)}var uh,ah=(fh.prototype.Er=function(t,e,n){return ph(t).put(dh(e),n)},fh.prototype.Ar=function(t,e){return t=ph(t),e=dh(e),t.delete(e)},fh.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.Jo(e,t)})},fh.prototype.Rr=function(t,e){var n=this;return ph(t).get(dh(e)).next(function(t){return n.Xo(t)})},fh.prototype.Zo=function(t,e){var n=this;return ph(t).get(dh(e)).next(function(t){var e=n.Xo(t);return e?{ta:e,size:yh(t)}:null})},fh.prototype.getEntries=function(t,e){var n=this,r=no;return this.ea(t,e,function(t,e){e=n.Xo(e),r=r.ot(t,e)}).next(function(){return r})},fh.prototype.na=function(t,e){var r=this,i=no,o=new Wi(jr.i);return this.ea(t,e,function(t,e){var n=r.Xo(e);o=n?(i=i.ot(t,n),o.ot(t,yh(e))):(i=i.ot(t,null),o.ot(t,0))}).next(function(){return{sa:i,ia:o}})},fh.prototype.ea=function(t,e,i){if(e.m())return Ia.resolve();var n=IDBKeyRange.bound(e.first().path.A(),e.last().path.A()),o=e._t(),s=o.It();return ph(t).rs({range:n},function(t,e,n){for(var r=jr.$(t);s&&jr.i(s,r)<0;)i(s,null),s=o.It();s&&s.isEqual(r)&&(i(s,e),s=o.At()?o.It():null),s?n.Xn(s.path.A()):n.done()}).next(function(){for(;s;)i(s,null),s=o.At()?o.It():null})},fh.prototype.Lr=function(t,r,e){var n,i=this,o=oo,s=r.path.length+1,u={};return e.isEqual(Si.min())?(n=r.path.A(),u.range=IDBKeyRange.lowerBound(n)):(n=r.path.A(),e=Wc(e),u.range=IDBKeyRange.lowerBound([n,e],!0),u.index=xh.collectionReadTimeIndex),ph(t).rs(u,function(t,e,n){t.length===s&&(e=Hc(i.serializer,e),r.path.T(e.key.path)?e instanceof wu&&qu(r,e)&&(o=o.ot(e.key,e)):n.done())}).next(function(){return o})},fh.prototype.ra=function(t){return new ch(this,!!t&&t.oa)},fh.prototype.aa=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},fh.prototype.getMetadata=function(t){return lh(t).get(kh.key).next(function(t){return kr(!!t),t})},fh.prototype.Jo=function(t,e){return lh(t).put(kh.key,e)},fh.prototype.Xo=function(t){return!t||(t=Hc(this.serializer,t))instanceof bu&&t.version.isEqual(Si.min())?null:t},fh),ch=(n(hh,uh=h),hh.prototype.yr=function(i){var o=this,s=[],u=0,a=new to(function(t,e){return li(t.R(),e.R())});return this.wr.forEach(function(t,e){var n,r=o.ua.get(t);e?(n=Kc(o.ca.serializer,e,o.readTime),a=a.add(t.path.h()),e=yh(n),u+=e-r,s.push(o.ca.Er(i,t,n))):(u-=r,o.oa?(r=Kc(o.ca.serializer,new bu(t,Si.min()),o.readTime),s.push(o.ca.Er(i,t,r))):s.push(o.ca.Ar(i,t)))}),a.forEach(function(t){s.push(o.ca.Dr.Mo(i,t))}),s.push(this.ca.updateMetadata(i,u)),Ia.$n(s)},hh.prototype.gr=function(t,e){var n=this;return this.ca.Zo(t,e).next(function(t){return null===t?(n.ua.set(e,0),null):(n.ua.set(e,t.size),t.ta)})},hh.prototype.Pr=function(t,e){var n=this;return this.ca.na(t,e).next(function(t){var e=t.sa;return t.ia.forEach(function(t,e){n.ua.set(t,e)}),e})},hh);function hh(t,e){var n=this;return(n=uh.call(this)||this).ca=t,n.oa=e,n.ua=new Ai(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function fh(t,e){this.serializer=t,this.Dr=e}function lh(t){return $h.Qn(t,kh.store)}function ph(t){return $h.Qn(t,xh.store)}function dh(t){return t.path.A()}function yh(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw xr();e=t.noDocument}return JSON.stringify(e).length}var vh=(Th.prototype.Mo=function(t,e){return this.ha.add(e),Ia.resolve()},Th.prototype.Qr=function(t,e){return Ia.resolve(this.ha.getEntries(e))},Th),gh=(Ih.prototype.add=function(t){var e=t._(),n=t.h(),r=this.index[e]||new to(Vr.i),t=!r.has(n);return this.index[e]=r.add(n),t},Ih.prototype.has=function(t){var e=t._(),t=t.h();return(e=this.index[e])&&e.has(t)},Ih.prototype.getEntries=function(t){return(this.index[t]||new to(Vr.i)).A()},Ih),mh=(Eh.prototype.createOrUpgrade=function(e,n,t,r){var i=this;kr(t<r&&0<=t&&r<=10);var o=new Oa("createOrUpgrade",n);t<1&&1<=r&&(e.createObjectStore(bh.store),(s=e).createObjectStore(_h.store,{keyPath:_h.keyPath}),s.createObjectStore(Ah.store,{keyPath:Ah.keyPath,autoIncrement:!0}).createIndex(Ah.userMutationsIndex,Ah.userMutationsKeyPath,{unique:!0}),s.createObjectStore(Nh.store),Uh(e),e.createObjectStore(xh.store));var s,u=Ia.resolve();return t<3&&3<=r&&(0!==t&&((s=e).deleteObjectStore(Rh.store),s.deleteObjectStore(Oh.store),s.deleteObjectStore(Ph.store),Uh(e)),u=u.next(function(){return t=o.store(Ph.store),e=new Ph(0,0,Si.min().Z(),0),t.put(Ph.key,e);var t,e})),t<4&&4<=r&&(0!==t&&(u=u.next(function(){return n=e,(r=o).store(Ah.store).ts().next(function(t){n.deleteObjectStore(Ah.store),n.createObjectStore(Ah.store,{keyPath:Ah.keyPath,autoIncrement:!0}).createIndex(Ah.userMutationsIndex,Ah.userMutationsKeyPath,{unique:!0});var e=r.store(Ah.store),t=t.map(function(t){return e.put(t)});return Ia.$n(t)});var n,r})),u=u.next(function(){e.createObjectStore(Vh.store,{keyPath:Vh.keyPath})})),t<5&&5<=r&&(u=u.next(function(){return i.removeAcknowledgedMutations(o)})),t<6&&6<=r&&(u=u.next(function(){return e.createObjectStore(kh.store),i.addDocumentGlobal(o)})),t<7&&7<=r&&(u=u.next(function(){return i.ensureSequenceNumbers(o)})),t<8&&8<=r&&(u=u.next(function(){return i.createCollectionParentIndex(e,o)})),t<9&&9<=r&&(u=u.next(function(){var t;(t=e).objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(t=n.objectStore(xh.store)).createIndex(xh.readTimeIndex,xh.readTimeIndexPath,{unique:!1}),t.createIndex(xh.collectionReadTimeIndex,xh.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=r&&(u=u.next(function(){return i.rewriteCanonicalIds(o)})),u},Eh.prototype.addDocumentGlobal=function(e){var n=0;return e.store(xh.store).rs(function(t,e){n+=yh(e)}).next(function(){var t=new kh(n);return e.store(kh.store).put(kh.key,t)})},Eh.prototype.removeAcknowledgedMutations=function(n){var r=this,t=n.store(_h.store),i=n.store(Ah.store);return t.ts().next(function(t){return Ia.forEach(t,function(e){var t=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return i.ts(Ah.userMutationsIndex,t).next(function(t){return Ia.forEach(t,function(t){return kr(t.userId===e.userId),t=Jc(r.serializer,t),rh(n,e.userId,t).next(function(){})})})})})},Eh.prototype.ensureSequenceNumbers=function(t){var o=t.store(Rh.store),e=t.store(xh.store);return t.store(Ph.store).get(Ph.key).next(function(r){var i=[];return e.rs(function(t,e){var n=new Vr(t),t=[0,qc(n)];i.push(o.get(t).next(function(t){return t?Ia.resolve():o.put(new Rh(0,qc(n),r.highestListenSequenceNumber))}))}).next(function(){return Ia.$n(i)})})},Eh.prototype.createCollectionParentIndex=function(t,e){function r(t){if(i.add(t)){var e=t._(),t=t.h();return n.put({collectionId:e,parent:qc(t)})}}t.createObjectStore(Ch.store,{keyPath:Ch.keyPath});var n=e.store(Ch.store),i=new gh;return e.store(xh.store).rs({ss:!0},function(t,e){return r((t=new Vr(t)).h())}).next(function(){return e.store(Nh.store).rs({ss:!0},function(t,e){t[0];var n=t[1];return r((n=(t[2],Bc(n))).h())})})},Eh.prototype.rewriteCanonicalIds=function(t){var n=this,r=t.store(Oh.store);return r.rs(function(t,e){return e=$c(e),e=Zc(n.serializer,e),r.put(e)})},Eh),wh=function(t,e){this.seconds=t,this.nanoseconds=e},bh=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function Eh(t){this.serializer=t}function Ih(){this.index={}}function Th(){this.ha=new gh}bh.store="owner",bh.key="owner";var _h=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};_h.store="mutationQueues",_h.keyPath="userId";var Ah=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Ah.store="mutations",Ah.keyPath="batchId",Ah.userMutationsIndex="userMutationsIndex",Ah.userMutationsKeyPath=["userId","batchId"];var Nh=(Sh.prefixForUser=function(t){return[t]},Sh.prefixForPath=function(t,e){return[t,qc(e)]},Sh.key=function(t,e,n){return[t,qc(e),n]},Sh);function Sh(){}Nh.store="documentMutations",Nh.PLACEHOLDER=new Nh;var Dh=function(t,e){this.path=t,this.readTime=e},Lh=function(t,e){this.path=t,this.version=e},xh=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};xh.store="remoteDocuments",xh.readTimeIndex="readTimeIndex",xh.readTimeIndexPath="readTime",xh.collectionReadTimeIndex="collectionReadTimeIndex",xh.collectionReadTimeIndexPath=["parentPath","readTime"];var kh=function(t){this.byteSize=t};kh.store="remoteDocumentGlobal",kh.key="remoteDocumentGlobalKey";var Oh=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Oh.store="targets",Oh.keyPath="targetId",Oh.queryTargetsIndexName="queryTargetsIndex",Oh.queryTargetsKeyPath=["canonicalId","targetId"];var Rh=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Rh.store="targetDocuments",Rh.keyPath=["targetId","path"],Rh.documentTargetsIndex="documentTargetsIndex",Rh.documentTargetsKeyPath=["path","targetId"];var Ph=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Ph.key="targetGlobalKey",Ph.store="targetGlobal";var Ch=function(t,e){this.collectionId=t,this.parent=e};function Uh(t){t.createObjectStore(Rh.store,{keyPath:Rh.keyPath}).createIndex(Rh.documentTargetsIndex,Rh.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Oh.store,{keyPath:Oh.keyPath}).createIndex(Oh.queryTargetsIndexName,Oh.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Ph.store)}Ch.store="collectionParents",Ch.keyPath=["collectionId","parent"];var Vh=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Vh.store="clientMetadata",Vh.keyPath="clientId";var Mh=i(i(i([_h.store,Ah.store,Nh.store,xh.store,Oh.store,bh.store,Ph.store,Rh.store],[Vh.store]),[kh.store]),[Ch.store]),Fh=(jh.prototype.Mo=function(t,e){var n=this;if(this.la.has(e))return Ia.resolve();var r=e._(),i=e.h();return t.pr(function(){n.la.add(e)}),i={collectionId:r,parent:qc(i)},qh(t).put(i)},jh.prototype.Qr=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[di(i),""],!1,!0);return qh(t).ts(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(Bc(r.parent))}return o})},jh);function jh(){this.la=new gh}function qh(t){return $h.Qn(t,Ch.store)}var Gh=(Hh.prototype.next=function(){return this._a+=2,this._a},Hh.fa=function(){return new Hh(0)},Hh.da=function(){return new Hh(-1)},Hh),Bh=(zh.prototype.wa=function(n){var r=this;return this.ma(n).next(function(t){var e=new Gh(t.highestTargetId);return t.highestTargetId=e.next(),r.Ta(n,t).next(function(){return t.highestTargetId})})},zh.prototype.Ea=function(t){return this.ma(t).next(function(t){return Si.J(new Ni(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},zh.prototype.Ia=function(t){return this.ma(t).next(function(t){return t.highestListenSequenceNumber})},zh.prototype.Aa=function(e,n,r){var i=this;return this.ma(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.Z()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.Ta(e,t)})},zh.prototype.Ra=function(e,n){var r=this;return this.ga(e,n).next(function(){return r.ma(e).next(function(t){return t.targetCount+=1,r.Pa(n,t),r.Ta(e,t)})})},zh.prototype.ya=function(t,e){return this.ga(t,e)},zh.prototype.Va=function(e,t){var n=this;return this.pa(e,t.targetId).next(function(){return Kh(e).delete(t.targetId)}).next(function(){return n.ma(e)}).next(function(t){return kr(0<t.targetCount),--t.targetCount,n.Ta(e,t)})},zh.prototype.po=function(n,r,i){var o=this,s=0,u=[];return Kh(n).rs(function(t,e){(e=$c(e)).sequenceNumber<=r&&null===i.get(e.targetId)&&(s++,u.push(o.Va(n,e)))}).next(function(){return Ia.$n(u)}).next(function(){return s})},zh.prototype.Ce=function(t,n){return Kh(t).rs(function(t,e){e=$c(e),n(e)})},zh.prototype.ma=function(t){return Wh(t).get(Ph.key).next(function(t){return kr(null!==t),t})},zh.prototype.Ta=function(t,e){return Wh(t).put(Ph.key,e)},zh.prototype.ga=function(t,e){return Kh(t).put(Zc(this.serializer,e))},zh.prototype.Pa=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},zh.prototype.ba=function(t){return this.ma(t).next(function(t){return t.targetCount})},zh.prototype.va=function(t,r){var e=Mi(r),e=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),i=null;return Kh(t).rs({range:e,index:Oh.queryTargetsIndexName},function(t,e,n){e=$c(e),Fi(r,e.target)&&(i=e,n.done())}).next(function(){return i})},zh.prototype.Sa=function(n,t,r){var i=this,o=[],s=Qh(n);return t.forEach(function(t){var e=qc(t.path);o.push(s.put(new Rh(r,e))),o.push(i.No.Da(n,r,t))}),Ia.$n(o)},zh.prototype.Ca=function(n,t,r){var i=this,o=Qh(n);return Ia.forEach(t,function(t){var e=qc(t.path);return Ia.$n([o.delete([r,e]),i.No.Na(n,r,t)])})},zh.prototype.pa=function(t,e){return t=Qh(t),e=IDBKeyRange.bound([e],[e+1],!1,!0),t.delete(e)},zh.prototype.Fa=function(t,e){var e=IDBKeyRange.bound([e],[e+1],!1,!0),t=Qh(t),r=ao();return t.rs({range:e,ss:!0},function(t,e,n){t=Bc(t[1]),t=new jr(t),r=r.add(t)}).next(function(){return r})},zh.prototype.Ho=function(t,e){var e=qc(e.path),e=IDBKeyRange.bound([e],[di(e)],!1,!0),i=0;return Qh(t).rs({index:Rh.documentTargetsIndex,ss:!0,range:e},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},zh.prototype.Ue=function(t,e){return Kh(t).get(e).next(function(t){return t?$c(t):null})},zh);function zh(t,e){this.No=t,this.serializer=e}function Hh(t){this._a=t}function Kh(t){return $h.Qn(t,Oh.store)}function Wh(t){return $h.Qn(t,Ph.store)}function Qh(t){return $h.Qn(t,Rh.store)}var Xh,Yh="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Jh=(n(tf,Xh=be),tf),$h=(Zh.Qn=function(t,e){if(t instanceof Jh)return Ta.Qn(t.jo,e);throw xr()},Zh.prototype.start=function(){var e=this;return this.za().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Ir(Er.FAILED_PRECONDITION,Yh);return e.Ha(),e.Ya(),e.Ja(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.Ka.Ia(t)})}).then(function(t){e.Ma=new ec(t,e.$a)}).then(function(){e.Oa=!0}).catch(function(t){return e.ja&&e.ja.close(),Promise.reject(t)})},Zh.prototype.Xa=function(n){var t=this;return this.Qa=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.Ei?[2,n(e)]:[2]})})},n(this.isPrimary)},Zh.prototype.Za=function(n){var t=this;this.ja.Kn(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},Zh.prototype.tc=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.fn.ws(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Ei?[4,this.za()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},Zh.prototype.za=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return nf(e).put(new Vh(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.ec(e).next(function(t){t||(n.isPrimary=!1,n.fn.Cs(function(){return n.Qa(!1)}))})}).next(function(){return n.nc(e)}).next(function(t){return n.isPrimary&&!t?n.sc(e).next(function(){return!1}):!!t&&n.ic(e).next(function(){return!0})})}).catch(function(t){if(ka(t))return Nr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Nr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.fn.Cs(function(){return n.Qa(t)}),n.isPrimary=t})},Zh.prototype.ec=function(t){var e=this;return ef(t).get(bh.key).next(function(t){return Ia.resolve(e.rc(t))})},Zh.prototype.oc=function(t){return nf(t).delete(this.clientId)},Zh.prototype.ac=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.cc(this.Ua,18e5)?[3,2]:(this.Ua=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=Zh.Qn(t,Vh.store);return r.ts().next(function(t){var e=o.uc(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return Ia.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.Ga)for(n=0,r=e;n<r.length;n++)i=r[n],this.Ga.removeItem(this.hc(i.clientId));t.label=2;case 2:return[2]}})})},Zh.prototype.Ja=function(){var t=this;this.qa=this.fn.yn("client_metadata_refresh",4e3,function(){return t.za().then(function(){return t.ac()}).then(function(){return t.Ja()})})},Zh.prototype.rc=function(t){return!!t&&t.ownerId===this.clientId},Zh.prototype.nc=function(e){var r=this;return this.ka?Ia.resolve(!0):ef(e).get(bh.key).next(function(t){if(null!==t&&r.cc(t.leaseTimestampMs,5e3)&&!r.lc(t.ownerId)){if(r.rc(t)&&r.networkEnabled)return!0;if(!r.rc(t)){if(!t.allowTabSynchronization)throw new Ir(Er.FAILED_PRECONDITION,Yh);return!1}}return!(!r.networkEnabled||!r.inForeground)||nf(e).ts().next(function(t){return void 0===r.uc(t,5e3).find(function(t){if(r.clientId!==t.clientId){var e=!r.networkEnabled&&t.networkEnabled,n=!r.inForeground&&t.inForeground,t=r.networkEnabled===t.networkEnabled;if(e||n&&t)return!0}return!1})})}).next(function(t){return r.isPrimary!==t&&Nr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},Zh.prototype.Di=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return this.Oa=!1,this._c(),this.qa&&(this.qa.cancel(),this.qa=null),this.fc(),this.dc(),[4,this.ja.runTransaction("shutdown","readwrite",[bh.store,Vh.store],function(t){var e=new Jh(t,ec.ai);return n.sc(e).next(function(){return n.oc(e)})})];case 1:return t.sent(),this.ja.close(),this.wc(),[2]}})})},Zh.prototype.uc=function(t,e){var n=this;return t.filter(function(t){return n.cc(t.updateTimeMs,e)&&!n.lc(t.clientId)})},Zh.prototype.pi=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return nf(t).ts().next(function(t){return e.uc(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(Zh.prototype,"Ei",{get:function(){return this.Oa},enumerable:!1,configurable:!0}),Zh.prototype.mc=function(t){return th.xo(t,this.serializer,this.Dr,this.No)},Zh.prototype.Tc=function(){return this.Ka},Zh.prototype.Ec=function(){return this.vr},Zh.prototype.Ic=function(){return this.Dr},Zh.prototype.runTransaction=function(e,n,r){var i=this;Nr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.ja.runTransaction(e,t,Mh,function(t){return o=new Jh(t,i.Ma?i.Ma.next():ec.ai),"readwrite-primary"===n?i.ec(o).next(function(t){return!!t||i.nc(o)}).next(function(t){if(!t)throw Sr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.fn.Cs(function(){return i.Qa(!1)}),new Ir(Er.FAILED_PRECONDITION,yc);return r(o)}).next(function(t){return i.ic(o).next(function(){return t})}):i.Ac(o).next(function(){return r(o)})}).then(function(t){return o.br(),t})},Zh.prototype.Ac=function(t){var e=this;return ef(t).get(bh.key).next(function(t){if(null!==t&&e.cc(t.leaseTimestampMs,5e3)&&!e.lc(t.ownerId)&&!e.rc(t)&&!(e.ka||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Ir(Er.FAILED_PRECONDITION,Yh)})},Zh.prototype.ic=function(t){var e=new bh(this.clientId,this.allowTabSynchronization,Date.now());return ef(t).put(bh.key,e)},Zh.Ln=function(){return Ta.Ln()},Zh.prototype.sc=function(t){var e=this,n=ef(t);return n.get(bh.key).next(function(t){return e.rc(t)?(Nr("IndexedDbPersistence","Releasing primary lease."),n.delete(bh.key)):Ia.resolve()})},Zh.prototype.cc=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Sr("Detected an update time that is in the future: "+t+" > "+n),1))},Zh.prototype.Ha=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ba=function(){t.fn.ws(function(){return t.inForeground="visible"===t.document.visibilityState,t.za()})},this.document.addEventListener("visibilitychange",this.Ba),this.inForeground="visible"===this.document.visibilityState)},Zh.prototype.fc=function(){this.Ba&&(this.document.removeEventListener("visibilitychange",this.Ba),this.Ba=null)},Zh.prototype.Ya=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.La=function(){e._c(),e.fn.ws(function(){return e.Di()})},this.window.addEventListener("unload",this.La))},Zh.prototype.dc=function(){this.La&&(this.window.removeEventListener("unload",this.La),this.La=null)},Zh.prototype.lc=function(t){try{var e=null!==(null===(e=this.Ga)||void 0===e?void 0:e.getItem(this.hc(t)));return Nr("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return Sr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},Zh.prototype._c=function(){if(this.Ga)try{this.Ga.setItem(this.hc(this.clientId),String(Date.now()))}catch(t){Sr("Failed to set zombie client id.",t)}},Zh.prototype.wc=function(){if(this.Ga)try{this.Ga.removeItem(this.hc(this.clientId))}catch(t){}},Zh.prototype.hc=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},Zh);function Zh(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.fn=i,this.window=o,this.document=s,this.$a=a,this.ka=c,this.Ma=null,this.Oa=!1,this.isPrimary=!1,this.networkEnabled=!0,this.La=null,this.inForeground=!1,this.Ba=null,this.qa=null,this.Ua=Number.NEGATIVE_INFINITY,this.Qa=function(t){return Promise.resolve()},!Zh.Ln())throw new Ir(Er.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.No=new rf(this,r),this.Wa=e+"main",this.serializer=new zc(u),this.ja=new Ta(this.Wa,10,new mh(this.serializer)),this.Ka=new Bh(this.No,this.serializer),this.Dr=new Fh,this.vr=(e=this.serializer,u=this.Dr,new ah(e,u)),this.window&&this.window.localStorage?this.Ga=this.window.localStorage:(this.Ga=null,!1===c&&Sr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function tf(t,e){var n=this;return(n=Xh.call(this)||this).jo=t,n.xa=e,n}function ef(t){return $h.Qn(t,bh.store)}function nf(t){return $h.Qn(t,Vh.store)}var rf=(of.prototype.Po=function(t){var n=this.Rc(t);return this.db.Tc().ba(t).next(function(e){return n.next(function(t){return e+t})})},of.prototype.Rc=function(t){var e=0;return this.Vo(t,function(t){e++}).next(function(){return e})},of.prototype.Ce=function(t,e){return this.db.Tc().Ce(t,e)},of.prototype.Vo=function(t,n){return this.gc(t,function(t,e){return n(e)})},of.prototype.Da=function(t,e,n){return sf(t,n)},of.prototype.Na=function(t,e,n){return sf(t,n)},of.prototype.po=function(t,e,n){return this.db.Tc().po(t,e,n)},of.prototype.Go=sf,of.prototype.Pc=function(t,e){return r=e,i=!1,sh(n=t).os(function(t){return nh(n,t,r).next(function(t){return t&&(i=!0),Ia.resolve(!t)})}).next(function(){return i});var n,r,i},of.prototype.bo=function(n,r){var i=this,o=this.db.Ec().ra(),s=[],u=0;return this.gc(n,function(e,t){t<=r&&(t=i.Pc(n,e).next(function(t){if(!t)return u++,o.Rr(n,e).next(function(){return o.Ar(e),Qh(n).delete([0,qc(e.path)])})}),s.push(t))}).next(function(){return Ia.$n(s)}).next(function(){return o.apply(n)}).next(function(){return u})},of.prototype.removeTarget=function(t,e){return e=e.st(t.xa),this.db.Tc().ya(t,e)},of.prototype.yc=sf,of.prototype.gc=function(t,r){var i,t=Qh(t),o=ec.ai;return t.rs({index:Rh.documentTargetsIndex},function(t,e){var n=t[0],t=(t[1],e.path),e=e.sequenceNumber;0===n?(o!==ec.ai&&r(new jr(Bc(i)),o),o=e,i=t):o=ec.ai}).next(function(){o!==ec.ai&&r(new jr(Bc(i)),o)})},of.prototype.So=function(t){return this.db.Ec().aa(t)},of);function of(t,e){this.db=t,this.wo=new Mc(this,e)}function sf(t,e){return Qh(t).put((t=t.xa,new Rh(0,qc(e.path),t)))}function uf(t,e){var n=t.projectId;return t.j||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var af=(cf.prototype.Io=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.vo(t,n.bc)})},cf);function cf(t,e,n){this.persistence=t,this.Vc=e,this.bc=new Wi(li),this.vc=new Ai(Mi,Fi),this.Sc=Si.min(),this.Sr=t.mc(n),this.Dc=t.Ec(),this.Ka=t.Tc(),this.Cc=new vc(this.Dc,this.Sr,this.persistence.Ic()),this.Vc.Nc(this.Cc)}function hf(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Ka.Ea(t)})}function ff(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Ka.va(e,r).next(function(t){return t?(n=t,Ia.resolve(n)):i.Ka.wa(e).next(function(t){return n=new Bi(r,t,0,e.xa),i.Ka.Ra(e,n).next(function(){return n})})})}).then(function(t){var e=i.bc.get(t.targetId);return(null===e||0<t.nt.L(e.nt))&&(i.bc=i.bc.ot(t.targetId,t),i.vc.set(r,t.targetId)),t})}function lf(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).bc.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.No.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!ka(r=t.sent()))throw r;return Nr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.bc=e.bc.remove(o),e.vc.delete(n.target),[2]}})})}function pf(t,o,s){var u=t,a=Si.min(),c=ao();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=Pu(o),(void 0!==(t=(i=t).vc.get(r))?Ia.resolve(i.bc.get(t)):i.Ka.va(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.Ka.Fa(e,t.targetId).next(function(t){c=t})}).next(function(){return u.Vc.Lr(e,o,s?a:Si.min(),s?c:ao())}).next(function(t){return{documents:t,Fc:c}});var t,n,r,i})}function df(t,e){var n=t,r=n.Ka;return(t=n.bc.get(e))?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Ue(t,e).next(function(t){return t?t.target:null})})}function yf(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Er.FAILED_PRECONDITION||e.message!==yc)throw e;return Nr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function vf(t,e){this.user=e,this.type="OAuth",this.Kc={},this.Kc.Authorization="Bearer "+t}function gf(t,e,n,r,i){var o=this;this.ju=t,this.Ku=e,this.cs=n,this.Gu={},this.zu=[],this.Hu=new Map,this.Yu=new Set,this.Ju=[],this.Xu=i,this.Xu.Zu(function(t){n.ws(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Jf(this)?(Nr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Yu.add(4),[4,Bf(e)];case 1:return t.sent(),e.th.set("Unknown"),e.Yu.delete(4),[4,Gf(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.th=new xf(n,r)}var mf,wf,bf,Ef=(qf.prototype.m=function(){return this.$c.m()},qf.prototype.Da=function(t,e){e=new If(t,e),this.$c=this.$c.add(e),this.Mc=this.Mc.add(e)},qf.prototype.Lc=function(t,e){var n=this;t.forEach(function(t){return n.Da(t,e)})},qf.prototype.Na=function(t,e){this.Bc(new If(t,e))},qf.prototype.qc=function(t,e){var n=this;t.forEach(function(t){return n.Na(t,e)})},qf.prototype.Uc=function(t){var e=this,n=new jr(new Vr([])),r=new If(n,t),t=new If(n,t+1),i=[];return this.Mc.Ft([r,t],function(t){e.Bc(t),i.push(t.key)}),i},qf.prototype.Qc=function(){var e=this;this.$c.forEach(function(t){return e.Bc(t)})},qf.prototype.Bc=function(t){this.$c=this.$c.delete(t),this.Mc=this.Mc.delete(t)},qf.prototype.Wc=function(t){var e=new jr(new Vr([])),n=new If(e,t),t=new If(e,t+1),r=ao();return this.Mc.Ft([n,t],function(t){r=r.add(t.key)}),r},qf.prototype.Ho=function(t){var e=new If(t,0);return null!==(e=this.$c.$t(e))&&t.isEqual(e.key)},qf),If=(jf.kc=function(t,e){return jr.i(t.key,e.key)||li(t.jc,e.jc)},jf.Oc=function(t,e){return li(t.jc,e.jc)||jr.i(t.key,e.key)},jf),Tf=(Ff.prototype.getToken=function(){return Promise.resolve(null)},Ff.prototype.zc=function(){},Ff.prototype.Hc=function(t){(this.Gc=t)($a.UNAUTHENTICATED)},Ff.prototype.Yc=function(){this.Gc=null},Ff),_f=(Mf.prototype.getToken=function(){var e=this,n=this.Zc,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.Zc!==n?(Nr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(kr("string"==typeof t.accessToken),new vf(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Mf.prototype.zc=function(){this.forceRefresh=!0},Mf.prototype.Hc=function(t){this.Gc=t,this.Xc&&t(this.currentUser)},Mf.prototype.Yc=function(){this.auth&&this.auth.removeAuthTokenListener(this.Jc),this.Jc=null,this.Gc=null},Mf.prototype.tu=function(){var t=this.auth&&this.auth.getUid();return kr(null===t||"string"==typeof t),new $a(t)},Mf),Af=(Object.defineProperty(Vf.prototype,"Kc",{get:function(){var t={"X-Goog-AuthUser":this.nu},e=this.eu.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Vf),Nf=(Uf.prototype.getToken=function(){return Promise.resolve(new Af(this.eu,this.nu))},Uf.prototype.Hc=function(t){t($a.ni)},Uf.prototype.Yc=function(){},Uf.prototype.zc=function(){},Uf),Ee=(Cf.prototype.cu=function(){return 1===this.state||2===this.state||4===this.state},Cf.prototype.uu=function(){return 2===this.state},Cf.prototype.start=function(){3!==this.state?this.auth():this.hu()},Cf.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.cu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Cf.prototype.lu=function(){this.state=0,this.ys.reset()},Cf.prototype._u=function(){var t=this;this.uu()&&null===this.au&&(this.au=this.fn.yn(this.su,6e4,function(){return t.fu()}))},Cf.prototype.du=function(t){this.wu(),this.stream.send(t)},Cf.prototype.fu=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.uu()?[2,this.close(0)]:[2]})})},Cf.prototype.wu=function(){this.au&&(this.au.cancel(),this.au=null)},Cf.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.wu(),this.ys.cancel(),this.ou++,3!==e?this.ys.reset():n&&n.code===Er.RESOURCE_EXHAUSTED?(Sr(n.toString()),Sr("Using maximum backoff delay to prevent overloading the backend."),this.ys.Rn()):n&&n.code===Er.UNAUTHENTICATED&&this.ru.zc(),null!==this.stream&&(this.mu(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Tu(n)];case 1:return t.sent(),[2]}})})},Cf.prototype.mu=function(){},Cf.prototype.auth=function(){var n=this;this.state=1;var t=this.Eu(this.ou),e=this.ou;this.ru.getToken().then(function(t){n.ou===e&&n.Iu(t)},function(e){t(function(){var t=new Ir(Er.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Au(t)})})},Cf.prototype.Iu=function(t){var e=this,n=this.Eu(this.ou);this.stream=this.Ru(t),this.stream.gu(function(){n(function(){return e.state=2,e.listener.gu()})}),this.stream.Tu(function(t){n(function(){return e.Au(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Cf.prototype.hu=function(){var t=this;this.state=4,this.ys.gn(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},Cf.prototype.Au=function(t){return Nr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Cf.prototype.Eu=function(e){var n=this;return function(t){n.fn.ws(function(){return n.ou===e?t():(Nr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Cf),Sf=(n(Pf,bf=Ee),Pf.prototype.Ru=function(t){return this.iu.Pu("Listen",t)},Pf.prototype.onMessage=function(t){this.ys.reset();var e,n=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:xr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.Qe?(kr(void 0===o||"string"==typeof o),yi.fromBase64String(o||"")):(kr(void 0===o||o instanceof Uint8Array),yi.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Er.UNKNOWN:Ki(s.code),new Ir(o,s.message||"")),r=new mo(n,r,i,s||null)}else if("documentChange"in e){e.documentChange,(a=e.documentChange).document,a.document.name,a.document.updateTime;var i=ss(t,a.document.name),u=ns(a.document.updateTime),s=new hu({mapValue:{fields:a.document.fields}}),u=new wu(i,u,s,{}),s=a.targetIds||[],a=a.removedTargetIds||[];r=new vo(s,a,u.key,u)}else if("documentDelete"in e){e.documentDelete,(a=e.documentDelete).document;var u=ss(t,a.document),c=a.readTime?ns(a.readTime):Si.min(),c=new bu(u,c),a=a.removedTargetIds||[];r=new vo([],a,c.key,c)}else if("documentRemove"in e){e.documentRemove,(c=e.documentRemove).document;var h=ss(t,c.document),c=c.removedTargetIds||[];r=new vo([],c,h,null)}else{if(!("filter"in e))return xr();e.filter,(h=e.filter).targetId,e=new qi(e=h.count||0),h=h.targetId,r=new go(h,e)}return r}(this.serializer,t),t=!("targetChange"in(e=t))||(e=e.targetChange).targetIds&&e.targetIds.length||!e.readTime?Si.min():ns(e.readTime);return this.listener.yu(n,t)},Pf.prototype.Vu=function(t){var e,n,r,i,o={};o.database=cs(this.serializer),o.addTarget=(e=this.serializer,(r=ji(r=(n=t).target)?{documents:ds(e,r)}:{query:ys(e,r)}).targetId=n.targetId,0<n.resumeToken.O()&&(r.resumeToken=es(e,n.resumeToken)),r),(t=(this.serializer,i=t,null==(t=function(){switch(i.et){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return xr()}}())?null:{"goog-listen-tags":t}))&&(o.labels=t),this.du(o)},Pf.prototype.pu=function(t){var e={};e.database=cs(this.serializer),e.removeTarget=t,this.du(e)},Pf),Df=(n(Rf,wf=Ee),Object.defineProperty(Rf.prototype,"vu",{get:function(){return this.bu},enumerable:!1,configurable:!0}),Rf.prototype.start=function(){this.bu=!1,this.lastStreamToken=void 0,wf.prototype.start.call(this)},Rf.prototype.mu=function(){this.bu&&this.Su([])},Rf.prototype.Ru=function(t){return this.iu.Pu("Write",t)},Rf.prototype.onMessage=function(t){if(kr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.bu){this.ys.reset();var e=(n=t.writeResults,i=t.commitTime,n&&0<n.length?(kr(void 0!==i),n.map(function(t){return n=i,(r=(e=t).updateTime?ns(e.updateTime):ns(n)).isEqual(Si.min())&&(r=ns(n)),n=null,e.transformResults&&0<e.transformResults.length&&(n=e.transformResults),new Gs(r,n);var e,n,r})):[]),n=ns(t.commitTime);return this.listener.Du(n,e)}var i;return kr(!t.writeResults||0===t.writeResults.length),this.bu=!0,this.listener.Cu()},Rf.prototype.Nu=function(){var t={};t.database=cs(this.serializer),this.du(t)},Rf.prototype.Su=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return ls(e.serializer,t)})};this.du(t)},Rf),Lf=(n(Of,mf=function(){}),Of.prototype.xu=function(){if(this.Fu)throw new Ir(Er.FAILED_PRECONDITION,"The client has already been terminated.")},Of.prototype.$u=function(e,n,r){var i=this;return this.xu(),this.credentials.getToken().then(function(t){return i.iu.$u(e,n,r,t)}).catch(function(t){throw t.code===Er.UNAUTHENTICATED&&i.credentials.zc(),t})},Of.prototype.ku=function(e,n,r){var i=this;return this.xu(),this.credentials.getToken().then(function(t){return i.iu.ku(e,n,r,t)}).catch(function(t){throw t.code===Er.UNAUTHENTICATED&&i.credentials.zc(),t})},Of.prototype.terminate=function(){this.Fu=!1},Of),xf=(kf.prototype.Bu=function(){var t=this;0===this.Mu&&(this.qu("Unknown"),this.Ou=this.cs.yn("online_state_timeout",1e4,function(){return t.Ou=null,t.Uu("Backend didn't respond within 10 seconds."),t.qu("Offline"),Promise.resolve()}))},kf.prototype.Qu=function(t){"Online"===this.state?this.qu("Unknown"):(this.Mu++,1<=this.Mu&&(this.Wu(),this.Uu("Connection failed 1 times. Most recent error: "+t.toString()),this.qu("Offline")))},kf.prototype.set=function(t){this.Wu(),this.Mu=0,"Online"===t&&(this.Lu=!1),this.qu(t)},kf.prototype.qu=function(t){t!==this.state&&(this.state=t,this.di(t))},kf.prototype.Uu=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.Lu?(Sr(t),this.Lu=!1):Nr("OnlineStateTracker",t)},kf.prototype.Wu=function(){null!==this.Ou&&(this.Ou.cancel(),this.Ou=null)},kf);function kf(t,e){this.cs=t,this.di=e,this.state="Unknown",this.Mu=0,this.Ou=null,this.Lu=!0}function Of(t,e,n){var r=this;return(r=mf.call(this)||this).credentials=t,r.iu=e,r.serializer=n,r.Fu=!1,r}function Rf(t,e,n,r,i){var o=this;return(o=wf.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.bu=!1,o}function Pf(t,e,n,r,i){var o=this;return(o=bf.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Cf(t,e,n,r,i,o){this.fn=t,this.su=n,this.iu=r,this.ru=i,this.listener=o,this.state=0,this.ou=0,this.au=null,this.stream=null,this.ys=new Ea(t,e)}function Uf(t,e){this.eu=t,this.nu=e}function Vf(t,e){this.eu=t,this.nu=e,this.type="FirstParty",this.user=$a.ni}function Mf(t){var e=this;this.Jc=null,this.currentUser=$a.UNAUTHENTICATED,this.Xc=!1,this.Zc=0,this.Gc=null,this.forceRefresh=!1,this.Jc=function(){e.Zc++,e.currentUser=e.tu(),e.Xc=!0,e.Gc&&e.Gc(e.currentUser)},this.Zc=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Jc):(this.Jc(null),t.get().then(function(t){e.auth=t,e.Jc&&e.auth.addAuthTokenListener(e.Jc)},function(){}))}function Ff(){this.Gc=null}function jf(t,e){this.key=t,this.jc=e}function qf(){this.$c=new to(If.kc),this.Mc=new to(If.Oc)}function Gf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!Jf(r))return[3,4];e=0,n=r.Ju,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Bf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.Ju,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function zf(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Nr("RemoteStore","RemoteStore shutting down."),e.Yu.add(5),[4,Bf(e)];case 1:return t.sent(),e.Xu.Di(),e.th.set("Unknown"),[2]}})})}function Hf(t,e){t.Hu.has(e.targetId)||(t.Hu.set(e.targetId,e),Yf(t)?Xf(t):ol(t).uu()&&Wf(t,e))}function Kf(t,e){var n=t,t=ol(n);n.Hu.delete(e),t.uu()&&Qf(n,e),0===n.Hu.size&&(t.uu()?t._u():Jf(n)&&n.th.set("Unknown"))}function Wf(t,e){t.eh.Ie(e.targetId),ol(t).Vu(e)}function Qf(t,e){t.eh.Ie(e),ol(t).pu(e)}function Xf(e){e.eh=new bo({qe:function(t){return e.Gu.qe(t)},Ue:function(t){return e.Hu.get(t)||null}}),ol(e).start(),e.th.Bu()}function Yf(t){return Jf(t)&&!ol(t).cu()&&0<t.Hu.size}function Jf(t){return 0===t.Yu.size}function $f(t){t.eh=void 0}function Zf(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!ka(r))throw r;return n.Yu.add(1),[4,Bf(n)];case 1:return t.sent(),n.th.set("Offline"),i=i||function(){return hf(n.ju)},n.cs.Cs(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Nr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Yu.delete(1),[4,Gf(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function tl(e,n){return n().catch(function(t){return Zf(e,t,n)})}function el(h){return y(this,void 0,void 0,function(){var s,u,a,c;return v(this,function(t){switch(t.label){case 0:u=sl(s=h),a=0<s.zu.length?s.zu[s.zu.length-1].batchId:-1,t.label=1;case 1:if(!(Jf(s)&&s.zu.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(r=s.ju,i=a,(o=r).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===i&&(i=-1),o.Sr.Bo(t,i)}))];case 3:return null===(c=t.sent())?(0===s.zu.length&&u._u(),[3,7]):(a=c.batchId,n=c,(e=s).zu.push(n),(e=sl(e)).uu()&&e.vu&&e.Su(n.mutations),[3,6]);case 4:return c=t.sent(),[4,Zf(s,c)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return nl(s)&&rl(s),[2]}var e,n,r,i,o})})}function nl(t){return Jf(t)&&!sl(t).cu()&&0<t.zu.length}function rl(t){sl(t).start()}function il(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Yu.delete(2),[4,Gf(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Yu.add(2),[4,Bf(e)]);case 3:t.sent(),e.th.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function ol(n){var t,e,r,i=this;return n.oh||(n.oh=(t=n.Ku,e=n.cs,r={gu:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.Hu.forEach(function(t,e){Wf(n,t)}),[2]})})}.bind(null,n),Tu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return $f(e),Yf(e)?(e.th.Qu(n),Xf(e)):e.th.set("Unknown"),[2]})})}.bind(null,n),yu:function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.th.set("Online"),!(u instanceof mo&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Hu.has(i)?[4,o.Gu.nh(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Hu.delete(i),o.eh.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Nr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,Zf(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof vo?s.eh.be(u):u instanceof go?s.eh.$e(u):s.eh.De(u),a.isEqual(Si.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,hf(s.ju)];case 8:return o=t.sent(),0<=a.L(o)?[4,(i=a,(e=(r=s).eh.Oe(i)).zt.forEach(function(t,e){var n;0<t.resumeToken.O()&&(n=r.Hu.get(e))&&r.Hu.set(e,n.it(t.resumeToken,i))}),e.Ht.forEach(function(t){var e=r.Hu.get(t);e&&(r.Hu.set(t,e.it(yi.B,e.nt)),Qf(r,t),e=new Bi(e.target,t,1,e.sequenceNumber),Wf(r,e))}),r.Gu.sh(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Nr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,Zf(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n)},t.xu(),new Sf(e,t.iu,t.credentials,t.serializer,r)),n.Ju.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.oh.lu(),Yf(n)?Xf(n):n.th.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.oh.stop()];case 2:t.sent(),$f(n),t.label=3;case 3:return[2]}})})})),n.oh}function sl(n){var t,e,r,i=this;return n.ah||(n.ah=(t=n.Ku,e=n.cs,r={gu:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return sl(e).Nu(),[2]})})}.bind(null,n),Tu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&sl(e).vu?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Hi(n=i.code)&&n!==Er.ABORTED?(e=r.zu.shift(),sl(r).lu(),[4,tl(r,function(){return r.Gu.rh(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,el(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return nl(e)&&rl(e),[2]}})})}.bind(null,n),Cu:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=sl(o),n=0,r=o.zu;n<r.length;n++)i=r[n],e.Su(i.mutations);return[2]})})}.bind(null,n),Du:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.zu.shift(),n=dc.from(e,i,o),[4,tl(r,function(){return r.Gu.ih(n)})];case 1:return t.sent(),[4,el(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.xu(),new Df(e,t.iu,t.credentials,t.serializer,r)),n.Ju.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.ah.lu(),[4,el(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.ah.stop()];case 3:t.sent(),0<n.zu.length&&(Nr("RemoteStore","Stopping write stream with "+n.zu.length+" pending writes"),n.zu=[]),t.label=4;case 4:return[2]}})})})),n.ah}var ul=function(t){this.key=t},al=function(t){this.key=t},cl=(Object.defineProperty(dl.prototype,"dh",{get:function(){return this.uh},enumerable:!1,configurable:!0}),dl.prototype.wh=function(t,e){var s=this,u=e?e.mh:new fo,a=(e||this).fh,c=(e||this).Wt,h=a,f=!1,l=Du(this.query)&&a.size===this.query.limit?a.last():null,p=Lu(this.query)&&a.size===this.query.limit?a.first():null;if(t.ht(function(t,e){var n=a.get(t),r=(r=e instanceof wu?e:null)&&(qu(s.query,r)?r:null),i=!!n&&s.Wt.has(n.key),o=!!r&&(r.Je||s.Wt.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.Th(n,r)||(u.track({type:2,doc:r}),e=!0,(l&&0<s._h(r,l)||p&&s._h(r,p)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(l||p)&&(f=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),Du(this.query)||Lu(this.query))for(;h.size>this.query.limit;){var n=Du(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{fh:h,mh:u,Eh:f,Wt:c}},dl.prototype.Th=function(t,e){return t.Je&&e.hasCommittedMutations&&!e.Je},dl.prototype.yr=function(t,e,n){var o=this,r=this.fh;this.fh=t.fh,this.Wt=t.Wt;var i=t.mh.Ut();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o._h(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return xr()}}var r,i}),this.Ih(n);var s=e?this.Ah():[],e=(n=0===this.lh.size&&this.te?1:0)!==this.hh;return this.hh=n,0!==i.length||e?{snapshot:new lo(this.query,t.fh,r,i,t.Wt,0==n,e,!1),Rh:s}:{Rh:s}},dl.prototype.Qs=function(t){return this.te&&"Offline"===t?(this.te=!1,this.yr({fh:this.fh,mh:new fo,Wt:this.Wt,Eh:!1},!1)):{Rh:[]}},dl.prototype.gh=function(t){return!this.uh.has(t)&&!!this.fh.has(t)&&!this.fh.get(t).Je},dl.prototype.Ih=function(t){var e=this;t&&(t.ee.forEach(function(t){return e.uh=e.uh.add(t)}),t.ne.forEach(function(t){}),t.se.forEach(function(t){return e.uh=e.uh.delete(t)}),this.te=t.te)},dl.prototype.Ah=function(){var e=this;if(!this.te)return[];var n=this.lh;this.lh=ao(),this.fh.forEach(function(t){e.gh(t.key)&&(e.lh=e.lh.add(t.key))});var r=[];return n.forEach(function(t){e.lh.has(t)||r.push(new al(t))}),this.lh.forEach(function(t){n.has(t)||r.push(new ul(t))}),r},dl.prototype.Ph=function(t){return this.uh=t.Fc,this.lh=ao(),t=this.wh(t.documents),this.yr(t,!0)},dl.prototype.yh=function(){return lo.Gt(this.query,this.fh,this.Wt,0===this.hh)},dl),hl=function(t,e,n){this.query=t,this.targetId=e,this.view=n},fl=function(t){this.key=t,this.Vh=!1},ll=(Object.defineProperty(pl.prototype,"Uh",{get:function(){return!0===this.qh},enumerable:!1,configurable:!0}),pl);function pl(t,e,n,r,i,o){this.ju=t,this.ph=e,this.bh=n,this.Sh=r,this.currentUser=i,this.Dh=o,this.Ch={},this.Nh=new Ai(Fu,Mu),this.Fh=new Map,this.xh=[],this.$h=new Wi(jr.i),this.kh=new Map,this.Mh=new Ef,this.Oh={},this.Lh=new Map,this.Bh=Gh.da(),this.onlineState="Unknown",this.qh=void 0}function dl(t,e){this.query=t,this.uh=e,this.hh=null,this.te=!1,this.lh=ao(),this.Wt=ao(),this._h=Gu(t),this.fh=new ho(this._h)}function yl(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Qh=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.wh(o)).Eh?[4,pf(r.ju,i.query,!1).then(function(t){return t=t.documents,i.view.wh(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.zt.get(i.targetId),n=i.view.yr(e,r.Uh,n),[2,(Il(r,i.targetId,n.Rh),n.snapshot)]}})})}(i,t,e,n)},[4,pf(i.ju,o,!0)];case 1:return n=t.sent(),r=new cl(o,n.Fc),e=r.wh(n.documents),n=yo.Zt(s,u&&"Offline"!==i.onlineState),n=r.yr(e,i.Uh,n),Il(i,s,n.Rh),r=new hl(o,s,r),[2,(i.Nh.set(o,r),i.Fh.has(s)?i.Fh.get(s).push(o):i.Fh.set(s,[o]),n.snapshot)]}})})}function vl(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:n=i,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.ju,c=e,h=(a=o).nt,f=c.bc,c.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var i=c.Dc.ra({oa:!0});f=c.bc;var u=[];a.zt.forEach(function(t,e){var n,r,i,o=f.get(e);o&&(u.push(c.Ka.Ca(s,t.se,e).next(function(){return c.Ka.Sa(s,t.ee,e)})),0<(i=t.resumeToken).O()&&(n=o.it(i,h).st(s.xa),f=f.ot(e,n),r=o,i=t,kr(0<(o=n).resumeToken.O()),(0===r.resumeToken.O()||3e8<=o.nt.X()-r.nt.X()||0<i.ee.size+i.ne.size+i.se.size)&&u.push(c.Ka.ya(s,n))))});var t,o=no,n=ao();return a.Yt.forEach(function(t,e){n=n.add(t)}),u.push(i.getEntries(s,n).next(function(r){a.Yt.forEach(function(t,e){var n=r.get(t);e instanceof bu&&e.version.isEqual(Si.min())?(i.Ar(t,h),o=o.ot(t,e)):null==n||0<e.version.L(n.version)||0===e.version.L(n.version)&&n.hasPendingWrites?(i.Er(e,h),o=o.ot(t,e)):Nr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Jt.has(t)&&u.push(c.persistence.No.yc(s,t))})})),h.isEqual(Si.min())||(t=c.Ka.Ea(s).next(function(t){return c.Ka.Aa(s,s.xa,h)}),u.push(t)),Ia.$n(u).next(function(){return i.apply(s)}).next(function(){return c.Cc.Mr(s,o)})}).then(function(t){return c.bc=f,t}))];case 2:return r=t.sent(),o.zt.forEach(function(t,e){(e=n.kh.get(e))&&(kr(t.ee.size+t.ne.size+t.se.size<=1),0<t.ee.size?e.Vh=!0:0<t.ne.size?kr(e.Vh):0<t.se.size&&(kr(e.Vh),e.Vh=!1))}),[4,_l(n,r,o)];case 3:return t.sent(),[3,6];case 4:return[4,yf(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,a,c,h,f})})}function gl(t,n,e){var r;((t=t).Uh&&0===e||!t.Uh&&1===e)&&(r=[],t.Nh.forEach(function(t,e){(e=e.view.Qs(n)).snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.Bs.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Qs(i)&&(o=!0)}),o&&Ya(t)}(t.bh,n),r.length&&t.Ch.yu(r),t.onlineState=n,t.Uh&&t.Sh.Ki(n))}function ml(t,e){(t.Lh.get(e)||[]).forEach(function(t){t.resolve()}),t.Lh.delete(e)}function wl(t,e,n){var r=t,i=r.Oh[r.currentUser.ti()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.Oh[r.currentUser.ti()]=i)}function bl(e,t,n){void 0===n&&(n=null),e.Sh.Bi(t);for(var r=0,i=e.Fh.get(t);r<i.length;r++){var o=i[r];e.Nh.delete(o),n&&e.Ch.Wh(o,n)}e.Fh.delete(t),e.Uh&&e.Mh.Uc(t).forEach(function(t){e.Mh.Ho(t)||El(e,t)})}function El(t,e){var n=t.$h.get(e);null!==n&&(Kf(t.ph,n),t.$h=t.$h.remove(e),t.kh.delete(n),Tl(t))}function Il(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var u=s[o];u instanceof ul?(t.Mh.Da(u.key,e),r=t,i=(i=u).key,r.$h.get(i)||(Nr("SyncEngine","New document in limbo: "+i),r.xh.push(i),Tl(r))):u instanceof al?(Nr("SyncEngine","Document no longer in limbo: "+u.key),t.Mh.Na(u.key,e),t.Mh.Ho(u.key)||El(t,u.key)):xr()}}function Tl(t){for(;0<t.xh.length&&t.$h.size<t.Dh;){var e=t.xh.shift(),n=t.Bh.next();t.kh.set(n,new fl(e)),t.$h=t.$h.ot(e,n),Hf(t.ph,new Bi(Pu(Su(e.path)),n,2,ec.ai))}}function _l(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Nh.m()?[3,3]:(n.Nh.forEach(function(t,e){o.push(n.Qh(e,s,u).then(function(t){t&&(n.Uh&&n.Sh.Qi(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=gc.zr(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.Ch.yu(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Ia.forEach(c,function(e){return Ia.forEach(e.Kr,function(t){return r.persistence.No.Da(n,e.targetId,t)}).next(function(){return Ia.forEach(e.Gr,function(t){return r.persistence.No.Na(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!ka(e=t.sent()))throw e;return Nr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.bc.get(o),u=s.nt,u=s.rt(u),r.bc=r.bc.ot(o,u));return[2]}})})}(n.ju,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function Al(p,d){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l;return v(this,function(t){switch(t.label){case 0:e=p,n=[],r=[],i=0,o=d,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.Fh.get(s))&&0!==a.length?[4,ff(e.ju,Pu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(f=h[c],f=e.Nh.get(f),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,pf((e=r).ju,i.query,!0)];case 1:return n=t.sent(),n=i.view.Ph(n),[2,(e.Uh&&Il(e,i.targetId,n.Rh),n)]}})})}(e,f)]):[3,6];case 4:(f=t.sent()).snapshot&&r.push(f.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,df(e.ju,s)];case 8:return l=t.sent(),[4,ff(e.ju,l)];case 9:return u=t.sent(),[4,yl(e,Nl(l),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.Ch.yu(r),n)]}})})}function Nl(t){return Nu(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Sl(t){return t.ph.Gu.sh=vl.bind(null,t),t.ph.Gu.qe=function(t,e){var n=t;if((t=n.kh.get(e))&&t.Vh)return ao().add(t.key);var r=ao();if(!(e=n.Fh.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Nh.get(s),r=r.kt(s.view.dh);return r}.bind(null,t),t.ph.Gu.nh=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Sh.Qi(s,"rejected",u),i=e.kh.get(s),(n=i&&i.key)?(r=(r=new Wi(jr.i)).ot(n,new bu(n,Si.min())),i=ao().add(n),i=new po(Si.min(),new Map,new to(li),r,i),[4,vl(e,i)]):[3,2];case 1:return t.sent(),e.$h=e.$h.remove(n),e.kh.delete(s),Tl(e),[3,4];case 2:return[4,lf(e.ju,s,!1).then(function(){return bl(e,s,u)}).catch(yf)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,t),t.Ch.yu=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query;if(u=n.Bs.get(u)){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Ws(s)&&(r=!0);u.Ls=s}}r&&Ya(n)}.bind(null,t.bh),t.Ch.Wh=function(t,e,n){var r=t;if(t=r.Bs.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.Bs.delete(e)}.bind(null,t.bh),t}function Dl(t){return t.ph.Gu.ih=function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.ju,h=s,(f=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=h.batch.keys(),n=f.Dc.ra({oa:!0}),i=f,o=t,s=n,u=(r=h).batch,a=u.keys(),c=Ia.resolve();return a.forEach(function(n){c=c.next(function(){return s.Rr(o,n)}).next(function(t){var e=t;kr(null!==(t=r.dr.get(n))),(!e||e.version.L(t)<0)&&(e=u.cr(n,e,r))&&s.Er(e,r._r)})}),c.next(function(){return i.Sr.Wo(o,u)}).next(function(){return n.apply(t)}).next(function(){return f.Sr.zo(t)}).next(function(){return f.Cc.kr(t,e)})}))];case 2:return i=t.sent(),wl(n,r,null),ml(n,r),n.Sh.ki(r,"acknowledged"),[4,_l(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,yf(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,h,f})})}.bind(null,t),t.ph.Gu.rh=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.ju,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Sr.Oo(e,r).next(function(t){return kr(null!==t),n=t.keys(),i.Sr.Wo(e,t)}).next(function(){return i.Sr.zo(e)}).next(function(){return i.Cc.kr(e,n)})}))];case 2:return o=t.sent(),wl(n,u,a),ml(n,u),n.Sh.ki(u,"rejected",a),[4,_l(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,yf(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,t),t}var Ll,xl,kl,Ol=(rp.prototype.Nc=function(t){this.zh=t},rp.prototype.Lr=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.on.length||1===r.on.length&&r.on[0].field.p())||i.isEqual(Si.min())?this.Hh(e,r):this.zh.kr(e,o).next(function(t){var n=s.Yh(r,t);return(Du(r)||Lu(r))&&s.Eh(r.an,n,o,i)?s.Hh(e,r):(Ar()<=l.DEBUG&&Nr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ju(r)),s.zh.Lr(e,r,i).next(function(e){return n.forEach(function(t){e=e.ot(t.key,t)}),e}))})},rp.prototype.Yh=function(n,t){var r=new to(Gu(n));return t.forEach(function(t,e){e instanceof wu&&qu(n,e)&&(r=r.add(e))}),r},rp.prototype.Eh=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version.L(r))},rp.prototype.Hh=function(t,e){return Ar()<=l.DEBUG&&Nr("IndexFreeQueryEngine","Using full collection scan to execute query:",ju(e)),this.zh.Lr(t,e,Si.min())},rp),Rl=(np.prototype.$o=function(t){return Ia.resolve(0===this.Sr.length)},np.prototype.ko=function(t,e,n,r){var i=this.Jh;this.Jh++,0<this.Sr.length&&this.Sr[this.Sr.length-1],n=new pc(i,e,n,r),this.Sr.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Xh=this.Xh.add(new If(u.key,i)),this.Dr.Mo(t,u.key.path.h())}return Ia.resolve(n)},np.prototype.Oo=function(t,e){return Ia.resolve(this.Zh(e))},np.prototype.Bo=function(t,e){return e+=1,e=(e=this.tl(e))<0?0:e,Ia.resolve(this.Sr.length>e?this.Sr[e]:null)},np.prototype.qo=function(){return Ia.resolve(0===this.Sr.length?-1:this.Jh-1)},np.prototype.Uo=function(t){return Ia.resolve(this.Sr.slice())},np.prototype.Nr=function(t,e){var n=this,r=new If(e,0),e=new If(e,Number.POSITIVE_INFINITY),i=[];return this.Xh.Ft([r,e],function(t){t=n.Zh(t.jc),i.push(t)}),Ia.resolve(i)},np.prototype.Or=function(t,e){var n=this,r=new to(li);return e.forEach(function(t){var e=new If(t,0),t=new If(t,Number.POSITIVE_INFINITY);n.Xh.Ft([e,t],function(t){r=r.add(t.jc)})}),Ia.resolve(this.el(r))},np.prototype.Wr=function(t,e){var n=e.path,r=n.length+1,e=n;jr.F(e)||(e=e.child(""));var e=new If(new jr(e),0),i=new to(li);return this.Xh.xt(function(t){var e=t.key.path;return!!n.T(e)&&(e.length===r&&(i=i.add(t.jc)),!0)},e),Ia.resolve(this.el(i))},np.prototype.el=function(t){var e=this,n=[];return t.forEach(function(t){null!==(t=e.Zh(t))&&n.push(t)}),n},np.prototype.Wo=function(n,r){var i=this;kr(0===this.nl(r.batchId,"removed")),this.Sr.shift();var o=this.Xh;return Ia.forEach(r.mutations,function(t){var e=new If(t.key,r.batchId);return o=o.delete(e),i.No.Go(n,t.key)}).next(function(){i.Xh=o})},np.prototype.Ko=function(t){},np.prototype.Ho=function(t,e){var n=new If(e,0),n=this.Xh.$t(n);return Ia.resolve(e.isEqual(n&&n.key))},np.prototype.zo=function(t){return this.Sr.length,Ia.resolve()},np.prototype.nl=function(t,e){return this.tl(t)},np.prototype.tl=function(t){return 0===this.Sr.length?0:t-this.Sr[0].batchId},np.prototype.Zh=function(t){return(t=this.tl(t))<0||t>=this.Sr.length?null:this.Sr[t]},np),Pl=(ep.prototype.Er=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this.sl(e);return this.docs=this.docs.ot(r,{ta:e,size:o,readTime:n}),this.size+=o-i,this.Dr.Mo(t,r.path.h())},ep.prototype.Ar=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},ep.prototype.Rr=function(t,e){return e=this.docs.get(e),Ia.resolve(e?e.ta:null)},ep.prototype.getEntries=function(t,e){var n=this,r=no;return e.forEach(function(t){var e=n.docs.get(t);r=r.ot(t,e?e.ta:null)}),Ia.resolve(r)},ep.prototype.Lr=function(t,e,n){for(var r=oo,i=new jr(e.path.child("")),o=this.docs.ft(i);o.At();){var s=(u=o.It()).key,u=(a=u.value).ta,a=a.readTime;if(!e.path.T(s.path))break;a.L(n)<=0||u instanceof wu&&qu(e,u)&&(r=r.ot(u.key,u))}return Ia.resolve(r)},ep.prototype.il=function(t,e){return Ia.forEach(this.docs,function(t){return e(t)})},ep.prototype.ra=function(t){return new Cl(this)},ep.prototype.aa=function(t){return Ia.resolve(this.size)},ep),Cl=(n(tp,kl=h),tp.prototype.yr=function(n){var r=this,i=[];return this.wr.forEach(function(t,e){e?i.push(r.ca.Er(n,e,r.readTime)):r.ca.Ar(t)}),Ia.$n(i)},tp.prototype.gr=function(t,e){return this.ca.Rr(t,e)},tp.prototype.Pr=function(t,e){return this.ca.getEntries(t,e)},tp),Ul=(Zl.prototype.Ce=function(t,n){return this.rl.forEach(function(t,e){return n(e)}),Ia.resolve()},Zl.prototype.Ea=function(t){return Ia.resolve(this.lastRemoteSnapshotVersion)},Zl.prototype.Ia=function(t){return Ia.resolve(this.ol)},Zl.prototype.wa=function(t){return this.highestTargetId=this.cl.next(),Ia.resolve(this.highestTargetId)},Zl.prototype.Aa=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ol&&(this.ol=e),Ia.resolve()},Zl.prototype.ga=function(t){this.rl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.cl=new Gh(e),this.highestTargetId=e),t.sequenceNumber>this.ol&&(this.ol=t.sequenceNumber)},Zl.prototype.Ra=function(t,e){return this.ga(e),this.targetCount+=1,Ia.resolve()},Zl.prototype.ya=function(t,e){return this.ga(e),Ia.resolve()},Zl.prototype.Va=function(t,e){return this.rl.delete(e.target),this.al.Uc(e.targetId),--this.targetCount,Ia.resolve()},Zl.prototype.po=function(n,r,i){var o=this,s=0,u=[];return this.rl.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.rl.delete(t),u.push(o.pa(n,e.targetId)),s++)}),Ia.$n(u).next(function(){return s})},Zl.prototype.ba=function(t){return Ia.resolve(this.targetCount)},Zl.prototype.va=function(t,e){return e=this.rl.get(e)||null,Ia.resolve(e)},Zl.prototype.Sa=function(t,e,n){return this.al.Lc(e,n),Ia.resolve()},Zl.prototype.Ca=function(e,t,n){this.al.qc(t,n);var r=this.persistence.No,i=[];return r&&t.forEach(function(t){i.push(r.Go(e,t))}),Ia.$n(i)},Zl.prototype.pa=function(t,e){return this.al.Uc(e),Ia.resolve()},Zl.prototype.Fa=function(t,e){return e=this.al.Wc(e),Ia.resolve(e)},Zl.prototype.Ho=function(t,e){return Ia.resolve(this.al.Ho(e))},Zl),Vl=($l.prototype.start=function(){return Promise.resolve()},$l.prototype.Di=function(){return this.Oa=!1,Promise.resolve()},Object.defineProperty($l.prototype,"Ei",{get:function(){return this.Oa},enumerable:!1,configurable:!0}),$l.prototype.Za=function(){},$l.prototype.tc=function(){},$l.prototype.Ic=function(){return this.Dr},$l.prototype.mc=function(t){var e=this.ul[t.ti()];return e||(e=new Rl(this.Dr,this.No),this.ul[t.ti()]=e),e},$l.prototype.Tc=function(){return this.Ka},$l.prototype.Ec=function(){return this.vr},$l.prototype.runTransaction=function(t,e,n){var r=this;Nr("MemoryPersistence","Starting transaction:",t);var i=new Ml(this.Ma.next());return this.No.ll(),n(i).next(function(t){return r.No._l(i).next(function(){return t})}).Fn().then(function(t){return i.br(),t})},$l.prototype.fl=function(e,n){return Ia.kn(Object.values(this.ul).map(function(t){return function(){return t.Ho(e,n)}}))},$l),Ml=(n(Jl,xl=be),Jl),Fl=(Yl.ml=function(t){return new Yl(t)},Object.defineProperty(Yl.prototype,"Tl",{get:function(){if(this.wl)return this.wl;throw xr()},enumerable:!1,configurable:!0}),Yl.prototype.Da=function(t,e,n){return this.dl.Da(n,e),this.Tl.delete(n.toString()),Ia.resolve()},Yl.prototype.Na=function(t,e,n){return this.dl.Na(n,e),this.Tl.add(n.toString()),Ia.resolve()},Yl.prototype.Go=function(t,e){return this.Tl.add(e.toString()),Ia.resolve()},Yl.prototype.removeTarget=function(t,e){var n=this;this.dl.Uc(e.targetId).forEach(function(t){return n.Tl.add(t.toString())});var r=this.persistence.Tc();return r.Fa(t,e.targetId).next(function(t){t.forEach(function(t){return n.Tl.add(t.toString())})}).next(function(){return r.Va(t,e)})},Yl.prototype.ll=function(){this.wl=new Set},Yl.prototype._l=function(n){var r=this,i=this.persistence.Ec().ra();return Ia.forEach(this.Tl,function(t){var e=jr.D(t);return r.El(n,e).next(function(t){t||i.Ar(e)})}).next(function(){return r.wl=null,i.apply(n)})},Yl.prototype.yc=function(t,e){var n=this;return this.El(t,e).next(function(t){t?n.Tl.delete(e.toString()):n.Tl.add(e.toString())})},Yl.prototype.hl=function(t){return 0},Yl.prototype.El=function(t,e){var n=this;return Ia.kn([function(){return Ia.resolve(n.dl.Ho(e))},function(){return n.persistence.Tc().Ho(t,e)},function(){return n.persistence.fl(t,e)}])},Yl),jl=(Xl.prototype.gu=function(t){this.Rl=t},Xl.prototype.Tu=function(t){this.gl=t},Xl.prototype.onMessage=function(t){this.Pl=t},Xl.prototype.close=function(){this.Al()},Xl.prototype.send=function(t){this.Il(t)},Xl.prototype.yl=function(){this.Rl()},Xl.prototype.Vl=function(t){this.gl(t)},Xl.prototype.pl=function(t){this.Pl(t)},Xl),ql={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Gl=(Ql.prototype.$u=function(e,t,n,r){var i=this.Dl(e,t);return Nr("RestConnection","Sending: ",i,n),t={},this.Cl(t,r),this.Nl(e,i,t,n).then(function(t){return Nr("RestConnection","Received: ",t),t},function(t){throw Dr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Ql.prototype.ku=function(t,e,n,r){return this.$u(t,e,n,r)},Ql.prototype.Cl=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.24.0",t["Content-Type"]="text/plain",e)for(var n in e.Kc)e.Kc.hasOwnProperty(n)&&(t[n]=e.Kc[n])},Ql.prototype.Dl=function(t,e){return t=ql[t],this.vl+"/v1/"+e+":"+t},n(Wl,Ll=Ql),Wl.prototype.Nl=function(o,e,s,u){return new Promise(function(n,r){var i=new gr;i.listenOnce(yr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case dr.NO_ERROR:var t=i.getResponseJson();Nr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case dr.TIMEOUT:Nr("Connection",'RPC "'+o+'" timed out'),r(new Ir(Er.DEADLINE_EXCEEDED,"Request time out"));break;case dr.HTTP_ERROR:var e=i.getStatus();Nr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Er).indexOf(e)?e:Er.UNKNOWN,r(new Ir(e,t.message))):r(new Ir(Er.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Ir(Er.UNAVAILABLE,"Connection failed."));break;default:xr()}}finally{Nr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},Wl.prototype.Pu=function(t,e){var n,r=[this.vl,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new cr,t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.U.projectId+"/databases/"+this.U.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.W};this.Cl(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),Nr("Connection","Creating WebChannel: "+(r=r.join("")),t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new jl({Il:function(t){u?Nr("Connection","Not sending because WebChannel is closed:",t):(s||(Nr("Connection","Opening WebChannel transport."),o.open(),s=!0),Nr("Connection","WebChannel sending:",t),o.send(t))},Al:function(){return o.close()}});return(t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})})(vr.EventType.OPEN,function(){u||Nr("Connection","WebChannel transport opened.")}),t(vr.EventType.CLOSE,function(){u||(u=!0,Nr("Connection","WebChannel transport closed"),a.Vl())}),t(vr.EventType.ERROR,function(t){u||(u=!0,Dr("Connection","WebChannel transport errored:",t),a.Vl(new Ir(Er.UNAVAILABLE,"The operation could not be completed")))}),t(vr.EventType.MESSAGE,function(t){var e,n,r,i;u||(kr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Nr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Gi[r];if(void 0!==t)return Ki(t)}(),i=n.message,void 0===t&&(t=Er.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.Vl(new Ir(t,i)),o.close()):(Nr("Connection","WebChannel received:",e),a.pl(e)))}),setTimeout(function(){a.yl()},0),a},Wl),Bl=(Kl.prototype.Zu=function(t){this.Ml.push(t)},Kl.prototype.Di=function(){window.removeEventListener("online",this.Fl),window.removeEventListener("offline",this.$l)},Kl.prototype.Ol=function(){window.addEventListener("online",this.Fl),window.addEventListener("offline",this.$l)},Kl.prototype.xl=function(){Nr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Ml;t<e.length;t++)(0,e[t])(0)},Kl.prototype.kl=function(){Nr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Ml;t<e.length;t++)(0,e[t])(1)},Kl.Ln=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Kl),zl=(Hl.prototype.Zu=function(t){},Hl.prototype.Di=function(){},Hl);function Hl(){}function Kl(){var t=this;this.Fl=function(){return t.xl()},this.$l=function(){return t.kl()},this.Ml=[],this.Ol()}function Wl(t){var e=this;return(e=Ll.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.W=t.W,e}function Ql(t){this.bl=t,this.U=t.U;var e=t.ssl?"https":"http";this.vl=e+"://"+t.host,this.Sl="projects/"+this.U.projectId+"/databases/"+this.U.database+"/documents"}function Xl(t){this.Il=t.Il,this.Al=t.Al}function Yl(t){this.persistence=t,this.dl=new Ef,this.wl=null}function Jl(t){var e=this;return(e=xl.call(this)||this).xa=t,e}function $l(t){var e=this;this.ul={},this.Ma=new ec(0),this.Oa=!1,this.Oa=!0,this.No=t(this),this.Ka=new Ul(this),this.Dr=new vh,this.vr=(t=this.Dr,new Pl(t,function(t){return e.No.hl(t)}))}function Zl(t){this.persistence=t,this.rl=new Ai(Mi,Fi),this.lastRemoteSnapshotVersion=Si.min(),this.highestTargetId=0,this.ol=0,this.al=new Ef,this.targetCount=0,this.cl=Gh.fa()}function tp(t){var e=this;return(e=kl.call(this)||this).ca=t,e}function ep(t,e){this.Dr=t,this.sl=e,this.docs=new Wi(jr.i),this.size=0}function np(t,e){this.Dr=t,this.No=e,this.Sr=[],this.Jh=1,this.Xh=new to(If.kc)}function rp(){}function ip(t){return new Yo(t,!0)}var op,sp,up,ap,cp="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",hp=(Ap.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Sh=this.Ll(e),this.persistence=this.Bl(e),[4,this.persistence.start()];case 1:return t.sent(),this.ql=this.Ul(e),this.ju=this.Ql(e),[2]}})})},Ap.prototype.Ul=function(t){return null},Ap.prototype.Ql=function(t){return e=this.persistence,n=new Ol,t=t.Wl,new af(e,n,t);var e,n},Ap.prototype.Bl=function(t){if(t.persistenceSettings.jl)throw new Ir(Er.FAILED_PRECONDITION,cp);return new Vl(Fl.ml)},Ap.prototype.Ll=function(t){return new lc},Ap.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.ql&&this.ql.stop(),[4,this.Sh.Di()];case 1:return t.sent(),[4,this.persistence.Di()];case 2:return t.sent(),[2]}})})},Ap.prototype.clearPersistence=function(t,e){throw new Ir(Er.FAILED_PRECONDITION,cp)},Ap),fp=(n(_p,ap=hp),_p.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,ap.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=ph(t),r=Si.min(),t.rs({index:xh.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=Qc(e.readTime)),n.done()}).next(function(){return r});var r}).then(function(t){e.Sc=t})]})})}(this.ju)];case 2:return t.sent(),[4,this.Kl.initialize(this,e)];case 3:return t.sent(),[4,Dl(this.Kl.fi)];case 4:return t.sent(),[4,el(this.Kl.ph)];case 5:return t.sent(),[2]}})})},_p.prototype.Ul=function(t){var e=this.persistence.No.wo;return new Vc(e,t.cs)},_p.prototype.Bl=function(t){var e=uf(t.bl.U,t.bl.persistenceKey),n=ip(t.bl.U);return new $h(t.persistenceSettings.synchronizeTabs,e,t.clientId,Pc.ao(t.persistenceSettings.cacheSizeBytes),t.cs,Fa(),ja(),n,this.Sh,t.persistenceSettings.ka)},_p.prototype.Ll=function(t){return new lc},_p.prototype.clearPersistence=function(t,e){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return Ta.Ln()?(e=n+"main",[4,Ta.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(uf(t,e))},n(Tp,up=_p),Tp.prototype.initialize=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,up.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.Kl.fi,this.Sh instanceof fc?(this.Sh.fi={er:function(u,a,c,h){return y(this,void 0,void 0,function(){var o,s;return v(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).ju,n=a,i=(r=e).Sr,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Lo(e,n).next(function(t){return t?r.Cc.kr(e,t):Ia.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,el(o.ph)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(wl(o,a,h||null),ml(o,a),o.ju.Sr.Ko(a)):xr(),t.label=4;case 4:return[4,_l(o,s)];case 5:return t.sent(),[3,7];case 6:Nr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}.bind(null,e),nr:function(o,u,a,c){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:return(n=o).qh?(Nr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!n.Fh.has(u))return[3,8];switch(a){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,(e=n.ju,(s=e).persistence.runTransaction("Get new document changes","readonly",function(t){return e=s.Dc,n=t,t=s.Sc,r=e,i=no,o=Wc(t),t=ph(n),n=IDBKeyRange.lowerBound(o,!0),t.rs({index:xh.readTimeIndex,range:n},function(t,e){var n=Hc(r.serializer,e);i=i.ot(n.key,n),o=e.readTime}).next(function(){return{xc:i,readTime:Qc(o)}});var e,n,r,i,o}).then(function(t){var e=t.xc,t=t.readTime;return s.Sc=t,e}))];case 3:return r=t.sent(),i=po.Xt(u,"current"===a),[4,_l(n,r,i)];case 4:return t.sent(),[3,8];case 5:return[4,lf(n.ju,u,!0)];case 6:return t.sent(),bl(n,u,c),[3,8];case 7:xr(),t.label=8;case 8:return[2]}var e,s})})}.bind(null,e),sr:function(c,h,f){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a;return v(this,function(t){switch(t.label){case 0:if(!(n=Sl(c)).qh)return[3,10];e=0,r=h,t.label=1;case 1:return e<r.length?(r=r[e],n.Fh.has(r)?(Nr("SyncEngine","Adding an already active target "+r),[3,5]):[4,df(n.ju,r)]):[3,6];case 2:return i=t.sent(),[4,ff(n.ju,i)];case 3:return o=t.sent(),[4,yl(n,Nl(i),o.targetId,!1)];case 4:t.sent(),Hf(n.ph,o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return n.Fh.has(e)?[4,lf(n.ju,e,!1).then(function(){Kf(n.ph,e),bl(n,e)}).catch(yf)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=0,a=f,t.label=7;case 7:return u<a.length?(a=a[u],[5,s(a)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})}.bind(null,e),pi:function(t){return t.ju.persistence.pi()}.bind(null,e)},[4,this.Sh.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence.Xa(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,function(h,f){return y(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return v(this,function(t){switch(t.label){case 0:return Sl(r=h),Dl(r),!0!==f||!0===r.qh?[3,3]:(e=r.Sh.Ci(),[4,Al(r,e.A())]);case 1:return i=t.sent(),r.qh=!0,[4,il(r.ph,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],Hf(r.ph,u);return[3,7];case 3:return!1!==f||!1===r.qh?[3,7]:(a=[],c=Promise.resolve(),r.Fh.forEach(function(t,e){r.Sh.qi(e)?a.push(e):c=c.then(function(){return bl(r,e),lf(r.ju,e,!0)}),Kf(r.ph,e)}),[4,c]);case 4:return t.sent(),[4,Al(r,a)];case 5:return t.sent(),(n=r).kh.forEach(function(t,e){Kf(n.ph,e)}),n.Mh.Qc(),n.kh=new Map,n.$h=new Wi(jr.i),r.qh=!1,[4,il(r.ph,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}(this.Kl.fi,e)];case 1:return t.sent(),this.ql&&(e&&!this.ql.Ei?this.ql.start(this.ju):e||this.ql.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},Tp.prototype.Ll=function(t){if(t.persistenceSettings.jl&&t.persistenceSettings.synchronizeTabs){var e=Fa();if(!fc.Ln(e))throw new Ir(Er.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=uf(t.bl.U,t.bl.persistenceKey);return new fc(e,t.cs,n,t.clientId,t.Wl)}return new lc},Tp),lp=(Ip.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.ju?[3,2]:(this.ju=n.ju,this.Sh=n.Sh,this.Ku=this.Gl(r),this.ph=this.zl(r),this.bh=this.Hl(r),this.fi=this.Yl(r),this.Sh.di=function(t){return gl(e.fi,t,1)},this.ph.Gu.Jl=function(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Nr("SyncEngine","User change. New user:",o.ti()),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Sr,m=e.Cc,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.Sr.Uo(v).next(function(t){return g=t,n=e.persistence.mc(o),m=new vc(e.Dc,n,e.persistence.Ic()),n.Uo(v)}).next(function(t){for(var e=[],n=[],r=ao(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.kr(v,r).next(function(t){return{jh:t,Kh:e,Gh:n}})})})];case 1:return r=t.sent(),[2,(e.Sr=n,e.Cc=m,e.Vc.Nc(e.Cc),r)]}})})}(n.ju,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Lh.forEach(function(t){t.forEach(function(t){t.reject(new Ir(Er.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Lh.clear(),n.Sh.ji(o,r.Kh,r.Gh),[4,_l(n,r.jh)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this.fi),[4,il(this.ph,this.fi.Uh)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Ip.prototype.Hl=function(t){return new Wa},Ip.prototype.Gl=function(t){var e=ip(t.bl.U),n=(n=t.bl,new Gl(n));return t=t.credentials,new Lf(t,n,e)},Ip.prototype.zl=function(t){var e=this;return new gf(this.ju,this.Ku,t.cs,function(t){return gl(e.fi,t,0)},t=new(Bl.Ln()?Bl:zl))},Ip.prototype.Yl=function(t){return e=this.ju,n=this.ph,r=this.bh,i=this.Sh,o=t.Wl,s=t.Dh,u=!t.persistenceSettings.jl||!t.persistenceSettings.synchronizeTabs,s=new ll(e,n,r,i,o,s),u&&(s.qh=!0),s;var e,n,r,i,o,s,u},Ip.prototype.terminate=function(){return zf(this.ph)},Ip),pp=(Ep.prototype.next=function(t){this.observer.next&&this.Xl(this.observer.next,t)},Ep.prototype.error=function(t){this.observer.error?this.Xl(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Ep.prototype.Zl=function(){this.muted=!0},Ep.prototype.Xl=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Ep),dp=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Ir(Er.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(Xr("FieldPath","string",e,t[e]),0===t[e].length)throw new Ir(Er.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.t_=new Fr(t)},yp=(n(bp,sp=dp),bp.documentId=function(){return new bp(Fr.v().R())},bp.prototype.isEqual=function(t){if(!(t instanceof bp))throw si("isEqual","FieldPath",1,t);return this.t_.isEqual(t.t_)},bp),vp=new RegExp("[~\\*/\\[\\]]"),gp=function(t){this.e_=t},mp=(n(wp,op=gp),wp.prototype.n_=function(t){if(2!==t.s_)throw 1===t.s_?t.i_(this.e_+"() can only appear at the top level of your update data"):t.i_(this.e_+"() cannot be used with set() unless you pass {merge:true}");return t.We.push(t.path),null},wp.prototype.isEqual=function(t){return t instanceof wp},wp);function wp(){return null!==op&&op.apply(this,arguments)||this}function bp(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return sp.call(this,t)||this}function Ep(t){this.observer=t,this.muted=!1}function Ip(){}function Tp(){return null!==up&&up.apply(this,arguments)||this}function _p(t){var e=this;return(e=ap.call(this)||this).Kl=t,e}function Ap(){}function Np(t,e,n){return new Xp({s_:3,r_:e.settings.r_,methodName:t.e_,o_:n},e.U,e.serializer,e.ignoreUndefinedProperties)}var Sp,Dp,Lp,xp,kp=(n(Wp,xp=gp),Wp.prototype.n_=function(t){return new js(t.path,new As)},Wp.prototype.isEqual=function(t){return t instanceof Wp},Wp),Op=(n(Kp,Lp=gp),Kp.prototype.n_=function(t){var e=Np(this,t,!0),n=this.a_.map(function(t){return rd(t,e)}),n=new Ns(n);return new js(t.path,n)},Kp.prototype.isEqual=function(t){return this===t},Kp),Rp=(n(Hp,Dp=gp),Hp.prototype.n_=function(t){var e=Np(this,t,!0),n=this.a_.map(function(t){return rd(t,e)}),n=new ks(n);return new js(t.path,n)},Hp.prototype.isEqual=function(t){return this===t},Hp),Pp=(n(zp,Sp=gp),zp.prototype.n_=function(t){var e=new Cs(t.serializer,Zo(t.serializer,this.c_));return new js(t.path,e)},zp.prototype.isEqual=function(t){return this===t},zp),Cp=(Object.defineProperty(Bp.prototype,"latitude",{get:function(){return this.u_},enumerable:!1,configurable:!0}),Object.defineProperty(Bp.prototype,"longitude",{get:function(){return this.h_},enumerable:!1,configurable:!0}),Bp.prototype.isEqual=function(t){return this.u_===t.u_&&this.h_===t.h_},Bp.prototype.toJSON=function(){return{latitude:this.u_,longitude:this.h_}},Bp.prototype.Y=function(t){return li(this.u_,t.u_)||li(this.h_,t.h_)},Bp),Up=function(t){this.l_=t},Vp=/^__.*__$/,Mp=function(t,e,n){this.__=t,this.f_=e,this.d_=n},Fp=(Gp.prototype.w_=function(t,e){var n=[];return null!==this.We?n.push(new $s(t,this.data,this.We,e)):n.push(new Js(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new ru(t,this.fieldTransforms)),n},Gp),jp=(qp.prototype.w_=function(t,e){return e=[new $s(t,this.data,this.We,e)],0<this.fieldTransforms.length&&e.push(new ru(t,this.fieldTransforms)),e},qp);function qp(t,e,n){this.data=t,this.We=e,this.fieldTransforms=n}function Gp(t,e,n){this.data=t,this.We=e,this.fieldTransforms=n}function Bp(t,e){if(Kr("GeoPoint",arguments,2),Xr("GeoPoint","number",1,t),Xr("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Ir(Er.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Ir(Er.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.u_=t,this.h_=e}function zp(t,e){var n=this;return(n=Sp.call(this,t)||this).c_=e,n}function Hp(t,e){var n=this;return(n=Dp.call(this,t)||this).a_=e,n}function Kp(t,e){var n=this;return(n=Lp.call(this,t)||this).a_=e,n}function Wp(){return null!==xp&&xp.apply(this,arguments)||this}function Qp(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw xr()}}var Xp=(Object.defineProperty($p.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty($p.prototype,"s_",{get:function(){return this.settings.s_},enumerable:!1,configurable:!0}),$p.prototype.T_=function(t){return new $p(Object.assign(Object.assign({},this.settings),t),this.U,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.We)},$p.prototype.E_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.T_({path:e,o_:!1})).I_(t),e},$p.prototype.A_=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t);return(t=this.T_({path:t,o_:!1})).m_(),t},$p.prototype.R_=function(t){return this.T_({path:void 0,o_:!0})},$p.prototype.i_=function(t){return cd(t,this.settings.methodName,this.settings.g_||!1,this.path,this.settings.r_)},$p.prototype.contains=function(e){return void 0!==this.We.find(function(t){return e.T(t)})||void 0!==this.fieldTransforms.find(function(t){return e.T(t.field)})},$p.prototype.m_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.I_(this.path.get(t))},$p.prototype.I_=function(t){if(0===t.length)throw this.i_("Document fields must not be empty");if(Qp(this.s_)&&Vp.test(t))throw this.i_('Document fields cannot begin and end with "__"')},$p),Yp=(Jp.prototype.P_=function(t,e,n,r){return void 0===r&&(r=!1),new Xp({s_:t,methodName:e,r_:n,path:Fr.P(),o_:!1,g_:r},this.U,this.serializer,this.ignoreUndefinedProperties)},Jp);function Jp(t,e,n){this.U=t,this.ignoreUndefinedProperties=e,this.serializer=n||ip(t)}function $p(t,e,n,r,i,o){this.settings=t,this.U=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.m_(),this.fieldTransforms=i||[],this.We=o||[]}function Zp(t,e,n,r,i,o){void 0===o&&(o={});var s=t.P_(o.merge||o.mergeFields?2:0,e,n,i);sd("Data must be an object, but it was:",s,r);var u,a,r=id(r,s);if(o.merge)u=new Fs(s.We),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=f[h],p=void 0;if(l instanceof dp)p=l.t_;else{if("string"!=typeof l)throw xr();p=ad(e,l,n)}if(!s.contains(p))throw new Ir(Er.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");hd(c,p)||c.push(p)}u=new Fs(c),a=s.fieldTransforms.filter(function(t){return u.Ye(t.field)})}else u=null,a=s.fieldTransforms;return new Fp(new hu(r),u,a)}function td(t,r,i,e){var o=t.P_(1,r,i);sd("Data must be an object, but it was:",o,e);var s=[],u=new fu;return Rr(e,function(t,e){var n=ad(r,t,i),t=o.A_(n);e instanceof mp||e instanceof Up&&e.l_ instanceof mp?s.push(n):null!=(t=rd(e,t))&&(s.push(n),u.set(n,t))}),e=new Fs(s),new jp(u.Xe(),e,o.fieldTransforms)}function ed(t,e,n,r,i,o){var s=t.P_(1,e,n),u=[ud(e,r,n)],a=[i];if(o.length%2!=0)throw new Ir(Er.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(ud(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new fu,y=u.length-1;0<=y;--y)hd(p,u[y])||(h=u[y],f=a[y],l=s.A_(h),f instanceof mp||f instanceof Up&&f.l_ instanceof mp?p.push(h):null!=(l=rd(f,l))&&(p.push(h),d.set(h,l)));return i=new Fs(p),new jp(d.Xe(),i,s.fieldTransforms)}function nd(t,e,n,r){return void 0===r&&(r=!1),rd(n,t.P_(r?4:3,e))}function rd(s,t){if(s instanceof Up&&(s=s.l_),od(s))return sd("Unsupported field value:",t,s),id(s,t);if(s instanceof gp)return function(t,e){if(!Qp(e.s_))throw e.i_(t.e_+"() can only be used with update() and set()");if(!e.path)throw e.i_(t.e_+"() is not currently supported inside arrays");(t=t.n_(e))&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.We.push(t.path),s instanceof Array){if(t.settings.o_&&4!==t.s_)throw t.i_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=rd(i[r],t.R_(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Zo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Ni.fromDate(t);return{timestampValue:ts(e.serializer,n)}}if(t instanceof Ni){var r=new Ni(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:ts(e.serializer,r)}}if(t instanceof Cp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof gi)return{bytesValue:es(e.serializer,t.q)};if(t instanceof Mp){if(n=e.U,!(r=t.__).isEqual(n))throw e.i_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:rs(t.__||e.U,t.f_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.i_("Unsupported field value: "+ri(t))}(s,t)}function id(t,n){var r={};return Pr(t)?n.path&&0<n.path.length&&n.We.push(n.path):Rr(t,function(t,e){null!=(e=rd(e,n.E_(t)))&&(r[t]=e)}),{mapValue:{fields:r}}}function od(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Ni||t instanceof Cp||t instanceof gi||t instanceof Mp||t instanceof gp)}function sd(t,e,n){if(!od(n)||!ni(n))throw"an object"===(n=ri(n))?e.i_(t+" a custom object"):e.i_(t+" "+n)}function ud(t,e,n){if(e instanceof dp)return e.t_;if("string"==typeof e)return ad(t,e);throw cd("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function ad(t,e,n){try{return function(e){if(0<=e.search(vp))throw new Ir(Er.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(yp.bind.apply(yp,i([void 0],e.split("."))))}catch(t){throw new Ir(Er.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).t_}catch(e){throw cd(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function cd(t,e,n,r,i){var o=r&&!r.m(),s=void 0!==i,e="Function "+e+"() called with invalid data";return n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Ir(Er.INVALID_ARGUMENT,(e+=". ")+t+n)}function hd(t,e){return t.some(function(t){return t.isEqual(e)})}var fd=(vd.prototype.v_=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.S_(),0<this.mutations.length)throw new Ir(Er.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var i,e,n,o,r;return v(this,function(t){switch(t.label){case 0:return e=cs((i=s).serializer)+"/documents",n={documents:u.map(function(t){return os(i.serializer,t)})},[4,i.ku("BatchGetDocuments",e,n)];case 1:return n=t.sent(),o=new Map,n.forEach(function(t){var e,n,r,t=(e=i.serializer,"found"in(t=t)?function(t,e){kr(!!e.found),e.found.name,e.found.updateTime;var n=ss(t,e.found.name),t=ns(e.found.updateTime),e=new hu({mapValue:{fields:e.found.fields}});return new wu(n,t,e,{})}(e,t):"missing"in t?(n=e,kr(!!(r=t).missing),kr(!!r.readTime),n=ss(n,r.missing),r=ns(r.readTime),new bu(n,r)):xr());o.set(t.key.toString(),t)}),r=[],[2,(u.forEach(function(t){kr(!!(t=o.get(t.toString()))),r.push(t)}),r)]}})})}(this.Ku,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof bu||t instanceof wu?n.D_(t):xr()}),e)]}})})},vd.prototype.set=function(t,e){this.write(e.w_(t,this.Ge(t))),this.b_.add(t.toString())},vd.prototype.update=function(t,e){try{this.write(e.w_(t,this.C_(t)))}catch(t){this.p_=t}this.b_.add(t.toString())},vd.prototype.delete=function(t){this.write([new au(t,this.Ge(t))]),this.b_.add(t.toString())},vd.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.S_(),this.p_)throw this.p_;return e=this.y_,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=jr.D(e),n.mutations.push(new cu(e,n.Ge(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=cs((e=i).serializer)+"/documents",r={writes:o.map(function(t){return ls(e.serializer,t)})},[4,e.$u("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Ku,this.mutations)];case 1:return t.sent(),this.V_=!0,[2]}})})},vd.prototype.D_=function(t){var e;if(t instanceof wu)e=t.version;else{if(!(t instanceof bu))throw xr();e=Si.min()}var n=this.y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Ir(Er.ABORTED,"Document version changed between two reads.")}else this.y_.set(t.key.toString(),e)},vd.prototype.Ge=function(t){var e=this.y_.get(t.toString());return!this.b_.has(t.toString())&&e?Bs.updateTime(e):Bs.ze()},vd.prototype.C_=function(t){var e=this.y_.get(t.toString());if(this.b_.has(t.toString())||!e)return Bs.exists(!0);if(e.isEqual(Si.min()))throw new Ir(Er.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Bs.updateTime(e)},vd.prototype.write=function(t){this.S_(),this.mutations=this.mutations.concat(t)},vd.prototype.S_=function(){},vd),ld=(yd.prototype.run=function(){this.F_()},yd.prototype.F_=function(){var t=this;this.ys.gn(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new fd(this.Ku),(n=this.x_(e))&&n.then(function(t){r.cs.ws(function(){return e.commit().then(function(){r.ls.resolve(t)}).catch(function(t){r.k_(t)})})}).catch(function(t){r.k_(t)}),[2]})})})},yd.prototype.x_=function(t){try{var e=this.updateFunction(t);return!Ri(e)&&e.catch&&e.then?e:(this.ls.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.ls.reject(t),null}},yd.prototype.k_=function(t){var e=this;0<this.N_&&this.M_(t)?(--this.N_,this.cs.ws(function(){return e.F_(),Promise.resolve()})):this.ls.reject(t)},yd.prototype.M_=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!Hi(t))},yd),pd=(dd.prototype.start=function(t,e,n,r){var i=this;this.L_(),this.bl=t;var o=new wa,s=!1;return this.credentials.Hc(function(t){return s?void i.cs.Cs(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).cs.xs(),Nr("RemoteStore","RemoteStore received new credentials"),n=Jf(e),e.Yu.add(3),[4,Bf(e)];case 1:return t.sent(),n&&e.th.set("Unknown"),[4,e.Gu.Jl(i)];case 2:return t.sent(),e.Yu.delete(3),[4,Gf(e)];case 3:return t.sent(),[2]}})})}(i.ph,t)}):(s=!0,Nr("FirestoreClient","Initializing. user=",t.uid),i.B_(e,n,r,t,o).then(i.O_.resolve,i.O_.reject))}),this.cs.ws(function(){return i.O_.promise}),o.promise},dd.prototype.enableNetwork=function(){var e=this;return this.L_(),this.cs.enqueue(function(){return e.persistence.tc(!0),(t=e.ph).Yu.delete(0),Gf(t);var t})},dd.prototype.B_=function(r,i,o,s,u){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={cs:this.cs,bl:this.bl,clientId:this.clientId,credentials:this.credentials,Wl:s,Dh:100,persistenceSettings:o},[4,r.initialize(e)];case 1:return t.sent(),[4,i.initialize(r,e)];case 2:return t.sent(),this.persistence=r.persistence,this.Sh=r.Sh,this.ju=r.ju,this.ql=r.ql,this.Ku=i.Ku,this.ph=i.ph,this.fi=i.fi,this.q_=i.bh,this.q_.Us=function(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=Sl(s),(o=e.Nh.get(u))?(n=o.targetId,e.Sh.Oi(n),r=o.view.yh(),[3,4]):[3,1];case 1:return[4,ff(e.ju,Pu(u))];case 2:return i=t.sent(),o=e.Sh.Oi(i.targetId),n=i.targetId,[4,yl(e,u,n,"current"===o)];case 3:r=t.sent(),e.Uh&&Hf(e.ph,i),t.label=4;case 4:return[2,r]}})})}.bind(null,this.fi),this.q_.js=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Nh.get(o),1<(r=e.Fh.get(n.targetId)).length?[2,(e.Fh.set(n.targetId,r.filter(function(t){return!Mu(t,o)})),void e.Nh.delete(o))]:e.Uh?(e.Sh.Bi(n.targetId),e.Sh.Fi(n.targetId)?[3,2]:[4,lf(e.ju,n.targetId,!1).then(function(){e.Sh.Ui(n.targetId),Kf(e.ph,n.targetId),bl(e,n.targetId)}).catch(yf)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return bl(e,n.targetId),[4,lf(e.ju,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,this.fi),this.persistence.Za(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),u.resolve(),[3,4];case 3:if(e=t.sent(),u.reject(e),!this.U_(e))throw e;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),this.B_(new hp,new lp,{jl:!1},s,u))];case 4:return[2]}})})},dd.prototype.U_=function(t){return"FirebaseError"===t.name?t.code===Er.FAILED_PRECONDITION||t.code===Er.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},dd.prototype.L_=function(){if(this.cs.ps)throw new Ir(Er.FAILED_PRECONDITION,"The client has already been terminated.")},dd.prototype.disableNetwork=function(){var t=this;return this.L_(),this.cs.enqueue(function(){return t.persistence.tc(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Yu.add(0),[4,Bf(e)];case 1:return t.sent(),e.th.set("Offline"),[2]}})})}(t.ph)})},dd.prototype.terminate=function(){var t=this;this.cs.Ds();var n=new wa;return this.cs.bs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.ql&&this.ql.stop(),[4,zf(this.ph)];case 1:return t.sent(),[4,this.Sh.Di()];case 2:return t.sent(),[4,this.persistence.Di()];case 3:return t.sent(),this.credentials.Yc(),n.resolve(),[3,5];case 4:return e=Ha(e=t.sent(),"Failed to shutdown persistence"),n.reject(e),[3,5];case 5:return[2]}})})}),n.promise},dd.prototype.waitForPendingWrites=function(){var t=this;this.L_();var e=new wa;return this.cs.ws(function(){return function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:Jf((n=o).ph)||Nr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.ju).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Sr.qo(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Lh.get(r)||[]).push(s),n.Lh.set(r,i),[3,4]);case 3:return i=Ha(i=t.sent(),"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}(t.fi,e)}),e.promise},dd.prototype.listen=function(t,e,n){var r=this;this.L_();var i=new pp(n),o=new Ja(t,i,e);return this.cs.ws(function(){return Qa(r.q_,o)}),function(){i.Zl(),r.cs.ws(function(){return Xa(r.q_,o)})}},dd.prototype.Q_=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.L_(),[4,this.O_.promise];case 1:return t.sent(),e=new wa,[2,(this.cs.ws(function(){return function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.Cc.Cr(t,e)}))];case 1:return(r=t.sent())instanceof wu?s.resolve(r):r instanceof bu?s.resolve(null):s.reject(new Ir(Er.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=Ha(r=t.sent(),"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(n.ju,r,e)}),e.promise)]}})})},dd.prototype.W_=function(c,h){return void 0===h&&(h={}),y(this,void 0,void 0,function(){var e,a=this;return v(this,function(t){switch(t.label){case 0:return this.L_(),[4,this.O_.promise];case 1:return t.sent(),e=new wa,[2,(this.cs.ws(function(){return n=a.q_,r=a.cs,i=c,o=h,s=e,t=new pp({next:function(t){r.ws(function(){return Xa(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Ir(Er.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Ir(Er.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Ja(Su(i.path),t,{includeMetadataChanges:!0,Xs:!0}),Qa(n,u);var n,r,i,o,s,t,u}),e.promise)]}})})},dd.prototype.j_=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.L_(),[4,this.O_.promise];case 1:return t.sent(),e=new wa,[2,(this.cs.ws(function(){return function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,pf(r,i,!0)];case 1:return n=t.sent(),e=new cl(i,n.Fc),n=e.wh(n.documents),n=e.yr(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=Ha(n=t.sent(),"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(n.ju,r,e)}),e.promise)]}})})},dd.prototype.K_=function(c,h){return void 0===h&&(h={}),y(this,void 0,void 0,function(){var u,a=this;return v(this,function(t){switch(t.label){case 0:return this.L_(),[4,this.O_.promise];case 1:return t.sent(),u=new wa,[2,(this.cs.ws(function(){return e=a.q_,n=a.cs,t=c,r=h,i=u,o=new pp({next:function(t){n.ws(function(){return Xa(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Ir(Er.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Ja(t,o,{includeMetadataChanges:!0,Xs:!0}),Qa(e,s);var e,n,t,r,i,o,s}),u.promise)]}})})},dd.prototype.write=function(t){var e=this;this.L_();var n=new wa;return this.cs.ws(function(){return function(l,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:u=Dl(l),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(i=u.ju,a=p,h=i,f=Ni.now(),o=a.reduce(function(t,e){return t.add(e.key)},ao()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.Cc.kr(u,o).next(function(t){c=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=c.get(i.key),s instanceof ru?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof wu?t.field(i.field):void 0;null!=(o=Is(i.transform,o||null))&&(e=(null==e?new fu:e).set(i.field,o))}return e?e.Xe():null}(o):null);null!=o&&e.push(new $s(i.key,o,function s(t){var u=[];return Rr(t.fields||{},function(t,e){var n=new Fr([t]);if(Wo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Fs(u)}(o.proto.mapValue),Bs.exists(!0)))}return h.Sr.ko(u,f,e,a)})}).then(function(t){var e=t.lr(c);return{batchId:t.batchId,wr:e}}))];case 2:return s=t.sent(),u.Sh.xi(s.batchId),e=u,n=s.batchId,r=d,i=(i=(i=e.Oh[e.currentUser.ti()])||new Wi(li)).ot(n,r),e.Oh[e.currentUser.ti()]=i,[4,_l(u,s.wr)];case 3:return t.sent(),[4,el(u.ph)];case 4:return t.sent(),[3,6];case 5:return u=Ha(u=t.sent(),"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,i,a,c,h,f,o})})}(e.fi,t,n)}),n.promise},dd.prototype.U=function(){return this.bl.U},dd.prototype.G_=function(t){var e=this;this.L_();var r=new pp(t);return this.cs.ws(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,(e=this.q_,n=r,e.qs.add(n),void n.next())];var e,n})})}),function(){r.Zl(),e.cs.ws(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,void this.q_.qs.delete(r)]})})})}},Object.defineProperty(dd.prototype,"z_",{get:function(){return this.cs.ps},enumerable:!1,configurable:!0}),dd.prototype.transaction=function(t){var e=this;this.L_();var n=new wa;return this.cs.ws(function(){return new ld(e.cs,e.Ku,t,n).run(),Promise.resolve()}),n.promise},dd);function dd(t,e){this.credentials=t,this.cs=e,this.clientId=hi.k(),this.O_=new wa}function yd(t,e,n,r){this.cs=t,this.Ku=e,this.updateFunction=n,this.ls=r,this.N_=5,this.ys=new Ea(this.cs,"transaction_retry")}function vd(t){this.Ku=t,this.y_=new Map,this.mutations=[],this.V_=!1,this.p_=null,this.b_=new Set}function gd(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var md,wd,bd=(Md.prototype.X_=function(t){switch(Ro(t)){case 0:return null;case 1:return t.booleanValue;case 2:return jo(t.integerValue||t.doubleValue);case 3:return this.Z_(t.timestampValue);case 4:return this.tf(t);case 5:return t.stringValue;case 6:return this.J_(qo(t.bytesValue));case 7:return this.ef(t.referenceValue);case 8:return this.nf(t.geoPointValue);case 9:return this.sf(t.arrayValue);case 10:return this.if(t.mapValue);default:throw xr()}},Md.prototype.if=function(t){var n=this,r={};return Rr(t.fields||{},function(t,e){r[t]=n.X_(e)}),r},Md.prototype.nf=function(t){return new Cp(jo(t.latitude),jo(t.longitude))},Md.prototype.sf=function(t){var e=this;return(t.values||[]).map(function(t){return e.X_(t)})},Md.prototype.tf=function(t){switch(this.H_){case"previous":var e=function t(e){return xo(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==e?null:this.X_(e);case"estimate":return this.Z_(ko(t));default:return null}},Md.prototype.Z_=function(t){return t=Fo(t),t=new Ni(t.seconds,t.nanos),this.timestampsInSnapshots?t:t.toDate()},Md.prototype.ef=function(t){var e=Vr.g(t);return kr(Es(e)),t=new _i(e.get(1),e.get(3)),e=new jr(e.u(5)),t.isEqual(this.U)||Sr("Document "+e+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+this.U.projectId+"/"+this.U.database+") instead."),this.Y_(e)},Md),Ed=Pc.ho,Id=(Vd.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Vd),Td=(Object.defineProperty(Ud.prototype,"mf",{get:function(){return this.Tf||(this.Tf=new Yp(this.__,this.wf.ignoreUndefinedProperties)),this.Tf},enumerable:!1,configurable:!0}),Ud.prototype.settings=function(t){if(Kr("Firestore.settings",arguments,1),Xr("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.wf),t)).merge,t=new Id(t),this.lf&&!this.wf.isEqual(t))throw new Ir(Er.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.wf=t).credentials&&(this.df=function(t){if(!t)return new Tf;switch(t.type){case"gapi":var e=t.client;return kr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Nf(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Ir(Er.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Ud.prototype.enableNetwork=function(){return this.hf(),this.lf.enableNetwork()},Ud.prototype.disableNetwork=function(){return this.hf(),this.lf.disableNetwork()},Ud.prototype.enablePersistence=function(t){var e;if(this.lf)throw new Ir(Er.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var n=!1,r=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Sr("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),n=null!==(e=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==e&&e,r=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,n&&r))throw new Ir(Er.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Ef(this.rf,this.af,{jl:!0,cacheSizeBytes:this.wf.cacheSizeBytes,synchronizeTabs:n,ka:r})},Ud.prototype.clearPersistence=function(){return y(this,void 0,void 0,function(){var n,e=this;return v(this,function(t){if(void 0!==this.lf&&!this.lf.z_)throw new Ir(Er.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new wa,[2,(this.uf.bs(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.rf.clearPersistence(this.__,this.ff)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},Ud.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Ud.prototype,"If",{get:function(){return this.hf(),this.lf.z_},enumerable:!1,configurable:!0}),Ud.prototype.waitForPendingWrites=function(){return this.hf(),this.lf.waitForPendingWrites()},Ud.prototype.onSnapshotsInSync=function(t){return this.hf(),gd(t)||(Xr("Firestore.onSnapshotsInSync","function",1,t),t={next:t}),this.lf.G_(t)},Ud.prototype.hf=function(){return this.lf||this.Ef(new hp,new lp,{jl:!1}),this.lf},Ud.prototype.Af=function(){return new Ei(this.__,this.ff,this.wf.host,this.wf.ssl,this.wf.experimentalForceLongPolling,this.wf.experimentalAutoDetectLongPolling)},Ud.prototype.Ef=function(t,e,n){var r=this.Af();return this.lf=new pd(this.df,this.uf),this.lf.start(r,t,e,n)},Ud._f=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Ir(Er.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e;if(!(t=t.options.projectId)||"string"!=typeof t)throw new Ir(Er.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new _i(t)},Object.defineProperty(Ud.prototype,"app",{get:function(){if(!this.cf)throw new Ir(Er.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.cf},enumerable:!1,configurable:!0}),Ud.prototype.collection=function(t){return Kr("Firestore.collection",arguments,1),Xr("Firestore.collection","non-empty string",1,t),this.hf(),new Kd(Vr.g(t),this,null)},Ud.prototype.doc=function(t){return Kr("Firestore.doc",arguments,1),Xr("Firestore.doc","non-empty string",1,t),this.hf(),Nd.Rf(Vr.g(t),this,null)},Ud.prototype.collectionGroup=function(t){if(Kr("Firestore.collectionGroup",arguments,1),Xr("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Ir(Er.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.hf(),new zd((t=t,new Iu(Vr.P(),t)),this,null)},Ud.prototype.runTransaction=function(e){var n=this;return Kr("Firestore.runTransaction",arguments,1),Xr("Firestore.runTransaction","function",1,e),this.hf().transaction(function(t){return e(new _d(n,t))})},Ud.prototype.batch=function(){return this.hf(),new Ad(this)},Object.defineProperty(Ud,"logLevel",{get:function(){switch(Ar()){case l.DEBUG:return"debug";case l.ERROR:return"error";case l.SILENT:return"silent";case l.WARN:return"warn";case l.INFO:return"info";case l.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),Ud.setLogLevel=function(t){Kr("Firestore.setLogLevel",arguments,1),ti("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Tr.setLogLevel(t)},Ud.prototype.gf=function(){return this.wf.timestampsInSnapshots},Ud.prototype.Pf=function(){return this.wf},Ud),_d=(Cd.prototype.get=function(t){var e=this;Kr("Transaction.get",arguments,1);var n=Zd("Transaction.get",t,this.yf);return this.Vf.v_([n.f_]).then(function(t){if(!t||1!==t.length)return xr();if((t=t[0])instanceof bu)return new Dd(e.yf,n.f_,null,!1,!1,n.d_);if(t instanceof wu)return new Dd(e.yf,n.f_,t,!1,!1,n.d_);throw xr()})},Cd.prototype.set=function(t,e,n){return Qr("Transaction.set",arguments,2,3),t=Zd("Transaction.set",t,this.yf),n=Yd("Transaction.set",n),e=ty(t.d_,e,n),n=Zp(this.yf.mf,"Transaction.set",t.f_,e,null!==t.d_,n),this.Vf.set(t.f_,n),this},Cd.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return e="string"==typeof e||e instanceof yp?(Wr("Transaction.update",arguments,3),r=Zd("Transaction.update",t,this.yf),ed(this.yf.mf,"Transaction.update",r.f_,e,n,i)):(Kr("Transaction.update",arguments,2),r=Zd("Transaction.update",t,this.yf),td(this.yf.mf,"Transaction.update",r.f_,e)),this.Vf.update(r.f_,e),this},Cd.prototype.delete=function(t){return Kr("Transaction.delete",arguments,1),t=Zd("Transaction.delete",t,this.yf),this.Vf.delete(t.f_),this},Cd),Ad=(Pd.prototype.set=function(t,e,n){return Qr("WriteBatch.set",arguments,2,3),this.vf(),t=Zd("WriteBatch.set",t,this.yf),n=Yd("WriteBatch.set",n),e=ty(t.d_,e,n),n=Zp(this.yf.mf,"WriteBatch.set",t.f_,e,null!==t.d_,n),this.pf=this.pf.concat(n.w_(t.f_,Bs.ze())),this},Pd.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return this.vf(),e="string"==typeof e||e instanceof yp?(Wr("WriteBatch.update",arguments,3),r=Zd("WriteBatch.update",t,this.yf),ed(this.yf.mf,"WriteBatch.update",r.f_,e,n,i)):(Kr("WriteBatch.update",arguments,2),r=Zd("WriteBatch.update",t,this.yf),td(this.yf.mf,"WriteBatch.update",r.f_,e)),this.pf=this.pf.concat(e.w_(r.f_,Bs.exists(!0))),this},Pd.prototype.delete=function(t){return Kr("WriteBatch.delete",arguments,1),this.vf(),t=Zd("WriteBatch.delete",t,this.yf),this.pf=this.pf.concat(new au(t.f_,Bs.ze())),this},Pd.prototype.commit=function(){return this.vf(),this.bf=!0,0<this.pf.length?this.yf.hf().write(this.pf):Promise.resolve()},Pd.prototype.vf=function(){if(this.bf)throw new Ir(Er.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Pd),Nd=(n(Rd,wd=Mp),Rd.Rf=function(t,e,n){if(t.length%2!=0)throw new Ir(Er.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.R()+" has "+t.length);return new Rd(new jr(t),e,n)},Object.defineProperty(Rd.prototype,"id",{get:function(){return this.f_.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(Rd.prototype,"parent",{get:function(){return new Kd(this.f_.path.h(),this.firestore,this.d_)},enumerable:!1,configurable:!0}),Object.defineProperty(Rd.prototype,"path",{get:function(){return this.f_.path.R()},enumerable:!1,configurable:!0}),Rd.prototype.collection=function(t){if(Kr("DocumentReference.collection",arguments,1),Xr("DocumentReference.collection","non-empty string",1,t),!t)throw new Ir(Er.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");return t=Vr.g(t),new Kd(this.f_.path.child(t),this.firestore,null)},Rd.prototype.isEqual=function(t){if(!(t instanceof Rd))throw si("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.f_.isEqual(t.f_)&&this.d_===t.d_},Rd.prototype.set=function(t,e){return Qr("DocumentReference.set",arguments,1,2),e=Yd("DocumentReference.set",e),t=ty(this.d_,t,e),e=Zp(this.firestore.mf,"DocumentReference.set",this.f_,t,null!==this.d_,e),this.lf.write(e.w_(this.f_,Bs.ze()))},Rd.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return t="string"==typeof t||t instanceof yp?(Wr("DocumentReference.update",arguments,2),ed(this.firestore.mf,"DocumentReference.update",this.f_,t,e,n)):(Kr("DocumentReference.update",arguments,1),td(this.firestore.mf,"DocumentReference.update",this.f_,t)),this.lf.write(t.w_(this.f_,Bs.exists(!0)))},Rd.prototype.delete=function(){return Kr("DocumentReference.delete",arguments,0),this.lf.write([new au(this.f_,Bs.ze())])},Rd.prototype.onSnapshot=function(){for(var e=this,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];Qr("DocumentReference.onSnapshot",arguments,1,4);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||gd(n[i])||(oi("DocumentReference.onSnapshot",r=n[i],["includeMetadataChanges"]),$r("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};gd(n[i])?(s=n[i],n[i]=null===(r=s.next)||void 0===r?void 0:r.bind(s),n[i+1]=null===(r=s.error)||void 0===r?void 0:r.bind(s),n[i+2]=null===(r=s.complete)||void 0===r?void 0:r.bind(s)):(Xr("DocumentReference.onSnapshot","function",i,n[i]),Yr("DocumentReference.onSnapshot","function",i+1,n[i+1]),Yr("DocumentReference.onSnapshot","function",i+2,n[i+2]));var s={next:function(t){n[i]&&n[i](e.Sf(t))},error:n[i+1],complete:n[i+2]};return this.lf.listen(Su(this.f_.path),o,s)},Rd.prototype.get=function(t){var e=this;Qr("DocumentReference.get",arguments,0,1),$d("DocumentReference.get",t);var n=this.firestore.hf();return t&&"cache"===t.source?n.Q_(this.f_).then(function(t){return new Dd(e.firestore,e.f_,t,!0,t instanceof wu&&t.Je,e.d_)}):n.W_(this.f_,t).then(function(t){return e.Sf(t)})},Rd.prototype.withConverter=function(t){return new Rd(this.f_,this.firestore,t)},Rd.prototype.Sf=function(t){var e=t.docs.get(this.f_);return new Dd(this.firestore,this.f_,e,t.fromCache,t.hasPendingWrites,this.d_)},Rd),Sd=(Od.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Od),Dd=(kd.prototype.data=function(t){var e=this;if(Qr("DocumentSnapshot.data",arguments,0,1),t=Jd("DocumentSnapshot.data",t),this.Df){if(this.d_){var n=new Ld(this.yf,this.f_,this.Df,this.Cf,this.Nf,null);return this.d_.fromFirestore(n,t)}return new bd(this.yf.__,this.yf.gf(),t.serverTimestamps||"none",function(t){return new Nd(t,e.yf,null)},function(t){return new Ti(t)}).X_(this.Df.rn())}},kd.prototype.get=function(t,e){var n=this;if(Qr("DocumentSnapshot.get",arguments,1,2),e=Jd("DocumentSnapshot.get",e),this.Df&&null!==(t=this.Df.data().field(ud("DocumentSnapshot.get",t,this.f_))))return new bd(this.yf.__,this.yf.gf(),e.serverTimestamps||"none",function(t){return new Nd(t,n.yf,n.d_)},function(t){return new Ti(t)}).X_(t)},Object.defineProperty(kd.prototype,"id",{get:function(){return this.f_.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(kd.prototype,"ref",{get:function(){return new Nd(this.f_,this.yf,this.d_)},enumerable:!1,configurable:!0}),Object.defineProperty(kd.prototype,"exists",{get:function(){return null!==this.Df},enumerable:!1,configurable:!0}),Object.defineProperty(kd.prototype,"metadata",{get:function(){return new Sd(this.Nf,this.Cf)},enumerable:!1,configurable:!0}),kd.prototype.isEqual=function(t){if(!(t instanceof kd))throw si("isEqual","DocumentSnapshot",1,t);return this.yf===t.yf&&this.Cf===t.Cf&&this.f_.isEqual(t.f_)&&(null===this.Df?null===t.Df:this.Df.isEqual(t.Df))&&this.d_===t.d_},kd),Ld=(n(xd,md=Dd),xd.prototype.data=function(t){return md.prototype.data.call(this,t)},xd);function xd(){return null!==md&&md.apply(this,arguments)||this}function kd(t,e,n,r,i,o){this.yf=t,this.f_=e,this.Df=n,this.Cf=r,this.Nf=i,this.d_=o}function Od(t,e){this.hasPendingWrites=t,this.fromCache=e}function Rd(t,e,n){var r=this;return(r=wd.call(this,e.__,t,n)||this).f_=t,r.firestore=e,r.d_=n,r.lf=r.firestore.hf(),r}function Pd(t){this.yf=t,this.pf=[],this.bf=!1}function Cd(t,e){this.yf=t,this.Vf=e}function Ud(t,e,n,r){var i=this;if(void 0===n&&(n=new hp),void 0===r&&(r=new lp),this.rf=n,this.af=r,this.cf=null,this.uf=new Ga,this.INTERNAL={delete:function(){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.hf(),[4,this.lf.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options)r=t,this.cf=r,this.__=Ud._f(r),this.ff=r.name,this.df=new _f(e);else{if(!(t=t).projectId)throw new Ir(Er.INVALID_ARGUMENT,"Must provide projectId");this.__=new _i(t.projectId,t.database),this.ff="[DEFAULT]",this.df=new Tf}this.wf=new Id({})}function Vd(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Ir(Er.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Jr("settings","non-empty string","host",t.host),this.host=t.host,$r("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(oi("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","experimentalAutoDetectLongPolling","ignoreUndefinedProperties"]),$r("settings","object","credentials",t.credentials),this.credentials=t.credentials,$r("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),$r("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Sr("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Sr("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(e=t.timestampsInSnapshots)||void 0===e||e,this.ignoreUndefinedProperties=null!==(e=t.ignoreUndefinedProperties)&&void 0!==e&&e,$r("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Pc._o;else{if(t.cacheSizeBytes!==Ed&&t.cacheSizeBytes<Pc.lo)throw new Ir(Er.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Pc.lo);this.cacheSizeBytes=t.cacheSizeBytes}$r("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(e=t.experimentalForceLongPolling)&&void 0!==e&&e,$r("settings","boolean","experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalAutoDetectLongPolling=null!==(e=t.experimentalAutoDetectLongPolling)&&void 0!==e&&e,function(t,e){if(!0===t&&!0===e)throw new Ir(Er.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(t.experimentalForceLongPolling,t.experimentalAutoDetectLongPolling)}function Md(t,e,n,r,i){this.U=t,this.timestampsInSnapshots=e,this.H_=n,this.Y_=r,this.J_=i}function Fd(t,e,n){if("string"==typeof n){if(""===n)throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ou(e)&&-1!==n.indexOf("/"))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child(Vr.g(n)),!jr.F(e))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Go(t,new jr(e))}if(n instanceof Mp)return Go(t,n.f_);throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+ri(n)+".")}function jd(t,e){if(!Array.isArray(t)||0===t.length)throw new Ir(Er.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Ir(Er.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new Ir(Er.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Ir(Er.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function qd(t,e,n){if(!n.isEqual(e))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Gd(t){if(Lu(t)&&0===t.on.length)throw new Ir(Er.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Bd,zd=(Xd.prototype.where=function(t,e,n){return Kr("Query.where",arguments,3),ii("Query.where",3,n),e=ti("Query.where",["<","<=","==","!=",">=",">","array-contains","in","array-contains-any","not-in"],2,e),t=ud("Query.where",t),e=function(t,e,n,r,i,o){if(r.p()){if("array-contains"===i||"array-contains-any"===i)throw new Ir(Er.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){jd(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(Fd(n,t,c))}h={arrayValue:{values:s}}}else h=Fd(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||jd(o,i),h=nd(e,"Query.where",o,"in"===i||"not-in"===i);var h=zu.create(r,i,h);return function(t,e){if(e.hn()){var n=ku(t);if(null!==n&&!n.isEqual(e.field))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=xu(t))&&qd(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new Ir(Er.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Ir(Er.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(this.Ff,this.firestore.mf,this.firestore.__,t,e,n),new Xd((e=(n=this.Ff).filters.concat([e]),new Iu(n.path,n.collectionGroup,n.on.slice(),e,n.limit,n.an,n.startAt,n.endAt)),this.firestore,this.d_)},Xd.prototype.orderBy=function(t,e){if(Qr("Query.orderBy",arguments,1,2),Yr("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Ir(Er.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var n,t=ud("Query.orderBy",t),t=function(t,e,n){if(null!==t.startAt)throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new ma(e,n);return e=r,null!==xu(n=t)||null!==(t=ku(n))&&qd(0,t,e.field),r}(this.Ff,t,n);return new Xd((t=(n=this.Ff).on.concat([t]),new Iu(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.an,n.startAt,n.endAt)),this.firestore,this.d_)},Xd.prototype.limit=function(t){return Kr("Query.limit",arguments,1),Xr("Query.limit","number",1,t),ui("Query.limit",1,t),new Xd(Cu(this.Ff,t,"F"),this.firestore,this.d_)},Xd.prototype.limitToLast=function(t){return Kr("Query.limitToLast",arguments,1),Xr("Query.limitToLast","number",1,t),ui("Query.limitToLast",1,t),new Xd(Cu(this.Ff,t,"L"),this.firestore,this.d_)},Xd.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Wr("Query.startAt",arguments,1),t=this.xf("Query.startAt",t,e,!0),new Xd(Uu(this.Ff,t),this.firestore,this.d_)},Xd.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Wr("Query.startAfter",arguments,1),t=this.xf("Query.startAfter",t,e,!1),new Xd(Uu(this.Ff,t),this.firestore,this.d_)},Xd.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Wr("Query.endBefore",arguments,1),t=this.xf("Query.endBefore",t,e,!0),new Xd(Vu(this.Ff,t),this.firestore,this.d_)},Xd.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Wr("Query.endAt",arguments,1),t=this.xf("Query.endAt",t,e,!1),new Xd(Vu(this.Ff,t),this.firestore,this.d_)},Xd.prototype.isEqual=function(t){if(!(t instanceof Xd))throw si("isEqual","Query",1,t);return this.firestore===t.firestore&&Mu(this.Ff,t.Ff)&&this.d_===t.d_},Xd.prototype.withConverter=function(t){return new Xd(this.Ff,this.firestore,t)},Xd.prototype.xf=function(c,t,e,n){return ii(c,1,t),t instanceof Dd?(Kr(c,i([t],e),1),function(t,e,n,r){if(!n)throw new Ir(Er.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=Ru(t);o<s.length;o++){var u=s[o];if(u.field.p())i.push(Go(e,n.key));else{var a=n.field(u.field);if(xo(a))throw new Ir(Er.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a)throw u=u.field.R(),new Ir(Er.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.");i.push(a)}}return new ha(i,r)}(this.Ff,this.firestore.__,t.Df,n)):(e=[t].concat(e),function(t,e,n,r,i,o){var s=t.on;if(i.length>s.length)throw new Ir(Er.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.p()){if("string"!=typeof c)throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Ou(t)&&-1!==c.indexOf("/"))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(Vr.g(c));if(!jr.F(h))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new jr(h),u.push(Go(e,h))}else c=nd(n,r,c),u.push(c)}return new ha(u,o)}(this.Ff,this.firestore.__,this.firestore.mf,c,e,n))},Xd.prototype.onSnapshot=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Qr("Query.onSnapshot",arguments,1,4);var i={},o=0;"object"!=typeof n[o]||gd(n[o])||(oi("Query.onSnapshot",i=n[o],["includeMetadataChanges"]),$r("Query.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),o++),gd(n[o])?(s=n[o],n[o]=null===(t=s.next)||void 0===t?void 0:t.bind(s),n[o+1]=null===(t=s.error)||void 0===t?void 0:t.bind(s),n[o+2]=null===(t=s.complete)||void 0===t?void 0:t.bind(s)):(Xr("Query.onSnapshot","function",o,n[o]),Yr("Query.onSnapshot","function",o+1,n[o+1]),Yr("Query.onSnapshot","function",o+2,n[o+2]));var s={next:function(t){n[o]&&n[o](new Hd(e.firestore,e.Ff,t,e.d_))},error:n[o+1],complete:n[o+2]};return Gd(this.Ff),this.firestore.hf().listen(this.Ff,i,s)},Xd.prototype.get=function(t){var e=this;Qr("Query.get",arguments,0,1),$d("Query.get",t),Gd(this.Ff);var n=this.firestore.hf();return(t&&"cache"===t.source?n.j_(this.Ff):n.K_(this.Ff,t)).then(function(t){return new Hd(e.firestore,e.Ff,t,e.d_)})},Xd),Hd=(Object.defineProperty(Qd.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Qd.prototype,"empty",{get:function(){return this.kf.docs.m()},enumerable:!1,configurable:!0}),Object.defineProperty(Qd.prototype,"size",{get:function(){return this.kf.docs.size},enumerable:!1,configurable:!0}),Qd.prototype.forEach=function(e,n){var r=this;Qr("QuerySnapshot.forEach",arguments,1,2),Xr("QuerySnapshot.forEach","function",1,e),this.kf.docs.forEach(function(t){e.call(n,r.Lf(t,r.metadata.fromCache,r.kf.Wt.has(t.key)))})},Object.defineProperty(Qd.prototype,"query",{get:function(){return new zd(this.$f,this.yf,this.d_)},enumerable:!1,configurable:!0}),Qd.prototype.docChanges=function(t){if(t&&(oi("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),$r("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges)),(t=!(!t||!t.includeMetadataChanges))&&this.kf.Kt)throw new Ir(Er.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Mf&&this.Of===t||(this.Mf=function(i,e,o){if(i.Qt.m()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Wt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Qt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Wt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return xr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.kf,t,this.Lf.bind(this)),this.Of=t),this.Mf},Qd.prototype.isEqual=function(t){if(!(t instanceof Qd))throw si("isEqual","QuerySnapshot",1,t);return this.yf===t.yf&&Mu(this.$f,t.$f)&&this.kf.isEqual(t.kf)&&this.d_===t.d_},Qd.prototype.Lf=function(t,e,n){return new Ld(this.yf,t.key,t,e,n,this.d_)},Qd),Kd=(n(Wd,Bd=zd),Object.defineProperty(Wd.prototype,"id",{get:function(){return this.Ff.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(Wd.prototype,"parent",{get:function(){var t=this.Ff.path.h();return t.m()?null:new Nd(new jr(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(Wd.prototype,"path",{get:function(){return this.Ff.path.R()},enumerable:!1,configurable:!0}),Wd.prototype.doc=function(t){return Qr("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=hi.k()),Xr("CollectionReference.doc","non-empty string",1,t),t=Vr.g(t),Nd.Rf(this.Ff.path.child(t),this.firestore,this.d_)},Wd.prototype.add=function(t){Kr("CollectionReference.add",arguments,1),Xr("CollectionReference.add","object",1,t=this.d_?this.d_.toFirestore(t):t);var e=this.doc();return new Nd(e.f_,this.firestore,null).set(t).then(function(){return e})},Wd.prototype.withConverter=function(t){return new Wd(this.Bf,this.firestore,t)},Wd);function Wd(t,e,n){var r=this;if(((r=Bd.call(this,Su(t),e,n)||this).Bf=t).length%2!=1)throw new Ir(Er.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.R()+" has "+t.length);return r}function Qd(t,e,n,r){this.yf=t,this.$f=e,this.kf=n,this.d_=r,this.Mf=null,this.Of=null,this.metadata=new Sd(n.hasPendingWrites,n.fromCache)}function Xd(t,e,n){this.Ff=t,this.firestore=e,this.d_=n}function Yd(t,e){if(void 0===e)return{merge:!1};if(oi(t,e,["merge","mergeFields"]),$r(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+ri(n));for(var r,i=0;i<n.length;++i)if(!("string"==typeof(r=n[i])||r instanceof yp))throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+ri(n[i]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new Ir(Er.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function Jd(t,e){return void 0===e?{}:(oi(t,e,["serverTimestamps"]),Zr(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function $d(t,e){Yr(t,"object",1,e),e&&(oi(t,e,["source"]),Zr(t,0,"source",e.source,["default","server","cache"]))}function Zd(t,e,n){if(e instanceof Mp){if(e.firestore!==n)throw new Ir(Er.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw si(t,"DocumentReference",1,e)}function ty(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var ey,ny,be=(n(iy,ey=Up),iy.serverTimestamp=function(){Hr("FieldValue.serverTimestamp",arguments);var t=new kp("serverTimestamp");return t.e_="FieldValue.serverTimestamp",new iy(t)},iy.delete=function(){Hr("FieldValue.delete",arguments);var t=new mp("deleteField");return t.e_="FieldValue.delete",new iy(t)},iy.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Wr("FieldValue.arrayUnion",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Wr("arrayUnion()",arguments,1),new Op("arrayUnion",t)}.apply(void 0,t);return n.e_="FieldValue.arrayUnion",new iy(n)},iy.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Wr("FieldValue.arrayRemove",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Wr("arrayRemove()",arguments,1),new Rp("arrayRemove",t)}.apply(void 0,t);return n.e_="FieldValue.arrayRemove",new iy(n)},iy.increment=function(t){return Xr("FieldValue.increment","number",1,t),Kr("FieldValue.increment",arguments,1),(t=new Pp("increment",t)).e_="FieldValue.increment",new iy(t)},iy.prototype.isEqual=function(t){return this.l_.isEqual(t.l_)},iy),ry={Firestore:Td,GeoPoint:Cp,Timestamp:Ni,Blob:Ti,Transaction:_d,WriteBatch:Ad,DocumentReference:Nd,DocumentSnapshot:Dd,Query:zd,QueryDocumentSnapshot:Ld,QuerySnapshot:Hd,CollectionReference:Kd,FieldPath:yp,FieldValue:be,setLogLevel:Td.setLogLevel,CACHE_SIZE_UNLIMITED:Ed};function iy(){return null!==ey&&ey.apply(this,arguments)||this}(ny=e.default).INTERNAL.registerComponent(new mr("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),r=new lp,t=new fp(r),new Td(e,n,t,r);var e,n,r},"PUBLIC").setServiceProps(Object.assign({},ry))),ny.registerVersion("@firebase/firestore","1.18.0")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});