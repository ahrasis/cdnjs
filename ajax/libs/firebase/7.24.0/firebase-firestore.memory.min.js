!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Mf){"use strict";try{(function(){var u,t,e=(t=Mf)&&"object"==typeof t&&"default"in t?t:{default:t},r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(be=u=u||{})[be.DEBUG=0]="DEBUG",be[be.VERBOSE=1]="VERBOSE",be[be.INFO=2]="INFO",be[be.WARN=3]="WARN",be[be.ERROR=4]="ERROR",be[be.SILENT=5]="SILENT";var a={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},h=u.INFO,c=((Ee={})[u.DEBUG]="log",Ee[u.VERBOSE]="log",Ee[u.INFO]="info",Ee[u.WARN]="warn",Ee[u.ERROR]="error",Ee),l=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?a[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},f);function f(t){this.name=t,this._logLevel=h,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e){return(e=d.call(this,e)||this).code=t,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,t=(t=this.errors[t])?(r=i,t.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").",s=new m(o,t),u=0,a=Object.keys(i);u<a.length;u++){var h=a[u];"_"!==h.slice(-1)&&(h in s&&console.warn('Overwriting FirebaseError base field "'+h+'" can cause unexpected behavior.'),s[h]=i[h])}return s},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,R="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},O=R||self;function S(){}function D(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function L(t){var e=D(t);return"array"==e||"object"==e&&"number"==typeof t.length}function V(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var _="closure_uid_"+(1e9*Math.random()>>>0),U=0;function k(t,e,n){return t.call.apply(t.bind,arguments)}function j(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function P(t,e,n){return(P=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?k:j).apply(null,arguments)}function C(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var M=Date.now;function x(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function F(){this.j=this.j,this.i=this.i}F.prototype.j=!1,F.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,_)&&this[_]||(this[_]=++U))},F.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var q=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},B=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function G(){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function W(t){return/^[\s\xa0]*$/.test(t)}var Q,H=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function X(t,e){return-1!=t.indexOf(e)}function K(t,e){return t<e?-1:e<t?1:0}var Y=O.navigator;function J(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function $(t){var e,n={};for(e in t)n[e]=t[e];return n}Q=(Y=Y&&Y.userAgent)?Y:"";var Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<Z.length;i++)e=Z[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function et(t){return et[" "](t),t}et[" "]=S;var nt,rt=X(Q,"Opera"),it=X(Q,"Trident")||X(Q,"MSIE"),ot=X(Q,"Edge"),st=ot||it,ut=X(Q,"Gecko")&&!(X(Q.toLowerCase(),"webkit")&&!X(Q,"Edge"))&&!(X(Q,"Trident")||X(Q,"MSIE"))&&!X(Q,"Edge"),at=X(Q.toLowerCase(),"webkit")&&!X(Q,"Edge");function ht(){var t=O.document;return t?t.documentMode:void 0}var ct="",lt=(lt=Q,ut?/rv:([^\);]+)(\)|;)/.exec(lt):ot?/Edge\/([\d\.]+)/.exec(lt):it?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(lt):at?/WebKit\/(\S+)/.exec(lt):rt?/(?:Version)[ \/]?(\S+)/.exec(lt):void 0);lt&&(ct=lt?lt[1]:""),nt=it&&null!=(lt=ht())&&lt>parseFloat(ct)?String(lt):ct;var ft={};function pt(u){return t=u,e=function(){for(var t=0,e=H(String(nt)).split("."),n=H(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=K(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||K(0==o[2].length,0==s[2].length)||K(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=ft,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var dt=O.document&&it&&(ht()||parseInt(nt,10))||void 0,yt=!it||9<=Number(dt),vt=it&&!pt("9"),gt=function(){if(!O.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{O.addEventListener("test",S,e),O.removeEventListener("test",S,e)}catch(t){}return t}();function mt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function wt(t,e){if(mt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ut){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:bt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}mt.prototype.b=function(){this.defaultPrevented=!0},x(wt,mt);var bt={2:"touch",3:"pen",4:"mouse"};wt.prototype.b=function(){wt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,vt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Et="closure_listenable_"+(1e6*Math.random()|0),It=0;function Tt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++It,this.Y=this.Z=!1}function At(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Nt(t){this.src=t,this.a={},this.b=0}function Rt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=q(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(At(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Ot(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Nt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Ot(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Tt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var St="closure_lm_"+(1e6*Math.random()|0),Dt={};function Lt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Mt(r),e&&e[Et]?e.wa(n,r,V(i)?!!i.capture:!!i,o):Vt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Lt(t,e[o],n,r,i);return null}return n=Mt(n),t&&t[Et]?t.va(e,n,V(r)?!!r.capture:!!r,i):Vt(t,e,n,!1,r,i)}function Vt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=V(i)?!!i.capture:!!i;if(s&&!yt)return null;var u,a,h=Pt(t);if(h||(t[St]=h=new Nt(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=jt,r=a=yt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)gt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ut(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function _t(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Et]?Rt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ut(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Pt(e))?(Rt(n,t),0==n.b&&(n.src=null,e[St]=null)):At(t)))}function Ut(t){return t in Dt?Dt[t]:Dt[t]="on"+t}function kt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&_t(t),n.call(r,e)}function jt(t,e){if(t.Y)return!0;if(yt)return kt(t,new wt(e,this));if(!e)t:{e=["window","event"];for(var n=O,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return kt(t,e=new wt(e,this))}function Pt(t){return(t=t[St])instanceof Nt?t:null}var Ct="__closure_events_fn_"+(1e9*Math.random()>>>0);function Mt(e){return"function"==D(e)?e:(e[Ct]||(e[Ct]=function(t){return e.handleEvent(t)}),e[Ct])}function xt(){F.call(this),this.c=new Nt(this),(this.J=this).C=null}function Ft(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Rt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}x(xt,F),xt.prototype[Et]=!0,(N=xt.prototype).addEventListener=function(t,e,n,r){Lt(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=V(i)?!!i.capture:!!i,r=Mt(r),e&&e[Et]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Ot(s=e.a[n],r,i,o))&&(At(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Pt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Ot(n,r,i,o)),(r=-1<e?n[e]:null)&&_t(r))}(this,t,e,n,r)},N.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new mt(t,n):t instanceof mt?t.target=t.target||n:(s=t,tt(t=new mt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=Ft(o,r,!0,t)&&s;if(s=Ft(o=t.a=n,r,!0,t)&&s,s=Ft(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=Ft(o=t.a=e[i],r,!1,t)&&s;return s},N.G=function(){if(xt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)At(n[r]);delete e.a[t],e.b--}}this.C=null},N.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},N.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var qt=O.JSON.stringify;function Bt(){this.b=this.a=null}var Gt,zt=(Wt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Wt(function(){return new Qt},function(t){t.reset()},100));function Wt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Qt(){this.next=this.b=this.a=null}function Ht(t,e){var n;Gt||(n=O.Promise.resolve(void 0),Gt=function(){n.then(Yt)}),Xt||(Gt(),Xt=!0),Kt.add(t,e)}Bt.prototype.add=function(t,e){var n=zt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Qt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Xt=!(Qt.prototype.reset=function(){this.next=this.b=this.a=null}),Kt=new Bt;function Yt(){for(var t,e;n=e=void 0,n=null,(e=Kt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){O.setTimeout(function(){throw t},0)}(t)}var n=zt;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Xt=!1}function Jt(t,e){xt.call(this),this.b=t||1,this.a=e||O,this.f=P(this.Ya,this),this.g=M()}function $t(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Zt(t,e,n){if("function"==D(t))n&&(t=P(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=P(t.handleEvent,t)}return 2147483647<Number(e)?-1:O.setTimeout(t,e||0)}x(Jt,xt),(N=Jt.prototype).aa=!1,N.M=null,N.Ya=function(){var t;this.aa&&(0<(t=M()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&($t(this),this.start())))},N.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=M())},N.G=function(){Jt.S.G.call(this),$t(this),delete this.a};var te,ee,ne,re=(T(ee=oe,ne=te=F),ee.prototype=null===ne?Object.create(ne):(ie.prototype=ne.prototype,new ie),oe.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=Zt(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},oe.prototype.G=function(){te.prototype.G.call(this),this.a&&(O.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},oe);function ie(){this.constructor=ee}function oe(t,e,n){var r=te.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function se(t){F.call(this),this.b=t,this.a={}}x(se,F);var ue=[];function ae(t,e,n,r){Array.isArray(n)||(n&&(ue[0]=n.toString()),n=ue);for(var i=0;i<n.length;i++){var o=Lt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function he(t){J(t.a,function(t,e){this.a.hasOwnProperty(e)&&_t(t)},t),t.a={}}function ce(){this.a=!0}function le(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return qt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}se.prototype.G=function(){se.S.G.call(this),he(this)},se.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ce.prototype.info=function(){};var fe=null;function pe(){return fe=fe||new xt}function de(t){mt.call(this,"serverreachability",t)}function ye(){var t=pe();t.dispatchEvent(new de(t))}function ve(t){mt.call(this,"statevent",t)}function ge(){var t=pe();t.dispatchEvent(new ve(t))}function me(t){mt.call(this,"timingevent",t)}function we(t,e){if("function"!=D(t))throw Error("Fn must not be null and must be a function");return O.setTimeout(function(){t()},e)}x(de,mt),x(ve,mt),x(me,mt);var be={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ee={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Ie(){}function Te(t){var e;return(e=t.a)||(e=t.a={}),e}function Ae(){}Ie.prototype.a=null;var Ne,R={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Re(){mt.call(this,"d")}function Oe(){mt.call(this,"c")}function Se(){}function De(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new se(this),this.P=Le,t=st?125:void 0,this.R=new Jt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}x(Re,mt),x(Oe,mt),x(Se,Ie),Ne=new Se;var Le=45e3,Ve={},_e={};function Ue(t,e,n){t.H=1,t.i=tn(Xe(e)),t.j=n,t.I=!0,ke(t,null)}function ke(t,e){t.u=M(),Pe(t),t.l=Xe(t.i);var s,u,a,h,c,l,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),dn(n.b,"t",r),t.D=0,t.a=ur(t.g,t.g.C?e:null),0<t.O&&(t.F=new re(P(t.Ca,t,t.a),t.O)),ae(t.J,t.a,"readystatechange",t.Wa),e=t.B?$(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ye(),s=t.c,u=t.m,a=t.l,h=t.f,c=t.T,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function je(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?_e:(i=Number(u.substring(i,o)),isNaN(i)?Ve:(o+=1)+i>u.length?_e:(u=u.substr(o,i),r.D=o+i,u)));if(u==_e){4==e&&(t.h=4,ge(),s=!1),le(t.c,t.f,null,"[Incomplete Response]");break}if(u==Ve){t.h=4,ge(),le(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}le(t.c,t.f,u,null),qe(t,u)}4==e&&0==n.length&&(t.h=1,ge(),s=!1),t.b=t.b&&s,s?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Zn(e),e.F=!0)):(le(t.c,t.f,n,"[Invalid Chunked Response]"),Fe(t),xe(t))}function Pe(t){t.U=M()+t.P,Ce(t,t.P)}function Ce(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=we(P(t.Ua,t),e)}function Me(t){t.o&&(O.clearTimeout(t.o),t.o=null)}function xe(t){0==t.g.v||t.A||nr(t.g,t)}function Fe(t){Me(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,$t(t.R),he(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function qe(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||En(u.b,t)))if(u.I=t.N,!t.C&&En(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var h=a;if(0==h[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;er(u),zn(u)}$n(u),ge()}}else u.oa=h[1],0<u.oa-u.P&&h[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=we(P(u.Ra,u),6e3));if(bn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else ir(u,11)}else if(!t.C&&u.a!=t||er(u),!W(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)h=e[a],u.P=h[0],h=h[1],2==u.v?"c"==h[0]?(u.J=h[1],u.ga=h[2],null!=(r=h[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=h[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=h[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(X(r,"spdy")||X(r,"quic")||X(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(In(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,Ze(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.V&&(u.N=M()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=sr(n,n.C?n.ga:null,n.fa),i.C?(Tn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Me(o),Pe(o)),n.a=i):Jn(n),0<u.g.length&&Hn(u)):"stop"!=h[0]&&"close"!=h[0]||ir(u,7):3==u.v&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?ir(u,7):Gn(u):"noop"!=h[0]&&u.f&&u.f.sa(h),u.o=0);ye()}catch(t){}}function Be(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(L(t)||"string"==typeof t)B(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(L(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(L(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Ge(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ge)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function ze(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];We(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)We(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function We(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=De.prototype).setTimeout=function(t){this.P=t},N.Wa=function(t){t=t.target;var e=this.F;e&&3==xn(t)?e.f():this.Ca(t)},N.Ca=function(t){try{if(t==this.a)t:{var e=xn(this.a),n=this.a.ua(),r=this.a.X();if(!(e<3||3==e&&!st&&!this.a.$())){this.A||4!=e||7==n||ye(),Me(this);var i=this.a.X();if(this.N=i,n=this.a.$(),this.b=200==i,r=this.c,u=this.m,a=this.l,h=this.f,c=this.T,l=e,f=i,r.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+c+"]: "+u+"\n"+a+"\n"+l+" "+f}),this.b){if(this.V&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!W(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,ge(),Fe(this),xe(this);break t}le(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,qe(this,s)}this.I?(je(this,e,n),st&&this.b&&3==e&&(ae(this.J,this.R,"tick",this.Va),this.R.start())):(le(this.c,this.f,n,null),qe(this,n)),4==e&&Fe(this),this.b&&!this.A&&(4==e?nr(this.g,this):(this.b=!1,Pe(this)))}else 400==i&&0<n.indexOf("Unknown SID")?this.h=3:this.h=0,ge(),Fe(this),xe(this)}}}catch(t){}var u,a,h,c,l,f},N.Va=function(){var t,e;this.a&&(t=xn(this.a),e=this.a.$(),this.D<e.length&&(Me(this),je(this,t,e),this.b&&4!=t&&Pe(this)))},N.cancel=function(){this.A=!0,Fe(this)},N.Ua=function(){this.o=null;var t,e,n=M();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ye(),ge()),Fe(this),this.h=2,xe(this)):Ce(this,this.U-n)},(N=Ge.prototype).K=function(){ze(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.L=function(){return ze(this),this.a.concat()},N.get=function(t,e){return We(this.b,t)?this.b[t]:e},N.set=function(t,e){We(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Qe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function He(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof He?(this.a=void 0!==e?e:t.a,Ke(this,t.f),this.j=t.j,Ye(this,t.c),Je(this,t.h),this.g=t.g,e=t.b,(n=new cn).c=e.c,e.a&&(n.a=new Ge(e.a),n.b=e.b),$e(this,n),this.i=t.i):t&&(n=String(t).match(Qe))?(this.a=!!e,Ke(this,n[1]||"",!0),this.j=en(n[2]||""),Ye(this,n[3]||"",!0),Je(this,n[4]),this.g=en(n[5]||"",!0),$e(this,n[6]||"",!0),this.i=en(n[7]||"")):(this.a=!!e,this.b=new cn(null,this.a))}function Xe(t){return new He(t)}function Ke(t,e,n){t.f=n?en(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ye(t,e,n){t.c=n?en(e,!0):e}function Je(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function $e(t,e,n){var r,i;e instanceof cn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(ln(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(fn(this,e),dn(this,n,t))},r)),r.f=i):(n||(e=nn(e,an)),t.b=new cn(e,t.a))}function Ze(t,e,n){t.b.set(e,n)}function tn(t){return Ze(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^M()).toString(36)),t}function en(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function nn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,rn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function rn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}He.prototype.toString=function(){var t=[],e=this.f;e&&t.push(nn(e,on,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(nn(e,on,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(nn(n,"/"==n.charAt(0)?un:sn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",nn(n,hn)),t.join("")};var on=/[#\/\?@]/g,sn=/[#\?:]/g,un=/[#\?]/g,an=/[#\?@]/g,hn=/#/g;function cn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function ln(u){u.a||(u.a=new Ge,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],o=n,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function fn(t,e){ln(t),e=yn(t,e),We(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,We((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&ze(t)))}function pn(t,e){return ln(t),e=yn(t,e),We(t.a.b,e)}function dn(t,e,n){fn(t,e),0<n.length&&(t.c=null,t.a.set(yn(t,e),z(n)),t.b+=n.length)}function yn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function vn(t,e){this.b=t,this.a=e}function gn(t){this.g=t||mn,t=O.PerformanceNavigationTiming?0<(t=O.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(O.ia&&O.ia.ya&&O.ia.ya()&&O.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(N=cn.prototype).add=function(t,e){ln(this),this.c=null,t=yn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(n,r){ln(this),this.a.forEach(function(t,e){B(t,function(t){n.call(r,t,e,this)},this)},this)},N.L=function(){ln(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},N.K=function(t){ln(this);var e=[];if("string"==typeof t)pn(this,t)&&(e=G(e,this.a.get(yn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=G(e,t[n])}return e},N.set=function(t,e){return ln(this),this.c=null,pn(this,t=yn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var mn=10;function wn(t){return t.b||t.a&&t.a.size>=t.f}function bn(t){return t.b?1:t.a?t.a.size:0}function En(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function In(t,e){t.a?t.a.add(e):t.b=e}function Tn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function An(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return z(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Nn(){}function Rn(){this.a=new Nn}function On(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}gn.prototype.cancel=function(){var t,e;if(this.c=An(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Nn.prototype.stringify=function(t){return O.JSON.stringify(t,void 0)},Nn.prototype.parse=function(t){return O.JSON.parse(t,void 0)};var Sn=O.JSON.parse;function Dn(t){xt.call(this),this.headers=new Ge,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Ln,this.D=this.F=!1}x(Dn,xt);var Ln="",Vn=/^https?$/i,_n=["POST","PUT"];function Un(t){return"content-type"==t.toLowerCase()}function kn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,jn(t),Cn(t)}function jn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Pn(t){if(t.b&&(!t.s[1]||4!=xn(t)||2!=t.X()))if(t.l&&4==xn(t))Zt(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==xn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Qe)[1]||null)&&O.self&&O.self.location&&(i=(r=O.self.location.protocol).substr(0,r.length-1)),n=!Vn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<xn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",jn(t)}}finally{Cn(t)}}}function Cn(t,e){if(t.a){Mn(t);var n=t.a,r=t.s[0]?S:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Mn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(O.clearTimeout(t.m),t.m=null)}function xn(t){return t.a?t.a.readyState:0}function Fn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",J(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Ze(t,e,n))}function qn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Bn(t){this.pa=0,this.g=[],this.c=new ce,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=qn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=qn("baseRetryDelayMs",5e3,t),this.Ma=qn("retryDelaySeedMs",1e4,t),this.Ja=qn("forwardChannelMaxRetries",2,t),this.ma=qn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new gn(t&&t.concurrentRequestLimit),this.ka=new Rn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Gn(t){var e,n;Wn(t),3==t.v&&(e=t.R++,Ze(n=Xe(t.B),"SID",t.J),Ze(n,"RID",e),Ze(n,"TYPE","terminate"),Kn(t,n),(e=new De(t,t.c,e,void 0)).H=2,e.i=tn(Xe(n)),n=!1,O.navigator&&O.navigator.sendBeacon&&(n=O.navigator.sendBeacon(e.i.toString(),"")),!n&&O.Image&&((new Image).src=e.i,n=!0),n||(e.a=ur(e.g,null),e.a.ba(e.i)),e.u=M(),Pe(e)),or(t)}function zn(t){t.a&&(Zn(t),t.a.cancel(),t.a=null)}function Wn(t){zn(t),t.j&&(O.clearTimeout(t.j),t.j=null),er(t),t.b.cancel(),t.h&&("number"==typeof t.h&&O.clearTimeout(t.h),t.h=null)}function Qn(t,e){t.g.push(new vn(t.La++,e)),3==t.v&&Hn(t)}function Hn(t){wn(t.b)||t.h||(t.h=!0,Ht(t.Ba,t),t.u=0)}function Xn(t,e){var n=e?e.f:t.R++,r=Xe(t.B);Ze(r,"SID",t.J),Ze(r,"RID",n),Ze(r,"AID",t.P),Kn(t,r),t.i&&t.l&&Fn(r,t.i,t.l),n=new De(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Yn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),In(t.b,n),Ue(n,r,e)}function Kn(t,n){t.f&&Be({},function(t,e){Ze(n,e,t)})}function Yn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?P(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+h+"_"||"";try{Be(t,function(t,e){var n=t;V(t)&&(n=qt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s)}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Jn(t){t.a||t.j||(t.U=1,Ht(t.Aa,t),t.o=0)}function $n(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=we(P(t.Aa,t),rr(t,t.o)),t.o++,1)}function Zn(t){null!=t.s&&(O.clearTimeout(t.s),t.s=null)}function tr(t){t.a=new De(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Xe(t.la);Ze(e,"RID","rpc"),Ze(e,"SID",t.J),Ze(e,"CI",t.H?"0":"1"),Ze(e,"AID",t.P),Kn(t,e),Ze(e,"TYPE","xmlhttp"),t.i&&t.l&&Fn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=tn(Xe(e)),n.j=null,n.I=!0,ke(n,t)}function er(t){null!=t.m&&(O.clearTimeout(t.m),t.m=null)}function nr(t,e){var n,r=null;if(t.a==e){er(t),Zn(t),t.a=null;var i=2}else{if(!En(t.b,e))return;r=e.s,Tn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b)1==i?(r=e.j?e.j.length:0,e=M()-e.u,n=t.u,(i=pe()).dispatchEvent(new me(i)),Hn(t)):Jn(t);else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(bn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=we(P(t.Ba,t,e),rr(t,t.u)),t.u++,1}}(t,e)||2==i&&$n(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:ir(t,5);break;case 4:ir(t,10);break;case 3:ir(t,6);break;default:ir(t,2)}}function rr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function ir(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=P(t.Xa,t),r||(r=new He("//www.google.com/images/cleardot.gif"),O.location&&"http"==O.location.protocol||Ke(r,"https"),tn(r)),n=r.toString(),r=o,o=new ce,O.Image?((i=new Image).onload=C(On,o,i,"TestLoadImage: loaded",!0,r),i.onerror=C(On,o,i,"TestLoadImage: error",!1,r),i.onabort=C(On,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=C(On,o,i,"TestLoadImage: timeout",!1,r),O.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):ge(),t.v=0,t.f&&t.f.ra(e),or(t),Wn(t)}function or(t){t.v=0,t.I=-1,t.f&&(0==An(t.b).length&&0==t.g.length||(t.b.c.length=0,z(t.g),t.g.length=0),t.f.qa())}function sr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof He?Xe(s):new He(s,void 0);return""!=a.c?(e&&Ye(a,e+"."+a.c),Je(a,a.h)):(r=(u=O.location).protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new He(null,void 0),r&&Ke(u,r),i&&Ye(u,i),o&&Je(u,o),s&&(u.g=s),a=u),t.W&&J(t.W,function(t,e){Ze(a,e,t)}),e=t.A,n=t.na,e&&n&&Ze(a,e,n),Ze(a,"VER",t.ha),Kn(t,a),a}function ur(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Dn(t.Ka)).F=t.C,e}function ar(){}function hr(){if(it&&!(10<=Number(dt)))throw Error("Environmental error: no available transport.")}function cr(t,e){xt.call(this),this.a=new Bn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!W(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!W(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new pr(this)}function lr(t){Re.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function fr(){Oe.call(this),this.status=1}function pr(t){this.a=t}(N=Dn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Te(this.H):Te(Ne),this.a.onreadystatechange=P(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void kn(this,t)}t=n||"";var i,o=new Ge(this.headers);r&&Be(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Un,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=O.FormData&&t instanceof O.FormData,0<=q(_n,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Mn(this),0<this.o&&((this.D=(i=this.a,it&&pt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=P(this.xa,this)):this.m=Zt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){kn(this,t)}},N.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Cn(this))},N.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Cn(this,!0)),Dn.S.G.call(this)},N.za=function(){this.j||(this.A||this.l||this.g?Pn(this):this.Ta())},N.Ta=function(){Pn(this)},N.X=function(){try{return 2<xn(this)?this.a.status:-1}catch(t){return-1}},N.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},N.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Sn(e)}},N.ua=function(){return this.h},N.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=Bn.prototype).ha=8,N.v=1,N.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new De(this,this.c,t,void 0),r=this.l;if(this.O&&(r?tt(r=$(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Yn(this,n,e),Ze(i=Xe(this.B),"RID",t),Ze(i,"CVER",22),this.A&&Ze(i,"X-HTTP-Session-Id",this.A),Kn(this,i),this.i&&r&&Fn(i,this.i,r),In(this.b,n),this.Ga&&Ze(i,"TYPE","init"),this.da?(Ze(i,"$req",e),Ze(i,"SID","null"),n.V=!0,Ue(n,i,null)):Ue(n,i,e),this.v=2}}else 3==this.v&&(t?Xn(this,t):0==this.g.length||wn(this.b)||Xn(this))},N.Aa=function(){var t;this.j=null,tr(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=we(P(this.Sa,this),t))},N.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,zn(this),tr(this))},N.Ra=function(){null!=this.m&&(this.m=null,zn(this),$n(this),ge())},N.Xa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),ge()},(N=ar.prototype).ta=function(){},N.sa=function(){},N.ra=function(){},N.qa=function(){},N.Ha=function(){},hr.prototype.a=function(t,e){return new cr(t,e)},x(cr,xt),(N=cr.prototype).addEventListener=function(t,e,n,r){cr.S.addEventListener.call(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){cr.S.removeEventListener.call(this,t,e,n,r)},N.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;ge(),t.fa=e,t.W=n||{},t.H=t.T,t.B=sr(t,null,t.fa),Hn(t)},N.close=function(){Gn(this.a)},N.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Qn(this.a,e)):this.g?((e={}).__data__=qt(t),Qn(this.a,e)):Qn(this.a,t)},N.G=function(){this.a.f=null,delete this.f,Gn(this.a),delete this.a,cr.S.G.call(this)},x(lr,Re),x(fr,Oe),x(pr,ar),pr.prototype.ta=function(){this.a.dispatchEvent("a")},pr.prototype.sa=function(t){this.a.dispatchEvent(new lr(t))},pr.prototype.ra=function(t){this.a.dispatchEvent(new fr)},pr.prototype.qa=function(){this.a.dispatchEvent("b")},hr.prototype.createWebChannel=hr.prototype.a,cr.prototype.send=cr.prototype.Pa,cr.prototype.open=cr.prototype.Oa,be.NO_ERROR=0,be.TIMEOUT=8,be.HTTP_ERROR=6,Ee.COMPLETE="complete",(Ae.EventType=R).OPEN="a",R.CLOSE="b",R.ERROR="c",R.MESSAGE="d",xt.prototype.listen=xt.prototype.va,Dn.prototype.listenOnce=Dn.prototype.wa,Dn.prototype.getLastError=Dn.prototype.Qa,Dn.prototype.getLastErrorCode=Dn.prototype.ua,Dn.prototype.getStatus=Dn.prototype.X,Dn.prototype.getResponseJson=Dn.prototype.Na,Dn.prototype.getResponseText=Dn.prototype.$,Dn.prototype.send=Dn.prototype.ba;var dr=be,yr=Ee,vr=Ae,gr=Dn,mr=(wr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},wr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},wr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},wr);function wr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var br,Er={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ir=(n(Ar,br=Error),Ar),Tr=new l("@firebase/firestore");function Ar(t,e){var n=this;return(n=br.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Nr(){return Tr.logLevel}function Rr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Tr.logLevel<=u.DEBUG&&(e=n.map(Dr),Tr.debug.apply(Tr,i(["Firestore (7.24.0): "+t],e)))}function Or(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Tr.logLevel<=u.ERROR&&(e=n.map(Dr),Tr.error.apply(Tr,i(["Firestore (7.24.0): "+t],e)))}function Sr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Tr.logLevel<=u.WARN&&(e=n.map(Dr),Tr.warn.apply(Tr,i(["Firestore (7.24.0): "+t],e)))}function Dr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Lr(t){throw void 0===t&&(t="Unexpected state"),Or(t="FIRESTORE (7.24.0) INTERNAL ASSERTION FAILED: "+t),new Error(t)}function Vr(t){t||Lr()}function _r(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Ur(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function kr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var jr,Pr,l=(Object.defineProperty(zr.prototype,"length",{get:function(){return this.t},enumerable:!1,configurable:!0}),zr.prototype.isEqual=function(t){return 0===zr.i(this,t)},zr.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof zr?t.forEach(function(t){e.push(t)}):e.push(t),this.o(e)},zr.prototype.limit=function(){return this.offset+this.length},zr.prototype.u=function(t){return t=void 0===t?1:t,this.o(this.segments,this.offset+t,this.length-t)},zr.prototype.h=function(){return this.o(this.segments,this.offset,this.length-1)},zr.prototype.l=function(){return this.segments[this.offset]},zr.prototype._=function(){return this.get(this.length-1)},zr.prototype.get=function(t){return this.segments[this.offset+t]},zr.prototype.m=function(){return 0===this.length},zr.prototype.T=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},zr.prototype.I=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},zr.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},zr.prototype.A=function(){return this.segments.slice(this.offset,this.limit())},zr.i=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},zr),Cr=(n(Gr,Pr=l),Gr.prototype.o=function(t,e,n){return new Gr(t,e,n)},Gr.prototype.R=function(){return this.A().join("/")},Gr.prototype.toString=function(){return this.R()},Gr.P=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Ir(Er.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new Gr(n)},Gr.g=function(){return new Gr([])},Gr),Mr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,xr=(n(Br,jr=l),Br.prototype.o=function(t,e,n){return new Br(t,e,n)},Br.p=function(t){return Mr.test(t)},Br.prototype.R=function(){return this.A().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),Br.p(t)||(t="`"+t+"`"),t}).join(".")},Br.prototype.toString=function(){return this.R()},Br.prototype.V=function(){return 1===this.length&&"__name__"===this.get(0)},Br.v=function(){return new Br(["__name__"])},Br.S=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Ir(Er.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Ir(Er.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Ir(Er.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Ir(Er.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Br(e)},Br.g=function(){return new Br([])},Br),Fr=(qr.D=function(t){return new qr(Cr.P(t))},qr.C=function(t){return new qr(Cr.P(t).u(5))},qr.prototype.F=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},qr.prototype.isEqual=function(t){return null!==t&&0===Cr.i(this.path,t.path)},qr.prototype.toString=function(){return this.path.toString()},qr.i=function(t,e){return Cr.i(t.path,e.path)},qr.N=function(t){return t.length%2==0},qr.$=function(t){return new qr(new Cr(t.slice()))},qr);function qr(t){this.path=t}function Br(){return null!==jr&&jr.apply(this,arguments)||this}function Gr(){return null!==Pr&&Pr.apply(this,arguments)||this}function zr(t,e,n){void 0===e?e=0:e>t.length&&Lr(),void 0===n?n=t.length-e:n>t.length-e&&Lr(),this.segments=t,this.offset=e,this.t=n}function Wr(t,e){if(0!==e.length)throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+hi(e.length,"argument")+".")}function Qr(t,e,n){if(e.length!==n)throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires "+hi(n,"argument")+", but was called with "+hi(e.length,"argument")+".")}function Hr(t,e,n){if(e.length<n)throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires at least "+hi(n,"argument")+", but was called with "+hi(e.length,"argument")+".")}function Xr(t,e,n,r){if(e.length<n||e.length>r)throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+hi(e.length,"argument")+".")}function Kr(t,e,n,r){ei(t,e,ai(n)+" argument",r)}function Yr(t,e,n,r){void 0!==r&&Kr(t,e,n,r)}function Jr(t,e,n,r){ei(t,e,n+" option",r)}function $r(t,e,n,r){void 0!==r&&Jr(t,e,n,r)}function Zr(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(ri(s))}var u=ri(n);throw new Ir(Er.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function ti(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Ir(Er.INVALID_ARGUMENT,"Invalid value "+ri(r)+" provided to function "+t+"() for its "+ai(n)+" argument. Acceptable values: "+e.join(", "));return r}function ei(t,e,n,r){if(!("object"===e?ni(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e))throw r=ri(r),new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}function ni(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function ri(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Lr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function ii(t,e,n){if(void 0===n)throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+ai(e)+" argument, but it was undefined.")}function oi(n,t,r){Ur(t,function(t,e){if(r.indexOf(t)<0)throw new Ir(Er.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function si(t,e,n,r){return r=ri(r),new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires its "+ai(n)+" argument to be a "+e+", but it was: "+r)}function ui(t,e,n){if(n<=0)throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires its "+ai(e)+" argument to be a positive number, but it was: "+n+".")}function ai(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function hi(t,e){return t+" "+e+(1===t?"":"s")}var ci=(li.k=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},li);function li(){}function fi(t,e){return t<e?-1:e<t?1:0}function pi(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var di=(yi.fromBase64String=function(t){return new yi(atob(t))},yi.fromUint8Array=function(t){return new yi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},yi.prototype.toBase64=function(){return t=this.O,btoa(t);var t},yi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.O)},yi.prototype.L=function(){return 2*this.O.length},yi.prototype.M=function(t){return fi(this.O,t.O)},yi.prototype.isEqual=function(t){return this.O===t.O},yi);function yi(t){this.O=t}di.q=new di("");var vi=(gi.fromBase64String=function(t){try{return new gi(di.fromBase64String(t))}catch(t){throw new Ir(Er.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},gi.fromUint8Array=function(t){return new gi(di.fromUint8Array(t))},gi.prototype.toBase64=function(){return this.U.toBase64()},gi.prototype.toUint8Array=function(){return this.U.toUint8Array()},gi.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},gi.prototype.isEqual=function(t){return this.U.isEqual(t.U)},gi);function gi(t){this.U=t}function mi(){if("undefined"==typeof Uint8Array)throw new Ir(Er.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function wi(){if("undefined"==typeof atob)throw new Ir(Er.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function bi(t,e,n,r,i,o){this.B=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.j=o}var Ei,Ii=(n(Vi,Ei=vi),Vi.fromBase64String=function(t){Qr("Blob.fromBase64String",arguments,1),Kr("Blob.fromBase64String","string",1,t),wi();try{return new Vi(di.fromBase64String(t))}catch(t){throw new Ir(Er.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Vi.fromUint8Array=function(t){if(Qr("Blob.fromUint8Array",arguments,1),mi(),!(t instanceof Uint8Array))throw si("Blob.fromUint8Array","Uint8Array",1,t);return new Vi(di.fromUint8Array(t))},Vi.prototype.toBase64=function(){return Qr("Blob.toBase64",arguments,0),wi(),Ei.prototype.toBase64.call(this)},Vi.prototype.toUint8Array=function(){return Qr("Blob.toUint8Array",arguments,0),mi(),Ei.prototype.toUint8Array.call(this)},Vi.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Vi),Ti=(Object.defineProperty(Li.prototype,"W",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Li.prototype.isEqual=function(t){return t instanceof Li&&t.projectId===this.projectId&&t.database===this.database},Li.prototype.M=function(t){return fi(this.projectId,t.projectId)||fi(this.database,t.database)},Li),Ai=(Di.prototype.get=function(t){var e=this.G(t);if(void 0!==(e=this.H[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.K(i,t))return o}},Di.prototype.has=function(t){return void 0!==this.get(t)},Di.prototype.set=function(t,e){var n=this.G(t),r=this.H[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.K(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.H[n]=[[t,e]]},Di.prototype.delete=function(t){var e=this.G(t),n=this.H[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.K(n[r][0],t))return 1===n.length?delete this.H[e]:n.splice(r,1),!0;return!1},Di.prototype.forEach=function(s){Ur(this.H,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];s(i,o)}})},Di.prototype.m=function(){return kr(this.H)},Di),Ni=(Si.now=function(){return Si.fromMillis(Date.now())},Si.fromDate=function(t){return Si.fromMillis(t.getTime())},Si.fromMillis=function(t){var e=Math.floor(t/1e3);return new Si(e,1e6*(t-1e3*e))},Si.prototype.toDate=function(){return new Date(this.toMillis())},Si.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Si.prototype.Y=function(t){return this.seconds===t.seconds?fi(this.nanoseconds,t.nanoseconds):fi(this.seconds,t.seconds)},Si.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Si.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Si.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},Si.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Si),Ri=(Oi.J=function(t){return new Oi(t)},Oi.min=function(){return new Oi(new Ni(0,0))},Oi.prototype.M=function(t){return this.timestamp.Y(t.timestamp)},Oi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Oi.prototype.X=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Oi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Oi.prototype.Z=function(){return this.timestamp},Oi);function Oi(t){this.timestamp=t}function Si(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Ir(Er.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Ir(Er.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Ir(Er.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Ir(Er.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Di(t,e){this.G=t,this.K=e,this.H={}}function Li(t,e){this.projectId=t,this.database=e||"(default)"}function Vi(){return null!==Ei&&Ei.apply(this,arguments)||this}function _i(t){return null==t}function Ui(t){return 0===t&&1/t==-1/0}var ki=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.tt=null};function ji(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new ki(t,e,n,r,i,o,s)}function Pi(t){var e=t;return null===e.tt&&(t=e.path.R(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.R()+t.op.toString()+Po(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.R()+t.dir}).join(","),_i(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=ra(e.startAt)),e.endAt&&(t+="|ub:",t+=ra(e.endAt)),e.tt=t),e.tt}function Ci(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!_o(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!oa(t.startAt,e.startAt)&&oa(t.endAt,e.endAt)}function Mi(t){return Fr.N(t.path)&&null===t.collectionGroup&&0===t.filters.length}function xi(t){this.count=t}var Fi,qi=(Bi.prototype.st=function(t){return new Bi(this.target,this.targetId,this.et,t,this.nt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Bi.prototype.it=function(t,e){return new Bi(this.target,this.targetId,this.et,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Bi.prototype.rt=function(t){return new Bi(this.target,this.targetId,this.et,this.sequenceNumber,this.nt,t,this.resumeToken)},Bi);function Bi(t,e,n,r,i,o,s){void 0===i&&(i=Ri.min()),void 0===o&&(o=Ri.min()),void 0===s&&(s=di.q),this.target=t,this.targetId=e,this.et=n,this.sequenceNumber=r,this.nt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Gi(t){switch(t){case Er.OK:return Lr(),0;case Er.CANCELLED:case Er.UNKNOWN:case Er.DEADLINE_EXCEEDED:case Er.RESOURCE_EXHAUSTED:case Er.INTERNAL:case Er.UNAVAILABLE:case Er.UNAUTHENTICATED:return;case Er.INVALID_ARGUMENT:case Er.NOT_FOUND:case Er.ALREADY_EXISTS:case Er.PERMISSION_DENIED:case Er.FAILED_PRECONDITION:case Er.ABORTED:case Er.OUT_OF_RANGE:case Er.UNIMPLEMENTED:case Er.DATA_LOSS:return 1;default:return Lr(),0}}function zi(t){if(void 0===t)return Or("GRPC error has no .code"),Er.UNKNOWN;switch(t){case Fi.OK:return Er.OK;case Fi.CANCELLED:return Er.CANCELLED;case Fi.UNKNOWN:return Er.UNKNOWN;case Fi.DEADLINE_EXCEEDED:return Er.DEADLINE_EXCEEDED;case Fi.RESOURCE_EXHAUSTED:return Er.RESOURCE_EXHAUSTED;case Fi.INTERNAL:return Er.INTERNAL;case Fi.UNAVAILABLE:return Er.UNAVAILABLE;case Fi.UNAUTHENTICATED:return Er.UNAUTHENTICATED;case Fi.INVALID_ARGUMENT:return Er.INVALID_ARGUMENT;case Fi.NOT_FOUND:return Er.NOT_FOUND;case Fi.ALREADY_EXISTS:return Er.ALREADY_EXISTS;case Fi.PERMISSION_DENIED:return Er.PERMISSION_DENIED;case Fi.FAILED_PRECONDITION:return Er.FAILED_PRECONDITION;case Fi.ABORTED:return Er.ABORTED;case Fi.OUT_OF_RANGE:return Er.OUT_OF_RANGE;case Fi.UNIMPLEMENTED:return Er.UNIMPLEMENTED;case Fi.DATA_LOSS:return Er.DATA_LOSS;default:return Lr()}}(l=Fi=Fi||{})[l.OK=0]="OK",l[l.CANCELLED=1]="CANCELLED",l[l.UNKNOWN=2]="UNKNOWN",l[l.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",l[l.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",l[l.NOT_FOUND=5]="NOT_FOUND",l[l.ALREADY_EXISTS=6]="ALREADY_EXISTS",l[l.PERMISSION_DENIED=7]="PERMISSION_DENIED",l[l.UNAUTHENTICATED=16]="UNAUTHENTICATED",l[l.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",l[l.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",l[l.ABORTED=10]="ABORTED",l[l.OUT_OF_RANGE=11]="OUT_OF_RANGE",l[l.UNIMPLEMENTED=12]="UNIMPLEMENTED",l[l.INTERNAL=13]="INTERNAL",l[l.UNAVAILABLE=14]="UNAVAILABLE",l[l.DATA_LOSS=15]="DATA_LOSS";var Wi=(Yi.prototype.ot=function(t,e){return new Yi(this.i,this.root.ot(t,e,this.i).copy(null,null,Hi.ut,null,null))},Yi.prototype.remove=function(t){return new Yi(this.i,this.root.remove(t,this.i).copy(null,null,Hi.ut,null,null))},Yi.prototype.get=function(t){for(var e=this.root;!e.m();){var n=this.i(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Yi.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.m();){var r=this.i(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Yi.prototype.m=function(){return this.root.m()},Object.defineProperty(Yi.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Yi.prototype.ct=function(){return this.root.ct()},Yi.prototype.at=function(){return this.root.at()},Yi.prototype.ht=function(t){return this.root.ht(t)},Yi.prototype.forEach=function(n){this.ht(function(t,e){return n(t,e),!1})},Yi.prototype.toString=function(){var n=[];return this.ht(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Yi.prototype.lt=function(t){return this.root.lt(t)},Yi.prototype._t=function(){return new Qi(this.root,null,this.i,!1)},Yi.prototype.ft=function(t){return new Qi(this.root,t,this.i,!1)},Yi.prototype.dt=function(){return new Qi(this.root,null,this.i,!0)},Yi.prototype.wt=function(t){return new Qi(this.root,t,this.i,!0)},Yi),Qi=(Ki.prototype.It=function(){var t=this.Et.pop(),e={key:t.key,value:t.value};if(this.Tt)for(t=t.left;!t.m();)this.Et.push(t),t=t.right;else for(t=t.right;!t.m();)this.Et.push(t),t=t.left;return e},Ki.prototype.At=function(){return 0<this.Et.length},Ki.prototype.Rt=function(){if(0===this.Et.length)return null;var t=this.Et[this.Et.length-1];return{key:t.key,value:t.value}},Ki),Hi=(Xi.prototype.copy=function(t,e,n,r,i){return new Xi(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Xi.prototype.m=function(){return!1},Xi.prototype.ht=function(t){return this.left.ht(t)||t(this.key,this.value)||this.right.ht(t)},Xi.prototype.lt=function(t){return this.right.lt(t)||t(this.key,this.value)||this.left.lt(t)},Xi.prototype.min=function(){return this.left.m()?this:this.left.min()},Xi.prototype.ct=function(){return this.min().key},Xi.prototype.at=function(){return this.right.m()?this.key:this.right.at()},Xi.prototype.ot=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.ot(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.ot(t,e,n))).yt()},Xi.prototype.Pt=function(){if(this.left.m())return Xi.EMPTY;var t=this;return t.left.gt()||t.left.left.gt()||(t=t.Vt()),(t=t.copy(null,null,null,t.left.Pt(),null)).yt()},Xi.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.m()||r.left.gt()||r.left.left.gt()||(r=r.Vt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.gt()&&(r=r.vt()),r.right.m()||r.right.gt()||r.right.left.gt()||(r=r.bt()),0===e(t,r.key)){if(r.right.m())return Xi.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Pt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.yt()},Xi.prototype.gt=function(){return this.color},Xi.prototype.yt=function(){var t=this;return t.right.gt()&&!t.left.gt()&&(t=t.St()),t.left.gt()&&t.left.left.gt()&&(t=t.vt()),t.left.gt()&&t.right.gt()&&(t=t.Dt()),t},Xi.prototype.Vt=function(){var t=this.Dt();return t.right.left.gt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.vt())).St()).Dt()),t},Xi.prototype.bt=function(){var t=this.Dt();return t.left.left.gt()&&(t=(t=t.vt()).Dt()),t},Xi.prototype.St=function(){var t=this.copy(null,null,Xi.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Xi.prototype.vt=function(){var t=this.copy(null,null,Xi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Xi.prototype.Dt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Xi.prototype.Ct=function(){var t=this.Ft();return Math.pow(2,t)<=this.size+1},Xi.prototype.Ft=function(){if(this.gt()&&this.left.gt())throw Lr();if(this.right.gt())throw Lr();var t=this.left.Ft();if(t!==this.right.Ft())throw Lr();return t+(this.gt()?0:1)},Xi);function Xi(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Xi.RED,this.left=null!=r?r:Xi.EMPTY,this.right=null!=i?i:Xi.EMPTY,this.size=this.left.size+1+this.right.size}function Ki(t,e,n,r){this.Tt=r,this.Et=[];for(var i=1;!t.m();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Tt?t.left:t.right;else{if(0===i){this.Et.push(t);break}this.Et.push(t),t=this.Tt?t.right:t.left}}function Yi(t,e){this.i=t,this.root=e||Hi.EMPTY}function Ji(){this.size=0}Hi.EMPTY=null,Hi.RED=!0,Hi.ut=!1,Hi.EMPTY=(Object.defineProperty(Ji.prototype,"key",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ji.prototype,"value",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ji.prototype,"color",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ji.prototype,"left",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ji.prototype,"right",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Ji.prototype.copy=function(t,e,n,r,i){return this},Ji.prototype.ot=function(t,e,n){return new Hi(t,e)},Ji.prototype.remove=function(t,e){return this},Ji.prototype.m=function(){return!0},Ji.prototype.ht=function(t){return!1},Ji.prototype.lt=function(t){return!1},Ji.prototype.ct=function(){return null},Ji.prototype.at=function(){return null},Ji.prototype.gt=function(){return!1},Ji.prototype.Ct=function(){return!0},Ji.prototype.Ft=function(){return 0},new Ji);var $i=(no.prototype.has=function(t){return null!==this.data.get(t)},no.prototype.first=function(){return this.data.ct()},no.prototype.last=function(){return this.data.at()},Object.defineProperty(no.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),no.prototype.indexOf=function(t){return this.data.indexOf(t)},no.prototype.forEach=function(n){this.data.ht(function(t,e){return n(t),!1})},no.prototype.Nt=function(t,e){for(var n=this.data.ft(t[0]);n.At();){var r=n.It();if(0<=this.i(r.key,t[1]))return;e(r.key)}},no.prototype.$t=function(t,e){for(var n=void 0!==e?this.data.ft(e):this.data._t();n.At();)if(!t(n.It().key))return},no.prototype.xt=function(t){return(t=this.data.ft(t)).At()?t.It().key:null},no.prototype._t=function(){return new Zi(this.data._t())},no.prototype.ft=function(t){return new Zi(this.data.ft(t))},no.prototype.add=function(t){return this.copy(this.data.remove(t).ot(t,!0))},no.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},no.prototype.m=function(){return this.data.m()},no.prototype.kt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},no.prototype.isEqual=function(t){if(!(t instanceof no))return!1;if(this.size!==t.size)return!1;for(var e=this.data._t(),n=t.data._t();e.At();){var r=e.It().key,i=n.It().key;if(0!==this.i(r,i))return!1}return!0},no.prototype.A=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},no.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},no.prototype.copy=function(t){var e=new no(this.i);return e.data=t,e},no),Zi=(eo.prototype.It=function(){return this.Ot.It().key},eo.prototype.At=function(){return this.Ot.At()},eo),to=new Wi(Fr.i);function eo(t){this.Ot=t}function no(t){this.i=t,this.data=new Wi(this.i)}var ro=new Wi(Fr.i),io=new Wi(Fr.i),oo=new $i(Fr.i);function so(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=oo,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var uo=new $i(fi),ao=(No.qt=function(t){return new No(t.i)},No.prototype.has=function(t){return null!=this.Lt.get(t)},No.prototype.get=function(t){return this.Lt.get(t)},No.prototype.first=function(){return this.Mt.ct()},No.prototype.last=function(){return this.Mt.at()},No.prototype.m=function(){return this.Mt.m()},No.prototype.indexOf=function(t){return(t=this.Lt.get(t))?this.Mt.indexOf(t):-1},Object.defineProperty(No.prototype,"size",{get:function(){return this.Mt.size},enumerable:!1,configurable:!0}),No.prototype.forEach=function(n){this.Mt.ht(function(t,e){return n(t),!1})},No.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Lt.ot(t.key,t),e.Mt.ot(t,null))},No.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Lt.remove(t),this.Mt.remove(e)):this},No.prototype.isEqual=function(t){if(!(t instanceof No))return!1;if(this.size!==t.size)return!1;for(var e=this.Mt._t(),n=t.Mt._t();e.At();){var r=e.It().key,i=n.It().key;if(!r.isEqual(i))return!1}return!0},No.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},No.prototype.copy=function(t,e){var n=new No;return n.i=this.i,n.Lt=t,n.Mt=e,n},No),ho=(Ao.prototype.track=function(t){var e=t.doc.key,n=this.Ut.get(e);!n||0!==t.type&&3===n.type?this.Ut=this.Ut.ot(e,t):3===t.type&&1!==n.type?this.Ut=this.Ut.ot(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Ut=this.Ut.ot(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Ut=this.Ut.ot(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Ut=this.Ut.remove(e):1===t.type&&2===n.type?this.Ut=this.Ut.ot(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Ut=this.Ut.ot(e,{type:2,doc:t.doc}):Lr()},Ao.prototype.Bt=function(){var n=[];return this.Ut.ht(function(t,e){n.push(e)}),n},Ao),co=(To.zt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new To(t,e,ao.qt(e),i,n,r,!0,!1)},Object.defineProperty(To.prototype,"hasPendingWrites",{get:function(){return!this.jt.m()},enumerable:!1,configurable:!0}),To.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Wt===t.Wt&&this.jt.isEqual(t.jt)&&Ru(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Qt.isEqual(t.Qt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},To),lo=(Io.Xt=function(t,e){var n=new Map;return n.set(t,fo.Zt(t,e)),new Io(Ri.min(),n,uo,to,so())},Io),fo=(Eo.Zt=function(t,e){return new Eo(di.q,e,so(),so(),so())},Eo),po=function(t,e,n,r){this.ie=t,this.removedTargetIds=e,this.key=n,this.re=r},yo=function(t,e){this.targetId=t,this.oe=e},vo=function(t,e,n,r){void 0===n&&(n=di.q),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},go=(Object.defineProperty(bo.prototype,"te",{get:function(){return this.he},enumerable:!1,configurable:!0}),Object.defineProperty(bo.prototype,"resumeToken",{get:function(){return this.ae},enumerable:!1,configurable:!0}),Object.defineProperty(bo.prototype,"_e",{get:function(){return 0!==this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(bo.prototype,"fe",{get:function(){return this.le},enumerable:!1,configurable:!0}),bo.prototype.de=function(t){0<t.L()&&(this.le=!0,this.ae=t)},bo.prototype.we=function(){var n=so(),r=so(),i=so();return this.ce.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Lr()}}),new fo(this.ae,this.he,n,r,i)},bo.prototype.me=function(){this.le=!1,this.ce=Oo()},bo.prototype.Te=function(t,e){this.le=!0,this.ce=this.ce.ot(t,e)},bo.prototype.Ee=function(t){this.le=!0,this.ce=this.ce.remove(t)},bo.prototype.Ie=function(){this.ue+=1},bo.prototype.Ae=function(){--this.ue},bo.prototype.Re=function(){this.le=!0,this.he=!0},bo),mo=(wo.prototype.ve=function(t){for(var e=0,n=t.ie;e<n.length;e++){var r=n[e];t.re instanceof au?this.be(r,t.re):t.re instanceof hu&&this.Se(r,t.key,t.re)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Se(s,t.key,t.re)}},wo.prototype.De=function(n){var r=this;this.Ce(n,function(t){var e=r.Fe(t);switch(n.state){case 0:r.Ne(t)&&e.de(n.resumeToken);break;case 1:e.Ae(),e._e||e.me(),e.de(n.resumeToken);break;case 2:e.Ae(),e._e||r.removeTarget(t);break;case 3:r.Ne(t)&&(e.Re(),e.de(n.resumeToken));break;case 4:r.Ne(t)&&(r.$e(t),e.de(n.resumeToken));break;default:Lr()}})},wo.prototype.Ce=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Pe.forEach(function(t,e){r.Ne(e)&&n(e)})},wo.prototype.xe=function(t){var e=t.targetId,n=t.oe.count;(t=this.ke(e))&&(Mi(t=t.target)?0===n?(t=new Fr(t.path),this.Se(e,t,new hu(t,Ri.min()))):Vr(1===n):this.Oe(e)!==n&&(this.$e(e),this.Ve=this.Ve.add(e)))},wo.prototype.Le=function(r){var i=this,o=new Map;this.Pe.forEach(function(t,e){var n=i.ke(e);n&&(t.te&&Mi(n.target)&&(n=new Fr(n.target.path),null!==i.ge.get(n)||i.Me(e,n)||i.Se(e,n,new hu(n,r))),t.fe&&(o.set(e,t.we()),t.me()))});var s=so();this.pe.forEach(function(t,e){var n=!0;e.$t(function(t){return!(t=i.ke(t))||2===t.et||(n=!1)}),n&&(s=s.add(t))});var t=new lo(r,o,this.Ve,this.ge,s);return this.ge=to,this.pe=Ro(),this.Ve=new $i(fi),t},wo.prototype.be=function(t,e){var n;this.Ne(t)&&(n=this.Me(t,e.key)?2:0,this.Fe(t).Te(e.key,n),this.ge=this.ge.ot(e.key,e),this.pe=this.pe.ot(e.key,this.qe(e.key).add(t)))},wo.prototype.Se=function(t,e,n){var r;this.Ne(t)&&(r=this.Fe(t),this.Me(t,e)?r.Te(e,1):r.Ee(e),this.pe=this.pe.ot(e,this.qe(e).delete(t)),n&&(this.ge=this.ge.ot(e,n)))},wo.prototype.removeTarget=function(t){this.Pe.delete(t)},wo.prototype.Oe=function(t){var e=this.Fe(t).we();return this.ye.Ue(t).size+e.ee.size-e.se.size},wo.prototype.Ie=function(t){this.Fe(t).Ie()},wo.prototype.Fe=function(t){var e=this.Pe.get(t);return e||(e=new go,this.Pe.set(t,e)),e},wo.prototype.qe=function(t){var e=this.pe.get(t);return e||(e=new $i(fi),this.pe=this.pe.ot(t,e)),e},wo.prototype.Ne=function(t){var e=null!==this.ke(t);return e||Rr("WatchChangeAggregator","Detected inactive target",t),e},wo.prototype.ke=function(t){var e=this.Pe.get(t);return e&&e._e?null:this.ye.Be(t)},wo.prototype.$e=function(e){var n=this;this.Pe.set(e,new go),this.ye.Ue(e).forEach(function(t){n.Se(e,t,null)})},wo.prototype.Me=function(t,e){return this.ye.Ue(t).has(e)},wo);function wo(t){this.ye=t,this.Pe=new Map,this.ge=to,this.pe=Ro(),this.Ve=new $i(fi)}function bo(){this.ue=0,this.ce=Oo(),this.ae=di.q,this.he=!1,this.le=!0}function Eo(t,e,n,r,i){this.resumeToken=t,this.te=e,this.ee=n,this.ne=r,this.se=i}function Io(t,e,n,r,i){this.nt=t,this.Kt=e,this.Ht=n,this.Yt=r,this.Jt=i}function To(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Qt=n,this.docChanges=r,this.jt=i,this.fromCache=o,this.Wt=s,this.Gt=u}function Ao(){this.Ut=new Wi(Fr.i)}function No(n){this.i=n?function(t,e){return n(t,e)||Fr.i(t.key,e.key)}:function(t,e){return Fr.i(t.key,e.key)},this.Lt=ro,this.Mt=new Wi(this.i)}function Ro(){return new Wi(Fr.i)}function Oo(){return new Wi(Fr.i)}function So(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Do(t){return t=Co(t.mapValue.fields.__local_write_time__.timestampValue),new Ni(t.seconds,t.nanos)}var Lo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Vo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?So(t)?4:10:Lr()}function _o(r,i){var t,e,n,o=Vo(r);if(o!==Vo(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return Do(r).isEqual(Do(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Co(r.timestampValue),t=Co(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,xo(r.bytesValue).isEqual(xo(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return o=i,Mo((t=r).geoPointValue.latitude)===Mo(o.geoPointValue.latitude)&&Mo(t.geoPointValue.longitude)===Mo(o.geoPointValue.longitude);case 2:return n=i,"integerValue"in(e=r)&&"integerValue"in n?Mo(e.integerValue)===Mo(n.integerValue):"doubleValue"in e&&"doubleValue"in n&&((e=Mo(e.doubleValue))===(n=Mo(n.doubleValue))?Ui(e)===Ui(n):isNaN(e)&&isNaN(n));case 9:return pi(r.arrayValue.values||[],i.arrayValue.values||[],_o);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(_r(e)!==_r(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!_o(e[t],n[t])))return!1;return!0}();default:return Lr()}}function Uo(t,e){return void 0!==(t.values||[]).find(function(t){return _o(t,e)})}function ko(t,e){var n,r,i,o,s=Vo(t),u=Vo(e);if(s!==u)return fi(s,u);switch(s){case 0:return 0;case 1:return fi(t.booleanValue,e.booleanValue);case 2:return n=e,(r=Mo(t.integerValue||t.doubleValue))<(n=Mo(n.integerValue||n.doubleValue))?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return jo(t.timestampValue,e.timestampValue);case 4:return jo(Do(t),Do(e));case 5:return fi(t.stringValue,e.stringValue);case 6:return i=t.bytesValue,o=e.bytesValue,i=xo(i),o=xo(o),i.M(o);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=fi(n[i],r[i]);if(0!==o)return o}return fi(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return s=t.geoPointValue,r=e.geoPointValue,0!==(n=fi(Mo(s.latitude),Mo(r.latitude)))?n:fi(Mo(s.longitude),Mo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=ko(n[i],r[i]);if(o)return o}return fi(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=fi(r[s],o[s]);if(0!==u)return u;if(0!==(u=ko(n[r[s]],i[o[s]])))return u}return fi(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Lr()}}function jo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return fi(t,e);var n=Co(t),t=Co(e);return 0!==(e=fi(n.seconds,t.seconds))?e:fi(n.nanos,t.nanos)}function Po(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=Co(t=i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?xo(i.bytesValue).toBase64():"referenceValue"in i?(e=i.referenceValue,Fr.C(e).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Lr();var t,e}(t)}function Co(t){if(Vr(!!t),"string"!=typeof t)return{seconds:Mo(t.seconds),nanos:Mo(t.nanos)};var e=0,n=Lo.exec(t);return Vr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Mo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function xo(t){return"string"==typeof t?di.fromBase64String(t):di.fromUint8Array(t)}function Fo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.R()}}function qo(t){return t&&"integerValue"in t}function Bo(t){return!!t&&"arrayValue"in t}function Go(t){return t&&"nullValue"in t}function zo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Wo(t){return t&&"mapValue"in t}var Qo={asc:"ASCENDING",desc:"DESCENDING"},Ho={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Xo=function(t,e){this.B=t,this.Qe=e};function Ko(t){return{integerValue:""+t}}function Yo(t,e){if(t.Qe){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ui(e)?"-0":e}}function Jo(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!Ui(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Ko(e):Yo(t,e);var n}function $o(t,e){return t.Qe?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Zo(t,e){return t.Qe?e.toBase64():e.toUint8Array()}function ts(t){return Vr(!!t),Ri.J((t=Co(t),new Ni(t.seconds,t.nanos)))}function es(t,e){return new Cr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).R()}function ns(t,e){return es(t.B,e.path)}function rs(t,e){return Vr(cs(e=Cr.P(e))),Vr(e.get(1)===t.B.projectId),Vr(!e.get(3)&&!t.B.database||e.get(3)===t.B.database),new Fr((Vr(4<(e=e).length&&"documents"===e.get(4)),e.u(5)))}function is(t,e){return es(t.B,e)}function os(t){return new Cr(["projects",t.B.projectId,"databases",t.B.database]).R()}function ss(t,e,n){return{name:ns(t,e),fields:n.proto.mapValue.fields}}function us(t,e){var n,r,i;if(e instanceof Fs)n={update:ss(t,e.key,e.value)};else if(e instanceof Js)n={delete:ns(t,e.key)};else if(e instanceof qs)n={update:ss(t,e.key,e.data),updateMask:(i=e.je,r=[],i.fields.forEach(function(t){return r.push(t.R())}),{fieldPaths:r})};else if(e instanceof Qs)n={transform:{document:ns(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof ds)return{fieldPath:t.field.R(),setToServerValue:"REQUEST_TIME"};if(e instanceof ys)return{fieldPath:t.field.R(),appendMissingElements:{values:e.elements}};if(e instanceof bs)return{fieldPath:t.field.R(),removeAllFromArray:{values:e.elements}};if(e instanceof As)return{fieldPath:t.field.R(),increment:e.We};throw Lr()})}};else{if(!(e instanceof $s))return Lr();n={verify:ns(t,e.key)}}return e.ze.Ge||(n.currentDocument=void 0!==(i=e.ze).updateTime?{updateTime:$o(e=t,(t=i.updateTime).Z())}:void 0!==i.exists?{exists:i.exists}:Lr()),n}function as(t){return{before:t.before,values:t.position}}function hs(t){return{fieldPath:t.R()}}function cs(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function ls(t,e){return t instanceof As?qo(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var fs,ps,ds=(n(gs,ps=l=function(){this.Ke=void 0}),gs),ys=(n(vs,fs=l),vs);function vs(t){var e=this;return(e=fs.call(this)||this).elements=t,e}function gs(){return null!==ps&&ps.apply(this,arguments)||this}function ms(t,e){for(var n=Os(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return _o(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var ws,bs=(n(Es,ws=l),Es);function Es(t){var e=this;return(e=ws.call(this)||this).elements=t,e}function Is(t,e){for(var n=Os(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!_o(t,e)})}(i[r]);return{arrayValue:{values:n}}}var Ts,As=(n(Ns,Ts=l),Ns);function Ns(t,e){var n=this;return(n=Ts.call(this)||this).serializer=t,n.We=e,n}function Rs(t){return Mo(t.integerValue||t.doubleValue)}function Os(t){return Bo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Ss(t,e){this.field=t,this.transform=e}var Ds=(Ls.prototype.He=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].T(t))return!0;return!1},Ls.prototype.isEqual=function(t){return pi(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Ls);function Ls(t){(this.fields=t).sort(xr.i)}function Vs(t,e){this.version=t,this.transformResults=e}var _s=(Us.Ye=function(){return new Us},Us.exists=function(t){return new Us(void 0,t)},Us.updateTime=function(t){return new Us(t)},Object.defineProperty(Us.prototype,"Ge",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Us.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Us);function Us(t,e){this.updateTime=t,this.exists=e}function ks(t,e){return void 0!==t.updateTime?e instanceof au&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof au}function js(t,e,n,r){return t instanceof Fs?(o=e,ks((i=t).ze,o)?(o=Cs(o),new au(i.key,o,i.value,{Je:!0})):o):t instanceof qs?function(t,e){if(!ks(t.ze,e))return e;var n=Cs(e),e=zs(t,e);return new au(t.key,n,e,{Je:!0})}(t,e):t instanceof Qs?function(t,e,n,r){if(!ks(t.ze,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],h=a.transform,c=null;n instanceof au&&(c=n.field(a.field)),null===c&&r instanceof au&&(c=r.field(a.field)),o.push((i=c,a=e,c=void 0,(h=h)instanceof ds?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(c.fields.__previous_value__=i),{mapValue:c}):h instanceof ys?ms(h,i):h instanceof bs?Is(h,i):(i=Rs(h=ls(c=h,i))+Rs(c.We),qo(h)&&qo(c.We)?Ko(i):Yo(c.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=Xs(t,i.data(),r);return new au(t.key,i.version,r,{Je:!0})}(t,e,r,n):(e=e,ks((t=t).ze,e)?new hu(t.key,Ri.min()):e);var i,o}function Ps(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.ze.isEqual(e.ze)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.je.isEqual(e.je):2!==t.type||pi(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof ys&&e instanceof ys||t instanceof bs&&e instanceof bs?pi(t.elements,e.elements,_o):t instanceof As&&e instanceof As?_o(t.We,e.We):t instanceof ds&&e instanceof ds)}))}function Cs(t){return t instanceof au?t.version:Ri.min()}var Ms,xs,Fs=(n(Gs,xs=l=function(){}),Gs),qs=(n(Bs,Ms=l),Bs);function Bs(t,e,n,r){var i=this;return(i=Ms.call(this)||this).key=t,i.data=e,i.je=n,i.ze=r,i.type=1,i}function Gs(t,e,n){var r=this;return(r=xs.call(this)||this).key=t,r.value=e,r.ze=n,r.type=0,r}function zs(t,e){return n=t,e=e instanceof au?e.data():Zs.empty(),r=new tu(e),n.je.fields.forEach(function(t){var e;t.m()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Xe();var n,r}var Ws,Qs=(n(Hs,Ws=l),Hs);function Hs(t,e){var n=this;return(n=Ws.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.ze=_s.exists(!0),n}function Xs(t,e,n){for(var r=new tu(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Xe()}var Ks,Ys,Js=(n(iu,Ys=l),iu),$s=(n(ru,Ks=l),ru),Zs=(nu.empty=function(){return new nu({mapValue:{}})},nu.prototype.field=function(t){if(t.m())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Wo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t._()])||null},nu.prototype.isEqual=function(t){return _o(this.proto,t.proto)},nu),tu=(eu.prototype.set=function(t,e){return this.en(t,e),this},eu.prototype.delete=function(t){return this.en(t,null),this},eu.prototype.en=function(t,e){for(var n=this.tn,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===Vo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t._(),e)},eu.prototype.Xe=function(){var t=this.nn(xr.g(),this.tn);return null!=t?new Zs(t):this.Ze},eu.prototype.nn=function(r,t){var i=this,o=!1,e=this.Ze.field(r),s=Wo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.nn(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},eu);function eu(t){void 0===t&&(t=Zs.empty()),this.Ze=t,this.tn=new Map}function nu(t){this.proto=t}function ru(t,e){var n=this;return(n=Ks.call(this)||this).key=t,n.ze=e,n.type=4,n}function iu(t,e){var n=this;return(n=Ys.call(this)||this).key=t,n.ze=e,n.type=3,n}var ou,su,uu,au=(n(du,uu=l=function(t,e){this.key=t,this.version=e}),du.prototype.field=function(t){return this.sn.field(t)},du.prototype.data=function(){return this.sn},du.prototype.rn=function(){return this.sn.proto},du.prototype.isEqual=function(t){return t instanceof du&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Je===t.Je&&this.hasCommittedMutations===t.hasCommittedMutations&&this.sn.isEqual(t.sn)},du.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.sn.toString()+", {hasLocalMutations: "+this.Je+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(du.prototype,"hasPendingWrites",{get:function(){return this.Je||this.hasCommittedMutations},enumerable:!1,configurable:!0}),du),hu=(n(pu,su=l),pu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(pu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),pu.prototype.isEqual=function(t){return t instanceof pu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},pu),cu=(n(fu,ou=l),fu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(fu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),fu.prototype.isEqual=function(t){return t instanceof fu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},fu),lu=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.on=n,this.filters=r,this.limit=i,this.un=o,this.startAt=s,this.endAt=u,this.cn=null,this.an=null,this.startAt,this.endAt};function fu(){return null!==ou&&ou.apply(this,arguments)||this}function pu(t,e,n){var r=this;return(r=su.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function du(t,e,n,r){var i=this;return(i=uu.call(this,t,e)||this).sn=n,i.Je=!!r.Je,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function yu(t){return new lu(t)}function vu(t){return!_i(t.limit)&&"F"===t.un}function gu(t){return!_i(t.limit)&&"L"===t.un}function mu(t){return 0<t.on.length?t.on[0].field:null}function wu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.hn())return r.field}return null}function bu(t){return null!==t.collectionGroup}function Eu(t){var e=t;if(null===e.cn){e.cn=[];var n=wu(e),t=mu(e);if(null!==n&&null===t)n.V()||e.cn.push(new sa(n)),e.cn.push(new sa(xr.v(),"asc"));else{for(var r=!1,i=0,o=e.on;i<o.length;i++){var s=o[i];e.cn.push(s),s.field.V()&&(r=!0)}r||(n=0<e.on.length?e.on[e.on.length-1].dir:"asc",e.cn.push(new sa(xr.v(),n)))}}return e.cn}function Iu(t){var e=t;if(!e.an)if("F"===e.un)e.an=ji(e.path,e.collectionGroup,Eu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Eu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new sa(o.field,s))}var u=e.endAt?new $u(e.endAt.position,!e.endAt.before):null,t=e.startAt?new $u(e.startAt.position,!e.startAt.before):null;e.an=ji(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.an}function Tu(t,e,n){return new lu(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Au(t,e){return new lu(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.un,e,t.endAt)}function Nu(t,e){return new lu(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.un,t.startAt,e)}function Ru(t,e){return Ci(Iu(t),Iu(e))&&t.un===e.un}function Ou(t){return Pi(Iu(t))+"|lt:"+t.un}function Su(t){return"Query(target="+(n=(e=Iu(t)).path.R(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.R()+" "+t.op+" "+Po(t.value)}).join(", ")+"]"),_i(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.R()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+ra(e.startAt)),e.endAt&&(n+=", endAt: "+ra(e.endAt)),"Target("+n+")")+"; limitType="+t.un+")";var e,n}function Du(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.F(e.collectionGroup)&&e.path.T(n):Fr.N(e.path)?e.path.isEqual(n):e.path.I(n))&&function(t){for(var e=0,n=i.on;e<n.length;e++){var r=n[e];if(!r.field.V()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||ia(t.startAt,Eu(t),n))&&(!t.endAt||!ia(t.endAt,Eu(t),n)));var e,n}function Lu(u){return function(t,e){for(var n=!1,r=0,i=Eu(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i,o;switch(n=t.field.V()?Fr.i(e.key,n.key):(r=t.field,i=n,o=e.field(r),r=i.field(r),null!==o&&null!==r?ko(o,r):Lr()),t.dir){case"asc":return n;case"desc":return-1*n;default:return Lr()}}(o,t,e);if(0!==s)return s;n=n||o.field.V()}return 0}}var Vu,_u=(n(Uu,Vu=function(){}),Uu.create=function(t,e,n){if(t.V())return"in"===e||"not-in"===e?this.ln(t,e,n):new Cu(t,e,n);if(Go(n)){if("=="!==e&&"!="!==e)throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. Null only supports '==' and '!=' comparisons.");return new Uu(t,e,n)}if(zo(n)){if("=="!==e&&"!="!==e)throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. NaN only supports '==' and '!=' comparisons.");return new Uu(t,e,n)}return"array-contains"===e?new Xu(t,n):"in"===e?new Ku(t,n):"not-in"===e?new Yu(t,n):"array-contains-any"===e?new Ju(t,n):new Uu(t,e,n)},Uu.ln=function(t,e,n){return new("in"===e?Mu:xu)(t,n)},Uu.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this._n(ko(t,this.value)):null!==t&&Vo(this.value)===Vo(t)&&this._n(ko(t,this.value))},Uu.prototype._n=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Lr()}},Uu.prototype.hn=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Uu);function Uu(t,e,n){var r=this;return(r=Vu.call(this)||this).field=t,r.op=e,r.value=n,r}var ku,ju,Pu,Cu=(n(Bu,Pu=_u),Bu.prototype.matches=function(t){return t=Fr.i(t.key,this.key),this._n(t)},Bu),Mu=(n(qu,ju=_u),qu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},qu),xu=(n(Fu,ku=_u),Fu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Fu);function Fu(t,e){var n=this;return(n=ku.call(this,t,"not-in",e)||this).keys=Gu(0,e),n}function qu(t,e){var n=this;return(n=ju.call(this,t,"in",e)||this).keys=Gu(0,e),n}function Bu(t,e,n){var r=this;return(r=Pu.call(this,t,e,n)||this).key=Fr.C(n.referenceValue),r}function Gu(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return Fr.C(t.referenceValue)})}var zu,Wu,Qu,Hu,Xu=(n(na,Hu=_u),na.prototype.matches=function(t){return Bo(t=t.field(this.field))&&Uo(t.arrayValue,this.value)},na),Ku=(n(ea,Qu=_u),ea.prototype.matches=function(t){return null!==(t=t.field(this.field))&&Uo(this.value.arrayValue,t)},ea),Yu=(n(ta,Wu=_u),ta.prototype.matches=function(t){return!Uo(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&(null!==(t=t.field(this.field))&&!Uo(this.value.arrayValue,t))},ta),Ju=(n(Zu,zu=_u),Zu.prototype.matches=function(t){var e=this;return!(!Bo(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return Uo(e.value.arrayValue,t)})},Zu),$u=function(t,e){this.position=t,this.before=e};function Zu(t,e){return zu.call(this,t,"array-contains-any",e)||this}function ta(t,e){return Wu.call(this,t,"not-in",e)||this}function ea(t,e){return Qu.call(this,t,"in",e)||this}function na(t,e){return Hu.call(this,t,"array-contains",e)||this}function ra(t){return(t.before?"b":"a")+":"+t.position.map(Po).join(",")}function ia(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.V()?Fr.i(Fr.C(s.referenceValue),n.key):ko(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function oa(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!_o(t.position[n],e.position[n]))return!1;return!0}var sa=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function ua(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var aa=(la.prototype.reset=function(){this.En=0},la.prototype.Rn=function(){this.En=this.Tn},la.prototype.yn=function(t){var e=this;this.cancel();var n=Math.floor(this.En+this.Pn()),r=Math.max(0,Date.now()-this.An),i=Math.max(0,n-r);0<i&&Rr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.En+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.In=this.fn.gn(this.dn,i,function(){return e.An=Date.now(),t()}),this.En*=this.mn,this.En<this.wn&&(this.En=this.wn),this.En>this.Tn&&(this.En=this.Tn)},la.prototype.pn=function(){null!==this.In&&(this.In.Vn(),this.In=null)},la.prototype.cancel=function(){null!==this.In&&(this.In.cancel(),this.In=null)},la.prototype.Pn=function(){return(Math.random()-.5)*this.En},la),ha=(ca.prototype.catch=function(t){return this.next(void 0,t)},ca.prototype.next=function(r,i){var o=this;return this.Dn&&Lr(),this.Dn=!0,this.Sn?this.error?this.Cn(i,this.error):this.Fn(r,this.result):new ca(function(e,n){o.vn=function(t){o.Fn(r,t).next(e,n)},o.bn=function(t){o.Cn(i,t).next(e,n)}})},ca.prototype.Nn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ca.prototype.$n=function(t){try{var e=t();return e instanceof ca?e:ca.resolve(e)}catch(t){return ca.reject(t)}},ca.prototype.Fn=function(t,e){return t?this.$n(function(){return t(e)}):ca.resolve(e)},ca.prototype.Cn=function(t,e){return t?this.$n(function(){return t(e)}):ca.reject(e)},ca.resolve=function(n){return new ca(function(t,e){t(n)})},ca.reject=function(n){return new ca(function(t,e){e(n)})},ca.xn=function(t){return new ca(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},ca.kn=function(t){for(var n=ca.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?ca.resolve(t):e()})}(r[e]);return n},ca.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.xn(i)},ca);function ca(t){var e=this;this.vn=null,this.bn=null,this.result=void 0,this.error=void 0,this.Sn=!1,this.Dn=!1,t(function(t){e.Sn=!0,e.result=t,e.vn&&e.vn(t)},function(t){e.Sn=!0,e.error=t,e.bn&&e.bn(t)})}function la(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.fn=t,this.dn=e,this.wn=n,this.mn=r,this.Tn=i,this.En=0,this.In=null,this.An=Date.now(),this.reset()}function fa(t){return"IndexedDbTransactionError"===t.name}function pa(){return"undefined"!=typeof document?document:null}var da=(ga.Un=function(t,e,n,r,i){return(i=new ga(t,e,Date.now()+n,r,i)).start(n),i},ga.prototype.start=function(t){var e=this;this.Bn=setTimeout(function(){return e.Qn()},t)},ga.prototype.Vn=function(){return this.Qn()},ga.prototype.cancel=function(t){null!==this.Bn&&(this.clearTimeout(),this.qn.reject(new Ir(Er.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},ga.prototype.Qn=function(){var e=this;this.On.jn(function(){return null!==e.Bn?(e.clearTimeout(),e.op().then(function(t){return e.qn.resolve(t)})):Promise.resolve()})},ga.prototype.clearTimeout=function(){null!==this.Bn&&(this.Mn(this),clearTimeout(this.Bn),this.Bn=null)},ga),ya=(Object.defineProperty(va.prototype,"ts",{get:function(){return this.zn},enumerable:!1,configurable:!0}),va.prototype.jn=function(t){this.enqueue(t)},va.prototype.es=function(t){this.ns(),this.ss(t)},va.prototype.rs=function(){var t;this.zn||(this.zn=!0,(t=pa())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Zn))},va.prototype.enqueue=function(t){return this.ns(),this.zn?new Promise(function(t){}):this.ss(t)},va.prototype.os=function(t){var e=this;this.jn(function(){return e.Gn.push(t),e.us()})},va.prototype.us=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Gn.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Gn[0]()];case 2:return t.sent(),this.Gn.shift(),this.Xn.reset(),[3,4];case 3:if(!fa(e=t.sent()))throw e;return Rr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Gn.length&&this.Xn.yn(function(){return n.us()}),t.label=5;case 5:return[2]}})})},va.prototype.ss=function(t){var r=this,e=this.Wn.then(function(){return r.Yn=!0,t().catch(function(t){throw r.Hn=t,r.Yn=!1,Or("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Yn=!1,t})});return this.Wn=e},va.prototype.gn=function(t,e,n){var r=this;return this.ns(),-1<this.Jn.indexOf(t)&&(e=0),n=da.Un(this,t,e,n,function(t){return r.cs(t)}),this.Kn.push(n),n},va.prototype.ns=function(){this.Hn&&Lr()},va.prototype.hs=function(){},va.prototype.ls=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Wn];case 1:t.sent(),t.label=2;case 2:if(e!==this.Wn)return[3,0];t.label=3;case 3:return[2]}})})},va.prototype._s=function(t){for(var e=0,n=this.Kn;e<n.length;e++)if(n[e].dn===t)return!0;return!1},va.prototype.fs=function(r){var i=this;return this.ls().then(function(){i.Kn.sort(function(t,e){return t.Ln-e.Ln});for(var t=0,e=i.Kn;t<e.length;t++){var n=e[t];if(n.Vn(),"all"!==r&&n.dn===r)break}return i.ls()})},va.prototype.ds=function(t){this.Jn.push(t)},va.prototype.cs=function(t){t=this.Kn.indexOf(t),this.Kn.splice(t,1)},va);function va(){var e=this;this.Wn=Promise.resolve(),this.Gn=[],this.zn=!1,this.Kn=[],this.Hn=null,this.Yn=!1,this.Jn=[],this.Xn=new aa(this,"async_queue_retry"),this.Zn=function(){var t=pa();t&&Rr("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.Xn.pn()};var t=pa();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Zn)}function ga(t,e,n,r,i){this.On=t,this.dn=e,this.Ln=n,this.op=r,this.Mn=i,this.qn=new ua,this.then=this.qn.promise.then.bind(this.qn.promise),this.qn.promise.catch(function(t){})}function ma(t,e){if(Or("AsyncQueue",e+": "+t),fa(t))return new Ir(Er.UNAVAILABLE,e+": "+t);throw t}function wa(){this.ws=void 0,this.listeners=[]}function ba(){this.Ts=new Ai(Ou,Ru),this.onlineState="Unknown",this.Es=new Set}function Ea(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.Ts.get(n))||(r=!0,i=new wa),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Is(n)];case 2:return o.ws=t.sent(),[3,4];case 3:return o=ma(o=t.sent(),"Initialization of query '"+Su(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.Ts.set(n,i),i.listeners.push(u),u.As(e.onlineState),i.ws&&u.Rs(i.ws)&&Ta(e),[2]}})})}function Ia(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.Ts.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.Ts.delete(n),e.ys(n))]:[2]})})}function Ta(t){t.Es.forEach(function(t){t.next()})}var Aa=(Oa.prototype.Rs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new co(t.query,t.docs,t.Qt,e,t.jt,t.fromCache,t.Wt,!0)}var o=!1;return this.gs?this.Vs(t)&&(this.Ps.next(t),o=!0):this.vs(t,this.onlineState)&&(this.bs(t),o=!0),this.ps=t,o},Oa.prototype.onError=function(t){this.Ps.error(t)},Oa.prototype.As=function(t){this.onlineState=t;var e=!1;return this.ps&&!this.gs&&this.vs(this.ps,t)&&(this.bs(this.ps),e=!0),e},Oa.prototype.vs=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Ss&&n||t.docs.m()&&"Offline"!==e)},Oa.prototype.Vs=function(t){if(0<t.docChanges.length)return!0;var e=this.ps&&this.ps.hasPendingWrites!==t.hasPendingWrites;return!(!t.Wt&&!e)&&!0===this.options.includeMetadataChanges},Oa.prototype.bs=function(t){t=co.zt(t.query,t.docs,t.jt,t.fromCache),this.gs=!0,this.Ps.next(t)},Oa),Na=(Ra.prototype.Ds=function(){return null!=this.uid},Ra.prototype.Cs=function(){return this.Ds()?"uid:"+this.uid:"anonymous-user"},Ra.prototype.isEqual=function(t){return t.uid===this.uid},Ra);function Ra(t){this.uid=t}function Oa(t,e,n){this.query=t,this.Ps=e,this.gs=!1,this.ps=null,this.onlineState="Unknown",this.options=n||{}}Na.UNAUTHENTICATED=new Na(null),Na.Fs=new Na("google-credentials-uid"),Na.Ns=new Na("first-party-uid");var Sa=(Da.prototype.xs=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Da.prototype.next=function(){var t=++this.previousValue;return this.ks&&this.ks(t),t},Da);function Da(t,e){var n=this;this.previousValue=t,e&&(e.$s=function(t){return n.xs(t)},this.ks=function(t){return e.Os(t)})}Sa.Ls=-1;var La=(Ga.prototype.Ms=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Ga.prototype.qs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Ga.prototype.Us=function(){var t={activeTargetIds:this.activeTargetIds.A(),updateTimeMs:Date.now()};return JSON.stringify(t)},Ga),Va=(Ba.prototype.Ws=function(t){},Ba.prototype.Gs=function(t,e,n){},Ba.prototype.zs=function(t){return this.Bs.Ms(t),this.Qs[t]||"not-current"},Ba.prototype.Ks=function(t,e,n){this.Qs[t]=e},Ba.prototype.Hs=function(t){this.Bs.qs(t)},Ba.prototype.Ys=function(t){return this.Bs.activeTargetIds.has(t)},Ba.prototype.Js=function(t){delete this.Qs[t]},Ba.prototype.Xs=function(){return this.Bs.activeTargetIds},Ba.prototype.Zs=function(t){return this.Bs.activeTargetIds.has(t)},Ba.prototype.start=function(){return this.Bs=new La,Promise.resolve()},Ba.prototype.ti=function(t,e,n){},Ba.prototype.ei=function(t){},Ba.prototype.ni=function(){},Ba.prototype.Os=function(t){},Ba),_a=(qa.prototype.ii=function(t,e,n){for(var r,i,o,s,u,a,h=n.ri,c=0;c<this.mutations.length;c++){var l=this.mutations[c];l.key.isEqual(t)&&(r=l,i=e,o=h[c],a=u=s=void 0,e=r instanceof Fs?new au(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof qs?(u=i,a=o,ks((s=r).ze,u)?(u=zs(s,u),new au(s.key,a.version,u,{hasCommittedMutations:!0})):new cu(s.key,a.version)):r instanceof Qs?function(t,e,n){if(Vr(null!=n.transformResults),!ks(t.ze,e))return new cu(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Vr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof au&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof ys?ms(o,s):o instanceof bs?Is(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=Xs(t,r.data(),e);return new au(t.key,n,e,{hasCommittedMutations:!0})}(r,i,o):new hu(r.key,o.version,{hasCommittedMutations:!0}))}return e},qa.prototype.oi=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=js(i,e,e,this.si))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=js(a,e,o,this.si))}return e},qa.prototype.ui=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.oi(t.key,n.get(t.key));e&&(i=i.ot(t.key,e))}),i},qa.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},so())},qa.prototype.isEqual=function(t){return this.batchId===t.batchId&&pi(this.mutations,t.mutations,Ps)&&pi(this.baseMutations,t.baseMutations,Ps)},qa),Ua=(Fa.from=function(t,e,n){Vr(t.mutations.length===n.length);for(var r=io,i=t.mutations,o=0;o<i.length;o++)r=r.ot(i[o].key,n[o].version);return new Fa(t,e,n,r)},Fa),ka=(xa.prototype.fi=function(e,n){var r=this;return this.li.di(e,n).next(function(t){return r.wi(e,n,t)})},xa.prototype.wi=function(t,r,i){return this.hi.mi(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].oi(r,t);return t})},xa.prototype.Ti=function(t,e,i){var o=to;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].oi(t,e);o=o.ot(t,e)}),o},xa.prototype.Ei=function(e,t){var n=this;return this.hi.getEntries(e,t).next(function(t){return n.Ii(e,t)})},xa.prototype.Ii=function(e,r){var i=this;return this.li.Ai(e,r).next(function(t){var t=i.Ti(e,r,t),n=to;return t.forEach(function(t,e){e=e||new hu(t,Ri.min()),n=n.ot(t,e)}),n})},xa.prototype.Ri=function(t,e,n){return r=e,Fr.N(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.yi(t,e.path):bu(e)?this.Pi(t,e,n):this.gi(t,e,n);var r},xa.prototype.yi=function(t,e){return this.fi(t,new Fr(e)).next(function(t){var e=ro;return t instanceof au&&(e=e.ot(t.key,t)),e})},xa.prototype.Pi=function(n,r,i){var o=this,s=r.collectionGroup,u=ro;return this._i.pi(n,s).next(function(t){return ha.forEach(t,function(t){var e=(e=r,t=t.child(s),new lu(t,null,e.on.slice(),e.filters.slice(),e.limit,e.un,e.startAt,e.endAt));return o.gi(n,e,i).next(function(t){t.forEach(function(t,e){u=u.ot(t,e)})})}).next(function(){return u})})},xa.prototype.gi=function(e,n,t){var h,c,r=this;return this.hi.Ri(e,n,t).next(function(t){return h=t,r.li.Vi(e,n)}).next(function(t){return c=t,r.vi(e,c,h).next(function(t){h=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=js(s,a=h.get(u),a,r.si);h=a instanceof au?h.ot(u,a):h.remove(u)}})}).next(function(){return h.forEach(function(t,e){Du(n,e)||(h=h.remove(t))}),h})},xa.prototype.vi=function(t,e,n){for(var r=so(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof qs&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.hi.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof au&&(h=h.ot(t,e))}),h})},xa),ja=(Ma.Di=function(t,e){for(var n=so(),r=so(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Ma(t,e.fromCache,n,r)},Ma),Pa=(Ca.$i=function(t){return new Ca(t,Ca.xi,Ca.ki)},Ca);function Ca(t,e,n){this.Ci=t,this.Fi=e,this.Ni=n}function Ma(t,e,n,r){this.targetId=t,this.fromCache=e,this.bi=n,this.Si=r}function xa(t,e,n){this.hi=t,this.li=e,this._i=n}function Fa(t,e,n,r){this.batch=t,this.ci=e,this.ri=n,this.ai=r}function qa(t,e,n,r){this.batchId=t,this.si=e,this.baseMutations=n,this.mutations=r}function Ba(){this.Bs=new La,this.Qs={},this.js=null,this.$s=null}function Ga(){this.activeTargetIds=uo}Pa.Oi=-1,Pa.Li=1048576,Pa.Mi=41943040,Pa.xi=10,Pa.ki=1e3,Pa.qi=new Pa(Pa.Mi,Pa.xi,Pa.ki),Pa.Ui=new Pa(Pa.Oi,0,0);var za=(Ja.prototype.Qi=function(t,e){return this.Bi.add(e),ha.resolve()},Ja.prototype.pi=function(t,e){return ha.resolve(this.Bi.getEntries(e))},Ja),Wa=(Ya.prototype.add=function(t){var e=t._(),n=t.h(),r=this.index[e]||new $i(Cr.i),t=!r.has(n);return this.index[e]=r.add(n),t},Ya.prototype.has=function(t){var e=t._(),t=t.h();return(e=this.index[e])&&e.has(t)},Ya.prototype.getEntries=function(t){return(this.index[t]||new $i(Cr.i)).A()},Ya),Qa=(Ka.prototype.next=function(){return this.ji+=2,this.ji},Ka.Wi=function(){return new Ka(0)},Ka.Gi=function(){return new Ka(-1)},Ka),Ha=(Xa.prototype.rr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.ur(t,n.Ki)})},Xa);function Xa(t,e,n){this.persistence=t,this.zi=e,this.Ki=new Wi(fi),this.Hi=new Ai(Pi,Ci),this.Yi=Ri.min(),this.li=t.Ji(n),this.Xi=t.Zi(),this.tr=t.er(),this.nr=new ka(this.Xi,this.li,this.persistence.sr()),this.zi.ir(this.nr)}function Ka(t){this.ji=t}function Ya(){this.index={}}function Ja(){this.Bi=new Wa}function $a(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.tr.dr(t)})}function Za(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).Ki.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Rr.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!fa(r=t.sent()))throw r;return Rr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.Ki=e.Ki.remove(o),e.Hi.delete(n.target),[2]}})})}function th(t,o,s){var u=t,a=Ri.min(),h=so();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=Iu(o),(void 0!==(t=(i=t).Hi.get(r))?ha.resolve(i.Ki.get(t)):i.tr.gr(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.tr.pr(e,t.targetId).next(function(t){h=t})}).next(function(){return u.zi.Ri(e,o,s?a:Ri.min(),s?h:so())}).next(function(t){return{documents:t,Vr:h}});var t,n,r,i})}function eh(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Er.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Rr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function nh(t,e){this.user=e,this.type="OAuth",this.Br={},this.Br.Authorization="Bearer "+t}function rh(t,e,n,r,i){var o=this;this.Qo=t,this.jo=e,this.On=n,this.Wo={},this.Go=[],this.zo=new Map,this.Ko=new Set,this.Ho=[],this.Yo=i,this.Yo.Jo(function(t){n.jn(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Ch(this)?(Rr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Ko.add(4),[4,Dh(e)];case 1:return t.sent(),e.Xo.set("Unknown"),e.Ko.delete(4),[4,Sh(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Xo=new vh(n,r)}var ih,oh,sh,uh=(Oh.prototype.m=function(){return this.vr.m()},Oh.prototype.Cr=function(t,e){e=new ah(t,e),this.vr=this.vr.add(e),this.Sr=this.Sr.add(e)},Oh.prototype.Fr=function(t,e){var n=this;t.forEach(function(t){return n.Cr(t,e)})},Oh.prototype.Nr=function(t,e){this.$r(new ah(t,e))},Oh.prototype.kr=function(t,e){var n=this;t.forEach(function(t){return n.Nr(t,e)})},Oh.prototype.Or=function(t){var e=this,n=new Fr(new Cr([])),r=new ah(n,t),t=new ah(n,t+1),i=[];return this.Sr.Nt([r,t],function(t){e.$r(t),i.push(t.key)}),i},Oh.prototype.Lr=function(){var e=this;this.vr.forEach(function(t){return e.$r(t)})},Oh.prototype.$r=function(t){this.vr=this.vr.delete(t),this.Sr=this.Sr.delete(t)},Oh.prototype.Mr=function(t){var e=new Fr(new Cr([])),n=new ah(e,t),t=new ah(e,t+1),r=so();return this.Sr.Nt([n,t],function(t){r=r.add(t.key)}),r},Oh.prototype.qr=function(t){var e=new ah(t,0);return null!==(e=this.vr.xt(e))&&t.isEqual(e.key)},Oh),ah=(Rh.br=function(t,e){return Fr.i(t.key,e.key)||fi(t.Ur,e.Ur)},Rh.Dr=function(t,e){return fi(t.Ur,e.Ur)||Fr.i(t.key,e.key)},Rh),hh=(Nh.prototype.getToken=function(){return Promise.resolve(null)},Nh.prototype.jr=function(){},Nh.prototype.Wr=function(t){(this.Qr=t)(Na.UNAUTHENTICATED)},Nh.prototype.Gr=function(){this.Qr=null},Nh),ch=(Ah.prototype.getToken=function(){var e=this,n=this.Hr,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.Hr!==n?(Rr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Vr("string"==typeof t.accessToken),new nh(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Ah.prototype.jr=function(){this.forceRefresh=!0},Ah.prototype.Wr=function(t){this.Qr=t,this.Kr&&t(this.currentUser)},Ah.prototype.Gr=function(){this.auth&&this.auth.removeAuthTokenListener(this.zr),this.zr=null,this.Qr=null},Ah.prototype.Yr=function(){var t=this.auth&&this.auth.getUid();return Vr(null===t||"string"==typeof t),new Na(t)},Ah),lh=(Object.defineProperty(Th.prototype,"Br",{get:function(){var t={"X-Goog-AuthUser":this.Xr},e=this.Jr.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Th),fh=(Ih.prototype.getToken=function(){return Promise.resolve(new lh(this.Jr,this.Xr))},Ih.prototype.Wr=function(t){t(Na.Ns)},Ih.prototype.Gr=function(){},Ih.prototype.jr=function(){},Ih),l=(Eh.prototype.ro=function(){return 1===this.state||2===this.state||4===this.state},Eh.prototype.oo=function(){return 2===this.state},Eh.prototype.start=function(){3!==this.state?this.auth():this.uo()},Eh.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.ro()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Eh.prototype.co=function(){this.state=0,this.Xn.reset()},Eh.prototype.ao=function(){var t=this;this.oo()&&null===this.io&&(this.io=this.fn.gn(this.Zr,6e4,function(){return t.ho()}))},Eh.prototype.lo=function(t){this._o(),this.stream.send(t)},Eh.prototype.ho=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.oo()?[2,this.close(0)]:[2]})})},Eh.prototype._o=function(){this.io&&(this.io.cancel(),this.io=null)},Eh.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this._o(),this.Xn.cancel(),this.so++,3!==e?this.Xn.reset():n&&n.code===Er.RESOURCE_EXHAUSTED?(Or(n.toString()),Or("Using maximum backoff delay to prevent overloading the backend."),this.Xn.Rn()):n&&n.code===Er.UNAUTHENTICATED&&this.no.jr(),null!==this.stream&&(this.fo(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.do(n)];case 1:return t.sent(),[2]}})})},Eh.prototype.fo=function(){},Eh.prototype.auth=function(){var n=this;this.state=1;var t=this.wo(this.so),e=this.so;this.no.getToken().then(function(t){n.so===e&&n.mo(t)},function(e){t(function(){var t=new Ir(Er.UNKNOWN,"Fetching auth token failed: "+e.message);return n.To(t)})})},Eh.prototype.mo=function(t){var e=this,n=this.wo(this.so);this.stream=this.Eo(t),this.stream.Io(function(){n(function(){return e.state=2,e.listener.Io()})}),this.stream.do(function(t){n(function(){return e.To(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Eh.prototype.uo=function(){var t=this;this.state=4,this.Xn.yn(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},Eh.prototype.To=function(t){return Rr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Eh.prototype.wo=function(e){var n=this;return function(t){n.fn.jn(function(){return n.so===e?t():(Rr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Eh),ph=(n(bh,sh=l),bh.prototype.Eo=function(t){return this.eo.Ao("Listen",t)},bh.prototype.onMessage=function(t){this.Xn.reset();var e,n=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:Lr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.Qe?(Vr(void 0===o||"string"==typeof o),di.fromBase64String(o||"")):(Vr(void 0===o||o instanceof Uint8Array),di.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Er.UNKNOWN:zi(s.code),new Ir(o,s.message||"")),r=new vo(n,r,i,s||null)}else if("documentChange"in e){e.documentChange,(a=e.documentChange).document,a.document.name,a.document.updateTime;var i=rs(t,a.document.name),u=ts(a.document.updateTime),s=new Zs({mapValue:{fields:a.document.fields}}),u=new au(i,u,s,{}),s=a.targetIds||[],a=a.removedTargetIds||[];r=new po(s,a,u.key,u)}else if("documentDelete"in e){e.documentDelete,(a=e.documentDelete).document;var u=rs(t,a.document),h=a.readTime?ts(a.readTime):Ri.min(),h=new hu(u,h),a=a.removedTargetIds||[];r=new po([],a,h.key,h)}else if("documentRemove"in e){e.documentRemove,(h=e.documentRemove).document;var c=rs(t,h.document),h=h.removedTargetIds||[];r=new po([],h,c,null)}else{if(!("filter"in e))return Lr();e.filter,(c=e.filter).targetId,e=new xi(e=c.count||0),c=c.targetId,r=new yo(c,e)}return r}(this.serializer,t),t=!("targetChange"in(e=t))||(e=e.targetChange).targetIds&&e.targetIds.length||!e.readTime?Ri.min():ts(e.readTime);return this.listener.Ro(n,t)},bh.prototype.yo=function(t){var e,n,r,i,o,s,u,a,h={};h.database=os(this.serializer),h.addTarget=(e=this.serializer,(r=Mi(r=(n=t).target)?{documents:{documents:[is(e,r.path)]}}:{query:(i=e,s={structuredQuery:{}},u=(o=r).path,null!==o.collectionGroup?(s.parent=is(i,u),s.structuredQuery.from=[{collectionId:o.collectionGroup,allDescendants:!0}]):(s.parent=is(i,u.h()),s.structuredQuery.from=[{collectionId:u._()}]),(u=function(t){if(0!==t.length)return 1===(t=t.map(function(t){if("=="===t.op){if(zo(t.value))return{unaryFilter:{field:hs(t.field),op:"IS_NAN"}};if(Go(t.value))return{unaryFilter:{field:hs(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(zo(t.value))return{unaryFilter:{field:hs(t.field),op:"IS_NOT_NAN"}};if(Go(t.value))return{unaryFilter:{field:hs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:hs(t.field),op:(e=t.op,Ho[e]),value:t.value}};var e})).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(o.filters))&&(s.structuredQuery.where=u),(u=function(t){if(0!==t.length)return t.map(function(t){return{field:hs((t=t).field),direction:(t=t.dir,Qo[t])}})}(o.orderBy))&&(s.structuredQuery.orderBy=u),u=o.limit,null!==(u=i.Qe||_i(u)?u:{value:u})&&(s.structuredQuery.limit=u),o.startAt&&(s.structuredQuery.startAt=as(o.startAt)),o.endAt&&(s.structuredQuery.endAt=as(o.endAt)),s)}).targetId=n.targetId,0<n.resumeToken.L()&&(r.resumeToken=Zo(e,n.resumeToken)),r),(t=(this.serializer,a=t,null==(t=function(){switch(a.et){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Lr()}}())?null:{"goog-listen-tags":t}))&&(h.labels=t),this.lo(h)},bh.prototype.Po=function(t){var e={};e.database=os(this.serializer),e.removeTarget=t,this.lo(e)},bh),dh=(n(wh,oh=l),Object.defineProperty(wh.prototype,"Vo",{get:function(){return this.po},enumerable:!1,configurable:!0}),wh.prototype.start=function(){this.po=!1,this.lastStreamToken=void 0,oh.prototype.start.call(this)},wh.prototype.fo=function(){this.po&&this.vo([])},wh.prototype.Eo=function(t){return this.eo.Ao("Write",t)},wh.prototype.onMessage=function(t){if(Vr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.po){this.Xn.reset();var e=(n=t.writeResults,i=t.commitTime,n&&0<n.length?(Vr(void 0!==i),n.map(function(t){return n=i,(r=(e=t).updateTime?ts(e.updateTime):ts(n)).isEqual(Ri.min())&&(r=ts(n)),n=null,e.transformResults&&0<e.transformResults.length&&(n=e.transformResults),new Vs(r,n);var e,n,r})):[]),n=ts(t.commitTime);return this.listener.bo(n,e)}var i;return Vr(!t.writeResults||0===t.writeResults.length),this.po=!0,this.listener.So()},wh.prototype.Do=function(){var t={};t.database=os(this.serializer),this.lo(t)},wh.prototype.vo=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return us(e.serializer,t)})};this.lo(t)},wh),yh=(n(mh,ih=function(){}),mh.prototype.Fo=function(){if(this.Co)throw new Ir(Er.FAILED_PRECONDITION,"The client has already been terminated.")},mh.prototype.No=function(e,n,r){var i=this;return this.Fo(),this.credentials.getToken().then(function(t){return i.eo.No(e,n,r,t)}).catch(function(t){throw t.code===Er.UNAUTHENTICATED&&i.credentials.jr(),t})},mh.prototype.$o=function(e,n,r){var i=this;return this.Fo(),this.credentials.getToken().then(function(t){return i.eo.$o(e,n,r,t)}).catch(function(t){throw t.code===Er.UNAUTHENTICATED&&i.credentials.jr(),t})},mh.prototype.terminate=function(){this.Co=!1},mh),vh=(gh.prototype.Lo=function(){var t=this;0===this.xo&&(this.Mo("Unknown"),this.ko=this.On.gn("online_state_timeout",1e4,function(){return t.ko=null,t.qo("Backend didn't respond within 10 seconds."),t.Mo("Offline"),Promise.resolve()}))},gh.prototype.Uo=function(t){"Online"===this.state?this.Mo("Unknown"):(this.xo++,1<=this.xo&&(this.Bo(),this.qo("Connection failed 1 times. Most recent error: "+t.toString()),this.Mo("Offline")))},gh.prototype.set=function(t){this.Bo(),this.xo=0,"Online"===t&&(this.Oo=!1),this.Mo(t)},gh.prototype.Mo=function(t){t!==this.state&&(this.state=t,this.js(t))},gh.prototype.qo=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.Oo?(Or(t),this.Oo=!1):Rr("OnlineStateTracker",t)},gh.prototype.Bo=function(){null!==this.ko&&(this.ko.cancel(),this.ko=null)},gh);function gh(t,e){this.On=t,this.js=e,this.state="Unknown",this.xo=0,this.ko=null,this.Oo=!0}function mh(t,e,n){var r=this;return(r=ih.call(this)||this).credentials=t,r.eo=e,r.serializer=n,r.Co=!1,r}function wh(t,e,n,r,i){var o=this;return(o=oh.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.po=!1,o}function bh(t,e,n,r,i){var o=this;return(o=sh.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Eh(t,e,n,r,i,o){this.fn=t,this.Zr=n,this.eo=r,this.no=i,this.listener=o,this.state=0,this.so=0,this.io=null,this.stream=null,this.Xn=new aa(t,e)}function Ih(t,e){this.Jr=t,this.Xr=e}function Th(t,e){this.Jr=t,this.Xr=e,this.type="FirstParty",this.user=Na.Ns}function Ah(t){var e=this;this.zr=null,this.currentUser=Na.UNAUTHENTICATED,this.Kr=!1,this.Hr=0,this.Qr=null,this.forceRefresh=!1,this.zr=function(){e.Hr++,e.currentUser=e.Yr(),e.Kr=!0,e.Qr&&e.Qr(e.currentUser)},this.Hr=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.zr):(this.zr(null),t.get().then(function(t){e.auth=t,e.zr&&e.auth.addAuthTokenListener(e.zr)},function(){}))}function Nh(){this.Qr=null}function Rh(t,e){this.key=t,this.Ur=e}function Oh(){this.vr=new $i(ah.br),this.Sr=new $i(ah.Dr)}function Sh(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!Ch(r))return[3,4];e=0,n=r.Ho,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Dh(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.Ho,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Lh(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Rr("RemoteStore","RemoteStore shutting down."),e.Ko.add(5),[4,Dh(e)];case 1:return t.sent(),e.Yo.ni(),e.Xo.set("Unknown"),[2]}})})}function Vh(t,e){t.zo.has(e.targetId)||(t.zo.set(e.targetId,e),Ph(t)?jh(t):zh(t).oo()&&Uh(t,e))}function _h(t,e){var n=t,t=zh(n);n.zo.delete(e),t.oo()&&kh(n,e),0===n.zo.size&&(t.oo()?t.ao():Ch(n)&&n.Xo.set("Unknown"))}function Uh(t,e){t.Zo.Ie(e.targetId),zh(t).yo(e)}function kh(t,e){t.Zo.Ie(e),zh(t).Po(e)}function jh(e){e.Zo=new mo({Ue:function(t){return e.Wo.Ue(t)},Be:function(t){return e.zo.get(t)||null}}),zh(e).start(),e.Xo.Lo()}function Ph(t){return Ch(t)&&!zh(t).ro()&&0<t.zo.size}function Ch(t){return 0===t.Ko.size}function Mh(t){t.Zo=void 0}function xh(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!fa(r))throw r;return n.Ko.add(1),[4,Dh(n)];case 1:return t.sent(),n.Xo.set("Offline"),i=i||function(){return $a(n.Qo)},n.On.os(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Rr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Ko.delete(1),[4,Sh(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function Fh(e,n){return n().catch(function(t){return xh(e,t,n)})}function qh(c){return y(this,void 0,void 0,function(){var s,u,a,h;return v(this,function(t){switch(t.label){case 0:u=Wh(s=c),a=0<s.Go.length?s.Go[s.Go.length-1].batchId:-1,t.label=1;case 1:if(!(Ch(s)&&s.Go.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(r=s.Qo,i=a,(o=r).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===i&&(i=-1),o.li.Pr(t,i)}))];case 3:return null===(h=t.sent())?(0===s.Go.length&&u.ao(),[3,7]):(a=h.batchId,n=h,(e=s).Go.push(n),(e=Wh(e)).oo()&&e.Vo&&e.vo(n.mutations),[3,6]);case 4:return h=t.sent(),[4,xh(s,h)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Bh(s)&&Gh(s),[2]}var e,n,r,i,o})})}function Bh(t){return Ch(t)&&!Wh(t).ro()&&0<t.Go.length}function Gh(t){Wh(t).start()}function zh(n){var t,e,r,i=this;return n.iu||(n.iu=(t=n.jo,e=n.On,r={Io:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.zo.forEach(function(t,e){Uh(n,t)}),[2]})})}.bind(null,n),do:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return Mh(e),Ph(e)?(e.Xo.Uo(n),jh(e)):e.Xo.set("Unknown"),[2]})})}.bind(null,n),Ro:function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Xo.set("Online"),!(u instanceof vo&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.zo.has(i)?[4,o.Wo.tu(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.zo.delete(i),o.Zo.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Rr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,xh(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof po?s.Zo.ve(u):u instanceof yo?s.Zo.xe(u):s.Zo.De(u),a.isEqual(Ri.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,$a(s.Qo)];case 8:return o=t.sent(),0<=a.M(o)?[4,(i=a,(e=(r=s).Zo.Le(i)).Kt.forEach(function(t,e){var n;0<t.resumeToken.L()&&(n=r.zo.get(e))&&r.zo.set(e,n.it(t.resumeToken,i))}),e.Ht.forEach(function(t){var e=r.zo.get(t);e&&(r.zo.set(t,e.it(di.q,e.nt)),kh(r,t),e=new qi(e.target,t,1,e.sequenceNumber),Uh(r,e))}),r.Wo.eu(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Rr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,xh(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n)},t.Fo(),new ph(e,t.eo,t.credentials,t.serializer,r)),n.Ho.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.iu.co(),Ph(n)?jh(n):n.Xo.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.iu.stop()];case 2:t.sent(),Mh(n),t.label=3;case 3:return[2]}})})})),n.iu}function Wh(n){var t,e,r,i=this;return n.ru||(n.ru=(t=n.jo,e=n.On,r={Io:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return Wh(e).Do(),[2]})})}.bind(null,n),do:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&Wh(e).Vo?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Gi(n=i.code)&&n!==Er.ABORTED?(e=r.Go.shift(),Wh(r).co(),[4,Fh(r,function(){return r.Wo.su(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,qh(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Bh(e)&&Gh(e),[2]}})})}.bind(null,n),So:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=Wh(o),n=0,r=o.Go;n<r.length;n++)i=r[n],e.vo(i.mutations);return[2]})})}.bind(null,n),bo:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Go.shift(),n=Ua.from(e,i,o),[4,Fh(r,function(){return r.Wo.nu(n)})];case 1:return t.sent(),[4,qh(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Fo(),new dh(e,t.eo,t.credentials,t.serializer,r)),n.Ho.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.ru.co(),[4,qh(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.ru.stop()];case 3:t.sent(),0<n.Go.length&&(Rr("RemoteStore","Stopping write stream with "+n.Go.length+" pending writes"),n.Go=[]),t.label=4;case 4:return[2]}})})})),n.ru}function Qh(t,e,n){this.query=t,this.targetId=e,this.view=n}var Hh=function(t){this.key=t},Xh=function(t){this.key=t},Kh=(Object.defineProperty(Zh.prototype,"lu",{get:function(){return this.ou},enumerable:!1,configurable:!0}),Zh.prototype._u=function(t,e){var s=this,u=e?e.fu:new ho,a=(e||this).hu,h=(e||this).jt,c=a,l=!1,f=vu(this.query)&&a.size===this.query.limit?a.last():null,p=gu(this.query)&&a.size===this.query.limit?a.first():null;if(t.ht(function(t,e){var n=a.get(t),r=(r=e instanceof au?e:null)&&(Du(s.query,r)?r:null),i=!!n&&s.jt.has(n.key),o=!!r&&(r.Je||s.jt.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.du(n,r)||(u.track({type:2,doc:r}),e=!0,(f&&0<s.au(r,f)||p&&s.au(r,p)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(h=r?(c=c.add(r),o?h.add(t):h.delete(t)):(c=c.delete(t),h.delete(t)))}),vu(this.query)||gu(this.query))for(;c.size>this.query.limit;){var n=vu(this.query)?c.last():c.first(),c=c.delete(n.key),h=h.delete(n.key);u.track({type:1,doc:n})}return{hu:c,fu:u,wu:l,jt:h}},Zh.prototype.du=function(t,e){return t.Je&&e.hasCommittedMutations&&!e.Je},Zh.prototype.mu=function(t,e,n){var o=this,r=this.hu;this.hu=t.hu,this.jt=t.jt;var i=t.fu.Bt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.au(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Lr()}}var r,i}),this.Tu(n);var s=e?this.Eu():[],e=(n=0===this.cu.size&&this.te?1:0)!==this.uu;return this.uu=n,0!==i.length||e?{snapshot:new co(this.query,t.hu,r,i,t.jt,0==n,e,!1),Iu:s}:{Iu:s}},Zh.prototype.As=function(t){return this.te&&"Offline"===t?(this.te=!1,this.mu({hu:this.hu,fu:new ho,jt:this.jt,wu:!1},!1)):{Iu:[]}},Zh.prototype.Au=function(t){return!this.ou.has(t)&&!!this.hu.has(t)&&!this.hu.get(t).Je},Zh.prototype.Tu=function(t){var e=this;t&&(t.ee.forEach(function(t){return e.ou=e.ou.add(t)}),t.ne.forEach(function(t){}),t.se.forEach(function(t){return e.ou=e.ou.delete(t)}),this.te=t.te)},Zh.prototype.Eu=function(){var e=this;if(!this.te)return[];var n=this.cu;this.cu=so(),this.hu.forEach(function(t){e.Au(t.key)&&(e.cu=e.cu.add(t.key))});var r=[];return n.forEach(function(t){e.cu.has(t)||r.push(new Xh(t))}),this.cu.forEach(function(t){n.has(t)||r.push(new Hh(t))}),r},Zh.prototype.Ru=function(t){return this.ou=t.Vr,this.cu=so(),t=this._u(t.documents),this.mu(t,!0)},Zh.prototype.yu=function(){return co.zt(this.query,this.hu,this.jt,0===this.uu)},Zh),Yh=function(t){this.key=t,this.Pu=!1},Jh=(Object.defineProperty($h.prototype,"Mu",{get:function(){return!0===this.Lu},enumerable:!1,configurable:!0}),$h);function $h(t,e,n,r,i,o){this.Qo=t,this.gu=e,this.pu=n,this.Vu=r,this.currentUser=i,this.vu=o,this.bu={},this.Su=new Ai(Ou,Ru),this.Du=new Map,this.Cu=[],this.Fu=new Wi(Fr.i),this.Nu=new Map,this.$u=new uh,this.xu={},this.ku=new Map,this.Ou=Qa.Gi(),this.onlineState="Unknown",this.Lu=void 0}function Zh(t,e){this.query=t,this.ou=e,this.uu=null,this.te=!1,this.cu=so(),this.jt=so(),this.au=Lu(t),this.hu=new ao(this.au)}function tc(f,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:(o=f).gu.Wo.nu=function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Qo,c=s,(l=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=c.batch.keys(),n=l.Xi.cr({ar:!0}),i=l,o=t,s=n,u=(r=c).batch,a=u.keys(),h=ha.resolve();return a.forEach(function(n){h=h.next(function(){return s.mi(o,n)}).next(function(t){var e=t;Vr(null!==(t=r.ai.get(n))),(!e||e.version.M(t)<0)&&(e=u.ii(n,e,r))&&s.hr(e,r.ci)})}),h.next(function(){return i.li.lr(o,u)}).next(function(){return n.apply(t)}).next(function(){return l.li._r(t)}).next(function(){return l.nr.Ei(t,e)})}))];case 2:return i=t.sent(),ic(n,r,null),rc(n,r),n.Vu.Gs(r,"acknowledged"),[4,hc(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,eh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,c,l})})}.bind(null,o),o.gu.Wo.su=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Qo,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.li.Gu(e,r).next(function(t){return Vr(null!==t),n=t.keys(),i.li.lr(e,t)}).next(function(){return i.li._r(e)}).next(function(){return i.nr.Ei(e,n)})}))];case 2:return o=t.sent(),ic(n,u,a),rc(n,u),n.Vu.Gs(u,"rejected",a),[4,hc(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,eh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.Qo,a=p,c=r,l=Ni.now(),i=a.reduce(function(t,e){return t.add(e.key)},so()),c.persistence.runTransaction("Locally write mutations","readwrite",function(u){return c.nr.Ei(u,i).next(function(t){h=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=h.get(i.key),s instanceof Qs?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof au?t.field(i.field):void 0;null!=(o=ls(i.transform,o||null))&&(e=(null==e?new tu:e).set(i.field,o))}return e?e.Xe():null}(o):null);null!=o&&e.push(new qs(i.key,o,function s(t){var u=[];return Ur(t.fields||{},function(t,e){var n=new xr([t]);if(Wo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Ds(u)}(o.proto.mapValue),_s.exists(!0)))}return c.li.ju(u,l,e,a)})}).then(function(t){var e=t.ui(h);return{batchId:t.batchId,Wu:e}}))];case 2:return s=t.sent(),u.Vu.Ws(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.xu[e.currentUser.Cs()])||new Wi(fi)).ot(n,o),e.xu[e.currentUser.Cs()]=r,[4,hc(u,s.Wu)];case 3:return t.sent(),[4,qh(u.gu)];case 4:return t.sent(),[3,6];case 5:return u=ma(u=t.sent(),"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,h,c,l,i,o})})}function ec(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:n=i,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Qo,h=e,c=(a=o).nt,l=h.Ki,h.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var i=h.Xi.cr({ar:!0});l=h.Ki;var u=[];a.Kt.forEach(function(t,e){var n,r,i,o=l.get(e);o&&(u.push(h.tr.wr(s,t.se,e).next(function(){return h.tr.mr(s,t.ee,e)})),0<(i=t.resumeToken).L()&&(n=o.it(i,c).st(s.Tr),l=l.ot(e,n),r=o,i=t,Vr(0<(o=n).resumeToken.L()),(0===r.resumeToken.L()||3e8<=o.nt.X()-r.nt.X()||0<i.ee.size+i.ne.size+i.se.size)&&u.push(h.tr.Er(s,n))))});var t,o=to,n=so();return a.Yt.forEach(function(t,e){n=n.add(t)}),u.push(i.getEntries(s,n).next(function(r){a.Yt.forEach(function(t,e){var n=r.get(t);e instanceof hu&&e.version.isEqual(Ri.min())?(i.Ir(t,c),o=o.ot(t,e)):null==n||0<e.version.M(n.version)||0===e.version.M(n.version)&&n.hasPendingWrites?(i.hr(e,c),o=o.ot(t,e)):Rr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Jt.has(t)&&u.push(h.persistence.Rr.Ar(s,t))})})),c.isEqual(Ri.min())||(t=h.tr.dr(s).next(function(t){return h.tr.yr(s,s.Tr,c)}),u.push(t)),ha.xn(u).next(function(){return i.apply(s)}).next(function(){return h.nr.Ii(s,o)})}).then(function(t){return h.Ki=l,t}))];case 2:return r=t.sent(),o.Kt.forEach(function(t,e){(e=n.Nu.get(e))&&(Vr(t.ee.size+t.ne.size+t.se.size<=1),0<t.ee.size?e.Pu=!0:0<t.ne.size?Vr(e.Pu):0<t.se.size&&(Vr(e.Pu),e.Pu=!1))}),[4,hc(n,r,o)];case 3:return t.sent(),[3,6];case 4:return[4,eh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,a,h,c,l})})}function nc(t,n,e){var r;((t=t).Mu&&0===e||!t.Mu&&1===e)&&(r=[],t.Su.forEach(function(t,e){(e=e.view.As(n)).snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.Ts.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].As(i)&&(o=!0)}),o&&Ta(t)}(t.pu,n),r.length&&t.bu.Ro(r),t.onlineState=n,t.Mu&&t.Vu.ei(n))}function rc(t,e){(t.ku.get(e)||[]).forEach(function(t){t.resolve()}),t.ku.delete(e)}function ic(t,e,n){var r=t,i=r.xu[r.currentUser.Cs()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.xu[r.currentUser.Cs()]=i)}function oc(e,t,n){void 0===n&&(n=null),e.Vu.Hs(t);for(var r=0,i=e.Du.get(t);r<i.length;r++){var o=i[r];e.Su.delete(o),n&&e.bu.qu(o,n)}e.Du.delete(t),e.Mu&&e.$u.Or(t).forEach(function(t){e.$u.qr(t)||sc(e,t)})}function sc(t,e){var n=t.Fu.get(e);null!==n&&(_h(t.gu,n),t.Fu=t.Fu.remove(e),t.Nu.delete(n),ac(t))}function uc(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var u=s[o];u instanceof Hh?(t.$u.Cr(u.key,e),r=t,i=(i=u).key,r.Fu.get(i)||(Rr("SyncEngine","New document in limbo: "+i),r.Cu.push(i),ac(r))):u instanceof Xh?(Rr("SyncEngine","Document no longer in limbo: "+u.key),t.$u.Nr(u.key,e),t.$u.qr(u.key)||sc(t,u.key)):Lr()}}function ac(t){for(;0<t.Cu.length&&t.Fu.size<t.vu;){var e=t.Cu.shift(),n=t.Ou.next();t.Nu.set(n,new Yh(e)),t.Fu=t.Fu.ot(e,n),Vh(t.gu,new qi(Iu(yu(e.path)),n,2,Sa.Ls))}}function hc(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Su.m()?[3,3]:(n.Su.forEach(function(t,e){o.push(n.Qu(e,s,u).then(function(t){t&&(n.Mu&&n.Vu.Ks(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=ja.Di(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.bu.Ro(r),[4,function(a,h){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return ha.forEach(h,function(e){return ha.forEach(e.bi,function(t){return r.persistence.Rr.Cr(n,e.targetId,t)}).next(function(){return ha.forEach(e.Si,function(t){return r.persistence.Rr.Nr(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!fa(e=t.sent()))throw e;return Rr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=h;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.Ki.get(o),u=s.nt,u=s.rt(u),r.Ki=r.Ki.ot(o,u));return[2]}})})}(n.Qo,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}var cc,lc,fc,pc=(Fc.prototype.ir=function(t){this.Xu=t},Fc.prototype.Ri=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.on.length||1===r.on.length&&r.on[0].field.V())||i.isEqual(Ri.min())?this.Zu(e,r):this.Xu.Ei(e,o).next(function(t){var n=s.tc(r,t);return(vu(r)||gu(r))&&s.wu(r.un,n,o,i)?s.Zu(e,r):(Nr()<=u.DEBUG&&Rr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Su(r)),s.Xu.Ri(e,r,i).next(function(e){return n.forEach(function(t){e=e.ot(t.key,t)}),e}))})},Fc.prototype.tc=function(n,t){var r=new $i(Lu(n));return t.forEach(function(t,e){e instanceof au&&Du(n,e)&&(r=r.add(e))}),r},Fc.prototype.wu=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version.M(r))},Fc.prototype.Zu=function(t,e){return Nr()<=u.DEBUG&&Rr("IndexFreeQueryEngine","Using full collection scan to execute query:",Su(e)),this.Xu.Ri(t,e,Ri.min())},Fc),dc=(xc.prototype.sc=function(t){return ha.resolve(0===this.li.length)},xc.prototype.ju=function(t,e,n,r){var i=this.ec;this.ec++,0<this.li.length&&this.li[this.li.length-1],n=new _a(i,e,n,r),this.li.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.nc=this.nc.add(new ah(u.key,i)),this._i.Qi(t,u.key.path.h())}return ha.resolve(n)},xc.prototype.Gu=function(t,e){return ha.resolve(this.ic(e))},xc.prototype.Pr=function(t,e){return e+=1,e=(e=this.rc(e))<0?0:e,ha.resolve(this.li.length>e?this.li[e]:null)},xc.prototype.zu=function(){return ha.resolve(0===this.li.length?-1:this.ec-1)},xc.prototype.Ku=function(t){return ha.resolve(this.li.slice())},xc.prototype.di=function(t,e){var n=this,r=new ah(e,0),e=new ah(e,Number.POSITIVE_INFINITY),i=[];return this.nc.Nt([r,e],function(t){t=n.ic(t.Ur),i.push(t)}),ha.resolve(i)},xc.prototype.Ai=function(t,e){var n=this,r=new $i(fi);return e.forEach(function(t){var e=new ah(t,0),t=new ah(t,Number.POSITIVE_INFINITY);n.nc.Nt([e,t],function(t){r=r.add(t.Ur)})}),ha.resolve(this.oc(r))},xc.prototype.Vi=function(t,e){var n=e.path,r=n.length+1,e=n;Fr.N(e)||(e=e.child(""));var e=new ah(new Fr(e),0),i=new $i(fi);return this.nc.$t(function(t){var e=t.key.path;return!!n.T(e)&&(e.length===r&&(i=i.add(t.Ur)),!0)},e),ha.resolve(this.oc(i))},xc.prototype.oc=function(t){var e=this,n=[];return t.forEach(function(t){null!==(t=e.ic(t))&&n.push(t)}),n},xc.prototype.lr=function(n,r){var i=this;Vr(0===this.uc(r.batchId,"removed")),this.li.shift();var o=this.nc;return ha.forEach(r.mutations,function(t){var e=new ah(t.key,r.batchId);return o=o.delete(e),i.Rr.cc(n,t.key)}).next(function(){i.nc=o})},xc.prototype.ac=function(t){},xc.prototype.qr=function(t,e){var n=new ah(e,0),n=this.nc.xt(n);return ha.resolve(e.isEqual(n&&n.key))},xc.prototype._r=function(t){return this.li.length,ha.resolve()},xc.prototype.uc=function(t,e){return this.rc(t)},xc.prototype.rc=function(t){return 0===this.li.length?0:t-this.li[0].batchId},xc.prototype.ic=function(t){return(t=this.rc(t))<0||t>=this.li.length?null:this.li[t]},xc),yc=(Mc.prototype.hr=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this.hc(e);return this.docs=this.docs.ot(r,{lc:e,size:o,readTime:n}),this.size+=o-i,this._i.Qi(t,r.path.h())},Mc.prototype.Ir=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Mc.prototype.mi=function(t,e){return e=this.docs.get(e),ha.resolve(e?e.lc:null)},Mc.prototype.getEntries=function(t,e){var n=this,r=to;return e.forEach(function(t){var e=n.docs.get(t);r=r.ot(t,e?e.lc:null)}),ha.resolve(r)},Mc.prototype.Ri=function(t,e,n){for(var r=ro,i=new Fr(e.path.child("")),o=this.docs.ft(i);o.At();){var s=(u=o.It()).key,u=(a=u.value).lc,a=a.readTime;if(!e.path.T(s.path))break;a.M(n)<=0||u instanceof au&&Du(e,u)&&(r=r.ot(u.key,u))}return ha.resolve(r)},Mc.prototype._c=function(t,e){return ha.forEach(this.docs,function(t){return e(t)})},Mc.prototype.cr=function(t){return new vc(this)},Mc.prototype.fc=function(t){return ha.resolve(this.size)},Mc),vc=(Object.defineProperty(Cc.prototype,"readTime",{get:function(){return this.wc},set:function(t){this.wc=t},enumerable:!1,configurable:!0}),Cc.prototype.hr=function(t,e){this.mc(),this.readTime=e,this.Wu.set(t.key,t)},Cc.prototype.Ir=function(t,e){this.mc(),e&&(this.readTime=e),this.Wu.set(t,null)},Cc.prototype.mi=function(t,e){this.mc();var n=this.Wu.get(e);return void 0!==n?ha.resolve(n):this.Tc(t,e)},Cc.prototype.getEntries=function(t,e){return this.Ec(t,e)},Cc.prototype.apply=function(t){return this.mc(),this.dc=!0,this.mu(t)},Cc.prototype.mc=function(){},n(Pc,fc=Cc),Pc.prototype.mu=function(n){var r=this,i=[];return this.Wu.forEach(function(t,e){e?i.push(r.Ic.hr(n,e,r.readTime)):r.Ic.Ir(t)}),ha.xn(i)},Pc.prototype.Tc=function(t,e){return this.Ic.mi(t,e)},Pc.prototype.Ec=function(t,e){return this.Ic.getEntries(t,e)},Pc),gc=(jc.prototype.Ce=function(t,n){return this.Ac.forEach(function(t,e){return n(e)}),ha.resolve()},jc.prototype.dr=function(t){return ha.resolve(this.lastRemoteSnapshotVersion)},jc.prototype.gc=function(t){return ha.resolve(this.Rc)},jc.prototype.Uu=function(t){return this.highestTargetId=this.Pc.next(),ha.resolve(this.highestTargetId)},jc.prototype.yr=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Rc&&(this.Rc=e),ha.resolve()},jc.prototype.Vc=function(t){this.Ac.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Pc=new Qa(e),this.highestTargetId=e),t.sequenceNumber>this.Rc&&(this.Rc=t.sequenceNumber)},jc.prototype.Bu=function(t,e){return this.Vc(e),this.targetCount+=1,ha.resolve()},jc.prototype.Er=function(t,e){return this.Vc(e),ha.resolve()},jc.prototype.vc=function(t,e){return this.Ac.delete(e.target),this.yc.Or(e.targetId),--this.targetCount,ha.resolve()},jc.prototype.bc=function(n,r,i){var o=this,s=0,u=[];return this.Ac.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.Ac.delete(t),u.push(o.Sc(n,e.targetId)),s++)}),ha.xn(u).next(function(){return s})},jc.prototype.Dc=function(t){return ha.resolve(this.targetCount)},jc.prototype.gr=function(t,e){return e=this.Ac.get(e)||null,ha.resolve(e)},jc.prototype.mr=function(t,e,n){return this.yc.Fr(e,n),ha.resolve()},jc.prototype.wr=function(e,t,n){this.yc.kr(t,n);var r=this.persistence.Rr,i=[];return r&&t.forEach(function(t){i.push(r.cc(e,t))}),ha.xn(i)},jc.prototype.Sc=function(t,e){return this.yc.Or(e),ha.resolve()},jc.prototype.pr=function(t,e){return e=this.yc.Mr(e),ha.resolve(e)},jc.prototype.qr=function(t,e){return ha.resolve(this.yc.qr(e))},jc),mc=(kc.prototype.start=function(){return Promise.resolve()},kc.prototype.ni=function(){return this.Nc=!1,Promise.resolve()},Object.defineProperty(kc.prototype,"xc",{get:function(){return this.Nc},enumerable:!1,configurable:!0}),kc.prototype.kc=function(){},kc.prototype.Oc=function(){},kc.prototype.sr=function(){return this._i},kc.prototype.Ji=function(t){var e=this.Cc[t.Cs()];return e||(e=new dc(this._i,this.Rr),this.Cc[t.Cs()]=e),e},kc.prototype.er=function(){return this.tr},kc.prototype.Zi=function(){return this.hi},kc.prototype.runTransaction=function(t,e,n){var r=this;Rr("MemoryPersistence","Starting transaction:",t);var i=new wc(this.Fc.next());return this.Rr.Lc(),n(i).next(function(t){return r.Rr.Mc(i).next(function(){return t})}).Nn().then(function(t){return i.qc(),t})},kc.prototype.Uc=function(e,n){return ha.kn(Object.values(this.Cc).map(function(t){return function(){return t.qr(e,n)}}))},kc),wc=(Uc.prototype.Qc=function(t){this.Bc.push(t)},Uc.prototype.qc=function(){this.Bc.forEach(function(t){return t()})},n(_c,lc=Uc),_c),bc=(Vc.Gc=function(t){return new Vc(t)},Object.defineProperty(Vc.prototype,"zc",{get:function(){if(this.Wc)return this.Wc;throw Lr()},enumerable:!1,configurable:!0}),Vc.prototype.Cr=function(t,e,n){return this.jc.Cr(n,e),this.zc.delete(n.toString()),ha.resolve()},Vc.prototype.Nr=function(t,e,n){return this.jc.Nr(n,e),this.zc.add(n.toString()),ha.resolve()},Vc.prototype.cc=function(t,e){return this.zc.add(e.toString()),ha.resolve()},Vc.prototype.removeTarget=function(t,e){var n=this;this.jc.Or(e.targetId).forEach(function(t){return n.zc.add(t.toString())});var r=this.persistence.er();return r.pr(t,e.targetId).next(function(t){t.forEach(function(t){return n.zc.add(t.toString())})}).next(function(){return r.vc(t,e)})},Vc.prototype.Lc=function(){this.Wc=new Set},Vc.prototype.Mc=function(n){var r=this,i=this.persistence.Zi().cr();return ha.forEach(this.zc,function(t){var e=Fr.D(t);return r.Kc(n,e).next(function(t){t||i.Ir(e)})}).next(function(){return r.Wc=null,i.apply(n)})},Vc.prototype.Ar=function(t,e){var n=this;return this.Kc(t,e).next(function(t){t?n.zc.delete(e.toString()):n.zc.add(e.toString())})},Vc.prototype.$c=function(t){return 0},Vc.prototype.Kc=function(t,e){var n=this;return ha.kn([function(){return ha.resolve(n.jc.qr(e))},function(){return n.persistence.er().qr(t,e)},function(){return n.persistence.Uc(t,e)}])},Vc),Ec=(Lc.prototype.Io=function(t){this.Jc=t},Lc.prototype.do=function(t){this.Xc=t},Lc.prototype.onMessage=function(t){this.Zc=t},Lc.prototype.close=function(){this.Yc()},Lc.prototype.send=function(t){this.Hc(t)},Lc.prototype.ta=function(){this.Jc()},Lc.prototype.ea=function(t){this.Xc(t)},Lc.prototype.na=function(t){this.Zc(t)},Lc),Ic={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Tc=(Dc.prototype.No=function(e,t,n,r){var i=this.oa(e,t);return Rr("RestConnection","Sending: ",i,n),t={},this.ua(t,r),this.ca(e,i,t,n).then(function(t){return Rr("RestConnection","Received: ",t),t},function(t){throw Sr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Dc.prototype.$o=function(t,e,n,r){return this.No(t,e,n,r)},Dc.prototype.ua=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.24.0",t["Content-Type"]="text/plain",e)for(var n in e.Br)e.Br.hasOwnProperty(n)&&(t[n]=e.Br[n])},Dc.prototype.oa=function(t,e){return t=Ic[t],this.ia+"/v1/"+e+":"+t},n(Sc,cc=Dc),Sc.prototype.ca=function(o,e,s,u){return new Promise(function(n,r){var i=new gr;i.listenOnce(yr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case dr.NO_ERROR:var t=i.getResponseJson();Rr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case dr.TIMEOUT:Rr("Connection",'RPC "'+o+'" timed out'),r(new Ir(Er.DEADLINE_EXCEEDED,"Request time out"));break;case dr.HTTP_ERROR:var e=i.getStatus();Rr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Er).indexOf(e)?e:Er.UNKNOWN,r(new Ir(e,t.message))):r(new Ir(Er.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Ir(Er.UNAVAILABLE,"Connection failed."));break;default:Lr()}}finally{Rr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},Sc.prototype.Ao=function(t,e){var n,r=[this.ia,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new hr,t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.B.projectId+"/databases/"+this.B.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.j};this.ua(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),Rr("Connection","Creating WebChannel: "+(r=r.join("")),t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new Ec({Hc:function(t){u?Rr("Connection","Not sending because WebChannel is closed:",t):(s||(Rr("Connection","Opening WebChannel transport."),o.open(),s=!0),Rr("Connection","WebChannel sending:",t),o.send(t))},Yc:function(){return o.close()}});return(t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})})(vr.EventType.OPEN,function(){u||Rr("Connection","WebChannel transport opened.")}),t(vr.EventType.CLOSE,function(){u||(u=!0,Rr("Connection","WebChannel transport closed"),a.ea())}),t(vr.EventType.ERROR,function(t){u||(u=!0,Sr("Connection","WebChannel transport errored:",t),a.ea(new Ir(Er.UNAVAILABLE,"The operation could not be completed")))}),t(vr.EventType.MESSAGE,function(t){var e,n,r,i;u||(Vr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Rr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Fi[r];if(void 0!==t)return zi(t)}(),i=n.message,void 0===t&&(t=Er.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.ea(new Ir(t,i)),o.close()):(Rr("Connection","WebChannel received:",e),a.na(e)))}),setTimeout(function(){a.ta()},0),a},Sc),Ac=(Oc.prototype.Jo=function(t){this.fa.push(t)},Oc.prototype.ni=function(){window.removeEventListener("online",this.aa),window.removeEventListener("offline",this.la)},Oc.prototype.da=function(){window.addEventListener("online",this.aa),window.addEventListener("offline",this.la)},Oc.prototype.ha=function(){Rr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.fa;t<e.length;t++)(0,e[t])(0)},Oc.prototype._a=function(){Rr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.fa;t<e.length;t++)(0,e[t])(1)},Oc.wa=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Oc),Nc=(Rc.prototype.Jo=function(t){},Rc.prototype.ni=function(){},Rc);function Rc(){}function Oc(){var t=this;this.aa=function(){return t.ha()},this.la=function(){return t._a()},this.fa=[],this.da()}function Sc(t){var e=this;return(e=cc.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.j=t.j,e}function Dc(t){this.sa=t,this.B=t.B;var e=t.ssl?"https":"http";this.ia=e+"://"+t.host,this.ra="projects/"+this.B.projectId+"/databases/"+this.B.database+"/documents"}function Lc(t){this.Hc=t.Hc,this.Yc=t.Yc}function Vc(t){this.persistence=t,this.jc=new uh,this.Wc=null}function _c(t){var e=this;return(e=lc.call(this)||this).Tr=t,e}function Uc(){this.Bc=[]}function kc(t){var e=this;this.Cc={},this.Fc=new Sa(0),this.Nc=!1,this.Nc=!0,this.Rr=t(this),this.tr=new gc(this),this._i=new za,this.hi=(t=this._i,new yc(t,function(t){return e.Rr.$c(t)}))}function jc(t){this.persistence=t,this.Ac=new Ai(Pi,Ci),this.lastRemoteSnapshotVersion=Ri.min(),this.highestTargetId=0,this.Rc=0,this.yc=new uh,this.targetCount=0,this.Pc=Qa.Wi()}function Pc(t){var e=this;return(e=fc.call(this)||this).Ic=t,e}function Cc(){this.Wu=new Ai(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.dc=!1}function Mc(t,e){this._i=t,this.hc=e,this.docs=new Wi(Fr.i),this.size=0}function xc(t,e){this._i=t,this.Rr=e,this.li=[],this.ec=1,this.nc=new $i(ah.br)}function Fc(){}function qc(t){return new Xo(t,!0)}var Bc,Gc,zc="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Wc=(rl.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Vu=this.ma(e),this.persistence=this.Ta(e),[4,this.persistence.start()];case 1:return t.sent(),this.Ea=this.Ia(e),this.Qo=this.Aa(e),[2]}})})},rl.prototype.Ia=function(t){return null},rl.prototype.Aa=function(t){return e=this.persistence,n=new pc,t=t.Ra,new Ha(e,n,t);var e,n},rl.prototype.Ta=function(t){if(t.persistenceSettings.ya)throw new Ir(Er.FAILED_PRECONDITION,zc);return new mc(bc.Gc)},rl.prototype.ma=function(t){return new Va},rl.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Ea&&this.Ea.stop(),[4,this.Vu.ni()];case 1:return t.sent(),[4,this.persistence.ni()];case 2:return t.sent(),[2]}})})},rl.prototype.clearPersistence=function(t,e){throw new Ir(Er.FAILED_PRECONDITION,zc)},rl),Qc=(nl.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Qo?[3,2]:(this.Qo=n.Qo,this.Vu=n.Vu,this.jo=this.Pa(r),this.gu=this.ga(r),this.pu=this.pa(r),this.Va=this.va(r),this.Vu.js=function(t){return nc(e.Va,t,1)},this.gu.Wo.ba=function(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Rr("SyncEngine","User change. New user:",o.Cs()),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).li,m=e.nr,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.li.Ku(v).next(function(t){return g=t,n=e.persistence.Ji(o),m=new ka(e.Xi,n,e.persistence.sr()),n.Ku(v)}).next(function(t){for(var e=[],n=[],r=so(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Ei(v,r).next(function(t){return{Hu:t,Yu:e,Ju:n}})})})];case 1:return r=t.sent(),[2,(e.li=n,e.nr=m,e.zi.ir(e.nr),r)]}})})}(n.Qo,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).ku.forEach(function(t){t.forEach(function(t){t.reject(new Ir(Er.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.ku.clear(),n.Vu.ti(o,r.Yu,r.Ju),[4,hc(n,r.Hu)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this.Va),[4,function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Ko.delete(2),[4,Sh(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Ko.add(2),[4,Dh(e)]);case 3:t.sent(),e.Xo.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.gu,this.Va.Mu)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},nl.prototype.pa=function(t){return new ba},nl.prototype.Pa=function(t){var e=qc(t.sa.B),n=(n=t.sa,new Tc(n));return t=t.credentials,new yh(t,n,e)},nl.prototype.ga=function(t){var e=this;return new rh(this.Qo,this.jo,t.On,function(t){return nc(e.Va,t,0)},t=new(Ac.wa()?Ac:Nc))},nl.prototype.va=function(t){return e=this.Qo,n=this.gu,r=this.pu,i=this.Vu,o=t.Ra,s=t.vu,u=!t.persistenceSettings.ya||!t.persistenceSettings.synchronizeTabs,s=new Jh(e,n,r,i,o,s),u&&(s.Lu=!0),s;var e,n,r,i,o,s,u},nl.prototype.terminate=function(){return Lh(this.gu)},nl),Hc=(el.prototype.next=function(t){this.observer.next&&this.Sa(this.observer.next,t)},el.prototype.error=function(t){this.observer.error?this.Sa(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},el.prototype.Da=function(){this.muted=!0},el.prototype.Sa=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},el),Xc=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Ir(Er.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(Kr("FieldPath","string",e,t[e]),0===t[e].length)throw new Ir(Er.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Ca=new xr(t)},Kc=(n(tl,Gc=Xc),tl.documentId=function(){return new tl(xr.v().R())},tl.prototype.isEqual=function(t){if(!(t instanceof tl))throw si("isEqual","FieldPath",1,t);return this.Ca.isEqual(t.Ca)},tl),Yc=new RegExp("[~\\*/\\[\\]]"),Jc=function(t){this.Fa=t},$c=(n(Zc,Bc=Jc),Zc.prototype.Na=function(t){if(2!==t.$a)throw 1===t.$a?t.xa(this.Fa+"() can only appear at the top level of your update data"):t.xa(this.Fa+"() cannot be used with set() unless you pass {merge:true}");return t.je.push(t.path),null},Zc.prototype.isEqual=function(t){return t instanceof Zc},Zc);function Zc(){return null!==Bc&&Bc.apply(this,arguments)||this}function tl(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Gc.call(this,t)||this}function el(t){this.observer=t,this.muted=!1}function nl(){}function rl(){}function il(t,e,n){return new Ol({$a:3,ka:e.settings.ka,methodName:t.Fa,Oa:n},e.B,e.serializer,e.ignoreUndefinedProperties)}var ol,sl,ul,al,hl=(n(Nl,al=Jc),Nl.prototype.Na=function(t){return new Ss(t.path,new ds)},Nl.prototype.isEqual=function(t){return t instanceof Nl},Nl),cl=(n(Al,ul=Jc),Al.prototype.Na=function(t){var e=il(this,t,!0),n=this.La.map(function(t){return jl(t,e)}),n=new ys(n);return new Ss(t.path,n)},Al.prototype.isEqual=function(t){return this===t},Al),ll=(n(Tl,sl=Jc),Tl.prototype.Na=function(t){var e=il(this,t,!0),n=this.La.map(function(t){return jl(t,e)}),n=new bs(n);return new Ss(t.path,n)},Tl.prototype.isEqual=function(t){return this===t},Tl),fl=(n(Il,ol=Jc),Il.prototype.Na=function(t){var e=new As(t.serializer,Jo(t.serializer,this.Ma));return new Ss(t.path,e)},Il.prototype.isEqual=function(t){return this===t},Il),pl=(Object.defineProperty(El.prototype,"latitude",{get:function(){return this.qa},enumerable:!1,configurable:!0}),Object.defineProperty(El.prototype,"longitude",{get:function(){return this.Ua},enumerable:!1,configurable:!0}),El.prototype.isEqual=function(t){return this.qa===t.qa&&this.Ua===t.Ua},El.prototype.toJSON=function(){return{latitude:this.qa,longitude:this.Ua}},El.prototype.Y=function(t){return fi(this.qa,t.qa)||fi(this.Ua,t.Ua)},El),dl=function(t){this.Ba=t},yl=/^__.*__$/,vl=function(t,e,n){this.Qa=t,this.ja=e,this.Wa=n},gl=(bl.prototype.Ga=function(t,e){var n=[];return null!==this.je?n.push(new qs(t,this.data,this.je,e)):n.push(new Fs(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Qs(t,this.fieldTransforms)),n},bl),ml=(wl.prototype.Ga=function(t,e){return e=[new qs(t,this.data,this.je,e)],0<this.fieldTransforms.length&&e.push(new Qs(t,this.fieldTransforms)),e},wl);function wl(t,e,n){this.data=t,this.je=e,this.fieldTransforms=n}function bl(t,e,n){this.data=t,this.je=e,this.fieldTransforms=n}function El(t,e){if(Qr("GeoPoint",arguments,2),Kr("GeoPoint","number",1,t),Kr("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Ir(Er.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Ir(Er.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.qa=t,this.Ua=e}function Il(t,e){var n=this;return(n=ol.call(this,t)||this).Ma=e,n}function Tl(t,e){var n=this;return(n=sl.call(this,t)||this).La=e,n}function Al(t,e){var n=this;return(n=ul.call(this,t)||this).La=e,n}function Nl(){return null!==al&&al.apply(this,arguments)||this}function Rl(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Lr()}}var Ol=(Object.defineProperty(Ll.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Ll.prototype,"$a",{get:function(){return this.settings.$a},enumerable:!1,configurable:!0}),Ll.prototype.Ka=function(t){return new Ll(Object.assign(Object.assign({},this.settings),t),this.B,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.je)},Ll.prototype.Ha=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.Ka({path:e,Oa:!1})).Ya(t),e},Ll.prototype.Ja=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t);return(t=this.Ka({path:t,Oa:!1})).za(),t},Ll.prototype.Xa=function(t){return this.Ka({path:void 0,Oa:!0})},Ll.prototype.xa=function(t){return ql(t,this.settings.methodName,this.settings.Za||!1,this.path,this.settings.ka)},Ll.prototype.contains=function(e){return void 0!==this.je.find(function(t){return e.T(t)})||void 0!==this.fieldTransforms.find(function(t){return e.T(t.field)})},Ll.prototype.za=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Ya(this.path.get(t))},Ll.prototype.Ya=function(t){if(0===t.length)throw this.xa("Document fields must not be empty");if(Rl(this.$a)&&yl.test(t))throw this.xa('Document fields cannot begin and end with "__"')},Ll),Sl=(Dl.prototype.th=function(t,e,n,r){return void 0===r&&(r=!1),new Ol({$a:t,methodName:e,ka:n,path:xr.g(),Oa:!1,Za:r},this.B,this.serializer,this.ignoreUndefinedProperties)},Dl);function Dl(t,e,n){this.B=t,this.ignoreUndefinedProperties=e,this.serializer=n||qc(t)}function Ll(t,e,n,r,i,o){this.settings=t,this.B=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.za(),this.fieldTransforms=i||[],this.je=o||[]}function Vl(t,e,n,r,i,o){void 0===o&&(o={});var s=t.th(o.merge||o.mergeFields?2:0,e,n,i);Ml("Data must be an object, but it was:",s,r);var u,a,r=Pl(r,s);if(o.merge)u=new Ds(s.je),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],c=0,l=o.mergeFields;c<l.length;c++){var f=l[c],p=void 0;if(f instanceof Xc)p=f.Ca;else{if("string"!=typeof f)throw Lr();p=Fl(e,f,n)}if(!s.contains(p))throw new Ir(Er.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Bl(h,p)||h.push(p)}u=new Ds(h),a=s.fieldTransforms.filter(function(t){return u.He(t.field)})}else u=null,a=s.fieldTransforms;return new gl(new Zs(r),u,a)}function _l(t,r,i,e){var o=t.th(1,r,i);Ml("Data must be an object, but it was:",o,e);var s=[],u=new tu;return Ur(e,function(t,e){var n=Fl(r,t,i),t=o.Ja(n);e instanceof $c||e instanceof dl&&e.Ba instanceof $c?s.push(n):null!=(t=jl(e,t))&&(s.push(n),u.set(n,t))}),e=new Ds(s),new ml(u.Xe(),e,o.fieldTransforms)}function Ul(t,e,n,r,i,o){var s=t.th(1,e,n),u=[xl(e,r,n)],a=[i];if(o.length%2!=0)throw new Ir(Er.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(xl(e,o[h])),a.push(o[h+1]);for(var c,l,f,p=[],d=new tu,y=u.length-1;0<=y;--y)Bl(p,u[y])||(c=u[y],l=a[y],f=s.Ja(c),l instanceof $c||l instanceof dl&&l.Ba instanceof $c?p.push(c):null!=(f=jl(l,f))&&(p.push(c),d.set(c,f)));return i=new Ds(p),new ml(d.Xe(),i,s.fieldTransforms)}function kl(t,e,n,r){return void 0===r&&(r=!1),jl(n,t.th(r?4:3,e))}function jl(s,t){if(s instanceof dl&&(s=s.Ba),Cl(s))return Ml("Unsupported field value:",t,s),Pl(s,t);if(s instanceof Jc)return function(t,e){if(!Rl(e.$a))throw e.xa(t.Fa+"() can only be used with update() and set()");if(!e.path)throw e.xa(t.Fa+"() is not currently supported inside arrays");(t=t.Na(e))&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.je.push(t.path),s instanceof Array){if(t.settings.Oa&&4!==t.$a)throw t.xa("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=jl(i[r],t.Xa(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Jo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Ni.fromDate(t);return{timestampValue:$o(e.serializer,n)}}if(t instanceof Ni){var r=new Ni(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:$o(e.serializer,r)}}if(t instanceof pl)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof vi)return{bytesValue:Zo(e.serializer,t.U)};if(t instanceof vl){if(n=e.B,!(r=t.Qa).isEqual(n))throw e.xa("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:es(t.Qa||e.B,t.ja.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.xa("Unsupported field value: "+ri(t))}(s,t)}function Pl(t,n){var r={};return kr(t)?n.path&&0<n.path.length&&n.je.push(n.path):Ur(t,function(t,e){null!=(e=jl(e,n.Ha(t)))&&(r[t]=e)}),{mapValue:{fields:r}}}function Cl(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Ni||t instanceof pl||t instanceof vi||t instanceof vl||t instanceof Jc)}function Ml(t,e,n){if(!Cl(n)||!ni(n))throw"an object"===(n=ri(n))?e.xa(t+" a custom object"):e.xa(t+" "+n)}function xl(t,e,n){if(e instanceof Xc)return e.Ca;if("string"==typeof e)return Fl(t,e);throw ql("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Fl(t,e,n){try{return function(e){if(0<=e.search(Yc))throw new Ir(Er.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Kc.bind.apply(Kc,i([void 0],e.split("."))))}catch(t){throw new Ir(Er.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Ca}catch(e){throw ql(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function ql(t,e,n,r,i){var o=r&&!r.m(),s=void 0!==i,e="Function "+e+"() called with invalid data";return n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Ir(Er.INVALID_ARGUMENT,(e+=". ")+t+n)}function Bl(t,e){return t.some(function(t){return t.isEqual(e)})}var Gl=(Xl.prototype.rh=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.oh(),0<this.mutations.length)throw new Ir(Er.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var i,e,n,o,r;return v(this,function(t){switch(t.label){case 0:return e=os((i=s).serializer)+"/documents",n={documents:u.map(function(t){return ns(i.serializer,t)})},[4,i.$o("BatchGetDocuments",e,n)];case 1:return n=t.sent(),o=new Map,n.forEach(function(t){var e,n,r,t=(e=i.serializer,"found"in(t=t)?function(t,e){Vr(!!e.found),e.found.name,e.found.updateTime;var n=rs(t,e.found.name),t=ts(e.found.updateTime),e=new Zs({mapValue:{fields:e.found.fields}});return new au(n,t,e,{})}(e,t):"missing"in t?(n=e,Vr(!!(r=t).missing),Vr(!!r.readTime),n=rs(n,r.missing),r=ts(r.readTime),new hu(n,r)):Lr());o.set(t.key.toString(),t)}),r=[],[2,(u.forEach(function(t){Vr(!!(t=o.get(t.toString()))),r.push(t)}),r)]}})})}(this.jo,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof hu||t instanceof au?n.uh(t):Lr()}),e)]}})})},Xl.prototype.set=function(t,e){this.write(e.Ga(t,this.ze(t))),this.ih.add(t.toString())},Xl.prototype.update=function(t,e){try{this.write(e.Ga(t,this.ah(t)))}catch(t){this.sh=t}this.ih.add(t.toString())},Xl.prototype.delete=function(t){this.write([new Js(t,this.ze(t))]),this.ih.add(t.toString())},Xl.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.oh(),this.sh)throw this.sh;return e=this.eh,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=Fr.D(e),n.mutations.push(new $s(e,n.ze(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=os((e=i).serializer)+"/documents",r={writes:o.map(function(t){return us(e.serializer,t)})},[4,e.No("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.jo,this.mutations)];case 1:return t.sent(),this.nh=!0,[2]}})})},Xl.prototype.uh=function(t){var e;if(t instanceof au)e=t.version;else{if(!(t instanceof hu))throw Lr();e=Ri.min()}var n=this.eh.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Ir(Er.ABORTED,"Document version changed between two reads.")}else this.eh.set(t.key.toString(),e)},Xl.prototype.ze=function(t){var e=this.eh.get(t.toString());return!this.ih.has(t.toString())&&e?_s.updateTime(e):_s.Ye()},Xl.prototype.ah=function(t){var e=this.eh.get(t.toString());if(this.ih.has(t.toString())||!e)return _s.exists(!0);if(e.isEqual(Ri.min()))throw new Ir(Er.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return _s.updateTime(e)},Xl.prototype.write=function(t){this.oh(),this.mutations=this.mutations.concat(t)},Xl.prototype.oh=function(){},Xl),zl=(Hl.prototype.run=function(){this.lh()},Hl.prototype.lh=function(){var t=this;this.Xn.yn(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new Gl(this.jo),(n=this._h(e))&&n.then(function(t){r.On.jn(function(){return e.commit().then(function(){r.qn.resolve(t)}).catch(function(t){r.fh(t)})})}).catch(function(t){r.fh(t)}),[2]})})})},Hl.prototype._h=function(t){try{var e=this.updateFunction(t);return!_i(e)&&e.catch&&e.then?e:(this.qn.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.qn.reject(t),null}},Hl.prototype.fh=function(t){var e=this;0<this.hh&&this.dh(t)?(--this.hh,this.On.jn(function(){return e.lh(),Promise.resolve()})):this.qn.reject(t)},Hl.prototype.dh=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!Gi(t))},Hl),Wl=(Ql.prototype.start=function(t,e,n,r){var i=this;this.mh(),this.sa=t;var o=new ua,s=!1;return this.credentials.Wr(function(t){return s?void i.On.os(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).On.hs(),Rr("RemoteStore","RemoteStore received new credentials"),n=Ch(e),e.Ko.add(3),[4,Dh(e)];case 1:return t.sent(),n&&e.Xo.set("Unknown"),[4,e.Wo.ba(i)];case 2:return t.sent(),e.Ko.delete(3),[4,Sh(e)];case 3:return t.sent(),[2]}})})}(i.gu,t)}):(s=!0,Rr("FirestoreClient","Initializing. user=",t.uid),i.Th(e,n,r,t,o).then(i.wh.resolve,i.wh.reject))}),this.On.jn(function(){return i.wh.promise}),o.promise},Ql.prototype.enableNetwork=function(){var e=this;return this.mh(),this.On.enqueue(function(){return e.persistence.Oc(!0),(t=e.gu).Ko.delete(0),Sh(t);var t})},Ql.prototype.Th=function(r,i,o,s,u){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={On:this.On,sa:this.sa,clientId:this.clientId,credentials:this.credentials,Ra:s,vu:100,persistenceSettings:o},[4,r.initialize(e)];case 1:return t.sent(),[4,i.initialize(r,e)];case 2:return t.sent(),this.persistence=r.persistence,this.Vu=r.Vu,this.Qo=r.Qo,this.Ea=r.Ea,this.jo=i.jo,this.gu=i.gu,this.Va=i.Va,this.Eh=i.pu,this.Eh.Is=function(h,c){return y(this,void 0,void 0,function(){var n,o,s,u,a;return v(this,function(t){switch(t.label){case 0:return(e=h).gu.Wo.eu=ec.bind(null,e),e.gu.Wo.Ue=function(t,e){var n=t;if((t=n.Nu.get(e))&&t.Pu)return so().add(t.key);var r=so();if(!(e=n.Du.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Su.get(s),r=r.kt(s.view.lu);return r}.bind(null,e),e.gu.Wo.tu=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Vu.Ks(s,"rejected",u),i=e.Nu.get(s),(n=i&&i.key)?(r=(r=new Wi(Fr.i)).ot(n,new hu(n,Ri.min())),i=so().add(n),i=new lo(Ri.min(),new Map,new $i(fi),r,i),[4,ec(e,i)]):[3,2];case 1:return t.sent(),e.Fu=e.Fu.remove(n),e.Nu.delete(s),ac(e),[3,4];case 2:return[4,Za(e.Qo,s,!1).then(function(){return oc(e,s,u)}).catch(eh)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.bu.Ro=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query;if(u=n.Ts.get(u)){for(var a=0,h=u.listeners;a<h.length;a++)h[a].Rs(s)&&(r=!0);u.ws=s}}r&&Ta(n)}.bind(null,e.pu),e.bu.qu=function(t,e,n){var r=t;if(t=r.Ts.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.Ts.delete(e)}.bind(null,e.pu),(a=(n=e).Su.get(c))?(o=a.targetId,n.Vu.zs(o),s=a.view.yu(),[3,4]):[3,1];case 1:return[4,(e=n.Qo,r=Iu(c),(i=e).persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.tr.gr(e,r).next(function(t){return t?(n=t,ha.resolve(n)):i.tr.Uu(e).next(function(t){return n=new qi(r,t,0,e.Tr),i.tr.Bu(e,n).next(function(){return n})})})}).then(function(t){var e=i.Ki.get(t.targetId);return(null===e||0<t.nt.M(e.nt))&&(i.Ki=i.Ki.ot(t.targetId,t),i.Hi.set(r,t.targetId)),t}))];case 2:return u=t.sent(),a=n.Vu.zs(u.targetId),o=u.targetId,[4,function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Qu=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view._u(o)).wu?[4,th(r.Qo,i.query,!1).then(function(t){return t=t.documents,i.view._u(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.Kt.get(i.targetId),n=i.view.mu(e,r.Mu,n),[2,(uc(r,i.targetId,n.Iu),n.snapshot)]}})})}(i,t,e,n)},[4,th(i.Qo,o,!0)];case 1:return n=t.sent(),r=new Kh(o,n.Vr),e=r._u(n.documents),n=fo.Zt(s,u&&"Offline"!==i.onlineState),n=r.mu(e,i.Mu,n),uc(i,s,n.Iu),r=new Qh(o,s,r),i.Su.set(o,r),i.Du.has(s)?i.Du.get(s).push(o):i.Du.set(s,[o]),[2,n.snapshot]}})})}(n,c,o,"current"===a)];case 3:s=t.sent(),n.Mu&&Vh(n.gu,u),t.label=4;case 4:return[2,s]}var r,i,e})})}.bind(null,this.Va),this.Eh.ys=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Su.get(o),1<(r=e.Du.get(n.targetId)).length?[2,(e.Du.set(n.targetId,r.filter(function(t){return!Ru(t,o)})),void e.Su.delete(o))]:e.Mu?(e.Vu.Hs(n.targetId),e.Vu.Zs(n.targetId)?[3,2]:[4,Za(e.Qo,n.targetId,!1).then(function(){e.Vu.Js(n.targetId),_h(e.gu,n.targetId),oc(e,n.targetId)}).catch(eh)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return oc(e,n.targetId),[4,Za(e.Qo,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,this.Va),this.persistence.kc(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),u.resolve(),[3,4];case 3:if(e=t.sent(),u.reject(e),!this.Ih(e))throw e;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),this.Th(new Wc,new Qc,{ya:!1},s,u))];case 4:return[2]}})})},Ql.prototype.Ih=function(t){return"FirebaseError"===t.name?t.code===Er.FAILED_PRECONDITION||t.code===Er.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Ql.prototype.mh=function(){if(this.On.ts)throw new Ir(Er.FAILED_PRECONDITION,"The client has already been terminated.")},Ql.prototype.disableNetwork=function(){var t=this;return this.mh(),this.On.enqueue(function(){return t.persistence.Oc(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Ko.add(0),[4,Dh(e)];case 1:return t.sent(),e.Xo.set("Offline"),[2]}})})}(t.gu)})},Ql.prototype.terminate=function(){var t=this;this.On.rs();var n=new ua;return this.On.es(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.Ea&&this.Ea.stop(),[4,Lh(this.gu)];case 1:return t.sent(),[4,this.Vu.ni()];case 2:return t.sent(),[4,this.persistence.ni()];case 3:return t.sent(),this.credentials.Gr(),n.resolve(),[3,5];case 4:return e=ma(e=t.sent(),"Failed to shutdown persistence"),n.reject(e),[3,5];case 5:return[2]}})})}),n.promise},Ql.prototype.waitForPendingWrites=function(){var t=this;this.mh();var e=new ua;return this.On.jn(function(){return function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:Ch((n=o).gu)||Rr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Qo).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.li.zu(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.ku.get(r)||[]).push(s),n.ku.set(r,i),[3,4]);case 3:return i=ma(i=t.sent(),"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}(t.Va,e)}),e.promise},Ql.prototype.listen=function(t,e,n){var r=this;this.mh();var i=new Hc(n),o=new Aa(t,i,e);return this.On.jn(function(){return Ea(r.Eh,o)}),function(){i.Da(),r.On.jn(function(){return Ia(r.Eh,o)})}},Ql.prototype.Ah=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.mh(),[4,this.wh.promise];case 1:return t.sent(),e=new ua,[2,(this.On.jn(function(){return function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.nr.fi(t,e)}))];case 1:return(r=t.sent())instanceof au?s.resolve(r):r instanceof hu?s.resolve(null):s.reject(new Ir(Er.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=ma(r=t.sent(),"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(n.Qo,r,e)}),e.promise)]}})})},Ql.prototype.Rh=function(h,c){return void 0===c&&(c={}),y(this,void 0,void 0,function(){var e,a=this;return v(this,function(t){switch(t.label){case 0:return this.mh(),[4,this.wh.promise];case 1:return t.sent(),e=new ua,[2,(this.On.jn(function(){return n=a.Eh,r=a.On,i=h,o=c,s=e,t=new Hc({next:function(t){r.jn(function(){return Ia(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Ir(Er.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Ir(Er.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Aa(yu(i.path),t,{includeMetadataChanges:!0,Ss:!0}),Ea(n,u);var n,r,i,o,s,t,u}),e.promise)]}})})},Ql.prototype.yh=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.mh(),[4,this.wh.promise];case 1:return t.sent(),e=new ua,[2,(this.On.jn(function(){return function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,th(r,i,!0)];case 1:return n=t.sent(),e=new Kh(i,n.Vr),n=e._u(n.documents),n=e.mu(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=ma(n=t.sent(),"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(n.Qo,r,e)}),e.promise)]}})})},Ql.prototype.Ph=function(h,c){return void 0===c&&(c={}),y(this,void 0,void 0,function(){var u,a=this;return v(this,function(t){switch(t.label){case 0:return this.mh(),[4,this.wh.promise];case 1:return t.sent(),u=new ua,[2,(this.On.jn(function(){return e=a.Eh,n=a.On,t=h,r=c,i=u,o=new Hc({next:function(t){n.jn(function(){return Ia(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Ir(Er.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Aa(t,o,{includeMetadataChanges:!0,Ss:!0}),Ea(e,s);var e,n,t,r,i,o,s}),u.promise)]}})})},Ql.prototype.write=function(t){var e=this;this.mh();var n=new ua;return this.On.jn(function(){return tc(e.Va,t,n)}),n.promise},Ql.prototype.B=function(){return this.sa.B},Ql.prototype.gh=function(t){var e=this;this.mh();var r=new Hc(t);return this.On.jn(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,(e=this.Eh,n=r,e.Es.add(n),void n.next())];var e,n})})}),function(){r.Da(),e.On.jn(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,void this.Eh.Es.delete(r)]})})})}},Object.defineProperty(Ql.prototype,"ph",{get:function(){return this.On.ts},enumerable:!1,configurable:!0}),Ql.prototype.transaction=function(t){var e=this;this.mh();var n=new ua;return this.On.jn(function(){return new zl(e.On,e.jo,t,n).run(),Promise.resolve()}),n.promise},Ql);function Ql(t,e){this.credentials=t,this.On=e,this.clientId=ci.k(),this.wh=new ua}function Hl(t,e,n,r){this.On=t,this.jo=e,this.updateFunction=n,this.qn=r,this.hh=5,this.Xn=new aa(this.On,"transaction_retry")}function Xl(t){this.jo=t,this.eh=new Map,this.mutations=[],this.nh=!1,this.sh=null,this.ih=new Set}function Kl(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Yl,Jl,$l=(gf.prototype.Dh=function(t){switch(Vo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Mo(t.integerValue||t.doubleValue);case 3:return this.Ch(t.timestampValue);case 4:return this.Fh(t);case 5:return t.stringValue;case 6:return this.Sh(xo(t.bytesValue));case 7:return this.Nh(t.referenceValue);case 8:return this.$h(t.geoPointValue);case 9:return this.xh(t.arrayValue);case 10:return this.kh(t.mapValue);default:throw Lr()}},gf.prototype.kh=function(t){var n=this,r={};return Ur(t.fields||{},function(t,e){r[t]=n.Dh(e)}),r},gf.prototype.$h=function(t){return new pl(Mo(t.latitude),Mo(t.longitude))},gf.prototype.xh=function(t){var e=this;return(t.values||[]).map(function(t){return e.Dh(t)})},gf.prototype.Fh=function(t){switch(this.Vh){case"previous":var e=function t(e){return So(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==e?null:this.Dh(e);case"estimate":return this.Ch(Do(t));default:return null}},gf.prototype.Ch=function(t){return t=Co(t),t=new Ni(t.seconds,t.nanos),this.timestampsInSnapshots?t:t.toDate()},gf.prototype.Nh=function(t){var e=Cr.P(t);return Vr(cs(e)),t=new Ti(e.get(1),e.get(3)),e=new Fr(e.u(5)),t.isEqual(this.B)||Or("Document "+e+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+this.B.projectId+"/"+this.B.database+") instead."),this.bh(e)},gf),Zl=Pa.Oi,tf=(vf.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},vf),ef=(Object.defineProperty(yf.prototype,"zh",{get:function(){return this.Kh||(this.Kh=new Sl(this.Qa,this.Gh.ignoreUndefinedProperties)),this.Kh},enumerable:!1,configurable:!0}),yf.prototype.settings=function(t){if(Qr("Firestore.settings",arguments,1),Kr("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.Gh),t)).merge,t=new tf(t),this.Bh&&!this.Gh.isEqual(t))throw new Ir(Er.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.Gh=t).credentials&&(this.Wh=function(t){if(!t)return new hh;switch(t.type){case"gapi":var e=t.client;return Vr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new fh(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Ir(Er.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},yf.prototype.enableNetwork=function(){return this.Uh(),this.Bh.enableNetwork()},yf.prototype.disableNetwork=function(){return this.Uh(),this.Bh.disableNetwork()},yf.prototype.enablePersistence=function(t){var e;if(this.Bh)throw new Ir(Er.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var n=!1,r=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Or("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),n=null!==(e=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==e&&e,r=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,n&&r))throw new Ir(Er.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Hh(this.Oh,this.Lh,{ya:!0,cacheSizeBytes:this.Gh.cacheSizeBytes,synchronizeTabs:n,Yh:r})},yf.prototype.clearPersistence=function(){return y(this,void 0,void 0,function(){var n,e=this;return v(this,function(t){if(void 0!==this.Bh&&!this.Bh.ph)throw new Ir(Er.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new ua,[2,(this.qh.es(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Oh.clearPersistence(this.Qa,this.jh)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},yf.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(yf.prototype,"Jh",{get:function(){return this.Uh(),this.Bh.ph},enumerable:!1,configurable:!0}),yf.prototype.waitForPendingWrites=function(){return this.Uh(),this.Bh.waitForPendingWrites()},yf.prototype.onSnapshotsInSync=function(t){return this.Uh(),Kl(t)||(Kr("Firestore.onSnapshotsInSync","function",1,t),t={next:t}),this.Bh.gh(t)},yf.prototype.Uh=function(){return this.Bh||this.Hh(new Wc,new Qc,{ya:!1}),this.Bh},yf.prototype.Xh=function(){return new bi(this.Qa,this.jh,this.Gh.host,this.Gh.ssl,this.Gh.experimentalForceLongPolling,this.Gh.experimentalAutoDetectLongPolling)},yf.prototype.Hh=function(t,e,n){var r=this.Xh();return this.Bh=new Wl(this.Wh,this.qh),this.Bh.start(r,t,e,n)},yf.Qh=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Ir(Er.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e;if(!(t=t.options.projectId)||"string"!=typeof t)throw new Ir(Er.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Ti(t)},Object.defineProperty(yf.prototype,"app",{get:function(){if(!this.Mh)throw new Ir(Er.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Mh},enumerable:!1,configurable:!0}),yf.prototype.collection=function(t){return Qr("Firestore.collection",arguments,1),Kr("Firestore.collection","non-empty string",1,t),this.Uh(),new Nf(Cr.P(t),this,null)},yf.prototype.doc=function(t){return Qr("Firestore.doc",arguments,1),Kr("Firestore.doc","non-empty string",1,t),this.Uh(),of.Zh(Cr.P(t),this,null)},yf.prototype.collectionGroup=function(t){if(Qr("Firestore.collectionGroup",arguments,1),Kr("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Ir(Er.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.Uh(),new Tf((t=t,new lu(Cr.g(),t)),this,null)},yf.prototype.runTransaction=function(e){var n=this;return Qr("Firestore.runTransaction",arguments,1),Kr("Firestore.runTransaction","function",1,e),this.Uh().transaction(function(t){return e(new nf(n,t))})},yf.prototype.batch=function(){return this.Uh(),new rf(this)},Object.defineProperty(yf,"logLevel",{get:function(){switch(Nr()){case u.DEBUG:return"debug";case u.ERROR:return"error";case u.SILENT:return"silent";case u.WARN:return"warn";case u.INFO:return"info";case u.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),yf.setLogLevel=function(t){Qr("Firestore.setLogLevel",arguments,1),ti("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Tr.setLogLevel(t)},yf.prototype.tl=function(){return this.Gh.timestampsInSnapshots},yf.prototype.el=function(){return this.Gh},yf),nf=(df.prototype.get=function(t){var e=this;Qr("Transaction.get",arguments,1);var n=_f("Transaction.get",t,this.nl);return this.sl.rh([n.ja]).then(function(t){if(!t||1!==t.length)return Lr();if((t=t[0])instanceof hu)return new uf(e.nl,n.ja,null,!1,!1,n.Wa);if(t instanceof au)return new uf(e.nl,n.ja,t,!1,!1,n.Wa);throw Lr()})},df.prototype.set=function(t,e,n){return Xr("Transaction.set",arguments,2,3),t=_f("Transaction.set",t,this.nl),n=Df("Transaction.set",n),e=Uf(t.Wa,e,n),n=Vl(this.nl.zh,"Transaction.set",t.ja,e,null!==t.Wa,n),this.sl.set(t.ja,n),this},df.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return e="string"==typeof e||e instanceof Kc?(Hr("Transaction.update",arguments,3),r=_f("Transaction.update",t,this.nl),Ul(this.nl.zh,"Transaction.update",r.ja,e,n,i)):(Qr("Transaction.update",arguments,2),r=_f("Transaction.update",t,this.nl),_l(this.nl.zh,"Transaction.update",r.ja,e)),this.sl.update(r.ja,e),this},df.prototype.delete=function(t){return Qr("Transaction.delete",arguments,1),t=_f("Transaction.delete",t,this.nl),this.sl.delete(t.ja),this},df),rf=(pf.prototype.set=function(t,e,n){return Xr("WriteBatch.set",arguments,2,3),this.ol(),t=_f("WriteBatch.set",t,this.nl),n=Df("WriteBatch.set",n),e=Uf(t.Wa,e,n),n=Vl(this.nl.zh,"WriteBatch.set",t.ja,e,null!==t.Wa,n),this.il=this.il.concat(n.Ga(t.ja,_s.Ye())),this},pf.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return this.ol(),e="string"==typeof e||e instanceof Kc?(Hr("WriteBatch.update",arguments,3),r=_f("WriteBatch.update",t,this.nl),Ul(this.nl.zh,"WriteBatch.update",r.ja,e,n,i)):(Qr("WriteBatch.update",arguments,2),r=_f("WriteBatch.update",t,this.nl),_l(this.nl.zh,"WriteBatch.update",r.ja,e)),this.il=this.il.concat(e.Ga(r.ja,_s.exists(!0))),this},pf.prototype.delete=function(t){return Qr("WriteBatch.delete",arguments,1),this.ol(),t=_f("WriteBatch.delete",t,this.nl),this.il=this.il.concat(new Js(t.ja,_s.Ye())),this},pf.prototype.commit=function(){return this.ol(),this.rl=!0,0<this.il.length?this.nl.Uh().write(this.il):Promise.resolve()},pf.prototype.ol=function(){if(this.rl)throw new Ir(Er.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},pf),of=(n(ff,Jl=vl),ff.Zh=function(t,e,n){if(t.length%2!=0)throw new Ir(Er.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.R()+" has "+t.length);return new ff(new Fr(t),e,n)},Object.defineProperty(ff.prototype,"id",{get:function(){return this.ja.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(ff.prototype,"parent",{get:function(){return new Nf(this.ja.path.h(),this.firestore,this.Wa)},enumerable:!1,configurable:!0}),Object.defineProperty(ff.prototype,"path",{get:function(){return this.ja.path.R()},enumerable:!1,configurable:!0}),ff.prototype.collection=function(t){if(Qr("DocumentReference.collection",arguments,1),Kr("DocumentReference.collection","non-empty string",1,t),!t)throw new Ir(Er.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");return t=Cr.P(t),new Nf(this.ja.path.child(t),this.firestore,null)},ff.prototype.isEqual=function(t){if(!(t instanceof ff))throw si("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.ja.isEqual(t.ja)&&this.Wa===t.Wa},ff.prototype.set=function(t,e){return Xr("DocumentReference.set",arguments,1,2),e=Df("DocumentReference.set",e),t=Uf(this.Wa,t,e),e=Vl(this.firestore.zh,"DocumentReference.set",this.ja,t,null!==this.Wa,e),this.Bh.write(e.Ga(this.ja,_s.Ye()))},ff.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return t="string"==typeof t||t instanceof Kc?(Hr("DocumentReference.update",arguments,2),Ul(this.firestore.zh,"DocumentReference.update",this.ja,t,e,n)):(Qr("DocumentReference.update",arguments,1),_l(this.firestore.zh,"DocumentReference.update",this.ja,t)),this.Bh.write(t.Ga(this.ja,_s.exists(!0)))},ff.prototype.delete=function(){return Qr("DocumentReference.delete",arguments,0),this.Bh.write([new Js(this.ja,_s.Ye())])},ff.prototype.onSnapshot=function(){for(var e=this,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];Xr("DocumentReference.onSnapshot",arguments,1,4);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||Kl(n[i])||(oi("DocumentReference.onSnapshot",r=n[i],["includeMetadataChanges"]),$r("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};Kl(n[i])?(s=n[i],n[i]=null===(r=s.next)||void 0===r?void 0:r.bind(s),n[i+1]=null===(r=s.error)||void 0===r?void 0:r.bind(s),n[i+2]=null===(r=s.complete)||void 0===r?void 0:r.bind(s)):(Kr("DocumentReference.onSnapshot","function",i,n[i]),Yr("DocumentReference.onSnapshot","function",i+1,n[i+1]),Yr("DocumentReference.onSnapshot","function",i+2,n[i+2]));var s={next:function(t){n[i]&&n[i](e.ul(t))},error:n[i+1],complete:n[i+2]};return this.Bh.listen(yu(this.ja.path),o,s)},ff.prototype.get=function(t){var e=this;Xr("DocumentReference.get",arguments,0,1),Vf("DocumentReference.get",t);var n=this.firestore.Uh();return t&&"cache"===t.source?n.Ah(this.ja).then(function(t){return new uf(e.firestore,e.ja,t,!0,t instanceof au&&t.Je,e.Wa)}):n.Rh(this.ja,t).then(function(t){return e.ul(t)})},ff.prototype.withConverter=function(t){return new ff(this.ja,this.firestore,t)},ff.prototype.ul=function(t){var e=t.docs.get(this.ja);return new uf(this.firestore,this.ja,e,t.fromCache,t.hasPendingWrites,this.Wa)},ff),sf=(lf.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},lf),uf=(cf.prototype.data=function(t){var e=this;if(Xr("DocumentSnapshot.data",arguments,0,1),t=Lf("DocumentSnapshot.data",t),this.cl){if(this.Wa){var n=new af(this.nl,this.ja,this.cl,this.al,this.hl,null);return this.Wa.fromFirestore(n,t)}return new $l(this.nl.Qa,this.nl.tl(),t.serverTimestamps||"none",function(t){return new of(t,e.nl,null)},function(t){return new Ii(t)}).Dh(this.cl.rn())}},cf.prototype.get=function(t,e){var n=this;if(Xr("DocumentSnapshot.get",arguments,1,2),e=Lf("DocumentSnapshot.get",e),this.cl&&null!==(t=this.cl.data().field(xl("DocumentSnapshot.get",t,this.ja))))return new $l(this.nl.Qa,this.nl.tl(),e.serverTimestamps||"none",function(t){return new of(t,n.nl,n.Wa)},function(t){return new Ii(t)}).Dh(t)},Object.defineProperty(cf.prototype,"id",{get:function(){return this.ja.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(cf.prototype,"ref",{get:function(){return new of(this.ja,this.nl,this.Wa)},enumerable:!1,configurable:!0}),Object.defineProperty(cf.prototype,"exists",{get:function(){return null!==this.cl},enumerable:!1,configurable:!0}),Object.defineProperty(cf.prototype,"metadata",{get:function(){return new sf(this.hl,this.al)},enumerable:!1,configurable:!0}),cf.prototype.isEqual=function(t){if(!(t instanceof cf))throw si("isEqual","DocumentSnapshot",1,t);return this.nl===t.nl&&this.al===t.al&&this.ja.isEqual(t.ja)&&(null===this.cl?null===t.cl:this.cl.isEqual(t.cl))&&this.Wa===t.Wa},cf),af=(n(hf,Yl=uf),hf.prototype.data=function(t){return Yl.prototype.data.call(this,t)},hf);function hf(){return null!==Yl&&Yl.apply(this,arguments)||this}function cf(t,e,n,r,i,o){this.nl=t,this.ja=e,this.cl=n,this.al=r,this.hl=i,this.Wa=o}function lf(t,e){this.hasPendingWrites=t,this.fromCache=e}function ff(t,e,n){var r=this;return(r=Jl.call(this,e.Qa,t,n)||this).ja=t,r.firestore=e,r.Wa=n,r.Bh=r.firestore.Uh(),r}function pf(t){this.nl=t,this.il=[],this.rl=!1}function df(t,e){this.nl=t,this.sl=e}function yf(t,e,n,r){var i=this;if(void 0===n&&(n=new Wc),void 0===r&&(r=new Qc),this.Oh=n,this.Lh=r,this.Mh=null,this.qh=new ya,this.INTERNAL={delete:function(){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Uh(),[4,this.Bh.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options)r=t,this.Mh=r,this.Qa=yf.Qh(r),this.jh=r.name,this.Wh=new ch(e);else{if(!(t=t).projectId)throw new Ir(Er.INVALID_ARGUMENT,"Must provide projectId");this.Qa=new Ti(t.projectId,t.database),this.jh="[DEFAULT]",this.Wh=new hh}this.Gh=new tf({})}function vf(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Ir(Er.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Jr("settings","non-empty string","host",t.host),this.host=t.host,$r("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(oi("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","experimentalAutoDetectLongPolling","ignoreUndefinedProperties"]),$r("settings","object","credentials",t.credentials),this.credentials=t.credentials,$r("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),$r("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Or("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Or("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(e=t.timestampsInSnapshots)||void 0===e||e,this.ignoreUndefinedProperties=null!==(e=t.ignoreUndefinedProperties)&&void 0!==e&&e,$r("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Pa.Mi;else{if(t.cacheSizeBytes!==Zl&&t.cacheSizeBytes<Pa.Li)throw new Ir(Er.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Pa.Li);this.cacheSizeBytes=t.cacheSizeBytes}$r("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(e=t.experimentalForceLongPolling)&&void 0!==e&&e,$r("settings","boolean","experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalAutoDetectLongPolling=null!==(e=t.experimentalAutoDetectLongPolling)&&void 0!==e&&e,function(t,e){if(!0===t&&!0===e)throw new Ir(Er.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(t.experimentalForceLongPolling,t.experimentalAutoDetectLongPolling)}function gf(t,e,n,r,i){this.B=t,this.timestampsInSnapshots=e,this.Vh=n,this.bh=r,this.Sh=i}function mf(t,e,n){if("string"==typeof n){if(""===n)throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!bu(e)&&-1!==n.indexOf("/"))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child(Cr.P(n)),!Fr.N(e))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Fo(t,new Fr(e))}if(n instanceof vl)return Fo(t,n.ja);throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+ri(n)+".")}function wf(t,e){if(!Array.isArray(t)||0===t.length)throw new Ir(Er.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Ir(Er.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new Ir(Er.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Ir(Er.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function bf(t,e,n){if(!n.isEqual(e))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Ef(t){if(gu(t)&&0===t.on.length)throw new Ir(Er.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var If,Tf=(Sf.prototype.where=function(t,e,n){return Qr("Query.where",arguments,3),ii("Query.where",3,n),e=ti("Query.where",["<","<=","==","!=",">=",">","array-contains","in","array-contains-any","not-in"],2,e),t=xl("Query.where",t),e=function(t,e,n,r,i,o){if(r.V()){if("array-contains"===i||"array-contains-any"===i)throw new Ir(Er.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){wf(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var h=a[u];s.push(mf(n,t,h))}c={arrayValue:{values:s}}}else c=mf(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||wf(o,i),c=kl(e,"Query.where",o,"in"===i||"not-in"===i);var c=_u.create(r,i,c);return function(t,e){if(e.hn()){var n=wu(t);if(null!==n&&!n.isEqual(e.field))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=mu(t))&&bf(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new Ir(Er.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Ir(Er.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,c),c}(this.ll,this.firestore.zh,this.firestore.Qa,t,e,n),new Sf((e=(n=this.ll).filters.concat([e]),new lu(n.path,n.collectionGroup,n.on.slice(),e,n.limit,n.un,n.startAt,n.endAt)),this.firestore,this.Wa)},Sf.prototype.orderBy=function(t,e){if(Xr("Query.orderBy",arguments,1,2),Yr("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Ir(Er.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var n,t=xl("Query.orderBy",t),t=function(t,e,n){if(null!==t.startAt)throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new sa(e,n);return e=r,null!==mu(n=t)||null!==(t=wu(n))&&bf(0,t,e.field),r}(this.ll,t,n);return new Sf((t=(n=this.ll).on.concat([t]),new lu(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.un,n.startAt,n.endAt)),this.firestore,this.Wa)},Sf.prototype.limit=function(t){return Qr("Query.limit",arguments,1),Kr("Query.limit","number",1,t),ui("Query.limit",1,t),new Sf(Tu(this.ll,t,"F"),this.firestore,this.Wa)},Sf.prototype.limitToLast=function(t){return Qr("Query.limitToLast",arguments,1),Kr("Query.limitToLast","number",1,t),ui("Query.limitToLast",1,t),new Sf(Tu(this.ll,t,"L"),this.firestore,this.Wa)},Sf.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Hr("Query.startAt",arguments,1),t=this._l("Query.startAt",t,e,!0),new Sf(Au(this.ll,t),this.firestore,this.Wa)},Sf.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Hr("Query.startAfter",arguments,1),t=this._l("Query.startAfter",t,e,!1),new Sf(Au(this.ll,t),this.firestore,this.Wa)},Sf.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Hr("Query.endBefore",arguments,1),t=this._l("Query.endBefore",t,e,!0),new Sf(Nu(this.ll,t),this.firestore,this.Wa)},Sf.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Hr("Query.endAt",arguments,1),t=this._l("Query.endAt",t,e,!1),new Sf(Nu(this.ll,t),this.firestore,this.Wa)},Sf.prototype.isEqual=function(t){if(!(t instanceof Sf))throw si("isEqual","Query",1,t);return this.firestore===t.firestore&&Ru(this.ll,t.ll)&&this.Wa===t.Wa},Sf.prototype.withConverter=function(t){return new Sf(this.ll,this.firestore,t)},Sf.prototype._l=function(h,t,e,n){return ii(h,1,t),t instanceof uf?(Qr(h,i([t],e),1),function(t,e,n,r){if(!n)throw new Ir(Er.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+h+"().");for(var i=[],o=0,s=Eu(t);o<s.length;o++){var u=s[o];if(u.field.V())i.push(Fo(e,n.key));else{var a=n.field(u.field);if(So(a))throw new Ir(Er.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a)throw u=u.field.R(),new Ir(Er.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.");i.push(a)}}return new $u(i,r)}(this.ll,this.firestore.Qa,t.cl,n)):(e=[t].concat(e),function(t,e,n,r,i,o){var s=t.on;if(i.length>s.length)throw new Ir(Er.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var h=i[a];if(s[a].field.V()){if("string"!=typeof h)throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!bu(t)&&-1!==h.indexOf("/"))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(Cr.P(h));if(!Fr.N(c))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");c=new Fr(c),u.push(Fo(e,c))}else h=kl(n,r,h),u.push(h)}return new $u(u,o)}(this.ll,this.firestore.Qa,this.firestore.zh,h,e,n))},Sf.prototype.onSnapshot=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Xr("Query.onSnapshot",arguments,1,4);var i={},o=0;"object"!=typeof n[o]||Kl(n[o])||(oi("Query.onSnapshot",i=n[o],["includeMetadataChanges"]),$r("Query.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),o++),Kl(n[o])?(s=n[o],n[o]=null===(t=s.next)||void 0===t?void 0:t.bind(s),n[o+1]=null===(t=s.error)||void 0===t?void 0:t.bind(s),n[o+2]=null===(t=s.complete)||void 0===t?void 0:t.bind(s)):(Kr("Query.onSnapshot","function",o,n[o]),Yr("Query.onSnapshot","function",o+1,n[o+1]),Yr("Query.onSnapshot","function",o+2,n[o+2]));var s={next:function(t){n[o]&&n[o](new Af(e.firestore,e.ll,t,e.Wa))},error:n[o+1],complete:n[o+2]};return Ef(this.ll),this.firestore.Uh().listen(this.ll,i,s)},Sf.prototype.get=function(t){var e=this;Xr("Query.get",arguments,0,1),Vf("Query.get",t),Ef(this.ll);var n=this.firestore.Uh();return(t&&"cache"===t.source?n.yh(this.ll):n.Ph(this.ll,t)).then(function(t){return new Af(e.firestore,e.ll,t,e.Wa)})},Sf),Af=(Object.defineProperty(Of.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Of.prototype,"empty",{get:function(){return this.dl.docs.m()},enumerable:!1,configurable:!0}),Object.defineProperty(Of.prototype,"size",{get:function(){return this.dl.docs.size},enumerable:!1,configurable:!0}),Of.prototype.forEach=function(e,n){var r=this;Xr("QuerySnapshot.forEach",arguments,1,2),Kr("QuerySnapshot.forEach","function",1,e),this.dl.docs.forEach(function(t){e.call(n,r.Tl(t,r.metadata.fromCache,r.dl.jt.has(t.key)))})},Object.defineProperty(Of.prototype,"query",{get:function(){return new Tf(this.fl,this.nl,this.Wa)},enumerable:!1,configurable:!0}),Of.prototype.docChanges=function(t){if(t&&(oi("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),$r("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges)),(t=!(!t||!t.includeMetadataChanges))&&this.dl.Gt)throw new Ir(Er.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.wl&&this.ml===t||(this.wl=function(i,e,o){if(i.Qt.m()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.jt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Qt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.jt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Lr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.dl,t,this.Tl.bind(this)),this.ml=t),this.wl},Of.prototype.isEqual=function(t){if(!(t instanceof Of))throw si("isEqual","QuerySnapshot",1,t);return this.nl===t.nl&&Ru(this.fl,t.fl)&&this.dl.isEqual(t.dl)&&this.Wa===t.Wa},Of.prototype.Tl=function(t,e,n){return new af(this.nl,t.key,t,e,n,this.Wa)},Of),Nf=(n(Rf,If=Tf),Object.defineProperty(Rf.prototype,"id",{get:function(){return this.ll.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(Rf.prototype,"parent",{get:function(){var t=this.ll.path.h();return t.m()?null:new of(new Fr(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(Rf.prototype,"path",{get:function(){return this.ll.path.R()},enumerable:!1,configurable:!0}),Rf.prototype.doc=function(t){return Xr("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=ci.k()),Kr("CollectionReference.doc","non-empty string",1,t),t=Cr.P(t),of.Zh(this.ll.path.child(t),this.firestore,this.Wa)},Rf.prototype.add=function(t){Qr("CollectionReference.add",arguments,1),Kr("CollectionReference.add","object",1,t=this.Wa?this.Wa.toFirestore(t):t);var e=this.doc();return new of(e.ja,this.firestore,null).set(t).then(function(){return e})},Rf.prototype.withConverter=function(t){return new Rf(this.El,this.firestore,t)},Rf);function Rf(t,e,n){var r=this;if(((r=If.call(this,yu(t),e,n)||this).El=t).length%2!=1)throw new Ir(Er.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.R()+" has "+t.length);return r}function Of(t,e,n,r){this.nl=t,this.fl=e,this.dl=n,this.Wa=r,this.wl=null,this.ml=null,this.metadata=new sf(n.hasPendingWrites,n.fromCache)}function Sf(t,e,n){this.ll=t,this.firestore=e,this.Wa=n}function Df(t,e){if(void 0===e)return{merge:!1};if(oi(t,e,["merge","mergeFields"]),$r(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+ri(n));for(var r,i=0;i<n.length;++i)if(!("string"==typeof(r=n[i])||r instanceof Kc))throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+ri(n[i]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new Ir(Er.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function Lf(t,e){return void 0===e?{}:(oi(t,e,["serverTimestamps"]),Zr(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Vf(t,e){Yr(t,"object",1,e),e&&(oi(t,e,["source"]),Zr(t,0,"source",e.source,["default","server","cache"]))}function _f(t,e,n){if(e instanceof vl){if(e.firestore!==n)throw new Ir(Er.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw si(t,"DocumentReference",1,e)}function Uf(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var kf,jf,l=(n(Cf,kf=dl),Cf.serverTimestamp=function(){Wr("FieldValue.serverTimestamp",arguments);var t=new hl("serverTimestamp");return t.Fa="FieldValue.serverTimestamp",new Cf(t)},Cf.delete=function(){Wr("FieldValue.delete",arguments);var t=new $c("deleteField");return t.Fa="FieldValue.delete",new Cf(t)},Cf.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Hr("FieldValue.arrayUnion",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Hr("arrayUnion()",arguments,1),new cl("arrayUnion",t)}.apply(void 0,t);return n.Fa="FieldValue.arrayUnion",new Cf(n)},Cf.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Hr("FieldValue.arrayRemove",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Hr("arrayRemove()",arguments,1),new ll("arrayRemove",t)}.apply(void 0,t);return n.Fa="FieldValue.arrayRemove",new Cf(n)},Cf.increment=function(t){return Kr("FieldValue.increment","number",1,t),Qr("FieldValue.increment",arguments,1),(t=new fl("increment",t)).Fa="FieldValue.increment",new Cf(t)},Cf.prototype.isEqual=function(t){return this.Ba.isEqual(t.Ba)},Cf),Pf={Firestore:ef,GeoPoint:pl,Timestamp:Ni,Blob:Ii,Transaction:nf,WriteBatch:rf,DocumentReference:of,DocumentSnapshot:uf,Query:Tf,QueryDocumentSnapshot:af,QuerySnapshot:Af,CollectionReference:Nf,FieldPath:Kc,FieldValue:l,setLogLevel:ef.setLogLevel,CACHE_SIZE_UNLIMITED:Zl};function Cf(){return null!==kf&&kf.apply(this,arguments)||this}(jf=e.default).INTERNAL.registerComponent(new mr("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new ef(e,t,new Wc,new Qc);var e},"PUBLIC").setServiceProps(Object.assign({},Pf))),jf.registerVersion("@firebase/firestore","1.18.0")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});