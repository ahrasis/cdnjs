!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(ng){"use strict";try{(function(){var l,t,e=(t=ng)&&"object"==typeof t&&"default"in t?t:{default:t};function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function n(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=u[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(ge=l=l||{})[ge.DEBUG=0]="DEBUG",ge[ge.VERBOSE=1]="VERBOSE",ge[ge.INFO=2]="INFO",ge[ge.WARN=3]="WARN",ge[ge.ERROR=4]="ERROR",ge[ge.SILENT=5]="SILENT";var r={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},i=l.INFO,u=((me={})[l.DEBUG]="log",me[l.VERBOSE]="log",me[l.INFO]="info",me[l.WARN]="warn",me[l.ERROR]="error",me),o=(Object.defineProperty(a.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),a.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?r[t]:t},Object.defineProperty(a.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),a.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.DEBUG],t)),this._logHandler.apply(this,s([this,l.DEBUG],t))},a.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.VERBOSE],t)),this._logHandler.apply(this,s([this,l.VERBOSE],t))},a.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.INFO],t)),this._logHandler.apply(this,s([this,l.INFO],t))},a.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.WARN],t)),this._logHandler.apply(this,s([this,l.WARN],t))},a.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.ERROR],t)),this._logHandler.apply(this,s([this,l.ERROR],t))},a);function a(t){this.name=t,this._logLevel=i,this._logHandler=n,this._userLogHandler=null}var c=function(t,e){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function h(t,e){function n(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function f(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(h(w,d=Error),w);function w(t,e,n){return(e=d.call(this,e)||this).code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(I.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=(t=this.errors[t])?(r=i,t.replace(E,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},I);function I(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var E=/\{\$([^}]+)}/g,_=function(t,e){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function T(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},N=A||self;function S(){}function O(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function D(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var x="closure_uid_"+(1e9*Math.random()>>>0),k=0;function P(t,e,n){return t.call.apply(t.bind,arguments)}function R(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function L(t,e,n){return(L=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?P:R).apply(null,arguments)}function C(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function U(){return Date.now()}function V(t,o){function e(){}e.prototype=o.prototype,t.X=o.prototype,t.prototype=new e,(t.prototype.constructor=t).Kb=function(t,e,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[e].apply(t,r)}}function M(){this.j=this.j,this.i=this.i}M.prototype.j=!1,M.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,x)&&this[x]||(this[x]=++k))},M.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var j=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},F=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function q(){return Array.prototype.concat.apply([],arguments)}function B(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function G(t){return/^[\s\xa0]*$/.test(t)}var z=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function H(t,e){return-1!=t.indexOf(e)}function K(t,e){return t<e?-1:e<t?1:0}var W=N.navigator;function Q(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Y(t){var e,n={};for(e in t)n[e]=t[e];return n}ut=(W=W&&W.userAgent)?W:"";var J="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function X(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<J.length;i++)e=J[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function $(t){return $[" "](t),t}$[" "]=S;var Z,tt=H(ut,"Opera"),et=H(ut,"Trident")||H(ut,"MSIE"),nt=H(ut,"Edge"),rt=nt||et,it=H(ut,"Gecko")&&!(H(ut.toLowerCase(),"webkit")&&!H(ut,"Edge"))&&!(H(ut,"Trident")||H(ut,"MSIE"))&&!H(ut,"Edge"),ot=H(ut.toLowerCase(),"webkit")&&!H(ut,"Edge");function st(){var t=N.document;return t?t.documentMode:void 0}var W="",ut=(ut=ut,it?/rv:([^\);]+)(\)|;)/.exec(ut):nt?/Edge\/([\d\.]+)/.exec(ut):et?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ut):ot?/WebKit\/(\S+)/.exec(ut):tt?/(?:Version)[ \/]?(\S+)/.exec(ut):void 0);ut&&(W=ut?ut[1]:""),Z=et&&null!=(ut=st())&&ut>parseFloat(W)?String(ut):W;var at={};function ct(u){return t=u,e=function(){for(var t=0,e=z(String(Z)).split("."),n=z(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++)for(var o=e[i]||"",s=n[i]||"";o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],(0!=o[0].length||0!=s[0].length)&&(t=K(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||K(0==o[2].length,0==s[2].length)||K(o[2],s[2]),o=o[3],s=s[3],0==t););return 0<=t},n=at,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var ht=N.document&&et&&(st()||parseInt(Z,10))||void 0,ft=!et||9<=Number(ht),lt=et&&!ct("9"),pt=function(){if(!N.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{N.addEventListener("test",S,e),N.removeEventListener("test",S,e)}catch(t){}return t}();function dt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function yt(t,e){if(dt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(it){t:{try{$(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:vt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}dt.prototype.b=function(){this.defaultPrevented=!0},V(yt,dt);var vt={2:"touch",3:"pen",4:"mouse"};yt.prototype.b=function(){yt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,lt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var gt="closure_listenable_"+(1e6*Math.random()|0),mt=0;function wt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++mt,this.Y=this.Z=!1}function bt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function It(t){this.src=t,this.a={},this.b=0}function Et(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=j(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(bt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function _t(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}It.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=_t(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new wt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Tt="closure_lm_"+(1e6*Math.random()|0),At={};function Nt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Lt(r),e&&e[gt]?e.wa(n,r,D(i)?!!i.capture:!!i,o):St(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Nt(t,e[o],n,r,i);return null}return n=Lt(n),t&&t[gt]?t.va(e,n,D(r)?!!r.capture:!!r,i):St(t,e,n,!1,r,i)}function St(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=D(i)?!!i.capture:!!i;if(s&&!ft)return null;var u,a,c=Pt(t);if(c||(t[Tt]=c=new It(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=kt,r=a=ft?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)pt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Dt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ot(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[gt]?Et(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Dt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Pt(e))?(Et(n,t),0==n.b&&(n.src=null,e[Tt]=null)):bt(t)))}function Dt(t){return t in At?At[t]:At[t]="on"+t}function xt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Ot(t),n.call(r,e)}function kt(t,e){if(t.Y)return!0;if(ft)return xt(t,new yt(e,this));if(!e)t:{e=["window","event"];for(var n=N,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return xt(t,e=new yt(e,this))}function Pt(t){return(t=t[Tt])instanceof It?t:null}var Rt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Lt(e){return"function"==typeof e?e:(e[Rt]||(e[Rt]=function(t){return e.handleEvent(t)}),e[Rt])}function Ct(){M.call(this),this.c=new It(this),(this.J=this).C=null}function Ut(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new dt(e,t):e instanceof dt?e.target=e.target||t:(s=e,X(e=new dt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Vt(o,r,!0,e)&&s;if(s=Vt(o=e.a=t,r,!0,e)&&s,s=Vt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Vt(o=e.a=n[i],r,!1,e)&&s}function Vt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Et(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}V(Ct,M),Ct.prototype[gt]=!0,(ut=Ct.prototype).addEventListener=function(t,e,n,r){Nt(this,t,e,n,r)},ut.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=D(i)?!!i.capture:!!i,r=Lt(r),e&&e[gt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=_t(s=e.a[n],r,i,o))&&(bt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Pt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=_t(n,r,i,o)),(r=-1<e?n[e]:null)&&Ot(r))}(this,t,e,n,r)},ut.G=function(){if(Ct.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)bt(n[r]);delete e.a[t],e.b--}}this.C=null},ut.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},ut.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Mt=N.JSON.stringify;function jt(){this.b=this.a=null}var Ft,qt=(Bt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Bt(function(){return new Gt},function(t){t.reset()}));function Bt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Gt(){this.next=this.b=this.a=null}function zt(t,e){var n;Ft||(n=N.Promise.resolve(void 0),Ft=function(){n.then(Wt)}),Ht||(Ft(),Ht=!0),Kt.add(t,e)}jt.prototype.add=function(t,e){var n=qt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Gt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Ht=!(Gt.prototype.reset=function(){this.next=this.b=this.a=null}),Kt=new jt;function Wt(){for(var t,e;n=e=void 0,n=null,(e=Kt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){N.setTimeout(function(){throw t},0)}(t)}var n=qt;n.f(t),n.b<100&&(n.b++,t.next=n.a,n.a=t)}Ht=!1}function Qt(t,e){Ct.call(this),this.b=t||1,this.a=e||N,this.f=L(this.Za,this),this.g=U()}function Yt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Jt(t,e,n){if("function"==typeof t)n&&(t=L(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=L(t.handleEvent,t)}return 2147483647<Number(e)?-1:N.setTimeout(t,e||0)}V(Qt,Ct),(ut=Qt.prototype).aa=!1,ut.M=null,ut.Za=function(){var t;this.aa&&(0<(t=U()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Ut(this,"tick"),this.aa&&(Yt(this),this.start())))},ut.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=U())},ut.G=function(){Qt.X.G.call(this),Yt(this),delete this.a};var Xt,$t,Zt=(_($t=ee,W=Xt=M),$t.prototype=null===W?Object.create(W):(te.prototype=W.prototype,new te),ee.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=Jt(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ee.prototype.G=function(){Xt.prototype.G.call(this),this.a&&(N.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ee);function te(){this.constructor=$t}function ee(t,e){var n=Xt.call(this)||this;return n.g=t,n.h=e,n.b=null,n.c=!1,n.a=null,n}function ne(t){M.call(this),this.b=t,this.a={}}V(ne,M);var re=[];function ie(t,e,n,r){Array.isArray(n)||(n&&(re[0]=n.toString()),n=re);for(var i=0;i<n.length;i++){var o=Nt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function oe(t){Q(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ot(t)},t),t.a={}}function se(){this.a=!0}function ue(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return Mt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ne.prototype.G=function(){ne.X.G.call(this),oe(this)},ne.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},se.prototype.info=function(){};var ae={},ce=null;function he(){return ce=ce||new Ct}function fe(t){dt.call(this,ae.Fa,t)}function le(){var t=he();Ut(t,new fe(t))}function pe(t,e){dt.call(this,ae.STAT_EVENT,t),this.stat=e}function de(t){var e=he();Ut(e,new pe(e,t))}function ye(t){dt.call(this,ae.Ga,t)}function ve(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return N.setTimeout(function(){t()},e)}ae.Fa="serverreachability",V(fe,dt),ae.STAT_EVENT="statevent",V(pe,dt),ae.Ga="timingevent",V(ye,dt);var ge={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},me={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function we(){}function be(t){var e;return(e=t.a)||(e=t.a={}),e}function Ie(){}we.prototype.a=null;var Ee,A={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function _e(){dt.call(this,"d")}function Te(){dt.call(this,"c")}function Ae(){}function Ne(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ne(this),this.P=Se,t=rt?125:void 0,this.R=new Qt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}V(_e,dt),V(Te,dt),V(Ae,we),Ee=new Ae;var Se=45e3,Oe={},De={};function xe(t,e,n){t.H=1,t.i=Xe(He(e)),t.j=n,t.I=!0,ke(t,null)}function ke(t,e){t.u=U(),Re(t),t.l=He(t.i);var s,u,a,c,h,f,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),fn(n.b,"t",r),t.D=0,t.a=ir(t.g,t.g.C?e:null),0<t.O&&(t.F=new Zt(L(t.Ca,t,t.a),t.O)),ie(t.J,t.a,"readystatechange",t.Xa),e=t.B?Y(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),le(),s=t.c,u=t.m,a=t.l,c=t.f,h=t.S,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Pe(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?De:(i=Number(u.substring(i,o)),isNaN(i)?Oe:(o+=1)+i>u.length?De:(u=u.substr(o,i),r.D=o+i,u)));if(u==De){4==e&&(t.h=4,de(14),s=!1),ue(t.c,t.f,null,"[Incomplete Response]");break}if(u==Oe){t.h=4,de(15),ue(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}ue(t.c,t.f,u,null),Me(t,u)}4==e&&0==n.length&&(t.h=1,de(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Jn(e),e.F=!0,de(11))):(ue(t.c,t.f,n,"[Invalid Chunked Response]"),Ve(t),Ue(t))}function Re(t){t.T=U()+t.P,Le(t,t.P)}function Le(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=ve(L(t.Va,t),e)}function Ce(t){t.o&&(N.clearTimeout(t.o),t.o=null)}function Ue(t){0==t.g.v||t.A||Zn(t.g,t)}function Ve(t){Ce(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Yt(t.R),oe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Me(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||mn(u.b,t)))if(u.I=t.N,!t.C&&mn(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;$n(u),qn(u)}Yn(u),de(18)}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=ve(L(u.Sa,u),6e3));if(gn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else er(u,11)}else if(!t.C&&u.a!=t||$n(u),!G(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(H(r,"spdy")||H(r,"quic")||H(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(wn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,Je(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=U()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=rr(n,n.C?n.ga:null,n.fa),i.C?(bn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Ce(o),Re(o)),n.a=i):Qn(n),0<u.g.length&&zn(u)):"stop"!=c[0]&&"close"!=c[0]||er(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?er(u,7):Fn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0);le()}catch(t){}}function je(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(O(t)||"string"==typeof t)F(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(O(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(O(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Fe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Fe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function qe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Be(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Be(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Be(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(ut=Ne.prototype).setTimeout=function(t){this.P=t},ut.Xa=function(t){t=t.target;var e=this.F;e&&3==Un(t)?e.f():this.Ca(t)},ut.Ca=function(t){try{if(t==this.a)t:{var e=Un(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!rt&&!this.a.$())){this.A||4!=e||7==n||le(),Ce(this);var i=this.a.W();if(this.N=i,n=this.a.$(),this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.S,f=e,l=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+f+" "+l}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!G(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,de(12),Ve(this),Ue(this);break t}ue(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Me(this,s)}this.I?(Pe(this,e,n),rt&&this.b&&3==e&&(ie(this.J,this.R,"tick",this.Wa),this.R.start())):(ue(this.c,this.f,n,null),Me(this,n)),4==e&&Ve(this),this.b&&!this.A&&(4==e?Zn(this.g,this):(this.b=!1,Re(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,de(12)):(this.h=0,de(13)),Ve(this),Ue(this)}}}catch(t){}var u,a,c,h,f,l},ut.Wa=function(){var t,e;this.a&&(t=Un(this.a),e=this.a.$(),this.D<e.length&&(Ce(this),Pe(this,t,e),this.b&&4!=t&&Re(this)))},ut.cancel=function(){this.A=!0,Ve(this)},ut.Va=function(){this.o=null;var t,e,n=U();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(le(),de(17)),Ve(this),this.h=2,Ue(this)):Le(this,this.T-n)},(ut=Fe.prototype).K=function(){qe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},ut.L=function(){return qe(this),this.a.concat()},ut.get=function(t,e){return Be(this.b,t)?this.b[t]:e},ut.set=function(t,e){Be(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},ut.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ge=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function ze(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof ze?(this.a=void 0!==e?e:t.a,Ke(this,t.f),this.j=t.j,We(this,t.c),Qe(this,t.h),this.g=t.g,e=t.b,(n=new un).c=e.c,e.a&&(n.a=new Fe(e.a),n.b=e.b),Ye(this,n),this.i=t.i):t&&(n=String(t).match(Ge))?(this.a=!!e,Ke(this,n[1]||"",!0),this.j=$e(n[2]||""),We(this,n[3]||"",!0),Qe(this,n[4]),this.g=$e(n[5]||"",!0),Ye(this,n[6]||"",!0),this.i=$e(n[7]||"")):(this.a=!!e,this.b=new un(null,this.a))}function He(t){return new ze(t)}function Ke(t,e,n){t.f=n?$e(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function We(t,e,n){t.c=n?$e(e,!0):e}function Qe(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Ye(t,e,n){var r,i;e instanceof un?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(an(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(cn(this,e),fn(this,n,t))},r)),r.f=i):(n||(e=Ze(e,on)),t.b=new un(e,t.a))}function Je(t,e,n){t.b.set(e,n)}function Xe(t){return Je(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^U()).toString(36)),t}function $e(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ze(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,tn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function tn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}ze.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Ze(e,en,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(Ze(e,en,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Ze(n,"/"==n.charAt(0)?rn:nn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Ze(n,sn)),t.join("")};var en=/[#\/\?@]/g,nn=/[#\?:]/g,rn=/[#\?]/g,on=/[#\?@]/g,sn=/#/g;function un(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function an(o){o.a||(o.a=new Fe,o.b=0,o.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],r=n,i=i?decodeURIComponent(i.replace(/\+/g," ")):"",o.add(decodeURIComponent(r.replace(/\+/g," ")),i)}}}(o.c))}function cn(t,e){an(t),e=ln(t,e),Be(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Be((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&qe(t)))}function hn(t,e){return an(t),e=ln(t,e),Be(t.a.b,e)}function fn(t,e,n){cn(t,e),0<n.length&&(t.c=null,t.a.set(ln(t,e),B(n)),t.b+=n.length)}function ln(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(ut=un.prototype).add=function(t,e){an(this),this.c=null,t=ln(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},ut.forEach=function(n,r){an(this),this.a.forEach(function(t,e){F(t,function(t){n.call(r,t,e,this)},this)},this)},ut.L=function(){an(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},ut.K=function(t){an(this);var e=[];if("string"==typeof t)hn(this,t)&&(e=q(e,this.a.get(ln(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=q(e,t[n])}return e},ut.set=function(t,e){return an(this),this.c=null,hn(this,t=ln(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},ut.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},ut.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};function pn(t,e){this.b=t,this.a=e}function dn(t){this.g=t||yn,t=N.PerformanceNavigationTiming?0<(t=N.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(N.ia&&N.ia.ya&&N.ia.ya()&&N.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var yn=10;function vn(t){return t.b||t.a&&t.a.size>=t.f}function gn(t){return t.b?1:t.a?t.a.size:0}function mn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function wn(t,e){t.a?t.a.add(e):t.b=e}function bn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function In(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return B(t.c);var r=t.c;try{for(var i=T(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function En(){}function _n(){this.a=new En}function Tn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}dn.prototype.cancel=function(){var t,e;if(this.c=In(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=T(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},En.prototype.stringify=function(t){return N.JSON.stringify(t,void 0)},En.prototype.parse=function(t){return N.JSON.parse(t,void 0)};var An=N.JSON.parse;function Nn(t){Ct.call(this),this.headers=new Fe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Sn,this.D=this.F=!1}V(Nn,Ct);var Sn="",On=/^https?$/i,Dn=["POST","PUT"];function xn(t){return"content-type"==t.toLowerCase()}function kn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Pn(t),Ln(t)}function Pn(t){t.u||(t.u=!0,Ut(t,"complete"),Ut(t,"error"))}function Rn(t){if(t.b&&(!t.s[1]||4!=Un(t)||2!=t.W()))if(t.l&&4==Un(t))Jt(t.za,0,t);else if(Ut(t,"readystatechange"),4==Un(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Ge)[1]||null)&&N.self&&N.self.location&&(i=(r=N.self.location.protocol).substr(0,r.length-1)),n=!On.test(i?i.toLowerCase():"")),e=n),e)Ut(t,"complete"),Ut(t,"success");else{t.h=6;try{var u=2<Un(t)?t.a.statusText:""}catch(o){u=""}t.f=u+" ["+t.W()+"]",Pn(t)}}finally{Ln(t)}}}function Ln(t,e){if(t.a){Cn(t);var n=t.a,r=t.s[0]?S:null;t.a=null,t.s=null,e||Ut(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Cn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(N.clearTimeout(t.m),t.m=null)}function Un(t){return t.a?t.a.readyState:0}function Vn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",Q(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Je(t,e,n))}function Mn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function jn(t){this.pa=0,this.g=[],this.c=new se,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Mn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Mn("baseRetryDelayMs",5e3,t),this.Ra=Mn("retryDelaySeedMs",1e4,t),this.Ma=Mn("forwardChannelMaxRetries",2,t),this.ma=Mn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new dn(t&&t.concurrentRequestLimit),this.ka=new _n,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Fn(t){var e,n;Bn(t),3==t.v&&(e=t.R++,Je(n=He(t.B),"SID",t.J),Je(n,"RID",e),Je(n,"TYPE","terminate"),Kn(t,n),(e=new Ne(t,t.c,e,void 0)).H=2,e.i=Xe(He(n)),n=!1,N.navigator&&N.navigator.sendBeacon&&(n=N.navigator.sendBeacon(e.i.toString(),"")),!n&&N.Image&&((new Image).src=e.i,n=!0),n||(e.a=ir(e.g,null),e.a.ba(e.i)),e.u=U(),Re(e)),nr(t)}function qn(t){t.a&&(Jn(t),t.a.cancel(),t.a=null)}function Bn(t){qn(t),t.j&&(N.clearTimeout(t.j),t.j=null),$n(t),t.b.cancel(),t.h&&("number"==typeof t.h&&N.clearTimeout(t.h),t.h=null)}function Gn(t,e){t.g.push(new pn(t.Oa++,e)),3==t.v&&zn(t)}function zn(t){vn(t.b)||t.h||(t.h=!0,zt(t.Ba,t),t.u=0)}function Hn(t,e){var n=e?e.f:t.R++,r=He(t.B);Je(r,"SID",t.J),Je(r,"RID",n),Je(r,"AID",t.P),Kn(t,r),t.i&&t.l&&Vn(r,t.i,t.l),n=new Ne(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Wn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),wn(t.b,n),xe(n,r,e)}function Kn(t,n){t.f&&je({},function(t,e){Je(n,e,t)})}function Wn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?L(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+c+"_"||"";try{je(t,function(t,e){var n=t;D(t)&&(n=Mt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s)}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Qn(t){t.a||t.j||(t.T=1,zt(t.Aa,t),t.o=0)}function Yn(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=ve(L(t.Aa,t),tr(t,t.o)),t.o++,1)}function Jn(t){null!=t.s&&(N.clearTimeout(t.s),t.s=null)}function Xn(t){t.a=new Ne(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=He(t.la);Je(e,"RID","rpc"),Je(e,"SID",t.J),Je(e,"CI",t.H?"0":"1"),Je(e,"AID",t.P),Kn(t,e),Je(e,"TYPE","xmlhttp"),t.i&&t.l&&Vn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=Xe(He(e)),n.j=null,n.I=!0,ke(n,t)}function $n(t){null!=t.m&&(N.clearTimeout(t.m),t.m=null)}function Zn(t,e){var n,r,i,o=null;if(t.a==e){$n(t),Jn(t),t.a=null;var s=2}else{if(!mn(t.b,e))return;o=e.s,bn(t.b,e),s=1}if(t.I=e.N,0!=t.v)if(e.b)1==s?(o=e.j?e.j.length:0,e=U()-e.u,n=t.u,Ut(s=he(),new ye(s)),zn(t)):Qn(t);else if(3==(n=e.h)||0==n&&0<t.I||(1!=s||(i=e,gn((r=t).b)>=r.b.f-(r.h?1:0)||(r.h?(r.g=i.s.concat(r.g),0):1==r.v||2==r.v||r.u>=(r.La?0:r.Ma)||(r.h=ve(L(r.Ba,r,i),tr(r,r.u)),r.u++,0))))&&(2!=s||!Yn(t)))switch(o&&0<o.length&&(e=t.b,e.c=e.c.concat(o)),n){case 1:er(t,5);break;case 4:er(t,10);break;case 3:er(t,6);break;default:er(t,2)}}function tr(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function er(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=L(t.Ya,t),r||(r=new ze("//www.google.com/images/cleardot.gif"),N.location&&"http"==N.location.protocol||Ke(r,"https"),Xe(r)),n=r.toString(),r=o,o=new se,N.Image?((i=new Image).onload=C(Tn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=C(Tn,o,i,"TestLoadImage: error",!1,r),i.onabort=C(Tn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=C(Tn,o,i,"TestLoadImage: timeout",!1,r),N.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):de(2),t.v=0,t.f&&t.f.ra(e),nr(t),Bn(t)}function nr(t){t.v=0,t.I=-1,t.f&&(0==In(t.b).length&&0==t.g.length||(t.b.c.length=0,B(t.g),t.g.length=0),t.f.qa())}function rr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof ze?He(s):new ze(s,void 0);return""!=a.c?(e&&We(a,e+"."+a.c),Qe(a,a.h)):(r=(u=N.location).protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new ze(null,void 0),r&&Ke(u,r),i&&We(u,i),o&&Qe(u,o),s&&(u.g=s),a=u),t.V&&Q(t.V,function(t,e){Je(a,e,t)}),e=t.A,n=t.na,e&&n&&Je(a,e,n),Je(a,"VER",t.ha),Kn(t,a),a}function ir(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Nn(t.Na)).F=t.C,e}function or(){}function sr(){if(et&&!(10<=Number(ht)))throw Error("Environmental error: no available transport.")}function ur(t,e){Ct.call(this),this.a=new jn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!G(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!G(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new hr(this)}function ar(t){_e.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function cr(){Te.call(this),this.status=1}function hr(t){this.a=t}(ut=Nn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?be(this.H):be(Ee),this.a.onreadystatechange=L(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void kn(this,t)}t=n||"";var i,o=new Fe(this.headers);r&&je(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=xn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=N.FormData&&t instanceof N.FormData,0<=j(Dn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Cn(this),0<this.o&&((this.D=(i=this.a,et&&ct(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=L(this.xa,this)):this.m=Jt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){kn(this,t)}},ut.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Ut(this,"timeout"),this.abort(8))},ut.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Ut(this,"complete"),Ut(this,"abort"),Ln(this))},ut.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Ln(this,!0)),Nn.X.G.call(this)},ut.za=function(){this.j||(this.A||this.l||this.g?Rn(this):this.Ua())},ut.Ua=function(){Rn(this)},ut.W=function(){try{return 2<Un(this)?this.a.status:-1}catch(t){return-1}},ut.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},ut.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),An(e)}},ut.ua=function(){return this.h},ut.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(ut=jn.prototype).ha=8,ut.v=1,ut.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ne(this,this.c,t,void 0),r=this.l;if(this.O&&(r?X(r=Y(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Wn(this,n,e),Je(i=He(this.B),"RID",t),Je(i,"CVER",22),this.A&&Je(i,"X-HTTP-Session-Id",this.A),Kn(this,i),this.i&&r&&Vn(i,this.i,r),wn(this.b,n),this.Ia&&Je(i,"TYPE","init"),this.da?(Je(i,"$req",e),Je(i,"SID","null"),n.U=!0,xe(n,i,null)):xe(n,i,e),this.v=2}}else 3==this.v&&(t?Hn(this,t):0==this.g.length||vn(this.b)||Hn(this))},ut.Aa=function(){var t;this.j=null,Xn(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=ve(L(this.Ta,this),t))},ut.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,de(10),qn(this),Xn(this))},ut.Sa=function(){null!=this.m&&(this.m=null,qn(this),Yn(this),de(19))},ut.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),de(2)):(this.c.info("Failed to ping google.com"),de(1))},(ut=or.prototype).ta=function(){},ut.sa=function(){},ut.ra=function(){},ut.qa=function(){},ut.Ja=function(){},sr.prototype.a=function(t,e){return new ur(t,e)},V(ur,Ct),ur.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;de(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=rr(t,null,t.fa),zn(t)},ur.prototype.close=function(){Fn(this.a)},ur.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Gn(this.a,e)):this.l?((e={}).__data__=Mt(t),Gn(this.a,e)):Gn(this.a,t)},ur.prototype.G=function(){this.a.f=null,delete this.f,Fn(this.a),delete this.a,ur.X.G.call(this)},V(ar,_e),V(cr,Te),V(hr,or),hr.prototype.ta=function(){Ut(this.a,"a")},hr.prototype.sa=function(t){Ut(this.a,new ar(t))},hr.prototype.ra=function(t){Ut(this.a,new cr)},hr.prototype.qa=function(){Ut(this.a,"b")},sr.prototype.createWebChannel=sr.prototype.a,ur.prototype.send=ur.prototype.h,ur.prototype.open=ur.prototype.g,ge.NO_ERROR=0,ge.TIMEOUT=8,ge.HTTP_ERROR=6,me.COMPLETE="complete",(Ie.EventType=A).OPEN="a",A.CLOSE="b",A.ERROR="c",A.MESSAGE="d",Ct.prototype.listen=Ct.prototype.va,Nn.prototype.listenOnce=Nn.prototype.wa,Nn.prototype.getLastError=Nn.prototype.Qa,Nn.prototype.getLastErrorCode=Nn.prototype.ua,Nn.prototype.getStatus=Nn.prototype.W,Nn.prototype.getResponseJson=Nn.prototype.Pa,Nn.prototype.getResponseText=Nn.prototype.$,Nn.prototype.send=Nn.prototype.ba;var fr=he,lr=ge,pr=me,dr=ae,yr=Ie,vr=Nn,gr=new o("@firebase/firestore");function mr(){return gr.logLevel}function wr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];gr.logLevel<=l.DEBUG&&(e=n.map(Er),gr.debug.apply(gr,f(["Firestore (8.2.0): "+t],e)))}function br(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];gr.logLevel<=l.ERROR&&(e=n.map(Er),gr.error.apply(gr,f(["Firestore (8.2.0): "+t],e)))}function Ir(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];gr.logLevel<=l.WARN&&(e=n.map(Er),gr.warn.apply(gr,f(["Firestore (8.2.0): "+t],e)))}function Er(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function _r(t){throw void 0===t&&(t="Unexpected state"),br(t="FIRESTORE (8.2.0) INTERNAL ASSERTION FAILED: "+t),new Error(t)}function Tr(t){t||_r()}var Ar=(Nr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Nr);function Nr(){}function Sr(t,e){return t<e?-1:e<t?1:0}function Or(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Dr(t){return t+"\0"}var xr=(kr.fromBase64String=function(t){return new kr(atob(t))},kr.fromUint8Array=function(t){return new kr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},kr.prototype.toBase64=function(){return t=this.i,btoa(t);var t},kr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},kr.prototype.o=function(){return 2*this.i.length},kr.prototype.u=function(t){return Sr(this.i,t.i)},kr.prototype.isEqual=function(t){return this.i===t.i},kr);function kr(t){this.i=t}xr.h=new xr("");var Pr,Rr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Lr=(h(Mr,Pr=Error),Mr),Cr=(Vr.fromBase64String=function(t){try{return new Vr(xr.fromBase64String(t))}catch(t){throw new Lr(Rr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},Vr.fromUint8Array=function(t){return new Vr(xr.fromUint8Array(t))},Vr.prototype.toBase64=function(){return this.l.toBase64()},Vr.prototype.toUint8Array=function(){return this.l.toUint8Array()},Vr.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Vr.prototype.isEqual=function(t){return this.l.isEqual(t.l)},Vr),Ur=function(t){this._=t};function Vr(t){this.l=t}function Mr(t,e){var n=this;return(n=Pr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function jr(){if("undefined"==typeof Uint8Array)throw new Lr(Rr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Fr(){if("undefined"==typeof atob)throw new Lr(Rr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var qr,Br=(h(Hr,qr=Ur),Hr.fromBase64String=function(t){return Fr(),new Hr(Cr.fromBase64String(t))},Hr.fromUint8Array=function(t){return jr(),new Hr(Cr.fromUint8Array(t))},Hr.prototype.toBase64=function(){return Fr(),this._.toBase64()},Hr.prototype.toUint8Array=function(){return jr(),this._.toUint8Array()},Hr.prototype.isEqual=function(t){return this._.isEqual(t._)},Hr.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Hr),Gr=(zr.prototype.T=function(){return null!=this.uid},zr.prototype.I=function(){return this.T()?"uid:"+this.uid:"anonymous-user"},zr.prototype.isEqual=function(t){return t.uid===this.uid},zr);function zr(t){this.uid=t}function Hr(){return null!==qr&&qr.apply(this,arguments)||this}function Kr(t,e){this.user=e,this.type="OAuth",this.R={},this.R.Authorization="Bearer "+t}Gr.UNAUTHENTICATED=new Gr(null),Gr.m=new Gr("google-credentials-uid"),Gr.A=new Gr("first-party-uid");var Wr=(ui.prototype.getToken=function(){return Promise.resolve(null)},ui.prototype.g=function(){},ui.prototype.V=function(t){(this.P=t)(Gr.UNAUTHENTICATED)},ui.prototype.p=function(){this.P=null},ui),Qr=(si.prototype.getToken=function(){var e=this,n=this.D,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.D!==n?(wr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Tr("string"==typeof t.accessToken),new Kr(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},si.prototype.g=function(){this.forceRefresh=!0},si.prototype.V=function(t){this.P=t,this.S&&t(this.currentUser)},si.prototype.p=function(){this.auth&&this.auth.removeAuthTokenListener(this.v),this.v=null,this.P=null},si.prototype.C=function(){var t=this.auth&&this.auth.getUid();return Tr(null===t||"string"==typeof t),new Gr(t)},si),Yr=(Object.defineProperty(oi.prototype,"R",{get:function(){var t={"X-Goog-AuthUser":this.F},e=this.N.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),oi),Jr=(ii.prototype.getToken=function(){return Promise.resolve(new Yr(this.N,this.F))},ii.prototype.V=function(t){t(Gr.A)},ii.prototype.p=function(){},ii.prototype.g=function(){},ii),Xr=function(t,e,n,r,i,o){this.O=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.k=o},$r=(Object.defineProperty(ri.prototype,"M",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),ri.prototype.isEqual=function(t){return t instanceof ri&&t.projectId===this.projectId&&t.database===this.database},ri),Zr=(ni.prototype.L=function(t){},ni.prototype.$=function(){},ni),ti=(ei.prototype.L=function(t){this.W.push(t)},ei.prototype.$=function(){window.removeEventListener("online",this.B),window.removeEventListener("offline",this.U)},ei.prototype.j=function(){window.addEventListener("online",this.B),window.addEventListener("offline",this.U)},ei.prototype.q=function(){wr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.W;t<e.length;t++)(0,e[t])(0)},ei.prototype.K=function(){wr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.W;t<e.length;t++)(0,e[t])(1)},ei.G=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},ei);function ei(){var t=this;this.B=function(){return t.q()},this.U=function(){return t.K()},this.W=[],this.j()}function ni(){}function ri(t,e){this.projectId=t,this.database=e||"(default)"}function ii(t,e){this.N=t,this.F=e}function oi(t,e){this.N=t,this.F=e,this.type="FirstParty",this.user=Gr.A}function si(t){var e=this;this.v=null,this.currentUser=Gr.UNAUTHENTICATED,this.S=!1,this.D=0,this.P=null,this.forceRefresh=!1,this.v=function(){e.D++,e.currentUser=e.C(),e.S=!0,e.P&&e.P(e.currentUser)},this.D=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.v):(this.v(null),t.get().then(function(t){e.auth=t,e.v&&e.auth.addAuthTokenListener(e.v)},function(){}))}function ui(){this.P=null}function ai(t){return null==t}function ci(t){return 0===t&&1/t==-1/0}function hi(t){return"number"==typeof t&&Number.isInteger(t)&&!ci(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var fi,li={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};function pi(t){switch(t){case Rr.OK:return _r(),0;case Rr.CANCELLED:case Rr.UNKNOWN:case Rr.DEADLINE_EXCEEDED:case Rr.RESOURCE_EXHAUSTED:case Rr.INTERNAL:case Rr.UNAVAILABLE:case Rr.UNAUTHENTICATED:return;case Rr.INVALID_ARGUMENT:case Rr.NOT_FOUND:case Rr.ALREADY_EXISTS:case Rr.PERMISSION_DENIED:case Rr.FAILED_PRECONDITION:case Rr.ABORTED:case Rr.OUT_OF_RANGE:case Rr.UNIMPLEMENTED:case Rr.DATA_LOSS:return 1;default:return _r(),0}}function di(t){if(void 0===t)return br("GRPC error has no .code"),Rr.UNKNOWN;switch(t){case fi.OK:return Rr.OK;case fi.CANCELLED:return Rr.CANCELLED;case fi.UNKNOWN:return Rr.UNKNOWN;case fi.DEADLINE_EXCEEDED:return Rr.DEADLINE_EXCEEDED;case fi.RESOURCE_EXHAUSTED:return Rr.RESOURCE_EXHAUSTED;case fi.INTERNAL:return Rr.INTERNAL;case fi.UNAVAILABLE:return Rr.UNAVAILABLE;case fi.UNAUTHENTICATED:return Rr.UNAUTHENTICATED;case fi.INVALID_ARGUMENT:return Rr.INVALID_ARGUMENT;case fi.NOT_FOUND:return Rr.NOT_FOUND;case fi.ALREADY_EXISTS:return Rr.ALREADY_EXISTS;case fi.PERMISSION_DENIED:return Rr.PERMISSION_DENIED;case fi.FAILED_PRECONDITION:return Rr.FAILED_PRECONDITION;case fi.ABORTED:return Rr.ABORTED;case fi.OUT_OF_RANGE:return Rr.OUT_OF_RANGE;case fi.UNIMPLEMENTED:return Rr.UNIMPLEMENTED;case fi.DATA_LOSS:return Rr.DATA_LOSS;default:return _r()}}(me=fi={})[me.OK=0]="OK",me[me.CANCELLED=1]="CANCELLED",me[me.UNKNOWN=2]="UNKNOWN",me[me.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",me[me.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",me[me.NOT_FOUND=5]="NOT_FOUND",me[me.ALREADY_EXISTS=6]="ALREADY_EXISTS",me[me.PERMISSION_DENIED=7]="PERMISSION_DENIED",me[me.UNAUTHENTICATED=16]="UNAUTHENTICATED",me[me.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",me[me.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",me[me.ABORTED=10]="ABORTED",me[me.OUT_OF_RANGE=11]="OUT_OF_RANGE",me[me.UNIMPLEMENTED=12]="UNIMPLEMENTED",me[me.INTERNAL=13]="INTERNAL",me[me.UNAVAILABLE=14]="UNAVAILABLE",me[me.DATA_LOSS=15]="DATA_LOSS";var yi,vi,gi,mi=(Ci.prototype.Y=function(t){this.X=t},Ci.prototype.Z=function(t){this.tt=t},Ci.prototype.onMessage=function(t){this.et=t},Ci.prototype.close=function(){this.J()},Ci.prototype.send=function(t){this.H(t)},Ci.prototype.nt=function(){this.X()},Ci.prototype.st=function(t){this.tt(t)},Ci.prototype.it=function(t){this.et(t)},Ci),wi=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})},bi=(Li.prototype.at=function(e,t,n,r){var i=this.ut(e,t);return wr("RestConnection","Sending: ",i,n),t={},this.ht(t,r),this.lt(e,i,t,n).then(function(t){return wr("RestConnection","Received: ",t),t},function(t){throw Ir("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Li.prototype._t=function(t,e,n,r){return this.at(t,e,n,r)},Li.prototype.ht=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.2.0",t["Content-Type"]="text/plain",e)for(var n in e.R)e.R.hasOwnProperty(n)&&(t[n]=e.R[n])},Li.prototype.ut=function(t,e){return t=li[t],this.ot+"/v1/"+e+":"+t},h(Ri,gi=Li),Ri.prototype.lt=function(o,e,s,u){return new Promise(function(n,r){var i=new vr;i.listenOnce(pr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case lr.NO_ERROR:var t=i.getResponseJson();wr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case lr.TIMEOUT:wr("Connection",'RPC "'+o+'" timed out'),r(new Lr(Rr.DEADLINE_EXCEEDED,"Request time out"));break;case lr.HTTP_ERROR:var e=i.getStatus();wr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace(/_/g,"-"),e=0<=Object.values(Rr).indexOf(e)?e:Rr.UNKNOWN,r(new Lr(e,t.message))):r(new Lr(Rr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Lr(Rr.UNAVAILABLE,"Connection failed."));break;default:_r()}}finally{wr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},Ri.prototype.ft=function(t,e){var n,r=[this.ot,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new sr,o=fr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.O.projectId+"/databases/"+this.O.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.k};this.ht(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),wr("Connection","Creating WebChannel: "+(r=r.join("")),t);var s=i.createWebChannel(r,t),u=!1,a=!1,c=new mi({H:function(t){a?wr("Connection","Not sending because WebChannel is closed:",t):(u||(wr("Connection","Opening WebChannel transport."),s.open(),u=!0),wr("Connection","WebChannel sending:",t),s.send(t))},J:function(){return s.close()}});return(t=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})})(s,yr.EventType.OPEN,function(){a||wr("Connection","WebChannel transport opened.")}),t(s,yr.EventType.CLOSE,function(){a||(a=!0,wr("Connection","WebChannel transport closed"),c.st())}),t(s,yr.EventType.ERROR,function(t){a||(a=!0,Ir("Connection","WebChannel transport errored:",t),c.st(new Lr(Rr.UNAVAILABLE,"The operation could not be completed")))}),t(s,yr.EventType.MESSAGE,function(t){var e,n,r,i;a||(Tr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(wr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=fi[r];if(void 0!==t)return di(t)}(),i=n.message,void 0===t&&(t=Rr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),a=!0,c.st(new Lr(t,i)),s.close()):(wr("Connection","WebChannel received:",e),c.it(e)))}),t(o,dr.STAT_EVENT,function(t){10===t.stat?wr("Connection","Detected buffering proxy"):11===t.stat&&wr("Connection","Detected no buffering proxy")}),setTimeout(function(){c.nt()},0),c},Ri),Ii=(Pi.now=function(){return Pi.fromMillis(Date.now())},Pi.fromDate=function(t){return Pi.fromMillis(t.getTime())},Pi.fromMillis=function(t){var e=Math.floor(t/1e3);return new Pi(e,1e6*(t-1e3*e))},Pi.prototype.toDate=function(){return new Date(this.toMillis())},Pi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Pi.prototype.dt=function(t){return this.seconds===t.seconds?Sr(this.nanoseconds,t.nanoseconds):Sr(this.seconds,t.seconds)},Pi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Pi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Pi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},Pi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Pi),Ei=(ki.wt=function(t){return new ki(t)},ki.min=function(){return new ki(new Ii(0,0))},ki.prototype.u=function(t){return this.timestamp.dt(t.timestamp)},ki.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},ki.prototype.Et=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},ki.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},ki.prototype.Tt=function(){return this.timestamp},ki),o=(Object.defineProperty(xi.prototype,"length",{get:function(){return this.It},enumerable:!1,configurable:!0}),xi.prototype.isEqual=function(t){return 0===xi.At(this,t)},xi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof xi?t.forEach(function(t){e.push(t)}):e.push(t),this.Rt(e)},xi.prototype.limit=function(){return this.offset+this.length},xi.prototype.Pt=function(t){return t=void 0===t?1:t,this.Rt(this.segments,this.offset+t,this.length-t)},xi.prototype.yt=function(){return this.Rt(this.segments,this.offset,this.length-1)},xi.prototype.gt=function(){return this.segments[this.offset]},xi.prototype.Vt=function(){return this.get(this.length-1)},xi.prototype.get=function(t){return this.segments[this.offset+t]},xi.prototype.bt=function(){return 0===this.length},xi.prototype.vt=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},xi.prototype.St=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},xi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},xi.prototype.Dt=function(){return this.segments.slice(this.offset,this.limit())},xi.At=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},xi),_i=(h(Di,vi=o),Di.prototype.Rt=function(t,e,n){return new Di(t,e,n)},Di.prototype.Ct=function(){return this.Dt().join("/")},Di.prototype.toString=function(){return this.Ct()},Di.xt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Lr(Rr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new Di(n)},Di.Nt=function(){return new Di([])},Di),Ti=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ai=(h(Oi,yi=o),Oi.prototype.Rt=function(t,e,n){return new Oi(t,e,n)},Oi.Ft=function(t){return Ti.test(t)},Oi.prototype.Ct=function(){return this.Dt().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Oi.Ft(t)||(t="`"+t+"`"),t}).join(".")},Oi.prototype.toString=function(){return this.Ct()},Oi.prototype.Ot=function(){return 1===this.length&&"__name__"===this.get(0)},Oi.kt=function(){return new Oi(["__name__"])},Oi.Mt=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Lr(Rr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Lr(Rr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Lr(Rr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Lr(Rr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Oi(e)},Oi.Nt=function(){return new Oi([])},Oi),Ni=(Si.Lt=function(t){return new Si(_i.xt(t))},Si.$t=function(t){return new Si(_i.xt(t).Pt(5))},Si.prototype.Bt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Si.prototype.isEqual=function(t){return null!==t&&0===_i.At(this.path,t.path)},Si.prototype.toString=function(){return this.path.toString()},Si.At=function(t,e){return _i.At(t.path,e.path)},Si.qt=function(t){return t.length%2==0},Si.Ut=function(t){return new Si(new _i(t.slice()))},Si);function Si(t){this.path=t}function Oi(){return null!==yi&&yi.apply(this,arguments)||this}function Di(){return null!==vi&&vi.apply(this,arguments)||this}function xi(t,e,n){void 0===e?e=0:e>t.length&&_r(),void 0===n?n=t.length-e:n>t.length-e&&_r(),this.segments=t,this.offset=e,this.It=n}function ki(t){this.timestamp=t}function Pi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Lr(Rr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Lr(Rr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Lr(Rr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Lr(Rr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Ri(t){var e=this;return(e=gi.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.k=t.k,e}function Li(t){this.rt=t,this.O=t.O;var e=t.ssl?"https":"http";this.ot=e+"://"+t.host,this.ct="projects/"+this.O.projectId+"/databases/"+this.O.database+"/documents"}function Ci(t){this.H=t.H,this.J=t.J}function Ui(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Vi(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Mi(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var ji=(qi.prototype.Qt=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].vt(t))return!0;return!1},qi.prototype.isEqual=function(t){return Or(this.fields,t.fields,function(t,e){return t.isEqual(e)})},qi),Fi=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function qi(t){(this.fields=t).sort(Ai.At)}function Bi(t){if(Tr(!!t),"string"!=typeof t)return{seconds:Gi(t.seconds),nanos:Gi(t.nanos)};var e=0,n=Fi.exec(t);return Tr(!!n),n[1]&&(n=(n[1]+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Gi(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function zi(t){return"string"==typeof t?xr.fromBase64String(t):xr.fromUint8Array(t)}function Hi(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Ki(t){return t=Bi(t.mapValue.fields.__local_write_time__.timestampValue),new Ii(t.seconds,t.nanos)}function Wi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Hi(t)?4:10:_r()}function Qi(r,i){var t,e=Wi(r);if(e!==Wi(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return Ki(r).isEqual(Ki(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Bi(r.timestampValue),t=Bi(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,zi(r.bytesValue).isEqual(zi(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Gi((t=r).geoPointValue.latitude)===Gi(e.geoPointValue.latitude)&&Gi(t.geoPointValue.longitude)===Gi(e.geoPointValue.longitude);case 2:return t=i,"integerValue"in(e=r)&&"integerValue"in t?Gi(e.integerValue)===Gi(t.integerValue):"doubleValue"in e&&"doubleValue"in t&&((e=Gi(e.doubleValue))===(t=Gi(t.doubleValue))?ci(e)===ci(t):isNaN(e)&&isNaN(t));case 9:return Or(r.arrayValue.values||[],i.arrayValue.values||[],Qi);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Ui(e)!==Ui(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!Qi(e[t],n[t])))return!1;return!0}();default:return _r()}}function Yi(t,e){return void 0!==(t.values||[]).find(function(t){return Qi(t,e)})}function Ji(t,e){var n,r,i,o=Wi(t),s=Wi(e);if(o!==s)return Sr(o,s);switch(o){case 0:return 0;case 1:return Sr(t.booleanValue,e.booleanValue);case 2:return n=e,(r=Gi(t.integerValue||t.doubleValue))<(n=Gi(n.integerValue||n.doubleValue))?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return Xi(t.timestampValue,e.timestampValue);case 4:return Xi(Ki(t),Ki(e));case 5:return Sr(t.stringValue,e.stringValue);case 6:return i=t.bytesValue,s=e.bytesValue,i=zi(i),s=zi(s),i.u(s);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Sr(n[i],r[i]);if(0!==o)return o}return Sr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return o=t.geoPointValue,r=e.geoPointValue,0!==(n=Sr(Gi(o.latitude),Gi(r.latitude)))?n:Sr(Gi(o.longitude),Gi(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Ji(n[i],r[i]);if(o)return o}return Sr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Sr(r[s],o[s]);if(0!==u)return u;if(0!==(u=Ji(n[r[s]],i[o[s]])))return u}return Sr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw _r()}}function Xi(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Sr(t,e);var n=Bi(t),t=Bi(e);return 0!==(e=Sr(n.seconds,t.seconds))?e:Sr(n.nanos,t.nanos)}function $i(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=Bi(t=i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?zi(i.bytesValue).toBase64():"referenceValue"in i?(e=i.referenceValue,Ni.$t(e).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):_r();var t,e}(t)}function Zi(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.Ct()}}function to(t){return t&&"integerValue"in t}function eo(t){return!!t&&"arrayValue"in t}function no(t){return t&&"nullValue"in t}function ro(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function io(t){return t&&"mapValue"in t}var oo=(ao.empty=function(){return new ao({mapValue:{}})},ao.prototype.field=function(t){if(t.bt())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!io(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.Vt()])||null},ao.prototype.isEqual=function(t){return Qi(this.proto,t.proto)},ao),so=(uo.prototype.set=function(t,e){return this.jt(t,e),this},uo.prototype.delete=function(t){return this.jt(t,null),this},uo.prototype.jt=function(t,e){for(var n=this.Wt,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===Wi(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.Vt(),e)},uo.prototype.Gt=function(){var t=this.zt(Ai.Nt(),this.Wt);return null!=t?new oo(t):this.Kt},uo.prototype.zt=function(r,t){var i=this,o=!1,e=this.Kt.field(r),s=io(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.zt(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},uo);function uo(t){void 0===t&&(t=oo.empty()),this.Kt=t,this.Wt=new Map}function ao(t){this.proto=t}var co,ho,fo,lo=(h(wo,fo=me=function(t,e){this.key=t,this.version=e}),wo.prototype.field=function(t){return this.Ht.field(t)},wo.prototype.data=function(){return this.Ht},wo.prototype.Yt=function(){return this.Ht.proto},wo.prototype.isEqual=function(t){return t instanceof wo&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Jt===t.Jt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Ht.isEqual(t.Ht)},wo.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Ht.toString()+", {hasLocalMutations: "+this.Jt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(wo.prototype,"hasPendingWrites",{get:function(){return this.Jt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),wo),po=(h(mo,ho=me),mo.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(mo.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),mo.prototype.isEqual=function(t){return t instanceof mo&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},mo),yo=(h(go,co=me),go.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(go.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),go.prototype.isEqual=function(t){return t instanceof go&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},go),vo=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Xt=null};function go(){return null!==co&&co.apply(this,arguments)||this}function mo(t,e,n){var r=this;return(r=ho.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function wo(t,e,n,r){var i=this;return(i=fo.call(this,t,e)||this).Ht=n,i.Jt=!!r.Jt,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function bo(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new vo(t,e,n,r,i,o,s)}function Io(t){var e=t;return null===e.Xt&&(t=e.path.Ct(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return t.field.Ct()+t.op.toString()+$i(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return t.field.Ct()+t.dir}).join(","),ai(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=Jo(e.startAt)),e.endAt&&(t+="|ub:",t+=Jo(e.endAt)),e.Xt=t),e.Xt}function Eo(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!Qi(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Zo(t.startAt,e.startAt)&&Zo(t.endAt,e.endAt)}function _o(t){return Ni.qt(t.path)&&null===t.collectionGroup&&0===t.filters.length}var To,Ao=(h(No,To=function(){}),No.create=function(t,e,n){return t.Ot()?"in"===e||"not-in"===e?this.Zt(t,e,n):new xo(t,e,n):"array-contains"===e?new qo(t,n):"in"===e?new Bo(t,n):"not-in"===e?new Go(t,n):"array-contains-any"===e?new zo(t,n):new No(t,e,n)},No.Zt=function(t,e,n){return new("in"===e?ko:Po)(t,n)},No.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this.te(Ji(t,this.value)):null!==t&&Wi(this.value)===Wi(t)&&this.te(Ji(t,this.value))},No.prototype.te=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return _r()}},No.prototype.ee=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},No);function No(t,e,n){var r=this;return(r=To.call(this)||this).field=t,r.op=e,r.value=n,r}var So,Oo,Do,xo=(h(Co,Do=Ao),Co.prototype.matches=function(t){return t=Ni.At(t.key,this.key),this.te(t)},Co),ko=(h(Lo,Oo=Ao),Lo.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Lo),Po=(h(Ro,So=Ao),Ro.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Ro);function Ro(t,e){var n=this;return(n=So.call(this,t,"not-in",e)||this).keys=Uo(0,e),n}function Lo(t,e){var n=this;return(n=Oo.call(this,t,"in",e)||this).keys=Uo(0,e),n}function Co(t,e,n){var r=this;return(r=Do.call(this,t,e,n)||this).key=Ni.$t(n.referenceValue),r}function Uo(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return Ni.$t(t.referenceValue)})}var Vo,Mo,jo,Fo,qo=(h(Yo,Fo=Ao),Yo.prototype.matches=function(t){return eo(t=t.field(this.field))&&Yi(t.arrayValue,this.value)},Yo),Bo=(h(Qo,jo=Ao),Qo.prototype.matches=function(t){return null!==(t=t.field(this.field))&&Yi(this.value.arrayValue,t)},Qo),Go=(h(Wo,Mo=Ao),Wo.prototype.matches=function(t){return!Yi(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&(null!==(t=t.field(this.field))&&!Yi(this.value.arrayValue,t))},Wo),zo=(h(Ko,Vo=Ao),Ko.prototype.matches=function(t){var e=this;return!(!eo(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return Yi(e.value.arrayValue,t)})},Ko),Ho=function(t,e){this.position=t,this.before=e};function Ko(t,e){return Vo.call(this,t,"array-contains-any",e)||this}function Wo(t,e){return Mo.call(this,t,"not-in",e)||this}function Qo(t,e){return jo.call(this,t,"in",e)||this}function Yo(t,e){return Fo.call(this,t,"array-contains",e)||this}function Jo(t){return(t.before?"b":"a")+":"+t.position.map($i).join(",")}var Xo=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function $o(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.Ot()?Ni.At(Ni.$t(s.referenceValue),n.key):Ji(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Zo(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Qi(t.position[n],e.position[n]))return!1;return!0}var ts=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.ne=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.se=null,this.ie=null,this.startAt,this.endAt};function es(t,e,n,r,i,o,s,u){return new ts(t,e,n,r,i,o,s,u)}function ns(t){return new ts(t)}function rs(t){return!ai(t.limit)&&"F"===t.limitType}function is(t){return!ai(t.limit)&&"L"===t.limitType}function os(t){return 0<t.ne.length?t.ne[0].field:null}function ss(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.ee())return r.field}return null}function us(t){return null!==t.collectionGroup}function as(t){var e=t;if(null===e.se){e.se=[];var n=ss(e),t=os(e);if(null!==n&&null===t)n.Ot()||e.se.push(new Xo(n)),e.se.push(new Xo(Ai.kt(),"asc"));else{for(var r=!1,i=0,o=e.ne;i<o.length;i++){var s=o[i];e.se.push(s),s.field.Ot()&&(r=!0)}r||(n=0<e.ne.length?e.ne[e.ne.length-1].dir:"asc",e.se.push(new Xo(Ai.kt(),n)))}}return e.se}function cs(t){var e=t;if(!e.ie)if("F"===e.limitType)e.ie=bo(e.path,e.collectionGroup,as(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=as(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Xo(o.field,s))}var u=e.endAt?new Ho(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Ho(e.startAt.position,!e.startAt.before):null;e.ie=bo(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.ie}function hs(t,e,n){return new ts(t.path,t.collectionGroup,t.ne.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function fs(t,e){return Eo(cs(t),cs(e))&&t.limitType===e.limitType}function ls(t){return Io(cs(t))+"|lt:"+t.limitType}function ps(t){return"Query(target="+(n=(e=cs(t)).path.Ct(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return t.field.Ct()+" "+t.op+" "+$i(t.value)}).join(", ")+"]"),ai(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return t.field.Ct()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Jo(e.startAt)),e.endAt&&(n+=", endAt: "+Jo(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function ds(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.Bt(e.collectionGroup)&&e.path.vt(n):Ni.qt(e.path)?e.path.isEqual(n):e.path.St(n))&&function(t){for(var e=0,n=i.ne;e<n.length;e++){var r=n[e];if(!r.field.Ot()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||$o(t.startAt,as(t),n))&&(!t.endAt||!$o(t.endAt,as(t),n)));var e,n}function ys(u){return function(t,e){for(var n=!1,r=0,i=as(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i;switch(n=t.field.Ot()?Ni.At(e.key,n.key):(r=t.field,i=n,e=e.field(r),r=i.field(r),null!==e&&null!==r?Ji(e,r):_r()),t.dir){case"asc":return n;case"desc":return-1*n;default:return _r()}}(o,t,e);if(0!==s)return s;n=n||o.field.Ot()}return 0}}var vs=(gs.prototype.ce=function(t){return new gs(this.target,this.targetId,this.re,t,this.oe,this.lastLimboFreeSnapshotVersion,this.resumeToken)},gs.prototype.ae=function(t,e){return new gs(this.target,this.targetId,this.re,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},gs.prototype.ue=function(t){return new gs(this.target,this.targetId,this.re,this.sequenceNumber,this.oe,t,this.resumeToken)},gs);function gs(t,e,n,r,i,o,s){void 0===i&&(i=Ei.min()),void 0===o&&(o=Ei.min()),void 0===s&&(s=xr.h),this.target=t,this.targetId=e,this.re=n,this.sequenceNumber=r,this.oe=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function ms(t,e){if(t.he){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ci(e)?"-0":e}}function ws(t){return{integerValue:""+t}}function bs(t,e){return hi(e)?ws(e):ms(t,e)}function Is(t,e){return t instanceof Ls?to(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var Es,_s,Ts=(h(Ss,_s=o=function(){this.le=void 0}),Ss),As=(h(Ns,Es=o),Ns);function Ns(t){var e=this;return(e=Es.call(this)||this).elements=t,e}function Ss(){return null!==_s&&_s.apply(this,arguments)||this}function Os(t,e){for(var n=Vs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return Qi(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var Ds,xs=(h(ks,Ds=o),ks);function ks(t){var e=this;return(e=Ds.call(this)||this).elements=t,e}function Ps(t,e){for(var n=Vs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!Qi(t,e)})}(i[r]);return{arrayValue:{values:n}}}var Rs,Ls=(h(Cs,Rs=o),Cs);function Cs(t,e){var n=this;return(n=Rs.call(this)||this).fe=t,n._e=e,n}function Us(t){return Gi(t.integerValue||t.doubleValue)}function Vs(t){return eo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Ms(t,e){this.version=t,this.transformResults=e}var js=function(t,e){this.field=t,this.transform=e},Fs=(qs.de=function(){return new qs},qs.exists=function(t){return new qs(void 0,t)},qs.updateTime=function(t){return new qs(t)},Object.defineProperty(qs.prototype,"we",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),qs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},qs);function qs(t,e){this.updateTime=t,this.exists=e}function Bs(t,e){return void 0!==t.updateTime?e instanceof lo&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof lo}function Gs(t,e,n,r){return t instanceof Qs?function(t,e,n,r){if(!Bs(t.Ee,e))return e;var i=t.value;return t.fieldTransforms&&(r=tu(t.fieldTransforms,n,e,r),i=eu(t.fieldTransforms,i,r)),e=Hs(e),new lo(t.key,e,i,{Jt:!0})}(t,e,r,n):t instanceof Ys?function(t,e,n,r){if(!Bs(t.Ee,e))return e;var i=Hs(e),r=$s(t,e,tu(t.fieldTransforms,n,e,r));return new lo(t.key,i,r,{Jt:!0})}(t,e,r,n):Bs(t.Ee,e)?new po(t.key,Ei.min()):e}function zs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ee.isEqual(e.Ee)&&(n=t.fieldTransforms,r=e.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&Or(n,r,function(t,e){return t.field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof As&&e instanceof As||t instanceof xs&&e instanceof xs?Or(t.elements,e.elements,Qi):t instanceof Ls&&e instanceof Ls?Qi(t._e,e._e):t instanceof Ts&&e instanceof Ts)})))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.Te.isEqual(e.Te));var n,r}function Hs(t){return t instanceof lo?t.version:Ei.min()}var Ks,Ws,Qs=(h(Xs,Ws=me=function(){}),Xs),Ys=(h(Js,Ks=me),Js);function Js(t,e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=Ks.call(this)||this).key=t,o.data=e,o.Te=n,o.Ee=r,o.fieldTransforms=i,o.type=1,o}function Xs(t,e,n,r){void 0===r&&(r=[]);var i=this;return(i=Ws.call(this)||this).key=t,i.value=e,i.Ee=n,i.fieldTransforms=r,i.type=0,i}function $s(t,e,n){var r,i,o=t;return e=e instanceof lo?e.data():oo.empty(),i=new so(e),o.Te.fields.forEach(function(t){var e;t.bt()||(null!==(e=o.data.field(t))?i.set(t,e):i.delete(t))}),r=i.Gt(),eu(t.fieldTransforms,r,n)}function Zs(t,e,n){var r=[];Tr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof lo&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof As?Os(o,s):o instanceof xs?Ps(o,s):u))}return r}function tu(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],c=a.transform,h=null;n instanceof lo&&(h=n.field(a.field)),null===h&&r instanceof lo&&(h=r.field(a.field)),o.push((i=h,a=e,h=void 0,c instanceof Ts?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(h.fields.__previous_value__=i),{mapValue:h}):c instanceof As?Os(c,i):c instanceof xs?Ps(c,i):(i=Us(c=Is(h=c,i))+Us(h._e),to(c)&&to(h._e)?ws(i):ms(h.fe,i))))}return o}function eu(t,e,n){for(var r=new so(e),i=0;i<t.length;i++){var o=t[i];r.set(o.field,n[i])}return r.Gt()}function nu(t){this.count=t}var ru,iu,ou=(h(du,iu=me),du),su=(h(pu,ru=me),pu),uu=(lu.prototype.Ie=function(t,e){return new lu(this.At,this.root.Ie(t,e,this.At).copy(null,null,cu.me,null,null))},lu.prototype.remove=function(t){return new lu(this.At,this.root.remove(t,this.At).copy(null,null,cu.me,null,null))},lu.prototype.get=function(t){for(var e=this.root;!e.bt();){var n=this.At(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},lu.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.bt();){var r=this.At(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},lu.prototype.bt=function(){return this.root.bt()},Object.defineProperty(lu.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),lu.prototype.Ae=function(){return this.root.Ae()},lu.prototype.Re=function(){return this.root.Re()},lu.prototype.Pe=function(t){return this.root.Pe(t)},lu.prototype.forEach=function(n){this.Pe(function(t,e){return n(t,e),!1})},lu.prototype.toString=function(){var n=[];return this.Pe(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},lu.prototype.ye=function(t){return this.root.ye(t)},lu.prototype.ge=function(){return new au(this.root,null,this.At,!1)},lu.prototype.Ve=function(t){return new au(this.root,t,this.At,!1)},lu.prototype.pe=function(){return new au(this.root,null,this.At,!0)},lu.prototype.be=function(t){return new au(this.root,t,this.At,!0)},lu),au=(fu.prototype.De=function(){var t=this.Se.pop(),e={key:t.key,value:t.value};if(this.ve)for(t=t.left;!t.bt();)this.Se.push(t),t=t.right;else for(t=t.right;!t.bt();)this.Se.push(t),t=t.left;return e},fu.prototype.Ce=function(){return 0<this.Se.length},fu.prototype.xe=function(){if(0===this.Se.length)return null;var t=this.Se[this.Se.length-1];return{key:t.key,value:t.value}},fu),cu=(hu.prototype.copy=function(t,e,n,r,i){return new hu(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},hu.prototype.bt=function(){return!1},hu.prototype.Pe=function(t){return this.left.Pe(t)||t(this.key,this.value)||this.right.Pe(t)},hu.prototype.ye=function(t){return this.right.ye(t)||t(this.key,this.value)||this.left.ye(t)},hu.prototype.min=function(){return this.left.bt()?this:this.left.min()},hu.prototype.Ae=function(){return this.min().key},hu.prototype.Re=function(){return this.right.bt()?this.key:this.right.Re()},hu.prototype.Ie=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Ie(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Ie(t,e,n))).Ne()},hu.prototype.Fe=function(){if(this.left.bt())return hu.EMPTY;var t=this;return t.left.Oe()||t.left.left.Oe()||(t=t.ke()),(t=t.copy(null,null,null,t.left.Fe(),null)).Ne()},hu.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.bt()||r.left.Oe()||r.left.left.Oe()||(r=r.ke()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Oe()&&(r=r.Me()),r.right.bt()||r.right.Oe()||r.right.left.Oe()||(r=r.Le()),0===e(t,r.key)){if(r.right.bt())return hu.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Fe())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Ne()},hu.prototype.Oe=function(){return this.color},hu.prototype.Ne=function(){var t=this;return t.right.Oe()&&!t.left.Oe()&&(t=t.$e()),t.left.Oe()&&t.left.left.Oe()&&(t=t.Me()),t.left.Oe()&&t.right.Oe()&&(t=t.Be()),t},hu.prototype.ke=function(){var t=this.Be();return t.right.left.Oe()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Me())).$e()).Be()),t},hu.prototype.Le=function(){var t=this.Be();return t.left.left.Oe()&&(t=(t=t.Me()).Be()),t},hu.prototype.$e=function(){var t=this.copy(null,null,hu.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},hu.prototype.Me=function(){var t=this.copy(null,null,hu.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},hu.prototype.Be=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},hu.prototype.qe=function(){var t=this.Ue();return Math.pow(2,t)<=this.size+1},hu.prototype.Ue=function(){if(this.Oe()&&this.left.Oe())throw _r();if(this.right.Oe())throw _r();var t=this.left.Ue();if(t!==this.right.Ue())throw _r();return t+(this.Oe()?0:1)},hu);function hu(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:hu.RED,this.left=null!=r?r:hu.EMPTY,this.right=null!=i?i:hu.EMPTY,this.size=this.left.size+1+this.right.size}function fu(t,e,n,r){this.ve=r,this.Se=[];for(var i=1;!t.bt();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.ve?t.left:t.right;else{if(0===i){this.Se.push(t);break}this.Se.push(t),t=this.ve?t.right:t.left}}function lu(t,e){this.At=t,this.root=e||cu.EMPTY}function pu(t,e){var n=this;return(n=ru.call(this)||this).key=t,n.Ee=e,n.type=3,n.fieldTransforms=[],n}function du(t,e){var n=this;return(n=iu.call(this)||this).key=t,n.Ee=e,n.type=2,n.fieldTransforms=[],n}function yu(){this.size=0}cu.EMPTY=null,cu.RED=!0,cu.me=!1,cu.EMPTY=(Object.defineProperty(yu.prototype,"key",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(yu.prototype,"value",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(yu.prototype,"color",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(yu.prototype,"left",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(yu.prototype,"right",{get:function(){throw _r()},enumerable:!1,configurable:!0}),yu.prototype.copy=function(t,e,n,r,i){return this},yu.prototype.Ie=function(t,e,n){return new cu(t,e)},yu.prototype.remove=function(t,e){return this},yu.prototype.bt=function(){return!0},yu.prototype.Pe=function(t){return!1},yu.prototype.ye=function(t){return!1},yu.prototype.Ae=function(){return null},yu.prototype.Re=function(){return null},yu.prototype.Oe=function(){return!1},yu.prototype.qe=function(){return!0},yu.prototype.Ue=function(){return 0},new yu);var vu=(bu.prototype.has=function(t){return null!==this.data.get(t)},bu.prototype.first=function(){return this.data.Ae()},bu.prototype.last=function(){return this.data.Re()},Object.defineProperty(bu.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),bu.prototype.indexOf=function(t){return this.data.indexOf(t)},bu.prototype.forEach=function(n){this.data.Pe(function(t,e){return n(t),!1})},bu.prototype.Qe=function(t,e){for(var n=this.data.Ve(t[0]);n.Ce();){var r=n.De();if(0<=this.At(r.key,t[1]))return;e(r.key)}},bu.prototype.Ke=function(t,e){for(var n=void 0!==e?this.data.Ve(e):this.data.ge();n.Ce();)if(!t(n.De().key))return},bu.prototype.We=function(t){return(t=this.data.Ve(t)).Ce()?t.De().key:null},bu.prototype.ge=function(){return new gu(this.data.ge())},bu.prototype.Ve=function(t){return new gu(this.data.Ve(t))},bu.prototype.add=function(t){return this.copy(this.data.remove(t).Ie(t,!0))},bu.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},bu.prototype.bt=function(){return this.data.bt()},bu.prototype.je=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},bu.prototype.isEqual=function(t){if(!(t instanceof bu))return!1;if(this.size!==t.size)return!1;for(var e=this.data.ge(),n=t.data.ge();e.Ce();){var r=e.De().key,i=n.De().key;if(0!==this.At(r,i))return!1}return!0},bu.prototype.Dt=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},bu.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},bu.prototype.copy=function(t){var e=new bu(this.At);return e.data=t,e},bu),gu=(wu.prototype.De=function(){return this.Ge.De().key},wu.prototype.Ce=function(){return this.Ge.Ce()},wu),mu=new uu(Ni.At);function wu(t){this.Ge=t}function bu(t){this.At=t,this.data=new uu(this.At)}var Iu=new uu(Ni.At),Eu=new uu(Ni.At),_u=new vu(Ni.At);function Tu(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=_u,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Au=new vu(Sr),Nu=(Bu.Je=function(t){return new Bu(t.At)},Bu.prototype.has=function(t){return null!=this.ze.get(t)},Bu.prototype.get=function(t){return this.ze.get(t)},Bu.prototype.first=function(){return this.He.Ae()},Bu.prototype.last=function(){return this.He.Re()},Bu.prototype.bt=function(){return this.He.bt()},Bu.prototype.indexOf=function(t){return(t=this.ze.get(t))?this.He.indexOf(t):-1},Object.defineProperty(Bu.prototype,"size",{get:function(){return this.He.size},enumerable:!1,configurable:!0}),Bu.prototype.forEach=function(n){this.He.Pe(function(t,e){return n(t),!1})},Bu.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.ze.Ie(t.key,t),e.He.Ie(t,null))},Bu.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.ze.remove(t),this.He.remove(e)):this},Bu.prototype.isEqual=function(t){if(!(t instanceof Bu))return!1;if(this.size!==t.size)return!1;for(var e=this.He.ge(),n=t.He.ge();e.Ce();){var r=e.De().key,i=n.De().key;if(!r.isEqual(i))return!1}return!0},Bu.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Bu.prototype.copy=function(t,e){var n=new Bu;return n.At=this.At,n.ze=t,n.He=e,n},Bu),Su=(qu.prototype.track=function(t){var e=t.doc.key,n=this.Ye.get(e);!n||0!==t.type&&3===n.type?this.Ye=this.Ye.Ie(e,t):3===t.type&&1!==n.type?this.Ye=this.Ye.Ie(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Ye=this.Ye.Ie(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Ye=this.Ye.Ie(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Ye=this.Ye.remove(e):1===t.type&&2===n.type?this.Ye=this.Ye.Ie(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Ye=this.Ye.Ie(e,{type:2,doc:t.doc}):_r()},qu.prototype.Xe=function(){var n=[];return this.Ye.Pe(function(t,e){n.push(e)}),n},qu),Ou=(Fu.sn=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Fu(t,e,Nu.Je(e),i,n,r,!0,!1)},Object.defineProperty(Fu.prototype,"hasPendingWrites",{get:function(){return!this.tn.bt()},enumerable:!1,configurable:!0}),Fu.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.en===t.en&&this.tn.isEqual(t.tn)&&fs(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ze.isEqual(t.Ze)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Fu),Du=(ju.un=function(t,e){var n=new Map;return n.set(t,xu.hn(t,e)),new ju(Ei.min(),n,Au,mu,Tu())},ju),xu=(Mu.hn=function(t,e){return new Mu(xr.h,e,Tu(),Tu(),Tu())},Mu),ku=function(t,e,n,r){this.wn=t,this.removedTargetIds=e,this.key=n,this.En=r},Pu=function(t,e){this.targetId=t,this.Tn=e},Ru=function(t,e,n,r){void 0===n&&(n=xr.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Lu=(Object.defineProperty(Vu.prototype,"ln",{get:function(){return this.Rn},enumerable:!1,configurable:!0}),Object.defineProperty(Vu.prototype,"resumeToken",{get:function(){return this.An},enumerable:!1,configurable:!0}),Object.defineProperty(Vu.prototype,"yn",{get:function(){return 0!==this.In},enumerable:!1,configurable:!0}),Object.defineProperty(Vu.prototype,"gn",{get:function(){return this.Pn},enumerable:!1,configurable:!0}),Vu.prototype.Vn=function(t){0<t.o()&&(this.Pn=!0,this.An=t)},Vu.prototype.pn=function(){var n=Tu(),r=Tu(),i=Tu();return this.mn.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:_r()}}),new xu(this.An,this.Rn,n,r,i)},Vu.prototype.bn=function(){this.Pn=!1,this.mn=zu()},Vu.prototype.vn=function(t,e){this.Pn=!0,this.mn=this.mn.Ie(t,e)},Vu.prototype.Sn=function(t){this.Pn=!0,this.mn=this.mn.remove(t)},Vu.prototype.Dn=function(){this.In+=1},Vu.prototype.Cn=function(){--this.In},Vu.prototype.xn=function(){this.Pn=!0,this.Rn=!0},Vu),Cu=(Uu.prototype.Ln=function(t){for(var e=0,n=t.wn;e<n.length;e++){var r=n[e];t.En instanceof lo?this.$n(r,t.En):t.En instanceof po&&this.Bn(r,t.key,t.En)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.Bn(r,t.key,t.En)},Uu.prototype.qn=function(n){var r=this;this.Un(n,function(t){var e=r.Qn(t);switch(n.state){case 0:r.Kn(t)&&e.Vn(n.resumeToken);break;case 1:e.Cn(),e.yn||e.bn(),e.Vn(n.resumeToken);break;case 2:e.Cn(),e.yn||r.removeTarget(t);break;case 3:r.Kn(t)&&(e.xn(),e.Vn(n.resumeToken));break;case 4:r.Kn(t)&&(r.Wn(t),e.Vn(n.resumeToken));break;default:_r()}})},Uu.prototype.Un=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Fn.forEach(function(t,e){r.Kn(e)&&n(e)})},Uu.prototype.jn=function(t){var e=t.targetId,n=t.Tn.count;(t=this.Gn(e))&&(_o(t=t.target)?0===n?(t=new Ni(t.path),this.Bn(e,t,new po(t,Ei.min()))):Tr(1===n):this.zn(e)!==n&&(this.Wn(e),this.Mn=this.Mn.add(e)))},Uu.prototype.Hn=function(r){var i=this,o=new Map;this.Fn.forEach(function(t,e){var n=i.Gn(e);n&&(t.ln&&_o(n.target)&&(n=new Ni(n.target.path),null!==i.On.get(n)||i.Jn(e,n)||i.Bn(e,n,new po(n,r))),t.gn&&(o.set(e,t.pn()),t.bn()))});var s=Tu();this.kn.forEach(function(t,e){var n=!0;e.Ke(function(t){return!(t=i.Gn(t))||2===t.re||(n=!1)}),n&&(s=s.add(t))});var t=new Du(r,o,this.Mn,this.On,s);return this.On=mu,this.kn=Gu(),this.Mn=new vu(Sr),t},Uu.prototype.$n=function(t,e){var n;this.Kn(t)&&(n=this.Jn(t,e.key)?2:0,this.Qn(t).vn(e.key,n),this.On=this.On.Ie(e.key,e),this.kn=this.kn.Ie(e.key,this.Yn(e.key).add(t)))},Uu.prototype.Bn=function(t,e,n){var r;this.Kn(t)&&(r=this.Qn(t),this.Jn(t,e)?r.vn(e,1):r.Sn(e),this.kn=this.kn.Ie(e,this.Yn(e).delete(t)),n&&(this.On=this.On.Ie(e,n)))},Uu.prototype.removeTarget=function(t){this.Fn.delete(t)},Uu.prototype.zn=function(t){var e=this.Qn(t).pn();return this.Nn.Xn(t).size+e._n.size-e.dn.size},Uu.prototype.Dn=function(t){this.Qn(t).Dn()},Uu.prototype.Qn=function(t){var e=this.Fn.get(t);return e||(e=new Lu,this.Fn.set(t,e)),e},Uu.prototype.Yn=function(t){var e=this.kn.get(t);return e||(e=new vu(Sr),this.kn=this.kn.Ie(t,e)),e},Uu.prototype.Kn=function(t){var e=null!==this.Gn(t);return e||wr("WatchChangeAggregator","Detected inactive target",t),e},Uu.prototype.Gn=function(t){var e=this.Fn.get(t);return e&&e.yn?null:this.Nn.Zn(t)},Uu.prototype.Wn=function(e){var n=this;this.Fn.set(e,new Lu),this.Nn.Xn(e).forEach(function(t){n.Bn(e,t,null)})},Uu.prototype.Jn=function(t,e){return this.Nn.Xn(t).has(e)},Uu);function Uu(t){this.Nn=t,this.Fn=new Map,this.On=mu,this.kn=Gu(),this.Mn=new vu(Sr)}function Vu(){this.In=0,this.mn=zu(),this.An=xr.h,this.Rn=!1,this.Pn=!0}function Mu(t,e,n,r,i){this.resumeToken=t,this.ln=e,this._n=n,this.fn=r,this.dn=i}function ju(t,e,n,r,i){this.oe=t,this.rn=e,this.on=n,this.cn=r,this.an=i}function Fu(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Ze=n,this.docChanges=r,this.tn=i,this.fromCache=o,this.en=s,this.nn=u}function qu(){this.Ye=new uu(Ni.At)}function Bu(n){this.At=n?function(t,e){return n(t,e)||Ni.At(t.key,e.key)}:function(t,e){return Ni.At(t.key,e.key)},this.ze=Iu,this.He=new uu(this.At)}function Gu(){return new uu(Ni.At)}function zu(){return new uu(Ni.At)}var Hu={asc:"ASCENDING",desc:"DESCENDING"},Ku={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Wu=function(t,e){this.O=t,this.he=e};function Qu(t,e){return t.he?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Yu(t,e){return t.he?e.toBase64():e.toUint8Array()}function Ju(t){return Tr(!!t),Ei.wt((t=Bi(t),new Ii(t.seconds,t.nanos)))}function Xu(t,e){return new _i(["projects",t.projectId,"databases",t.database]).child("documents").child(e).Ct()}function $u(t){return Tr(va(t=_i.xt(t))),t}function Zu(t,e){return Xu(t.O,e.path)}function ta(t,e){if((e=$u(e)).get(1)!==t.O.projectId)throw new Lr(Rr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.O.projectId);if(e.get(3)!==t.O.database)throw new Lr(Rr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.O.database);return new Ni(ia(e))}function ea(t,e){return Xu(t.O,e)}function na(t){return 4===(t=$u(t)).length?_i.Nt():ia(t)}function ra(t){return new _i(["projects",t.O.projectId,"databases",t.O.database]).Ct()}function ia(t){return Tr(4<t.length&&"documents"===t.get(4)),t.Pt(5)}function oa(t,e,n){return{name:Zu(t,e),fields:n.proto.mapValue.fields}}function sa(t,e,n){var r=ta(t,e.name),t=Ju(e.updateTime),e=new oo({mapValue:{fields:e.fields}});return new lo(r,t,e,{hasCommittedMutations:!!n})}function ua(t,e){var n,r,i;if(e instanceof Qs)n={update:oa(t,e.key,e.value)};else if(e instanceof ou)n={delete:Zu(t,e.key)};else if(e instanceof Ys)n={update:oa(t,e.key,e.data),updateMask:(i=e.Te,r=[],i.fields.forEach(function(t){return r.push(t.Ct())}),{fieldPaths:r})};else{if(!(e instanceof su))return _r();n={verify:Zu(t,e.key)}}return 0<e.fieldTransforms.length&&(n.updateTransforms=e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Ts)return{fieldPath:t.field.Ct(),setToServerValue:"REQUEST_TIME"};if(e instanceof As)return{fieldPath:t.field.Ct(),appendMissingElements:{values:e.elements}};if(e instanceof xs)return{fieldPath:t.field.Ct(),removeAllFromArray:{values:e.elements}};if(e instanceof Ls)return{fieldPath:t.field.Ct(),increment:e._e};throw _r()})),e.Ee.we||(n.currentDocument=void 0!==(i=e.Ee).updateTime?{updateTime:Qu(e=t,(t=i.updateTime).Tt())}:void 0!==i.exists?{exists:i.exists}:_r()),n}function aa(i,t){var e=t.currentDocument?void 0!==(s=t.currentDocument).updateTime?Fs.updateTime(Ju(s.updateTime)):void 0!==s.exists?Fs.exists(s.exists):Fs.de():Fs.de(),n=t.updateTransforms?t.updateTransforms.map(function(t){return e=i,r=null,"setToServerValue"in(t=t)?(Tr("REQUEST_TIME"===t.setToServerValue),r=new Ts):"appendMissingElements"in t?(n=t.appendMissingElements.values||[],r=new As(n)):"removeAllFromArray"in t?(n=t.removeAllFromArray.values||[],r=new xs(n)):"increment"in t?r=new Ls(e,t.increment):_r(),t=Ai.Mt(t.fieldPath),new js(t,r);var e,n,r}):[];if(t.update){t.update.name;var r=ta(i,t.update.name),o=new oo({mapValue:{fields:t.update.fields}});if(t.updateMask){var s=(s=t.updateMask.fieldPaths||[],new ji(s.map(function(t){return Ai.Mt(t)})));return new Ys(r,o,s,e,n)}return new Qs(r,o,e,n)}return t.delete?(n=ta(i,t.delete),new ou(n,e)):t.verify?(t=ta(i,t.verify),new su(t,e)):_r()}function ca(t,e){return{documents:[ea(t,e.path)]}}function ha(t,e){var n={structuredQuery:{}},r=e.path;return null!==e.collectionGroup?(n.parent=ea(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=ea(t,r.yt()),n.structuredQuery.from=[{collectionId:r.Vt()}]),(r=function(t){if(0!==t.length)return 1===(t=t.map(function(t){if("=="===t.op){if(ro(t.value))return{unaryFilter:{field:da(t.field),op:"IS_NAN"}};if(no(t.value))return{unaryFilter:{field:da(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(ro(t.value))return{unaryFilter:{field:da(t.field),op:"IS_NOT_NAN"}};if(no(t.value))return{unaryFilter:{field:da(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:da(t.field),op:(e=t.op,Ku[e]),value:t.value}};var e})).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(e.filters))&&(n.structuredQuery.where=r),(r=function(t){if(0!==t.length)return t.map(function(t){return{field:da(t.field),direction:(t=t.dir,Hu[t])}})}(e.orderBy))&&(n.structuredQuery.orderBy=r),r=e.limit,null!==(r=t.he||ai(r)?r:{value:r})&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=la(e.startAt)),e.endAt&&(n.structuredQuery.endAt=la(e.endAt)),n}function fa(t){var e=na(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Tr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=ya(t.unaryFilter.field);return Ao.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=ya(t.unaryFilter.field);return Ao.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":return n=ya(t.unaryFilter.field),Ao.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":return t=ya(t.unaryFilter.field),Ao.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return _r()}}(e)]:void 0!==e.fieldFilter?[(n=e,Ao.create(ya(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return _r()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):_r():[];var n}(n.where)),t=[],n.orderBy&&(t=n.orderBy.map(function(t){return new Xo(ya((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e})),r=null,n.limit&&(r=ai(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=pa(n.startAt));var u=null;return n.endAt&&(u=pa(n.endAt)),es(e,i,t,o,r,"F",s,u)}function la(t){return{before:t.before,values:t.position}}function pa(t){var e=!!t.before,t=t.values||[];return new Ho(t,e)}function da(t){return{fieldPath:t.Ct()}}function ya(t){return Ai.Mt(t.fieldPath)}function va(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function ga(t){return new Wu(t,!0)}var ma,wa=(Oa.prototype.catch=function(t){return this.next(void 0,t)},Oa.prototype.next=function(r,i){var o=this;return this.ss&&_r(),this.ss=!0,this.ns?this.error?this.rs(i,this.error):this.os(r,this.result):new Oa(function(e,n){o.ts=function(t){o.os(r,t).next(e,n)},o.es=function(t){o.rs(i,t).next(e,n)}})},Oa.prototype.cs=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Oa.prototype.us=function(t){try{var e=t();return e instanceof Oa?e:Oa.resolve(e)}catch(t){return Oa.reject(t)}},Oa.prototype.os=function(t,e){return t?this.us(function(){return t(e)}):Oa.resolve(e)},Oa.prototype.rs=function(t,e){return t?this.us(function(){return t(e)}):Oa.reject(e)},Oa.resolve=function(n){return new Oa(function(t,e){t(n)})},Oa.reject=function(n){return new Oa(function(t,e){e(n)})},Oa.hs=function(t){return new Oa(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Oa.ls=function(t){for(var n=Oa.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Oa.resolve(t):e()})}(r[e]);return n},Oa.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.hs(i)},Oa),ba=(Sa.open=function(t,e,n,r){try{return new Sa(e,t.transaction(r,n))}catch(t){throw new _a(e,t)}},Object.defineProperty(Sa.prototype,"fs",{get:function(){return this._s.promise},enumerable:!1,configurable:!0}),Sa.prototype.abort=function(t){t&&this._s.reject(t),this.aborted||(wr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Sa.prototype.store=function(t){return t=this.transaction.objectStore(t),new xa(t)},Sa),Ia=(Na.delete=function(t){return wr("SimpleDb","Removing database:",t),Pa(window.indexedDB.deleteDatabase(t)).cs()},Na.G=function(){if("undefined"==typeof indexedDB)return!1;if(Na.Es())return!0;var t=p(),e=0<(n=Na.ws(t))&&n<10,n=0<(n=Na.Ts(t))&&n<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||e||n)},Na.Es=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Is)},Na.As=function(t,e){return t.store(e)},Na.ws=function(t){return t=(t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i))?t[1].split("_").slice(0,2).join("."):"-1",Number(t)},Na.Ts=function(t){return t=(t=t.match(/Android ([\d.]+)/i))?t[1].split(".").slice(0,2).join("."):"-1",Number(t)},Na.prototype.Rs=function(o){return y(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(wr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(t){t=t.target.result,e(t)},r.onblocked=function(){n(new _a(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){"VersionError"===(t=t.target.error).name?n(new Lr(Rr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new _a(o,t))},r.onupgradeneeded=function(t){wr("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;i.ds.Ps(e,r.transaction,t.oldVersion,i.version).next(function(){wr("SimpleDb","Database upgrade to version "+i.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.ys&&(this.db.onversionchange=function(t){return i.ys(t)}),this.db)]}})})},Na.prototype.gs=function(e){this.ys=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},Na.prototype.runTransaction=function(u,n,a,c){return y(this,void 0,void 0,function(){var i,o,s,e;return v(this,function(t){switch(t.label){case 0:i="readonly"===n,o=0,e=function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.Rs(u)];case 2:return s.db=t.sent(),e=ba.open(s.db,u,i?"readonly":"readwrite",a),n=c(e).catch(function(t){return e.abort(t),wa.reject(t)}).cs(),r={},n.catch(function(){}),[4,e.fs];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return n=t.sent(),r="FirebaseError"!==n.name&&o<3,wr("SimpleDb","Transaction failed with error:",n.message,"Retrying:",r),s.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},s=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(e=t.sent()))return[2,e.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},Na.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},Na),Ea=(Object.defineProperty(Aa.prototype,"ns",{get:function(){return this.ps},enumerable:!1,configurable:!0}),Object.defineProperty(Aa.prototype,"vs",{get:function(){return this.bs},enumerable:!1,configurable:!0}),Object.defineProperty(Aa.prototype,"cursor",{set:function(t){this.Vs=t},enumerable:!1,configurable:!0}),Aa.prototype.done=function(){this.ps=!0},Aa.prototype.Ss=function(t){this.bs=t},Aa.prototype.delete=function(){return Pa(this.Vs.delete())},Aa),_a=(h(Ta,ma=Lr),Ta);function Ta(t,e){var n=this;return(n=ma.call(this,Rr.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function Aa(t){this.Vs=t,this.ps=!1,this.bs=null}function Na(t,e,n){this.name=t,this.version=e,this.ds=n,12.2===Na.ws(p())&&br("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function Sa(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this._s=new wi,this.transaction.oncomplete=function(){n._s.resolve()},this.transaction.onabort=function(){t.error?n._s.reject(new _a(e,t.error)):n._s.resolve()},this.transaction.onerror=function(t){t=La(t.target.error),n._s.reject(new _a(e,t))}}function Oa(t){var e=this;this.ts=null,this.es=null,this.result=void 0,this.error=void 0,this.ns=!1,this.ss=!1,t(function(t){e.ns=!0,e.result=t,e.ts&&e.ts(t)},function(t){e.ns=!0,e.error=t,e.es&&e.es(t)})}function Da(t){return"IndexedDbTransactionError"===t.name}var xa=(ka.prototype.put=function(t,e){return Pa(t=void 0!==e?(wr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(wr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},ka.prototype.add=function(t){return wr("SimpleDb","ADD",this.store.name,t,t),Pa(this.store.add(t))},ka.prototype.get=function(e){var n=this;return Pa(this.store.get(e)).next(function(t){return void 0===t&&(t=null),wr("SimpleDb","GET",n.store.name,e,t),t})},ka.prototype.delete=function(t){return wr("SimpleDb","DELETE",this.store.name,t),Pa(this.store.delete(t))},ka.prototype.count=function(){return wr("SimpleDb","COUNT",this.store.name),Pa(this.store.count())},ka.prototype.Ds=function(t,e){var e=this.cursor(this.options(t,e)),n=[];return this.Cs(e,function(t,e){n.push(e)}).next(function(){return n})},ka.prototype.xs=function(t,e){return wr("SimpleDb","DELETE ALL",this.store.name),(e=this.options(t,e)).Ns=!1,e=this.cursor(e),this.Cs(e,function(t,e,n){return n.delete()})},ka.prototype.Fs=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.Cs(n,e)},ka.prototype.Os=function(r){var t=this.cursor({});return new wa(function(n,e){t.onerror=function(t){t=La(t.target.error),e(t)},t.onsuccess=function(t){var e=t.target.result;e?r(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},ka.prototype.Cs=function(t,i){var o=[];return new wa(function(r,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n=t.target.result;n?(e=new Ea(n),(t=i(n.primaryKey,n.value,e))instanceof wa&&(t=t.catch(function(t){return e.done(),wa.reject(t)}),o.push(t)),e.ns?r():null===e.vs?n.continue():n.continue(e.vs)):r()}}).next(function(){return wa.hs(o)})},ka.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},ka.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.Ns?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},ka);function ka(t){this.store=t}function Pa(t){return new wa(function(e,n){t.onsuccess=function(t){t=t.target.result,e(t)},t.onerror=function(t){t=La(t.target.error),n(t)}})}var Ra=!1;function La(t){var e=Ia.ws(p());if(12.2<=e&&e<13&&(e="An internal error was encountered in the Indexed Database server",0<=t.message.indexOf(e))){var n=new Lr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Ra||(Ra=!0,setTimeout(function(){throw n},0)),n}return t}var Ca=(Ua.qs=function(t,e,n,r,i){return(i=new Ua(t,e,Date.now()+n,r,i)).start(n),i},Ua.prototype.start=function(t){var e=this;this.Us=setTimeout(function(){return e.Qs()},t)},Ua.prototype.Ks=function(){return this.Qs()},Ua.prototype.cancel=function(t){null!==this.Us&&(this.clearTimeout(),this.Bs.reject(new Lr(Rr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Ua.prototype.Qs=function(){var e=this;this.ks.Ws(function(){return null!==e.Us?(e.clearTimeout(),e.op().then(function(t){return e.Bs.resolve(t)})):Promise.resolve()})},Ua.prototype.clearTimeout=function(){null!==this.Us&&(this.$s(this),clearTimeout(this.Us),this.Us=null)},Ua);function Ua(t,e,n,r,i){this.ks=t,this.Ms=e,this.Ls=n,this.op=r,this.$s=i,this.Bs=new wi,this.then=this.Bs.promise.then.bind(this.Bs.promise),this.Bs.promise.catch(function(t){})}function Va(t,e){if(br("AsyncQueue",e+": "+t),Da(t))return new Lr(Rr.UNAVAILABLE,e+": "+t);throw t}var Ma,ja,Fa,qa=(tc.prototype.reset=function(){this.Js=0},tc.prototype.Zs=function(){this.Js=this.Hs},tc.prototype.ti=function(t){var e=this;this.cancel();var n=Math.floor(this.Js+this.ei()),r=Math.max(0,Date.now()-this.Xs),i=Math.max(0,n-r);0<i&&wr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Js+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ys=this.js.ni(this.Ms,i,function(){return e.Xs=Date.now(),t()}),this.Js*=this.zs,this.Js<this.Gs&&(this.Js=this.Gs),this.Js>this.Hs&&(this.Js=this.Hs)},tc.prototype.si=function(){null!==this.Ys&&(this.Ys.Ks(),this.Ys=null)},tc.prototype.cancel=function(){null!==this.Ys&&(this.Ys.cancel(),this.Ys=null)},tc.prototype.ei=function(){return(Math.random()-.5)*this.Js},tc),o=(Za.prototype.hi=function(){return 1===this.state||2===this.state||4===this.state},Za.prototype.li=function(){return 2===this.state},Za.prototype.start=function(){3!==this.state?this.auth():this._i()},Za.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.hi()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Za.prototype.fi=function(){this.state=0,this.ui.reset()},Za.prototype.di=function(){var t=this;this.li()&&null===this.ai&&(this.ai=this.js.ni(this.ii,6e4,function(){return t.wi()}))},Za.prototype.Ei=function(t){this.Ti(),this.stream.send(t)},Za.prototype.wi=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.li()?[2,this.close(0)]:[2]})})},Za.prototype.Ti=function(){this.ai&&(this.ai.cancel(),this.ai=null)},Za.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Ti(),this.ui.cancel(),this.ci++,3!==e?this.ui.reset():n&&n.code===Rr.RESOURCE_EXHAUSTED?(br(n.toString()),br("Using maximum backoff delay to prevent overloading the backend."),this.ui.Zs()):n&&n.code===Rr.UNAUTHENTICATED&&this.oi.g(),null!==this.stream&&(this.Ii(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Z(n)];case 1:return t.sent(),[2]}})})},Za.prototype.Ii=function(){},Za.prototype.auth=function(){var n=this;this.state=1;var t=this.mi(this.ci),e=this.ci;this.oi.getToken().then(function(t){n.ci===e&&n.Ai(t)},function(e){t(function(){var t=new Lr(Rr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Ri(t)})})},Za.prototype.Ai=function(t){var e=this,n=this.mi(this.ci);this.stream=this.Pi(t),this.stream.Y(function(){n(function(){return e.state=2,e.listener.Y()})}),this.stream.Z(function(t){n(function(){return e.Ri(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Za.prototype._i=function(){var t=this;this.state=4,this.ui.ti(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},Za.prototype.Ri=function(t){return wr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Za.prototype.mi=function(e){var n=this;return function(t){n.js.Ws(function(){return n.ci===e?t():(wr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Za),Ba=(h($a,Fa=o),$a.prototype.Pi=function(t){return this.ri.ft("Listen",t)},$a.prototype.onMessage=function(t){this.ui.reset();var e,n=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:_r(),r=e.targetChange.targetIds||[],i=(s=e.targetChange.resumeToken,t.he?(Tr(void 0===s||"string"==typeof s),xr.fromBase64String(s||"")):(Tr(void 0===s||s instanceof Uint8Array),xr.fromUint8Array(s||new Uint8Array))),o=(u=e.targetChange.cause)&&(a=void 0===(c=u).code?Rr.UNKNOWN:di(c.code),new Lr(a,c.message||"")),s=new Ru(n,r,i,o||null)}else if("documentChange"in e){e.documentChange,(n=e.documentChange).document,n.document.name,n.document.updateTime,r=ta(t,n.document.name),i=Ju(n.document.updateTime);var u=new oo({mapValue:{fields:n.document.fields}}),a=(o=new lo(r,i,u,{}),n.targetIds||[]),c=n.removedTargetIds||[],s=new ku(a,c,o.key,o)}else if("documentDelete"in e)e.documentDelete,(n=e.documentDelete).document,r=ta(t,n.document),i=n.readTime?Ju(n.readTime):Ei.min(),u=new po(r,i),o=n.removedTargetIds||[],s=new ku([],o,u.key,u);else if("documentRemove"in e)e.documentRemove,(n=e.documentRemove).document,r=ta(t,n.document),i=n.removedTargetIds||[],s=new ku([],i,r,null);else{if(!("filter"in e))return _r();e.filter,(e=e.filter).targetId,r=new nu(n=e.count||0),i=e.targetId,s=new Pu(i,r)}return s}(this.fe,t),t=!("targetChange"in(e=t))||(e=e.targetChange).targetIds&&e.targetIds.length||!e.readTime?Ei.min():Ju(e.readTime);return this.listener.yi(n,t)},$a.prototype.gi=function(t){var e,n,r,i,o={};o.database=ra(this.fe),o.addTarget=(e=this.fe,(r=_o(r=(n=t).target)?{documents:ca(e,r)}:{query:ha(e,r)}).targetId=n.targetId,0<n.resumeToken.o()?r.resumeToken=Yu(e,n.resumeToken):0<n.oe.u(Ei.min())&&(r.readTime=Qu(e,n.oe.Tt())),r),(t=(this.fe,i=t,null==(t=function(){switch(i.re){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return _r()}}())?null:{"goog-listen-tags":t}))&&(o.labels=t),this.Ei(o)},$a.prototype.Vi=function(t){var e={};e.database=ra(this.fe),e.removeTarget=t,this.Ei(e)},$a),Ga=(h(Xa,ja=o),Object.defineProperty(Xa.prototype,"bi",{get:function(){return this.pi},enumerable:!1,configurable:!0}),Xa.prototype.start=function(){this.pi=!1,this.lastStreamToken=void 0,ja.prototype.start.call(this)},Xa.prototype.Ii=function(){this.pi&&this.vi([])},Xa.prototype.Pi=function(t){return this.ri.ft("Write",t)},Xa.prototype.onMessage=function(t){if(Tr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.pi){this.ui.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Tr(void 0!==r),n.map(function(t){return n=r,(t=(e=t).updateTime?Ju(e.updateTime):Ju(n)).isEqual(Ei.min())&&(t=Ju(n)),n=null,e.transformResults&&0<e.transformResults.length&&(n=e.transformResults),new Ms(t,n);var e,n})):[]),n=Ju(t.commitTime);return this.listener.Si(n,e)}var r;return Tr(!t.writeResults||0===t.writeResults.length),this.pi=!0,this.listener.Di()},Xa.prototype.Ci=function(){var t={};t.database=ra(this.fe),this.Ei(t)},Xa.prototype.vi=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return ua(e.fe,t)})};this.Ei(t)},Xa),za=(h(Ja,Ma=function(){}),Ja.prototype.Ni=function(){if(this.xi)throw new Lr(Rr.FAILED_PRECONDITION,"The client has already been terminated.")},Ja.prototype.at=function(e,n,r){var i=this;return this.Ni(),this.credentials.getToken().then(function(t){return i.ri.at(e,n,r,t)}).catch(function(t){throw t.code===Rr.UNAUTHENTICATED&&i.credentials.g(),t})},Ja.prototype._t=function(e,n,r){var i=this;return this.Ni(),this.credentials.getToken().then(function(t){return i.ri._t(e,n,r,t)}).catch(function(t){throw t.code===Rr.UNAUTHENTICATED&&i.credentials.g(),t})},Ja.prototype.terminate=function(){this.xi=!1},Ja),Ha="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",me=(Ya.prototype.Oi=function(t){this.Fi.push(t)},Ya.prototype.ki=function(){this.Fi.forEach(function(t){return t()})},Ya),Ka={Mi:!1,Li:0,$i:0,Bi:0},Wa=(Qa.Ki=function(t){return new Qa(t,Qa.Wi,Qa.ji)},Qa);function Qa(t,e,n){this.qi=t,this.Ui=e,this.Qi=n}function Ya(){this.Fi=[]}function Ja(t,e,n){var r=this;return(r=Ma.call(this)||this).credentials=t,r.ri=e,r.fe=n,r.xi=!1,r}function Xa(t,e,n,r,i){var o=this;return(o=ja.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).fe=r,o.pi=!1,o}function $a(t,e,n,r,i){var o=this;return(o=Fa.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).fe=r,o}function Za(t,e,n,r,i,o){this.js=t,this.ii=n,this.ri=r,this.oi=i,this.listener=o,this.state=0,this.ci=0,this.ai=null,this.stream=null,this.ui=new qa(t,e)}function tc(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.js=t,this.Ms=e,this.Gs=n,this.zs=r,this.Hs=i,this.Js=0,this.Ys=null,this.Xs=Date.now(),this.reset()}Wa.Wi=10,Wa.ji=1e3,Wa.Gi=new Wa(41943040,Wa.Wi,Wa.ji),Wa.zi=new Wa(-1,0,0);var ec=(nc.prototype.Ji=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},nc.prototype.next=function(){var t=++this.previousValue;return this.Yi&&this.Yi(t),t},nc);function nc(t,e){var n=this;this.previousValue=t,e&&(e.Hi=function(t){return n.Ji(t)},this.Yi=function(t){return e.Xi(t)})}function rc(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Rr.FAILED_PRECONDITION||e.message!==Ha)throw e;return wr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function ic(t,e){this.progress=t,this.tr=e}ec.Zi=-1;var oc=(fc.prototype.nr=function(t,e,n){for(var r,i,o,s,u,a,c=n.sr,h=0;h<this.mutations.length;h++){var f=this.mutations[h];f.key.isEqual(t)&&(r=f,u=e,i=c[h],f=a=void 0,e=r instanceof Qs?(a=i,f=(o=r).value,a.transformResults&&(s=Zs(o.fieldTransforms,u,a.transformResults),f=eu(o.fieldTransforms,f,s)),new lo(o.key,a.version,f,{hasCommittedMutations:!0})):r instanceof Ys?(a=u,f=i,Bs((u=r).Ee,a)?(a=$s(u,a,f.transformResults?Zs(u.fieldTransforms,a,f.transformResults):[]),new lo(u.key,f.version,a,{hasCommittedMutations:!0})):new yo(u.key,f.version)):new po(r.key,i.version,{hasCommittedMutations:!0}))}return e},fc.prototype.ir=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Gs(i,e,e,this.er))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Gs(a,e,o,this.er))}return e},fc.prototype.rr=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.ir(t.key,n.get(t.key));e&&(i=i.Ie(t.key,e))}),i},fc.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Tu())},fc.prototype.isEqual=function(t){return this.batchId===t.batchId&&Or(this.mutations,t.mutations,zs)&&Or(this.baseMutations,t.baseMutations,zs)},fc),sc=(hc.from=function(t,e,n){Tr(t.mutations.length===n.length);for(var r=Eu,i=t.mutations,o=0;o<i.length;o++)r=r.Ie(i[o].key,n[o].version);return new hc(t,e,n,r)},hc),uc=(cc.prototype.get=function(t){var e=this.ur(t);if(void 0!==(e=this.lr[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.hr(i,t))return o}},cc.prototype.has=function(t){return void 0!==this.get(t)},cc.prototype.set=function(t,e){var n=this.ur(t),r=this.lr[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.hr(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.lr[n]=[[t,e]]},cc.prototype.delete=function(t){var e=this.ur(t),n=this.lr[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.hr(n[r][0],t))return 1===n.length?delete this.lr[e]:n.splice(r,1),!0;return!1},cc.prototype.forEach=function(s){Vi(this.lr,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];s(i,o)}})},cc.prototype.bt=function(){return Mi(this.lr)},cc),o=(ac.prototype.wr=function(t){return(t=this._r.get(t))?t.readTime:Ei.min()},ac.prototype.Er=function(t,e){this.Tr(),this._r.set(t.key,{Ir:t,readTime:e})},ac.prototype.mr=function(t,e){void 0===e&&(e=null),this.Tr(),this._r.set(t,{Ir:null,readTime:e})},ac.prototype.Ar=function(t,e){this.Tr();var n=this._r.get(e);return void 0!==n?wa.resolve(n.Ir):this.Rr(t,e)},ac.prototype.getEntries=function(t,e){return this.Pr(t,e)},ac.prototype.apply=function(t){return this.Tr(),this.dr=!0,this.yr(t)},ac.prototype.Tr=function(){},ac);function ac(){this._r=new uc(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.dr=!1}function cc(t,e){this.ur=t,this.hr=e,this.lr={}}function hc(t,e,n,r){this.batch=t,this.cr=e,this.sr=n,this.ar=r}function fc(t,e,n,r){this.batchId=t,this.er=e,this.baseMutations=n,this.mutations=r}function lc(t,e){var n=t[0],r=t[1],t=e[0],e=e[1];return 0===(t=Sr(n,t))?Sr(r,e):t}var pc=(mc.prototype.pr=function(){return++this.Vr},mc.prototype.br=function(t){var e=[t,this.pr()];this.buffer.size<this.gr?this.buffer=this.buffer.add(e):lc(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(mc.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),mc),dc=(gc.prototype.start=function(t){-1!==this.vr.params.qi&&this.Cr(t)},gc.prototype.stop=function(){this.Dr&&(this.Dr.cancel(),this.Dr=null)},Object.defineProperty(gc.prototype,"Nr",{get:function(){return null!==this.Dr},enumerable:!1,configurable:!0}),gc.prototype.Cr=function(n){var t=this,e=this.Sr?3e5:6e4;wr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.Dr=this.ks.ni("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.Dr=null,this.Sr=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.Fr(this.vr)];case 2:return t.sent(),[3,7];case 3:return Da(e=t.sent())?(wr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,rc(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.Cr(n)];case 8:return t.sent(),[2]}})})})},gc),yc=(vc.prototype.kr=function(t,e){return this.Or.Mr(t).next(function(t){return Math.floor(e/100*t)})},vc.prototype.Lr=function(t,e){var n=this;if(0===e)return wa.resolve(ec.Zi);var r=new pc(e);return this.Or.Un(t,function(t){return r.br(t.sequenceNumber)}).next(function(){return n.Or.$r(t,function(t){return r.br(t)})}).next(function(){return r.maxValue})},vc.prototype.Br=function(t,e,n){return this.Or.Br(t,e,n)},vc.prototype.qr=function(t,e){return this.Or.qr(t,e)},vc.prototype.Ur=function(e,n){var r=this;return-1===this.params.qi?(wr("LruGarbageCollector","Garbage collection skipped; disabled"),wa.resolve(Ka)):this.Qr(e).next(function(t){return t<r.params.qi?(wr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.qi),Ka):r.Kr(e,n)})},vc.prototype.Qr=function(t){return this.Or.Qr(t)},vc.prototype.Kr=function(e,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.kr(e,this.params.Ui).next(function(t){return i=t>h.params.Qi?(wr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.Qi+" from "+t),h.params.Qi):t,s=Date.now(),h.Lr(e,i)}).next(function(t){return r=t,u=Date.now(),h.Br(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.qr(e,r)}).next(function(t){return c=Date.now(),mr()<=l.DEBUG&&wr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),wa.resolve({Mi:!0,Li:i,$i:o,Bi:t})})},vc);function vc(t,e){this.Or=t,this.params=e}function gc(t,e){this.vr=t,this.ks=e,this.Sr=!1,this.Dr=null}function mc(t){this.gr=t,this.buffer=new vu(lc),this.Vr=0}function wc(t,e,n){if(!n)throw new Lr(Rr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function bc(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Lr(Rr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Ic(t,e,n,r){if(!0===e&&!0===r)throw new Lr(Rr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Ec(t){if(!Ni.qt(t))throw new Lr(Rr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function _c(t){if(Ni.qt(t))throw new Lr(Rr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Tc(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":_r();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Ac(t,e){if("_delegate"in t&&(t=t._),t instanceof e)return t;if(e.name===t.constructor.name)throw new Lr(Rr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");throw t=Tc(t),new Lr(Rr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function Nc(t,e){if(e<=0)throw new Lr(Rr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Sc=(kc.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},kc),Oc=new Map,Dc=(Object.defineProperty(xc.prototype,"app",{get:function(){if(!this.Jr)throw new Lr(Rr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Jr},enumerable:!1,configurable:!0}),Object.defineProperty(xc.prototype,"Yr",{get:function(){return this.Gr},enumerable:!1,configurable:!0}),Object.defineProperty(xc.prototype,"Xr",{get:function(){return void 0!==this.Zr},enumerable:!1,configurable:!0}),xc.prototype.eo=function(t){if(this.Gr)throw new Lr(Rr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.jr=new Sc(t),void 0!==t.credentials&&(this.Hr=function(t){if(!t)return new Wr;switch(t.type){case"gapi":var e=t.client;return Tr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Jr(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Lr(Rr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},xc.prototype.no=function(){return this.jr},xc.prototype.so=function(){return this.Gr=!0,this.jr},xc.prototype._delete=function(){return this.Zr||(this.Zr=this.io()),this.Zr},xc.prototype.io=function(){return(t=Oc.get(this))&&(wr("ComponentProvider","Removing Datastore"),Oc.delete(this),t.terminate()),Promise.resolve();var t},xc);function xc(t,e){this.Wr="(lite)",this.jr=new Sc({}),this.Gr=!1,t instanceof $r?(this.zr=t,this.Hr=new Wr):(this.Jr=t,this.zr=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Lr(Rr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new $r(t.options.projectId)}(t),this.Hr=new Qr(e))}function kc(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Lr(Rr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Lr(Rr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Ic("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function Pc(t){for(var o="",e=0;e<t.length;e++)0<o.length&&(o=Rc(o)),o=function(t){for(var e=o,n=t.length,r=0;r<n;r++){var i=t.charAt(r);switch(i){case"\0":e+="";break;case"":e+="";break;default:e+=i}}return e}(t.get(e));return Rc(o)}function Rc(t){return t+""}function Lc(t){var e=t.length;if(Tr(2<=e),2===e)return Tr(""===t.charAt(0)&&""===t.charAt(1)),_i.Nt();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&_r(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:_r()}o=s+2}return new _i(r)}function Cc(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n}var Uc=function(t,e){this.seconds=t,this.nanoseconds=e};function Vc(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}function Mc(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}Cc.store="owner",Cc.key="owner",Vc.store="mutationQueues",Vc.keyPath="userId",Mc.store="mutations",Mc.keyPath="batchId",Mc.userMutationsIndex="userMutationsIndex",Mc.userMutationsKeyPath=["userId","batchId"];var jc=(Fc.prefixForUser=function(t){return[t]},Fc.prefixForPath=function(t,e){return[t,Pc(e)]},Fc.key=function(t,e,n){return[t,Pc(e),n]},Fc);function Fc(){}function qc(t,e){this.path=t,this.readTime=e}function Bc(t,e){this.path=t,this.version=e}jc.store="documentMutations",jc.PLACEHOLDER=new jc;var Gc=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};function zc(t){this.byteSize=t}function Hc(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s}Gc.store="remoteDocuments",Gc.readTimeIndex="readTimeIndex",Gc.readTimeIndexPath="readTime",Gc.collectionReadTimeIndex="collectionReadTimeIndex",Gc.collectionReadTimeIndexPath=["parentPath","readTime"],zc.store="remoteDocumentGlobal",zc.key="remoteDocumentGlobalKey",Hc.store="targets",Hc.keyPath="targetId",Hc.queryTargetsIndexName="queryTargetsIndex",Hc.queryTargetsKeyPath=["canonicalId","targetId"];var Kc=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};function Wc(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r}function Qc(t,e){this.collectionId=t,this.parent=e}function Yc(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r}function Jc(t,e,n){this.bundleId=t,this.createTime=e,this.version=n}function Xc(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n}Kc.store="targetDocuments",Kc.keyPath=["targetId","path"],Kc.documentTargetsIndex="documentTargetsIndex",Kc.documentTargetsKeyPath=["path","targetId"],Wc.key="targetGlobalKey",Wc.store="targetGlobal",Qc.store="collectionParents",Qc.keyPath=["collectionId","parent"],Yc.store="clientMetadata",Yc.keyPath="clientId",Jc.store="bundles",Jc.keyPath="bundleId",Xc.store="namedQueries",Xc.keyPath="name";var $c,Zc=f(f(f(f([Vc.store,Mc.store,jc.store,Gc.store,Hc.store,Cc.store,Wc.store,Kc.store],[Yc.store]),[zc.store]),[Qc.store]),[Jc.store,Xc.store]),th=(h(eh,$c=me),eh);function eh(t,e){var n=this;return(n=$c.call(this)||this).ro=t,n.oo=e,n}function nh(t,e){return Ia.As(t.ro,e)}var rh=function(t){this.co=t};function ih(t,e){if(e.document)return sa(t.co,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Ni.Ut(e.noDocument.path),r=ch(e.noDocument.readTime);return new po(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}return e.unknownDocument?(n=Ni.Ut(e.unknownDocument.path),r=ch(e.unknownDocument.version),new yo(n,r)):_r()}function oh(t,e,n){var r=sh(n),n=e.key.path.yt().Dt();if(e instanceof lo){var i={name:Zu(o=t.co,(s=e).key),fields:s.Yt().mapValue.fields,updateTime:Qu(o,s.version.Tt())},o=e.hasCommittedMutations;return new Gc(null,null,i,o,r,n)}if(e instanceof po){var s=e.key.path.Dt(),i=ah(e.version),o=e.hasCommittedMutations;return new Gc(null,new qc(s,i),null,o,r,n)}return e instanceof yo?(o=e.key.path.Dt(),e=ah(e.version),new Gc(new Bc(o,e),null,null,!0,r,n)):_r()}function sh(t){return[(t=t.Tt()).seconds,t.nanoseconds]}function uh(t){return t=new Ii(t[0],t[1]),Ei.wt(t)}function ah(t){return t=t.Tt(),new Uc(t.seconds,t.nanoseconds)}function ch(t){return t=new Ii(t.seconds,t.nanoseconds),Ei.wt(t)}function hh(e,t){for(var n=(t.baseMutations||[]).map(function(t){return aa(e.co,t)}),r=t.mutations.length-1;0<=r;--r){var i=t.mutations[r];void 0!==(null==i?void 0:i.transform)&&(t.mutations[r-1].updateTransforms=i.transform.fieldTransforms,t.mutations.splice(r,1),--r)}var o=t.mutations.map(function(t){return aa(e.co,t)}),s=Ii.fromMillis(t.localWriteTimeMs);return new oc(t.batchId,s,n,o)}function fh(t){var e=ch(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?ch(t.lastLimboFreeSnapshotVersion):Ei.min(),r=void 0!==t.query.documents?(Tr(1===(r=t.query).documents.length),cs(ns(na(r.documents[0])))):cs(fa(t.query));return new vs(r,t.targetId,0,t.lastListenSequenceNumber,e,n,xr.fromBase64String(t.resumeToken))}function lh(t,e){var n=ah(e.oe),r=ah(e.lastLimboFreeSnapshotVersion),i=(_o(e.target)?ca:ha)(t.co,e.target),t=e.resumeToken.toBase64();return new Hc(e.targetId,Io(e.target),n,t,e.sequenceNumber,r,i)}function ph(t){var e=fa({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?hs(e,e.limit,"L"):e}var dh=(yh.prototype.ao=function(t,e){return vh(t).get(e).next(function(t){if(t)return{id:t.bundleId,createTime:ch(t.createTime),version:t.version}})},yh.prototype.uo=function(t,e){return vh(t).put({bundleId:e.id,createTime:ah(Ju(e.createTime)),version:e.version})},yh.prototype.ho=function(t,e){return gh(t).get(e).next(function(t){if(t)return{name:t.name,query:ph(t.bundledQuery),readTime:ch(t.readTime)}})},yh.prototype.lo=function(t,e){return gh(t).put({name:e.name,readTime:ah(Ju(e.readTime)),bundledQuery:e.bundledQuery})},yh);function yh(){}function vh(t){return nh(t,Jc.store)}function gh(t){return nh(t,Xc.store)}var mh=(_h.prototype.fo=function(t,e){return this._o.add(e),wa.resolve()},_h.prototype.wo=function(t,e){return wa.resolve(this._o.getEntries(e))},_h),wh=(Eh.prototype.add=function(t){var e=t.Vt(),n=t.yt(),r=this.index[e]||new vu(_i.At),t=!r.has(n);return this.index[e]=r.add(n),t},Eh.prototype.has=function(t){var e=t.Vt(),t=t.yt();return(e=this.index[e])&&e.has(t)},Eh.prototype.getEntries=function(t){return(this.index[t]||new vu(_i.At)).Dt()},Eh),bh=(Ih.prototype.fo=function(t,e){var n=this;if(this.Eo.has(e))return wa.resolve();var r=e.Vt(),i=e.yt();return t.Oi(function(){n.Eo.add(e)}),i={collectionId:r,parent:Pc(i)},Th(t).put(i)},Ih.prototype.wo=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Dr(i),""],!1,!0);return Th(t).Ds(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(Lc(r.parent))}return o})},Ih);function Ih(){this.Eo=new wh}function Eh(){this.index={}}function _h(){this._o=new wh}function Th(t){return nh(t,Qc.store)}function Ah(t,e,n){var r=t.store(Mc.store),i=t.store(jc.store),o=[],t=IDBKeyRange.only(n.batchId),s=0,t=r.Fs({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){Tr(1===s)}));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],f=jc.key(e,h.key.path,n.batchId);o.push(i.delete(f)),u.push(h.key)}return wa.hs(o).next(function(){return u})}function Nh(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw _r();e=t.noDocument}return JSON.stringify(e).length}var Sh=(Oh.Ao=function(t,e,n,r){return Tr(""!==t.uid),new Oh(t.T()?t.uid:"",e,n,r)},Oh.prototype.Ro=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return xh(t).Fs({index:Mc.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},Oh.prototype.Po=function(d,y,v,g){var m=this,w=kh(d),b=xh(d);return b.add({}).next(function(t){Tr("number"==typeof t);for(var e,n,r,i,o,s=new oc(t,y,v,g),u=(e=m.fe,n=m.userId,i=(r=s).baseMutations.map(function(t){return ua(e.co,t)}),o=r.mutations.map(function(t){return ua(e.co,t)}),new Mc(n,r.batchId,r.er.toMillis(),i,o)),a=[],c=new vu(function(t,e){return Sr(t.Ct(),e.Ct())}),h=0,f=g;h<f.length;h++){var l=f[h],p=jc.key(m.userId,l.key.path,t),c=c.add(l.key.path.yt());a.push(b.put(u)),a.push(w.put(p,jc.PLACEHOLDER))}return c.forEach(function(t){a.push(m.To.fo(d,t))}),d.Oi(function(){m.mo[t]=s.keys()}),wa.hs(a).next(function(){return s})})},Oh.prototype.yo=function(t,e){var n=this;return xh(t).get(e).next(function(t){return t?(Tr(t.userId===n.userId),hh(n.fe,t)):null})},Oh.prototype.Vo=function(t,e){var n=this;return this.mo[e]?wa.resolve(this.mo[e]):this.yo(t,e).next(function(t){return t?(t=t.keys(),n.mo[e]=t):null})},Oh.prototype.po=function(t,e){var r=this,i=e+1,e=IDBKeyRange.lowerBound([this.userId,i]),o=null;return xh(t).Fs({index:Mc.userMutationsIndex,range:e},function(t,e,n){e.userId===r.userId&&(Tr(e.batchId>=i),o=hh(r.fe,e)),n.done()}).next(function(){return o})},Oh.prototype.bo=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return xh(t).Fs({index:Mc.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},Oh.prototype.vo=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return xh(t).Ds(Mc.userMutationsIndex,n).next(function(t){return t.map(function(t){return hh(e.fe,t)})})},Oh.prototype.So=function(o,s){var u=this,t=jc.prefixForPath(this.userId,s.path),t=IDBKeyRange.lowerBound(t),a=[];return kh(o).Fs({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Lc(i);if(r===u.userId&&s.path.isEqual(i))return xh(o).get(t).next(function(t){if(!t)throw _r();Tr(t.userId===u.userId),a.push(hh(u.fe,t))});n.done()}).next(function(){return a})},Oh.prototype.Do=function(e,t){var s=this,u=new vu(Sr),n=[];return t.forEach(function(o){var t=jc.prefixForPath(s.userId,o.path),t=IDBKeyRange.lowerBound(t),t=kh(e).Fs({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Lc(i);r===s.userId&&o.path.isEqual(i)?u=u.add(t):n.done()});n.push(t)}),wa.hs(n).next(function(){return s.Co(e,u)})},Oh.prototype.xo=function(t,e){var o=this,s=e.path,u=s.length+1,e=jc.prefixForPath(this.userId,s),e=IDBKeyRange.lowerBound(e),a=new vu(Sr);return kh(t).Fs({range:e},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Lc(i);r===o.userId&&s.vt(i)?i.length===u&&(a=a.add(t)):n.done()}).next(function(){return o.Co(t,a)})},Oh.prototype.Co=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(xh(e).get(t).next(function(t){if(null===t)throw _r();Tr(t.userId===n.userId),r.push(hh(n.fe,t))}))}),wa.hs(i).next(function(){return r})},Oh.prototype.No=function(e,n){var r=this;return Ah(e.ro,this.userId,n).next(function(t){return e.Oi(function(){r.Fo(n.batchId)}),wa.forEach(t,function(t){return r.Io.Oo(e,t)})})},Oh.prototype.Fo=function(t){delete this.mo[t]},Oh.prototype.ko=function(e){var i=this;return this.Ro(e).next(function(t){if(!t)return wa.resolve();var t=IDBKeyRange.lowerBound(jc.prefixForUser(i.userId)),r=[];return kh(e).Fs({range:t},function(t,e,n){t[0]===i.userId?(t=Lc(t[1]),r.push(t)):n.done()}).next(function(){Tr(0===r.length)})})},Oh.prototype.Mo=function(t,e){return Dh(t,this.userId,e)},Oh.prototype.Lo=function(t){var e=this;return Ph(t).get(this.userId).next(function(t){return t||new Vc(e.userId,-1,"")})},Oh);function Oh(t,e,n,r){this.userId=t,this.fe=e,this.To=n,this.Io=r,this.mo={}}function Dh(t,o,e){var s=(e=jc.prefixForPath(o,e.path))[1],e=IDBKeyRange.lowerBound(e),u=!1;return kh(t).Fs({range:e,Ns:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function xh(t){return nh(t,Mc.store)}function kh(t){return nh(t,jc.store)}function Ph(t){return nh(t,Vc.store)}var Rh=(Uh.prototype.next=function(){return this.$o+=2,this.$o},Uh.Bo=function(){return new Uh(0)},Uh.qo=function(){return new Uh(-1)},Uh),Lh=(Ch.prototype.Uo=function(n){var r=this;return this.Qo(n).next(function(t){var e=new Rh(t.highestTargetId);return t.highestTargetId=e.next(),r.Ko(n,t).next(function(){return t.highestTargetId})})},Ch.prototype.Wo=function(t){return this.Qo(t).next(function(t){return Ei.wt(new Ii(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},Ch.prototype.jo=function(t){return this.Qo(t).next(function(t){return t.highestListenSequenceNumber})},Ch.prototype.Go=function(e,n,r){var i=this;return this.Qo(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.Tt()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.Ko(e,t)})},Ch.prototype.zo=function(e,n){var r=this;return this.Ho(e,n).next(function(){return r.Qo(e).next(function(t){return t.targetCount+=1,r.Jo(n,t),r.Ko(e,t)})})},Ch.prototype.Yo=function(t,e){return this.Ho(t,e)},Ch.prototype.Xo=function(e,t){var n=this;return this.Zo(e,t.targetId).next(function(){return Vh(e).delete(t.targetId)}).next(function(){return n.Qo(e)}).next(function(t){return Tr(0<t.targetCount),--t.targetCount,n.Ko(e,t)})},Ch.prototype.Br=function(n,r,i){var o=this,s=0,u=[];return Vh(n).Fs(function(t,e){(e=fh(e)).sequenceNumber<=r&&null===i.get(e.targetId)&&(s++,u.push(o.Xo(n,e)))}).next(function(){return wa.hs(u)}).next(function(){return s})},Ch.prototype.Un=function(t,n){return Vh(t).Fs(function(t,e){e=fh(e),n(e)})},Ch.prototype.Qo=function(t){return Mh(t).get(Wc.key).next(function(t){return Tr(null!==t),t})},Ch.prototype.Ko=function(t,e){return Mh(t).put(Wc.key,e)},Ch.prototype.Ho=function(t,e){return Vh(t).put(lh(this.fe,e))},Ch.prototype.Jo=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},Ch.prototype.tc=function(t){return this.Qo(t).next(function(t){return t.targetCount})},Ch.prototype.ec=function(t,r){var e=Io(r),e=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),i=null;return Vh(t).Fs({range:e,index:Hc.queryTargetsIndexName},function(t,e,n){e=fh(e),Eo(r,e.target)&&(i=e,n.done())}).next(function(){return i})},Ch.prototype.nc=function(n,t,r){var i=this,o=[],s=jh(n);return t.forEach(function(t){var e=Pc(t.path);o.push(s.put(new Kc(r,e))),o.push(i.Io.sc(n,r,t))}),wa.hs(o)},Ch.prototype.ic=function(n,t,r){var i=this,o=jh(n);return wa.forEach(t,function(t){var e=Pc(t.path);return wa.hs([o.delete([r,e]),i.Io.rc(n,r,t)])})},Ch.prototype.Zo=function(t,e){return t=jh(t),e=IDBKeyRange.bound([e],[e+1],!1,!0),t.delete(e)},Ch.prototype.oc=function(t,e){var e=IDBKeyRange.bound([e],[e+1],!1,!0),t=jh(t),r=Tu();return t.Fs({range:e,Ns:!0},function(t,e,n){t=Lc(t[1]),t=new Ni(t),r=r.add(t)}).next(function(){return r})},Ch.prototype.Mo=function(t,e){var e=Pc(e.path),e=IDBKeyRange.bound([e],[Dr(e)],!1,!0),i=0;return jh(t).Fs({index:Kc.documentTargetsIndex,Ns:!0,range:e},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},Ch.prototype.Zn=function(t,e){return Vh(t).get(e).next(function(t){return t?fh(t):null})},Ch);function Ch(t,e){this.Io=t,this.fe=e}function Uh(t){this.$o=t}function Vh(t){return nh(t,Hc.store)}function Mh(t){return nh(t,Wc.store)}function jh(t){return nh(t,Kc.store)}var Fh=(qh.prototype.Mr=function(t){var n=this.cc(t);return this.db.ac().tc(t).next(function(e){return n.next(function(t){return e+t})})},qh.prototype.cc=function(t){var e=0;return this.$r(t,function(t){e++}).next(function(){return e})},qh.prototype.Un=function(t,e){return this.db.ac().Un(t,e)},qh.prototype.$r=function(t,n){return this.uc(t,function(t,e){return n(e)})},qh.prototype.sc=function(t,e,n){return Bh(t,n)},qh.prototype.rc=function(t,e,n){return Bh(t,n)},qh.prototype.Br=function(t,e,n){return this.db.ac().Br(t,e,n)},qh.prototype.Oo=Bh,qh.prototype.hc=function(t,e){return r=e,i=!1,Ph(n=t).Os(function(t){return Dh(n,t,r).next(function(t){return t&&(i=!0),wa.resolve(!t)})}).next(function(){return i});var n,r,i},qh.prototype.qr=function(n,r){var i=this,o=this.db._c().lc(),s=[],u=0;return this.uc(n,function(e,t){t<=r&&(t=i.hc(n,e).next(function(t){if(!t)return u++,o.Ar(n,e).next(function(){return o.mr(e),jh(n).delete([0,Pc(e.path)])})}),s.push(t))}).next(function(){return wa.hs(s)}).next(function(){return o.apply(n)}).next(function(){return u})},qh.prototype.removeTarget=function(t,e){return e=e.ce(t.oo),this.db.ac().Yo(t,e)},qh.prototype.fc=Bh,qh.prototype.uc=function(t,r){var i,t=jh(t),o=ec.Zi;return t.Fs({index:Kc.documentTargetsIndex},function(t,e){var n=t[0],t=(t[1],e.path),e=e.sequenceNumber;0===n?(o!==ec.Zi&&r(new Ni(Lc(i)),o),o=e,i=t):o=ec.Zi}).next(function(){o!==ec.Zi&&r(new Ni(Lc(i)),o)})},qh.prototype.Qr=function(t){return this.db._c().dc(t)},qh);function qh(t,e){this.db=t,this.vr=new yc(this,e)}function Bh(t,e){return jh(t).put((t=t.oo,new Kc(0,Pc(e.path),t)))}var Gh,zh=(Wh.prototype.Er=function(t,e,n){return Yh(t).put(Jh(e),n)},Wh.prototype.mr=function(t,e){return t=Yh(t),e=Jh(e),t.delete(e)},Wh.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.wc(e,t)})},Wh.prototype.Ar=function(t,e){var n=this;return Yh(t).get(Jh(e)).next(function(t){return n.Ec(t)})},Wh.prototype.Tc=function(t,e){var n=this;return Yh(t).get(Jh(e)).next(function(t){var e=n.Ec(t);return e?{Ir:e,size:Nh(t)}:null})},Wh.prototype.getEntries=function(t,e){var n=this,r=mu;return this.Ic(t,e,function(t,e){e=n.Ec(e),r=r.Ie(t,e)}).next(function(){return r})},Wh.prototype.mc=function(t,e){var r=this,i=mu,o=new uu(Ni.At);return this.Ic(t,e,function(t,e){var n=r.Ec(e);o=n?(i=i.Ie(t,n),o.Ie(t,Nh(e))):(i=i.Ie(t,null),o.Ie(t,0))}).next(function(){return{Ac:i,Rc:o}})},Wh.prototype.Ic=function(t,e,i){if(e.bt())return wa.resolve();var n=IDBKeyRange.bound(e.first().path.Dt(),e.last().path.Dt()),o=e.ge(),s=o.De();return Yh(t).Fs({range:n},function(t,e,n){for(var r=Ni.Ut(t);s&&Ni.At(s,r)<0;)i(s,null),s=o.De();s&&s.isEqual(r)&&(i(s,e),s=o.Ce()?o.De():null),s?n.Ss(s.path.Dt()):n.done()}).next(function(){for(;s;)i(s,null),s=o.Ce()?o.De():null})},Wh.prototype.Pc=function(t,r,e){var n,i=this,o=Iu,s=r.path.length+1,u={};return e.isEqual(Ei.min())?(n=r.path.Dt(),u.range=IDBKeyRange.lowerBound(n)):(n=r.path.Dt(),e=sh(e),u.range=IDBKeyRange.lowerBound([n,e],!0),u.index=Gc.collectionReadTimeIndex),Yh(t).Fs(u,function(t,e,n){t.length===s&&(e=ih(i.fe,e),r.path.vt(e.key.path)?e instanceof lo&&ds(r,e)&&(o=o.Ie(e.key,e)):n.done())}).next(function(){return o})},Wh.prototype.lc=function(t){return new Hh(this,!!t&&t.yc)},Wh.prototype.dc=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},Wh.prototype.getMetadata=function(t){return Qh(t).get(zc.key).next(function(t){return Tr(!!t),t})},Wh.prototype.wc=function(t,e){return Qh(t).put(zc.key,e)},Wh.prototype.Ec=function(t){return!t||(t=ih(this.fe,t))instanceof po&&t.version.isEqual(Ei.min())?null:t},Wh),Hh=(h(Kh,Gh=o),Kh.prototype.yr=function(i){var o=this,s=[],u=0,a=new vu(function(t,e){return Sr(t.Ct(),e.Ct())});return this._r.forEach(function(t,e){var n,r=o.Vc.get(t);e.Ir?(n=oh(o.gc.fe,e.Ir,o.wr(t)),a=a.add(t.path.yt()),e=Nh(n),u+=e-r,s.push(o.gc.Er(i,t,n))):(u-=r,o.yc?(r=oh(o.gc.fe,new po(t,Ei.min()),o.wr(t)),s.push(o.gc.Er(i,t,r))):s.push(o.gc.mr(i,t)))}),a.forEach(function(t){s.push(o.gc.To.fo(i,t))}),s.push(this.gc.updateMetadata(i,u)),wa.hs(s)},Kh.prototype.Rr=function(t,e){var n=this;return this.gc.Tc(t,e).next(function(t){return null===t?(n.Vc.set(e,0),null):(n.Vc.set(e,t.size),t.Ir)})},Kh.prototype.Pr=function(t,e){var n=this;return this.gc.mc(t,e).next(function(t){var e=t.Ac;return t.Rc.forEach(function(t,e){n.Vc.set(t,e)}),e})},Kh);function Kh(t,e){var n=this;return(n=Gh.call(this)||this).gc=t,n.yc=e,n.Vc=new uc(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function Wh(t,e){this.fe=t,this.To=e}function Qh(t){return nh(t,zc.store)}function Yh(t){return nh(t,Gc.store)}function Jh(t){return t.path.Dt()}var Xh=($h.prototype.Ps=function(e,n,t,r){var i=this;Tr(t<r&&0<=t&&r<=11);var o=new ba("createOrUpgrade",n);t<1&&1<=r&&(e.createObjectStore(Cc.store),(s=e).createObjectStore(Vc.store,{keyPath:Vc.keyPath}),s.createObjectStore(Mc.store,{keyPath:Mc.keyPath,autoIncrement:!0}).createIndex(Mc.userMutationsIndex,Mc.userMutationsKeyPath,{unique:!0}),s.createObjectStore(jc.store),Zh(e),e.createObjectStore(Gc.store));var s,u=wa.resolve();return t<3&&3<=r&&(0!==t&&((s=e).deleteObjectStore(Kc.store),s.deleteObjectStore(Hc.store),s.deleteObjectStore(Wc.store),Zh(e)),u=u.next(function(){return t=o.store(Wc.store),e=new Wc(0,0,Ei.min().Tt(),0),t.put(Wc.key,e);var t,e})),t<4&&4<=r&&(0!==t&&(u=u.next(function(){return n=e,(r=o).store(Mc.store).Ds().next(function(t){n.deleteObjectStore(Mc.store),n.createObjectStore(Mc.store,{keyPath:Mc.keyPath,autoIncrement:!0}).createIndex(Mc.userMutationsIndex,Mc.userMutationsKeyPath,{unique:!0});var e=r.store(Mc.store),t=t.map(function(t){return e.put(t)});return wa.hs(t)});var n,r})),u=u.next(function(){e.createObjectStore(Yc.store,{keyPath:Yc.keyPath})})),t<5&&5<=r&&(u=u.next(function(){return i.bc(o)})),t<6&&6<=r&&(u=u.next(function(){return e.createObjectStore(zc.store),i.vc(o)})),t<7&&7<=r&&(u=u.next(function(){return i.Sc(o)})),t<8&&8<=r&&(u=u.next(function(){return i.Dc(e,o)})),t<9&&9<=r&&(u=u.next(function(){var t;(t=e).objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(t=n.objectStore(Gc.store)).createIndex(Gc.readTimeIndex,Gc.readTimeIndexPath,{unique:!1}),t.createIndex(Gc.collectionReadTimeIndex,Gc.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=r&&(u=u.next(function(){return i.Cc(o)})),t<11&&11<=r&&(u=u.next(function(){e.createObjectStore(Jc.store,{keyPath:Jc.keyPath}),e.createObjectStore(Xc.store,{keyPath:Xc.keyPath})})),u},$h.prototype.vc=function(e){var n=0;return e.store(Gc.store).Fs(function(t,e){n+=Nh(e)}).next(function(){var t=new zc(n);return e.store(zc.store).put(zc.key,t)})},$h.prototype.bc=function(n){var r=this,t=n.store(Vc.store),i=n.store(Mc.store);return t.Ds().next(function(t){return wa.forEach(t,function(e){var t=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return i.Ds(Mc.userMutationsIndex,t).next(function(t){return wa.forEach(t,function(t){return Tr(t.userId===e.userId),t=hh(r.fe,t),Ah(n,e.userId,t).next(function(){})})})})})},$h.prototype.Sc=function(t){var o=t.store(Kc.store),e=t.store(Gc.store);return t.store(Wc.store).get(Wc.key).next(function(r){var i=[];return e.Fs(function(t,e){var n=new _i(t),t=[0,Pc(n)];i.push(o.get(t).next(function(t){return t?wa.resolve():o.put(new Kc(0,Pc(n),r.highestListenSequenceNumber))}))}).next(function(){return wa.hs(i)})})},$h.prototype.Dc=function(t,e){function r(t){if(i.add(t)){var e=t.Vt(),t=t.yt();return n.put({collectionId:e,parent:Pc(t)})}}t.createObjectStore(Qc.store,{keyPath:Qc.keyPath});var n=e.store(Qc.store),i=new wh;return e.store(Gc.store).Fs({Ns:!0},function(t,e){return r((t=new _i(t)).yt())}).next(function(){return e.store(jc.store).Fs({Ns:!0},function(t,e){t[0];var n=t[1];return r((n=(t[2],Lc(n))).yt())})})},$h.prototype.Cc=function(t){var n=this,r=t.store(Hc.store);return r.Fs(function(t,e){return e=fh(e),e=lh(n.fe,e),r.put(e)})},$h);function $h(t){this.fe=t}function Zh(t){t.createObjectStore(Kc.store,{keyPath:Kc.keyPath}).createIndex(Kc.documentTargetsIndex,Kc.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Hc.store,{keyPath:Hc.keyPath}).createIndex(Hc.queryTargetsIndexName,Hc.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Wc.store)}var tf="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",ef=(nf.prototype.start=function(){var e=this;return this.Gc().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Lr(Rr.FAILED_PRECONDITION,tf);return e.zc(),e.Hc(),e.Jc(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.Qc.jo(t)})}).then(function(t){e.Fc=new ec(t,e.xc)}).then(function(){e.Oc=!0}).catch(function(t){return e.Uc&&e.Uc.close(),Promise.reject(t)})},nf.prototype.Yc=function(n){var t=this;return this.Bc=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.Nr?[2,n(e)]:[2]})})},n(this.isPrimary)},nf.prototype.Xc=function(n){var t=this;this.Uc.gs(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},nf.prototype.Zc=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.js.Ws(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Nr?[4,this.Gc()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},nf.prototype.Gc=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return of(e).put(new Yc(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.ta(e).next(function(t){t||(n.isPrimary=!1,n.js.ea(function(){return n.Bc(!1)}))})}).next(function(){return n.na(e)}).next(function(t){return n.isPrimary&&!t?n.sa(e).next(function(){return!1}):!!t&&n.ia(e).next(function(){return!0})})}).catch(function(t){if(Da(t))return wr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return wr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.js.ea(function(){return n.Bc(t)}),n.isPrimary=t})},nf.prototype.ta=function(t){var e=this;return rf(t).get(Cc.key).next(function(t){return wa.resolve(e.ra(t))})},nf.prototype.oa=function(t){return of(t).delete(this.clientId)},nf.prototype.ca=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.aa(this.$c,18e5)?[3,2]:(this.$c=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=nh(t,Yc.store);return r.Ds().next(function(t){var e=o.ua(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return wa.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.jc)for(n=0,r=e;n<r.length;n++)i=r[n],this.jc.removeItem(this.ha(i.clientId));t.label=2;case 2:return[2]}})})},nf.prototype.Jc=function(){var t=this;this.Lc=this.js.ni("client_metadata_refresh",4e3,function(){return t.Gc().then(function(){return t.ca()}).then(function(){return t.Jc()})})},nf.prototype.ra=function(t){return!!t&&t.ownerId===this.clientId},nf.prototype.na=function(e){var r=this;return this.Nc?wa.resolve(!0):rf(e).get(Cc.key).next(function(t){if(null!==t&&r.aa(t.leaseTimestampMs,5e3)&&!r.la(t.ownerId)){if(r.ra(t)&&r.networkEnabled)return!0;if(!r.ra(t)){if(!t.allowTabSynchronization)throw new Lr(Rr.FAILED_PRECONDITION,tf);return!1}}return!(!r.networkEnabled||!r.inForeground)||of(e).Ds().next(function(t){return void 0===r.ua(t,5e3).find(function(t){if(r.clientId!==t.clientId){var e=!r.networkEnabled&&t.networkEnabled,n=!r.inForeground&&t.inForeground,t=r.networkEnabled===t.networkEnabled;if(e||n&&t)return!0}return!1})})}).next(function(t){return r.isPrimary!==t&&wr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},nf.prototype.$=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return this.Oc=!1,this._a(),this.Lc&&(this.Lc.cancel(),this.Lc=null),this.fa(),this.da(),[4,this.Uc.runTransaction("shutdown","readwrite",[Cc.store,Yc.store],function(t){var e=new th(t,ec.Zi);return n.sa(e).next(function(){return n.oa(e)})})];case 1:return t.sent(),this.Uc.close(),this.wa(),[2]}})})},nf.prototype.ua=function(t,e){var n=this;return t.filter(function(t){return n.aa(t.updateTimeMs,e)&&!n.la(t.clientId)})},nf.prototype.Ea=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return of(t).Ds().next(function(t){return e.ua(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(nf.prototype,"Nr",{get:function(){return this.Oc},enumerable:!1,configurable:!0}),nf.prototype.Ta=function(t){return Sh.Ao(t,this.fe,this.To,this.Io)},nf.prototype.ac=function(){return this.Qc},nf.prototype._c=function(){return this.Kc},nf.prototype.Ia=function(){return this.To},nf.prototype.ma=function(){return this.Wc},nf.prototype.runTransaction=function(e,n,r){var i=this;wr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Uc.runTransaction(e,t,Zc,function(t){return o=new th(t,i.Fc?i.Fc.next():ec.Zi),"readwrite-primary"===n?i.ta(o).next(function(t){return!!t||i.na(o)}).next(function(t){if(!t)throw br("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.js.ea(function(){return i.Bc(!1)}),new Lr(Rr.FAILED_PRECONDITION,Ha);return r(o)}).next(function(t){return i.ia(o).next(function(){return t})}):i.Aa(o).next(function(){return r(o)})}).then(function(t){return o.ki(),t})},nf.prototype.Aa=function(t){var e=this;return rf(t).get(Cc.key).next(function(t){if(null!==t&&e.aa(t.leaseTimestampMs,5e3)&&!e.la(t.ownerId)&&!e.ra(t)&&!(e.Nc||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Lr(Rr.FAILED_PRECONDITION,tf)})},nf.prototype.ia=function(t){var e=new Cc(this.clientId,this.allowTabSynchronization,Date.now());return rf(t).put(Cc.key,e)},nf.G=function(){return Ia.G()},nf.prototype.sa=function(t){var e=this,n=rf(t);return n.get(Cc.key).next(function(t){return e.ra(t)?(wr("IndexedDbPersistence","Releasing primary lease."),n.delete(Cc.key)):wa.resolve()})},nf.prototype.aa=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(br("Detected an update time that is in the future: "+t+" > "+n),1))},nf.prototype.zc=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Mc=function(){t.js.Ws(function(){return t.inForeground="visible"===t.document.visibilityState,t.Gc()})},this.document.addEventListener("visibilitychange",this.Mc),this.inForeground="visible"===this.document.visibilityState)},nf.prototype.fa=function(){this.Mc&&(this.document.removeEventListener("visibilitychange",this.Mc),this.Mc=null)},nf.prototype.Hc=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.kc=function(){e._a(),e.js.Ws(function(){return e.$()})},this.window.addEventListener("unload",this.kc))},nf.prototype.da=function(){this.kc&&(this.window.removeEventListener("unload",this.kc),this.kc=null)},nf.prototype.la=function(t){try{var e=null!==(null===(e=this.jc)||void 0===e?void 0:e.getItem(this.ha(t)));return wr("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return br("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},nf.prototype._a=function(){if(this.jc)try{this.jc.setItem(this.ha(this.clientId),String(Date.now()))}catch(t){br("Failed to set zombie client id.",t)}},nf.prototype.wa=function(){if(this.jc)try{this.jc.removeItem(this.ha(this.clientId))}catch(t){}},nf.prototype.ha=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},nf);function nf(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.js=i,this.window=o,this.document=s,this.xc=a,this.Nc=c,this.Fc=null,this.Oc=!1,this.isPrimary=!1,this.networkEnabled=!0,this.kc=null,this.inForeground=!1,this.Mc=null,this.Lc=null,this.$c=Number.NEGATIVE_INFINITY,this.Bc=function(t){return Promise.resolve()},!nf.G())throw new Lr(Rr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Io=new Fh(this,r),this.qc=e+"main",this.fe=new rh(u),this.Uc=new Ia(this.qc,11,new Xh(this.fe)),this.Qc=new Lh(this.Io,this.fe),this.To=new bh,this.Kc=(e=this.fe,u=this.To,new zh(e,u)),this.Wc=new dh,this.window&&this.window.localStorage?this.jc=this.window.localStorage:(this.jc=null,!1===c&&br("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function rf(t){return nh(t,Cc.store)}function of(t){return nh(t,Yc.store)}function sf(t,e){var n=t.projectId;return t.M||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var uf=(df.prototype.Pa=function(e,n){var r=this;return this.Ra.So(e,n).next(function(t){return r.ya(e,n,t)})},df.prototype.ya=function(t,r,i){return this.Kc.Ar(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].ir(r,t);return t})},df.prototype.ga=function(t,e,i){var o=mu;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].ir(t,e);o=o.Ie(t,e)}),o},df.prototype.Va=function(e,t){var n=this;return this.Kc.getEntries(e,t).next(function(t){return n.pa(e,t)})},df.prototype.pa=function(e,r){var i=this;return this.Ra.Do(e,r).next(function(t){var t=i.ga(e,r,t),n=mu;return t.forEach(function(t,e){e=e||new po(t,Ei.min()),n=n.Ie(t,e)}),n})},df.prototype.Pc=function(t,e,n){return r=e,Ni.qt(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.ba(t,e.path):us(e)?this.va(t,e,n):this.Sa(t,e,n);var r},df.prototype.ba=function(t,e){return this.Pa(t,new Ni(e)).next(function(t){var e=Iu;return t instanceof lo&&(e=e.Ie(t.key,t)),e})},df.prototype.va=function(n,r,i){var o=this,s=r.collectionGroup,u=Iu;return this.To.wo(n,s).next(function(t){return wa.forEach(t,function(t){var e=(e=r,t=t.child(s),new ts(t,null,e.ne.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.Sa(n,e,i).next(function(t){t.forEach(function(t,e){u=u.Ie(t,e)})})}).next(function(){return u})})},df.prototype.Sa=function(e,n,t){var a,c,r=this;return this.Kc.Pc(e,n,t).next(function(t){return a=t,r.Ra.xo(e,n)}).next(function(t){return c=t,r.Da(e,c,a).next(function(t){a=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,s=Gs(s,s=a.get(u),s,r.er);a=s instanceof lo?a.Ie(u,s):a.remove(u)}})}).next(function(){return a.forEach(function(t,e){ds(n,e)||(a=a.remove(t))}),a})},df.prototype.Da=function(t,e,n){for(var r=Tu(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Ys&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.Kc.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof lo&&(c=c.Ie(t,e))}),c})},df),af=(pf.Na=function(t,e){for(var n=Tu(),r=Tu(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new pf(t,e.fromCache,n,r)},pf),cf=(lf.prototype.Fa=function(t){this.Oa=t},lf.prototype.Pc=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.ne.length||1===r.ne.length&&r.ne[0].field.Ot())||i.isEqual(Ei.min())?this.ka(e,r):this.Oa.Va(e,o).next(function(t){var n=s.Ma(r,t);return(rs(r)||is(r))&&s.La(r.limitType,n,o,i)?s.ka(e,r):(mr()<=l.DEBUG&&wr("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ps(r)),s.Oa.Pc(e,r,i).next(function(e){return n.forEach(function(t){e=e.Ie(t.key,t)}),e}))})},lf.prototype.Ma=function(n,t){var r=new vu(ys(n));return t.forEach(function(t,e){e instanceof lo&&ds(n,e)&&(r=r.add(e))}),r},lf.prototype.La=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version.u(r))},lf.prototype.ka=function(t,e){return mr()<=l.DEBUG&&wr("QueryEngine","Using full collection scan to execute query:",ps(e)),this.Oa.Pc(t,e,Ei.min())},lf),hf=(ff.prototype.Fr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Ur(t,n.Ba)})},ff);function ff(t,e,n,r){this.persistence=t,this.$a=e,this.fe=r,this.Ba=new uu(Sr),this.qa=new uc(Io,Eo),this.Ua=Ei.min(),this.Ra=t.Ta(n),this.Qa=t._c(),this.Qc=t.ac(),this.Ka=new uf(this.Qa,this.Ra,this.persistence.Ia()),this.Wc=t.ma(),this.$a.Fa(this.Ka)}function lf(){}function pf(t,e,n,r){this.targetId=t,this.fromCache=e,this.Ca=n,this.xa=r}function df(t,e,n){this.Kc=t,this.Ra=e,this.To=n}function yf(t,e,n,r){return new hf(t,e,n,r)}function vf(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Ra,m=e.Ka,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.Ra.vo(v).next(function(t){return g=t,n=e.persistence.Ta(o),m=new uf(e.Qa,n,e.persistence.Ia()),n.vo(v)}).next(function(t){for(var e=[],n=[],r=Tu(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Va(v,r).next(function(t){return{Wa:t,ja:e,Ga:n}})})})];case 1:return r=t.sent(),[2,(e.Ra=n,e.Ka=m,e.$a.Fa(e.Ka),r)]}})})}function gf(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Qc.Wo(t)})}function mf(t,s,e,u,a){var n=Tu();return e.forEach(function(t){return n=n.add(t)}),s.getEntries(t,n).next(function(i){var o=mu;return e.forEach(function(t,e){var n=i.get(t),r=(null==a?void 0:a.get(t))||u;e instanceof po&&e.version.isEqual(Ei.min())?(s.mr(t,r),o=o.Ie(t,e)):null==n||0<e.version.u(n.version)||0===e.version.u(n.version)&&n.hasPendingWrites?(s.Er(e,r),o=o.Ie(t,e)):wr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o})}function wf(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Qc.ec(e,r).next(function(t){return t?(n=t,wa.resolve(n)):i.Qc.Uo(e).next(function(t){return n=new vs(r,t,0,e.oo),i.Qc.zo(e,n).next(function(){return n})})})}).then(function(t){var e=i.Ba.get(t.targetId);return(null===e||0<t.oe.u(e.oe))&&(i.Ba=i.Ba.Ie(t.targetId,t),i.qa.set(r,t.targetId)),t})}function bf(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).Ba.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Io.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Da(r=t.sent()))throw r;return wr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.Ba=e.Ba.remove(o),e.qa.delete(n.target),[2]}})})}function If(t,o,s){var u=t,a=Ei.min(),c=Tu();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=cs(o),(void 0!==(t=(i=t).qa.get(r))?wa.resolve(i.Ba.get(t)):i.Qc.ec(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.Qc.oc(e,t.targetId).next(function(t){c=t})}).next(function(){return u.$a.Pc(e,o,s?a:Ei.min(),s?c:Tu())}).next(function(t){return{documents:t,za:c}});var t,n,r,i})}function Ef(t,e){var n=t,r=n.Qc;return(t=n.Ba.get(e))?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Zn(t,e).next(function(t){return t?t.target:null})})}function _f(t){var s=t;return s.persistence.runTransaction("Get new document changes","readonly",function(t){return e=s.Qa,n=t,t=s.Ua,r=e,i=mu,o=sh(t),t=Yh(n),n=IDBKeyRange.lowerBound(o,!0),t.Fs({index:Gc.readTimeIndex,range:n},function(t,e){var n=ih(r.fe,e);i=i.Ie(n.key,n),o=e.readTime}).next(function(){return{tr:i,readTime:uh(o)}});var e,n,r,i,o}).then(function(t){var e=t.tr,t=t.readTime;return s.Ua=t,e})}var Tf,Af,Nf=(Hf.prototype.ao=function(t,e){return wa.resolve(this.Xa.get(e))},Hf.prototype.uo=function(t,e){return this.Xa.set(e.id,{id:e.id,version:e.version,createTime:Ju(e.createTime)}),wa.resolve()},Hf.prototype.ho=function(t,e){return wa.resolve(this.Za.get(e))},Hf.prototype.lo=function(t,e){return this.Za.set(e.name,{name:e.name,query:ph(e.bundledQuery),readTime:Ju(e.readTime)}),wa.resolve()},Hf),Sf=(zf.prototype.bt=function(){return this.tu.bt()},zf.prototype.sc=function(t,e){e=new Of(t,e),this.tu=this.tu.add(e),this.nu=this.nu.add(e)},zf.prototype.iu=function(t,e){var n=this;t.forEach(function(t){return n.sc(t,e)})},zf.prototype.rc=function(t,e){this.ru(new Of(t,e))},zf.prototype.ou=function(t,e){var n=this;t.forEach(function(t){return n.rc(t,e)})},zf.prototype.cu=function(t){var e=this,n=new Ni(new _i([])),r=new Of(n,t),t=new Of(n,t+1),i=[];return this.nu.Qe([r,t],function(t){e.ru(t),i.push(t.key)}),i},zf.prototype.au=function(){var e=this;this.tu.forEach(function(t){return e.ru(t)})},zf.prototype.ru=function(t){this.tu=this.tu.delete(t),this.nu=this.nu.delete(t)},zf.prototype.uu=function(t){var e=new Ni(new _i([])),n=new Of(e,t),t=new Of(e,t+1),r=Tu();return this.nu.Qe([n,t],function(t){r=r.add(t.key)}),r},zf.prototype.Mo=function(t){var e=new Of(t,0);return null!==(e=this.tu.We(e))&&t.isEqual(e.key)},zf),Of=(Gf.eu=function(t,e){return Ni.At(t.key,e.key)||Sr(t.hu,e.hu)},Gf.su=function(t,e){return Sr(t.hu,e.hu)||Ni.At(t.key,e.key)},Gf),Df=(Bf.prototype.Ro=function(t){return wa.resolve(0===this.Ra.length)},Bf.prototype.Po=function(t,e,n,r){var i=this.lu;this.lu++,0<this.Ra.length&&this.Ra[this.Ra.length-1],n=new oc(i,e,n,r),this.Ra.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this._u=this._u.add(new Of(u.key,i)),this.To.fo(t,u.key.path.yt())}return wa.resolve(n)},Bf.prototype.yo=function(t,e){return wa.resolve(this.fu(e))},Bf.prototype.po=function(t,e){return e+=1,e=(e=this.du(e))<0?0:e,wa.resolve(this.Ra.length>e?this.Ra[e]:null)},Bf.prototype.bo=function(){return wa.resolve(0===this.Ra.length?-1:this.lu-1)},Bf.prototype.vo=function(t){return wa.resolve(this.Ra.slice())},Bf.prototype.So=function(t,e){var n=this,r=new Of(e,0),e=new Of(e,Number.POSITIVE_INFINITY),i=[];return this._u.Qe([r,e],function(t){t=n.fu(t.hu),i.push(t)}),wa.resolve(i)},Bf.prototype.Do=function(t,e){var n=this,r=new vu(Sr);return e.forEach(function(t){var e=new Of(t,0),t=new Of(t,Number.POSITIVE_INFINITY);n._u.Qe([e,t],function(t){r=r.add(t.hu)})}),wa.resolve(this.wu(r))},Bf.prototype.xo=function(t,e){var n=e.path,r=n.length+1,e=n;Ni.qt(e)||(e=e.child(""));var e=new Of(new Ni(e),0),i=new vu(Sr);return this._u.Ke(function(t){var e=t.key.path;return!!n.vt(e)&&(e.length===r&&(i=i.add(t.hu)),!0)},e),wa.resolve(this.wu(i))},Bf.prototype.wu=function(t){var e=this,n=[];return t.forEach(function(t){null!==(t=e.fu(t))&&n.push(t)}),n},Bf.prototype.No=function(n,r){var i=this;Tr(0===this.Eu(r.batchId,"removed")),this.Ra.shift();var o=this._u;return wa.forEach(r.mutations,function(t){var e=new Of(t.key,r.batchId);return o=o.delete(e),i.Io.Oo(n,t.key)}).next(function(){i._u=o})},Bf.prototype.Fo=function(t){},Bf.prototype.Mo=function(t,e){var n=new Of(e,0),n=this._u.We(n);return wa.resolve(e.isEqual(n&&n.key))},Bf.prototype.ko=function(t){return this.Ra.length,wa.resolve()},Bf.prototype.Eu=function(t,e){return this.du(t)},Bf.prototype.du=function(t){return 0===this.Ra.length?0:t-this.Ra[0].batchId},Bf.prototype.fu=function(t){return(t=this.du(t))<0||t>=this.Ra.length?null:this.Ra[t]},Bf),xf=(qf.prototype.Er=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this.Tu(e);return this.docs=this.docs.Ie(r,{Ir:e,size:o,readTime:n}),this.size+=o-i,this.To.fo(t,r.path.yt())},qf.prototype.mr=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},qf.prototype.Ar=function(t,e){return e=this.docs.get(e),wa.resolve(e?e.Ir:null)},qf.prototype.getEntries=function(t,e){var n=this,r=mu;return e.forEach(function(t){var e=n.docs.get(t);r=r.Ie(t,e?e.Ir:null)}),wa.resolve(r)},qf.prototype.Pc=function(t,e,n){for(var r=Iu,i=new Ni(e.path.child("")),o=this.docs.Ve(i);o.Ce();){var s=(u=o.De()).key,u=(a=u.value).Ir,a=a.readTime;if(!e.path.vt(s.path))break;a.u(n)<=0||u instanceof lo&&ds(e,u)&&(r=r.Ie(u.key,u))}return wa.resolve(r)},qf.prototype.Iu=function(t,e){return wa.forEach(this.docs,function(t){return e(t)})},qf.prototype.lc=function(t){return new kf(this)},qf.prototype.dc=function(t){return wa.resolve(this.size)},qf),kf=(h(Ff,Af=o),Ff.prototype.yr=function(n){var r=this,i=[];return this._r.forEach(function(t,e){e&&e.Ir?i.push(r.gc.Er(n,e.Ir,r.wr(t))):r.gc.mr(t)}),wa.hs(i)},Ff.prototype.Rr=function(t,e){return this.gc.Ar(t,e)},Ff.prototype.Pr=function(t,e){return this.gc.getEntries(t,e)},Ff),Pf=(jf.prototype.Un=function(t,n){return this.mu.forEach(function(t,e){return n(e)}),wa.resolve()},jf.prototype.Wo=function(t){return wa.resolve(this.lastRemoteSnapshotVersion)},jf.prototype.jo=function(t){return wa.resolve(this.Au)},jf.prototype.Uo=function(t){return this.highestTargetId=this.Pu.next(),wa.resolve(this.highestTargetId)},jf.prototype.Go=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Au&&(this.Au=e),wa.resolve()},jf.prototype.Ho=function(t){this.mu.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Pu=new Rh(e),this.highestTargetId=e),t.sequenceNumber>this.Au&&(this.Au=t.sequenceNumber)},jf.prototype.zo=function(t,e){return this.Ho(e),this.targetCount+=1,wa.resolve()},jf.prototype.Yo=function(t,e){return this.Ho(e),wa.resolve()},jf.prototype.Xo=function(t,e){return this.mu.delete(e.target),this.Ru.cu(e.targetId),--this.targetCount,wa.resolve()},jf.prototype.Br=function(n,r,i){var o=this,s=0,u=[];return this.mu.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.mu.delete(t),u.push(o.Zo(n,e.targetId)),s++)}),wa.hs(u).next(function(){return s})},jf.prototype.tc=function(t){return wa.resolve(this.targetCount)},jf.prototype.ec=function(t,e){return e=this.mu.get(e)||null,wa.resolve(e)},jf.prototype.nc=function(t,e,n){return this.Ru.iu(e,n),wa.resolve()},jf.prototype.ic=function(e,t,n){this.Ru.ou(t,n);var r=this.persistence.Io,i=[];return r&&t.forEach(function(t){i.push(r.Oo(e,t))}),wa.hs(i)},jf.prototype.Zo=function(t,e){return this.Ru.cu(e),wa.resolve()},jf.prototype.oc=function(t,e){return e=this.Ru.uu(e),wa.resolve(e)},jf.prototype.Mo=function(t,e){return wa.resolve(this.Ru.Mo(e))},jf),Rf=(Mf.prototype.start=function(){return Promise.resolve()},Mf.prototype.$=function(){return this.Oc=!1,Promise.resolve()},Object.defineProperty(Mf.prototype,"Nr",{get:function(){return this.Oc},enumerable:!1,configurable:!0}),Mf.prototype.Xc=function(){},Mf.prototype.Zc=function(){},Mf.prototype.Ia=function(){return this.To},Mf.prototype.Ta=function(t){var e=this.yu[t.I()];return e||(e=new Df(this.To,this.Io),this.yu[t.I()]=e),e},Mf.prototype.ac=function(){return this.Qc},Mf.prototype._c=function(){return this.Kc},Mf.prototype.ma=function(){return this.Wc},Mf.prototype.runTransaction=function(t,e,n){var r=this;wr("MemoryPersistence","Starting transaction:",t);var i=new Lf(this.Fc.next());return this.Io.Vu(),n(i).next(function(t){return r.Io.pu(i).next(function(){return t})}).cs().then(function(t){return i.ki(),t})},Mf.prototype.bu=function(e,n){return wa.ls(Object.values(this.yu).map(function(t){return function(){return t.Mo(e,n)}}))},Mf),Lf=(h(Vf,Tf=me),Vf),Cf=(Uf.Du=function(t){return new Uf(t)},Object.defineProperty(Uf.prototype,"Cu",{get:function(){if(this.Su)return this.Su;throw _r()},enumerable:!1,configurable:!0}),Uf.prototype.sc=function(t,e,n){return this.vu.sc(n,e),this.Cu.delete(n.toString()),wa.resolve()},Uf.prototype.rc=function(t,e,n){return this.vu.rc(n,e),this.Cu.add(n.toString()),wa.resolve()},Uf.prototype.Oo=function(t,e){return this.Cu.add(e.toString()),wa.resolve()},Uf.prototype.removeTarget=function(t,e){var n=this;this.vu.cu(e.targetId).forEach(function(t){return n.Cu.add(t.toString())});var r=this.persistence.ac();return r.oc(t,e.targetId).next(function(t){t.forEach(function(t){return n.Cu.add(t.toString())})}).next(function(){return r.Xo(t,e)})},Uf.prototype.Vu=function(){this.Su=new Set},Uf.prototype.pu=function(n){var r=this,i=this.persistence._c().lc();return wa.forEach(this.Cu,function(t){var e=Ni.Lt(t);return r.xu(n,e).next(function(t){t||i.mr(e)})}).next(function(){return r.Su=null,i.apply(n)})},Uf.prototype.fc=function(t,e){var n=this;return this.xu(t,e).next(function(t){t?n.Cu.delete(e.toString()):n.Cu.add(e.toString())})},Uf.prototype.gu=function(t){return 0},Uf.prototype.xu=function(t,e){var n=this;return wa.ls([function(){return wa.resolve(n.vu.Mo(e))},function(){return n.persistence.ac().Mo(t,e)},function(){return n.persistence.bu(t,e)}])},Uf);function Uf(t){this.persistence=t,this.vu=new Sf,this.Su=null}function Vf(t){var e=this;return(e=Tf.call(this)||this).oo=t,e}function Mf(t,e){var n=this;this.yu={},this.Fc=new ec(0),this.Oc=!1,this.Oc=!0,this.Io=t(this),this.Qc=new Pf(this),this.To=new mh,this.Kc=(t=this.To,new xf(t,function(t){return n.Io.gu(t)})),this.fe=new rh(e),this.Wc=new Nf(this.fe)}function jf(t){this.persistence=t,this.mu=new uc(Io,Eo),this.lastRemoteSnapshotVersion=Ei.min(),this.highestTargetId=0,this.Au=0,this.Ru=new Sf,this.targetCount=0,this.Pu=Rh.Bo()}function Ff(t){var e=this;return(e=Af.call(this)||this).gc=t,e}function qf(t,e){this.To=t,this.Tu=e,this.docs=new uu(Ni.At),this.size=0}function Bf(t,e){this.To=t,this.Io=e,this.Ra=[],this.lu=1,this._u=new vu(Of.eu)}function Gf(t,e){this.key=t,this.hu=e}function zf(){this.tu=new vu(Of.eu),this.nu=new vu(Of.su)}function Hf(t){this.fe=t,this.Xa=new Map,this.Za=new Map}function Kf(t,e){return"firestore_clients_"+t+"_"+e}function Wf(t,e,n){return n="firestore_mutations_"+t+"_"+n,e.T()&&(n+="_"+e.uid),n}function Qf(t,e){return"firestore_targets_"+t+"_"+e}var Yf=(al.Nu=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Lr(r.error.code,r.error.message)),i?new al(t,e,r.state,o):(br("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},al.prototype.Fu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},al),Jf=(ul.Nu=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Lr(n.error.code,n.error.message)),r?new ul(t,n.state,i):(br("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},ul.prototype.Fu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},ul),Xf=(sl.Nu=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Au,o=0;r&&o<n.activeTargetIds.length;++o)r=hi(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new sl(t,i):(br("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},sl),$f=(ol.Nu=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new ol(e.clientId,e.onlineState):(br("SharedClientState","Failed to parse online state: "+t),null)},ol),Zf=(il.prototype.Ou=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},il.prototype.ku=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},il.prototype.Fu=function(){var t={activeTargetIds:this.activeTargetIds.Dt(),updateTimeMs:Date.now()};return JSON.stringify(t)},il),tl=(rl.G=function(t){return!(!t||!t.localStorage)},rl.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f=this;return v(this,function(t){switch(t.label){case 0:return[4,this.Lu.Ea()];case 1:for(s=t.sent(),e=0,n=s;e<n.length;e++)(r=n[e])!==this.Mu&&(i=this.getItem(Kf(this.persistenceKey,r)))&&(o=Xf.Nu(r,i))&&(this.Uu=this.Uu.Ie(o.clientId,o));for(this.Yu(),(s=this.storage.getItem(this.Hu))&&(u=this.Xu(s))&&this.Zu(u),a=0,c=this.Qu;a<c.length;a++)h=c[a],this.qu(h);return this.Qu=[],this.window.addEventListener("unload",function(){return f.$()}),this.Nr=!0,[2]}})})},rl.prototype.Xi=function(t){this.setItem(this.Wu,JSON.stringify(t))},rl.prototype.th=function(){return this.eh(this.Uu)},rl.prototype.nh=function(n){var r=!1;return this.Uu.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},rl.prototype.sh=function(t){this.ih(t,"pending")},rl.prototype.rh=function(t,e,n){this.ih(t,e,n),this.oh(t)},rl.prototype.ah=function(t){var e,n="not-current";return this.nh(t)&&(!(e=this.storage.getItem(Qf(this.persistenceKey,t)))||(e=Jf.Nu(t,e))&&(n=e.state)),this.uh.Ou(t),this.Yu(),n},rl.prototype.hh=function(t){this.uh.ku(t),this.Yu()},rl.prototype.lh=function(t){return this.uh.activeTargetIds.has(t)},rl.prototype._h=function(t){this.removeItem(Qf(this.persistenceKey,t))},rl.prototype.fh=function(t,e,n){this.dh(t,e,n)},rl.prototype.wh=function(t,e,n){var r=this;e.forEach(function(t){r.oh(t)}),this.currentUser=t,n.forEach(function(t){r.sh(t)})},rl.prototype.Eh=function(t){this.Th(t)},rl.prototype.Ih=function(){this.mh()},rl.prototype.$=function(){this.Nr&&(this.window.removeEventListener("storage",this.Bu),this.removeItem(this.Ku),this.Nr=!1)},rl.prototype.getItem=function(t){var e=this.storage.getItem(t);return wr("SharedClientState","READ",t,e),e},rl.prototype.setItem=function(t,e){wr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},rl.prototype.removeItem=function(t){wr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},rl.prototype.qu=function(t){var e=this,o=t;o.storageArea===this.storage&&(wr("SharedClientState","EVENT",o.key,o.newValue),o.key!==this.Ku?this.js.ea(function(){return y(e,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){if(this.Nr){if(null!==o.key)if(this.ju.test(o.key)){if(null==o.newValue)return e=this.Ah(o.key),[2,this.Rh(e,null)];if(e=this.Ph(o.key,o.newValue))return[2,this.Rh(e.clientId,e)]}else if(this.Gu.test(o.key)){if(null!==o.newValue&&(n=this.yh(o.key,o.newValue)))return[2,this.gh(n)]}else if(this.zu.test(o.key)){if(null!==o.newValue&&(r=this.Vh(o.key,o.newValue)))return[2,this.ph(r)]}else if(o.key===this.Hu){if(null!==o.newValue&&(i=this.Xu(o.newValue)))return[2,this.Zu(i)]}else if(o.key===this.Wu)(i=function(t){var e=ec.Zi;if(null!=t)try{var n=JSON.parse(t);Tr("number"==typeof n),e=n}catch(t){br("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(o.newValue))!==ec.Zi&&this.Hi(i);else if(o.key===this.Ju)return[2,this.Lu.bh()]}else this.Qu.push(o);return[2]})})}):br("Received WebStorage notification for local change. Another client might have garbage-collected our state"))},Object.defineProperty(rl.prototype,"uh",{get:function(){return this.Uu.get(this.Mu)},enumerable:!1,configurable:!0}),rl.prototype.Yu=function(){this.setItem(this.Ku,this.uh.Fu())},rl.prototype.ih=function(t,e,n){n=new Yf(this.currentUser,t,e,n),t=Wf(this.persistenceKey,this.currentUser,t),this.setItem(t,n.Fu())},rl.prototype.oh=function(t){t=Wf(this.persistenceKey,this.currentUser,t),this.removeItem(t)},rl.prototype.Th=function(t){t={clientId:this.Mu,onlineState:t},this.storage.setItem(this.Hu,JSON.stringify(t))},rl.prototype.dh=function(t,e,n){var r=Qf(this.persistenceKey,t),n=new Jf(t,e,n);this.setItem(r,n.Fu())},rl.prototype.mh=function(){this.setItem(this.Ju,"value-not-used")},rl.prototype.Ah=function(t){return(t=this.ju.exec(t))?t[1]:null},rl.prototype.Ph=function(t,e){return t=this.Ah(t),Xf.Nu(t,e)},rl.prototype.yh=function(t,e){var n=this.Gu.exec(t),t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return Yf.Nu(new Gr(n),t,e)},rl.prototype.Vh=function(t,e){return t=this.zu.exec(t),t=Number(t[1]),Jf.Nu(t,e)},rl.prototype.Xu=function(t){return $f.Nu(t)},rl.prototype.gh=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.Lu.Sh(e.batchId,e.state,e.error)]:(wr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},rl.prototype.ph=function(t){return this.Lu.Dh(t.targetId,t.state,t.error)},rl.prototype.Rh=function(t,e){var n=this,r=e?this.Uu.Ie(t,e):this.Uu.remove(t),i=this.eh(this.Uu),o=this.eh(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.Lu.Ch(s,u).then(function(){n.Uu=r})},rl.prototype.Zu=function(t){this.Uu.get(t.clientId)&&this.$u(t.onlineState)},rl.prototype.eh=function(t){var n=Au;return t.forEach(function(t,e){n=n.je(e.activeTargetIds)}),n},rl),el=(nl.prototype.sh=function(t){},nl.prototype.rh=function(t,e,n){},nl.prototype.ah=function(t){return this.xh.Ou(t),this.Nh[t]||"not-current"},nl.prototype.fh=function(t,e,n){this.Nh[t]=e},nl.prototype.hh=function(t){this.xh.ku(t)},nl.prototype.lh=function(t){return this.xh.activeTargetIds.has(t)},nl.prototype._h=function(t){delete this.Nh[t]},nl.prototype.th=function(){return this.xh.activeTargetIds},nl.prototype.nh=function(t){return this.xh.activeTargetIds.has(t)},nl.prototype.start=function(){return this.xh=new Zf,Promise.resolve()},nl.prototype.wh=function(t,e,n){},nl.prototype.Eh=function(t){},nl.prototype.$=function(){},nl.prototype.Xi=function(t){},nl.prototype.Ih=function(){},nl);function nl(){this.xh=new Zf,this.Nh={},this.$u=null,this.Hi=null}function rl(t,e,n,r,i){this.window=t,this.js=e,this.persistenceKey=n,this.Mu=r,this.Lu=null,this.$u=null,this.Hi=null,this.Bu=this.qu.bind(this),this.Uu=new uu(Sr),this.Nr=!1,this.Qu=[],n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),this.storage=this.window.localStorage,this.currentUser=i,this.Ku=Kf(this.persistenceKey,this.Mu),this.Wu="firestore_sequence_number_"+this.persistenceKey,this.Uu=this.Uu.Ie(this.Mu,new Zf),this.ju=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.Gu=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.zu=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.Hu="firestore_online_state_"+this.persistenceKey,this.Ju="firestore_bundle_loaded_"+this.persistenceKey,this.window.addEventListener("storage",this.Bu)}function il(){this.activeTargetIds=Au}function ol(t,e){this.clientId=t,this.onlineState=e}function sl(t,e){this.clientId=t,this.activeTargetIds=e}function ul(t,e,n){this.targetId=t,this.state=e,this.error=n}function al(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function cl(){return"undefined"!=typeof window?window:null}function hl(){return"undefined"!=typeof document?document:null}function fl(t,e,n,r,i){var o=this;this.Uh=t,this.Qh=e,this.ks=n,this.Kh={},this.Wh=[],this.jh=new Map,this.Gh=new Set,this.zh=[],this.Hh=i,this.Hh.L(function(t){n.Ws(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return El(this)?(wr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Gh.add(4),[4,yl(e)];case 1:return t.sent(),e.Jh.set("Unknown"),e.Gh.delete(4),[4,dl(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Jh=new ll(n,r)}var ll=(pl.prototype.Mh=function(){var t=this;0===this.Fh&&(this.Lh("Unknown"),this.Oh=this.ks.ni("online_state_timeout",1e4,function(){return t.Oh=null,t.$h("Backend didn't respond within 10 seconds."),t.Lh("Offline"),Promise.resolve()}))},pl.prototype.Bh=function(t){"Online"===this.state?this.Lh("Unknown"):(this.Fh++,1<=this.Fh&&(this.qh(),this.$h("Connection failed 1 times. Most recent error: "+t.toString()),this.Lh("Offline")))},pl.prototype.set=function(t){this.qh(),this.Fh=0,"Online"===t&&(this.kh=!1),this.Lh(t)},pl.prototype.Lh=function(t){t!==this.state&&(this.state=t,this.$u(t))},pl.prototype.$h=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.kh?(br(t),this.kh=!1):wr("OnlineStateTracker",t)},pl.prototype.qh=function(){null!==this.Oh&&(this.Oh.cancel(),this.Oh=null)},pl);function pl(t,e){this.ks=t,this.$u=e,this.state="Unknown",this.Fh=0,this.Oh=null,this.kh=!0}function dl(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!El(r))return[3,4];e=0,n=r.zh,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function yl(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.zh,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function vl(t,e){t.jh.has(e.targetId)||(t.jh.set(e.targetId,e),Il(t)?bl(t):xl(t).li()&&ml(t,e))}function gl(t,e){var n=t,t=xl(n);n.jh.delete(e),t.li()&&wl(n,e),0===n.jh.size&&(t.li()?t.di():El(n)&&n.Jh.set("Unknown"))}function ml(t,e){t.Yh.Dn(e.targetId),xl(t).gi(e)}function wl(t,e){t.Yh.Dn(e),xl(t).Vi(e)}function bl(e){e.Yh=new Cu({Xn:function(t){return e.Kh.Xn(t)},Zn:function(t){return e.jh.get(t)||null}}),xl(e).start(),e.Jh.Mh()}function Il(t){return El(t)&&!xl(t).hi()&&0<t.jh.size}function El(t){return 0===t.Gh.size}function _l(t){t.Yh=void 0}function Tl(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!Da(r))throw r;return n.Gh.add(1),[4,yl(n)];case 1:return t.sent(),n.Jh.set("Offline"),i=i||function(){return gf(n.Uh)},n.ks.ea(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return wr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Gh.delete(1),[4,dl(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function Al(e,n){return n().catch(function(t){return Tl(e,t,n)})}function Nl(c){return y(this,void 0,void 0,function(){var o,s,u,a;return v(this,function(t){switch(t.label){case 0:s=kl(o=c),u=0<o.Wh.length?o.Wh[o.Wh.length-1].batchId:-1,t.label=1;case 1:if(!(El(o)&&o.Wh.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(n=o.Uh,r=u,(i=n).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===r&&(r=-1),i.Ra.po(t,r)}))];case 3:return null===(a=t.sent())?(0===o.Wh.length&&s.di(),[3,7]):(u=a.batchId,e=a,(n=o).Wh.push(e),(n=kl(n)).li()&&n.bi&&n.vi(e.mutations),[3,6]);case 4:return a=t.sent(),[4,Tl(o,a)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Sl(o)&&Ol(o),[2]}var e,n,r,i})})}function Sl(t){return El(t)&&!kl(t).hi()&&0<t.Wh.length}function Ol(t){kl(t).start()}function Dl(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Gh.delete(2),[4,dl(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Gh.add(2),[4,yl(e)]);case 3:t.sent(),e.Jh.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function xl(n){var t,e,r,i=this;return n.nl||(n.nl=(t=n.Qh,e=n.ks,r={Y:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.jh.forEach(function(t,e){ml(n,t)}),[2]})})}.bind(null,n),Z:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return _l(e),Il(e)?(e.Jh.Bh(n),bl(e)):e.Jh.set("Unknown"),[2]})})}.bind(null,n),yi:function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Jh.set("Online"),!(u instanceof Ru&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.jh.has(i)?[4,o.Kh.Xh(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.jh.delete(i),o.Yh.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),wr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,Tl(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof ku?s.Yh.Ln(u):u instanceof Pu?s.Yh.jn(u):s.Yh.qn(u),a.isEqual(Ei.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,gf(s.Uh)];case 8:return o=t.sent(),0<=a.u(o)?[4,(i=a,(e=(r=s).Yh.Hn(i)).rn.forEach(function(t,e){var n;0<t.resumeToken.o()&&(n=r.jh.get(e))&&r.jh.set(e,n.ae(t.resumeToken,i))}),e.on.forEach(function(t){var e=r.jh.get(t);e&&(r.jh.set(t,e.ae(xr.h,e.oe)),wl(r,t),e=new vs(e.target,t,1,e.sequenceNumber),ml(r,e))}),r.Kh.Zh(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return wr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,Tl(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n)},t.Ni(),new Ba(e,t.ri,t.credentials,t.fe,r)),n.zh.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.nl.fi(),Il(n)?bl(n):n.Jh.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.nl.stop()];case 2:t.sent(),_l(n),t.label=3;case 3:return[2]}})})})),n.nl}function kl(n){var t,e,r,i=this;return n.sl||(n.sl=(t=n.Qh,e=n.ks,r={Y:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return kl(e).Ci(),[2]})})}.bind(null,n),Z:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&kl(e).bi?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return pi(n=i.code)&&n!==Rr.ABORTED?(e=r.Wh.shift(),kl(r).fi(),[4,Al(r,function(){return r.Kh.el(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,Nl(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Sl(e)&&Ol(e),[2]}})})}.bind(null,n),Di:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=kl(o),n=0,r=o.Wh;n<r.length;n++)i=r[n],e.vi(i.mutations);return[2]})})}.bind(null,n),Si:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Wh.shift(),n=sc.from(e,i,o),[4,Al(r,function(){return r.Kh.tl(n)})];case 1:return t.sent(),[4,Nl(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Ni(),new Ga(e,t.ri,t.credentials,t.fe,r)),n.zh.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.sl.fi(),[4,Nl(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.sl.stop()];case 3:t.sent(),0<n.Wh.length&&(wr("RemoteStore","Stopping write stream with "+n.Wh.length+" pending writes"),n.Wh=[]),t.label=4;case 4:return[2]}})})})),n.sl}function Pl(){this.queries=new uc(ls,fs),this.onlineState="Unknown",this.rl=new Set}var Rl=function(){this.il=void 0,this.listeners=[]};function Ll(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new Rl),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.ol(n)];case 2:return o.il=t.sent(),[3,4];case 3:return o=Va(o=t.sent(),"Initialization of query '"+ps(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.cl(e.onlineState),i.il&&u.al(i.il)&&Ul(e),[2]}})})}function Cl(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.ul(n))]:[2]})})}function Ul(t){t.rl.forEach(function(t){t.next()})}var Vl=(zl.prototype.al=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Ou(t.query,t.docs,t.Ze,e,t.tn,t.fromCache,t.en,!0)}var o=!1;return this.ll?this.fl(t)&&(this.hl.next(t),o=!0):this.dl(t,this.onlineState)&&(this.wl(t),o=!0),this._l=t,o},zl.prototype.onError=function(t){this.hl.error(t)},zl.prototype.cl=function(t){this.onlineState=t;var e=!1;return this._l&&!this.ll&&this.dl(this._l,t)&&(this.wl(this._l),e=!0),e},zl.prototype.dl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.El&&n||t.docs.bt()&&"Offline"!==e)},zl.prototype.fl=function(t){if(0<t.docChanges.length)return!0;var e=this._l&&this._l.hasPendingWrites!==t.hasPendingWrites;return!(!t.en&&!e)&&!0===this.options.includeMetadataChanges},zl.prototype.wl=function(t){t=Ou.sn(t.query,t.docs,t.tn,t.fromCache),this.ll=!0,this.hl.next(t)},zl),Ml=(Gl.prototype.Tl=function(){return"metadata"in this.payload},Gl),jl=(Bl.prototype.Ha=function(t){return ta(this.fe,t)},Bl.prototype.Ja=function(t){return t.metadata.exists?sa(this.fe,t.document,!1):new po(this.Ha(t.metadata.name),this.Ya(t.metadata.readTime))},Bl.prototype.Ya=Ju,Bl),Fl=(ql.prototype.ml=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},ql.prototype.Al=function(t){for(var e=new Map,n=new jl(this.fe),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.Ha(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||Tu()).add(s);e.set(c,h)}}return e},ql.prototype.complete=function(){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return[4,function(f,l,p,d){return y(this,void 0,void 0,function(){var n,r,i,o,e,s,u,a,c,h;return v(this,function(t){switch(t.label){case 0:for(n=f,r=Tu(),i=mu,o=Eu,e=0,s=p;e<s.length;e++)u=s[e],a=l.Ha(u.metadata.name),u.document&&(r=r.add(a)),i=i.Ie(a,l.Ja(u)),o=o.Ie(a,l.Ya(u.metadata.readTime));return c=n.Qa.lc({yc:!0}),[4,wf(n,cs(ns(_i.xt("__bundle__/docs/"+d))))];case 1:return h=t.sent(),[2,n.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return mf(e,c,i,Ei.min(),o).next(function(t){return c.apply(e),t}).next(function(t){return n.Qc.Zo(e,h.targetId).next(function(){return n.Qc.nc(e,r,h.targetId)}).next(function(){return n.Ka.pa(e,t)})})})]}})})}(this.Uh,new jl(this.fe),this.documents,this.Il.id)];case 1:e=t.sent(),n=this.Al(this.documents),r=0,i=this.queries,t.label=2;case 2:return r<i.length?(i=i[r],[4,function(e,i,o){return void 0===o&&(o=Tu()),y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return[4,wf(e,cs(ph(i.bundledQuery)))];case 1:return n=t.sent(),[2,(r=e).persistence.runTransaction("Save named query","readwrite",function(t){var e=Ju(i.readTime);return 0<=n.oe.u(e)?r.Wc.lo(t,i):(e=n.ae(xr.h,e),r.Ba=r.Ba.Ie(e.targetId,e),r.Qc.Yo(t,e).next(function(){return r.Qc.Zo(t,n.targetId)}).next(function(){return r.Qc.nc(t,o,n.targetId)}).next(function(){return r.Wc.lo(t,i)}))})]}})})}(this.Uh,i,n.get(i.name))]):[3,5];case 3:t.sent(),t.label=4;case 4:return r++,[3,2];case 5:return[2,(this.progress.taskState="Success",new ic(Object.assign({},this.progress),e))]}})})},ql);function ql(t,e,n){this.Il=t,this.Uh=e,this.fe=n,this.queries=[],this.documents=[],this.progress=Hl(t)}function Bl(t){this.fe=t}function Gl(t,e){this.payload=t,this.byteLength=e}function zl(t,e,n){this.query=t,this.hl=e,this.ll=!1,this._l=null,this.onlineState="Unknown",this.options=n||{}}function Hl(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var Kl=function(t){this.key=t},Wl=function(t){this.key=t},Ql=(Object.defineProperty(Zl.prototype,"pl",{get:function(){return this.Rl},enumerable:!1,configurable:!0}),Zl.prototype.bl=function(t,e){var s=this,u=e?e.vl:new Su,a=(e||this).Vl,c=(e||this).tn,h=a,f=!1,l=rs(this.query)&&a.size===this.query.limit?a.last():null,p=is(this.query)&&a.size===this.query.limit?a.first():null;if(t.Pe(function(t,e){var n=a.get(t),r=(r=e instanceof lo?e:null)&&(ds(s.query,r)?r:null),i=!!n&&s.tn.has(n.key),o=!!r&&(r.Jt||s.tn.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.Sl(n,r)||(u.track({type:2,doc:r}),e=!0,(l&&0<s.gl(r,l)||p&&s.gl(r,p)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(l||p)&&(f=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),rs(this.query)||is(this.query))for(;h.size>this.query.limit;){var n=rs(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{Vl:h,vl:u,La:f,tn:c}},Zl.prototype.Sl=function(t,e){return t.Jt&&e.hasCommittedMutations&&!e.Jt},Zl.prototype.yr=function(t,e,n){var o=this,r=this.Vl;this.Vl=t.Vl,this.tn=t.tn;var i=t.vl.Xe();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.gl(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return _r()}}var r,i}),this.Dl(n);var s=e?this.Cl():[],e=(n=0===this.yl.size&&this.ln?1:0)!==this.Pl;return this.Pl=n,0!==i.length||e?{snapshot:new Ou(this.query,t.Vl,r,i,t.tn,0==n,e,!1),xl:s}:{xl:s}},Zl.prototype.cl=function(t){return this.ln&&"Offline"===t?(this.ln=!1,this.yr({Vl:this.Vl,vl:new Su,tn:this.tn,La:!1},!1)):{xl:[]}},Zl.prototype.Nl=function(t){return!this.Rl.has(t)&&!!this.Vl.has(t)&&!this.Vl.get(t).Jt},Zl.prototype.Dl=function(t){var e=this;t&&(t._n.forEach(function(t){return e.Rl=e.Rl.add(t)}),t.fn.forEach(function(t){}),t.dn.forEach(function(t){return e.Rl=e.Rl.delete(t)}),this.ln=t.ln)},Zl.prototype.Cl=function(){var e=this;if(!this.ln)return[];var n=this.yl;this.yl=Tu(),this.Vl.forEach(function(t){e.Nl(t.key)&&(e.yl=e.yl.add(t.key))});var r=[];return n.forEach(function(t){e.yl.has(t)||r.push(new Wl(t))}),this.yl.forEach(function(t){n.has(t)||r.push(new Kl(t))}),r},Zl.prototype.Fl=function(t){return this.Rl=t.za,this.yl=Tu(),t=this.bl(t.documents),this.yr(t,!0)},Zl.prototype.Ol=function(){return Ou.sn(this.query,this.Vl,this.tn,0===this.Pl)},Zl),Yl=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Jl=function(t){this.key=t,this.kl=!1},Xl=(Object.defineProperty($l.prototype,"Xl",{get:function(){return!0===this.Yl},enumerable:!1,configurable:!0}),$l);function $l(t,e,n,r,i,o){this.Uh=t,this.Ml=e,this.Ll=n,this.$l=r,this.currentUser=i,this.Bl=o,this.ql={},this.Ul=new uc(ls,fs),this.Ql=new Map,this.Kl=[],this.Wl=new uu(Ni.At),this.jl=new Map,this.Gl=new Sf,this.zl={},this.Hl=new Map,this.Jl=Rh.qo(),this.onlineState="Unknown",this.Yl=void 0}function Zl(t,e){this.query=t,this.Rl=e,this.Pl=null,this.ln=!1,this.yl=Tu(),this.tn=Tu(),this.gl=ys(t),this.Vl=new Nu(this.gl)}function tp(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Zl=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.bl(o)).La?[4,If(r.Uh,i.query,!1).then(function(t){return t=t.documents,i.view.bl(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.rn.get(i.targetId),n=i.view.yr(e,r.Xl,n),[2,(cp(r,i.targetId,n.xl),n.snapshot)]}})})}(i,t,e,n)},[4,If(i.Uh,o,!0)];case 1:return n=t.sent(),r=new Ql(o,n.za),e=r.bl(n.documents),n=xu.hn(s,u&&"Offline"!==i.onlineState),n=r.yr(e,i.Xl,n),cp(i,s,n.xl),r=new Yl(o,s,r),[2,(i.Ul.set(o,r),i.Ql.has(s)?i.Ql.get(s).push(o):i.Ql.set(s,[o]),n.snapshot)]}})})}function ep(l,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:u=yp(l),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(i=u.Uh,a=p,h=i,f=Ii.now(),o=a.reduce(function(t,e){return t.add(e.key)},Tu()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.Ka.Va(u,o).next(function(t){c=t;for(var e,n=[],r=0,i=a;r<i.length;r++){var o=i[r],s=(e=o,s=c.get(o.key),void 0!==e.fieldTransforms?function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof lo?e.field(o.field):void 0;null!=(s=Is(o.transform,s||null))&&(n=(null==n?new so:n).set(o.field,s))}return n?n.Gt():null}(e.fieldTransforms,s):null);null!=s&&n.push(new Ys(o.key,s,function s(t){var u=[];return Vi(t.fields||{},function(t,e){var n=new Ai([t]);if(io(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new ji(u)}(s.proto.mapValue),Fs.exists(!0)))}return h.Ra.Po(u,f,n,a)})}).then(function(t){var e=t.rr(c);return{batchId:t.batchId,_r:e}}))];case 2:return s=t.sent(),u.$l.sh(s.batchId),e=u,n=s.batchId,r=d,i=(i=(i=e.zl[e.currentUser.I()])||new uu(Sr)).Ie(n,r),e.zl[e.currentUser.I()]=i,[4,fp(u,s._r)];case 3:return t.sent(),[4,Nl(u.Ml)];case 4:return t.sent(),[3,6];case 5:return u=Va(u=t.sent(),"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,i,a,c,h,f,o})})}function np(o,s){return y(this,void 0,void 0,function(){var n,i;return v(this,function(t){switch(t.label){case 0:n=o,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Uh,a=e,c=(r=s).oe,h=a.Ba,a.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=a.Qa.lc({yc:!0});h=a.Ba;var u=[];r.rn.forEach(function(t,e){var n,r,i,o=h.get(e);o&&(u.push(a.Qc.ic(s,t.dn,e).next(function(){return a.Qc.nc(s,t._n,e)})),0<(i=t.resumeToken).o()&&(n=o.ae(i,c).ce(s.oo),h=h.Ie(e,n),r=o,i=t,Tr(0<(o=n).resumeToken.o()),(0===r.resumeToken.o()||3e8<=o.oe.Et()-r.oe.Et()||0<i._n.size+i.fn.size+i.dn.size)&&u.push(a.Qc.Yo(s,n))))});var e,n=mu;return r.cn.forEach(function(t,e){r.an.has(t)&&u.push(a.persistence.Io.fc(s,t))}),u.push(mf(s,t,r.cn,c,void 0).next(function(t){n=t})),c.isEqual(Ei.min())||(e=a.Qc.Wo(s).next(function(t){return a.Qc.Go(s,s.oo,c)}),u.push(e)),wa.hs(u).next(function(){return t.apply(s)}).next(function(){return a.Ka.pa(s,n)})}).then(function(t){return a.Ba=h,t}))];case 2:return i=t.sent(),s.rn.forEach(function(t,e){(e=n.jl.get(e))&&(Tr(t._n.size+t.fn.size+t.dn.size<=1),0<t._n.size?e.kl=!0:0<t.fn.size?Tr(e.kl):0<t.dn.size&&(Tr(e.kl),e.kl=!1))}),[4,fp(n,i,s)];case 3:return t.sent(),[3,6];case 4:return[4,rc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,a,c,h})})}function rp(t,n,e){var r;((t=t).Xl&&0===e||!t.Xl&&1===e)&&(r=[],t.Ul.forEach(function(t,e){(e=e.view.cl(n)).snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].cl(i)&&(o=!0)}),o&&Ul(t)}(t.Ll,n),r.length&&t.ql.yi(r),t.onlineState=n,t.Xl&&t.$l.Eh(n))}function ip(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:El((n=o).Ml)||wr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Uh).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Ra.bo(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Hl.get(r)||[]).push(s),n.Hl.set(r,i),[3,4]);case 3:return i=Va(i=t.sent(),"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function op(t,e){(t.Hl.get(e)||[]).forEach(function(t){t.resolve()}),t.Hl.delete(e)}function sp(t,e,n){var r=t,i=r.zl[r.currentUser.I()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.zl[r.currentUser.I()]=i)}function up(e,t,n){void 0===n&&(n=null),e.$l.hh(t);for(var r=0,i=e.Ql.get(t);r<i.length;r++){var o=i[r];e.Ul.delete(o),n&&e.ql.t_(o,n)}e.Ql.delete(t),e.Xl&&e.Gl.cu(t).forEach(function(t){e.Gl.Mo(t)||ap(e,t)})}function ap(t,e){var n=t.Wl.get(e);null!==n&&(gl(t.Ml,n),t.Wl=t.Wl.remove(e),t.jl.delete(n),hp(t))}function cp(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var u=s[o];u instanceof Kl?(t.Gl.sc(u.key,e),r=t,i=(i=u).key,r.Wl.get(i)||(wr("SyncEngine","New document in limbo: "+i),r.Kl.push(i),hp(r))):u instanceof Wl?(wr("SyncEngine","Document no longer in limbo: "+u.key),t.Gl.rc(u.key,e),t.Gl.Mo(u.key)||ap(t,u.key)):_r()}}function hp(t){for(;0<t.Kl.length&&t.Wl.size<t.Bl;){var e=t.Kl.shift(),n=t.Jl.next();t.jl.set(n,new Jl(e)),t.Wl=t.Wl.Ie(e,n),vl(t.Ml,new vs(cs(ns(e.path)),n,2,ec.Zi))}}function fp(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Ul.bt()?[3,3]:(n.Ul.forEach(function(t,e){o.push(n.Zl(e,s,u).then(function(t){t&&(n.Xl&&n.$l.fh(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=af.Na(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.ql.yi(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return wa.forEach(c,function(e){return wa.forEach(e.Ca,function(t){return r.persistence.Io.sc(n,e.targetId,t)}).next(function(){return wa.forEach(e.xa,function(t){return r.persistence.Io.rc(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Da(e=t.sent()))throw e;return wr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.Ba.get(o),u=s.oe,u=s.ue(u),r.Ba=r.Ba.Ie(o,u));return[2]}})})}(n.Uh,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function lp(p,d){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l;return v(this,function(t){switch(t.label){case 0:e=p,n=[],r=[],i=0,o=d,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.Ql.get(s))&&0!==a.length?[4,wf(e.Uh,cs(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(f=h[c],f=e.Ul.get(f),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,If((e=r).Uh,i.query,!0)];case 1:return n=t.sent(),n=i.view.Fl(n),[2,(e.Xl&&cp(e,i.targetId,n.xl),n)]}})})}(e,f)]):[3,6];case 4:(f=t.sent()).snapshot&&r.push(f.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,Ef(e.Uh,s)];case 8:return l=t.sent(),[4,wf(e.Uh,l)];case 9:return u=t.sent(),[4,tp(e,pp(l),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.ql.yi(r),n)]}})})}function pp(t){return es(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function dp(t){return t.Ml.Kh.Zh=np.bind(null,t),t.Ml.Kh.Xn=function(t,e){var n=t;if((t=n.jl.get(e))&&t.kl)return Tu().add(t.key);var r=Tu();if(!(e=n.Ql.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Ul.get(s),r=r.je(s.view.pl);return r}.bind(null,t),t.Ml.Kh.Xh=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).$l.fh(s,"rejected",u),i=e.jl.get(s),(n=i&&i.key)?(r=(r=new uu(Ni.At)).Ie(n,new po(n,Ei.min())),i=Tu().add(n),i=new Du(Ei.min(),new Map,new vu(Sr),r,i),[4,np(e,i)]):[3,2];case 1:return t.sent(),e.Wl=e.Wl.remove(n),e.jl.delete(s),hp(e),[3,4];case 2:return[4,bf(e.Uh,s,!1).then(function(){return up(e,s,u)}).catch(rc)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,t),t.ql.yi=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query;if(u=n.queries.get(u)){for(var a=0,c=u.listeners;a<c.length;a++)c[a].al(s)&&(r=!0);u.il=s}}r&&Ul(n)}.bind(null,t.Ll),t.ql.t_=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,t.Ll),t}function yp(t){return t.Ml.Kh.tl=function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Uh,h=s,(f=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=h.batch.keys(),n=f.Qa.lc({yc:!0}),i=f,o=t,s=n,u=(r=h).batch,a=u.keys(),c=wa.resolve();return a.forEach(function(n){c=c.next(function(){return s.Ar(o,n)}).next(function(t){var e=t;Tr(null!==(t=r.ar.get(n))),(!e||e.version.u(t)<0)&&(e=u.nr(n,e,r))&&s.Er(e,r.cr)})}),c.next(function(){return i.Ra.No(o,u)}).next(function(){return n.apply(t)}).next(function(){return f.Ra.ko(t)}).next(function(){return f.Ka.Va(t,e)})}))];case 2:return i=t.sent(),sp(n,r,null),op(n,r),n.$l.rh(r,"acknowledged"),[4,fp(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,rc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,h,f})})}.bind(null,t),t.Ml.Kh.el=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Uh,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Ra.yo(e,r).next(function(t){return Tr(null!==t),n=t.keys(),i.Ra.No(e,t)}).next(function(){return i.Ra.ko(e)}).next(function(){return i.Ka.Va(e,n)})}))];case 2:return o=t.sent(),sp(n,u,a),op(n,u),n.$l.rh(u,"rejected",a),[4,fp(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,rc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,t),t}function vp(t,e,n){var r=t;(function(l,p,d){return y(this,void 0,void 0,function(){var u,a,c,h,f;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,14,,15]),[4,p.getMetadata()];case 1:return u=t.sent(),[4,(r=l.Uh,o=r,s=Ju((i=u).createTime),o.persistence.runTransaction("hasNewerBundle","readonly",function(t){return o.Wc.ao(t,i.id)}).then(function(t){return!!t&&0<=t.createTime.u(s)}))];case 2:return t.sent()?[4,p.close()]:[3,4];case 3:return[2,(t.sent(),void d.e_({taskState:"Success",documentsLoaded:u.totalDocuments,bytesLoaded:u.totalBytes,totalDocuments:u.totalDocuments,totalBytes:u.totalBytes}))];case 4:return d.n_(Hl(u)),a=new Fl(u,l.Uh,p.fe),[4,p.s_()];case 5:c=t.sent(),t.label=6;case 6:return c?[4,a.ml(c)]:[3,10];case 7:return(h=t.sent())&&d.n_(h),[4,p.s_()];case 8:c=t.sent(),t.label=9;case 9:return[3,6];case 10:return[4,a.complete()];case 11:return f=t.sent(),[4,fp(l,f.tr,void 0)];case 12:return t.sent(),[4,(r=l.Uh,e=u,(n=r).persistence.runTransaction("Save bundle","readwrite",function(t){return n.Wc.uo(t,e)}))];case 13:return t.sent(),d.e_(f.progress),[3,15];case 14:return Ir("SyncEngine","Loading bundle failed with "+(f=t.sent())),d.i_(f),[3,15];case 15:return[2]}var e,n,r,i,o,s})})})(r,e,n).then(function(){r.$l.Ih()})}var gp,mp,wp=(Np.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.fe=ga(e.rt.O),this.$l=this.r_(e),this.persistence=this.o_(e),[4,this.persistence.start()];case 1:return t.sent(),this.c_=this.a_(e),this.Uh=this.u_(e),[2]}})})},Np.prototype.a_=function(t){return null},Np.prototype.u_=function(t){return yf(this.persistence,new cf,t.h_,this.fe)},Np.prototype.o_=function(t){return new Rf(Cf.Du,this.fe)},Np.prototype.r_=function(t){return new el},Np.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.c_&&this.c_.stop(),[4,this.$l.$()];case 1:return t.sent(),[4,this.persistence.$()];case 2:return t.sent(),[2]}})})},Np),bp=(h(Ap,mp=wp),Ap.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,mp.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=Yh(t),r=Ei.min(),t.Fs({index:Gc.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=uh(e.readTime)),n.done()}).next(function(){return r});var r}).then(function(t){e.Ua=t})]})})}(this.Uh)];case 2:return t.sent(),[4,this.l_.initialize(this,e)];case 3:return t.sent(),[4,yp(this.l_.Lu)];case 4:return t.sent(),[4,Nl(this.l_.Ml)];case 5:return t.sent(),[2]}})})},Ap.prototype.u_=function(t){return yf(this.persistence,new cf,t.h_,this.fe)},Ap.prototype.a_=function(t){var e=this.persistence.Io.vr;return new dc(e,t.ks)},Ap.prototype.o_=function(t){var e=sf(t.rt.O,t.rt.persistenceKey),n=void 0!==this.cacheSizeBytes?Wa.Ki(this.cacheSizeBytes):Wa.Gi;return new ef(this.synchronizeTabs,e,t.clientId,n,t.ks,cl(),hl(),this.fe,this.$l,!!this.forceOwnership)},Ap.prototype.r_=function(t){return new el},Ap),Ip=(h(Tp,gp=bp),Tp.prototype.initialize=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,gp.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.l_.Lu,this.$l instanceof tl?(this.$l.Lu={Sh:function(u,a,c,h){return y(this,void 0,void 0,function(){var o,s;return v(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).Uh,n=a,i=(r=e).Ra,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Vo(e,n).next(function(t){return t?r.Ka.Va(e,t):wa.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,Nl(o.Ml)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(sp(o,a,h||null),op(o,a),o.Uh.Ra.Fo(a)):_r(),t.label=4;case 4:return[4,fp(o,s)];case 5:return t.sent(),[3,7];case 6:wr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}.bind(null,e),Dh:function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return(e=i).Yl?(wr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!e.Ql.has(o))return[3,8];switch(s){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,_f(e.Uh)];case 3:return n=t.sent(),r=Du.un(o,"current"===s),[4,fp(e,n,r)];case 4:return t.sent(),[3,8];case 5:return[4,bf(e.Uh,o,!0)];case 6:return t.sent(),up(e,o,u),[3,8];case 7:_r(),t.label=8;case 8:return[2]}})})}.bind(null,e),Ch:function(c,h,f){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a;return v(this,function(t){switch(t.label){case 0:if(!(n=dp(c)).Yl)return[3,10];e=0,r=h,t.label=1;case 1:return e<r.length?(r=r[e],n.Ql.has(r)?(wr("SyncEngine","Adding an already active target "+r),[3,5]):[4,Ef(n.Uh,r)]):[3,6];case 2:return i=t.sent(),[4,wf(n.Uh,i)];case 3:return o=t.sent(),[4,tp(n,pp(i),o.targetId,!1)];case 4:t.sent(),vl(n.Ml,o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return n.Ql.has(e)?[4,bf(n.Uh,e,!1).then(function(){gl(n.Ml,e),up(n,e)}).catch(rc)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=0,a=f,t.label=7;case 7:return u<a.length?(a=a[u],[5,s(a)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})}.bind(null,e),Ea:function(t){return t.Uh.persistence.Ea()}.bind(null,e),bh:function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,_f((e=n).Uh).then(function(t){return fp(e,t)})]})})}.bind(null,e)},[4,this.$l.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence.Yc(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,function(h,f){return y(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return v(this,function(t){switch(t.label){case 0:return dp(r=h),yp(r),!0!==f||!0===r.Yl?[3,3]:(e=r.$l.th(),[4,lp(r,e.Dt())]);case 1:return i=t.sent(),r.Yl=!0,[4,Dl(r.Ml,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],vl(r.Ml,u);return[3,7];case 3:return!1!==f||!1===r.Yl?[3,7]:(a=[],c=Promise.resolve(),r.Ql.forEach(function(t,e){r.$l.lh(e)?a.push(e):c=c.then(function(){return up(r,e),bf(r.Uh,e,!0)}),gl(r.Ml,e)}),[4,c]);case 4:return t.sent(),[4,lp(r,a)];case 5:return t.sent(),(n=r).jl.forEach(function(t,e){gl(n.Ml,e)}),n.Gl.au(),n.jl=new Map,n.Wl=new uu(Ni.At),r.Yl=!1,[4,Dl(r.Ml,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}(this.l_.Lu,e)];case 1:return t.sent(),this.c_&&(e&&!this.c_.Nr?this.c_.start(this.Uh):e||this.c_.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},Tp.prototype.r_=function(t){var e=cl();if(!tl.G(e))throw new Lr(Rr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=sf(t.rt.O,t.rt.persistenceKey);return new tl(e,t.ks,n,t.clientId,t.h_)},Tp),Ep=(_p.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Uh?[3,2]:(this.Uh=n.Uh,this.$l=n.$l,this.Qh=this.__(r),this.Ml=this.f_(r),this.Ll=this.d_(r),this.Lu=this.w_(r,!n.synchronizeTabs),this.$l.$u=function(t){return rp(e.Lu,t,1)},this.Ml.Kh.E_=function(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(wr("SyncEngine","User change. New user:",o.I()),[4,vf(n.Uh,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Hl.forEach(function(t){t.forEach(function(t){t.reject(new Lr(Rr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Hl.clear(),n.$l.wh(o,r.ja,r.Ga),[4,fp(n,r.Wa)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this.Lu),[4,Dl(this.Ml,this.Lu.Xl)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},_p.prototype.d_=function(t){return new Pl},_p.prototype.__=function(t){var e=ga(t.rt.O),n=(n=t.rt,new bi(n));return t=t.credentials,new za(t,n,e)},_p.prototype.f_=function(t){var e=this;return new fl(this.Uh,this.Qh,t.ks,function(t){return rp(e.Lu,t,0)},t=new(ti.G()?ti:Zr))},_p.prototype.w_=function(t,e){return n=this.Uh,r=this.Ml,i=this.Ll,o=this.$l,s=t.h_,t=t.Bl,e=e,t=new Xl(n,r,i,o,s,t),e&&(t.Yl=!0),t;var n,r,i,o,s},_p.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,wr("RemoteStore","RemoteStore shutting down."),e.Gh.add(5),[4,yl(e)];case 1:return t.sent(),e.Hh.$(),e.Jh.set("Unknown"),[2]}})})}(this.Ml)},_p);function _p(){}function Tp(t,e){var n=this;return(n=gp.call(this,t,e,!1)||this).l_=t,n.cacheSizeBytes=e,n.synchronizeTabs=!0,n}function Ap(t,e,n){var r=this;return(r=mp.call(this)||this).l_=t,r.cacheSizeBytes=e,r.forceOwnership=n,r.synchronizeTabs=!1,r}function Np(){this.synchronizeTabs=!1}function Sp(n,r){void 0===r&&(r=10240);var i=0;return{read:function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return i<n.byteLength?(e={value:n.slice(i,i+r),done:!1},[2,(i+=r,e)]):[2,{done:!0}]})})},cancel:function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2]})})},releaseLock:function(){}}}var Op,Dp=(qp.prototype.next=function(t){this.observer.next&&this.T_(this.observer.next,t)},qp.prototype.error=function(t){this.observer.error?this.T_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},qp.prototype.I_=function(){this.muted=!0},qp.prototype.T_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},qp),xp=(Fp.prototype.close=function(){return this.m_.cancel()},Fp.prototype.getMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2,this.metadata.promise]})})},Fp.prototype.s_=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.R_())]}})})},Fp.prototype.R_=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return[4,this.P_()];case 1:return null===(e=t.sent())?[2,null]:(r=this.A_.decode(e),n=Number(r),isNaN(n)&&this.y_("length string ("+r+") is not valid number"),[4,this.g_(n)]);case 2:return r=t.sent(),[2,new Ml(JSON.parse(r),e.length+n)]}})})},Fp.prototype.V_=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},Fp.prototype.P_=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.V_()<0?[4,this.p_()]:[3,3];case 1:if(t.sent())return[3,3];t.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((e=this.V_())<0&&this.y_("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,e),[2,(this.buffer=this.buffer.slice(e),n)])}})})},Fp.prototype.g_=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.buffer.length<n?[4,this.p_()]:[3,3];case 1:t.sent()&&this.y_("Reached the end of bundle when more is expected."),t.label=2;case 2:return[3,0];case 3:return e=this.A_.decode(this.buffer.slice(0,n)),[2,(this.buffer=this.buffer.slice(n),e)]}})})},Fp.prototype.y_=function(t){throw this.m_.cancel(),new Error("Invalid bundle format: "+t)},Fp.prototype.p_=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,this.m_.read()];case 1:return(e=t.sent()).done||((n=new Uint8Array(this.buffer.length+e.value.length)).set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n),[2,e.done]}})})},Fp),kp=(jp.prototype.isEqual=function(t){return this.b_.isEqual(t.b_)},jp),Pp=function(t){this._methodName=t},Rp=(Object.defineProperty(Mp.prototype,"D_",{get:function(){return this.S_.path},enumerable:!1,configurable:!0}),Object.defineProperty(Mp.prototype,"id",{get:function(){return this.S_.path.Vt()},enumerable:!1,configurable:!0}),Object.defineProperty(Mp.prototype,"path",{get:function(){return this.S_.path.Ct()},enumerable:!1,configurable:!0}),Object.defineProperty(Mp.prototype,"parent",{get:function(){return new Cp(this.firestore,this.v_,this.S_.path.yt())},enumerable:!1,configurable:!0}),Mp.prototype.withConverter=function(t){return new Mp(this.firestore,t,this.S_)},Mp),Lp=(Vp.prototype.withConverter=function(t){return new Vp(this.firestore,t,this.C_)},Vp),Cp=(h(Up,Op=Lp),Object.defineProperty(Up.prototype,"id",{get:function(){return this.C_.path.Vt()},enumerable:!1,configurable:!0}),Object.defineProperty(Up.prototype,"path",{get:function(){return this.C_.path.Ct()},enumerable:!1,configurable:!0}),Object.defineProperty(Up.prototype,"parent",{get:function(){var t=this.D_.yt();return t.bt()?null:new Rp(this.firestore,null,new Ni(t))},enumerable:!1,configurable:!0}),Up.prototype.withConverter=function(t){return new Up(this.firestore,t,this.D_)},Up);function Up(t,e,n){var r=this;return(r=Op.call(this,t,e,ns(n))||this).firestore=t,r.D_=n,r.type="collection",r}function Vp(t,e,n){this.v_=e,this.C_=n,this.type="query",this.firestore=t}function Mp(t,e,n){this.v_=e,this.S_=n,this.type="document",this.firestore=t}function jp(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Lr(Rr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.b_=new Ai(t)}function Fp(t,e){var n=this;this.m_=t,this.fe=e,this.metadata=new wi,this.buffer=new Uint8Array,this.A_=new TextDecoder("utf-8"),this.R_().then(function(t){t&&t.Tl()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}function qp(t){this.observer=t,this.muted=!1}function Bp(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Ur&&(t=t._),wc("collection","path",e),t instanceof Dc)return _c(n=_i.xt.apply(_i,f([e],r))),new Cp(t,null,n);if(!(t instanceof Rp||t instanceof Cp))throw new Lr(Rr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return _c(n=_i.xt.apply(_i,f([t.path],r)).child(_i.xt(e))),new Cp(t.firestore,null,n)}function Gp(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Ur&&(t=t._),1===arguments.length&&(e=Ar.t()),wc("doc","path",e),t instanceof Dc)return Ec(n=_i.xt.apply(_i,f([e],r))),new Rp(t,null,new Ni(n));if(!(t instanceof Rp||t instanceof Cp))throw new Lr(Rr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Ec(n=t.D_.child(_i.xt.apply(_i,f([e],r)))),new Rp(t.firestore,t instanceof Cp?t.v_:null,new Ni(n))}function zp(t,e){return t instanceof Ur&&(t=t._),e instanceof Ur&&(e=e._),(t instanceof Rp||t instanceof Cp)&&(e instanceof Rp||e instanceof Cp)&&t.firestore===e.firestore&&t.path===e.path&&t.v_===e.v_}function Hp(t,e){return t instanceof Ur&&(t=t._),e instanceof Ur&&(e=e._),t instanceof Lp&&e instanceof Lp&&t.firestore===e.firestore&&fs(t.C_,e.C_)&&t.v_===e.v_}var Kp=(Object.defineProperty($p.prototype,"latitude",{get:function(){return this.x_},enumerable:!1,configurable:!0}),Object.defineProperty($p.prototype,"longitude",{get:function(){return this.N_},enumerable:!1,configurable:!0}),$p.prototype.isEqual=function(t){return this.x_===t.x_&&this.N_===t.N_},$p.prototype.toJSON=function(){return{latitude:this.x_,longitude:this.N_}},$p.prototype.dt=function(t){return Sr(this.x_,t.x_)||Sr(this.N_,t.N_)},$p),Wp=/^__.*__$/,Qp=(Xp.prototype.F_=function(t,e){return null!==this.Te?new Ys(t,this.data,this.Te,e,this.fieldTransforms):new Qs(t,this.data,e,this.fieldTransforms)},Xp),Yp=(Jp.prototype.F_=function(t,e){return new Ys(t,this.data,this.Te,e,this.fieldTransforms)},Jp);function Jp(t,e,n){this.data=t,this.Te=e,this.fieldTransforms=n}function Xp(t,e,n){this.data=t,this.Te=e,this.fieldTransforms=n}function $p(t,e){if(!isFinite(t)||t<-90||90<t)throw new Lr(Rr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Lr(Rr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.x_=t,this.N_=e}function Zp(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw _r()}}var td=(Object.defineProperty(rd.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(rd.prototype,"k_",{get:function(){return this.settings.k_},enumerable:!1,configurable:!0}),rd.prototype.M_=function(t){return new rd(Object.assign(Object.assign({},this.settings),t),this.O,this.fe,this.ignoreUndefinedProperties,this.fieldTransforms,this.Te)},rd.prototype.L_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.M_({path:e,B_:!1})).q_(t),e},rd.prototype.U_=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t);return(t=this.M_({path:t,B_:!1})).O_(),t},rd.prototype.Q_=function(t){return this.M_({path:void 0,B_:!0})},rd.prototype.K_=function(t){return Pd(t,this.settings.methodName,this.settings.W_||!1,this.path,this.settings.j_)},rd.prototype.contains=function(e){return void 0!==this.Te.find(function(t){return e.vt(t)})||void 0!==this.fieldTransforms.find(function(t){return e.vt(t.field)})},rd.prototype.O_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.q_(this.path.get(t))},rd.prototype.q_=function(t){if(0===t.length)throw this.K_("Document fields must not be empty");if(Zp(this.k_)&&Wp.test(t))throw this.K_('Document fields cannot begin and end with "__"')},rd),ed=(nd.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new td({k_:t,methodName:e,j_:n,path:Ai.Nt(),B_:!1,W_:r},this.O,this.fe,this.ignoreUndefinedProperties)},nd);function nd(t,e,n){this.O=t,this.ignoreUndefinedProperties=e,this.fe=n||ga(t)}function rd(t,e,n,r,i,o){this.settings=t,this.O=e,this.fe=n,this.ignoreUndefinedProperties=r,void 0===i&&this.O_(),this.fieldTransforms=i||[],this.Te=o||[]}function id(t){var e=t.so(),n=ga(t.zr);return new ed(t.zr,!!e.ignoreUndefinedProperties,n)}function od(t,e,n,r,i,o){void 0===o&&(o={});var s=t.G_(o.merge||o.mergeFields?2:0,e,n,i);Od("Data must be an object, but it was:",s,r);var u,a,r=Nd(r,s);if(o.merge)u=new ji(s.Te),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=Dd(e,f[h],n);if(!s.contains(l))throw new Lr(Rr.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");Rd(c,l)||c.push(l)}u=new ji(c),a=s.fieldTransforms.filter(function(t){return u.Qt(t.field)})}else u=null,a=s.fieldTransforms;return new Qp(new oo(r),u,a)}var sd,ud=(h(ad,sd=Pp),ad.prototype.z_=function(t){if(2!==t.k_)throw 1===t.k_?t.K_(this._methodName+"() can only appear at the top level of your update data"):t.K_(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.Te.push(t.path),null},ad.prototype.isEqual=function(t){return t instanceof ad},ad);function ad(){return null!==sd&&sd.apply(this,arguments)||this}function cd(t,e,n){return new td({k_:3,j_:e.settings.j_,methodName:t._methodName,B_:n},e.O,e.fe,e.ignoreUndefinedProperties)}var hd,fd,ld,pd,dd=(h(Id,pd=Pp),Id.prototype.z_=function(t){return new js(t.path,new Ts)},Id.prototype.isEqual=function(t){return t instanceof Id},Id),yd=(h(bd,ld=Pp),bd.prototype.z_=function(t){var e=cd(this,t,!0),n=this.H_.map(function(t){return Ad(t,e)}),n=new As(n);return new js(t.path,n)},bd.prototype.isEqual=function(t){return this===t},bd),vd=(h(wd,fd=Pp),wd.prototype.z_=function(t){var e=cd(this,t,!0),n=this.H_.map(function(t){return Ad(t,e)}),n=new xs(n);return new js(t.path,n)},wd.prototype.isEqual=function(t){return this===t},wd),gd=(h(md,hd=Pp),md.prototype.z_=function(t){var e=new Ls(t.fe,bs(t.fe,this.J_));return new js(t.path,e)},md.prototype.isEqual=function(t){return this===t},md);function md(t,e){var n=this;return(n=hd.call(this,t)||this).J_=e,n}function wd(t,e){var n=this;return(n=fd.call(this,t)||this).H_=e,n}function bd(t,e){var n=this;return(n=ld.call(this,t)||this).H_=e,n}function Id(){return null!==pd&&pd.apply(this,arguments)||this}function Ed(t,r,i,e){var o=t.G_(1,r,i);Od("Data must be an object, but it was:",o,e);var s=[],u=new so;return Vi(e,function(t,e){var n=kd(r,t,i);e instanceof Ur&&(e=e._),t=o.U_(n),e instanceof ud?s.push(n):null!=(t=Ad(e,t))&&(s.push(n),u.set(n,t))}),e=new ji(s),new Yp(u.Gt(),e,o.fieldTransforms)}function _d(t,e,n,r,i,o){var s=t.G_(1,e,n),u=[Dd(e,r,n)],a=[i];if(o.length%2!=0)throw new Lr(Rr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Dd(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new so,y=u.length-1;0<=y;--y)Rd(p,u[y])||(h=u[y],(f=a[y])instanceof Ur&&(f=f._),l=s.U_(h),f instanceof ud?p.push(h):null!=(l=Ad(f,l))&&(p.push(h),d.set(h,l)));return i=new ji(p),new Yp(d.Gt(),i,s.fieldTransforms)}function Td(t,e,n,r){return void 0===r&&(r=!1),Ad(n,t.G_(r?4:3,e))}function Ad(s,t){if(s instanceof Ur&&(s=s._),Sd(s))return Od("Unsupported field value:",t,s),Nd(s,t);if(s instanceof Pp)return function(t,e){if(!Zp(e.k_))throw e.K_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.K_(t._methodName+"() is not currently supported inside arrays");(t=t.z_(e))&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.Te.push(t.path),s instanceof Array){if(t.settings.B_&&4!==t.k_)throw t.K_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Ad(i[r],t.Q_(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof Ur&&(t=t._),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return bs(e.fe,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Ii.fromDate(t);return{timestampValue:Qu(e.fe,n)}}if(t instanceof Ii)return n=new Ii(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Qu(e.fe,n)};if(t instanceof Kp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Cr)return{bytesValue:Yu(e.fe,t.l)};if(t instanceof Rp){n=e.O;var r=t.firestore.zr;if(!r.isEqual(n))throw e.K_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Xu(t.firestore.zr||e.O,t.S_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.K_("Unsupported field value: "+Tc(t))}(s,t)}function Nd(t,n){var r={};return Mi(t)?n.path&&0<n.path.length&&n.Te.push(n.path):Vi(t,function(t,e){null!=(e=Ad(e,n.L_(t)))&&(r[t]=e)}),{mapValue:{fields:r}}}function Sd(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Ii||t instanceof Kp||t instanceof Cr||t instanceof Rp||t instanceof Pp)}function Od(t,e,n){if(!Sd(n)||"object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))throw"an object"===(n=Tc(n))?e.K_(t+" a custom object"):e.K_(t+" "+n);var r}function Dd(t,e,n){if(e instanceof Ur&&(e=e._),e instanceof kp)return e.b_;if("string"==typeof e)return kd(t,e);throw Pd("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var xd=new RegExp("[~\\*/\\[\\]]");function kd(e,n,r){if(0<=n.search(xd))throw Pd("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(kp.bind.apply(kp,f([void 0],n.split("."))))).b_}catch(t){throw Pd("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function Pd(t,e,n,r,i){var o=r&&!r.bt(),s=void 0!==i,e="Function "+e+"() called with invalid data";return n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Lr(Rr.INVALID_ARGUMENT,(e+=". ")+t+n)}function Rd(t,e){return t.some(function(t){return t.isEqual(e)})}var Ld=(jd.prototype.ef=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.nf(),0<this.mutations.length)throw new Lr(Rr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var r,e,n,i,o;return v(this,function(t){switch(t.label){case 0:return e=ra((r=s).fe)+"/documents",n={documents:u.map(function(t){return Zu(r.fe,t)})},[4,r._t("BatchGetDocuments",e,n)];case 1:return n=t.sent(),i=new Map,n.forEach(function(t){var e,n,t=(n=r.fe,"found"in t?function(t,e){Tr(!!e.found),e.found.name,e.found.updateTime;var n=ta(t,e.found.name),t=Ju(e.found.updateTime),e=new oo({mapValue:{fields:e.found.fields}});return new lo(n,t,e,{})}(n,t):"missing"in t?(e=n,Tr(!!(n=t).missing),Tr(!!n.readTime),e=ta(e,n.missing),n=Ju(n.readTime),new po(e,n)):_r());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){Tr(!!(t=i.get(t.toString()))),o.push(t)}),o)]}})})}(this.Qh,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof po||t instanceof lo?n.sf(t):_r()}),e)]}})})},jd.prototype.set=function(t,e){this.write(e.F_(t,this.Ee(t))),this.tf.add(t.toString())},jd.prototype.update=function(t,e){try{this.write(e.F_(t,this.rf(t)))}catch(t){this.Z_=t}this.tf.add(t.toString())},jd.prototype.delete=function(t){this.write(new ou(t,this.Ee(t))),this.tf.add(t.toString())},jd.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.nf(),this.Z_)throw this.Z_;return e=this.Y_,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=Ni.Lt(e),n.mutations.push(new su(e,n.Ee(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=ra((e=i).fe)+"/documents",r={writes:o.map(function(t){return ua(e.fe,t)})},[4,e.at("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Qh,this.mutations)];case 1:return t.sent(),this.X_=!0,[2]}})})},jd.prototype.sf=function(t){var e;if(t instanceof lo)e=t.version;else{if(!(t instanceof po))throw _r();e=Ei.min()}var n=this.Y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Lr(Rr.ABORTED,"Document version changed between two reads.")}else this.Y_.set(t.key.toString(),e)},jd.prototype.Ee=function(t){var e=this.Y_.get(t.toString());return!this.tf.has(t.toString())&&e?Fs.updateTime(e):Fs.de()},jd.prototype.rf=function(t){var e=this.Y_.get(t.toString());if(this.tf.has(t.toString())||!e)return Fs.exists(!0);if(e.isEqual(Ei.min()))throw new Lr(Rr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Fs.updateTime(e)},jd.prototype.write=function(t){this.nf(),this.mutations.push(t)},jd.prototype.nf=function(){},jd),Cd=(Md.prototype.run=function(){this.af()},Md.prototype.af=function(){var t=this;this.ui.ti(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new Ld(this.Qh),(n=this.uf(e))&&n.then(function(t){r.ks.Ws(function(){return e.commit().then(function(){r.Bs.resolve(t)}).catch(function(t){r.hf(t)})})}).catch(function(t){r.hf(t)}),[2]})})})},Md.prototype.uf=function(t){try{var e=this.updateFunction(t);return!ai(e)&&e.catch&&e.then?e:(this.Bs.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Bs.reject(t),null}},Md.prototype.hf=function(t){var e=this;0<this.cf&&this.lf(t)?(--this.cf,this.ks.Ws(function(){return e.af(),Promise.resolve()})):this.Bs.reject(t)},Md.prototype.lf=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!pi(t))},Md),Ud=(Vd.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.S.promise];case 1:return[2,(t.sent(),{ks:this.ks,rt:this.rt,clientId:this.clientId,credentials:this.credentials,h_:this.user,Bl:100})]}})})},Vd.prototype.ff=function(t){var e=this;this._f=t,this.S.promise.then(function(){return e._f(e.user)})},Vd.prototype.df=function(){if(this.ks.wf)throw new Lr(Rr.FAILED_PRECONDITION,"The client has already been terminated.")},Vd.prototype.terminate=function(){var t=this;this.ks.Ef();var n=new wi;return this.ks.Tf(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.If?[4,this.If.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.mf?[4,this.mf.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.p(),n.resolve(),[3,6];case 5:return e=Va(t.sent(),"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},Vd);function Vd(t,e,n){var r=this;this.credentials=t,this.ks=e,this.rt=n,this.user=Gr.UNAUTHENTICATED,this.clientId=Ar.t(),this._f=function(){},this.S=new wi,this.credentials.V(function(t){wr("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r._f(t)),r.S.resolve()})}function Md(t,e,n,r){this.ks=t,this.Qh=e,this.updateFunction=n,this.Bs=r,this.cf=5,this.ui=new qa(this.ks,"transaction_retry")}function jd(t){this.Qh=t,this.Y_=new Map,this.mutations=[],this.X_=!1,this.Z_=null,this.tf=new Set}function Fd(r,i){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return r.ks.Af(),wr("FirestoreClient","Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return e=t.sent(),[4,i.initialize(e)];case 2:return t.sent(),r.ff(function(e){return r.ks.ea(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,vf(i.Uh,e)];case 1:return t.sent(),[2]}})})})}),i.persistence.Xc(function(){return r.terminate()}),r.mf=i,[2]}})})}function qd(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.ks.Af(),[4,Bd(r)];case 1:return e=t.sent(),wr("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.ff(function(t){return r.ks.ea(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).ks.Af(),wr("RemoteStore","RemoteStore received new credentials"),n=El(e),e.Gh.add(3),[4,yl(e)];case 1:return t.sent(),n&&e.Jh.set("Unknown"),[4,e.Kh.E_(i)];case 2:return t.sent(),e.Gh.delete(3),[4,dl(e)];case 3:return t.sent(),[2]}})})}(i.Ml,t)})}),r.If=i,[2]}})})}function Bd(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.mf?[3,2]:(wr("FirestoreClient","Using default OfflineComponentProvider"),[4,Fd(e,new wp)]);case 1:t.sent(),t.label=2;case 2:return[2,e.mf]}})})}function Gd(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.If?[3,2]:(wr("FirestoreClient","Using default OnlineComponentProvider"),[4,qd(e,new Ep)]);case 1:t.sent(),t.label=2;case 2:return[2,e.If]}})})}function zd(t){return Bd(t).then(function(t){return t.persistence})}function Hd(t){return Bd(t).then(function(t){return t.Uh})}function Kd(t){return Gd(t).then(function(t){return t.Ml})}function Wd(t){return Gd(t).then(function(t){return t.Lu})}function Qd(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Gd(r)];case 1:return e=t.sent(),[2,((n=e.Ll).ol=function(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=dp(s),(o=e.Ul.get(u))?(n=o.targetId,e.$l.ah(n),r=o.view.Ol(),[3,4]):[3,1];case 1:return[4,wf(e.Uh,cs(u))];case 2:return i=t.sent(),o=e.$l.ah(i.targetId),n=i.targetId,[4,tp(e,u,n,"current"===o)];case 3:r=t.sent(),e.Xl&&vl(e.Ml,i),t.label=4;case 4:return[2,r]}})})}.bind(null,e.Lu),n.ul=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Ul.get(o),1<(r=e.Ql.get(n.targetId)).length?[2,(e.Ql.set(n.targetId,r.filter(function(t){return!fs(t,o)})),void e.Ul.delete(o))]:e.Xl?(e.$l.hh(n.targetId),e.$l.nh(n.targetId)?[3,2]:[4,bf(e.Uh,n.targetId,!1).then(function(){e.$l._h(n.targetId),gl(e.Ml,n.targetId),up(e,n.targetId)}).catch(rc)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return up(e,n.targetId),[4,bf(e.Uh,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.Lu),n)]}})})}function Yd(n,r,i){var t=this;void 0===i&&(i={});var o=new wi;return n.ks.Ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(n,r,i,o,s){var t=new Dp({next:function(t){r.Ws(function(){return Cl(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Lr(Rr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Lr(Rr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Vl(ns(i.path),t,{includeMetadataChanges:!0,El:!0});return Ll(n,u)},[4,Qd(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.ks,r,i,o])]}})})}),o.promise}function Jd(n,r,i){var t=this;void 0===i&&(i={});var o=new wi;return n.ks.Ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new Dp({next:function(t){n.Ws(function(){return Cl(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Lr(Rr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Vl(t,o,{includeMetadataChanges:!0,El:!0});return Ll(e,s)},[4,Qd(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.ks,r,i,o])]}})})}),o.promise}var Xd,$d=(Object.defineProperty(ey.prototype,"wf",{get:function(){return this.yf},enumerable:!1,configurable:!0}),ey.prototype.Ws=function(t){this.enqueue(t)},ey.prototype.Tf=function(t){this.Sf(),this.Df(t)},ey.prototype.Ef=function(){var t;this.yf||(this.yf=!0,(t=hl())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.vf))},ey.prototype.enqueue=function(t){return this.Sf(),this.yf?new Promise(function(t){}):this.Df(t)},ey.prototype.ea=function(t){var e=this;this.Ws(function(){return e.Pf.push(t),e.Cf()})},ey.prototype.Cf=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Pf.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Pf[0]()];case 2:return t.sent(),this.Pf.shift(),this.ui.reset(),[3,4];case 3:if(!Da(e=t.sent()))throw e;return wr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Pf.length&&this.ui.ti(function(){return n.Cf()}),t.label=5;case 5:return[2]}})})},ey.prototype.Df=function(t){var r=this,e=this.Rf.then(function(){return r.pf=!0,t().catch(function(t){throw r.Vf=t,r.pf=!1,br("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.pf=!1,t})});return this.Rf=e},ey.prototype.ni=function(t,e,n){var r=this;return this.Sf(),-1<this.bf.indexOf(t)&&(e=0),n=Ca.qs(this,t,e,n,function(t){return r.xf(t)}),this.gf.push(n),n},ey.prototype.Sf=function(){this.Vf&&_r()},ey.prototype.Af=function(){},ey.prototype.Nf=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Rf];case 1:t.sent(),t.label=2;case 2:if(e!==this.Rf)return[3,0];t.label=3;case 3:return[2]}})})},ey.prototype.Ff=function(t){for(var e=0,n=this.gf;e<n.length;e++)if(n[e].Ms===t)return!0;return!1},ey.prototype.Of=function(r){var i=this;return this.Nf().then(function(){i.gf.sort(function(t,e){return t.Ls-e.Ls});for(var t=0,e=i.gf;t<e.length;t++){var n=e[t];if(n.Ks(),"all"!==r&&n.Ms===r)break}return i.Nf()})},ey.prototype.kf=function(t){this.bf.push(t)},ey.prototype.xf=function(t){t=this.gf.indexOf(t),this.gf.splice(t,1)},ey),Zd=(h(ty,Xd=Dc),ty.prototype.io=function(){return this.Lf||ry(this),this.Lf.terminate()},ty);function ty(t,e){var n=this;return(n=Xd.call(this,t,e)||this).Mf=new $d,n.Wr="name"in t?t.name:"[DEFAULT]",n}function ey(){var e=this;this.Rf=Promise.resolve(),this.Pf=[],this.yf=!1,this.gf=[],this.Vf=null,this.pf=!1,this.bf=[],this.ui=new qa(this,"async_queue_retry"),this.vf=function(){var t=hl();t&&wr("AsyncQueue","Visibility state changed to "+t.visibilityState),e.ui.si()};var t=hl();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.vf)}function ny(t){return t.Lf||ry(t),t.Lf.df(),t.Lf}function ry(t){var e,n,r=t.so(),r=(e=t.zr,n=t.Wr,new Xr(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.Lf=new Ud(t.Hr,t.Mf,r)}function iy(n,r,i){var t=this,o=new wi;return n.ks.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,Fd(n,i)];case 1:return t.sent(),[4,qd(n,r)];case 2:return t.sent(),o.resolve(),[3,4];case 3:if(!("FirebaseError"===(t=e=t.sent()).name?t.code===Rr.FAILED_PRECONDITION||t.code===Rr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code))throw e;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),o.reject(e),[3,4];case 4:return[2]}})})}).then(function(){return o.promise})}function oy(t){if(t.Yr||t.Xr)throw new Lr(Rr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var sy,o=(fy.prototype.$f=function(t,e){switch(void 0===e&&(e="none"),Wi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Gi(t.integerValue||t.doubleValue);case 3:return this.Bf(t.timestampValue);case 4:return this.qf(t,e);case 5:return t.stringValue;case 6:return this.Uf(zi(t.bytesValue));case 7:return this.Qf(t.referenceValue);case 8:return this.Kf(t.geoPointValue);case 9:return this.Wf(t.arrayValue,e);case 10:return this.jf(t.mapValue,e);default:throw _r()}},fy.prototype.jf=function(t,n){var r=this,i={};return Vi(t.fields||{},function(t,e){i[t]=r.$f(e,n)}),i},fy.prototype.Kf=function(t){return new Kp(Gi(t.latitude),Gi(t.longitude))},fy.prototype.Wf=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.$f(t,e)})},fy.prototype.qf=function(t,e){switch(e){case"previous":var n=function t(e){return Hi(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==n?null:this.$f(n,e);case"estimate":return this.Bf(Ki(t));default:return null}},fy.prototype.Bf=function(t){return t=Bi(t),new Ii(t.seconds,t.nanos)},fy.prototype.Gf=function(t,e){var n=_i.xt(t);return Tr(va(n)),t=new $r(n.get(1),n.get(3)),n=new Ni(n.Pt(5)),t.isEqual(e)||br("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},fy),uy=(Object.defineProperty(hy.prototype,"id",{get:function(){return this.S_.path.Vt()},enumerable:!1,configurable:!0}),Object.defineProperty(hy.prototype,"ref",{get:function(){return new Rp(this.zf,this.v_,this.S_)},enumerable:!1,configurable:!0}),hy.prototype.exists=function(){return null!==this.Jf},hy.prototype.data=function(){if(this.Jf){if(this.v_){var t=new ay(this.zf,this.Hf,this.S_,this.Jf,null);return this.v_.fromFirestore(t)}return this.Hf.$f(this.Jf.Yt())}},hy.prototype.get=function(t){if(this.Jf&&null!==(t=this.Jf.data().field(ly("DocumentSnapshot.get",t))))return this.Hf.$f(t)},hy),ay=(h(cy,sy=uy),cy.prototype.data=function(){return sy.prototype.data.call(this)},cy);function cy(){return null!==sy&&sy.apply(this,arguments)||this}function hy(t,e,n,r,i){this.zf=t,this.Hf=e,this.S_=n,this.Jf=r,this.v_=i}function fy(){}function ly(t,e){return"string"==typeof e?kd(t,e):(e instanceof Ur?e._:e).b_}function py(t){if(is(t)&&0===t.ne.length)throw new Lr(Rr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}function dy(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++)t=i[r].Yf(t);return t}var yy,vy,gy,my,wy,by=(h(Dy,wy=me=function(){}),Dy.prototype.Yf=function(t){var e=id(t.firestore),e=function(t,e,n,r,i,o){if(r.Ot()){if("array-contains"===i||"array-contains-any"===i)throw new Lr(Rr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){Py(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(ky(n,t,c))}h={arrayValue:{values:s}}}else h=ky(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Py(o,i),h=Td(e,"where",o,"in"===i||"not-in"===i);var h=Ao.create(r,i,h);return function(t,e){if(e.ee()){var n=ss(t);if(null!==n&&!n.isEqual(e.field))throw new Lr(Rr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=os(t))&&Ry(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new Lr(Rr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Lr(Rr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(t.C_,e,t.firestore.zr,this.Xf,this.Zf,this.td);return new Lp(t.firestore,t.v_,(e=(t=t.C_).filters.concat([e]),new ts(t.path,t.collectionGroup,t.ne.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},Dy),Iy=(h(Oy,my=me),Oy.prototype.Yf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Lr(Rr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Lr(Rr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Xo(e,n);return e=r,null!==os(n=t)||null!==(t=ss(n))&&Ry(0,t,e.field),r}(t.C_,this.Xf,this.ed);return new Lp(t.firestore,t.v_,(e=(t=t.C_).ne.concat([e]),new ts(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},Oy),Ey=(h(Sy,gy=me),Sy.prototype.Yf=function(t){return new Lp(t.firestore,t.v_,hs(t.C_,this.nd,this.sd))},Sy),_y=(h(Ny,vy=me),Ny.prototype.Yf=function(t){var e=xy(t,this.type,this.rd,this.od);return new Lp(t.firestore,t.v_,(t=t.C_,new ts(t.path,t.collectionGroup,t.ne.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},Ny),Ty=(h(Ay,yy=me),Ay.prototype.Yf=function(t){var e=xy(t,this.type,this.rd,this.od);return new Lp(t.firestore,t.v_,(t=t.C_,new ts(t.path,t.collectionGroup,t.ne.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},Ay);function Ay(t,e,n){var r=this;return(r=yy.call(this)||this).type=t,r.rd=e,r.od=n,r}function Ny(t,e,n){var r=this;return(r=vy.call(this)||this).type=t,r.rd=e,r.od=n,r}function Sy(t,e,n){var r=this;return(r=gy.call(this)||this).type=t,r.nd=e,r.sd=n,r}function Oy(t,e){var n=this;return(n=my.call(this)||this).Xf=t,n.ed=e,n.type="orderBy",n}function Dy(t,e,n){var r=this;return(r=wy.call(this)||this).Xf=t,r.Zf=e,r.td=n,r.type="where",r}function xy(t,c,e,n){if(e[0]instanceof Ur&&(e[0]=e[0]._),e[0]instanceof uy)return function(t,e,n,r){if(!n)throw new Lr(Rr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=as(t);o<s.length;o++){var u=s[o];if(u.field.Ot())i.push(Zi(e,n.key));else{var a=n.field(u.field);if(Hi(a))throw new Lr(Rr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a)throw u=u.field.Ct(),new Lr(Rr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.");i.push(a)}}return new Ho(i,r)}(t.C_,t.firestore.zr,e[0].Jf,n);var r=id(t.firestore);return function(t,e,n,r,i,o){var s=t.ne;if(i.length>s.length)throw new Lr(Rr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.Ot()){if("string"!=typeof c)throw new Lr(Rr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!us(t)&&-1!==c.indexOf("/"))throw new Lr(Rr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(_i.xt(c));if(!Ni.qt(h))throw new Lr(Rr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new Ni(h),u.push(Zi(e,h))}else c=Td(n,r,c),u.push(c)}return new Ho(u,o)}(t.C_,t.firestore.zr,r,c,e,n)}function ky(t,e,n){if(n instanceof Ur&&(n=n._),"string"==typeof n){if(""===n)throw new Lr(Rr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!us(e)&&-1!==n.indexOf("/"))throw new Lr(Rr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child(_i.xt(n)),!Ni.qt(e))throw new Lr(Rr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Zi(t,new Ni(e))}if(n instanceof Rp)return Zi(t,n.S_);throw new Lr(Rr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Tc(n)+".")}function Py(t,e){if(!Array.isArray(t)||0===t.length)throw new Lr(Rr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Lr(Rr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Ry(t,e,n){if(!n.isEqual(e))throw new Lr(Rr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Ly(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Cy,Uy=(h(Vy,Cy=o),Vy.prototype.Uf=function(t){return new Cr(t)},Vy.prototype.Qf=function(t){return t=this.Gf(t,this.firestore.zr),new Rp(this.firestore,null,t)},Vy);function Vy(t){var e=this;return(e=Cy.call(this)||this).firestore=t,e}function My(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var jy,Fy,qy=(Qy.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Qy),By=(h(Wy,Fy=uy),Wy.prototype.exists=function(){return Fy.prototype.exists.call(this)},Wy.prototype.data=function(t){if(void 0===t&&(t={}),this.Jf){if(this.v_){var e=new Gy(this.zf,this.Hf,this.S_,this.Jf,this.metadata,null);return this.v_.fromFirestore(e,t)}return this.Hf.$f(this.Jf.Yt(),t.serverTimestamps)}},Wy.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Jf&&null!==(t=this.Jf.data().field(ly("DocumentSnapshot.get",t))))return this.Hf.$f(t,e.serverTimestamps)},Wy),Gy=(h(Ky,jy=By),Ky.prototype.data=function(t){return void 0===t&&(t={}),jy.prototype.data.call(this,t)},Ky),zy=(Object.defineProperty(Hy.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Hy.prototype,"size",{get:function(){return this.ud.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(Hy.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),Hy.prototype.forEach=function(e,n){var r=this;this.ud.docs.forEach(function(t){e.call(n,new Gy(r.zf,r.Hf,t.key,t,new qy(r.ud.tn.has(t.key),r.ud.fromCache),r.query.v_))})},Hy.prototype.docChanges=function(t){if(void 0===t&&(t={}),(t=!!t.includeMetadataChanges)&&this.ud.nn)throw new Lr(Rr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.hd&&this.ld===t||(this.hd=function(i,e){if(i.ud.Ze.bt()){var n=0;return i.ud.docChanges.map(function(t){var e=new Gy(i.zf,i.Hf,t.doc.key,t.doc,new qy(i.ud.tn.has(t.doc.key),i.ud.fromCache),i.query.v_);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.ud.Ze;return i.ud.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new Gy(i.zf,i.Hf,t.doc.key,t.doc,new qy(i.ud.tn.has(t.doc.key),i.ud.fromCache),i.query.v_),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return _r()}}(),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.ld=t),this.hd},Hy);function Hy(t,e,n,r){this.zf=t,this.Hf=e,this.ud=r,this.metadata=new qy(r.hasPendingWrites,r.fromCache),this.query=n}function Ky(){return null!==jy&&jy.apply(this,arguments)||this}function Wy(t,e,n,r,i,o){var s=this;return(s=Fy.call(this,t,e,n,r,o)||this).zf=t,s.ad=t,s.metadata=i,s}function Qy(t,e){this.hasPendingWrites=t,this.fromCache=e}function Yy(t,e){return t instanceof By&&e instanceof By?t.zf===e.zf&&t.S_.isEqual(e.S_)&&(null===t.Jf?null===e.Jf:t.Jf.isEqual(e.Jf))&&t.v_===e.v_:t instanceof zy&&e instanceof zy&&t.zf===e.zf&&Hp(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.ud.isEqual(e.ud)}var Jy,Xy=(h($y,Jy=o),$y.prototype.Uf=function(t){return new Cr(t)},$y.prototype.Qf=function(t){return t=this.Gf(t,this.firestore.zr),new Rp(this.firestore,null,t)},$y);function $y(t){var e=this;return(e=Jy.call(this)||this).firestore=t,e}function Zy(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Ac(t,Rp);var o=Ac(t.firestore,Zd),s=id(o);return e instanceof Ur&&(e=e._),ev(o,[("string"==typeof e||e instanceof kp?_d(s,"updateDoc",t.S_,e,n,r):Ed(s,"updateDoc",t.S_,e)).F_(t.S_,Fs.exists(!0))])}function tv(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];e instanceof Ur&&(e=e._);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||My(n[i])||(r=n[i],i++);var o,s,u,a,c,h,f={includeMetadataChanges:r.includeMetadataChanges};return My(n[i])&&(o=n[i],n[i]=null===(r=o.next)||void 0===r?void 0:r.bind(o),n[i+1]=null===(r=o.error)||void 0===r?void 0:r.bind(o),n[i+2]=null===(r=o.complete)||void 0===r?void 0:r.bind(o)),e instanceof Rp?(u=Ac(e.firestore,Zd),a=ns(e.S_.path),h={next:function(t){n[i]&&n[i](nv(u,e,t))},error:n[i+1],complete:n[i+2]}):(s=Ac(e,Lp),u=Ac(s.firestore,Zd),a=s.C_,c=new Xy(u),h={next:function(t){n[i]&&n[i](new zy(u,c,s,t))},error:n[i+1],complete:n[i+2]},py(e.C_)),function(n,t,e){var r=this,i=new Dp(h),o=new Vl(t,i,e);return n.ks.Ws(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Ll,[4,Qd(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})}),function(){i.I_(),n.ks.Ws(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Cl,[4,Qd(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})})}}(ny(u),a,f)}function ev(t,e){return function(n,r){var t=this,i=new wi;return n.ks.Ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=ep,[4,Wd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(ny(t),e)}function nv(t,e,n){var r=n.docs.get(e.S_),i=new Xy(t);return new By(t,i,e.S_,r,new qy(n.hasPendingWrites,n.fromCache),e.v_)}var rv=(iv.prototype.set=function(t,e,n){return this.Ed(),e=Ly((t=ov(t,this.zf)).v_,e,n),n=od(this.wd,"WriteBatch.set",t.S_,e,null!==t.v_,n),this.fd.push(n.F_(t.S_,Fs.de())),this},iv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return this.Ed(),t=ov(t,this.zf),e instanceof Ur&&(e=e._),e="string"==typeof e||e instanceof kp?_d(this.wd,"WriteBatch.update",t.S_,e,n,r):Ed(this.wd,"WriteBatch.update",t.S_,e),this.fd.push(e.F_(t.S_,Fs.exists(!0))),this},iv.prototype.delete=function(t){return this.Ed(),t=ov(t,this.zf),this.fd=this.fd.concat(new ou(t.S_,Fs.de())),this},iv.prototype.commit=function(){return this.Ed(),this.dd=!0,0<this.fd.length?this._d(this.fd):Promise.resolve()},iv.prototype.Ed=function(){if(this.dd)throw new Lr(Rr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},iv);function iv(t,e){this.zf=t,this._d=e,this.fd=[],this.dd=!1,this.wd=id(t)}function ov(t,e){if(t instanceof Ur&&(t=t._),t.firestore!==e)throw new Lr(Rr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var sv,uv,av,cv=(gv.prototype.get=function(t){var e=this,n=ov(t,this.zf),r=new Uy(this.zf);return this.Td.ef([n.S_]).then(function(t){if(!t||1!==t.length)return _r();if((t=t[0])instanceof po)return new uy(e.zf,r,n.S_,null,n.v_);if(t instanceof lo)return new uy(e.zf,r,t.key,t,n.v_);throw _r()})},gv.prototype.set=function(t,e,n){return e=Ly((t=ov(t,this.zf)).v_,e,n),n=od(this.wd,"Transaction.set",t.S_,e,null!==t.v_,n),this.Td.set(t.S_,n),this},gv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return t=ov(t,this.zf),e instanceof Ur&&(e=e._),e="string"==typeof e||e instanceof kp?_d(this.wd,"Transaction.update",t.S_,e,n,r):Ed(this.wd,"Transaction.update",t.S_,e),this.Td.update(t.S_,e),this},gv.prototype.delete=function(t){return t=ov(t,this.zf),this.Td.delete(t.S_),this},h(vv,av=gv),vv.prototype.get=function(t){var e=this,n=ov(t,this.zf),r=new Xy(this.zf);return av.prototype.get.call(this,t).then(function(t){return new By(e.zf,r,n.S_,t.Jf,new qy(!1,!1),n.v_)})},vv),hv=(yv.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){oy(t=Ac(t,Zd));var n=ny(t),r=t.so();return iy(n,t=new Ep,new bp(t,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._,{forceOwnership:e})},yv.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){oy(t=Ac(t,Zd));var e=ny(t),n=t.so();return iy(e,t=new Ep,new Ip(t,n.cacheSizeBytes))}(t._)},yv.prototype.clearIndexedDbPersistence=function(t){return function(n){var t=this;if(n.Yr&&!n.Xr)throw new Lr(Rr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var r=new wi;return n.Mf.Tf(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return Ia.G()?(e=n+"main",[4,Ia.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(sf(n.zr,n.Wr))];case 1:return t.sent(),r.resolve(),[3,3];case 2:return e=t.sent(),r.reject(e),[3,3];case 3:return[2]}})})}),r.promise}(t._)},yv),fv=(h(dv,uv=Ur),Object.defineProperty(dv.prototype,"zr",{get:function(){return this._.zr},enumerable:!1,configurable:!0}),dv.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._.no()),t)).merge,this._.eo(t)},dv.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this._.no().host&&Ir("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},dv.prototype.enableNetwork=function(){return function(r){var t=this;return r.ks.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,zd(r)];case 1:return e=t.sent(),[4,Kd(r)];case 2:return n=t.sent(),[2,(e.Zc(!0),(t=n).Gh.delete(0),dl(t))]}})})})}(ny(Ac(this._,Zd)))},dv.prototype.disableNetwork=function(){return function(r){var t=this;return r.ks.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,zd(r)];case 1:return e=t.sent(),[4,Kd(r)];case 2:return n=t.sent(),[2,(e.Zc(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Gh.add(0),[4,yl(e)];case 1:return t.sent(),e.Jh.set("Offline"),[2]}})})}(n))]}})})})}(ny(Ac(this._,Zd)))},dv.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Ic("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Id.enableMultiTabIndexedDbPersistence(this):this.Id.enableIndexedDbPersistence(this,n)},dv.prototype.clearPersistence=function(){return this.Id.clearIndexedDbPersistence(this)},dv.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this._._delete()},dv.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new wi;return n.ks.Ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=ip,[4,Wd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(ny(Ac(this._,Zd)))},dv.prototype.onSnapshotsInSync=function(t){return function(n,t){var e=this,r=new Dp(t);return n.ks.Ws(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.rl.add(e),e.next()},[4,Qd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),function(){r.I_(),n.ks.Ws(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.rl.delete(e)},[4,Qd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}}(ny(Ac(this._,Zd)),My(t)?t:{next:t})},Object.defineProperty(dv.prototype,"app",{get:function(){if(!this.md)throw new Lr(Rr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.md},enumerable:!1,configurable:!0}),dv.prototype.collection=function(t){try{return new qv(this,Bp(this._,t))}catch(t){throw Sv(t,"collection()","Firestore.collection()")}},dv.prototype.doc=function(t){try{return new _v(this,Gp(this._,t))}catch(t){throw Sv(t,"doc()","Firestore.doc()")}},dv.prototype.collectionGroup=function(t){try{return new Mv(this,function(t,e){if(t=Ac(t,Dc),wc("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new Lr(Rr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Lp(t,null,new ts(_i.Nt(),e))}(this._,t))}catch(t){throw Sv(t,"collectionGroup()","Firestore.collectionGroup()")}},dv.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new wi;return n.ks.Ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,Gd(n).then(function(t){return t.Qh})];case 1:return e=t.sent(),new Cd(n.ks,e,r,i).run(),[2]}})})}),i.promise}(ny(n=this._),function(t){return t=new cv(n,t),e(new Iv(r,t))})},dv.prototype.batch=function(){var e=this;return ny(this._),new Ev(new rv(this._,function(t){return ev(e._,t)}))},dv.prototype.loadBundle=function(t){throw new Lr(Rr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},dv.prototype.namedQuery=function(t){throw new Lr(Rr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},dv),lv=(h(pv,sv=o),pv.prototype.Uf=function(t){return new Br(new Cr(t))},pv.prototype.Qf=function(t){return t=this.Gf(t,this.firestore.zr),_v.Ad(t,this.firestore,null)},pv);function pv(t){var e=this;return(e=sv.call(this)||this).firestore=t,e}function dv(t,e,n){var r=this;return(r=uv.call(this,e)||this).Id=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof $r||(r.md=t),r}function yv(){}function vv(t,e){var n=this;return(n=av.call(this,t,e)||this).zf=t,n}function gv(t,e){this.zf=t,this.Td=e,this.wd=id(t)}var mv,wv,bv,Iv=(h(Nv,bv=Ur),Nv.prototype.get=function(t){var e=this,t=Qv(t);return this._.get(t).then(function(t){return new Uv(e.zf,t)})},Nv.prototype.set=function(t,e,n){return t=Qv(t),n?(bc("Transaction.set",n),this._.set(t,e,n)):this._.set(t,e),this},Nv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Qv(t);return 2===arguments.length?this._.update(o,e):(t=this._).update.apply(t,f([o,e,n],r)),this},Nv.prototype.delete=function(t){return t=Qv(t),this._.delete(t),this},Nv),Ev=(h(Av,wv=Ur),Av.prototype.set=function(t,e,n){return t=Qv(t),n?(bc("WriteBatch.set",n),this._.set(t,e,n)):this._.set(t,e),this},Av.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Qv(t);return 2===arguments.length?this._.update(o,e):(t=this._).update.apply(t,f([o,e,n],r)),this},Av.prototype.delete=function(t){return t=Qv(t),this._.delete(t),this},Av.prototype.commit=function(){return this._.commit()},Av),_v=(h(Tv,mv=Ur),Tv.Rd=function(t,e,n){if(t.length%2!=0)throw new Lr(Rr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.Ct()+" has "+t.length);return new Tv(e,new Rp(e._,n,new Ni(t)))},Tv.Ad=function(t,e,n){return new Tv(e,new Rp(e._,n,t))},Object.defineProperty(Tv.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(Tv.prototype,"parent",{get:function(){return new qv(this.firestore,this._.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(Tv.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Tv.prototype.collection=function(t){try{return new qv(this.firestore,Bp(this._,t))}catch(t){throw Sv(t,"collection()","DocumentReference.collection()")}},Tv.prototype.isEqual=function(t){return t instanceof Ur&&(t=t._),t instanceof Rp&&zp(this._,t)},Tv.prototype.set=function(t,e){e=bc("DocumentReference.set",e);try{return function(t,e,n){t=Ac(t,Rp);var r=Ac(t.firestore,Zd),e=Ly(t.v_,e,n);return ev(r,[od(id(r),"setDoc",t.S_,e,null!==t.v_,n).F_(t.S_,Fs.de())])}(this._,t,e)}catch(t){throw Sv(t,"setDoc()","DocumentReference.set()")}},Tv.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Zy(this._,t):Zy.apply(void 0,f([this._,t,e],n))}catch(t){throw Sv(t,"updateDoc()","DocumentReference.update()")}},Tv.prototype.delete=function(){return ev(Ac((t=this._).firestore,Zd),[new ou(t.S_,Fs.de())]);var t},Tv.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Ov(t),i=Dv(t,function(t){return new Uv(e.firestore,new By(e.firestore._,e.Hf,t.S_,t.Jf,t.metadata,e._.v_))});return tv(this._,r,i)},Tv.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=Ac(e,Rp);var n=Ac(e.firestore,Zd),t=ny(n),r=new Xy(n);return function(n,r){var t=this,i=new wi;return n.ks.Ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(o,s,u){return y(this,void 0,void 0,function(){var r,i;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=s,(n=o).persistence.runTransaction("read document","readonly",function(t){return n.Ka.Pa(t,e)}))];case 1:return(i=t.sent())instanceof lo?u.resolve(i):i instanceof po?u.resolve(null):u.reject(new Lr(Rr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),i=Va(r,"Failed to get document '"+s+" from cache"),u.reject(i),[3,3];case 3:return[2]}var e,n})})},[4,Hd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.S_).then(function(t){return new By(n,r,e.S_,t,new qy(t instanceof lo&&t.Jt,!0),e.v_)})}:"server"===(null==t?void 0:t.source)?function(e){e=Ac(e,Rp);var n=Ac(e.firestore,Zd);return Yd(ny(n),e.S_,{source:"server"}).then(function(t){return nv(n,e,t)})}:function(e){e=Ac(e,Rp);var n=Ac(e.firestore,Zd);return Yd(ny(n),e.S_).then(function(t){return nv(n,e,t)})})(this._).then(function(t){return new Uv(e.firestore,new By(e.firestore._,e.Hf,t.S_,t.Jf,t.metadata,e._.v_))})},Tv.prototype.withConverter=function(t){return new Tv(this.firestore,this._.withConverter(t))},Tv);function Tv(t,e){var n=this;return(n=mv.call(this,e)||this).firestore=t,n.Hf=new lv(t),n}function Av(){return null!==wv&&wv.apply(this,arguments)||this}function Nv(t,e){var n=this;return(n=bv.call(this,e)||this).zf=t,n}function Sv(t,e,n){return t.message=t.message.replace(e,n),t}function Ov(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!My(r))return r}return{}}function Dv(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=My(t[0])?t[0]:My(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var xv,kv,Pv,Rv,Lv,Cv,Uv=(h(Wv,Cv=Ur),Object.defineProperty(Wv.prototype,"ref",{get:function(){return new _v(this.zf,this._.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(Wv.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(Wv.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Wv.prototype,"exists",{get:function(){return this._.exists()},enumerable:!1,configurable:!0}),Wv.prototype.data=function(t){return this._.data(t)},Wv.prototype.get=function(t,e){return this._.get(t,e)},Wv.prototype.isEqual=function(t){return Yy(this._,t._)},Wv),Vv=(h(Kv,Lv=Uv),Kv.prototype.data=function(t){return this._.data(t)},Kv),Mv=(h(Hv,Rv=Ur),Hv.prototype.where=function(t,e,n){try{return new Hv(this.firestore,dy(this._,(r=n,i=e,o=ly("where",t),new by(o,i,r))))}catch(t){throw Sv(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},Hv.prototype.orderBy=function(n,t){try{return new Hv(this.firestore,dy(this._,function(t){void 0===t&&(t="asc");var e=t,t=ly("orderBy",n);return new Iy(t,e)}(t)))}catch(n){throw Sv(n,/(orderBy|where)\(\)/,"Query.$1()")}},Hv.prototype.limit=function(t){try{return new Hv(this.firestore,dy(this._,(Nc("limit",e=t),new Ey("limit",e,"F"))))}catch(t){throw Sv(t,"limit()","Query.limit()")}var e},Hv.prototype.limitToLast=function(t){try{return new Hv(this.firestore,dy(this._,(Nc("limitToLast",e=t),new Ey("limitToLast",e,"L"))))}catch(t){throw Sv(t,"limitToLast()","Query.limitToLast()")}var e},Hv.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Hv(this.firestore,dy(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new _y("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw Sv(t,"startAt()","Query.startAt()")}},Hv.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Hv(this.firestore,dy(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new _y("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw Sv(t,"startAfter()","Query.startAfter()")}},Hv.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Hv(this.firestore,dy(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ty("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw Sv(t,"endBefore()","Query.endBefore()")}},Hv.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Hv(this.firestore,dy(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ty("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw Sv(t,"endAt()","Query.endAt()")}},Hv.prototype.isEqual=function(t){return Hp(this._,t._)},Hv.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=Ac(e,Lp);var n=Ac(e.firestore,Zd),t=ny(n),r=new Xy(n);return function(n,r){var t=this,i=new wi;return n.ks.Ws(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,If(i,o,!0)];case 1:return r=t.sent(),e=new Ql(o,r.za),n=e.bl(r.documents),n=e.yr(n,!1),s.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),r=Va(n,"Failed to execute query '"+o+" against cache"),s.reject(r),[3,3];case 3:return[2]}})})},[4,Hd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.C_).then(function(t){return new zy(n,r,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){e=Ac(e,Lp);var n=Ac(e.firestore,Zd),t=ny(n),r=new Xy(n);return Jd(t,e.C_,{source:"server"}).then(function(t){return new zy(n,r,e,t)})}:function(e){e=Ac(e,Lp);var n=Ac(e.firestore,Zd),t=ny(n),r=new Xy(n);return py(e.C_),Jd(t,e.C_).then(function(t){return new zy(n,r,e,t)})})(this._).then(function(t){return new Fv(e.firestore,new zy(e.firestore._,e.Hf,e._,t.ud))})},Hv.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Ov(t),i=Dv(t,function(t){return new Fv(e.firestore,new zy(e.firestore._,e.Hf,e._,t.ud))});return tv(this._,r,i)},Hv.prototype.withConverter=function(t){return new Hv(this.firestore,this._.withConverter(t))},Hv),jv=(h(zv,Pv=Ur),Object.defineProperty(zv.prototype,"type",{get:function(){return this._.type},enumerable:!1,configurable:!0}),Object.defineProperty(zv.prototype,"doc",{get:function(){return new Vv(this.zf,this._.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(zv.prototype,"oldIndex",{get:function(){return this._.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(zv.prototype,"newIndex",{get:function(){return this._.newIndex},enumerable:!1,configurable:!0}),zv),Fv=(h(Gv,kv=Ur),Object.defineProperty(Gv.prototype,"query",{get:function(){return new Mv(this.zf,this._.query)},enumerable:!1,configurable:!0}),Object.defineProperty(Gv.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Gv.prototype,"size",{get:function(){return this._.size},enumerable:!1,configurable:!0}),Object.defineProperty(Gv.prototype,"empty",{get:function(){return this._.empty},enumerable:!1,configurable:!0}),Object.defineProperty(Gv.prototype,"docs",{get:function(){var e=this;return this._.docs.map(function(t){return new Vv(e.zf,t)})},enumerable:!1,configurable:!0}),Gv.prototype.docChanges=function(t){var e=this;return this._.docChanges(t).map(function(t){return new jv(e.zf,t)})},Gv.prototype.forEach=function(e,n){var r=this;this._.forEach(function(t){e.call(n,new Vv(r.zf,t))})},Gv.prototype.isEqual=function(t){return Yy(this._,t._)},Gv),qv=(h(Bv,xv=Mv),Object.defineProperty(Bv.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(Bv.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Object.defineProperty(Bv.prototype,"parent",{get:function(){var t=this._.parent;return t?new _v(this.firestore,t):null},enumerable:!1,configurable:!0}),Bv.prototype.doc=function(t){try{return new _v(this.firestore,void 0===t?Gp(this._):Gp(this._,t))}catch(t){throw Sv(t,"doc()","CollectionReference.doc()")}},Bv.prototype.add=function(t){var e,n=this,r=this._,i=t;return t=Ac(r.firestore,Zd),e=Gp(r),i=Ly(r.v_,i),ev(t,[od(id(r.firestore),"addDoc",e.S_,i,null!==r.v_,{}).F_(e.S_,Fs.exists(!1))]).then(function(){return e}).then(function(t){return new _v(n.firestore,t)})},Bv.prototype.isEqual=function(t){return zp(this._,t._)},Bv.prototype.withConverter=function(t){return new Bv(this.firestore,this._.withConverter(t))},Bv);function Bv(t,e){var n=this;return(n=xv.call(this,t,e)||this).firestore=t,n._=e,n}function Gv(t,e){var n=this;return(n=kv.call(this,e)||this).zf=t,n}function zv(t,e){var n=this;return(n=Pv.call(this,e)||this).zf=t,n}function Hv(t,e){var n=this;return(n=Rv.call(this,e)||this).firestore=t,n.Hf=new lv(t),n}function Kv(){return null!==Lv&&Lv.apply(this,arguments)||this}function Wv(t,e){var n=this;return(n=Cv.call(this,e)||this).zf=t,n}function Qv(t){return t instanceof Ur&&(t=t._),Ac(t,Rp)}var Yv,Jv,me=(h(tg,Jv=Ur),tg.documentId=function(){return new tg(Ai.kt().Ct())},tg.prototype.isEqual=function(t){return t instanceof Ur&&(t=t._),t instanceof kp&&this._.b_.isEqual(t.b_)},tg),o=(h(Zv,Yv=Ur),Zv.serverTimestamp=function(){var t=new dd("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new Zv(t)},Zv.delete=function(){var t=new ud("deleteField");return t._methodName="FieldValue.delete",new Zv(t)},Zv.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new yd("arrayUnion",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayUnion",new Zv(n)},Zv.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new vd("arrayRemove",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayRemove",new Zv(n)},Zv.increment=function(t){return(t=new gd("increment",t))._methodName="FieldValue.increment",new Zv(t)},Zv.prototype.isEqual=function(t){return this._.isEqual(t._)},Zv),Xv=($v.prototype.onProgress=function(t,e,n){this.Pd={next:t,error:e,complete:n}},$v.prototype.catch=function(t){return this.yd.promise.catch(t)},$v.prototype.then=function(t,e){return this.yd.promise.then(t,e)},$v.prototype.e_=function(t){this.n_(t),this.Pd.complete&&this.Pd.complete(),this.yd.resolve(t)},$v.prototype.i_=function(t){this.gd.taskState="Error",this.Pd.next&&this.Pd.next(this.gd),this.Pd.error&&this.Pd.error(t),this.yd.reject(t)},$v.prototype.n_=function(t){this.gd=t,this.Pd.next&&this.Pd.next(t)},$v);function $v(){this.Pd={},this.yd=new wi,this.gd={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}function Zv(){return null!==Yv&&Yv.apply(this,arguments)||this}function tg(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Jv.call(this,new(kp.bind.apply(kp,f([void 0],t))))||this}eg.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},eg.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},eg.prototype.setServiceProps=function(t){return this.serviceProps=t,this},ge=eg;function eg(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}o={Firestore:fv,GeoPoint:Kp,Timestamp:Ii,Blob:Br,Transaction:Iv,WriteBatch:Ev,DocumentReference:_v,DocumentSnapshot:Uv,Query:Mv,QueryDocumentSnapshot:Vv,QuerySnapshot:Fv,CollectionReference:qv,FieldPath:me,FieldValue:o,setLogLevel:function(t){gr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(e=e.default).INTERNAL.registerComponent(new ge("firestore",function(t){var e=t.getProvider("app").getImmediate();return t=t.getProvider("auth-internal"),new fv(e,new Zd(e,t),new hv)},"PUBLIC").setServiceProps(Object.assign({},o))),e.registerVersion("@firebase/firestore","2.1.0"),fv.prototype.loadBundle=function(t){return e=this,s=t,t=new Xv,function(n,t,r){var e,i=this,o=(e=s,t=ga(t),e=function(t){if(t instanceof Uint8Array)return Sp(t,void 0);if(t instanceof ArrayBuffer)return Sp(new Uint8Array(t),void 0);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof e?(new TextEncoder).encode(e):e),new xp(e,t));n.ks.Ws(function(){return y(i,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=vp,[4,Wd(n)];case 1:return e.apply(void 0,[t.sent(),o,r]),[2]}})})})}(ny(e._),e.zr,t),t;var e,s},fv.prototype.namedQuery=function(t){return function(n,r){var t=this;return n.ks.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){var n=t;return n.persistence.runTransaction("Get named query","readonly",function(t){return n.Wc.ho(t,e)})},[4,Hd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}(ny((e=this)._),t).then(function(t){return t?new Mv(e,new Lp(e._,null,t.query)):null});var e}}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});