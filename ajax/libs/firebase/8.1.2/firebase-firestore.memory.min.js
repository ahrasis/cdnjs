!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(hd){"use strict";try{(function(){var u,t,e=(t=hd)&&"object"==typeof t&&"default"in t?t:{default:t},r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function a(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function i(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,a(["["+i+"]  "+t.name+":"],n))}}(ge=u=u||{})[ge.DEBUG=0]="DEBUG",ge[ge.VERBOSE=1]="VERBOSE",ge[ge.INFO=2]="INFO",ge[ge.WARN=3]="WARN",ge[ge.ERROR=4]="ERROR",ge[ge.SILENT=5]="SILENT";var o={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},h=u.INFO,c=((me={})[u.DEBUG]="log",me[u.VERBOSE]="log",me[u.INFO]="info",me[u.WARN]="warn",me[u.ERROR]="error",me),l=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.DEBUG],t)),this._logHandler.apply(this,a([this,u.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.VERBOSE],t)),this._logHandler.apply(this,a([this,u.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.INFO],t)),this._logHandler.apply(this,a([this,u.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.WARN],t)),this._logHandler.apply(this,a([this,u.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.ERROR],t)),this._logHandler.apply(this,a([this,u.ERROR],t))},f);function f(t){this.name=t,this._logLevel=h,this._logHandler=i,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e,n){return(e=d.call(this,e)||this).code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=(t=this.errors[t])?(r=i,t.replace(T,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var T=/\{\$([^}]+)}/g,I=function(t,e){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function N(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},C=A||self;function O(){}function _(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function R(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var k="closure_uid_"+(1e9*Math.random()>>>0),D=0;function S(t,e,n){return t.call.apply(t.bind,arguments)}function L(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function P(t,e,n){return(P=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?S:L).apply(null,arguments)}function V(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function U(){return Date.now()}function j(t,o){function e(){}e.prototype=o.prototype,t.X=o.prototype,t.prototype=new e,(t.prototype.constructor=t).Kb=function(t,e,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[e].apply(t,r)}}function M(){this.j=this.j,this.i=this.i}M.prototype.j=!1,M.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,k)&&this[k]||(this[k]=++D))},M.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var x=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},q=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function F(){return Array.prototype.concat.apply([],arguments)}function G(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function z(t){return/^[\s\xa0]*$/.test(t)}var B=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function H(t,e){return-1!=t.indexOf(e)}function W(t,e){return t<e?-1:e<t?1:0}var Y=C.navigator;function X(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Q(t){var e,n={};for(e in t)n[e]=t[e];return n}ut=(Y=Y&&Y.userAgent)?Y:"";var K="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function J(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<K.length;i++)e=K[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function $(t){return $[" "](t),t}$[" "]=O;var Z,tt=H(ut,"Opera"),et=H(ut,"Trident")||H(ut,"MSIE"),nt=H(ut,"Edge"),rt=nt||et,it=H(ut,"Gecko")&&!(H(ut.toLowerCase(),"webkit")&&!H(ut,"Edge"))&&!(H(ut,"Trident")||H(ut,"MSIE"))&&!H(ut,"Edge"),ot=H(ut.toLowerCase(),"webkit")&&!H(ut,"Edge");function st(){var t=C.document;return t?t.documentMode:void 0}var Y="",ut=(ut=ut,it?/rv:([^\);]+)(\)|;)/.exec(ut):nt?/Edge\/([\d\.]+)/.exec(ut):et?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ut):ot?/WebKit\/(\S+)/.exec(ut):tt?/(?:Version)[ \/]?(\S+)/.exec(ut):void 0);ut&&(Y=ut?ut[1]:""),Z=et&&null!=(ut=st())&&ut>parseFloat(Y)?String(ut):Y;var at={};function ht(u){return t=u,e=function(){for(var t=0,e=B(String(Z)).split("."),n=B(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++)for(var o=e[i]||"",s=n[i]||"";o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],(0!=o[0].length||0!=s[0].length)&&(t=W(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||W(0==o[2].length,0==s[2].length)||W(o[2],s[2]),o=o[3],s=s[3],0==t););return 0<=t},n=at,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var ct=C.document&&et&&(st()||parseInt(Z,10))||void 0,lt=!et||9<=Number(ct),ft=et&&!ht("9"),pt=function(){if(!C.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{C.addEventListener("test",O,e),C.removeEventListener("test",O,e)}catch(t){}return t}();function dt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function yt(t,e){if(dt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(it){t:{try{$(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:vt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}dt.prototype.b=function(){this.defaultPrevented=!0},j(yt,dt);var vt={2:"touch",3:"pen",4:"mouse"};yt.prototype.b=function(){yt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,ft)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var gt="closure_listenable_"+(1e6*Math.random()|0),mt=0;function wt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++mt,this.Y=this.Z=!1}function bt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Et(t){this.src=t,this.a={},this.b=0}function Tt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=x(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(bt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function It(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Et.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=It(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new wt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Nt="closure_lm_"+(1e6*Math.random()|0),At={};function Ct(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Pt(r),e&&e[gt]?e.wa(n,r,R(i)?!!i.capture:!!i,o):Ot(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ct(t,e[o],n,r,i);return null}return n=Pt(n),t&&t[gt]?t.va(e,n,R(r)?!!r.capture:!!r,i):Ot(t,e,n,!1,r,i)}function Ot(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=R(i)?!!i.capture:!!i;if(s&&!lt)return null;var u,a,h=St(t);if(h||(t[Nt]=h=new Et(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=Dt,r=a=lt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)pt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Rt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function _t(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[gt]?Tt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Rt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=St(e))?(Tt(n,t),0==n.b&&(n.src=null,e[Nt]=null)):bt(t)))}function Rt(t){return t in At?At[t]:At[t]="on"+t}function kt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&_t(t),n.call(r,e)}function Dt(t,e){if(t.Y)return!0;if(lt)return kt(t,new yt(e,this));if(!e)t:{e=["window","event"];for(var n=C,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return kt(t,e=new yt(e,this))}function St(t){return(t=t[Nt])instanceof Et?t:null}var Lt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Pt(e){return"function"==typeof e?e:(e[Lt]||(e[Lt]=function(t){return e.handleEvent(t)}),e[Lt])}function Vt(){M.call(this),this.c=new Et(this),(this.J=this).C=null}function Ut(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new dt(e,t):e instanceof dt?e.target=e.target||t:(s=e,J(e=new dt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=jt(o,r,!0,e)&&s;if(s=jt(o=e.a=t,r,!0,e)&&s,s=jt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=jt(o=e.a=n[i],r,!1,e)&&s}function jt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Tt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}j(Vt,M),Vt.prototype[gt]=!0,(ut=Vt.prototype).addEventListener=function(t,e,n,r){Ct(this,t,e,n,r)},ut.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=R(i)?!!i.capture:!!i,r=Pt(r),e&&e[gt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=It(s=e.a[n],r,i,o))&&(bt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&St(e))&&(n=e.a[n.toString()],e=-1,n&&(e=It(n,r,i,o)),(r=-1<e?n[e]:null)&&_t(r))}(this,t,e,n,r)},ut.G=function(){if(Vt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)bt(n[r]);delete e.a[t],e.b--}}this.C=null},ut.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},ut.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Mt=C.JSON.stringify;function xt(){this.b=this.a=null}var qt,Ft=(Gt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Gt(function(){return new zt},function(t){t.reset()}));function Gt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function zt(){this.next=this.b=this.a=null}function Bt(t,e){var n;qt||(n=C.Promise.resolve(void 0),qt=function(){n.then(Yt)}),Ht||(qt(),Ht=!0),Wt.add(t,e)}xt.prototype.add=function(t,e){var n=Ft.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},zt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Ht=!(zt.prototype.reset=function(){this.next=this.b=this.a=null}),Wt=new xt;function Yt(){for(var t,e;n=e=void 0,n=null,(e=Wt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){C.setTimeout(function(){throw t},0)}(t)}var n=Ft;n.f(t),n.b<100&&(n.b++,t.next=n.a,n.a=t)}Ht=!1}function Xt(t,e){Vt.call(this),this.b=t||1,this.a=e||C,this.f=P(this.Za,this),this.g=U()}function Qt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Kt(t,e,n){if("function"==typeof t)n&&(t=P(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=P(t.handleEvent,t)}return 2147483647<Number(e)?-1:C.setTimeout(t,e||0)}j(Xt,Vt),(ut=Xt.prototype).aa=!1,ut.M=null,ut.Za=function(){var t;this.aa&&(0<(t=U()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Ut(this,"tick"),this.aa&&(Qt(this),this.start())))},ut.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=U())},ut.G=function(){Xt.X.G.call(this),Qt(this),delete this.a};var Jt,$t,Zt=(I($t=ee,Y=Jt=M),$t.prototype=null===Y?Object.create(Y):(te.prototype=Y.prototype,new te),ee.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=Kt(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ee.prototype.G=function(){Jt.prototype.G.call(this),this.a&&(C.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ee);function te(){this.constructor=$t}function ee(t,e){var n=Jt.call(this)||this;return n.g=t,n.h=e,n.b=null,n.c=!1,n.a=null,n}function ne(t){M.call(this),this.b=t,this.a={}}j(ne,M);var re=[];function ie(t,e,n,r){Array.isArray(n)||(n&&(re[0]=n.toString()),n=re);for(var i=0;i<n.length;i++){var o=Ct(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function oe(t){X(t.a,function(t,e){this.a.hasOwnProperty(e)&&_t(t)},t),t.a={}}function se(){this.a=!0}function ue(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return Mt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ne.prototype.G=function(){ne.X.G.call(this),oe(this)},ne.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},se.prototype.info=function(){};var ae={},he=null;function ce(){return he=he||new Vt}function le(t){dt.call(this,ae.Fa,t)}function fe(){var t=ce();Ut(t,new le(t))}function pe(t,e){dt.call(this,ae.STAT_EVENT,t),this.stat=e}function de(t){var e=ce();Ut(e,new pe(e,t))}function ye(t){dt.call(this,ae.Ga,t)}function ve(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return C.setTimeout(function(){t()},e)}ae.Fa="serverreachability",j(le,dt),ae.STAT_EVENT="statevent",j(pe,dt),ae.Ga="timingevent",j(ye,dt);var ge={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},me={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function we(){}function be(t){var e;return(e=t.a)||(e=t.a={}),e}function Ee(){}we.prototype.a=null;var Te,A={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Ie(){dt.call(this,"d")}function Ne(){dt.call(this,"c")}function Ae(){}function Ce(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ne(this),this.P=Oe,t=rt?125:void 0,this.R=new Xt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}j(Ie,dt),j(Ne,dt),j(Ae,we),Te=new Ae;var Oe=45e3,_e={},Re={};function ke(t,e,n){t.H=1,t.i=Je(He(e)),t.j=n,t.I=!0,De(t,null)}function De(t,e){t.u=U(),Le(t),t.l=He(t.i);var s,u,a,h,c,l,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),ln(n.b,"t",r),t.D=0,t.a=ir(t.g,t.g.C?e:null),0<t.O&&(t.F=new Zt(P(t.Ca,t,t.a),t.O)),ie(t.J,t.a,"readystatechange",t.Xa),e=t.B?Q(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),fe(),s=t.c,u=t.m,a=t.l,h=t.f,c=t.S,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function Se(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Re:(i=Number(u.substring(i,o)),isNaN(i)?_e:(o+=1)+i>u.length?Re:(u=u.substr(o,i),r.D=o+i,u)));if(u==Re){4==e&&(t.h=4,de(14),s=!1),ue(t.c,t.f,null,"[Incomplete Response]");break}if(u==_e){t.h=4,de(15),ue(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}ue(t.c,t.f,u,null),Me(t,u)}4==e&&0==n.length&&(t.h=1,de(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Kn(e),e.F=!0,de(11))):(ue(t.c,t.f,n,"[Invalid Chunked Response]"),je(t),Ue(t))}function Le(t){t.T=U()+t.P,Pe(t,t.P)}function Pe(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=ve(P(t.Va,t),e)}function Ve(t){t.o&&(C.clearTimeout(t.o),t.o=null)}function Ue(t){0==t.g.v||t.A||Zn(t.g,t)}function je(t){Ve(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Qt(t.R),oe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Me(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||mn(u.b,t)))if(u.I=t.N,!t.C&&mn(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var h=a;if(0==h[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;$n(u),Fn(u)}Qn(u),de(18)}}else u.oa=h[1],0<u.oa-u.P&&h[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=ve(P(u.Sa,u),6e3));if(gn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else er(u,11)}else if(!t.C&&u.a!=t||$n(u),!z(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)h=e[a],u.P=h[0],h=h[1],2==u.v?"c"==h[0]?(u.J=h[1],u.ga=h[2],null!=(r=h[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=h[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=h[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(H(r,"spdy")||H(r,"quic")||H(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(wn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,Ke(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=U()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=rr(n,n.C?n.ga:null,n.fa),i.C?(bn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Ve(o),Le(o)),n.a=i):Xn(n),0<u.g.length&&Bn(u)):"stop"!=h[0]&&"close"!=h[0]||er(u,7):3==u.v&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?er(u,7):qn(u):"noop"!=h[0]&&u.f&&u.f.sa(h),u.o=0);fe()}catch(t){}}function xe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(_(t)||"string"==typeof t)q(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(_(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(_(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function qe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof qe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Fe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ge(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Ge(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Ge(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(ut=Ce.prototype).setTimeout=function(t){this.P=t},ut.Xa=function(t){t=t.target;var e=this.F;e&&3==Un(t)?e.f():this.Ca(t)},ut.Ca=function(t){try{if(t==this.a)t:{var e=Un(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!rt&&!this.a.$())){this.A||4!=e||7==n||fe(),Ve(this);var i=this.a.W();if(this.N=i,n=this.a.$(),this.b=200==i,r=this.c,u=this.m,a=this.l,h=this.f,c=this.S,l=e,f=i,r.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+c+"]: "+u+"\n"+a+"\n"+l+" "+f}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,de(12),je(this),Ue(this);break t}ue(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Me(this,s)}this.I?(Se(this,e,n),rt&&this.b&&3==e&&(ie(this.J,this.R,"tick",this.Wa),this.R.start())):(ue(this.c,this.f,n,null),Me(this,n)),4==e&&je(this),this.b&&!this.A&&(4==e?Zn(this.g,this):(this.b=!1,Le(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,de(12)):(this.h=0,de(13)),je(this),Ue(this)}}}catch(t){}var u,a,h,c,l,f},ut.Wa=function(){var t,e;this.a&&(t=Un(this.a),e=this.a.$(),this.D<e.length&&(Ve(this),Se(this,t,e),this.b&&4!=t&&Le(this)))},ut.cancel=function(){this.A=!0,je(this)},ut.Va=function(){this.o=null;var t,e,n=U();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(fe(),de(17)),je(this),this.h=2,Ue(this)):Pe(this,this.T-n)},(ut=qe.prototype).K=function(){Fe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},ut.L=function(){return Fe(this),this.a.concat()},ut.get=function(t,e){return Ge(this.b,t)?this.b[t]:e},ut.set=function(t,e){Ge(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},ut.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var ze=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Be(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Be?(this.a=void 0!==e?e:t.a,We(this,t.f),this.j=t.j,Ye(this,t.c),Xe(this,t.h),this.g=t.g,e=t.b,(n=new un).c=e.c,e.a&&(n.a=new qe(e.a),n.b=e.b),Qe(this,n),this.i=t.i):t&&(n=String(t).match(ze))?(this.a=!!e,We(this,n[1]||"",!0),this.j=$e(n[2]||""),Ye(this,n[3]||"",!0),Xe(this,n[4]),this.g=$e(n[5]||"",!0),Qe(this,n[6]||"",!0),this.i=$e(n[7]||"")):(this.a=!!e,this.b=new un(null,this.a))}function He(t){return new Be(t)}function We(t,e,n){t.f=n?$e(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ye(t,e,n){t.c=n?$e(e,!0):e}function Xe(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Qe(t,e,n){var r,i;e instanceof un?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(an(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(hn(this,e),ln(this,n,t))},r)),r.f=i):(n||(e=Ze(e,on)),t.b=new un(e,t.a))}function Ke(t,e,n){t.b.set(e,n)}function Je(t){return Ke(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^U()).toString(36)),t}function $e(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ze(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,tn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function tn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Be.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Ze(e,en,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(Ze(e,en,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Ze(n,"/"==n.charAt(0)?rn:nn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Ze(n,sn)),t.join("")};var en=/[#\/\?@]/g,nn=/[#\?:]/g,rn=/[#\?]/g,on=/[#\?@]/g,sn=/#/g;function un(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function an(o){o.a||(o.a=new qe,o.b=0,o.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],r=n,i=i?decodeURIComponent(i.replace(/\+/g," ")):"",o.add(decodeURIComponent(r.replace(/\+/g," ")),i)}}}(o.c))}function hn(t,e){an(t),e=fn(t,e),Ge(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ge((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Fe(t)))}function cn(t,e){return an(t),e=fn(t,e),Ge(t.a.b,e)}function ln(t,e,n){hn(t,e),0<n.length&&(t.c=null,t.a.set(fn(t,e),G(n)),t.b+=n.length)}function fn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(ut=un.prototype).add=function(t,e){an(this),this.c=null,t=fn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},ut.forEach=function(n,r){an(this),this.a.forEach(function(t,e){q(t,function(t){n.call(r,t,e,this)},this)},this)},ut.L=function(){an(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},ut.K=function(t){an(this);var e=[];if("string"==typeof t)cn(this,t)&&(e=F(e,this.a.get(fn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=F(e,t[n])}return e},ut.set=function(t,e){return an(this),this.c=null,cn(this,t=fn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},ut.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},ut.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};function pn(t,e){this.b=t,this.a=e}function dn(t){this.g=t||yn,t=C.PerformanceNavigationTiming?0<(t=C.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(C.ia&&C.ia.ya&&C.ia.ya()&&C.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var yn=10;function vn(t){return t.b||t.a&&t.a.size>=t.f}function gn(t){return t.b?1:t.a?t.a.size:0}function mn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function wn(t,e){t.a?t.a.add(e):t.b=e}function bn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function En(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return G(t.c);var r=t.c;try{for(var i=N(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Tn(){}function In(){this.a=new Tn}function Nn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}dn.prototype.cancel=function(){var t,e;if(this.c=En(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=N(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Tn.prototype.stringify=function(t){return C.JSON.stringify(t,void 0)},Tn.prototype.parse=function(t){return C.JSON.parse(t,void 0)};var An=C.JSON.parse;function Cn(t){Vt.call(this),this.headers=new qe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=On,this.D=this.F=!1}j(Cn,Vt);var On="",_n=/^https?$/i,Rn=["POST","PUT"];function kn(t){return"content-type"==t.toLowerCase()}function Dn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Sn(t),Pn(t)}function Sn(t){t.u||(t.u=!0,Ut(t,"complete"),Ut(t,"error"))}function Ln(t){if(t.b&&(!t.s[1]||4!=Un(t)||2!=t.W()))if(t.l&&4==Un(t))Kt(t.za,0,t);else if(Ut(t,"readystatechange"),4==Un(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(ze)[1]||null)&&C.self&&C.self.location&&(i=(r=C.self.location.protocol).substr(0,r.length-1)),n=!_n.test(i?i.toLowerCase():"")),e=n),e)Ut(t,"complete"),Ut(t,"success");else{t.h=6;try{var u=2<Un(t)?t.a.statusText:""}catch(o){u=""}t.f=u+" ["+t.W()+"]",Sn(t)}}finally{Pn(t)}}}function Pn(t,e){if(t.a){Vn(t);var n=t.a,r=t.s[0]?O:null;t.a=null,t.s=null,e||Ut(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Vn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(C.clearTimeout(t.m),t.m=null)}function Un(t){return t.a?t.a.readyState:0}function jn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",X(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Ke(t,e,n))}function Mn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function xn(t){this.pa=0,this.g=[],this.c=new se,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Mn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Mn("baseRetryDelayMs",5e3,t),this.Ra=Mn("retryDelaySeedMs",1e4,t),this.Ma=Mn("forwardChannelMaxRetries",2,t),this.ma=Mn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new dn(t&&t.concurrentRequestLimit),this.ka=new In,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function qn(t){var e,n;Gn(t),3==t.v&&(e=t.R++,Ke(n=He(t.B),"SID",t.J),Ke(n,"RID",e),Ke(n,"TYPE","terminate"),Wn(t,n),(e=new Ce(t,t.c,e,void 0)).H=2,e.i=Je(He(n)),n=!1,C.navigator&&C.navigator.sendBeacon&&(n=C.navigator.sendBeacon(e.i.toString(),"")),!n&&C.Image&&((new Image).src=e.i,n=!0),n||(e.a=ir(e.g,null),e.a.ba(e.i)),e.u=U(),Le(e)),nr(t)}function Fn(t){t.a&&(Kn(t),t.a.cancel(),t.a=null)}function Gn(t){Fn(t),t.j&&(C.clearTimeout(t.j),t.j=null),$n(t),t.b.cancel(),t.h&&("number"==typeof t.h&&C.clearTimeout(t.h),t.h=null)}function zn(t,e){t.g.push(new pn(t.Oa++,e)),3==t.v&&Bn(t)}function Bn(t){vn(t.b)||t.h||(t.h=!0,Bt(t.Ba,t),t.u=0)}function Hn(t,e){var n=e?e.f:t.R++,r=He(t.B);Ke(r,"SID",t.J),Ke(r,"RID",n),Ke(r,"AID",t.P),Wn(t,r),t.i&&t.l&&jn(r,t.i,t.l),n=new Ce(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Yn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),wn(t.b,n),ke(n,r,e)}function Wn(t,n){t.f&&xe({},function(t,e){Ke(n,e,t)})}function Yn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?P(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+h+"_"||"";try{xe(t,function(t,e){var n=t;R(t)&&(n=Mt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s)}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Xn(t){t.a||t.j||(t.T=1,Bt(t.Aa,t),t.o=0)}function Qn(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=ve(P(t.Aa,t),tr(t,t.o)),t.o++,1)}function Kn(t){null!=t.s&&(C.clearTimeout(t.s),t.s=null)}function Jn(t){t.a=new Ce(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=He(t.la);Ke(e,"RID","rpc"),Ke(e,"SID",t.J),Ke(e,"CI",t.H?"0":"1"),Ke(e,"AID",t.P),Wn(t,e),Ke(e,"TYPE","xmlhttp"),t.i&&t.l&&jn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=Je(He(e)),n.j=null,n.I=!0,De(n,t)}function $n(t){null!=t.m&&(C.clearTimeout(t.m),t.m=null)}function Zn(t,e){var n,r,i,o=null;if(t.a==e){$n(t),Kn(t),t.a=null;var s=2}else{if(!mn(t.b,e))return;o=e.s,bn(t.b,e),s=1}if(t.I=e.N,0!=t.v)if(e.b)1==s?(o=e.j?e.j.length:0,e=U()-e.u,n=t.u,Ut(s=ce(),new ye(s)),Bn(t)):Xn(t);else if(3==(n=e.h)||0==n&&0<t.I||(1!=s||(i=e,gn((r=t).b)>=r.b.f-(r.h?1:0)||(r.h?(r.g=i.s.concat(r.g),0):1==r.v||2==r.v||r.u>=(r.La?0:r.Ma)||(r.h=ve(P(r.Ba,r,i),tr(r,r.u)),r.u++,0))))&&(2!=s||!Qn(t)))switch(o&&0<o.length&&(e=t.b,e.c=e.c.concat(o)),n){case 1:er(t,5);break;case 4:er(t,10);break;case 3:er(t,6);break;default:er(t,2)}}function tr(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function er(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=P(t.Ya,t),r||(r=new Be("//www.google.com/images/cleardot.gif"),C.location&&"http"==C.location.protocol||We(r,"https"),Je(r)),n=r.toString(),r=o,o=new se,C.Image?((i=new Image).onload=V(Nn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=V(Nn,o,i,"TestLoadImage: error",!1,r),i.onabort=V(Nn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=V(Nn,o,i,"TestLoadImage: timeout",!1,r),C.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):de(2),t.v=0,t.f&&t.f.ra(e),nr(t),Gn(t)}function nr(t){t.v=0,t.I=-1,t.f&&(0==En(t.b).length&&0==t.g.length||(t.b.c.length=0,G(t.g),t.g.length=0),t.f.qa())}function rr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Be?He(s):new Be(s,void 0);return""!=a.c?(e&&Ye(a,e+"."+a.c),Xe(a,a.h)):(r=(u=C.location).protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Be(null,void 0),r&&We(u,r),i&&Ye(u,i),o&&Xe(u,o),s&&(u.g=s),a=u),t.V&&X(t.V,function(t,e){Ke(a,e,t)}),e=t.A,n=t.na,e&&n&&Ke(a,e,n),Ke(a,"VER",t.ha),Wn(t,a),a}function ir(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Cn(t.Na)).F=t.C,e}function or(){}function sr(){if(et&&!(10<=Number(ct)))throw Error("Environmental error: no available transport.")}function ur(t,e){Vt.call(this),this.a=new xn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!z(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!z(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new cr(this)}function ar(t){Ie.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function hr(){Ne.call(this),this.status=1}function cr(t){this.a=t}(ut=Cn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?be(this.H):be(Te),this.a.onreadystatechange=P(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Dn(this,t)}t=n||"";var i,o=new qe(this.headers);r&&xe(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=kn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=C.FormData&&t instanceof C.FormData,0<=x(Rn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Vn(this),0<this.o&&((this.D=(i=this.a,et&&ht(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=P(this.xa,this)):this.m=Kt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Dn(this,t)}},ut.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Ut(this,"timeout"),this.abort(8))},ut.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Ut(this,"complete"),Ut(this,"abort"),Pn(this))},ut.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Pn(this,!0)),Cn.X.G.call(this)},ut.za=function(){this.j||(this.A||this.l||this.g?Ln(this):this.Ua())},ut.Ua=function(){Ln(this)},ut.W=function(){try{return 2<Un(this)?this.a.status:-1}catch(t){return-1}},ut.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},ut.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),An(e)}},ut.ua=function(){return this.h},ut.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(ut=xn.prototype).ha=8,ut.v=1,ut.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ce(this,this.c,t,void 0),r=this.l;if(this.O&&(r?J(r=Q(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Yn(this,n,e),Ke(i=He(this.B),"RID",t),Ke(i,"CVER",22),this.A&&Ke(i,"X-HTTP-Session-Id",this.A),Wn(this,i),this.i&&r&&jn(i,this.i,r),wn(this.b,n),this.Ia&&Ke(i,"TYPE","init"),this.da?(Ke(i,"$req",e),Ke(i,"SID","null"),n.U=!0,ke(n,i,null)):ke(n,i,e),this.v=2}}else 3==this.v&&(t?Hn(this,t):0==this.g.length||vn(this.b)||Hn(this))},ut.Aa=function(){var t;this.j=null,Jn(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=ve(P(this.Ta,this),t))},ut.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,de(10),Fn(this),Jn(this))},ut.Sa=function(){null!=this.m&&(this.m=null,Fn(this),Qn(this),de(19))},ut.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),de(2)):(this.c.info("Failed to ping google.com"),de(1))},(ut=or.prototype).ta=function(){},ut.sa=function(){},ut.ra=function(){},ut.qa=function(){},ut.Ja=function(){},sr.prototype.a=function(t,e){return new ur(t,e)},j(ur,Vt),ur.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;de(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=rr(t,null,t.fa),Bn(t)},ur.prototype.close=function(){qn(this.a)},ur.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,zn(this.a,e)):this.l?((e={}).__data__=Mt(t),zn(this.a,e)):zn(this.a,t)},ur.prototype.G=function(){this.a.f=null,delete this.f,qn(this.a),delete this.a,ur.X.G.call(this)},j(ar,Ie),j(hr,Ne),j(cr,or),cr.prototype.ta=function(){Ut(this.a,"a")},cr.prototype.sa=function(t){Ut(this.a,new ar(t))},cr.prototype.ra=function(t){Ut(this.a,new hr)},cr.prototype.qa=function(){Ut(this.a,"b")},sr.prototype.createWebChannel=sr.prototype.a,ur.prototype.send=ur.prototype.h,ur.prototype.open=ur.prototype.g,ge.NO_ERROR=0,ge.TIMEOUT=8,ge.HTTP_ERROR=6,me.COMPLETE="complete",(Ee.EventType=A).OPEN="a",A.CLOSE="b",A.ERROR="c",A.MESSAGE="d",Vt.prototype.listen=Vt.prototype.va,Cn.prototype.listenOnce=Cn.prototype.wa,Cn.prototype.getLastError=Cn.prototype.Qa,Cn.prototype.getLastErrorCode=Cn.prototype.ua,Cn.prototype.getStatus=Cn.prototype.W,Cn.prototype.getResponseJson=Cn.prototype.Pa,Cn.prototype.getResponseText=Cn.prototype.$,Cn.prototype.send=Cn.prototype.ba;var lr=ce,fr=ge,pr=me,dr=ae,yr=Ee,vr=Cn,ge=(gr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},gr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},gr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},gr);function gr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var mr=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},wr=(Object.defineProperty(Tr.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Tr.prototype.isEqual=function(t){return t instanceof Tr&&t.projectId===this.projectId&&t.database===this.database},Tr),br=(Er.prototype.u=function(){return null!=this.uid},Er.prototype.h=function(){return this.u()?"uid:"+this.uid:"anonymous-user"},Er.prototype.isEqual=function(t){return t.uid===this.uid},Er);function Er(t){this.uid=t}function Tr(t,e){this.projectId=t,this.database=e||"(default)"}br.UNAUTHENTICATED=new br(null),br.l=new br("google-credentials-uid"),br._=new br("first-party-uid");var Ir=new l("@firebase/firestore");function Nr(){return Ir.logLevel}function Ar(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ir.logLevel<=u.DEBUG&&(e=n.map(_r),Ir.debug.apply(Ir,s(["Firestore (8.1.2): "+t],e)))}function Cr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ir.logLevel<=u.ERROR&&(e=n.map(_r),Ir.error.apply(Ir,s(["Firestore (8.1.2): "+t],e)))}function Or(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ir.logLevel<=u.WARN&&(e=n.map(_r),Ir.warn.apply(Ir,s(["Firestore (8.1.2): "+t],e)))}function _r(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Rr(t){throw void 0===t&&(t="Unexpected state"),Cr(t="FIRESTORE (8.1.2) INTERNAL ASSERTION FAILED: "+t),new Error(t)}function kr(t){t||Rr()}function Dr(t,e){this.user=e,this.type="OAuth",this.m={},this.m.Authorization="Bearer "+t}var Sr,Lr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Pr=(n(zr,Sr=Error),zr),Vr=(Gr.prototype.getToken=function(){return Promise.resolve(null)},Gr.prototype.A=function(){},Gr.prototype.I=function(t){(this.T=t)(br.UNAUTHENTICATED)},Gr.prototype.R=function(){this.T=null},Gr),Ur=(Fr.prototype.getToken=function(){var e=this,n=this.p,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.p!==n?(Ar("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(kr("string"==typeof t.accessToken),new Dr(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Fr.prototype.A=function(){this.forceRefresh=!0},Fr.prototype.I=function(t){this.T=t,this.V&&t(this.currentUser)},Fr.prototype.R=function(){this.auth&&this.auth.removeAuthTokenListener(this.P),this.P=null,this.T=null},Fr.prototype.g=function(){var t=this.auth&&this.auth.getUid();return kr(null===t||"string"==typeof t),new br(t)},Fr),jr=(Object.defineProperty(qr.prototype,"m",{get:function(){var t={"X-Goog-AuthUser":this.C},e=this.v.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),qr),Mr=(xr.prototype.getToken=function(){return Promise.resolve(new jr(this.v,this.C))},xr.prototype.I=function(t){t(br._)},xr.prototype.R=function(){},xr.prototype.A=function(){},xr);function xr(t,e){this.v=t,this.C=e}function qr(t,e){this.v=t,this.C=e,this.type="FirstParty",this.user=br._}function Fr(t){var e=this;this.P=null,this.currentUser=br.UNAUTHENTICATED,this.V=!1,this.p=0,this.T=null,this.forceRefresh=!1,this.P=function(){e.p++,e.currentUser=e.g(),e.V=!0,e.T&&e.T(e.currentUser)},this.p=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.P):(this.P(null),t.get().then(function(t){e.auth=t,e.P&&e.auth.addAuthTokenListener(e.P)},function(){}))}function Gr(){this.T=null}function zr(t,e){var n=this;return(n=Sr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}var Br=(Hr.S=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Hr);function Hr(){}function Wr(t,e){return t<e?-1:e<t?1:0}function Yr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var Xr,Qr,Kr=(ui.now=function(){return ui.fromMillis(Date.now())},ui.fromDate=function(t){return ui.fromMillis(t.getTime())},ui.fromMillis=function(t){var e=Math.floor(t/1e3);return new ui(e,1e6*(t-1e3*e))},ui.prototype.toDate=function(){return new Date(this.toMillis())},ui.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},ui.prototype.D=function(t){return this.seconds===t.seconds?Wr(this.nanoseconds,t.nanoseconds):Wr(this.seconds,t.seconds)},ui.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},ui.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},ui.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},ui.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},ui),Jr=(si.N=function(t){return new si(t)},si.min=function(){return new si(new Kr(0,0))},si.prototype.F=function(t){return this.timestamp.D(t.timestamp)},si.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},si.prototype.O=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},si.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},si.prototype.L=function(){return this.timestamp},si),me=(Object.defineProperty(oi.prototype,"length",{get:function(){return this.$},enumerable:!1,configurable:!0}),oi.prototype.isEqual=function(t){return 0===oi.k(this,t)},oi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof oi?t.forEach(function(t){e.push(t)}):e.push(t),this.M(e)},oi.prototype.limit=function(){return this.offset+this.length},oi.prototype.U=function(t){return t=void 0===t?1:t,this.M(this.segments,this.offset+t,this.length-t)},oi.prototype.q=function(){return this.M(this.segments,this.offset,this.length-1)},oi.prototype.B=function(){return this.segments[this.offset]},oi.prototype.j=function(){return this.get(this.length-1)},oi.prototype.get=function(t){return this.segments[this.offset+t]},oi.prototype.W=function(){return 0===this.length},oi.prototype.G=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},oi.prototype.K=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},oi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},oi.prototype.H=function(){return this.segments.slice(this.offset,this.limit())},oi.k=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},oi),$r=(n(ii,Qr=me),ii.prototype.M=function(t,e,n){return new ii(t,e,n)},ii.prototype.Y=function(){return this.H().join("/")},ii.prototype.toString=function(){return this.Y()},ii.J=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Pr(Lr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new ii(n)},ii.X=function(){return new ii([])},ii),Zr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ti=(n(ri,Xr=me),ri.prototype.M=function(t,e,n){return new ri(t,e,n)},ri.Z=function(t){return Zr.test(t)},ri.prototype.Y=function(){return this.H().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ri.Z(t)||(t="`"+t+"`"),t}).join(".")},ri.prototype.toString=function(){return this.Y()},ri.prototype.tt=function(){return 1===this.length&&"__name__"===this.get(0)},ri.nt=function(){return new ri(["__name__"])},ri.et=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Pr(Lr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Pr(Lr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Pr(Lr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Pr(Lr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ri(e)},ri.X=function(){return new ri([])},ri),ei=(ni.st=function(t){return new ni($r.J(t))},ni.it=function(t){return new ni($r.J(t).U(5))},ni.prototype.rt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ni.prototype.isEqual=function(t){return null!==t&&0===$r.k(this.path,t.path)},ni.prototype.toString=function(){return this.path.toString()},ni.k=function(t,e){return $r.k(t.path,e.path)},ni.ot=function(t){return t.length%2==0},ni.ut=function(t){return new ni(new $r(t.slice()))},ni);function ni(t){this.path=t}function ri(){return null!==Xr&&Xr.apply(this,arguments)||this}function ii(){return null!==Qr&&Qr.apply(this,arguments)||this}function oi(t,e,n){void 0===e?e=0:e>t.length&&Rr(),void 0===n?n=t.length-e:n>t.length-e&&Rr(),this.segments=t,this.offset=e,this.$=n}function si(t){this.timestamp=t}function ui(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Pr(Lr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Pr(Lr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Pr(Lr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Pr(Lr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function ai(t){return null==t}function hi(t){return 0===t&&1/t==-1/0}var ci=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.ct=null};function li(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new ci(t,e,n,r,i,o,s)}function fi(t){var e=t;return null===e.ct&&(t=e.path.Y(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return t.field.Y()+t.op.toString()+go(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return t.field.Y()+t.dir}).join(","),ai(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=Fu(e.startAt)),e.endAt&&(t+="|ub:",t+=Fu(e.endAt)),e.ct=t),e.ct}function pi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!fo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!zu(t.startAt,e.startAt)&&zu(t.endAt,e.endAt)}function di(t){return ei.ot(t.path)&&null===t.collectionGroup&&0===t.filters.length}var yi=(vi.fromBase64String=function(t){return new vi(atob(t))},vi.fromUint8Array=function(t){return new vi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},vi.prototype.toBase64=function(){return t=this.ht,btoa(t);var t},vi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.ht)},vi.prototype.at=function(){return 2*this.ht.length},vi.prototype.F=function(t){return Wr(this.ht,t.ht)},vi.prototype.isEqual=function(t){return this.ht===t.ht},vi);function vi(t){this.ht=t}function gi(t){this.count=t}yi.lt=new yi("");var mi,wi=(bi.prototype.dt=function(t){return new bi(this.target,this.targetId,this._t,t,this.ft,this.lastLimboFreeSnapshotVersion,this.resumeToken)},bi.prototype.wt=function(t,e){return new bi(this.target,this.targetId,this._t,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},bi.prototype.Et=function(t){return new bi(this.target,this.targetId,this._t,this.sequenceNumber,this.ft,t,this.resumeToken)},bi);function bi(t,e,n,r,i,o,s){void 0===i&&(i=Jr.min()),void 0===o&&(o=Jr.min()),void 0===s&&(s=yi.lt),this.target=t,this.targetId=e,this._t=n,this.sequenceNumber=r,this.ft=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Ei(t){switch(t){case Lr.OK:return Rr(),0;case Lr.CANCELLED:case Lr.UNKNOWN:case Lr.DEADLINE_EXCEEDED:case Lr.RESOURCE_EXHAUSTED:case Lr.INTERNAL:case Lr.UNAVAILABLE:case Lr.UNAUTHENTICATED:return;case Lr.INVALID_ARGUMENT:case Lr.NOT_FOUND:case Lr.ALREADY_EXISTS:case Lr.PERMISSION_DENIED:case Lr.FAILED_PRECONDITION:case Lr.ABORTED:case Lr.OUT_OF_RANGE:case Lr.UNIMPLEMENTED:case Lr.DATA_LOSS:return 1;default:return Rr(),0}}function Ti(t){if(void 0===t)return Cr("GRPC error has no .code"),Lr.UNKNOWN;switch(t){case mi.OK:return Lr.OK;case mi.CANCELLED:return Lr.CANCELLED;case mi.UNKNOWN:return Lr.UNKNOWN;case mi.DEADLINE_EXCEEDED:return Lr.DEADLINE_EXCEEDED;case mi.RESOURCE_EXHAUSTED:return Lr.RESOURCE_EXHAUSTED;case mi.INTERNAL:return Lr.INTERNAL;case mi.UNAVAILABLE:return Lr.UNAVAILABLE;case mi.UNAUTHENTICATED:return Lr.UNAUTHENTICATED;case mi.INVALID_ARGUMENT:return Lr.INVALID_ARGUMENT;case mi.NOT_FOUND:return Lr.NOT_FOUND;case mi.ALREADY_EXISTS:return Lr.ALREADY_EXISTS;case mi.PERMISSION_DENIED:return Lr.PERMISSION_DENIED;case mi.FAILED_PRECONDITION:return Lr.FAILED_PRECONDITION;case mi.ABORTED:return Lr.ABORTED;case mi.OUT_OF_RANGE:return Lr.OUT_OF_RANGE;case mi.UNIMPLEMENTED:return Lr.UNIMPLEMENTED;case mi.DATA_LOSS:return Lr.DATA_LOSS;default:return Rr()}}(l=mi={})[l.OK=0]="OK",l[l.CANCELLED=1]="CANCELLED",l[l.UNKNOWN=2]="UNKNOWN",l[l.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",l[l.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",l[l.NOT_FOUND=5]="NOT_FOUND",l[l.ALREADY_EXISTS=6]="ALREADY_EXISTS",l[l.PERMISSION_DENIED=7]="PERMISSION_DENIED",l[l.UNAUTHENTICATED=16]="UNAUTHENTICATED",l[l.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",l[l.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",l[l.ABORTED=10]="ABORTED",l[l.OUT_OF_RANGE=11]="OUT_OF_RANGE",l[l.UNIMPLEMENTED=12]="UNIMPLEMENTED",l[l.INTERNAL=13]="INTERNAL",l[l.UNAVAILABLE=14]="UNAVAILABLE",l[l.DATA_LOSS=15]="DATA_LOSS";var Ii=(_i.prototype.Tt=function(t,e){return new _i(this.k,this.root.Tt(t,e,this.k).copy(null,null,Ai.At,null,null))},_i.prototype.remove=function(t){return new _i(this.k,this.root.remove(t,this.k).copy(null,null,Ai.At,null,null))},_i.prototype.get=function(t){for(var e=this.root;!e.W();){var n=this.k(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},_i.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.W();){var r=this.k(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},_i.prototype.W=function(){return this.root.W()},Object.defineProperty(_i.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),_i.prototype.It=function(){return this.root.It()},_i.prototype.Rt=function(){return this.root.Rt()},_i.prototype.Pt=function(t){return this.root.Pt(t)},_i.prototype.forEach=function(n){this.Pt(function(t,e){return n(t,e),!1})},_i.prototype.toString=function(){var n=[];return this.Pt(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},_i.prototype.yt=function(t){return this.root.yt(t)},_i.prototype.Vt=function(){return new Ni(this.root,null,this.k,!1)},_i.prototype.gt=function(t){return new Ni(this.root,t,this.k,!1)},_i.prototype.vt=function(){return new Ni(this.root,null,this.k,!0)},_i.prototype.bt=function(t){return new Ni(this.root,t,this.k,!0)},_i),Ni=(Oi.prototype.Dt=function(){var t=this.St.pop(),e={key:t.key,value:t.value};if(this.Ct)for(t=t.left;!t.W();)this.St.push(t),t=t.right;else for(t=t.right;!t.W();)this.St.push(t),t=t.left;return e},Oi.prototype.Nt=function(){return 0<this.St.length},Oi.prototype.xt=function(){if(0===this.St.length)return null;var t=this.St[this.St.length-1];return{key:t.key,value:t.value}},Oi),Ai=(Ci.prototype.copy=function(t,e,n,r,i){return new Ci(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Ci.prototype.W=function(){return!1},Ci.prototype.Pt=function(t){return this.left.Pt(t)||t(this.key,this.value)||this.right.Pt(t)},Ci.prototype.yt=function(t){return this.right.yt(t)||t(this.key,this.value)||this.left.yt(t)},Ci.prototype.min=function(){return this.left.W()?this:this.left.min()},Ci.prototype.It=function(){return this.min().key},Ci.prototype.Rt=function(){return this.right.W()?this.key:this.right.Rt()},Ci.prototype.Tt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Tt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Tt(t,e,n))).Ft()},Ci.prototype.Ot=function(){if(this.left.W())return Ci.EMPTY;var t=this;return t.left.Lt()||t.left.left.Lt()||(t=t.$t()),(t=t.copy(null,null,null,t.left.Ot(),null)).Ft()},Ci.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.W()||r.left.Lt()||r.left.left.Lt()||(r=r.$t()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Lt()&&(r=r.kt()),r.right.W()||r.right.Lt()||r.right.left.Lt()||(r=r.Mt()),0===e(t,r.key)){if(r.right.W())return Ci.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Ot())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Ft()},Ci.prototype.Lt=function(){return this.color},Ci.prototype.Ft=function(){var t=this;return t.right.Lt()&&!t.left.Lt()&&(t=t.Ut()),t.left.Lt()&&t.left.left.Lt()&&(t=t.kt()),t.left.Lt()&&t.right.Lt()&&(t=t.qt()),t},Ci.prototype.$t=function(){var t=this.qt();return t.right.left.Lt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.kt())).Ut()).qt()),t},Ci.prototype.Mt=function(){var t=this.qt();return t.left.left.Lt()&&(t=(t=t.kt()).qt()),t},Ci.prototype.Ut=function(){var t=this.copy(null,null,Ci.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Ci.prototype.kt=function(){var t=this.copy(null,null,Ci.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Ci.prototype.qt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Ci.prototype.Bt=function(){var t=this.Qt();return Math.pow(2,t)<=this.size+1},Ci.prototype.Qt=function(){if(this.Lt()&&this.left.Lt())throw Rr();if(this.right.Lt())throw Rr();var t=this.left.Qt();if(t!==this.right.Qt())throw Rr();return t+(this.Lt()?0:1)},Ci);function Ci(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Ci.RED,this.left=null!=r?r:Ci.EMPTY,this.right=null!=i?i:Ci.EMPTY,this.size=this.left.size+1+this.right.size}function Oi(t,e,n,r){this.Ct=r,this.St=[];for(var i=1;!t.W();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Ct?t.left:t.right;else{if(0===i){this.St.push(t);break}this.St.push(t),t=this.Ct?t.right:t.left}}function _i(t,e){this.k=t,this.root=e||Ai.EMPTY}function Ri(){this.size=0}Ai.EMPTY=null,Ai.RED=!0,Ai.At=!1,Ai.EMPTY=(Object.defineProperty(Ri.prototype,"key",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ri.prototype,"value",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ri.prototype,"color",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ri.prototype,"left",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ri.prototype,"right",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Ri.prototype.copy=function(t,e,n,r,i){return this},Ri.prototype.Tt=function(t,e,n){return new Ai(t,e)},Ri.prototype.remove=function(t,e){return this},Ri.prototype.W=function(){return!0},Ri.prototype.Pt=function(t){return!1},Ri.prototype.yt=function(t){return!1},Ri.prototype.It=function(){return null},Ri.prototype.Rt=function(){return null},Ri.prototype.Lt=function(){return!1},Ri.prototype.Bt=function(){return!0},Ri.prototype.Qt=function(){return 0},new Ri);var ki=(Pi.prototype.has=function(t){return null!==this.data.get(t)},Pi.prototype.first=function(){return this.data.It()},Pi.prototype.last=function(){return this.data.Rt()},Object.defineProperty(Pi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Pi.prototype.indexOf=function(t){return this.data.indexOf(t)},Pi.prototype.forEach=function(n){this.data.Pt(function(t,e){return n(t),!1})},Pi.prototype.jt=function(t,e){for(var n=this.data.gt(t[0]);n.Nt();){var r=n.Dt();if(0<=this.k(r.key,t[1]))return;e(r.key)}},Pi.prototype.Wt=function(t,e){for(var n=void 0!==e?this.data.gt(e):this.data.Vt();n.Nt();)if(!t(n.Dt().key))return},Pi.prototype.Gt=function(t){return(t=this.data.gt(t)).Nt()?t.Dt().key:null},Pi.prototype.Vt=function(){return new Di(this.data.Vt())},Pi.prototype.gt=function(t){return new Di(this.data.gt(t))},Pi.prototype.add=function(t){return this.copy(this.data.remove(t).Tt(t,!0))},Pi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Pi.prototype.W=function(){return this.data.W()},Pi.prototype.Kt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Pi.prototype.isEqual=function(t){if(!(t instanceof Pi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.Vt(),n=t.data.Vt();e.Nt();){var r=e.Dt().key,i=n.Dt().key;if(0!==this.k(r,i))return!1}return!0},Pi.prototype.H=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Pi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Pi.prototype.copy=function(t){var e=new Pi(this.k);return e.data=t,e},Pi),Di=(Li.prototype.Dt=function(){return this.zt.Dt().key},Li.prototype.Nt=function(){return this.zt.Nt()},Li),Si=new Ii(ei.k);function Li(t){this.zt=t}function Pi(t){this.k=t,this.data=new Ii(this.k)}var Vi=new Ii(ei.k),Ui=new Ii(ei.k),ji=new ki(ei.k);function Mi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=ji,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var xi=new ki(Wr),qi=(no.Jt=function(t){return new no(t.k)},no.prototype.has=function(t){return null!=this.Ht.get(t)},no.prototype.get=function(t){return this.Ht.get(t)},no.prototype.first=function(){return this.Yt.It()},no.prototype.last=function(){return this.Yt.Rt()},no.prototype.W=function(){return this.Yt.W()},no.prototype.indexOf=function(t){return(t=this.Ht.get(t))?this.Yt.indexOf(t):-1},Object.defineProperty(no.prototype,"size",{get:function(){return this.Yt.size},enumerable:!1,configurable:!0}),no.prototype.forEach=function(n){this.Yt.Pt(function(t,e){return n(t),!1})},no.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ht.Tt(t.key,t),e.Yt.Tt(t,null))},no.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ht.remove(t),this.Yt.remove(e)):this},no.prototype.isEqual=function(t){if(!(t instanceof no))return!1;if(this.size!==t.size)return!1;for(var e=this.Yt.Vt(),n=t.Yt.Vt();e.Nt();){var r=e.Dt().key,i=n.Dt().key;if(!r.isEqual(i))return!1}return!0},no.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},no.prototype.copy=function(t,e){var n=new no;return n.k=this.k,n.Ht=t,n.Yt=e,n},no),Fi=(eo.prototype.track=function(t){var e=t.doc.key,n=this.Xt.get(e);!n||0!==t.type&&3===n.type?this.Xt=this.Xt.Tt(e,t):3===t.type&&1!==n.type?this.Xt=this.Xt.Tt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Xt=this.Xt.Tt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Xt=this.Xt.remove(e):1===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):Rr()},eo.prototype.Zt=function(){var n=[];return this.Xt.Pt(function(t,e){n.push(e)}),n},eo),Gi=(to.rn=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new to(t,e,qi.Jt(e),i,n,r,!0,!1)},Object.defineProperty(to.prototype,"hasPendingWrites",{get:function(){return!this.nn.W()},enumerable:!1,configurable:!0}),to.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.en===t.en&&this.nn.isEqual(t.nn)&&cu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.tn.isEqual(t.tn)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},to),zi=(Zi.an=function(t,e){var n=new Map;return n.set(t,Bi.ln(t,e)),new Zi(Jr.min(),n,xi,Si,Mi())},Zi),Bi=($i.ln=function(t,e){return new $i(yi.lt,e,Mi(),Mi(),Mi())},$i),Hi=function(t,e,n,r){this.En=t,this.removedTargetIds=e,this.key=n,this.mn=r},Wi=function(t,e){this.targetId=t,this.Tn=e},Yi=function(t,e,n,r){void 0===n&&(n=yi.lt),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Xi=(Object.defineProperty(Ji.prototype,"_n",{get:function(){return this.Pn},enumerable:!1,configurable:!0}),Object.defineProperty(Ji.prototype,"resumeToken",{get:function(){return this.Rn},enumerable:!1,configurable:!0}),Object.defineProperty(Ji.prototype,"Vn",{get:function(){return 0!==this.An},enumerable:!1,configurable:!0}),Object.defineProperty(Ji.prototype,"pn",{get:function(){return this.yn},enumerable:!1,configurable:!0}),Ji.prototype.gn=function(t){0<t.at()&&(this.yn=!0,this.Rn=t)},Ji.prototype.vn=function(){var n=Mi(),r=Mi(),i=Mi();return this.In.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Rr()}}),new Bi(this.Rn,this.Pn,n,r,i)},Ji.prototype.bn=function(){this.yn=!1,this.In=io()},Ji.prototype.Cn=function(t,e){this.yn=!0,this.In=this.In.Tt(t,e)},Ji.prototype.Sn=function(t){this.yn=!0,this.In=this.In.remove(t)},Ji.prototype.Dn=function(){this.An+=1},Ji.prototype.Nn=function(){--this.An},Ji.prototype.xn=function(){this.yn=!0,this.Pn=!0},Ji),Qi=(Ki.prototype.Mn=function(t){for(var e=0,n=t.En;e<n.length;e++){var r=n[e];t.mn instanceof Xs?this.Un(r,t.mn):t.mn instanceof Qs&&this.qn(r,t.key,t.mn)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.qn(s,t.key,t.mn)}},Ki.prototype.Bn=function(n){var r=this;this.Qn(n,function(t){var e=r.jn(t);switch(n.state){case 0:r.Wn(t)&&e.gn(n.resumeToken);break;case 1:e.Nn(),e.Vn||e.bn(),e.gn(n.resumeToken);break;case 2:e.Nn(),e.Vn||r.removeTarget(t);break;case 3:r.Wn(t)&&(e.xn(),e.gn(n.resumeToken));break;case 4:r.Wn(t)&&(r.Gn(t),e.gn(n.resumeToken));break;default:Rr()}})},Ki.prototype.Qn=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.On.forEach(function(t,e){r.Wn(e)&&n(e)})},Ki.prototype.Kn=function(t){var e=t.targetId,n=t.Tn.count;(t=this.zn(e))&&(di(t=t.target)?0===n?(t=new ei(t.path),this.qn(e,t,new Qs(t,Jr.min()))):kr(1===n):this.Hn(e)!==n&&(this.Gn(e),this.kn=this.kn.add(e)))},Ki.prototype.Yn=function(r){var i=this,o=new Map;this.On.forEach(function(t,e){var n=i.zn(e);n&&(t._n&&di(n.target)&&(n=new ei(n.target.path),null!==i.Ln.get(n)||i.Jn(e,n)||i.qn(e,n,new Qs(n,r))),t.pn&&(o.set(e,t.vn()),t.bn()))});var s=Mi();this.$n.forEach(function(t,e){var n=!0;e.Wt(function(t){return!(t=i.zn(t))||2===t._t||(n=!1)}),n&&(s=s.add(t))});var t=new zi(r,o,this.kn,this.Ln,s);return this.Ln=Si,this.$n=ro(),this.kn=new ki(Wr),t},Ki.prototype.Un=function(t,e){var n;this.Wn(t)&&(n=this.Jn(t,e.key)?2:0,this.jn(t).Cn(e.key,n),this.Ln=this.Ln.Tt(e.key,e),this.$n=this.$n.Tt(e.key,this.Xn(e.key).add(t)))},Ki.prototype.qn=function(t,e,n){var r;this.Wn(t)&&(r=this.jn(t),this.Jn(t,e)?r.Cn(e,1):r.Sn(e),this.$n=this.$n.Tt(e,this.Xn(e).delete(t)),n&&(this.Ln=this.Ln.Tt(e,n)))},Ki.prototype.removeTarget=function(t){this.On.delete(t)},Ki.prototype.Hn=function(t){var e=this.jn(t).vn();return this.Fn.Zn(t).size+e.fn.size-e.wn.size},Ki.prototype.Dn=function(t){this.jn(t).Dn()},Ki.prototype.jn=function(t){var e=this.On.get(t);return e||(e=new Xi,this.On.set(t,e)),e},Ki.prototype.Xn=function(t){var e=this.$n.get(t);return e||(e=new ki(Wr),this.$n=this.$n.Tt(t,e)),e},Ki.prototype.Wn=function(t){var e=null!==this.zn(t);return e||Ar("WatchChangeAggregator","Detected inactive target",t),e},Ki.prototype.zn=function(t){var e=this.On.get(t);return e&&e.Vn?null:this.Fn.te(t)},Ki.prototype.Gn=function(e){var n=this;this.On.set(e,new Xi),this.Fn.Zn(e).forEach(function(t){n.qn(e,t,null)})},Ki.prototype.Jn=function(t,e){return this.Fn.Zn(t).has(e)},Ki);function Ki(t){this.Fn=t,this.On=new Map,this.Ln=Si,this.$n=ro(),this.kn=new ki(Wr)}function Ji(){this.An=0,this.In=io(),this.Rn=yi.lt,this.Pn=!1,this.yn=!0}function $i(t,e,n,r,i){this.resumeToken=t,this._n=e,this.fn=n,this.dn=r,this.wn=i}function Zi(t,e,n,r,i){this.ft=t,this.on=e,this.un=n,this.cn=r,this.hn=i}function to(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.tn=n,this.docChanges=r,this.nn=i,this.fromCache=o,this.en=s,this.sn=u}function eo(){this.Xt=new Ii(ei.k)}function no(n){this.k=n?function(t,e){return n(t,e)||ei.k(t.key,e.key)}:function(t,e){return ei.k(t.key,e.key)},this.Ht=Vi,this.Yt=new Ii(this.k)}function ro(){return new Ii(ei.k)}function io(){return new Ii(ei.k)}function oo(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function so(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function uo(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function ao(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function ho(t){return t=mo(t.mapValue.fields.__local_write_time__.timestampValue),new Kr(t.seconds,t.nanos)}var co=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function lo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ao(t)?4:10:Rr()}function fo(r,i){var t,e=lo(r);if(e!==lo(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return ho(r).isEqual(ho(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=mo(r.timestampValue),t=mo(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,bo(r.bytesValue).isEqual(bo(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,wo((t=r).geoPointValue.latitude)===wo(e.geoPointValue.latitude)&&wo(t.geoPointValue.longitude)===wo(e.geoPointValue.longitude);case 2:return t=i,"integerValue"in(e=r)&&"integerValue"in t?wo(e.integerValue)===wo(t.integerValue):"doubleValue"in e&&"doubleValue"in t&&((e=wo(e.doubleValue))===(t=wo(t.doubleValue))?hi(e)===hi(t):isNaN(e)&&isNaN(t));case 9:return Yr(r.arrayValue.values||[],i.arrayValue.values||[],fo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(oo(e)!==oo(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!fo(e[t],n[t])))return!1;return!0}();default:return Rr()}}function po(t,e){return void 0!==(t.values||[]).find(function(t){return fo(t,e)})}function yo(t,e){var n,r,i,o=lo(t),s=lo(e);if(o!==s)return Wr(o,s);switch(o){case 0:return 0;case 1:return Wr(t.booleanValue,e.booleanValue);case 2:return n=e,(r=wo(t.integerValue||t.doubleValue))<(n=wo(n.integerValue||n.doubleValue))?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return vo(t.timestampValue,e.timestampValue);case 4:return vo(ho(t),ho(e));case 5:return Wr(t.stringValue,e.stringValue);case 6:return i=t.bytesValue,s=e.bytesValue,i=bo(i),s=bo(s),i.F(s);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Wr(n[i],r[i]);if(0!==o)return o}return Wr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return o=t.geoPointValue,r=e.geoPointValue,0!==(n=Wr(wo(o.latitude),wo(r.latitude)))?n:Wr(wo(o.longitude),wo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=yo(n[i],r[i]);if(o)return o}return Wr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Wr(r[s],o[s]);if(0!==u)return u;if(0!==(u=yo(n[r[s]],i[o[s]])))return u}return Wr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Rr()}}function vo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Wr(t,e);var n=mo(t),t=mo(e);return 0!==(e=Wr(n.seconds,t.seconds))?e:Wr(n.nanos,t.nanos)}function go(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=mo(t=i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?bo(i.bytesValue).toBase64():"referenceValue"in i?(e=i.referenceValue,ei.it(e).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Rr();var t,e}(t)}function mo(t){if(kr(!!t),"string"!=typeof t)return{seconds:wo(t.seconds),nanos:wo(t.nanos)};var e=0,n=co.exec(t);return kr(!!n),n[1]&&(n=(n[1]+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function wo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function bo(t){return"string"==typeof t?yi.fromBase64String(t):yi.fromUint8Array(t)}function Eo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.Y()}}function To(t){return t&&"integerValue"in t}function Io(t){return!!t&&"arrayValue"in t}function No(t){return t&&"nullValue"in t}function Ao(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Co(t){return t&&"mapValue"in t}var Oo={asc:"ASCENDING",desc:"DESCENDING"},_o={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ro=function(t,e){this.t=t,this.ne=e};function ko(t){return{integerValue:""+t}}function Do(t,e){if(t.ne){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:hi(e)?"-0":e}}function So(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!hi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?ko(e):Do(t,e);var n}function Lo(t,e){return t.ne?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Po(t,e){return t.ne?e.toBase64():e.toUint8Array()}function Vo(t){return kr(!!t),Jr.N((t=mo(t),new Kr(t.seconds,t.nanos)))}function Uo(t,e){return new $r(["projects",t.projectId,"databases",t.database]).child("documents").child(e).Y()}function jo(t){return kr(Ko(t=$r.J(t))),t}function Mo(t,e){return Uo(t.t,e.path)}function xo(t,e){if((e=jo(e)).get(1)!==t.t.projectId)throw new Pr(Lr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.t.projectId);if(e.get(3)!==t.t.database)throw new Pr(Lr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.t.database);return new ei(Go(e))}function qo(t,e){return Uo(t.t,e)}function Fo(t){return new $r(["projects",t.t.projectId,"databases",t.t.database]).Y()}function Go(t){return kr(4<t.length&&"documents"===t.get(4)),t.U(5)}function zo(t,e,n){return{name:Mo(t,e),fields:n.proto.mapValue.fields}}function Bo(t,e){var n,r,i;if(e instanceof Cs)n={update:zo(t,e.key,e.value)};else if(e instanceof js)n={delete:Mo(t,e.key)};else if(e instanceof Os)n={update:zo(t,e.key,e.data),updateMask:(i=e.ee,r=[],i.fields.forEach(function(t){return r.push(t.Y())}),{fieldPaths:r})};else if(e instanceof Ss)n={transform:{document:Mo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof ts)return{fieldPath:t.field.Y(),setToServerValue:"REQUEST_TIME"};if(e instanceof es)return{fieldPath:t.field.Y(),appendMissingElements:{values:e.elements}};if(e instanceof ss)return{fieldPath:t.field.Y(),removeAllFromArray:{values:e.elements}};if(e instanceof cs)return{fieldPath:t.field.Y(),increment:e.se};throw Rr()})}};else{if(!(e instanceof Ms))return Rr();n={verify:Mo(t,e.key)}}return e.re.ie||(n.currentDocument=void 0!==(i=e.re).updateTime?{updateTime:Lo(e=t,(t=i.updateTime).L())}:void 0!==i.exists?{exists:i.exists}:Rr()),n}function Ho(t){var e=4===(o=jo(t.parent)).length?$r.X():Go(o),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(kr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Qo(t.unaryFilter.field);return vu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Qo(t.unaryFilter.field);return vu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":return n=Qo(t.unaryFilter.field),vu.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":return t=Qo(t.unaryFilter.field),vu.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Rr()}}(e)]:void 0!==e.fieldFilter?[(n=e,vu.create(Qo(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Rr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):Rr():[];var n}(n.where)),t=[],n.orderBy&&(t=n.orderBy.map(function(t){return new Bu(Qo((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e})),r=null,n.limit&&(r=ai(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=Yo(n.startAt));var u=null;return n.endAt&&(u=Yo(n.endAt)),new Js(e,i,t,o,r,"F",s,u)}function Wo(t){return{before:t.before,values:t.position}}function Yo(t){var e=!!t.before,t=t.values||[];return new Uu(t,e)}function Xo(t){return{fieldPath:t.Y()}}function Qo(t){return ti.et(t.fieldPath)}function Ko(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function Jo(t,e){return t instanceof cs?To(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var $o,Zo,ts=(n(rs,Zo=me=function(){this.oe=void 0}),rs),es=(n(ns,$o=me),ns);function ns(t){var e=this;return(e=$o.call(this)||this).elements=t,e}function rs(){return null!==Zo&&Zo.apply(this,arguments)||this}function is(t,e){for(var n=ps(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return fo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var os,ss=(n(us,os=me),us);function us(t){var e=this;return(e=os.call(this)||this).elements=t,e}function as(t,e){for(var n=ps(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!fo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var hs,cs=(n(ls,hs=me),ls);function ls(t,e){var n=this;return(n=hs.call(this)||this).serializer=t,n.se=e,n}function fs(t){return wo(t.integerValue||t.doubleValue)}function ps(t){return Io(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function ds(t,e){this.field=t,this.transform=e}var ys=(vs.prototype.ue=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].G(t))return!0;return!1},vs.prototype.isEqual=function(t){return Yr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},vs);function vs(t){(this.fields=t).sort(ti.k)}function gs(t,e){this.version=t,this.transformResults=e}var ms=(ws.ce=function(){return new ws},ws.exists=function(t){return new ws(void 0,t)},ws.updateTime=function(t){return new ws(t)},Object.defineProperty(ws.prototype,"ie",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),ws.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},ws);function ws(t,e){this.updateTime=t,this.exists=e}function bs(t,e){return void 0!==t.updateTime?e instanceof Xs&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Xs}function Es(t,e,n,r){return t instanceof Cs?(o=e,bs((i=t).re,o)?(o=Is(o),new Xs(i.key,o,i.value,{he:!0})):o):t instanceof Os?function(t,e){if(!bs(t.re,e))return e;var n=Is(e),e=ks(t,e);return new Xs(t.key,n,e,{he:!0})}(t,e):t instanceof Ss?function(t,e,n,r){if(!bs(t.re,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],h=a.transform,c=null;n instanceof Xs&&(c=n.field(a.field)),null===c&&r instanceof Xs&&(c=r.field(a.field)),o.push((i=c,a=e,c=void 0,h instanceof ts?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(c.fields.__previous_value__=i),{mapValue:c}):h instanceof es?is(h,i):h instanceof ss?as(h,i):(i=fs(h=Jo(c=h,i))+fs(c.se),To(h)&&To(c.se)?ko(i):Do(c.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=Ps(t,i.data(),r);return new Xs(t.key,i.version,r,{he:!0})}(t,e,r,n):bs(t.re,e)?new Qs(t.key,Jr.min()):e;var i,o}function Ts(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.re.isEqual(e.re)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.ee.isEqual(e.ee):2!==t.type||Yr(t.fieldTransforms,t.fieldTransforms,function(t,e){return t.field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof es&&e instanceof es||t instanceof ss&&e instanceof ss?Yr(t.elements,e.elements,fo):t instanceof cs&&e instanceof cs?fo(t.se,e.se):t instanceof ts&&e instanceof ts)}))}function Is(t){return t instanceof Xs?t.version:Jr.min()}var Ns,As,Cs=(n(Rs,As=l=function(){}),Rs),Os=(n(_s,Ns=l),_s);function _s(t,e,n,r){var i=this;return(i=Ns.call(this)||this).key=t,i.data=e,i.ee=n,i.re=r,i.type=1,i}function Rs(t,e,n){var r=this;return(r=As.call(this)||this).key=t,r.value=e,r.re=n,r.type=0,r}function ks(t,e){return n=t,e=e instanceof Xs?e.data():xs.empty(),r=new qs(e),n.ee.fields.forEach(function(t){var e;t.W()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.ae();var n,r}var Ds,Ss=(n(Ls,Ds=l),Ls);function Ls(t,e){var n=this;return(n=Ds.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.re=ms.exists(!0),n}function Ps(t,e,n){for(var r=new qs(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.ae()}var Vs,Us,js=(n(Bs,Us=l),Bs),Ms=(n(zs,Vs=l),zs),xs=(Gs.empty=function(){return new Gs({mapValue:{}})},Gs.prototype.field=function(t){if(t.W())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Co(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.j()])||null},Gs.prototype.isEqual=function(t){return fo(this.proto,t.proto)},Gs),qs=(Fs.prototype.set=function(t,e){return this.fe(t,e),this},Fs.prototype.delete=function(t){return this.fe(t,null),this},Fs.prototype.fe=function(t,e){for(var n=this._e,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===lo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.j(),e)},Fs.prototype.ae=function(){var t=this.de(ti.X(),this._e);return null!=t?new xs(t):this.le},Fs.prototype.de=function(r,t){var i=this,o=!1,e=this.le.field(r),s=Co(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.de(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Fs);function Fs(t){void 0===t&&(t=xs.empty()),this.le=t,this._e=new Map}function Gs(t){this.proto=t}function zs(t,e){var n=this;return(n=Vs.call(this)||this).key=t,n.re=e,n.type=4,n}function Bs(t,e){var n=this;return(n=Us.call(this)||this).key=t,n.re=e,n.type=3,n}var Hs,Ws,Ys,Xs=(n(tu,Ys=me=function(t,e){this.key=t,this.version=e}),tu.prototype.field=function(t){return this.we.field(t)},tu.prototype.data=function(){return this.we},tu.prototype.Ee=function(){return this.we.proto},tu.prototype.isEqual=function(t){return t instanceof tu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.he===t.he&&this.hasCommittedMutations===t.hasCommittedMutations&&this.we.isEqual(t.we)},tu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.we.toString()+", {hasLocalMutations: "+this.he+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(tu.prototype,"hasPendingWrites",{get:function(){return this.he||this.hasCommittedMutations},enumerable:!1,configurable:!0}),tu),Qs=(n(Zs,Ws=me),Zs.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Zs.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Zs.prototype.isEqual=function(t){return t instanceof Zs&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Zs),Ks=(n($s,Hs=me),$s.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty($s.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),$s.prototype.isEqual=function(t){return t instanceof $s&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},$s),Js=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.me=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Te=null,this.Ae=null,this.startAt,this.endAt};function $s(){return null!==Hs&&Hs.apply(this,arguments)||this}function Zs(t,e,n){var r=this;return(r=Ws.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function tu(t,e,n,r){var i=this;return(i=Ys.call(this,t,e)||this).we=n,i.he=!!r.he,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function eu(t){return new Js(t)}function nu(t){return!ai(t.limit)&&"F"===t.limitType}function ru(t){return!ai(t.limit)&&"L"===t.limitType}function iu(t){return 0<t.me.length?t.me[0].field:null}function ou(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.Ie())return r.field}return null}function su(t){return null!==t.collectionGroup}function uu(t){var e=t;if(null===e.Te){e.Te=[];var n=ou(e),t=iu(e);if(null!==n&&null===t)n.tt()||e.Te.push(new Bu(n)),e.Te.push(new Bu(ti.nt(),"asc"));else{for(var r=!1,i=0,o=e.me;i<o.length;i++){var s=o[i];e.Te.push(s),s.field.tt()&&(r=!0)}r||(n=0<e.me.length?e.me[e.me.length-1].dir:"asc",e.Te.push(new Bu(ti.nt(),n)))}}return e.Te}function au(t){var e=t;if(!e.Ae)if("F"===e.limitType)e.Ae=li(e.path,e.collectionGroup,uu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=uu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Bu(o.field,s))}var u=e.endAt?new Uu(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Uu(e.startAt.position,!e.startAt.before):null;e.Ae=li(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.Ae}function hu(t,e,n){return new Js(t.path,t.collectionGroup,t.me.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function cu(t,e){return pi(au(t),au(e))&&t.limitType===e.limitType}function lu(t){return fi(au(t))+"|lt:"+t.limitType}function fu(t){return"Query(target="+(n=(e=au(t)).path.Y(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return t.field.Y()+" "+t.op+" "+go(t.value)}).join(", ")+"]"),ai(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return t.field.Y()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Fu(e.startAt)),e.endAt&&(n+=", endAt: "+Fu(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function pu(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.rt(e.collectionGroup)&&e.path.G(n):ei.ot(e.path)?e.path.isEqual(n):e.path.K(n))&&function(t){for(var e=0,n=i.me;e<n.length;e++){var r=n[e];if(!r.field.tt()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||Gu(t.startAt,uu(t),n))&&(!t.endAt||!Gu(t.endAt,uu(t),n)));var e,n}function du(u){return function(t,e){for(var n=!1,r=0,i=uu(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i;switch(n=t.field.tt()?ei.k(e.key,n.key):(r=t.field,i=n,e=e.field(r),r=i.field(r),null!==e&&null!==r?yo(e,r):Rr()),t.dir){case"asc":return n;case"desc":return-1*n;default:return Rr()}}(o,t,e);if(0!==s)return s;n=n||o.field.tt()}return 0}}var yu,vu=(n(gu,yu=function(){}),gu.create=function(t,e,n){return t.tt()?"in"===e||"not-in"===e?this.Re(t,e,n):new Eu(t,e,n):"array-contains"===e?new Su(t,n):"in"===e?new Lu(t,n):"not-in"===e?new Pu(t,n):"array-contains-any"===e?new Vu(t,n):new gu(t,e,n)},gu.Re=function(t,e,n){return new("in"===e?Tu:Iu)(t,n)},gu.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this.Pe(yo(t,this.value)):null!==t&&lo(this.value)===lo(t)&&this.Pe(yo(t,this.value))},gu.prototype.Pe=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Rr()}},gu.prototype.Ie=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},gu);function gu(t,e,n){var r=this;return(r=yu.call(this)||this).field=t,r.op=e,r.value=n,r}var mu,wu,bu,Eu=(n(Cu,bu=vu),Cu.prototype.matches=function(t){return t=ei.k(t.key,this.key),this.Pe(t)},Cu),Tu=(n(Au,wu=vu),Au.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Au),Iu=(n(Nu,mu=vu),Nu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Nu);function Nu(t,e){var n=this;return(n=mu.call(this,t,"not-in",e)||this).keys=Ou(0,e),n}function Au(t,e){var n=this;return(n=wu.call(this,t,"in",e)||this).keys=Ou(0,e),n}function Cu(t,e,n){var r=this;return(r=bu.call(this,t,e,n)||this).key=ei.it(n.referenceValue),r}function Ou(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return ei.it(t.referenceValue)})}var _u,Ru,ku,Du,Su=(n(qu,Du=vu),qu.prototype.matches=function(t){return Io(t=t.field(this.field))&&po(t.arrayValue,this.value)},qu),Lu=(n(xu,ku=vu),xu.prototype.matches=function(t){return null!==(t=t.field(this.field))&&po(this.value.arrayValue,t)},xu),Pu=(n(Mu,Ru=vu),Mu.prototype.matches=function(t){return!po(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&(null!==(t=t.field(this.field))&&!po(this.value.arrayValue,t))},Mu),Vu=(n(ju,_u=vu),ju.prototype.matches=function(t){var e=this;return!(!Io(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return po(e.value.arrayValue,t)})},ju),Uu=function(t,e){this.position=t,this.before=e};function ju(t,e){return _u.call(this,t,"array-contains-any",e)||this}function Mu(t,e){return Ru.call(this,t,"not-in",e)||this}function xu(t,e){return ku.call(this,t,"in",e)||this}function qu(t,e){return Du.call(this,t,"array-contains",e)||this}function Fu(t){return(t.before?"b":"a")+":"+t.position.map(go).join(",")}function Gu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.tt()?ei.k(ei.it(s.referenceValue),n.key):yo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function zu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!fo(t.position[n],e.position[n]))return!1;return!0}var Bu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e},Hu=(Zu.prototype.Ve=function(t,e,n){for(var r,i,o,s,u,a=n.pe,h=0;h<this.mutations.length;h++){var c=this.mutations[h];c.key.isEqual(t)&&(r=c,i=e,o=a[h],c=u=s=void 0,e=r instanceof Cs?new Xs(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof Os?(u=i,c=o,bs((s=r).re,u)?(u=ks(s,u),new Xs(s.key,c.version,u,{hasCommittedMutations:!0})):new Ks(s.key,c.version)):r instanceof Ss?function(t,e,n){if(kr(null!=n.transformResults),!bs(t.re,e))return new Ks(t.key,n.version);var r=e,e=function(t,e,n){var r=[];kr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Xs&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof es?is(o,s):o instanceof ss?as(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=Ps(t,r.data(),e);return new Xs(t.key,n,e,{hasCommittedMutations:!0})}(r,i,o):new Qs(r.key,o.version,{hasCommittedMutations:!0}))}return e},Zu.prototype.ge=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Es(i,e,e,this.ye))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Es(a,e,o,this.ye))}return e},Zu.prototype.ve=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.ge(t.key,n.get(t.key));e&&(i=i.Tt(t.key,e))}),i},Zu.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Mi())},Zu.prototype.isEqual=function(t){return this.batchId===t.batchId&&Yr(this.mutations,t.mutations,Ts)&&Yr(this.baseMutations,t.baseMutations,Ts)},Zu),Wu=($u.from=function(t,e,n){kr(t.mutations.length===n.length);for(var r=Ui,i=t.mutations,o=0;o<i.length;o++)r=r.Tt(i[o].key,n[o].version);return new $u(t,e,n,r)},$u),Yu=(Ju.prototype.get=function(t){var e=this.Se(t);if(void 0!==(e=this.Ne[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.De(i,t))return o}},Ju.prototype.has=function(t){return void 0!==this.get(t)},Ju.prototype.set=function(t,e){var n=this.Se(t),r=this.Ne[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.De(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.Ne[n]=[[t,e]]},Ju.prototype.delete=function(t){var e=this.Se(t),n=this.Ne[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.De(n[r][0],t))return 1===n.length?delete this.Ne[e]:n.splice(r,1),!0;return!1},Ju.prototype.forEach=function(s){so(this.Ne,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];s(i,o)}})},Ju.prototype.W=function(){return uo(this.Ne)},Ju),Xu=(Ku.prototype.catch=function(t){return this.next(void 0,t)},Ku.prototype.next=function(r,i){var o=this;return this.Le&&Rr(),this.Le=!0,this.Oe?this.error?this.$e(i,this.error):this.ke(r,this.result):new Ku(function(e,n){o.xe=function(t){o.ke(r,t).next(e,n)},o.Fe=function(t){o.$e(i,t).next(e,n)}})},Ku.prototype.Me=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Ku.prototype.Ue=function(t){try{var e=t();return e instanceof Ku?e:Ku.resolve(e)}catch(t){return Ku.reject(t)}},Ku.prototype.ke=function(t,e){return t?this.Ue(function(){return t(e)}):Ku.resolve(e)},Ku.prototype.$e=function(t,e){return t?this.Ue(function(){return t(e)}):Ku.reject(e)},Ku.resolve=function(n){return new Ku(function(t,e){t(n)})},Ku.reject=function(n){return new Ku(function(t,e){e(n)})},Ku.qe=function(t){return new Ku(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Ku.Be=function(t){for(var n=Ku.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Ku.resolve(t):e()})}(r[e]);return n},Ku.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.qe(i)},Ku),Qu=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})};function Ku(t){var e=this;this.xe=null,this.Fe=null,this.result=void 0,this.error=void 0,this.Oe=!1,this.Le=!1,t(function(t){e.Oe=!0,e.result=t,e.xe&&e.xe(t)},function(t){e.Oe=!0,e.error=t,e.Fe&&e.Fe(t)})}function Ju(t,e){this.Se=t,this.De=e,this.Ne={}}function $u(t,e,n,r){this.batch=t,this.be=e,this.pe=n,this.Ce=r}function Zu(t,e,n,r){this.batchId=t,this.ye=e,this.baseMutations=n,this.mutations=r}function ta(t){return new Ro(t,!0)}function ea(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var na=(ua.prototype.Ge=function(e,n){var r=this;return this.je.Ke(e,n).next(function(t){return r.ze(e,n,t)})},ua.prototype.ze=function(t,r,i){return this.Qe.He(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].ge(r,t);return t})},ua.prototype.Ye=function(t,e,i){var o=Si;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].ge(t,e);o=o.Tt(t,e)}),o},ua.prototype.Je=function(e,t){var n=this;return this.Qe.getEntries(e,t).next(function(t){return n.Xe(e,t)})},ua.prototype.Xe=function(e,r){var i=this;return this.je.Ze(e,r).next(function(t){var t=i.Ye(e,r,t),n=Si;return t.forEach(function(t,e){e=e||new Qs(t,Jr.min()),n=n.Tt(t,e)}),n})},ua.prototype.ts=function(t,e,n){return r=e,ei.ot(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.ns(t,e.path):su(e)?this.es(t,e,n):this.ss(t,e,n);var r},ua.prototype.ns=function(t,e){return this.Ge(t,new ei(e)).next(function(t){var e=Vi;return t instanceof Xs&&(e=e.Tt(t.key,t)),e})},ua.prototype.es=function(n,r,i){var o=this,s=r.collectionGroup,u=Vi;return this.We.rs(n,s).next(function(t){return Xu.forEach(t,function(t){var e=(e=r,t=t.child(s),new Js(t,null,e.me.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.ss(n,e,i).next(function(t){t.forEach(function(t,e){u=u.Tt(t,e)})})}).next(function(){return u})})},ua.prototype.ss=function(e,n,t){var a,h,r=this;return this.Qe.ts(e,n,t).next(function(t){return a=t,r.je.os(e,n)}).next(function(t){return h=t,r.us(e,h,a).next(function(t){a=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,s=Es(s,s=a.get(u),s,r.ye);a=s instanceof Xs?a.Tt(u,s):a.remove(u)}})}).next(function(){return a.forEach(function(t,e){pu(n,e)||(a=a.remove(t))}),a})},ua.prototype.us=function(t,e,n){for(var r=Mi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Os&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.Qe.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Xs&&(h=h.Tt(t,e))}),h})},ua),ra=(sa.ls=function(t,e){for(var n=Mi(),r=Mi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new sa(t,e.fromCache,n,r)},sa),ia=(oa.prototype.fs=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},oa.prototype.next=function(){var t=++this.previousValue;return this.ds&&this.ds(t),t},oa);function oa(t,e){var n=this;this.previousValue=t,e&&(e._s=function(t){return n.fs(t)},this.ds=function(t){return e.ws(t)})}function sa(t,e,n,r){this.targetId=t,this.fromCache=e,this.cs=n,this.hs=r}function ua(t,e,n){this.Qe=t,this.je=e,this.We=n}ia.Es=-1;var aa=(ha.prototype.reset=function(){this.ys=0},ha.prototype.gs=function(){this.ys=this.Ps},ha.prototype.vs=function(t){var e=this;this.cancel();var n=Math.floor(this.ys+this.bs()),r=Math.max(0,Date.now()-this.ps),i=Math.max(0,n-r);0<i&&Ar("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.ys+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Vs=this.Ts.Cs(this.As,i,function(){return e.ps=Date.now(),t()}),this.ys*=this.Rs,this.ys<this.Is&&(this.ys=this.Is),this.ys>this.Ps&&(this.ys=this.Ps)},ha.prototype.Ss=function(){null!==this.Vs&&(this.Vs.Ds(),this.Vs=null)},ha.prototype.cancel=function(){null!==this.Vs&&(this.Vs.cancel(),this.Vs=null)},ha.prototype.bs=function(){return(Math.random()-.5)*this.ys},ha);function ha(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Ts=t,this.As=e,this.Is=n,this.Rs=r,this.Ps=i,this.ys=0,this.Vs=null,this.ps=Date.now(),this.reset()}function ca(t){return"IndexedDbTransactionError"===t.name}function la(){return"undefined"!=typeof document?document:null}var fa=(ya.Ls=function(t,e,n,r,i){return(i=new ya(t,e,Date.now()+n,r,i)).start(n),i},ya.prototype.start=function(t){var e=this;this.$s=setTimeout(function(){return e.ks()},t)},ya.prototype.Ds=function(){return this.ks()},ya.prototype.cancel=function(t){null!==this.$s&&(this.clearTimeout(),this.Os.reject(new Pr(Lr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},ya.prototype.ks=function(){var e=this;this.Ns.Ms(function(){return null!==e.$s?(e.clearTimeout(),e.op().then(function(t){return e.Os.resolve(t)})):Promise.resolve()})},ya.prototype.clearTimeout=function(){null!==this.$s&&(this.Fs(this),clearTimeout(this.$s),this.$s=null)},ya),pa=(Object.defineProperty(da.prototype,"Hs",{get:function(){return this.Bs},enumerable:!1,configurable:!0}),da.prototype.Ms=function(t){this.enqueue(t)},da.prototype.Ys=function(t){this.Js(),this.Xs(t)},da.prototype.Zs=function(){var t;this.Bs||(this.Bs=!0,(t=la())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.zs))},da.prototype.enqueue=function(t){return this.Js(),this.Bs?new Promise(function(t){}):this.Xs(t)},da.prototype.ti=function(t){var e=this;this.Ms(function(){return e.qs.push(t),e.ni()})},da.prototype.ni=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.qs.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.qs[0]()];case 2:return t.sent(),this.qs.shift(),this.Ks.reset(),[3,4];case 3:if(!ca(e=t.sent()))throw e;return Ar("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.qs.length&&this.Ks.vs(function(){return n.ni()}),t.label=5;case 5:return[2]}})})},da.prototype.Xs=function(t){var r=this,e=this.Us.then(function(){return r.Ws=!0,t().catch(function(t){throw r.js=t,r.Ws=!1,Cr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Ws=!1,t})});return this.Us=e},da.prototype.Cs=function(t,e,n){var r=this;return this.Js(),-1<this.Gs.indexOf(t)&&(e=0),n=fa.Ls(this,t,e,n,function(t){return r.ei(t)}),this.Qs.push(n),n},da.prototype.Js=function(){this.js&&Rr()},da.prototype.si=function(){},da.prototype.ii=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Us];case 1:t.sent(),t.label=2;case 2:if(e!==this.Us)return[3,0];t.label=3;case 3:return[2]}})})},da.prototype.ri=function(t){for(var e=0,n=this.Qs;e<n.length;e++)if(n[e].As===t)return!0;return!1},da.prototype.oi=function(r){var i=this;return this.ii().then(function(){i.Qs.sort(function(t,e){return t.xs-e.xs});for(var t=0,e=i.Qs;t<e.length;t++){var n=e[t];if(n.Ds(),"all"!==r&&n.As===r)break}return i.ii()})},da.prototype.ui=function(t){this.Gs.push(t)},da.prototype.ei=function(t){t=this.Qs.indexOf(t),this.Qs.splice(t,1)},da);function da(){var e=this;this.Us=Promise.resolve(),this.qs=[],this.Bs=!1,this.Qs=[],this.js=null,this.Ws=!1,this.Gs=[],this.Ks=new aa(this,"async_queue_retry"),this.zs=function(){var t=la();t&&Ar("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Ks.Ss()};var t=la();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.zs)}function ya(t,e,n,r,i){this.Ns=t,this.As=e,this.xs=n,this.op=r,this.Fs=i,this.Os=new Qu,this.then=this.Os.promise.then.bind(this.Os.promise),this.Os.promise.catch(function(t){})}function va(t,e){if(Cr("AsyncQueue",e+": "+t),ca(t))return new Pr(Lr.UNAVAILABLE,e+": "+t);throw t}function ga(t){this.fi=t}var ma=(wa.prototype.ci=function(t){this.hi=t},wa.prototype.ts=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.me.length||1===r.me.length&&r.me[0].field.tt())||i.isEqual(Jr.min())?this.ai(e,r):this.hi.Je(e,o).next(function(t){var n=s.li(r,t);return(nu(r)||ru(r))&&s._i(r.limitType,n,o,i)?s.ai(e,r):(Nr()<=u.DEBUG&&Ar("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),fu(r)),s.hi.ts(e,r,i).next(function(e){return n.forEach(function(t){e=e.Tt(t.key,t)}),e}))})},wa.prototype.li=function(n,t){var r=new ki(du(n));return t.forEach(function(t,e){e instanceof Xs&&pu(n,e)&&(r=r.add(e))}),r},wa.prototype._i=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version.F(r))},wa.prototype.ai=function(t,e){return Nr()<=u.DEBUG&&Ar("QueryEngine","Using full collection scan to execute query:",fu(e)),this.hi.ts(t,e,Jr.min())},wa);function wa(){}var ba=(Oa.prototype.wi=function(t,e){return this.di.add(e),Xu.resolve()},Oa.prototype.rs=function(t,e){return Xu.resolve(this.di.getEntries(e))},Oa),Ea=(Ca.prototype.add=function(t){var e=t.j(),n=t.q(),r=this.index[e]||new ki($r.k),t=!r.has(n);return this.index[e]=r.add(n),t},Ca.prototype.has=function(t){var e=t.j(),t=t.q();return(e=this.index[e])&&e.has(t)},Ca.prototype.getEntries=function(t){return(this.index[t]||new ki($r.k)).H()},Ca),Ta=(Aa.prototype.next=function(){return this.Ei+=2,this.Ei},Aa.mi=function(){return new Aa(0)},Aa.Ti=function(){return new Aa(-1)},Aa),Ia=(Na.prototype.Ni=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.xi(t,n.Ii)})},Na);function Na(t,e,n,r){this.persistence=t,this.Ai=e,this.serializer=r,this.Ii=new Ii(Wr),this.Ri=new Yu(fi,pi),this.Pi=Jr.min(),this.je=t.yi(n),this.Vi=t.pi(),this.gi=t.vi(),this.bi=new na(this.Vi,this.je,this.persistence.Ci()),this.Si=t.Di(),this.Ai.ci(this.bi)}function Aa(t){this.Ei=t}function Ca(){this.index={}}function Oa(){this.di=new Ea}function _a(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).je,m=e.bi,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.je.Fi(v).next(function(t){return g=t,n=e.persistence.yi(o),m=new na(e.Vi,n,e.persistence.Ci()),n.Fi(v)}).next(function(t){for(var e=[],n=[],r=Mi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Je(v,r).next(function(t){return{Oi:t,Li:e,$i:n}})})})];case 1:return r=t.sent(),[2,(e.je=n,e.bi=m,e.Ai.ci(e.bi),r)]}})})}function Ra(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.gi.Qi(t)})}function ka(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).Ii.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Hi.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!ca(r=t.sent()))throw r;return Ar("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.Ii=e.Ii.remove(o),e.Ri.delete(n.target),[2]}})})}function Da(t,o,s){var u=t,a=Jr.min(),h=Mi();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=au(o),(void 0!==(t=(i=t).Ri.get(r))?Xu.resolve(i.Ii.get(t)):i.gi.Zi(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.gi.tr(e,t.targetId).next(function(t){h=t})}).next(function(){return u.Ai.ts(e,o,s?a:Jr.min(),s?h:Mi())}).next(function(t){return{documents:t,nr:h}});var t,n,r,i})}function Sa(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Lr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Ar("LocalStore","Unexpectedly lost primary lease"),[2]})})}function La(t,e,n,r,i){var o=this;this.zr=t,this.Hr=e,this.Ns=n,this.Yr={},this.Jr=[],this.Xr=new Map,this.Zr=new Set,this.no=[],this.eo=i,this.eo.so(function(t){n.Ms(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return th(this)?(Ar("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Zr.add(4),[4,Ya(e)];case 1:return t.sent(),e.io.set("Unknown"),e.Zr.delete(4),[4,Wa(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.io=new qa(n,r)}var Pa,Va,Ua,l=(Ha.prototype.cr=function(){return 1===this.state||2===this.state||4===this.state},Ha.prototype.hr=function(){return 2===this.state},Ha.prototype.start=function(){3!==this.state?this.auth():this.ar()},Ha.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.cr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Ha.prototype.lr=function(){this.state=0,this.Ks.reset()},Ha.prototype._r=function(){var t=this;this.hr()&&null===this.ur&&(this.ur=this.Ts.Cs(this.er,6e4,function(){return t.dr()}))},Ha.prototype.wr=function(t){this.Er(),this.stream.send(t)},Ha.prototype.dr=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.hr()?[2,this.close(0)]:[2]})})},Ha.prototype.Er=function(){this.ur&&(this.ur.cancel(),this.ur=null)},Ha.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Er(),this.Ks.cancel(),this.rr++,3!==e?this.Ks.reset():n&&n.code===Lr.RESOURCE_EXHAUSTED?(Cr(n.toString()),Cr("Using maximum backoff delay to prevent overloading the backend."),this.Ks.gs()):n&&n.code===Lr.UNAUTHENTICATED&&this.ir.A(),null!==this.stream&&(this.mr(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Tr(n)];case 1:return t.sent(),[2]}})})},Ha.prototype.mr=function(){},Ha.prototype.auth=function(){var n=this;this.state=1;var t=this.Ar(this.rr),e=this.rr;this.ir.getToken().then(function(t){n.rr===e&&n.Ir(t)},function(e){t(function(){var t=new Pr(Lr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Rr(t)})})},Ha.prototype.Ir=function(t){var e=this,n=this.Ar(this.rr);this.stream=this.Pr(t),this.stream.yr(function(){n(function(){return e.state=2,e.listener.yr()})}),this.stream.Tr(function(t){n(function(){return e.Rr(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Ha.prototype.ar=function(){var t=this;this.state=4,this.Ks.vs(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},Ha.prototype.Rr=function(t){return Ar("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Ha.prototype.Ar=function(e){var n=this;return function(t){n.Ts.Ms(function(){return n.rr===e?t():(Ar("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Ha),ja=(n(Ba,Ua=l),Ba.prototype.Pr=function(t){return this.sr.Vr("Listen",t)},Ba.prototype.onMessage=function(t){this.Ks.reset();var e,n=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:Rr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.ne?(kr(void 0===o||"string"==typeof o),yi.fromBase64String(o||"")):(kr(void 0===o||o instanceof Uint8Array),yi.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Lr.UNKNOWN:Ti(s.code),new Pr(o,s.message||"")),r=new Yi(n,r,i,s||null)}else if("documentChange"in e){e.documentChange,(a=e.documentChange).document,a.document.name,a.document.updateTime;var i=xo(t,a.document.name),u=Vo(a.document.updateTime),s=new xs({mapValue:{fields:a.document.fields}}),u=new Xs(i,u,s,{}),s=a.targetIds||[],a=a.removedTargetIds||[];r=new Hi(s,a,u.key,u)}else if("documentDelete"in e){e.documentDelete,(a=e.documentDelete).document;var u=xo(t,a.document),h=a.readTime?Vo(a.readTime):Jr.min(),h=new Qs(u,h),a=a.removedTargetIds||[];r=new Hi([],a,h.key,h)}else if("documentRemove"in e){e.documentRemove,(h=e.documentRemove).document;var c=xo(t,h.document),h=h.removedTargetIds||[];r=new Hi([],h,c,null)}else{if(!("filter"in e))return Rr();e.filter,(c=e.filter).targetId,e=new gi(e=c.count||0),c=c.targetId,r=new Wi(c,e)}return r}(this.serializer,t),t=!("targetChange"in(e=t))||(e=e.targetChange).targetIds&&e.targetIds.length||!e.readTime?Jr.min():Vo(e.readTime);return this.listener.pr(n,t)},Ba.prototype.gr=function(t){var e,n,r,i,o,s,u,a,h={};h.database=Fo(this.serializer),h.addTarget=(e=this.serializer,(r=di(r=(n=t).target)?{documents:{documents:[qo(e,r.path)]}}:{query:(i=e,s={structuredQuery:{}},u=(o=r).path,null!==o.collectionGroup?(s.parent=qo(i,u),s.structuredQuery.from=[{collectionId:o.collectionGroup,allDescendants:!0}]):(s.parent=qo(i,u.q()),s.structuredQuery.from=[{collectionId:u.j()}]),(u=function(t){if(0!==t.length)return 1===(t=t.map(function(t){if("=="===t.op){if(Ao(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NAN"}};if(No(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Ao(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NOT_NAN"}};if(No(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Xo(t.field),op:(e=t.op,_o[e]),value:t.value}};var e})).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(o.filters))&&(s.structuredQuery.where=u),(u=function(t){if(0!==t.length)return t.map(function(t){return{field:Xo(t.field),direction:(t=t.dir,Oo[t])}})}(o.orderBy))&&(s.structuredQuery.orderBy=u),u=o.limit,null!==(u=i.ne||ai(u)?u:{value:u})&&(s.structuredQuery.limit=u),o.startAt&&(s.structuredQuery.startAt=Wo(o.startAt)),o.endAt&&(s.structuredQuery.endAt=Wo(o.endAt)),s)}).targetId=n.targetId,0<n.resumeToken.at()?r.resumeToken=Po(e,n.resumeToken):0<n.ft.F(Jr.min())&&(r.readTime=Lo(e,n.ft.L())),r),(t=(this.serializer,a=t,null==(t=function(){switch(a._t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Rr()}}())?null:{"goog-listen-tags":t}))&&(h.labels=t),this.wr(h)},Ba.prototype.vr=function(t){var e={};e.database=Fo(this.serializer),e.removeTarget=t,this.wr(e)},Ba),Ma=(n(za,Va=l),Object.defineProperty(za.prototype,"Cr",{get:function(){return this.br},enumerable:!1,configurable:!0}),za.prototype.start=function(){this.br=!1,this.lastStreamToken=void 0,Va.prototype.start.call(this)},za.prototype.mr=function(){this.br&&this.Sr([])},za.prototype.Pr=function(t){return this.sr.Vr("Write",t)},za.prototype.onMessage=function(t){if(kr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.br){this.Ks.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(kr(void 0!==r),n.map(function(t){return n=r,(t=(e=t).updateTime?Vo(e.updateTime):Vo(n)).isEqual(Jr.min())&&(t=Vo(n)),n=null,e.transformResults&&0<e.transformResults.length&&(n=e.transformResults),new gs(t,n);var e,n})):[]),n=Vo(t.commitTime);return this.listener.Dr(n,e)}var r;return kr(!t.writeResults||0===t.writeResults.length),this.br=!0,this.listener.Nr()},za.prototype.Fr=function(){var t={};t.database=Fo(this.serializer),this.wr(t)},za.prototype.Sr=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return Bo(e.serializer,t)})};this.wr(t)},za),xa=(n(Ga,Pa=function(){}),Ga.prototype.Lr=function(){if(this.Or)throw new Pr(Lr.FAILED_PRECONDITION,"The client has already been terminated.")},Ga.prototype.$r=function(e,n,r){var i=this;return this.Lr(),this.credentials.getToken().then(function(t){return i.sr.$r(e,n,r,t)}).catch(function(t){throw t.code===Lr.UNAUTHENTICATED&&i.credentials.A(),t})},Ga.prototype.kr=function(e,n,r){var i=this;return this.Lr(),this.credentials.getToken().then(function(t){return i.sr.kr(e,n,r,t)}).catch(function(t){throw t.code===Lr.UNAUTHENTICATED&&i.credentials.A(),t})},Ga.prototype.terminate=function(){this.Or=!1},Ga),qa=(Fa.prototype.Qr=function(){var t=this;0===this.Ur&&(this.jr("Unknown"),this.qr=this.Ns.Cs("online_state_timeout",1e4,function(){return t.qr=null,t.Wr("Backend didn't respond within 10 seconds."),t.jr("Offline"),Promise.resolve()}))},Fa.prototype.Gr=function(t){"Online"===this.state?this.jr("Unknown"):(this.Ur++,1<=this.Ur&&(this.Kr(),this.Wr("Connection failed 1 times. Most recent error: "+t.toString()),this.jr("Offline")))},Fa.prototype.set=function(t){this.Kr(),this.Ur=0,"Online"===t&&(this.Br=!1),this.jr(t)},Fa.prototype.jr=function(t){t!==this.state&&(this.state=t,this.Mr(t))},Fa.prototype.Wr=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.Br?(Cr(t),this.Br=!1):Ar("OnlineStateTracker",t)},Fa.prototype.Kr=function(){null!==this.qr&&(this.qr.cancel(),this.qr=null)},Fa);function Fa(t,e){this.Ns=t,this.Mr=e,this.state="Unknown",this.Ur=0,this.qr=null,this.Br=!0}function Ga(t,e,n){var r=this;return(r=Pa.call(this)||this).credentials=t,r.sr=e,r.serializer=n,r.Or=!1,r}function za(t,e,n,r,i){var o=this;return(o=Va.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.br=!1,o}function Ba(t,e,n,r,i){var o=this;return(o=Ua.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Ha(t,e,n,r,i,o){this.Ts=t,this.er=n,this.sr=r,this.ir=i,this.listener=o,this.state=0,this.rr=0,this.ur=null,this.stream=null,this.Ks=new aa(t,e)}function Wa(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!th(r))return[3,4];e=0,n=r.no,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Ya(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.no,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Xa(t,e){t.Xr.has(e.targetId)||(t.Xr.set(e.targetId,e),Za(t)?$a(t):uh(t).hr()&&Ka(t,e))}function Qa(t,e){var n=t,t=uh(n);n.Xr.delete(e),t.hr()&&Ja(n,e),0===n.Xr.size&&(t.hr()?t._r():th(n)&&n.io.set("Unknown"))}function Ka(t,e){t.ro.Dn(e.targetId),uh(t).gr(e)}function Ja(t,e){t.ro.Dn(e),uh(t).vr(e)}function $a(e){e.ro=new Qi({Zn:function(t){return e.Yr.Zn(t)},te:function(t){return e.Xr.get(t)||null}}),uh(e).start(),e.io.Qr()}function Za(t){return th(t)&&!uh(t).cr()&&0<t.Xr.size}function th(t){return 0===t.Zr.size}function eh(t){t.ro=void 0}function nh(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!ca(r))throw r;return n.Zr.add(1),[4,Ya(n)];case 1:return t.sent(),n.io.set("Offline"),i=i||function(){return Ra(n.zr)},n.Ns.ti(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Ar("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Zr.delete(1),[4,Wa(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function rh(e,n){return n().catch(function(t){return nh(e,t,n)})}function ih(h){return y(this,void 0,void 0,function(){var o,s,u,a;return v(this,function(t){switch(t.label){case 0:s=ah(o=h),u=0<o.Jr.length?o.Jr[o.Jr.length-1].batchId:-1,t.label=1;case 1:if(!(th(o)&&o.Jr.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(n=o.zr,r=u,(i=n).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===r&&(r=-1),i.je.Xi(t,r)}))];case 3:return null===(a=t.sent())?(0===o.Jr.length&&s._r(),[3,7]):(u=a.batchId,e=a,(n=o).Jr.push(e),(n=ah(n)).hr()&&n.Cr&&n.Sr(e.mutations),[3,6]);case 4:return a=t.sent(),[4,nh(o,a)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return oh(o)&&sh(o),[2]}var e,n,r,i})})}function oh(t){return th(t)&&!ah(t).cr()&&0<t.Jr.length}function sh(t){ah(t).start()}function uh(n){var t,e,r,i=this;return n.ao||(n.ao=(t=n.Hr,e=n.Ns,r={yr:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.Xr.forEach(function(t,e){Ka(n,t)}),[2]})})}.bind(null,n),Tr:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return eh(e),Za(e)?(e.io.Gr(n),$a(e)):e.io.set("Unknown"),[2]})})}.bind(null,n),pr:function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.io.set("Online"),!(u instanceof Yi&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Xr.has(i)?[4,o.Yr.oo(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Xr.delete(i),o.ro.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Ar("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,nh(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof Hi?s.ro.Mn(u):u instanceof Wi?s.ro.Kn(u):s.ro.Bn(u),a.isEqual(Jr.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Ra(s.zr)];case 8:return o=t.sent(),0<=a.F(o)?[4,(i=a,(e=(r=s).ro.Yn(i)).on.forEach(function(t,e){var n;0<t.resumeToken.at()&&(n=r.Xr.get(e))&&r.Xr.set(e,n.wt(t.resumeToken,i))}),e.un.forEach(function(t){var e=r.Xr.get(t);e&&(r.Xr.set(t,e.wt(yi.lt,e.ft)),Ja(r,t),e=new wi(e.target,t,1,e.sequenceNumber),Ka(r,e))}),r.Yr.uo(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Ar("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,nh(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n)},t.Lr(),new ja(e,t.sr,t.credentials,t.serializer,r)),n.no.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.ao.lr(),Za(n)?$a(n):n.io.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.ao.stop()];case 2:t.sent(),eh(n),t.label=3;case 3:return[2]}})})})),n.ao}function ah(n){var t,e,r,i=this;return n.lo||(n.lo=(t=n.Hr,e=n.Ns,r={yr:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return ah(e).Fr(),[2]})})}.bind(null,n),Tr:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&ah(e).Cr?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Ei(n=i.code)&&n!==Lr.ABORTED?(e=r.Jr.shift(),ah(r).lr(),[4,rh(r,function(){return r.Yr.ho(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,ih(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return oh(e)&&sh(e),[2]}})})}.bind(null,n),Nr:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=ah(o),n=0,r=o.Jr;n<r.length;n++)i=r[n],e.Sr(i.mutations);return[2]})})}.bind(null,n),Dr:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Jr.shift(),n=Wu.from(e,i,o),[4,rh(r,function(){return r.Yr.co(n)})];case 1:return t.sent(),[4,ih(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Lr(),new Ma(e,t.sr,t.credentials,t.serializer,r)),n.no.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.lo.lr(),[4,ih(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.lo.stop()];case 3:t.sent(),0<n.Jr.length&&(Ar("RemoteStore","Stopping write stream with "+n.Jr.length+" pending writes"),n.Jr=[]),t.label=4;case 4:return[2]}})})})),n.lo}function hh(){this.queries=new Yu(lu,cu),this.onlineState="Unknown",this.fo=new Set}var ch=function(){this._o=void 0,this.listeners=[]};function lh(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new ch),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.wo(n)];case 2:return o._o=t.sent(),[3,4];case 3:return o=va(o=t.sent(),"Initialization of query '"+fu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.Eo(e.onlineState),i._o&&u.mo(i._o)&&ph(e),[2]}})})}function fh(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.To(n))]:[2]})})}function ph(t){t.fo.forEach(function(t){t.next()})}var dh=(Dh.prototype.mo=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Gi(t.query,t.docs,t.tn,e,t.nn,t.fromCache,t.en,!0)}var o=!1;return this.Io?this.Po(t)&&(this.Ao.next(t),o=!0):this.yo(t,this.onlineState)&&(this.Vo(t),o=!0),this.Ro=t,o},Dh.prototype.onError=function(t){this.Ao.error(t)},Dh.prototype.Eo=function(t){this.onlineState=t;var e=!1;return this.Ro&&!this.Io&&this.yo(this.Ro,t)&&(this.Vo(this.Ro),e=!0),e},Dh.prototype.yo=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.po&&n||t.docs.W()&&"Offline"!==e)},Dh.prototype.Po=function(t){if(0<t.docChanges.length)return!0;var e=this.Ro&&this.Ro.hasPendingWrites!==t.hasPendingWrites;return!(!t.en&&!e)&&!0===this.options.includeMetadataChanges},Dh.prototype.Vo=function(t){t=Gi.rn(t.query,t.docs,t.nn,t.fromCache),this.Io=!0,this.Ao.next(t)},Dh),yh=(kh.prototype.W=function(){return this.vo.W()},kh.prototype.Do=function(t,e){e=new vh(t,e),this.vo=this.vo.add(e),this.Co=this.Co.add(e)},kh.prototype.No=function(t,e){var n=this;t.forEach(function(t){return n.Do(t,e)})},kh.prototype.xo=function(t,e){this.Fo(new vh(t,e))},kh.prototype.Oo=function(t,e){var n=this;t.forEach(function(t){return n.xo(t,e)})},kh.prototype.Lo=function(t){var e=this,n=new ei(new $r([])),r=new vh(n,t),t=new vh(n,t+1),i=[];return this.Co.jt([r,t],function(t){e.Fo(t),i.push(t.key)}),i},kh.prototype.$o=function(){var e=this;this.vo.forEach(function(t){return e.Fo(t)})},kh.prototype.Fo=function(t){this.vo=this.vo.delete(t),this.Co=this.Co.delete(t)},kh.prototype.ko=function(t){var e=new ei(new $r([])),n=new vh(e,t),t=new vh(e,t+1),r=Mi();return this.Co.jt([n,t],function(t){r=r.add(t.key)}),r},kh.prototype.Mo=function(t){var e=new vh(t,0);return null!==(e=this.vo.Gt(e))&&t.isEqual(e.key)},kh),vh=(Rh.bo=function(t,e){return ei.k(t.key,e.key)||Wr(t.Uo,e.Uo)},Rh.So=function(t,e){return Wr(t.Uo,e.Uo)||ei.k(t.key,e.key)},Rh),gh=(_h.prototype.qo=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},_h.prototype.Bo=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},_h.prototype.Qo=function(){var t={activeTargetIds:this.activeTargetIds.H(),updateTimeMs:Date.now()};return JSON.stringify(t)},_h),mh=(Oh.prototype.Go=function(t){},Oh.prototype.Ko=function(t,e,n){},Oh.prototype.zo=function(t){return this.jo.qo(t),this.Wo[t]||"not-current"},Oh.prototype.Ho=function(t,e,n){this.Wo[t]=e},Oh.prototype.Yo=function(t){this.jo.Bo(t)},Oh.prototype.Jo=function(t){return this.jo.activeTargetIds.has(t)},Oh.prototype.Xo=function(t){delete this.Wo[t]},Oh.prototype.Zo=function(){return this.jo.activeTargetIds},Oh.prototype.tu=function(t){return this.jo.activeTargetIds.has(t)},Oh.prototype.start=function(){return this.jo=new gh,Promise.resolve()},Oh.prototype.nu=function(t,e,n){},Oh.prototype.eu=function(t){},Oh.prototype.su=function(){},Oh.prototype.ws=function(t){},Oh.prototype.iu=function(){},Oh),wh=function(t){this.key=t},bh=function(t){this.key=t},Eh=(Object.defineProperty(Ch.prototype,"au",{get:function(){return this.ru},enumerable:!1,configurable:!0}),Ch.prototype.lu=function(t,e){var s=this,u=e?e._u:new Fi,a=(e||this).hu,h=(e||this).nn,c=a,l=!1,f=nu(this.query)&&a.size===this.query.limit?a.last():null,p=ru(this.query)&&a.size===this.query.limit?a.first():null;if(t.Pt(function(t,e){var n=a.get(t),r=(r=e instanceof Xs?e:null)&&(pu(s.query,r)?r:null),i=!!n&&s.nn.has(n.key),o=!!r&&(r.he||s.nn.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.fu(n,r)||(u.track({type:2,doc:r}),e=!0,(f&&0<s.cu(r,f)||p&&s.cu(r,p)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(h=r?(c=c.add(r),o?h.add(t):h.delete(t)):(c=c.delete(t),h.delete(t)))}),nu(this.query)||ru(this.query))for(;c.size>this.query.limit;){var n=nu(this.query)?c.last():c.first(),c=c.delete(n.key),h=h.delete(n.key);u.track({type:1,doc:n})}return{hu:c,_u:u,_i:l,nn:h}},Ch.prototype.fu=function(t,e){return t.he&&e.hasCommittedMutations&&!e.he},Ch.prototype.du=function(t,e,n){var o=this,r=this.hu;this.hu=t.hu,this.nn=t.nn;var i=t._u.Zt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.cu(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Rr()}}var r,i}),this.wu(n);var s=e?this.Eu():[],e=(n=0===this.uu.size&&this._n?1:0)!==this.ou;return this.ou=n,0!==i.length||e?{snapshot:new Gi(this.query,t.hu,r,i,t.nn,0==n,e,!1),mu:s}:{mu:s}},Ch.prototype.Eo=function(t){return this._n&&"Offline"===t?(this._n=!1,this.du({hu:this.hu,_u:new Fi,nn:this.nn,_i:!1},!1)):{mu:[]}},Ch.prototype.Tu=function(t){return!this.ru.has(t)&&!!this.hu.has(t)&&!this.hu.get(t).he},Ch.prototype.wu=function(t){var e=this;t&&(t.fn.forEach(function(t){return e.ru=e.ru.add(t)}),t.dn.forEach(function(t){}),t.wn.forEach(function(t){return e.ru=e.ru.delete(t)}),this._n=t._n)},Ch.prototype.Eu=function(){var e=this;if(!this._n)return[];var n=this.uu;this.uu=Mi(),this.hu.forEach(function(t){e.Tu(t.key)&&(e.uu=e.uu.add(t.key))});var r=[];return n.forEach(function(t){e.uu.has(t)||r.push(new bh(t))}),this.uu.forEach(function(t){n.has(t)||r.push(new wh(t))}),r},Ch.prototype.Au=function(t){return this.ru=t.nr,this.uu=Mi(),t=this.lu(t.documents),this.du(t,!0)},Ch.prototype.Iu=function(){return Gi.rn(this.query,this.hu,this.nn,0===this.ou)},Ch),Th=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Ih=function(t){this.key=t,this.Ru=!1},Nh=(Object.defineProperty(Ah.prototype,"$u",{get:function(){return!0===this.Lu},enumerable:!1,configurable:!0}),Ah);function Ah(t,e,n,r,i,o){this.zr=t,this.Pu=e,this.yu=n,this.Vu=r,this.currentUser=i,this.pu=o,this.gu={},this.vu=new Yu(lu,cu),this.bu=new Map,this.Cu=[],this.Su=new Ii(ei.k),this.Du=new Map,this.Nu=new yh,this.xu={},this.Fu=new Map,this.Ou=Ta.Ti(),this.onlineState="Unknown",this.Lu=void 0}function Ch(t,e){this.query=t,this.ru=e,this.ou=null,this._n=!1,this.uu=Mi(),this.nn=Mi(),this.cu=du(t),this.hu=new qi(this.cu)}function Oh(){this.jo=new gh,this.Wo={},this.Mr=null,this._s=null}function _h(){this.activeTargetIds=xi}function Rh(t,e){this.key=t,this.Uo=e}function kh(){this.vo=new ki(vh.bo),this.Co=new ki(vh.So)}function Dh(t,e,n){this.query=t,this.Ao=e,this.Io=!1,this.Ro=null,this.onlineState="Unknown",this.options=n||{}}function Sh(f,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:(o=f).Pu.Yr.co=function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.zr,c=s,(l=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=c.batch.keys(),n=l.Vi.ki({Mi:!0}),i=l,o=t,s=n,u=(r=c).batch,a=u.keys(),h=Xu.resolve();return a.forEach(function(n){h=h.next(function(){return s.He(o,n)}).next(function(t){var e=t;kr(null!==(t=r.Ce.get(n))),(!e||e.version.F(t)<0)&&(e=u.Ve(n,e,r))&&s.Ui(e,r.be)})}),h.next(function(){return i.je.qi(o,u)}).next(function(){return n.apply(t)}).next(function(){return l.je.Bi(t)}).next(function(){return l.bi.Je(t,e)})}))];case 2:return i=t.sent(),jh(n,r,null),Uh(n,r),n.Vu.Ko(r,"acknowledged"),[4,Gh(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,Sa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,c,l})})}.bind(null,o),o.Pu.Yr.ho=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.zr,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.je.ju(e,r).next(function(t){return kr(null!==t),n=t.keys(),i.je.qi(e,t)}).next(function(){return i.je.Bi(e)}).next(function(){return i.bi.Je(e,n)})}))];case 2:return o=t.sent(),jh(n,u,a),Uh(n,u),n.Vu.Ko(u,"rejected",a),[4,Gh(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Sa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.zr,a=p,c=r,l=Kr.now(),i=a.reduce(function(t,e){return t.add(e.key)},Mi()),c.persistence.runTransaction("Locally write mutations","readwrite",function(u){return c.bi.Je(u,i).next(function(t){h=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=h.get(i.key),s instanceof Ss?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof Xs?t.field(i.field):void 0;null!=(o=Jo(i.transform,o||null))&&(e=(null==e?new qs:e).set(i.field,o))}return e?e.ae():null}(o):null);null!=o&&e.push(new Os(i.key,o,function s(t){var u=[];return so(t.fields||{},function(t,e){var n=new ti([t]);if(Co(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new ys(u)}(o.proto.mapValue),ms.exists(!0)))}return c.je.Bu(u,l,e,a)})}).then(function(t){var e=t.ve(h);return{batchId:t.batchId,Qu:e}}))];case 2:return s=t.sent(),u.Vu.Go(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.xu[e.currentUser.h()])||new Ii(Wr)).Tt(n,o),e.xu[e.currentUser.h()]=r,[4,Gh(u,s.Qu)];case 3:return t.sent(),[4,ih(u.Pu)];case 4:return t.sent(),[3,6];case 5:return u=va(u=t.sent(),"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,h,c,l,i,o})})}function Lh(i,s){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:n=i,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.zr,c=e,l=(o=s).ft,f=c.Ii,c.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=c.Vi.ki({Mi:!0});f=c.Ii;var u=[];o.on.forEach(function(t,e){var n,r,i,o=f.get(e);o&&(u.push(c.gi.ji(s,t.wn,e).next(function(){return c.gi.Wi(s,t.fn,e)})),0<(i=t.resumeToken).at()&&(n=o.wt(i,l).dt(s.Gi),f=f.Tt(e,n),r=o,i=t,kr(0<(o=n).resumeToken.at()),(0===r.resumeToken.at()||3e8<=o.ft.O()-r.ft.O()||0<i.fn.size+i.dn.size+i.wn.size)&&u.push(c.gi.Ki(s,n))))});var e,a,n,h,r,i=Si;return o.cn.forEach(function(t,e){o.hn.has(t)&&u.push(c.persistence.Hi.zi(s,t))}),u.push((e=s,a=t,n=o.cn,h=l,r=Mi(),n.forEach(function(t){return r=r.add(t)}),a.getEntries(e,r).next(function(i){var o=Si;return n.forEach(function(t,e){var n=i.get(t),r=h;e instanceof Qs&&e.version.isEqual(Jr.min())?(a.Yi(t,r),o=o.Tt(t,e)):null==n||0<e.version.F(n.version)||0===e.version.F(n.version)&&n.hasPendingWrites?(a.Ui(e,r),o=o.Tt(t,e)):Ar("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o}).next(function(t){i=t}))),l.isEqual(Jr.min())||(e=c.gi.Qi(s).next(function(t){return c.gi.Ji(s,s.Gi,l)}),u.push(e)),Xu.qe(u).next(function(){return t.apply(s)}).next(function(){return c.bi.Xe(s,i)})}).then(function(t){return c.Ii=f,t}))];case 2:return r=t.sent(),s.on.forEach(function(t,e){(e=n.Du.get(e))&&(kr(t.fn.size+t.dn.size+t.wn.size<=1),0<t.fn.size?e.Ru=!0:0<t.dn.size?kr(e.Ru):0<t.wn.size&&(kr(e.Ru),e.Ru=!1))}),[4,Gh(n,r,s)];case 3:return t.sent(),[3,6];case 4:return[4,Sa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,o,c,l,f})})}function Ph(t,n,e){var r;((t=t).$u&&0===e||!t.$u&&1===e)&&(r=[],t.vu.forEach(function(t,e){(e=e.view.Eo(n)).snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Eo(i)&&(o=!0)}),o&&ph(t)}(t.yu,n),r.length&&t.gu.pr(r),t.onlineState=n,t.$u&&t.Vu.eu(n))}function Vh(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:th((n=o).Pu)||Ar("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.zr).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.je.Wu(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Fu.get(r)||[]).push(s),n.Fu.set(r,i),[3,4]);case 3:return i=va(i=t.sent(),"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function Uh(t,e){(t.Fu.get(e)||[]).forEach(function(t){t.resolve()}),t.Fu.delete(e)}function jh(t,e,n){var r=t,i=r.xu[r.currentUser.h()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.xu[r.currentUser.h()]=i)}function Mh(e,t,n){void 0===n&&(n=null),e.Vu.Yo(t);for(var r=0,i=e.bu.get(t);r<i.length;r++){var o=i[r];e.vu.delete(o),n&&e.gu.ku(o,n)}e.bu.delete(t),e.$u&&e.Nu.Lo(t).forEach(function(t){e.Nu.Mo(t)||xh(e,t)})}function xh(t,e){var n=t.Su.get(e);null!==n&&(Qa(t.Pu,n),t.Su=t.Su.remove(e),t.Du.delete(n),Fh(t))}function qh(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var u=s[o];u instanceof wh?(t.Nu.Do(u.key,e),r=t,i=(i=u).key,r.Su.get(i)||(Ar("SyncEngine","New document in limbo: "+i),r.Cu.push(i),Fh(r))):u instanceof bh?(Ar("SyncEngine","Document no longer in limbo: "+u.key),t.Nu.xo(u.key,e),t.Nu.Mo(u.key)||xh(t,u.key)):Rr()}}function Fh(t){for(;0<t.Cu.length&&t.Su.size<t.pu;){var e=t.Cu.shift(),n=t.Ou.next();t.Du.set(n,new Ih(e)),t.Su=t.Su.Tt(e,n),Xa(t.Pu,new wi(au(eu(e.path)),n,2,ia.Es))}}function Gh(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).vu.W()?[3,3]:(n.vu.forEach(function(t,e){o.push(n.qu(e,s,u).then(function(t){t&&(n.$u&&n.Vu.Ho(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=ra.ls(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.gu.pr(r),[4,function(a,h){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Xu.forEach(h,function(e){return Xu.forEach(e.cs,function(t){return r.persistence.Hi.Do(n,e.targetId,t)}).next(function(){return Xu.forEach(e.hs,function(t){return r.persistence.Hi.xo(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!ca(e=t.sent()))throw e;return Ar("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=h;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.Ii.get(o),u=s.ft,u=s.Et(u),r.Ii=r.Ii.Tt(o,u));return[2]}})})}(n.zr,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}var zh,Bh,Hh,Wh=(Ac.prototype.zu=function(t){return Xu.resolve(0===this.je.length)},Ac.prototype.Bu=function(t,e,n,r){var i=this.Gu;this.Gu++,0<this.je.length&&this.je[this.je.length-1],n=new Hu(i,e,n,r),this.je.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Ku=this.Ku.add(new vh(u.key,i)),this.We.wi(t,u.key.path.q())}return Xu.resolve(n)},Ac.prototype.ju=function(t,e){return Xu.resolve(this.Hu(e))},Ac.prototype.Xi=function(t,e){return e+=1,e=(e=this.Yu(e))<0?0:e,Xu.resolve(this.je.length>e?this.je[e]:null)},Ac.prototype.Wu=function(){return Xu.resolve(0===this.je.length?-1:this.Gu-1)},Ac.prototype.Fi=function(t){return Xu.resolve(this.je.slice())},Ac.prototype.Ke=function(t,e){var n=this,r=new vh(e,0),e=new vh(e,Number.POSITIVE_INFINITY),i=[];return this.Ku.jt([r,e],function(t){t=n.Hu(t.Uo),i.push(t)}),Xu.resolve(i)},Ac.prototype.Ze=function(t,e){var n=this,r=new ki(Wr);return e.forEach(function(t){var e=new vh(t,0),t=new vh(t,Number.POSITIVE_INFINITY);n.Ku.jt([e,t],function(t){r=r.add(t.Uo)})}),Xu.resolve(this.Ju(r))},Ac.prototype.os=function(t,e){var n=e.path,r=n.length+1,e=n;ei.ot(e)||(e=e.child(""));var e=new vh(new ei(e),0),i=new ki(Wr);return this.Ku.Wt(function(t){var e=t.key.path;return!!n.G(e)&&(e.length===r&&(i=i.add(t.Uo)),!0)},e),Xu.resolve(this.Ju(i))},Ac.prototype.Ju=function(t){var e=this,n=[];return t.forEach(function(t){null!==(t=e.Hu(t))&&n.push(t)}),n},Ac.prototype.qi=function(n,r){var i=this;kr(0===this.Xu(r.batchId,"removed")),this.je.shift();var o=this.Ku;return Xu.forEach(r.mutations,function(t){var e=new vh(t.key,r.batchId);return o=o.delete(e),i.Hi.Zu(n,t.key)}).next(function(){i.Ku=o})},Ac.prototype.tc=function(t){},Ac.prototype.Mo=function(t,e){var n=new vh(e,0),n=this.Ku.Gt(n);return Xu.resolve(e.isEqual(n&&n.key))},Ac.prototype.Bi=function(t){return this.je.length,Xu.resolve()},Ac.prototype.Xu=function(t,e){return this.Yu(t)},Ac.prototype.Yu=function(t){return 0===this.je.length?0:t-this.je[0].batchId},Ac.prototype.Hu=function(t){return(t=this.Yu(t))<0||t>=this.je.length?null:this.je[t]},Ac),Yh=(Nc.prototype.Ui=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this.nc(e);return this.docs=this.docs.Tt(r,{ec:e,size:o,readTime:n}),this.size+=o-i,this.We.wi(t,r.path.q())},Nc.prototype.Yi=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Nc.prototype.He=function(t,e){return e=this.docs.get(e),Xu.resolve(e?e.ec:null)},Nc.prototype.getEntries=function(t,e){var n=this,r=Si;return e.forEach(function(t){var e=n.docs.get(t);r=r.Tt(t,e?e.ec:null)}),Xu.resolve(r)},Nc.prototype.ts=function(t,e,n){for(var r=Vi,i=new ei(e.path.child("")),o=this.docs.gt(i);o.Nt();){var s=(u=o.Dt()).key,u=(a=u.value).ec,a=a.readTime;if(!e.path.G(s.path))break;a.F(n)<=0||u instanceof Xs&&pu(e,u)&&(r=r.Tt(u.key,u))}return Xu.resolve(r)},Nc.prototype.sc=function(t,e){return Xu.forEach(this.docs,function(t){return e(t)})},Nc.prototype.ki=function(t){return new Xh(this)},Nc.prototype.ic=function(t){return Xu.resolve(this.size)},Nc),Xh=(Ic.prototype.oc=function(t){return(t=this.Qu.get(t))?t.readTime:Jr.min()},Ic.prototype.Ui=function(t,e){this.uc(),this.Qu.set(t.key,{ec:t,readTime:e})},Ic.prototype.Yi=function(t,e){void 0===e&&(e=null),this.uc(),this.Qu.set(t,{ec:null,readTime:e})},Ic.prototype.He=function(t,e){this.uc();var n=this.Qu.get(e);return void 0!==n?Xu.resolve(n.ec):this.cc(t,e)},Ic.prototype.getEntries=function(t,e){return this.hc(t,e)},Ic.prototype.apply=function(t){return this.uc(),this.rc=!0,this.du(t)},Ic.prototype.uc=function(){},n(Tc,Hh=Ic),Tc.prototype.du=function(n){var r=this,i=[];return this.Qu.forEach(function(t,e){e&&e.ec?i.push(r.ac.Ui(n,e.ec,r.oc(t))):r.ac.Yi(t)}),Xu.qe(i)},Tc.prototype.cc=function(t,e){return this.ac.He(t,e)},Tc.prototype.hc=function(t,e){return this.ac.getEntries(t,e)},Tc),Qh=(Ec.prototype.Qn=function(t,n){return this.lc.forEach(function(t,e){return n(e)}),Xu.resolve()},Ec.prototype.Qi=function(t){return Xu.resolve(this.lastRemoteSnapshotVersion)},Ec.prototype.wc=function(t){return Xu.resolve(this._c)},Ec.prototype.Mu=function(t){return this.highestTargetId=this.dc.next(),Xu.resolve(this.highestTargetId)},Ec.prototype.Ji=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this._c&&(this._c=e),Xu.resolve()},Ec.prototype.Ec=function(t){this.lc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.dc=new Ta(e),this.highestTargetId=e),t.sequenceNumber>this._c&&(this._c=t.sequenceNumber)},Ec.prototype.Uu=function(t,e){return this.Ec(e),this.targetCount+=1,Xu.resolve()},Ec.prototype.Ki=function(t,e){return this.Ec(e),Xu.resolve()},Ec.prototype.mc=function(t,e){return this.lc.delete(e.target),this.fc.Lo(e.targetId),--this.targetCount,Xu.resolve()},Ec.prototype.Tc=function(n,r,i){var o=this,s=0,u=[];return this.lc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.lc.delete(t),u.push(o.Ac(n,e.targetId)),s++)}),Xu.qe(u).next(function(){return s})},Ec.prototype.Ic=function(t){return Xu.resolve(this.targetCount)},Ec.prototype.Zi=function(t,e){return e=this.lc.get(e)||null,Xu.resolve(e)},Ec.prototype.Wi=function(t,e,n){return this.fc.No(e,n),Xu.resolve()},Ec.prototype.ji=function(e,t,n){this.fc.Oo(t,n);var r=this.persistence.Hi,i=[];return r&&t.forEach(function(t){i.push(r.Zu(e,t))}),Xu.qe(i)},Ec.prototype.Ac=function(t,e){return this.fc.Lo(e),Xu.resolve()},Ec.prototype.tr=function(t,e){return e=this.fc.ko(e),Xu.resolve(e)},Ec.prototype.Mo=function(t,e){return Xu.resolve(this.fc.Mo(e))},Ec),Kh=(bc.prototype.yc=function(t,e){return Xu.resolve(this.Rc.get(e))},bc.prototype.Vc=function(t,e){return this.Rc.set(e.id,{id:e.id,version:e.version,createTime:Vo(e.createTime)}),Xu.resolve()},bc.prototype.gc=function(t,e){return Xu.resolve(this.Pc.get(e))},bc.prototype.vc=function(t,e){var n,r;return this.Pc.set(e.name,{name:(n=e).name,query:(e=Ho({parent:(r=n.bundledQuery).parent,structuredQuery:r.structuredQuery}),"LAST"===r.limitType?hu(e,e.limit,"L"):e),readTime:Vo(n.readTime)}),Xu.resolve()},bc),Jh=(wc.prototype.start=function(){return Promise.resolve()},wc.prototype.su=function(){return this.Sc=!1,Promise.resolve()},Object.defineProperty(wc.prototype,"Nc",{get:function(){return this.Sc},enumerable:!1,configurable:!0}),wc.prototype.xc=function(){},wc.prototype.Fc=function(){},wc.prototype.Ci=function(){return this.We},wc.prototype.yi=function(t){var e=this.bc[t.h()];return e||(e=new Wh(this.We,this.Hi),this.bc[t.h()]=e),e},wc.prototype.vi=function(){return this.gi},wc.prototype.pi=function(){return this.Qe},wc.prototype.Di=function(){return this.Si},wc.prototype.runTransaction=function(t,e,n){var r=this;Ar("MemoryPersistence","Starting transaction:",t);var i=new $h(this.Cc.next());return this.Hi.Oc(),n(i).next(function(t){return r.Hi.Lc(i).next(function(){return t})}).Me().then(function(t){return i.$c(),t})},wc.prototype.kc=function(e,n){return Xu.Be(Object.values(this.bc).map(function(t){return function(){return t.Mo(e,n)}}))},wc),$h=(mc.prototype.Uc=function(t){this.Mc.push(t)},mc.prototype.$c=function(){this.Mc.forEach(function(t){return t()})},n(gc,Bh=mc),gc),Zh=(vc.Qc=function(t){return new vc(t)},Object.defineProperty(vc.prototype,"jc",{get:function(){if(this.Bc)return this.Bc;throw Rr()},enumerable:!1,configurable:!0}),vc.prototype.Do=function(t,e,n){return this.qc.Do(n,e),this.jc.delete(n.toString()),Xu.resolve()},vc.prototype.xo=function(t,e,n){return this.qc.xo(n,e),this.jc.add(n.toString()),Xu.resolve()},vc.prototype.Zu=function(t,e){return this.jc.add(e.toString()),Xu.resolve()},vc.prototype.removeTarget=function(t,e){var n=this;this.qc.Lo(e.targetId).forEach(function(t){return n.jc.add(t.toString())});var r=this.persistence.vi();return r.tr(t,e.targetId).next(function(t){t.forEach(function(t){return n.jc.add(t.toString())})}).next(function(){return r.mc(t,e)})},vc.prototype.Oc=function(){this.Bc=new Set},vc.prototype.Lc=function(n){var r=this,i=this.persistence.pi().ki();return Xu.forEach(this.jc,function(t){var e=ei.st(t);return r.Wc(n,e).next(function(t){t||i.Yi(e)})}).next(function(){return r.Bc=null,i.apply(n)})},vc.prototype.zi=function(t,e){var n=this;return this.Wc(t,e).next(function(t){t?n.jc.delete(e.toString()):n.jc.add(e.toString())})},vc.prototype.Dc=function(t){return 0},vc.prototype.Wc=function(t,e){var n=this;return Xu.Be([function(){return Xu.resolve(n.qc.Mo(e))},function(){return n.persistence.vi().Mo(t,e)},function(){return n.persistence.kc(t,e)}])},vc),tc=(yc.prototype.yr=function(t){this.zc=t},yc.prototype.Tr=function(t){this.Hc=t},yc.prototype.onMessage=function(t){this.Yc=t},yc.prototype.close=function(){this.Kc()},yc.prototype.send=function(t){this.Gc(t)},yc.prototype.Jc=function(){this.zc()},yc.prototype.Xc=function(t){this.Hc(t)},yc.prototype.Zc=function(t){this.Yc(t)},yc),ec={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},nc=(dc.prototype.$r=function(e,t,n,r){var i=this.sh(e,t);return Ar("RestConnection","Sending: ",i,n),t={},this.ih(t,r),this.rh(e,i,t,n).then(function(t){return Ar("RestConnection","Received: ",t),t},function(t){throw Or("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},dc.prototype.kr=function(t,e,n,r){return this.$r(t,e,n,r)},dc.prototype.ih=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.1.2",t["Content-Type"]="text/plain",e)for(var n in e.m)e.m.hasOwnProperty(n)&&(t[n]=e.m[n])},dc.prototype.sh=function(t,e){return t=ec[t],this.nh+"/v1/"+e+":"+t},n(pc,zh=dc),pc.prototype.rh=function(o,e,s,u){return new Promise(function(n,r){var i=new vr;i.listenOnce(pr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case fr.NO_ERROR:var t=i.getResponseJson();Ar("Connection","XHR received:",JSON.stringify(t)),n(t);break;case fr.TIMEOUT:Ar("Connection",'RPC "'+o+'" timed out'),r(new Pr(Lr.DEADLINE_EXCEEDED,"Request time out"));break;case fr.HTTP_ERROR:var e=i.getStatus();Ar("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace(/_/g,"-"),e=0<=Object.values(Lr).indexOf(e)?e:Lr.UNKNOWN,r(new Pr(e,t.message))):r(new Pr(Lr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Pr(Lr.UNAVAILABLE,"Connection failed."));break;default:Rr()}}finally{Ar("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},pc.prototype.Vr=function(t,e){var n,r=[this.nh,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new sr,o=lr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.ih(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),Ar("Connection","Creating WebChannel: "+(r=r.join("")),t);var s=i.createWebChannel(r,t),u=!1,a=!1,h=new tc({Gc:function(t){a?Ar("Connection","Not sending because WebChannel is closed:",t):(u||(Ar("Connection","Opening WebChannel transport."),s.open(),u=!0),Ar("Connection","WebChannel sending:",t),s.send(t))},Kc:function(){return s.close()}});return(t=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})})(s,yr.EventType.OPEN,function(){a||Ar("Connection","WebChannel transport opened.")}),t(s,yr.EventType.CLOSE,function(){a||(a=!0,Ar("Connection","WebChannel transport closed"),h.Xc())}),t(s,yr.EventType.ERROR,function(t){a||(a=!0,Or("Connection","WebChannel transport errored:",t),h.Xc(new Pr(Lr.UNAVAILABLE,"The operation could not be completed")))}),t(s,yr.EventType.MESSAGE,function(t){var e,n,r,i;a||(kr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Ar("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=mi[r];if(void 0!==t)return Ti(t)}(),i=n.message,void 0===t&&(t=Lr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),a=!0,h.Xc(new Pr(t,i)),s.close()):(Ar("Connection","WebChannel received:",e),h.Zc(e)))}),t(o,dr.STAT_EVENT,function(t){10===t.stat?Ar("Connection","Detected buffering proxy"):11===t.stat&&Ar("Connection","Detected no buffering proxy")}),setTimeout(function(){h.Jc()},0),h},pc),rc=(fc.prototype.so=function(t){this.lh.push(t)},fc.prototype.su=function(){window.removeEventListener("online",this.oh),window.removeEventListener("offline",this.hh)},fc.prototype._h=function(){window.addEventListener("online",this.oh),window.addEventListener("offline",this.hh)},fc.prototype.uh=function(){Ar("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.lh;t<e.length;t++)(0,e[t])(0)},fc.prototype.ah=function(){Ar("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.lh;t<e.length;t++)(0,e[t])(1)},fc.fh=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},fc),ic=(lc.prototype.so=function(t){},lc.prototype.su=function(){},lc),oc=(cc.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.serializer=ta(e.th.t),this.Vu=this.dh(e),this.persistence=this.wh(e),[4,this.persistence.start()];case 1:return t.sent(),this.Eh=this.mh(e),this.zr=this.Th(e),[2]}})})},cc.prototype.mh=function(t){return null},cc.prototype.Th=function(t){return e=this.persistence,n=new ma,r=t.Ah,t=this.serializer,new Ia(e,n,r,t);var e,n,r},cc.prototype.wh=function(t){return new Jh(Zh.Qc,this.serializer)},cc.prototype.dh=function(t){return new mh},cc.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Eh&&this.Eh.stop(),[4,this.Vu.su()];case 1:return t.sent(),[4,this.persistence.su()];case 2:return t.sent(),[2]}})})},cc),sc=(hc.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.zr?[3,2]:(this.zr=n.zr,this.Vu=n.Vu,this.Hr=this.Ih(r),this.Pu=this.Rh(r),this.yu=this.Ph(r),this.yh=this.Vh(r,!n.synchronizeTabs),this.Vu.Mr=function(t){return Ph(e.yh,t,1)},this.Pu.Yr.ph=function(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Ar("SyncEngine","User change. New user:",o.h()),[4,_a(n.zr,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Fu.forEach(function(t){t.forEach(function(t){t.reject(new Pr(Lr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Fu.clear(),n.Vu.nu(o,r.Li,r.$i),[4,Gh(n,r.Oi)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this.yh),[4,function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Zr.delete(2),[4,Wa(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Zr.add(2),[4,Ya(e)]);case 3:t.sent(),e.io.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.Pu,this.yh.$u)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},hc.prototype.Ph=function(t){return new hh},hc.prototype.Ih=function(t){var e=ta(t.th.t),n=(n=t.th,new nc(n));return t=t.credentials,new xa(t,n,e)},hc.prototype.Rh=function(t){var e=this;return new La(this.zr,this.Hr,t.Ns,function(t){return Ph(e.yh,t,0)},t=new(rc.fh()?rc:ic))},hc.prototype.Vh=function(t,e){return n=this.zr,r=this.Pu,i=this.yu,o=this.Vu,s=t.Ah,t=t.pu,e=e,t=new Nh(n,r,i,o,s,t),e&&(t.Lu=!0),t;var n,r,i,o,s},hc.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Ar("RemoteStore","RemoteStore shutting down."),e.Zr.add(5),[4,Ya(e)];case 1:return t.sent(),e.eo.su(),e.io.set("Unknown"),[2]}})})}(this.Pu)},hc),uc=(ac.prototype.next=function(t){this.observer.next&&this.gh(this.observer.next,t)},ac.prototype.error=function(t){this.observer.error?this.gh(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},ac.prototype.bh=function(){this.muted=!0},ac.prototype.gh=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},ac);function ac(t){this.observer=t,this.muted=!1}function hc(){}function cc(){this.synchronizeTabs=!1}function lc(){}function fc(){var t=this;this.oh=function(){return t.uh()},this.hh=function(){return t.ah()},this.lh=[],this._h()}function pc(t){var e=this;return(e=zh.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.i=t.i,e}function dc(t){this.th=t,this.t=t.t;var e=t.ssl?"https":"http";this.nh=e+"://"+t.host,this.eh="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}function yc(t){this.Gc=t.Gc,this.Kc=t.Kc}function vc(t){this.persistence=t,this.qc=new yh,this.Bc=null}function gc(t){var e=this;return(e=Bh.call(this)||this).Gi=t,e}function mc(){this.Mc=[]}function wc(t,e){var n=this;this.bc={},this.Cc=new ia(0),this.Sc=!1,this.Sc=!0,this.Hi=t(this),this.gi=new Qh(this),this.We=new ba,this.Qe=(t=this.We,new Yh(t,function(t){return n.Hi.Dc(t)})),this.serializer=new ga(e),this.Si=new Kh(this.serializer)}function bc(t){this.serializer=t,this.Rc=new Map,this.Pc=new Map}function Ec(t){this.persistence=t,this.lc=new Yu(fi,pi),this.lastRemoteSnapshotVersion=Jr.min(),this.highestTargetId=0,this._c=0,this.fc=new yh,this.targetCount=0,this.dc=Ta.mi()}function Tc(t){var e=this;return(e=Hh.call(this)||this).ac=t,e}function Ic(){this.Qu=new Yu(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.rc=!1}function Nc(t,e){this.We=t,this.nc=e,this.docs=new Ii(ei.k),this.size=0}function Ac(t,e){this.We=t,this.Hi=e,this.je=[],this.Gu=1,this.Ku=new ki(vh.bo)}function Cc(t,e,n){if(!n)throw new Pr(Lr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Oc(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Pr(Lr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function _c(t,e,n,r){if(!0===e&&!0===r)throw new Pr(Lr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Rc(t){if(!ei.ot(t))throw new Pr(Lr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function kc(t){if(ei.ot(t))throw new Pr(Lr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Dc(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Rr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Sc(t,e){if("_delegate"in t&&(t=t.Ch),t instanceof e)return t;if(e.name===t.constructor.name)throw new Pr(Lr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");throw t=Dc(t),new Pr(Lr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function Lc(t,e){if(e<=0)throw new Pr(Lr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Pc,Vc=function(t){this._methodName=t},Uc=(n(jc,Pc=Vc),jc.prototype.Sh=function(t){if(2!==t.Dh)throw 1===t.Dh?t.Nh(this._methodName+"() can only appear at the top level of your update data"):t.Nh(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.ee.push(t.path),null},jc.prototype.isEqual=function(t){return t instanceof jc},jc);function jc(){return null!==Pc&&Pc.apply(this,arguments)||this}function Mc(t,e,n){return new Sf({Dh:3,xh:e.settings.xh,methodName:t._methodName,Fh:n},e.t,e.serializer,e.ignoreUndefinedProperties)}var xc,qc,Fc,Gc,zc=(n(sl,Gc=Vc),sl.prototype.Sh=function(t){return new ds(t.path,new ts)},sl.prototype.isEqual=function(t){return t instanceof sl},sl),Bc=(n(ol,Fc=Vc),ol.prototype.Sh=function(t){var e=Mc(this,t,!0),n=this.Oh.map(function(t){return qf(t,e)}),n=new es(n);return new ds(t.path,n)},ol.prototype.isEqual=function(t){return this===t},ol),Hc=(n(il,qc=Vc),il.prototype.Sh=function(t){var e=Mc(this,t,!0),n=this.Oh.map(function(t){return qf(t,e)}),n=new ss(n);return new ds(t.path,n)},il.prototype.isEqual=function(t){return this===t},il),Wc=(n(rl,xc=Vc),rl.prototype.Sh=function(t){var e=new cs(t.serializer,So(t.serializer,this.Lh));return new ds(t.path,e)},rl.prototype.isEqual=function(t){return this===t},rl),Yc=(Object.defineProperty(nl.prototype,"latitude",{get:function(){return this.$h},enumerable:!1,configurable:!0}),Object.defineProperty(nl.prototype,"longitude",{get:function(){return this.kh},enumerable:!1,configurable:!0}),nl.prototype.isEqual=function(t){return this.$h===t.$h&&this.kh===t.kh},nl.prototype.toJSON=function(){return{latitude:this.$h,longitude:this.kh}},nl.prototype.D=function(t){return Wr(this.$h,t.$h)||Wr(this.kh,t.kh)},nl),Xc=(el.fromBase64String=function(t){try{return new el(yi.fromBase64String(t))}catch(t){throw new Pr(Lr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},el.fromUint8Array=function(t){return new el(yi.fromUint8Array(t))},el.prototype.toBase64=function(){return this.Mh.toBase64()},el.prototype.toUint8Array=function(){return this.Mh.toUint8Array()},el.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},el.prototype.isEqual=function(t){return this.Mh.isEqual(t.Mh)},el),Qc=function(t){this.Ch=t},Kc=new Map,Jc=(tl.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},tl),$c=(Object.defineProperty(Zc.prototype,"app",{get:function(){if(!this.Wh)throw new Pr(Lr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Wh},enumerable:!1,configurable:!0}),Object.defineProperty(Zc.prototype,"Gh",{get:function(){return this.Bh},enumerable:!1,configurable:!0}),Object.defineProperty(Zc.prototype,"Kh",{get:function(){return void 0!==this.zh},enumerable:!1,configurable:!0}),Zc.prototype.Hh=function(t){if(this.Bh)throw new Pr(Lr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.qh=new Jc(t),void 0!==t.credentials&&(this.jh=function(t){if(!t)return new Vr;switch(t.type){case"gapi":var e=t.client;return kr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Mr(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Pr(Lr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Zc.prototype.Yh=function(){return this.qh},Zc.prototype.Jh=function(){return this.Bh=!0,this.qh},Zc.prototype._delete=function(){return this.zh||(this.zh=this.Xh()),this.zh},Zc.prototype.Xh=function(){return(t=Kc.get(this))&&(Ar("ComponentProvider","Removing Datastore"),Kc.delete(this),t.terminate()),Promise.resolve();var t},Zc);function Zc(t,e){this.Uh="(lite)",this.qh=new Jc({}),this.Bh=!1,t instanceof wr?(this.Qh=t,this.jh=new Vr):(this.Wh=t,this.Qh=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Pr(Lr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new wr(t.options.projectId)}(t),this.jh=new Ur(e))}function tl(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Pr(Lr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Pr(Lr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,_c("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function el(t){this.Mh=t}function nl(t,e){if(!isFinite(t)||t<-90||90<t)throw new Pr(Lr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Pr(Lr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.$h=t,this.kh=e}function rl(t,e){var n=this;return(n=xc.call(this,t)||this).Lh=e,n}function il(t,e){var n=this;return(n=qc.call(this,t)||this).Oh=e,n}function ol(t,e){var n=this;return(n=Fc.call(this,t)||this).Oh=e,n}function sl(){return null!==Gc&&Gc.apply(this,arguments)||this}function ul(){if("undefined"==typeof Uint8Array)throw new Pr(Lr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function al(){if("undefined"==typeof atob)throw new Pr(Lr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var hl,cl,ll,fl=(n(bl,ll=Qc),bl.fromBase64String=function(t){return al(),new bl(Xc.fromBase64String(t))},bl.fromUint8Array=function(t){return ul(),new bl(Xc.fromUint8Array(t))},bl.prototype.toBase64=function(){return al(),this.Ch.toBase64()},bl.prototype.toUint8Array=function(){return ul(),this.Ch.toUint8Array()},bl.prototype.isEqual=function(t){return this.Ch.isEqual(t.Ch)},bl.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},bl),me=(wl.prototype.Zh=function(t,e){switch(void 0===e&&(e="none"),lo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return wo(t.integerValue||t.doubleValue);case 3:return this.ta(t.timestampValue);case 4:return this.na(t,e);case 5:return t.stringValue;case 6:return this.ea(bo(t.bytesValue));case 7:return this.sa(t.referenceValue);case 8:return this.ia(t.geoPointValue);case 9:return this.ra(t.arrayValue,e);case 10:return this.oa(t.mapValue,e);default:throw Rr()}},wl.prototype.oa=function(t,n){var r=this,i={};return so(t.fields||{},function(t,e){i[t]=r.Zh(e,n)}),i},wl.prototype.ia=function(t){return new Yc(wo(t.latitude),wo(t.longitude))},wl.prototype.ra=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.Zh(t,e)})},wl.prototype.na=function(t,e){switch(e){case"previous":var n=function t(e){return ao(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==n?null:this.Zh(n,e);case"estimate":return this.ta(ho(t));default:return null}},wl.prototype.ta=function(t){return t=mo(t),new Kr(t.seconds,t.nanos)},wl.prototype.ua=function(t,e){var n=$r.J(t);return kr(Ko(n)),t=new wr(n.get(1),n.get(3)),n=new ei(n.U(5)),t.isEqual(e)||Cr("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},wl),pl=(n(ml,cl=me),ml.prototype.ea=function(t){return new fl(new Xc(t))},ml.prototype.sa=function(t){return t=this.ua(t,this.firestore.Qh),kp.ca(t,this.firestore,null)},ml),dl=(Object.defineProperty(gl.prototype,"id",{get:function(){return this.la.path.j()},enumerable:!1,configurable:!0}),Object.defineProperty(gl.prototype,"ref",{get:function(){return new zl(this.ha,this.fa,this.la)},enumerable:!1,configurable:!0}),gl.prototype.exists=function(){return null!==this._a},gl.prototype.data=function(){if(this._a){if(this.fa){var t=new yl(this.ha,this.aa,this.la,this._a,null);return this.fa.fromFirestore(t)}return this.aa.Zh(this._a.Ee())}},gl.prototype.get=function(t){if(this._a&&null!==(t=this._a.data().field(El("DocumentSnapshot.get",t))))return this.aa.Zh(t)},gl),yl=(n(vl,hl=dl),vl.prototype.data=function(){return hl.prototype.data.call(this)},vl);function vl(){return null!==hl&&hl.apply(this,arguments)||this}function gl(t,e,n,r,i){this.ha=t,this.aa=e,this.la=n,this._a=r,this.fa=i}function ml(t){var e=this;return(e=cl.call(this)||this).firestore=t,e}function wl(){}function bl(){return null!==ll&&ll.apply(this,arguments)||this}function El(t,e){return"string"==typeof e?Wf(t,e):(e instanceof Qc?e.Ch:e).da}var Tl,Il=(Cl.prototype.isEqual=function(t){return this.da.isEqual(t.da)},Cl),Nl=(n(Al,Tl=$c),Al.prototype.Xh=function(){return this.Ea||Np(this),this.Ea.terminate()},Al);function Al(t,e){var n=this;return(n=Tl.call(this,t,e)||this).wa=new pa,n.Uh="name"in t?t.name:"[DEFAULT]",n}function Cl(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Pr(Lr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.da=new ti(t)}var Ol,_l,Rl=(n(Pl,_l=dl),Pl.prototype.exists=function(){return _l.prototype.exists.call(this)},Pl.prototype.data=function(t){if(void 0===t&&(t={}),this._a){if(this.fa){var e=new kl(this.ha,this.aa,this.la,this._a,this.metadata,null);return this.fa.fromFirestore(e,t)}return this.aa.Zh(this._a.Ee(),t.serverTimestamps)}},Pl.prototype.get=function(t,e){if(void 0===e&&(e={}),this._a&&null!==(t=this._a.data().field(El("DocumentSnapshot.get",t))))return this.aa.Zh(t,e.serverTimestamps)},Pl),kl=(n(Ll,Ol=Rl),Ll.prototype.data=function(t){return void 0===t&&(t={}),Ol.prototype.data.call(this,t)},Ll),Dl=(Object.defineProperty(Sl.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Sl.prototype,"size",{get:function(){return this.Ta.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(Sl.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),Sl.prototype.forEach=function(e,n){var r=this;this.Ta.docs.forEach(function(t){e.call(n,new kl(r.ha,r.aa,t.key,t,new zp(r.Ta.nn.has(t.key),r.Ta.fromCache),r.query.fa))})},Sl.prototype.docChanges=function(t){if(void 0===t&&(t={}),(t=!!t.includeMetadataChanges)&&this.Ta.sn)throw new Pr(Lr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Aa&&this.Ia===t||(this.Aa=function(i,e){if(i.Ta.tn.W()){var n=0;return i.Ta.docChanges.map(function(t){var e=new kl(i.ha,i.aa,t.doc.key,t.doc,new zp(i.Ta.nn.has(t.doc.key),i.Ta.fromCache),i.query.fa);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.Ta.tn;return i.Ta.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new kl(i.ha,i.aa,t.doc.key,t.doc,new zp(i.Ta.nn.has(t.doc.key),i.Ta.fromCache),i.query.fa),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Rr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.Ia=t),this.Aa},Sl);function Sl(t,e,n,r){this.ha=t,this.aa=e,this.Ta=r,this.metadata=new zp(r.hasPendingWrites,r.fromCache),this.query=n}function Ll(){return null!==Ol&&Ol.apply(this,arguments)||this}function Pl(t,e,n,r,i,o){var s=this;return(s=_l.call(this,t,e,n,r,o)||this).ha=t,s.ma=t,s.metadata=i,s}function Vl(t,e){return t instanceof Rl&&e instanceof Rl?t.ha===e.ha&&t.la.isEqual(e.la)&&(null===t._a?null===e._a:t._a.isEqual(e._a))&&t.fa===e.fa:t instanceof Dl&&e instanceof Dl&&t.ha===e.ha&&Nf(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.Ta.isEqual(e.Ta)}var Ul,jl=(n(Ml,Ul=me),Ml.prototype.ea=function(t){return new Xc(t)},Ml.prototype.sa=function(t){return t=this.ua(t,this.firestore.Qh),new zl(this.firestore,null,t)},Ml);function Ml(t){var e=this;return(e=Ul.call(this)||this).firestore=t,e}function xl(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Sc(t,zl);var o=Sc(t.firestore,Nl),s=Af(o);return e instanceof Qc&&(e=e.Ch),Fl(o,("string"==typeof e||e instanceof Il?Mf(s,"updateDoc",t.la,e,n,r):jf(s,"updateDoc",t.la,e)).Pa(t.la,ms.exists(!0)))}function ql(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];e instanceof Qc&&(e=e.Ch);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||ea(n[i])||(r=n[i],i++);var o,s,u,a,h,c,l={includeMetadataChanges:r.includeMetadataChanges};return ea(n[i])&&(o=n[i],n[i]=null===(r=o.next)||void 0===r?void 0:r.bind(o),n[i+1]=null===(r=o.error)||void 0===r?void 0:r.bind(o),n[i+2]=null===(r=o.complete)||void 0===r?void 0:r.bind(o)),e instanceof zl?(u=Sc(e.firestore,Nl),a=eu(e.la.path),c={next:function(t){n[i]&&n[i](Gl(u,e,t))},error:n[i+1],complete:n[i+2]}):(s=Sc(e,Bl),u=Sc(s.firestore,Nl),a=s.Ra,h=new jl(u),c={next:function(t){n[i]&&n[i](new Dl(u,h,s,t))},error:n[i+1],complete:n[i+2]},df(e.Ra)),function(n,t,e){var r=this,i=new uc(c),o=new dh(t,i,e);return n.Ns.Ms(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=lh,[4,up(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})}),function(){i.bh(),n.Ns.Ms(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=fh,[4,up(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})})}}(Ip(u),a,l)}function Fl(t,e){return function(n,r){var t=this,i=new Qu;return n.Ns.Ms(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Sh,[4,sp(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(Ip(t),e)}function Gl(t,e,n){var r=n.docs.get(e.la),i=new jl(t);return new Rl(t,i,e.la,r,new zp(n.hasPendingWrites,n.fromCache),e.fa)}var zl=(Object.defineProperty(Wl.prototype,"ya",{get:function(){return this.la.path},enumerable:!1,configurable:!0}),Object.defineProperty(Wl.prototype,"id",{get:function(){return this.la.path.j()},enumerable:!1,configurable:!0}),Object.defineProperty(Wl.prototype,"path",{get:function(){return this.la.path.Y()},enumerable:!1,configurable:!0}),Object.defineProperty(Wl.prototype,"parent",{get:function(){return new vf(this.firestore,this.fa,this.la.path.q())},enumerable:!1,configurable:!0}),Wl.prototype.withConverter=function(t){return new Wl(this.firestore,t,this.la)},Wl),Bl=(Hl.prototype.withConverter=function(t){return new Hl(this.firestore,t,this.Ra)},Hl);function Hl(t,e,n){this.fa=e,this.Ra=n,this.type="query",this.firestore=t}function Wl(t,e,n){this.fa=e,this.la=n,this.type="document",this.firestore=t}function Yl(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++)t=i[r].Va(t);return t}var Xl,Ql,Kl,Jl,$l,Zl=(n(hf,$l=l=function(){}),hf.prototype.Va=function(t){var e=Af(t.firestore),e=function(t,e,n,r,i,o){if(r.tt()){if("array-contains"===i||"array-contains-any"===i)throw new Pr(Lr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){ff(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var h=a[u];s.push(lf(n,t,h))}c={arrayValue:{values:s}}}else c=lf(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||ff(o,i),c=xf(e,"where",o,"in"===i||"not-in"===i);var c=vu.create(r,i,c);return function(t,e){if(e.Ie()){var n=ou(t);if(null!==n&&!n.isEqual(e.field))throw new Pr(Lr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=iu(t))&&pf(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new Pr(Lr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Pr(Lr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,c),c}(t.Ra,e,t.firestore.Qh,this.pa,this.ga,this.va);return new Bl(t.firestore,t.fa,(e=(t=t.Ra).filters.concat([e]),new Js(t.path,t.collectionGroup,t.me.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},hf),tf=(n(af,Jl=l),af.prototype.Va=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Pr(Lr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Pr(Lr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Bu(e,n);return e=r,null!==iu(n=t)||null!==(t=ou(n))&&pf(0,t,e.field),r}(t.Ra,this.pa,this.ba);return new Bl(t.firestore,t.fa,(e=(t=t.Ra).me.concat([e]),new Js(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},af),ef=(n(uf,Kl=l),uf.prototype.Va=function(t){return new Bl(t.firestore,t.fa,hu(t.Ra,this.Ca,this.Sa))},uf),nf=(n(sf,Ql=l),sf.prototype.Va=function(t){var e=cf(t,this.type,this.Da,this.Na);return new Bl(t.firestore,t.fa,(t=t.Ra,new Js(t.path,t.collectionGroup,t.me.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},sf),rf=(n(of,Xl=l),of.prototype.Va=function(t){var e=cf(t,this.type,this.Da,this.Na);return new Bl(t.firestore,t.fa,(t=t.Ra,new Js(t.path,t.collectionGroup,t.me.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},of);function of(t,e,n){var r=this;return(r=Xl.call(this)||this).type=t,r.Da=e,r.Na=n,r}function sf(t,e,n){var r=this;return(r=Ql.call(this)||this).type=t,r.Da=e,r.Na=n,r}function uf(t,e,n){var r=this;return(r=Kl.call(this)||this).type=t,r.Ca=e,r.Sa=n,r}function af(t,e){var n=this;return(n=Jl.call(this)||this).pa=t,n.ba=e,n.type="orderBy",n}function hf(t,e,n){var r=this;return(r=$l.call(this)||this).pa=t,r.ga=e,r.va=n,r.type="where",r}function cf(t,h,e,n){if(e[0]instanceof Qc&&(e[0]=e[0].Ch),e[0]instanceof dl)return function(t,e,n,r){if(!n)throw new Pr(Lr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+h+"().");for(var i=[],o=0,s=uu(t);o<s.length;o++){var u=s[o];if(u.field.tt())i.push(Eo(e,n.key));else{var a=n.field(u.field);if(ao(a))throw new Pr(Lr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a)throw u=u.field.Y(),new Pr(Lr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.");i.push(a)}}return new Uu(i,r)}(t.Ra,t.firestore.Qh,e[0]._a,n);var r=Af(t.firestore);return function(t,e,n,r,i,o){var s=t.me;if(i.length>s.length)throw new Pr(Lr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var h=i[a];if(s[a].field.tt()){if("string"!=typeof h)throw new Pr(Lr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!su(t)&&-1!==h.indexOf("/"))throw new Pr(Lr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child($r.J(h));if(!ei.ot(c))throw new Pr(Lr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");c=new ei(c),u.push(Eo(e,c))}else h=xf(n,r,h),u.push(h)}return new Uu(u,o)}(t.Ra,t.firestore.Qh,r,h,e,n)}function lf(t,e,n){if(n instanceof Qc&&(n=n.Ch),"string"==typeof n){if(""===n)throw new Pr(Lr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!su(e)&&-1!==n.indexOf("/"))throw new Pr(Lr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child($r.J(n)),!ei.ot(e))throw new Pr(Lr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Eo(t,new ei(e))}if(n instanceof zl)return Eo(t,n.la);throw new Pr(Lr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Dc(n)+".")}function ff(t,e){if(!Array.isArray(t)||0===t.length)throw new Pr(Lr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Pr(Lr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function pf(t,e,n){if(!n.isEqual(e))throw new Pr(Lr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function df(t){if(ru(t)&&0===t.me.length)throw new Pr(Lr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var yf,vf=(n(gf,yf=Bl),Object.defineProperty(gf.prototype,"id",{get:function(){return this.Ra.path.j()},enumerable:!1,configurable:!0}),Object.defineProperty(gf.prototype,"path",{get:function(){return this.Ra.path.Y()},enumerable:!1,configurable:!0}),Object.defineProperty(gf.prototype,"parent",{get:function(){var t=this.ya.q();return t.W()?null:new zl(this.firestore,null,new ei(t))},enumerable:!1,configurable:!0}),gf.prototype.withConverter=function(t){return new gf(this.firestore,t,this.ya)},gf);function gf(t,e,n){var r=this;return(r=yf.call(this,t,e,eu(n))||this).firestore=t,r.ya=n,r.type="collection",r}function mf(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(t instanceof Qc&&(t=t.Ch),Cc("collection","path",e),t instanceof $c){var i=$r.J.apply($r,s([e],n));return kc(i),new vf(t,null,i)}if(!(t instanceof zl||t instanceof vf))throw new Pr(Lr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return kc(e=$r.J.apply($r,s([t.path],n)).child($r.J(e))),new vf(t.firestore,null,e)}function wf(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(t instanceof Qc&&(t=t.Ch),1===arguments.length&&(e=Br.S()),Cc("doc","path",e),t instanceof $c){var i=$r.J.apply($r,s([e],n));return Rc(i),new zl(t,null,new ei(i))}if(!(t instanceof zl||t instanceof vf))throw new Pr(Lr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Rc(e=t.ya.child($r.J.apply($r,s([e],n)))),new zl(t.firestore,t instanceof vf?t.fa:null,new ei(e))}var bf,Ef=(n(Tf,bf=me),Tf.prototype.ea=function(t){return new Xc(t)},Tf.prototype.sa=function(t){return t=this.ua(t,this.firestore.Qh),new zl(this.firestore,null,t)},Tf);function Tf(t){var e=this;return(e=bf.call(this)||this).firestore=t,e}function If(t,e){return t instanceof Qc&&(t=t.Ch),e instanceof Qc&&(e=e.Ch),(t instanceof zl||t instanceof vf)&&(e instanceof zl||e instanceof vf)&&t.firestore===e.firestore&&t.path===e.path&&t.fa===e.fa}function Nf(t,e){return t instanceof Qc&&(t=t.Ch),e instanceof Qc&&(e=e.Ch),t instanceof Bl&&e instanceof Bl&&t.firestore===e.firestore&&cu(t.Ra,e.Ra)&&t.fa===e.fa}function Af(t){var e=t.Jh(),n=ta(t.Qh);return new Lf(t.Qh,!!e.ignoreUndefinedProperties,n)}var Cf=/^__.*__$/,Of=(kf.prototype.Pa=function(t,e){var n=[];return null!==this.ee?n.push(new Os(t,this.data,this.ee,e)):n.push(new Cs(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Ss(t,this.fieldTransforms)),n},kf),_f=(Rf.prototype.Pa=function(t,e){return e=[new Os(t,this.data,this.ee,e)],0<this.fieldTransforms.length&&e.push(new Ss(t,this.fieldTransforms)),e},Rf);function Rf(t,e,n){this.data=t,this.ee=e,this.fieldTransforms=n}function kf(t,e,n){this.data=t,this.ee=e,this.fieldTransforms=n}function Df(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Rr()}}var Sf=(Object.defineProperty(Vf.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Vf.prototype,"Dh",{get:function(){return this.settings.Dh},enumerable:!1,configurable:!0}),Vf.prototype.Fa=function(t){return new Vf(Object.assign(Object.assign({},this.settings),t),this.t,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.ee)},Vf.prototype.Oa=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.Fa({path:e,Fh:!1})).La(t),e},Vf.prototype.$a=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t);return(t=this.Fa({path:t,Fh:!1})).xa(),t},Vf.prototype.ka=function(t){return this.Fa({path:void 0,Fh:!0})},Vf.prototype.Nh=function(t){return Yf(t,this.settings.methodName,this.settings.Ma||!1,this.path,this.settings.xh)},Vf.prototype.contains=function(e){return void 0!==this.ee.find(function(t){return e.G(t)})||void 0!==this.fieldTransforms.find(function(t){return e.G(t.field)})},Vf.prototype.xa=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.La(this.path.get(t))},Vf.prototype.La=function(t){if(0===t.length)throw this.Nh("Document fields must not be empty");if(Df(this.Dh)&&Cf.test(t))throw this.Nh('Document fields cannot begin and end with "__"')},Vf),Lf=(Pf.prototype.Ua=function(t,e,n,r){return void 0===r&&(r=!1),new Sf({Dh:t,methodName:e,xh:n,path:ti.X(),Fh:!1,Ma:r},this.t,this.serializer,this.ignoreUndefinedProperties)},Pf);function Pf(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.serializer=n||ta(t)}function Vf(t,e,n,r,i,o){this.settings=t,this.t=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.xa(),this.fieldTransforms=i||[],this.ee=o||[]}function Uf(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Ua(o.merge||o.mergeFields?2:0,e,n,i);zf("Data must be an object, but it was:",s,r);var u,a,r=Ff(r,s);if(o.merge)u=new ys(s.ee),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],c=0,l=o.mergeFields;c<l.length;c++){var f=Bf(e,l[c],n);if(!s.contains(f))throw new Pr(Lr.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");Xf(h,f)||h.push(f)}u=new ys(h),a=s.fieldTransforms.filter(function(t){return u.ue(t.field)})}else u=null,a=s.fieldTransforms;return new Of(new xs(r),u,a)}function jf(t,r,i,e){var o=t.Ua(1,r,i);zf("Data must be an object, but it was:",o,e);var s=[],u=new qs;return so(e,function(t,e){var n=Wf(r,t,i);e instanceof Qc&&(e=e.Ch),t=o.$a(n),e instanceof Uc?s.push(n):null!=(t=qf(e,t))&&(s.push(n),u.set(n,t))}),e=new ys(s),new _f(u.ae(),e,o.fieldTransforms)}function Mf(t,e,n,r,i,o){var s=t.Ua(1,e,n),u=[Bf(e,r,n)],a=[i];if(o.length%2!=0)throw new Pr(Lr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(Bf(e,o[h])),a.push(o[h+1]);for(var c,l,f,p=[],d=new qs,y=u.length-1;0<=y;--y)Xf(p,u[y])||(c=u[y],(l=a[y])instanceof Qc&&(l=l.Ch),f=s.$a(c),l instanceof Uc?p.push(c):null!=(f=qf(l,f))&&(p.push(c),d.set(c,f)));return i=new ys(p),new _f(d.ae(),i,s.fieldTransforms)}function xf(t,e,n,r){return void 0===r&&(r=!1),qf(n,t.Ua(r?4:3,e))}function qf(s,t){if(s instanceof Qc&&(s=s.Ch),Gf(s))return zf("Unsupported field value:",t,s),Ff(s,t);if(s instanceof Vc)return function(t,e){if(!Df(e.Dh))throw e.Nh(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Nh(t._methodName+"() is not currently supported inside arrays");(t=t.Sh(e))&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.ee.push(t.path),s instanceof Array){if(t.settings.Fh&&4!==t.Dh)throw t.Nh("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=qf(i[r],t.ka(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof Qc&&(t=t.Ch),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return So(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Kr.fromDate(t);return{timestampValue:Lo(e.serializer,n)}}if(t instanceof Kr){var r=new Kr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Lo(e.serializer,r)}}if(t instanceof Yc)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Xc)return{bytesValue:Po(e.serializer,t.Mh)};if(t instanceof zl){if(n=e.t,!(r=t.firestore.Qh).isEqual(n))throw e.Nh("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Uo(t.firestore.Qh||e.t,t.la.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.Nh("Unsupported field value: "+Dc(t))}(s,t)}function Ff(t,n){var r={};return uo(t)?n.path&&0<n.path.length&&n.ee.push(n.path):so(t,function(t,e){null!=(e=qf(e,n.Oa(t)))&&(r[t]=e)}),{mapValue:{fields:r}}}function Gf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Kr||t instanceof Yc||t instanceof Xc||t instanceof zl||t instanceof Vc)}function zf(t,e,n){if(!Gf(n)||"object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))throw"an object"===(n=Dc(n))?e.Nh(t+" a custom object"):e.Nh(t+" "+n);var r}function Bf(t,e,n){if(e instanceof Qc&&(e=e.Ch),e instanceof Il)return e.da;if("string"==typeof e)return Wf(t,e);throw Yf("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Hf=new RegExp("[~\\*/\\[\\]]");function Wf(e,n,r){if(0<=n.search(Hf))throw Yf("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(Il.bind.apply(Il,s([void 0],n.split("."))))).da}catch(t){throw Yf("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function Yf(t,e,n,r,i){var o=r&&!r.W(),s=void 0!==i,e="Function "+e+"() called with invalid data";return n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Pr(Lr.INVALID_ARGUMENT,(e+=". ")+t+n)}function Xf(t,e){return t.some(function(t){return t.isEqual(e)})}var Qf=(tp.prototype.Wa=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.Ga(),0<this.mutations.length)throw new Pr(Lr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var r,e,n,i,o;return v(this,function(t){switch(t.label){case 0:return e=Fo((r=s).serializer)+"/documents",n={documents:u.map(function(t){return Mo(r.serializer,t)})},[4,r.kr("BatchGetDocuments",e,n)];case 1:return n=t.sent(),i=new Map,n.forEach(function(t){var e,n,t=(n=r.serializer,"found"in t?function(t,e){kr(!!e.found),e.found.name,e.found.updateTime;var n=xo(t,e.found.name),t=Vo(e.found.updateTime),e=new xs({mapValue:{fields:e.found.fields}});return new Xs(n,t,e,{})}(n,t):"missing"in t?(e=n,kr(!!(n=t).missing),kr(!!n.readTime),e=xo(e,n.missing),n=Vo(n.readTime),new Qs(e,n)):Rr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){kr(!!(t=i.get(t.toString()))),o.push(t)}),o)]}})})}(this.Hr,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Qs||t instanceof Xs?n.Ka(t):Rr()}),e)]}})})},tp.prototype.set=function(t,e){this.write(e.Pa(t,this.re(t))),this.ja.add(t.toString())},tp.prototype.update=function(t,e){try{this.write(e.Pa(t,this.za(t)))}catch(t){this.Qa=t}this.ja.add(t.toString())},tp.prototype.delete=function(t){this.write([new js(t,this.re(t))]),this.ja.add(t.toString())},tp.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.Ga(),this.Qa)throw this.Qa;return e=this.qa,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=ei.st(e),n.mutations.push(new Ms(e,n.re(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=Fo((e=i).serializer)+"/documents",r={writes:o.map(function(t){return Bo(e.serializer,t)})},[4,e.$r("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Hr,this.mutations)];case 1:return t.sent(),this.Ba=!0,[2]}})})},tp.prototype.Ka=function(t){var e;if(t instanceof Xs)e=t.version;else{if(!(t instanceof Qs))throw Rr();e=Jr.min()}var n=this.qa.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Pr(Lr.ABORTED,"Document version changed between two reads.")}else this.qa.set(t.key.toString(),e)},tp.prototype.re=function(t){var e=this.qa.get(t.toString());return!this.ja.has(t.toString())&&e?ms.updateTime(e):ms.ce()},tp.prototype.za=function(t){var e=this.qa.get(t.toString());if(this.ja.has(t.toString())||!e)return ms.exists(!0);if(e.isEqual(Jr.min()))throw new Pr(Lr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ms.updateTime(e)},tp.prototype.write=function(t){this.Ga(),this.mutations=this.mutations.concat(t)},tp.prototype.Ga=function(){},tp),Kf=(Zf.prototype.run=function(){this.Ya()},Zf.prototype.Ya=function(){var t=this;this.Ks.vs(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new Qf(this.Hr),(n=this.Ja(e))&&n.then(function(t){r.Ns.Ms(function(){return e.commit().then(function(){r.Os.resolve(t)}).catch(function(t){r.Xa(t)})})}).catch(function(t){r.Xa(t)}),[2]})})})},Zf.prototype.Ja=function(t){try{var e=this.updateFunction(t);return!ai(e)&&e.catch&&e.then?e:(this.Os.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Os.reject(t),null}},Zf.prototype.Xa=function(t){var e=this;0<this.Ha&&this.Za(t)?(--this.Ha,this.Ns.Ms(function(){return e.Ya(),Promise.resolve()})):this.Os.reject(t)},Zf.prototype.Za=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!Ei(t))},Zf),Jf=($f.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.V.promise];case 1:return[2,(t.sent(),{Ns:this.Ns,th:this.th,clientId:this.clientId,credentials:this.credentials,Ah:this.user,pu:100})]}})})},$f.prototype.nl=function(t){var e=this;this.tl=t,this.V.promise.then(function(){return e.tl(e.user)})},$f.prototype.el=function(){if(this.Ns.Hs)throw new Pr(Lr.FAILED_PRECONDITION,"The client has already been terminated.")},$f.prototype.terminate=function(){var t=this;this.Ns.Zs();var n=new Qu;return this.Ns.Ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.sl?[4,this.sl.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.il?[4,this.il.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.R(),n.resolve(),[3,6];case 5:return e=va(t.sent(),"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},$f);function $f(t,e,n){var r=this;this.credentials=t,this.Ns=e,this.th=n,this.user=br.UNAUTHENTICATED,this.clientId=Br.S(),this.tl=function(){},this.V=new Qu,this.credentials.I(function(t){Ar("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.tl(t)),r.V.resolve()})}function Zf(t,e,n,r){this.Ns=t,this.Hr=e,this.updateFunction=n,this.Os=r,this.Ha=5,this.Ks=new aa(this.Ns,"transaction_retry")}function tp(t){this.Hr=t,this.qa=new Map,this.mutations=[],this.Ba=!1,this.Qa=null,this.ja=new Set}function ep(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.il?[3,2]:(Ar("FirestoreClient","Using default OfflineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return r.Ns.si(),Ar("FirestoreClient","Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return e=t.sent(),[4,i.initialize(e)];case 2:return t.sent(),r.nl(function(e){return r.Ns.ti(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,_a(i.zr,e)];case 1:return t.sent(),[2]}})})})}),i.persistence.xc(function(){return r.terminate()}),r.il=i,[2]}})})}(e,new oc)]);case 1:t.sent(),t.label=2;case 2:return[2,e.il]}})})}function np(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.sl?[3,2]:(Ar("FirestoreClient","Using default OnlineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.Ns.si(),[4,ep(r)];case 1:return e=t.sent(),Ar("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.nl(function(t){return r.Ns.ti(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).Ns.si(),Ar("RemoteStore","RemoteStore received new credentials"),n=th(e),e.Zr.add(3),[4,Ya(e)];case 1:return t.sent(),n&&e.io.set("Unknown"),[4,e.Yr.ph(i)];case 2:return t.sent(),e.Zr.delete(3),[4,Wa(e)];case 3:return t.sent(),[2]}})})}(i.Pu,t)})}),r.sl=i,[2]}})})}(e,new sc)]);case 1:t.sent(),t.label=2;case 2:return[2,e.sl]}})})}function rp(t){return ep(t).then(function(t){return t.persistence})}function ip(t){return ep(t).then(function(t){return t.zr})}function op(t){return np(t).then(function(t){return t.Pu})}function sp(t){return np(t).then(function(t){return t.yh})}function up(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,np(r)];case 1:return e=t.sent(),[2,((n=e.yu).wo=function(h,c){return y(this,void 0,void 0,function(){var n,o,s,u,a;return v(this,function(t){switch(t.label){case 0:return(e=h).Pu.Yr.uo=Lh.bind(null,e),e.Pu.Yr.Zn=function(t,e){var n=t;if((t=n.Du.get(e))&&t.Ru)return Mi().add(t.key);var r=Mi();if(!(e=n.bu.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.vu.get(s),r=r.Kt(s.view.au);return r}.bind(null,e),e.Pu.Yr.oo=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Vu.Ho(s,"rejected",u),i=e.Du.get(s),(n=i&&i.key)?(r=(r=new Ii(ei.k)).Tt(n,new Qs(n,Jr.min())),i=Mi().add(n),i=new zi(Jr.min(),new Map,new ki(Wr),r,i),[4,Lh(e,i)]):[3,2];case 1:return t.sent(),e.Su=e.Su.remove(n),e.Du.delete(s),Fh(e),[3,4];case 2:return[4,ka(e.zr,s,!1).then(function(){return Mh(e,s,u)}).catch(Sa)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.gu.pr=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query;if(u=n.queries.get(u)){for(var a=0,h=u.listeners;a<h.length;a++)h[a].mo(s)&&(r=!0);u._o=s}}r&&ph(n)}.bind(null,e.yu),e.gu.ku=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,e.yu),(a=(n=e).vu.get(c))?(o=a.targetId,n.Vu.zo(o),s=a.view.Iu(),[3,4]):[3,1];case 1:return[4,(e=n.zr,r=au(c),(i=e).persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.gi.Zi(e,r).next(function(t){return t?(n=t,Xu.resolve(n)):i.gi.Mu(e).next(function(t){return n=new wi(r,t,0,e.Gi),i.gi.Uu(e,n).next(function(){return n})})})}).then(function(t){var e=i.Ii.get(t.targetId);return(null===e||0<t.ft.F(e.ft))&&(i.Ii=i.Ii.Tt(t.targetId,t),i.Ri.set(r,t.targetId)),t}))];case 2:return u=t.sent(),a=n.Vu.zo(u.targetId),o=u.targetId,[4,function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.qu=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.lu(o))._i?[4,Da(r.zr,i.query,!1).then(function(t){return t=t.documents,i.view.lu(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.on.get(i.targetId),n=i.view.du(e,r.$u,n),[2,(qh(r,i.targetId,n.mu),n.snapshot)]}})})}(i,t,e,n)},[4,Da(i.zr,o,!0)];case 1:return n=t.sent(),r=new Eh(o,n.nr),e=r.lu(n.documents),n=Bi.ln(s,u&&"Offline"!==i.onlineState),n=r.du(e,i.$u,n),qh(i,s,n.mu),r=new Th(o,s,r),i.vu.set(o,r),i.bu.has(s)?i.bu.get(s).push(o):i.bu.set(s,[o]),[2,n.snapshot]}})})}(n,c,o,"current"===a)];case 3:s=t.sent(),n.$u&&Xa(n.Pu,u),t.label=4;case 4:return[2,s]}var r,i,e})})}.bind(null,e.yh),n.To=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).vu.get(o),1<(r=e.bu.get(n.targetId)).length?[2,(e.bu.set(n.targetId,r.filter(function(t){return!cu(t,o)})),void e.vu.delete(o))]:e.$u?(e.Vu.Yo(n.targetId),e.Vu.tu(n.targetId)?[3,2]:[4,ka(e.zr,n.targetId,!1).then(function(){e.Vu.Xo(n.targetId),Qa(e.Pu,n.targetId),Mh(e,n.targetId)}).catch(Sa)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Mh(e,n.targetId),[4,ka(e.zr,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.yh),n)]}})})}function ap(n,r,i){var t=this;void 0===i&&(i={});var o=new Qu;return n.Ns.Ms(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(n,r,i,o,s){var t=new uc({next:function(t){r.Ms(function(){return fh(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Pr(Lr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Pr(Lr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new dh(eu(i.path),t,{includeMetadataChanges:!0,po:!0});return lh(n,u)},[4,up(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.Ns,r,i,o])]}})})}),o.promise}function hp(n,r,i){var t=this;void 0===i&&(i={});var o=new Qu;return n.Ns.Ms(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new uc({next:function(t){n.Ms(function(){return fh(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Pr(Lr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new dh(t,o,{includeMetadataChanges:!0,po:!0});return lh(e,s)},[4,up(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.Ns,r,i,o])]}})})}),o.promise}var cp=(lp.prototype.set=function(t,e,n){return this.hl(),e=id((t=fp(t,this.ha)).fa,e,n),n=Uf(this.cl,"WriteBatch.set",t.la,e,null!==t.fa,n),this.ol=this.ol.concat(n.Pa(t.la,ms.ce())),this},lp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return this.hl(),t=fp(t,this.ha),e instanceof Qc&&(e=e.Ch),e="string"==typeof e||e instanceof Il?Mf(this.cl,"WriteBatch.update",t.la,e,n,r):jf(this.cl,"WriteBatch.update",t.la,e),this.ol=this.ol.concat(e.Pa(t.la,ms.exists(!0))),this},lp.prototype.delete=function(t){return this.hl(),t=fp(t,this.ha),this.ol=this.ol.concat(new js(t.la,ms.ce())),this},lp.prototype.commit=function(){return this.hl(),this.ul=!0,0<this.ol.length?this.rl(this.ol):Promise.resolve()},lp.prototype.hl=function(){if(this.ul)throw new Pr(Lr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},lp);function lp(t,e){this.ha=t,this.rl=e,this.ol=[],this.ul=!1,this.cl=Af(t)}function fp(t,e){if(t instanceof Qc&&(t=t.Ch),t.firestore!==e)throw new Pr(Lr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var pp,dp,yp=(Tp.prototype.get=function(t){var e=this,n=fp(t,this.ha),r=new Ef(this.ha);return this.al.Wa([n.la]).then(function(t){if(!t||1!==t.length)return Rr();if((t=t[0])instanceof Qs)return new dl(e.ha,r,n.la,null,n.fa);if(t instanceof Xs)return new dl(e.ha,r,t.key,t,n.fa);throw Rr()})},Tp.prototype.set=function(t,e,n){return e=id((t=fp(t,this.ha)).fa,e,n),n=Uf(this.cl,"Transaction.set",t.la,e,null!==t.fa,n),this.al.set(t.la,n),this},Tp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return t=fp(t,this.ha),e instanceof Qc&&(e=e.Ch),e="string"==typeof e||e instanceof Il?Mf(this.cl,"Transaction.update",t.la,e,n,r):jf(this.cl,"Transaction.update",t.la,e),this.al.update(t.la,e),this},Tp.prototype.delete=function(t){return t=fp(t,this.ha),this.al.delete(t.la),this},n(Ep,dp=Tp),Ep.prototype.get=function(t){var e=this,n=fp(t,this.ha),r=new jl(this.ha);return dp.prototype.get.call(this,t).then(function(t){return new Rl(e.ha,r,n.la,t._a,new zp(!1,!1),n.fa)})},Ep),vp="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",gp=(bp.prototype.enableIndexedDbPersistence=function(t,e){throw new Pr(Lr.FAILED_PRECONDITION,vp)},bp.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new Pr(Lr.FAILED_PRECONDITION,vp)},bp.prototype.clearIndexedDbPersistence=function(t){throw new Pr(Lr.FAILED_PRECONDITION,vp)},bp),mp=(n(wp,pp=Qc),Object.defineProperty(wp.prototype,"Qh",{get:function(){return this.Ch.Qh},enumerable:!1,configurable:!0}),wp.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.Ch.Yh()),t)).merge,this.Ch.Hh(t)},wp.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.Ch.Yh().host&&Or("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},wp.prototype.enableNetwork=function(){return function(r){var t=this;return r.Ns.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,rp(r)];case 1:return e=t.sent(),[4,op(r)];case 2:return n=t.sent(),[2,(e.Fc(!0),(t=n).Zr.delete(0),Wa(t))]}})})})}(Ip(Sc(this.Ch,Nl)))},wp.prototype.disableNetwork=function(){return function(r){var t=this;return r.Ns.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,rp(r)];case 1:return e=t.sent(),[4,op(r)];case 2:return n=t.sent(),[2,(e.Fc(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Zr.add(0),[4,Ya(e)];case 1:return t.sent(),e.io.set("Offline"),[2]}})})}(n))]}})})})}(Ip(Sc(this.Ch,Nl)))},wp.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&_c("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.ll.enableMultiTabIndexedDbPersistence(this):this.ll.enableIndexedDbPersistence(this,n)},wp.prototype.clearPersistence=function(){return this.ll.clearIndexedDbPersistence(this)},wp.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this.Ch._delete()},wp.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new Qu;return n.Ns.Ms(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Vh,[4,sp(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(Ip(Sc(this.Ch,Nl)))},wp.prototype.onSnapshotsInSync=function(t){return function(n,t){var e=this,r=new uc(t);return n.Ns.Ms(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.fo.add(e),e.next()},[4,up(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),function(){r.bh(),n.Ns.Ms(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.fo.delete(e)},[4,up(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}}(Ip(Sc(this.Ch,Nl)),ea(t)?t:{next:t})},Object.defineProperty(wp.prototype,"app",{get:function(){if(!this._l)throw new Pr(Lr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._l},enumerable:!1,configurable:!0}),wp.prototype.collection=function(t){try{return new Qp(this,mf(this.Ch,t))}catch(t){throw Pp(t,"collection()","Firestore.collection()")}},wp.prototype.doc=function(t){try{return new kp(this,wf(this.Ch,t))}catch(t){throw Pp(t,"doc()","Firestore.doc()")}},wp.prototype.collectionGroup=function(t){try{return new Wp(this,function(t,e){if(t=Sc(t,$c),Cc("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new Pr(Lr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Bl(t,null,new Js($r.X(),e))}(this.Ch,t))}catch(t){throw Pp(t,"collectionGroup()","Firestore.collectionGroup()")}},wp.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new Qu;return n.Ns.Ms(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,np(n).then(function(t){return t.Hr})];case 1:return e=t.sent(),new Kf(n.Ns,e,r,i).run(),[2]}})})}),i.promise}(Ip(n=this.Ch),function(t){return t=new yp(n,t),e(new _p(r,t))})},wp.prototype.batch=function(){var e=this;return Ip(this.Ch),new Rp(new cp(this.Ch,function(t){return Fl(e.Ch,t)}))},wp);function wp(t,e,n){var r=this;return(r=pp.call(this,e)||this).ll=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof wr||(r._l=t),r}function bp(){}function Ep(t,e){var n=this;return(n=dp.call(this,t,e)||this).ha=t,n}function Tp(t,e){this.ha=t,this.al=e,this.cl=Af(t)}function Ip(t){return t.Ea||Np(t),t.Ea.el(),t.Ea}function Np(t){var e,n,r=t.Jh(),r=(e=t.Qh,n=t.Uh,new mr(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.Ea=new Jf(t.jh,t.wa,r)}var Ap,Cp,Op,_p=(n(Lp,Op=Qc),Lp.prototype.get=function(t){var e=this,t=rd(t);return this.Ch.get(t).then(function(t){return new Bp(e.ha,t)})},Lp.prototype.set=function(t,e,n){return t=rd(t),n?(Oc("Transaction.set",n),this.Ch.set(t,e,n)):this.Ch.set(t,e),this},Lp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=rd(t);return 2===arguments.length?this.Ch.update(o,e):(t=this.Ch).update.apply(t,s([o,e,n],r)),this},Lp.prototype.delete=function(t){return t=rd(t),this.Ch.delete(t),this},Lp),Rp=(n(Sp,Cp=Qc),Sp.prototype.set=function(t,e,n){return t=rd(t),n?(Oc("WriteBatch.set",n),this.Ch.set(t,e,n)):this.Ch.set(t,e),this},Sp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=rd(t);return 2===arguments.length?this.Ch.update(o,e):(t=this.Ch).update.apply(t,s([o,e,n],r)),this},Sp.prototype.delete=function(t){return t=rd(t),this.Ch.delete(t),this},Sp.prototype.commit=function(){return this.Ch.commit()},Sp),kp=(n(Dp,Ap=Qc),Dp.fl=function(t,e,n){if(t.length%2!=0)throw new Pr(Lr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.Y()+" has "+t.length);return new Dp(e,new zl(e.Ch,n,new ei(t)))},Dp.ca=function(t,e,n){return new Dp(e,new zl(e.Ch,n,t))},Object.defineProperty(Dp.prototype,"id",{get:function(){return this.Ch.id},enumerable:!1,configurable:!0}),Object.defineProperty(Dp.prototype,"parent",{get:function(){return new Qp(this.firestore,this.Ch.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(Dp.prototype,"path",{get:function(){return this.Ch.path},enumerable:!1,configurable:!0}),Dp.prototype.collection=function(t){try{return new Qp(this.firestore,mf(this.Ch,t))}catch(t){throw Pp(t,"collection()","DocumentReference.collection()")}},Dp.prototype.isEqual=function(t){return t instanceof Qc&&(t=t.Ch),t instanceof zl&&If(this.Ch,t)},Dp.prototype.set=function(t,e){e=Oc("DocumentReference.set",e);try{return function(t,e,n){t=Sc(t,zl);var r=Sc(t.firestore,Nl),e=id(t.fa,e,n);return Fl(r,Uf(Af(r),"setDoc",t.la,e,null!==t.fa,n).Pa(t.la,ms.ce()))}(this.Ch,t,e)}catch(t){throw Pp(t,"setDoc()","DocumentReference.set()")}},Dp.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?xl(this.Ch,t):xl.apply(void 0,s([this.Ch,t,e],n))}catch(t){throw Pp(t,"updateDoc()","DocumentReference.update()")}},Dp.prototype.delete=function(){return Fl(Sc((t=this.Ch).firestore,Nl),[new js(t.la,ms.ce())]);var t},Dp.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Vp(t),i=Up(t,function(t){return new Bp(e.firestore,new Rl(e.firestore.Ch,e.aa,t.la,t._a,t.metadata,e.Ch.fa))});return ql(this.Ch,r,i)},Dp.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=Sc(e,zl);var n=Sc(e.firestore,Nl),t=Ip(n),r=new jl(n);return function(n,r){var t=this,i=new Qu;return n.Ns.Ms(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.bi.Ge(t,e)}))];case 1:return(r=t.sent())instanceof Xs?s.resolve(r):r instanceof Qs?s.resolve(null):s.reject(new Pr(Lr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=va(r=t.sent(),"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})},[4,ip(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.la).then(function(t){return new Rl(n,r,e.la,t,new zp(t instanceof Xs&&t.he,!0),e.fa)})}:"server"===(null==t?void 0:t.source)?function(e){e=Sc(e,zl);var n=Sc(e.firestore,Nl);return ap(Ip(n),e.la,{source:"server"}).then(function(t){return Gl(n,e,t)})}:function(e){e=Sc(e,zl);var n=Sc(e.firestore,Nl);return ap(Ip(n),e.la).then(function(t){return Gl(n,e,t)})})(this.Ch).then(function(t){return new Bp(e.firestore,new Rl(e.firestore.Ch,e.aa,t.la,t._a,t.metadata,e.Ch.fa))})},Dp.prototype.withConverter=function(t){return new Dp(this.firestore,this.Ch.withConverter(t))},Dp);function Dp(t,e){var n=this;return(n=Ap.call(this,e)||this).firestore=t,n.aa=new pl(t),n}function Sp(){return null!==Cp&&Cp.apply(this,arguments)||this}function Lp(t,e){var n=this;return(n=Op.call(this,e)||this).ha=t,n}function Pp(t,e,n){return t.message=t.message.replace(e,n),t}function Vp(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!ea(r))return r}return{}}function Up(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=ea(t[0])?t[0]:ea(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var jp,Mp,xp,qp,Fp,Gp,zp=(nd.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},nd),Bp=(n(ed,Gp=Qc),Object.defineProperty(ed.prototype,"ref",{get:function(){return new kp(this.ha,this.Ch.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(ed.prototype,"id",{get:function(){return this.Ch.id},enumerable:!1,configurable:!0}),Object.defineProperty(ed.prototype,"metadata",{get:function(){return this.Ch.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(ed.prototype,"exists",{get:function(){return this.Ch.exists()},enumerable:!1,configurable:!0}),ed.prototype.data=function(t){return this.Ch.data(t)},ed.prototype.get=function(t,e){return this.Ch.get(t,e)},ed.prototype.isEqual=function(t){return Vl(this.Ch,t.Ch)},ed),Hp=(n(td,Fp=Bp),td.prototype.data=function(t){return this.Ch.data(t)},td),Wp=(n(Zp,qp=Qc),Zp.prototype.where=function(t,e,n){try{return new Zp(this.firestore,Yl(this.Ch,(r=n,i=e,o=El("where",t),new Zl(o,i,r))))}catch(t){throw Pp(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},Zp.prototype.orderBy=function(n,t){try{return new Zp(this.firestore,Yl(this.Ch,function(t){void 0===t&&(t="asc");var e=t,t=El("orderBy",n);return new tf(t,e)}(t)))}catch(n){throw Pp(n,/(orderBy|where)\(\)/,"Query.$1()")}},Zp.prototype.limit=function(t){try{return new Zp(this.firestore,Yl(this.Ch,(Lc("limit",e=t),new ef("limit",e,"F"))))}catch(t){throw Pp(t,"limit()","Query.limit()")}var e},Zp.prototype.limitToLast=function(t){try{return new Zp(this.firestore,Yl(this.Ch,(Lc("limitToLast",e=t),new ef("limitToLast",e,"L"))))}catch(t){throw Pp(t,"limitToLast()","Query.limitToLast()")}var e},Zp.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Zp(this.firestore,Yl(this.Ch,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new nf("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw Pp(t,"startAt()","Query.startAt()")}},Zp.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Zp(this.firestore,Yl(this.Ch,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new nf("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw Pp(t,"startAfter()","Query.startAfter()")}},Zp.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Zp(this.firestore,Yl(this.Ch,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new rf("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw Pp(t,"endBefore()","Query.endBefore()")}},Zp.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Zp(this.firestore,Yl(this.Ch,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new rf("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw Pp(t,"endAt()","Query.endAt()")}},Zp.prototype.isEqual=function(t){return Nf(this.Ch,t.Ch)},Zp.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=Sc(e,Bl);var n=Sc(e.firestore,Nl),t=Ip(n),r=new jl(n);return function(n,r){var t=this,i=new Qu;return n.Ns.Ms(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Da(r,i,!0)];case 1:return n=t.sent(),e=new Eh(i,n.nr),n=e.lu(n.documents),n=e.du(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=va(n=t.sent(),"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})},[4,ip(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.Ra).then(function(t){return new Dl(n,r,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){e=Sc(e,Bl);var n=Sc(e.firestore,Nl),t=Ip(n),r=new jl(n);return hp(t,e.Ra,{source:"server"}).then(function(t){return new Dl(n,r,e,t)})}:function(e){e=Sc(e,Bl);var n=Sc(e.firestore,Nl),t=Ip(n),r=new jl(n);return df(e.Ra),hp(t,e.Ra).then(function(t){return new Dl(n,r,e,t)})})(this.Ch).then(function(t){return new Xp(e.firestore,new Dl(e.firestore.Ch,e.aa,e.Ch,t.Ta))})},Zp.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Vp(t),i=Up(t,function(t){return new Xp(e.firestore,new Dl(e.firestore.Ch,e.aa,e.Ch,t.Ta))});return ql(this.Ch,r,i)},Zp.prototype.withConverter=function(t){return new Zp(this.firestore,this.Ch.withConverter(t))},Zp),Yp=(n($p,xp=Qc),Object.defineProperty($p.prototype,"type",{get:function(){return this.Ch.type},enumerable:!1,configurable:!0}),Object.defineProperty($p.prototype,"doc",{get:function(){return new Hp(this.ha,this.Ch.doc)},enumerable:!1,configurable:!0}),Object.defineProperty($p.prototype,"oldIndex",{get:function(){return this.Ch.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty($p.prototype,"newIndex",{get:function(){return this.Ch.newIndex},enumerable:!1,configurable:!0}),$p),Xp=(n(Jp,Mp=Qc),Object.defineProperty(Jp.prototype,"query",{get:function(){return new Wp(this.ha,this.Ch.query)},enumerable:!1,configurable:!0}),Object.defineProperty(Jp.prototype,"metadata",{get:function(){return this.Ch.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Jp.prototype,"size",{get:function(){return this.Ch.size},enumerable:!1,configurable:!0}),Object.defineProperty(Jp.prototype,"empty",{get:function(){return this.Ch.empty},enumerable:!1,configurable:!0}),Object.defineProperty(Jp.prototype,"docs",{get:function(){var e=this;return this.Ch.docs.map(function(t){return new Hp(e.ha,t)})},enumerable:!1,configurable:!0}),Jp.prototype.docChanges=function(t){var e=this;return this.Ch.docChanges(t).map(function(t){return new Yp(e.ha,t)})},Jp.prototype.forEach=function(e,n){var r=this;this.Ch.forEach(function(t){e.call(n,new Hp(r.ha,t))})},Jp.prototype.isEqual=function(t){return Vl(this.Ch,t.Ch)},Jp),Qp=(n(Kp,jp=Wp),Object.defineProperty(Kp.prototype,"id",{get:function(){return this.Ch.id},enumerable:!1,configurable:!0}),Object.defineProperty(Kp.prototype,"path",{get:function(){return this.Ch.path},enumerable:!1,configurable:!0}),Object.defineProperty(Kp.prototype,"parent",{get:function(){var t=this.Ch.parent;return t?new kp(this.firestore,t):null},enumerable:!1,configurable:!0}),Kp.prototype.doc=function(t){try{return new kp(this.firestore,void 0===t?wf(this.Ch):wf(this.Ch,t))}catch(t){throw Pp(t,"doc()","CollectionReference.doc()")}},Kp.prototype.add=function(t){var e,n=this,r=this.Ch,i=t;return t=Sc(r.firestore,Nl),e=wf(r),i=id(r.fa,i),Fl(t,Uf(Af(r.firestore),"addDoc",e.la,i,null!==r.fa,{}).Pa(e.la,ms.exists(!1))).then(function(){return e}).then(function(t){return new kp(n.firestore,t)})},Kp.prototype.isEqual=function(t){return If(this.Ch,t.Ch)},Kp.prototype.withConverter=function(t){return new Kp(this.firestore,this.Ch.withConverter(t))},Kp);function Kp(t,e){var n=this;return(n=jp.call(this,t,e)||this).firestore=t,n.Ch=e,n}function Jp(t,e){var n=this;return(n=Mp.call(this,e)||this).ha=t,n}function $p(t,e){var n=this;return(n=xp.call(this,e)||this).ha=t,n}function Zp(t,e){var n=this;return(n=qp.call(this,e)||this).firestore=t,n.aa=new pl(t),n}function td(){return null!==Fp&&Fp.apply(this,arguments)||this}function ed(t,e){var n=this;return(n=Gp.call(this,e)||this).ha=t,n}function nd(t,e){this.hasPendingWrites=t,this.fromCache=e}function rd(t){return t instanceof Qc&&(t=t.Ch),Sc(t,zl)}function id(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var od,sd,l=(n(ad,sd=Qc),ad.documentId=function(){return new ad(ti.nt().Y())},ad.prototype.isEqual=function(t){return t instanceof Qc&&(t=t.Ch),t instanceof Il&&this.Ch.da.isEqual(t.da)},ad),me=(n(ud,od=Qc),ud.serverTimestamp=function(){var t=new zc("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new ud(t)},ud.delete=function(){var t=new Uc("deleteField");return t._methodName="FieldValue.delete",new ud(t)},ud.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Bc("arrayUnion",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayUnion",new ud(n)},ud.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Hc("arrayRemove",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayRemove",new ud(n)},ud.increment=function(t){return(t=new Wc("increment",t))._methodName="FieldValue.increment",new ud(t)},ud.prototype.isEqual=function(t){return this.Ch.isEqual(t.Ch)},ud),me={Firestore:mp,GeoPoint:Yc,Timestamp:Kr,Blob:fl,Transaction:_p,WriteBatch:Rp,DocumentReference:kp,DocumentSnapshot:Bp,Query:Wp,QueryDocumentSnapshot:Hp,QuerySnapshot:Xp,CollectionReference:Qp,FieldPath:l,FieldValue:me,setLogLevel:function(t){Ir.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};function ud(){return null!==od&&od.apply(this,arguments)||this}function ad(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return sd.call(this,new(Il.bind.apply(Il,s([void 0],t))))||this}(e=e.default).INTERNAL.registerComponent(new ge("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new mp(e,new Nl(e,t),new gp);var e},"PUBLIC").setServiceProps(Object.assign({},me))),e.registerVersion("@firebase/firestore","2.0.5")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});