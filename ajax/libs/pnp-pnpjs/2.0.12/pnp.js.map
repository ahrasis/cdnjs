{"version":3,"sources":["webpack://pnp/webpack/universalModuleDefinition","webpack://pnp/webpack/bootstrap","webpack://pnp/./node_modules/tslib/tslib.es6.js","webpack://pnp/./packages/common/index.ts","webpack://pnp/./packages/sp/telemetry.ts","webpack://pnp/./packages/odata/batch.ts","webpack://pnp/./packages/odata/caching.ts","webpack://pnp/./packages/odata/add-prop.ts","webpack://pnp/./packages/odata/invokable-extensions.ts","webpack://pnp/./packages/odata/invokable-binder.ts","webpack://pnp/./packages/odata/parsers.ts","webpack://pnp/./packages/odata/queryable.ts","webpack://pnp/./packages/odata/pipeline.ts","webpack://pnp/./packages/odata/pipeline-binder.ts","webpack://pnp/./packages/odata/request-builders.ts","webpack://pnp/./packages/sp/sharepointqueryable.ts","webpack://pnp/./packages/sp/operations.ts","webpack://pnp/./packages/graph/graphqueryable.ts","webpack://pnp/./packages/sp/webs/types.ts","webpack://pnp/./packages/sp/decorators.ts","webpack://pnp/./packages/graph/operations.ts","webpack://pnp/./packages/sp/utils/metadata.ts","webpack://pnp/./packages/sp/lists/types.ts","webpack://pnp/./packages/sp/utils/escapeQueryStrValue.ts","webpack://pnp/./packages/sp/items/types.ts","webpack://pnp/./packages/logging/logger.ts","webpack://pnp/./packages/logging/listeners.ts","webpack://pnp/./packages/sp/utils/extractweburl.ts","webpack://pnp/./packages/sp/odata.ts","webpack://pnp/./packages/sp/rest.ts","webpack://pnp/./packages/sp/sites/types.ts","webpack://pnp/./packages/sp/splibconfig.ts","webpack://pnp/./packages/graph/rest.ts","webpack://pnp/./packages/common/util.ts","webpack://pnp/./packages/sp/utils/toResourcePath.ts","webpack://pnp/./packages/graph/graphlibconfig.ts","webpack://pnp/./packages/sp/sites/index.ts","webpack://pnp/./packages/sp/webs/index.ts","webpack://pnp/./packages/sp/sphttpclient.ts","webpack://pnp/./packages/sp/utils/toabsoluteurl.ts","webpack://pnp/./packages/sp/batch.ts","webpack://pnp/./packages/graph/graphhttpclient.ts","webpack://pnp/./packages/common/libconfig.ts","webpack://pnp/./packages/common/collections.ts","webpack://pnp/./packages/common/safe-global.ts","webpack://pnp/./packages/sp/utils/objectToSPKeyValueCollection.ts","webpack://pnp/./packages/graph/index.ts","webpack://pnp/./packages/graph/types.ts","webpack://pnp/./packages/graph/batch.ts","webpack://pnp/./packages/config-store/configuration.ts","webpack://pnp/./packages/config-store/providers/cachingConfigurationProvider.ts","webpack://pnp/./packages/config-store/providers/spListConfigurationProvider.ts","webpack://pnp/./packages/sp/types.ts","webpack://pnp/./packages/sp/utils/file-names.ts","webpack://pnp/./packages/graph/utils/toabsoluteurl.ts","webpack://pnp/./packages/sp/lists/web.ts","webpack://pnp/./packages/sp/files/types.ts","webpack://pnp/./packages/sp/appcatalog/types.ts","webpack://pnp/./packages/sp/appcatalog/web.ts","webpack://pnp/./packages/sp/appcatalog/index.ts","webpack://pnp/./packages/sp/attachments/types.ts","webpack://pnp/./packages/sp/attachments/item.ts","webpack://pnp/./packages/sp/clientside-pages/funcs.ts","webpack://pnp/./packages/sp/files/web.ts","webpack://pnp/./packages/sp/comments/types.ts","webpack://pnp/./packages/sp/clientside-pages/types.ts","webpack://pnp/./packages/sp/comments/item.ts","webpack://pnp/./packages/sp/clientside-pages/web.ts","webpack://pnp/./packages/sp/folders/types.ts","webpack://pnp/./packages/sp/column-defaults/list.ts","webpack://pnp/./packages/sp/column-defaults/folder.ts","webpack://pnp/./packages/sp/content-types/types.ts","webpack://pnp/./packages/sp/content-types/web.ts","webpack://pnp/./packages/sp/content-types/item.ts","webpack://pnp/./packages/sp/content-types/list.ts","webpack://pnp/./packages/sp/features/types.ts","webpack://pnp/./packages/sp/features/site.ts","webpack://pnp/./packages/sp/features/web.ts","webpack://pnp/./packages/sp/fields/types.ts","webpack://pnp/./packages/sp/fields/web.ts","webpack://pnp/./packages/sp/fields/list.ts","webpack://pnp/./packages/sp/files/folder.ts","webpack://pnp/./packages/sp/files/item.ts","webpack://pnp/./packages/sp/folders/item.ts","webpack://pnp/./packages/sp/folders/list.ts","webpack://pnp/./packages/sp/folders/web.ts","webpack://pnp/./packages/sp/forms/types.ts","webpack://pnp/./packages/sp/forms/list.ts","webpack://pnp/./packages/sp/hubsites/types.ts","webpack://pnp/./packages/sp/hubsites/site.ts","webpack://pnp/./packages/sp/hubsites/web.ts","webpack://pnp/./packages/sp/hubsites/index.ts","webpack://pnp/./packages/sp/navigation/types.ts","webpack://pnp/./packages/sp/navigation/web.ts","webpack://pnp/./packages/sp/navigation/index.ts","webpack://pnp/./packages/sp/profiles/types.ts","webpack://pnp/./packages/sp/profiles/index.ts","webpack://pnp/./packages/sp/regional-settings/types.ts","webpack://pnp/./packages/sp/regional-settings/funcs.ts","webpack://pnp/./packages/sp/regional-settings/web.ts","webpack://pnp/./packages/sp/user-custom-actions/types.ts","webpack://pnp/./packages/sp/regional-settings/user-custom-actions.ts","webpack://pnp/./packages/sp/regional-settings/list.ts","webpack://pnp/./packages/sp/regional-settings/field.ts","webpack://pnp/./packages/sp/regional-settings/content-type.ts","webpack://pnp/./packages/sp/related-items/types.ts","webpack://pnp/./packages/sp/search/query.ts","webpack://pnp/./packages/sp/search/types.ts","webpack://pnp/./packages/sp/search/suggest.ts","webpack://pnp/./packages/sp/search/index.ts","webpack://pnp/./packages/sp/site-users/types.ts","webpack://pnp/./packages/sp/security/types.ts","webpack://pnp/./packages/sp/sharing/types.ts","webpack://pnp/./packages/sp/site-groups/types.ts","webpack://pnp/./packages/sp/security/funcs.ts","webpack://pnp/./packages/sp/security/item.ts","webpack://pnp/./packages/sp/security/list.ts","webpack://pnp/./packages/sp/security/web.ts","webpack://pnp/./packages/sp/sharing/funcs.ts","webpack://pnp/./packages/sp/sharing/file.ts","webpack://pnp/./packages/sp/sharing/folder.ts","webpack://pnp/./packages/sp/sharing/item.ts","webpack://pnp/./packages/sp/sharing/web.ts","webpack://pnp/./packages/sp/site-designs/types.ts","webpack://pnp/./packages/sp/site-designs/web.ts","webpack://pnp/./packages/sp/site-designs/index.ts","webpack://pnp/./packages/sp/site-groups/web.ts","webpack://pnp/./packages/sp/site-scripts/types.ts","webpack://pnp/./packages/sp/site-scripts/web.ts","webpack://pnp/./packages/sp/site-scripts/list.ts","webpack://pnp/./packages/sp/site-scripts/index.ts","webpack://pnp/./packages/sp/site-users/web.ts","webpack://pnp/./packages/sp/social/types.ts","webpack://pnp/./packages/sp/social/index.ts","webpack://pnp/./packages/sp/sputilities/types.ts","webpack://pnp/./packages/sp/sputilities/index.ts","webpack://pnp/./packages/sp/subscriptions/types.ts","webpack://pnp/./packages/sp/subscriptions/list.ts","webpack://pnp/./packages/sp/taxonomy/types.ts","webpack://pnp/./packages/sp/taxonomy/index.ts","webpack://pnp/./packages/sp/user-custom-actions/list.ts","webpack://pnp/./packages/sp/user-custom-actions/web.ts","webpack://pnp/./packages/sp/user-custom-actions/site.ts","webpack://pnp/./packages/sp/views/types.ts","webpack://pnp/./packages/sp/views/list.ts","webpack://pnp/./packages/sp/webparts/types.ts","webpack://pnp/./packages/sp/webparts/file.ts","webpack://pnp/./packages/sp/presets/all.ts","webpack://pnp/./packages/graph/decorators.ts","webpack://pnp/./packages/graph/conversations/types.ts","webpack://pnp/./packages/graph/attachments/types.ts","webpack://pnp/./packages/graph/utils/type.ts","webpack://pnp/./packages/graph/attachments/conversations.ts","webpack://pnp/./packages/graph/directory-objects/types.ts","webpack://pnp/./packages/graph/groups/types.ts","webpack://pnp/./packages/graph/calendars/funcs.ts","webpack://pnp/./packages/graph/calendars/types.ts","webpack://pnp/./packages/graph/calendars/groups.ts","webpack://pnp/./packages/graph/users/types.ts","webpack://pnp/./packages/graph/calendars/users.ts","webpack://pnp/./packages/graph/contacts/types.ts","webpack://pnp/./packages/graph/contacts/users.ts","webpack://pnp/./packages/graph/conversations/groups.ts","webpack://pnp/./packages/graph/directory-objects/index.ts","webpack://pnp/./packages/graph/groups/index.ts","webpack://pnp/./packages/graph/insights/types.ts","webpack://pnp/./packages/graph/insights/users.ts","webpack://pnp/./packages/graph/invitations/types.ts","webpack://pnp/./packages/graph/invitations/index.ts","webpack://pnp/./packages/graph/members/types.ts","webpack://pnp/./packages/graph/members/groups.ts","webpack://pnp/./packages/graph/messages/types.ts","webpack://pnp/./packages/graph/messages/users.ts","webpack://pnp/./packages/graph/onedrive/types.ts","webpack://pnp/./packages/graph/onedrive/users.ts","webpack://pnp/./packages/graph/onenote/types.ts","webpack://pnp/./packages/graph/onenote/users.ts","webpack://pnp/./packages/graph/photos/types.ts","webpack://pnp/./packages/graph/photos/groups.ts","webpack://pnp/./packages/graph/photos/users.ts","webpack://pnp/./packages/graph/planner/types.ts","webpack://pnp/./packages/graph/planner/groups.ts","webpack://pnp/./packages/graph/planner/users.ts","webpack://pnp/./packages/graph/planner/index.ts","webpack://pnp/./packages/graph/subscriptions/types.ts","webpack://pnp/./packages/graph/subscriptions/index.ts","webpack://pnp/./packages/graph/teams/types.ts","webpack://pnp/./packages/graph/teams/users.ts","webpack://pnp/./packages/graph/teams/index.ts","webpack://pnp/./packages/graph/users/index.ts","webpack://pnp/./packages/common/net.ts","webpack://pnp/./packages/common/storage.ts","webpack://pnp/./packages/sp/items/list.ts","webpack://pnp/./packages/pnpjs/sp-ns.ts","webpack://pnp/./packages/pnpjs/graph-ns.ts","webpack://pnp/./packages/pnpjs/pnplibconfig.ts","webpack://pnp/./packages/sp-addinhelpers/sprequestexecutorclient.ts","webpack://pnp/./packages/sp-addinhelpers/sprestaddin.ts","webpack://pnp/./packages/pnpjs/index.ts","webpack://pnp/(webpack)/buildin/global.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","extendStatics","b","setPrototypeOf","__proto__","Array","__extends","__","this","constructor","__decorate","decorators","target","desc","arguments","length","getOwnPropertyDescriptor","Reflect","decorate","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","e","rejected","result","done","then","apply","__generator","body","f","y","g","_","label","sent","trys","ops","verb","iterator","v","op","TypeError","pop","push","__values","__read","ar","error","__spread","concat","tag","descriptor","undefined","originalMethod","configure","args","getClientTag","h","deleteFromCollection","has","methodName","delete","isTagged","data","options","headers","_batchId","_reqs","_deps","_rDeps","_index","sort","info1","info2","index","track","batchee","batch","batchIndex","add","context","info","id","requestId","method","toUpperCase","parser","url","addDependency","resolver","addResolveBatchDependency","execute","all","executeImpl","storeName","expiration","defaultCachingStore","Date","defaultCachingTimeoutSeconds","CachingOptions","storage","local","session","cacheOptions","parse","response","cacheData","store","put","addProp","path","configurable","_enableExtensions","globalExtensions","factoryExtensions","Map","ObjExtensionsSym","for","extendGlobal","extendCol","extendObj","extensions","set","extendFactory","proto","getPrototypeOf","a","clearGlobalExtensions","disableExtensions","enableExtensions","applyFactoryExtensions","extensionOrDefault","or","extension","rest","invoker","invokableFactory","defaultAction","as","assign","ags","ie11","Proxy","_thisArg","argArray","receiver","handleError","parseImpl","parseFloat","status","text","txt","replace","JSON","json","parseODataJSON","catch","ok","init","results","blob","arrayBuffer","buffer","message","statusText","isHttpRequestError","clone","HttpRequestError","Error","cloneQueryableData","source","stringify","parsed","batchDependency","cachingOptions","clientFactory","dataSeed","_data","cloneParentWasCaching","parentUrl","query","useCaching","toUrl","pathPart","configureFrom","usingCaching","globalCacheDisable","usingParser","withPipeline","pipeline","pipes","slice","append","inBatch","hasBatch","addBatchDependency","cloneTo","settings","includeBatch","includeQuery","cloneParentCacheOptions","size","forEach","k","setResult","hasResult","shift","pipe","write","getTime","promise","ctx","log","activeLogLevel","level","returnResult","isBatched","requestPipelineMethod","alwaysRun","propertyKey","logStart","caching","toLowerCase","hydrate","CachingParserWrapper","send","batchId","client","opts","fetch","logEnd","getDefaultPipeline","pipelineBinder","test","defaultPipelineBinder","previous","spInvokableFactory","baseUrl","lastIndexOf","_forceCaching","toUrlAndQuery","aliasedParams","match","labelName","char","indexOf","from","map","join","select","selects","encodeURIComponent","expand","expands","additionalPath","getParent","parent","SharePointQueryable","_SharePointQueryable","filter","orderBy","ascending","split","skip","toString","top","SharePointQueryableCollection","_SharePointQueryableCollection","_update","type","mapper","props","SharePointQueryableInstance","_SharePointQueryableInstance","deleteable","deleteableWithETag","eTag","registerCustomRequestClientFactory","requestClientFactory","operation","spGet","spPost","spDelete","spPatch","spPostDelete","spPostDeleteETag","graphInvokableFactory","setEndpoint","endpoint","ensure","GraphQueryable","_GraphQueryable","num","skipToken","token","GraphQueryableCollection","_GraphQueryableCollection","search","GraphQueryableSearchableCollection","_GraphQueryableSearchableCollection","GraphQueryableInstance","_GraphQueryableInstance","title","description","template","language","inheritPermissions","postBody","Description","Language","Title","Url","UseSamePermissionsAsParentSite","WebTemplate","Webs","web","Web","_Webs","getParentWeb","ParentWeb","Id","openWebById","getSubwebsFilteredForCurrentUser","nWebTemplateFilter","nConfigurationFilter","createBatch","update","properties","applyTheme","colorPaletteUrl","fontSchemeUrl","backgroundImageUrl","shareGenerated","applyWebTemplate","q","availableWebTemplates","includeCrossLanugage","getChanges","mapToIcon","filename","progId","getStorageEntity","setStorageEntity","comments","removeStorageEntity","_Web","defaultPath","graphClientBinder","graphGet","graphPost","graphDelete","graphPatch","graphPut","metadata","RenderListDataOptions","ControlMode","getById","List","getByTitle","enableContentTypes","additionalSettings","addSettings","list","addOrUpdateSettings","ContentTypesEnabled","created","ensureSiteAssetsLibrary","Lists","ensureSitePagesLibrary","_Lists","getItemsByCAMLQuery","getListItemChangesSinceToken","recycle","Recycle","renderListData","viewXml","RenderListData","renderListDataAsStream","parameters","overrideParams","RenderOptions","reduce","bodyOptions","overrideParameters","renderListFormData","itemId","formId","RenderListFormData","reserveListItemId","ReserveListItemId","getListItemEntityTypeFullName","ListItemEntityTypeFullName","addValidateUpdateItemUsingPath","formValues","decodedUrl","bNewDocumentUpdate","checkInComment","additionalProps","addProps","FolderPath","leafName","LeafName","objectType","UnderlyingObjectType","listItemCreateInfo","res","AddValidateUpdateItemUsingPath","getParentInfos","urlInfo","RootFolderServerRelativePath","RootFolder","ServerRelativePath","RootFolderServerRelativeUrl","ServerRelativeUrl","RootFolderUniqueId","UniqueId","_List","escapeQueryStrValue","Item","getItemByStringId","stringId","reverse","getPaged","PagedItemCollectionParser","getAll","requestSize","acceptHeader","items","Items","itemsCollector","gatherer","last","hasNext","getNext","listItemEntityTypeFullName","removeDependency","ensureListItemEntityTypeName","listItemEntityType","item","candidatelistItemEntityTypeFullName","_Items","ItemVersions","substr","poster","ItemUpdatedParser","deleteWithParams","getWopiFrameUrl","action","GetWOPIFrameUrl","validateUpdateListItem","ParentList","_Item","versionId","ItemVersion","_ItemVersions","_ItemVersion","nextUrl","_parent","__next","PagedItemCollection","LogLevel","Logger","instance","_instance","LoggerImpl","subscribe","listeners","listener","clearSubscribers","count","writeJSON","entry","err","subscribers","subscriber","msg","format","console","warn","extractWebUrl","candidateUrl","odataUrlFrom","candidate","parts","__metadata","uri","editLink","spODataEntity","SPODataEntityParserImpl","spODataEntityArray","SPODataEntityArrayParserImpl","_options","_baseUrl","SPRest","setup","config","pageContext","spfxContext","getRootWeb","rootWeb","getContextInfo","Site","GetContextWebInformation","SupportedSchemaVersions","site","siteId","getDocumentLibraries","absoluteWebUrl","GetDocumentLibraries","getWebUrlFromPageUrl","absolutePageUrl","GetWebUrlFromPageUrl","webId","createCommunicationSite","lcid","shareByEmailEnabled","classification","siteDesignId","hubSiteId","owner","createCommunicationSiteFromProps","Classification","HubSiteId","Lcid","Owner","ShareByEmailEnabled","SiteDesignId","WebTemplateExtensionId","exists","createModernTeamSite","displayName","alias","isPublic","owners","createModernTeamSiteFromProps","optionalParams","CreationOptions","Owners","_Site","emptyGuid","SPRuntimeConfig","spPart","absoluteUrl","fetchClientFactory","graph","GraphRest","getCtxCallback","params","dateAdd","date","interval","units","ret","setFullYear","getFullYear","setMonth","getMonth","setDate","getDate","setTime","combine","paths","stringIsNullOrEmpty","getRandomString","chars","charAt","Math","floor","random","getGUID","now","isFunc","objectDefinedNotNull","obj","isArray","array","noOverwrite","check","getOwnPropertyNames","isUrlAbsolute","sanitizeGuid","guid","matches","exec","jsS","hOP","getHashCode","hash","charCodeAt","toResourcePath","DecodedUrl","GraphRuntimeConfig","graphPart","_impl","_digestCache","webUrl","cachedDigest","digests","fetchRaw","cache","credentials","resp","newCachedDigest","FormDigestTimeoutSeconds","FormDigestValue","getDigestFactory","Headers","clientTag","digest","rawHeaders","retry","setRetry","delay","parseInt","attempts","retryCount","setTimeout","post","patch","toAbsoluteUrl","_spPageContextInfo","webAbsoluteUrl","webServerRelativeUrl","location","ParseResponse","responses","statusRegExp","RegExp","lines","state","line","trim","Response","requests","absoluteRequestUrl","batchBody","currentChangeSetId","reqInfo","castHeaders","batchOptions","fetchResponse","SPBatch","request","retryContext","RuntimeConfig","_v","RuntimeConfigImpl","objectEntries","entries","keys","objectToMap","mergeMaps","maps","safeGlobal","global","objectToSPKeyValueCollection","Key","Value","ValueType","GraphEndpoints","Beta","V1","regex","replaces","batchUrl","maxRequests","makeUrlRelative","formatRequests","requestFragment","parseResponse","graphResponse","code","parsedResponses","fill","responseId","nextLink","requestsChunk","splice","batchRequest","GraphBatch","queryUrl","j","parsedResponse","chain","_settings","addJSON","load","provider","getConfiguration","getJSON","wrappedProvider","cacheKey","cacheStore","selectPnPCache","getWrappedProvider","enabled","getOrPut","providedConfig","pnpCache","listTitle","keyFieldName","valueFieldName","lists","asCaching","PrincipalType","PrincipalSource","PageType","InvalidFileFolderNameCharsOnlineRegex","InvalidFileFolderNameCharsOnPremiseRegex","containsInvalidFileFolderChars","input","onPremise","stripInvalidFileFolderChars","replacer","msGraphClientFactory","getClient","_graphBaseUrl","getList","listRelativeUrl","getCatalog","CheckinType","MoveOperations","TemplateFileType","getByName","File","content","shouldOverWrite","Files","file","addUsingPath","Overwrite","AutoCheckoutOnInvalidData","XorHash","odata","addChunked","progress","chunkSize","setContentChunked","addTemplateFile","fileUrl","templateFileType","_Files","Versions","approve","comment","cancelUpload","uploadId","checkin","checkinType","Major","checkout","copyTo","copyByPath","destUrl","KeepBoth","srcUrl","webBaseUrl","hostUrl","destPath","ResetAuthorAndCreatedOnCopy","ShouldBypassSharedLocks","srcPath","deny","moveTo","moveOperations","moveByPath","publish","undoCheckout","unpublish","Exists","getText","getBlob","getBuffer","setContent","getItem","listItemAllFields","fileSize","totalBlocks","blockNumber","currentPointer","stage","startUpload","continueUpload","finishUpload","fragment","StartUpload","fileOffset","ContinueUpload","Version","deleteAll","deleteById","recycleByID","deleteByLabel","recycleByLabel","restoreByLabel","_Versions","getAppById","App","syncSolutionToTeams","useSharePointItemId","appId","listId","listItems","AppCatalog","adder","deploy","skipFeatureDeployment","do","retract","install","uninstall","upgrade","remove","getAppCatalog","getTenantAppCatalogWeb","CorporateCatalogUrl","Attachment","Attachments","addMultiple","files","deleteMultiple","recycleMultiple","_Attachments","getParsed","getNextOrder","collection","max","order","reindex","columns","controls","getFileByServerRelativeUrl","fileRelativeUrl","getFileByServerRelativePath","getFileById","uniqueId","getFileByUrl","PromotedState","Comments","Comment","clear","_Comments","Replies","like","unlike","_Replies","initFrom","ClientsidePage","getLikedBy","getLikedByInformation","noInit","sections","commentsDisabled","_bannerImageDirty","_bannerImageThumbnailUrlDirty","_pageSettings","controlType","pageSettingsSlice","isDefaultDescription","isDefaultThumbnail","_layoutPart","_ClientsidePage","getDefaultLayoutPart","fromJSON","dataVersion","instanceId","authorByline","authors","layoutType","showPublishDate","showTopicHeader","textAlignment","topicHeader","reservedHeight","serverProcessedContent","htmlStrings","searchablePlainTexts","imageSources","links","PageLayoutType","BannerImageUrl","setBannerImage","BannerThumbnailUrl","TopicHeader","htmlAttributes","findIndex","layoutIndex","AuthorByline","hasVerticalSection","addVerticalSection","addSection","section","sectionIndex","pageData","canvasControls","CanvasContent1","layouts","LayoutWebpartsContent","setControls","CommentsDisabled","save","serverRelativePath","bannerImageUrl","r1","r2","SiteId","WebId","imageSource","customMetadata","ListId","IsPageCheckedOutToCurrentUser","saveBody","getCanvasContent1","getLayoutWebpartsContent","bannerImageUrlValue","thumbnailUrl","updater","discardPageCheckout","promoteToNews","promoteNewsImpl","findControlById","findControl","predicate","copy","pageName","promotedState","CreateClientsidePage","pageLayout","page","getControls","URL","makeGuid","searchParams","guidSite","guidWeb","guidFile","openWeb","translateX","translateY","imageSourceType","altText","setBannerImageFromExternalUrl","FileName","pathname","setAuthorById","authorId","userLoginData","setAuthorByLoginName","LoginName","authorLoginName","role","upn","UserPrincipalName","initer","listData","itemData","mergeColumnToTree","part","mergePartToTree","position","textData","innerHTML","canvasData","column","displayMode","emphasis","getEmphasisObj","control","zoneEmphasis","VersionInfo","LastVersionCreatedBy","LastVersionCreated","positionData","sectionFactor","zoneIndex","getOrCreateSection","addColumn","addControl","ClientsidePageFromFile","pageInitData","newPage","_emphasis","_memId","_order","_layoutIndex","factor","defaultColumn","CanvasColumn","Default","_section","getControl","_column","onColumnChange","setData","ClientsideText","anchorComponentId","controlIndex","col","addedFromPersistedData","editorType","ClientsideWebpart","fromComponentDef","definition","import","webPartData","reservedWidth","setProperties","getProperties","component","componendId","preconfiguredEntries","Manifest","default","webPartId","getClientsideWebParts","addClientsidePage","layout","loadClientsidePage","Folder","Folders","folder","serverRelativeUrl","overwrite","_Folders","origin","addSubFolderUsingPath","leafPath","folders","ListItemAllFields","getShareable","shareable","getDefaultColumnValues","rootFolder","baseFilePath","xml","defVals","subMatches","st","sm","decodeURIComponent","setDefaultColumnValues","defaults","fieldDefs","tags","fieldDefault","fd","InternalName","fieldDef","TypeAsString","wssId","termName","termId","eventReceivers","eventReceiverCreationInformation","EventType","ReceiverAssembly","ReceiverClass","ReceiverName","SequenceNumber","Synchronization","folderProps","serRelPath","vti_x005f_listname","fieldDefaults","merge","docLib","folderPath","existingDefaults","filteredExistingDefaults","existing","find","ed","clearDefaultColumnValues","addAvailableContentType","contentTypeId","ContentTypes","contentType","ContentType","group","_ContentTypes","FieldLinks","FieldLink","_FieldLinks","force","Features","featdefScope","featureId","feature","Feature","_Features","deactivate","DefinitionId","FieldTypes","DateTimeFieldFormatType","DateTimeFieldFriendlyFormatType","AddFieldOptions","CalendarType","UrlFieldFormatType","FieldUserSelectionMode","ChoiceFieldFormatType","Field","getByInternalNameOrTitle","createFieldAsXml","SchemaXml","Fields","field","fieldType","addText","maxLength","FieldTypeKind","MaxLength","addCalculated","formula","dateFormat","outputType","Text","DateFormat","Formula","OutputType","addDateTime","displayFormat","calendarType","friendlyDisplayFormat","DateOnly","Gregorian","Unspecified","DateTimeCalendarType","DisplayFormat","FriendlyDisplayFormat","addNumber","minValue","maxValue","MinimumValue","MaximumValue","addCurrency","currencyLocalId","CurrencyLocaleId","addMultilineText","numberOfLines","richText","restrictedMode","appendOnly","allowHyperlink","AllowHyperlink","AppendOnly","NumberOfLines","RestrictedMode","RichText","addUrl","Hyperlink","addUser","selectionMode","SelectionMode","addLookup","lookupListId","lookupFieldName","LookupFieldName","LookupListId","addChoice","choices","fillIn","Dropdown","Choices","EditFormat","FillInChoice","addMultiChoice","addBoolean","addDependentLookupField","primaryLookupFieldId","showField","addLocation","_Fields","req","setShowInDisplayForm","show","setShowInEditForm","setShowInNewForm","getFolderByServerRelativeUrl","folderRelativeUrl","getFolderByServerRelativePath","getFolderById","Form","_Forms","Forms","HubSite","_HubSites","HubSites","getSite","SiteUrl","joinHubSite","registerHubSite","unRegisterHubSite","hubSiteData","forceRefresh","syncHubSiteTheme","NavigationNode","visible","IsVisible","NavigationNodes","node","moveAfter","nodeId","previousNodeId","_Navigation","Navigation","getMenuState","menuNodeKey","depth","mapProviderName","customProperties","NavigationService","getMenuNodeKey","currentUrl","UrlZone","clientPeoplePickerQuery","profileLoader","Profiles","amIFollowedBy","loginName","amIFollowing","getFollowedTags","maxCount","getFollowersFor","_Profiles","getPeopleFollowedBy","getPropertiesFor","getUserProfilePropertyFor","propertyName","hideSuggestion","isFollowing","follower","followee","setMyProfilePic","profilePicSource","reader","FileReader","onload","readAsArrayBuffer","setSingleValueProfileProperty","accountName","propertyValue","setMultiValuedProfileProperty","propertyValues","createPersonalSiteEnqueueBulk","emails","ownerUserProfile","userProfile","createPersonalSite","interactiveRequest","shareAllSocialData","share","clientPeoplePickerResolveUser","queryParams","clientPeoplePickerSearchUser","ProfileLoaderFactory","ProfileLoader","ClientPeoplePickerFactory","getBodyFrom","ClientPeoplePickerResolveUser","ClientPeoplePickerSearchUser","ClientPeoplePickerQuery","TimeZone","TimeZones","getInstalledLanguages","_RegionalSettings","RegionalSettings","utcToLocalTime","utcTime","dateIsoString","toISOString","UTCToLocalTime","localTimeToUTC","localTime","getTimezoneOffset","LocalTimeToUTC","_TimeZone","_TimeZones","getValueForUICultureBinder","propName","cultureName","titleResource","descriptionResource","UserCustomActionRegistrationType","UserCustomActionScope","UserCustomAction","UserCustomActions","_UserCustomActions","getRelatedItems","sourceListName","sourceItemId","RelatedItemManager","SourceItemID","SourceListName","getPageOneRelatedItems","addSingleLink","sourceWebUrl","targetListName","targetItemID","targetWebUrl","tryAddReverseLink","SourceWebUrl","TargetItemID","TargetListName","TargetWebUrl","TryAddReverseLink","addSingleLinkToUrl","targetItemUrl","TargetItemUrl","addSingleLinkFromUrl","sourceItemUrl","targetItemId","SourceItemUrl","deleteSingleLink","tryDeleteReverseLink","TryDeleteReverseLink","_RelatedItemManager","funcs","toPropCase","str","$1","SearchQueryBuilder","queryText","_query","Querytext","self","proxy","pk","mappedPk","propKey","SortDirection","ReorderingRuleMatchType","QueryPropertyValueType","queryRegex","queryInit","parseQuery","HitHighlightedProperties","fixArrProp","Properties","RefinementFilters","ReorderingRules","SelectProperties","SortList","prop","toSearchQuery","_Search","Search","rawResponse","_url","_raw","_primary","postquery","RawSearchResults","ElapsedTime","PrimaryQueryResult","RelevantResults","RowCount","TotalRows","TotalRowsIncludingDuplicates","formatSearchResults","Table","Rows","getPage","pageNumber","pageSize","rows","RowLimit","StartRow","rawResults","tempResults","tempResult","cells","Cells","cell","writable","mapQueryToQueryString","PeopleNames","s_1","suggest","s_2","PersonalResults","Queries","querytext","querySetter","checkProp","sp","_Suggest","Suggest","Documents","ItemsMatchingContentType","ItemsMatchingTag","ItemsRelatedToCurrentUser","ItemsWithSameKeywordAsThisItem","LocalPeopleResults","LocalReportsAndDataResults","LocalSharePointResults","LocalVideoResults","Pages","Pictures","Popular","RecentlyChangedItems","RecommendedItems","Wiki","searchWithCaching","searchSuggest","PermissionKind","SharingRole","SPSharedObjectType","SharingDomainRestrictionMode","SharingOperationStatusCode","SharingLinkKind","RoleType","SiteUser","getByEmail","email","getByLoginName","removeById","SiteUsers","removeByLoginName","_SiteUsers","user","SiteGroups","SiteGroup","groupName","_SiteGroups","retGroup","setUserAsOwner","userId","RoleAssignment","principalId","roleDefId","RoleAssignments","_RoleAssignments","RoleDefinition","getByType","roleTypeKind","basePermissions","BasePermissions","High","Low","Name","Order","_RoleDefinitions","RoleDefinitions","bpObj","getUserEffectivePermissions","GetUserEffectivePermissions","getCurrentUserEffectivePermissions","EffectiveBasePermissions","breakRoleInheritance","copyRoleAssignments","clearSubscopes","resetRoleInheritance","userHasPermissions","permission","perms","hasPermissions","currentUserHasPermissions","perm","FullMask","shareObject","bypass","sendShareObjectRequest","getRoleValue","includeAnonymousLinkInEmail","propagateAcl","useSimplifiedRoles","roleValue","loginNames","userStr","peoplePickerInput","emailData","emailBody","emailSubject","subject","sendEmail","getShareLink","kind","expString","createLink","linkKind","checkPermissions","recipients","getSharingInformation","getObjectSharingSettings","unshareObject","deleteLinkByKind","unshareLink","shareId","shareWith","requireSignin","login","roleFilter","Edit","Contributor","Reader","def","w","Guest","View","checkSharingPermissions","unshare","deleteSharingLinkByKind","shareEverything","dependency","shareObjectRaw","createSiteDesign","creationInfo","SiteDesignsCloneFactory","applySiteDesign","getSiteDesigns","getSiteDesignMetadata","updateSiteDesign","updateInfo","deleteSiteDesign","getSiteDesignRights","grantSiteDesignRights","principalNames","grantedRights","revokeSiteDesignRights","addSiteDesignTask","addSiteDesignTaskToCurrentWeb","getSiteDesignTask","task","getSiteDesignRun","getSiteDesignRunStatus","runId","SiteDesigns","getSiteDesignRuns","createDefaultAssociatedGroups","groupNameSeed","siteOwner","siteOwner2","SiteScriptActionOutcome","getSiteScripts","SiteScriptsCloneFactory","createSiteScript","getSiteScriptMetadata","deleteSiteScript","updateSiteScript","Content","getSiteScriptFromList","listUrl","getSiteScriptFromWeb","executeSiteScriptAction","actionDefinition","SiteScripts","getSiteScript","extractInfo","absoluteListUrl","ensureUser","logonName","getUserById","SocialActorType","SocialActorTypes","SocialFollowResult","SocialStatusCode","MySocial","getFollowedSitesUri","SocialCloneFactory","FollowedSitesUri","getFollowedDocumentsUri","FollowedDocumentsUri","follow","actorInfo","createSocialActorInfoRequestBody","isFollowed","stopFollowing","_Social","Social","followed","types","MySocialCloneFactory","Followed","followedCount","FollowedCount","followers","Followers","suggestions","Suggestions","_MySocial","excute","Body","From","Subject","To","CC","BCC","AdditionalHeaders","UtilitiesCloneFactory","getCurrentUserEmailAddresses","resolvePrincipal","scopes","sources","inputIsEmailOnly","addToUserInfoList","matchUserInfoList","searchPrincipals","createEmailBodyForInvitation","pageAddress","expandGroupsToPrincipals","inputs","createWikiPage","Utilities","subscriptionId","Subscription","notificationUrl","expirationDate","clientState","subscription","_Subscriptions","Subscriptions","expirationDateTime","TermGroups","TermSets","_TermStore","TermStore","TermGroup","_TermGroups","TermSet","_TermSets","Children","Relations","getTermById","Term","_Children","Relation","_Relations","ViewScope","personalView","Views","view","_Views","ViewFields","renderAsHtml","setViewXml","getSchemaXml","fieldTitleOrInternalName","move","removeAll","fieldInternalName","_ViewFields","getView","viewId","WebPartsPersonalizationScope","WebPartDefinitions","export","LimitedWebPartManagerCloneFactory","webPartXml","LimitedWebPartManager","WebPartDefinition","getByControlId","saveChanges","zoneId","close","open","getLimitedWebPartManager","scope","Shared","updateable","updateableWithETag","addable","Threads","_Conversation","Conversation","_Conversations","Conversations","Posts","reply","Thread","_Thread","_Threads","forward","Post","_Post","_Posts","Senders","remover","addFile","bytes","contentBytes","DirectoryObjectTypes","GroupType","getMemberObjects","securityEnabledOnly","DirectoryObject","getMemberGroups","checkMemberGroups","groupIds","_DirectoryObject","getByIds","ids","directoryObject","DirectoryObjects","_DirectoryObjects","addFavorite","Group","removeFavorite","resetUnseenCount","subscribeByMail","unsubscribeByMail","getCalendarView","start","end","_Group","mailNickname","groupType","additionalProperties","mailEnabled","Office365","securityEnabled","Security","groupTypes","_Groups","Groups","calendarView","Events","Calendar","_Calendars","Calendars","_Event","Event","event","_Events","People","_User","User","_Users","Users","_People","_Contact","Contact","givenName","surName","emailAddresses","businessPhones","contact","_Contacts","Contacts","ContactFolders","_ContactFolder","ContactFolder","parentFolderId","contactFolder","_ContactFolders","TrendingInsights","UsedInsights","SharedInsights","_Insights","Insights","Resource","TrendingInsight","_TrendingInsights","UsedInsight","_UsedInsights","SharedInsight","_SharedInsights","_Resource","invitedUserEmailAddress","inviteRedirectUrl","_Invitations","Invitations","Member","Members","_Members","Message","_Messages","Messages","MailFolder","_MailFolders","MailFolders","_MailboxSettings","MailboxSettings","sendMail","Root","DriveItems","getItemById","DriveItem","_Drive","Drive","_Drives","Drives","searcher","_Root","parentReference","getContent","responseType","_DriveItem","_DriveItems","Notebooks","Sections","_OneNote","OneNote","Notebook","notebook","_Notebooks","Section","_Sections","Photo","_Photo","Plans","Tasks","Buckets","_Planner","Planner","_PlanDetails","PlanDetails","_Plan","Plan","plan","_Plans","_TaskDetails","TaskDetails","_Task","Task","planId","assignments","bucketId","_Tasks","_Bucket","Bucket","orderHint","bucket","_Buckets","_Subscription","changeType","resource","Channels","archive","shouldSetSpoSiteReadOnlyForMembers","Team","unarchive","cloneTeam","partsToClone","visibility","_Team","_Teams","Teams","Tabs","Channel","channel","_Channels","_Tab","Tab","appUrl","tab","_Tabs","createTeam","team","mergeHeaders","Request","mergeOptions","getADALResource","u","protocol","hostname","_token","FetchClient","getToken","aadTokenProviderFactory","getTokenProvider","BearerTokenFetchClient","defaultTimeoutMinutes","enableCacheExpiration","cacheExpirationHandler","PnPClientStorageWrapper","MemoryStorage","persistable","expire","setItem","createPersistable","removeItem","deleteExpired","defaultTimeout","pnp","cacheExpirationIntervalMilliseconds","_store","_local","_session","localStorage","sessionStorage","convertToResponse","spResponse","responseHeaders","statusCode","SP","RequestExecutor","temp","addinWebUrl","substring","executor","requestOptions","success","binaryStringRequestBody","executeAsync","crossDomainSite","addInWebUrl","hostWebUrl","_cdImpl","crossDomainWeb","urlPart","util","Def","Function"],"mappings":"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","file":"pnp.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"pnp\"] = factory();\n\telse\n\t\troot[\"pnp\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 51);\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","export * from \"./collections\";\r\nexport * from \"./libconfig\";\r\nexport * from \"./net\";\r\nexport * from \"./spfxcontextinterface\";\r\nexport * from \"./storage\";\r\nexport * from \"./util\";\r\nexport * from \"./safe-global\";\r\n","import { ISharePointQueryable } from \"./sharepointqueryable\";\r\nimport { stringIsNullOrEmpty } from \"@pnp/common\";\r\nimport { headers } from \"@pnp/odata\";\r\n\r\n/**\r\n * Includes this method name in the X-ClientService-ClientTag used to record pnpjs usage\r\n * \r\n * @param name Method name, displayed in the \r\n */\r\nexport function tag(name: string) {\r\n    return function (target: any, key: string, descriptor: PropertyDescriptor) {\r\n\r\n        if (descriptor === undefined) {\r\n            descriptor = Object.getOwnPropertyDescriptor(target, key);\r\n        }\r\n        const originalMethod = descriptor.value;\r\n\r\n        descriptor.value = async function (this: ISharePointQueryable, ...args: any[]) {\r\n\r\n            this.configure(headers({ \"X-PnPjs-Tracking\": name }));\r\n            return originalMethod.apply(this, args);\r\n        };\r\n\r\n        return descriptor;\r\n    };\r\n}\r\ntag.getClientTag = (h: Headers, deleteFromCollection = true): string => {\r\n    if (h.has(\"X-PnPjs-Tracking\")) {\r\n        const methodName = h.get(\"X-PnPjs-Tracking\");\r\n        if (deleteFromCollection) {\r\n            h.delete(\"X-PnPjs-Tracking\");\r\n        }\r\n        if (!stringIsNullOrEmpty(methodName)) {\r\n            return methodName;\r\n        }\r\n    }\r\n    return \"\";\r\n};\r\ntag.configure = <T extends ISharePointQueryable>(o: T, name: string): T => {\r\n    return o.configure(headers({ \"X-PnPjs-Tracking\": name }));\r\n};\r\ntag.isTagged = <T extends ISharePointQueryable>(o: T): T => {\r\n    return o.data.options.headers && o.data.options.headers[\"X-PnPjs-Tracking\"];\r\n};\r\n","import { IFetchOptions, getGUID } from \"@pnp/common\";\r\nimport { IODataParser } from \"./parsers\";\r\nimport { IQueryable } from \"./queryable\";\r\nimport { IRequestContext } from \"./pipeline\";\r\n\r\nexport interface IODataBatchRequestInfo {\r\n    url: string;\r\n    method: string;\r\n    options: IFetchOptions;\r\n    parser: IODataParser<any>;\r\n    resolve: ((d: any) => void) | null;\r\n    reject: ((error: any) => void) | null;\r\n    id: string;\r\n    index: number;\r\n}\r\n\r\nexport abstract class Batch {\r\n\r\n    protected _deps: Promise<void>[];\r\n    protected _reqs: IODataBatchRequestInfo[];\r\n    protected _rDeps: Promise<void>[];\r\n    private _index: number;\r\n\r\n    constructor(private _batchId = getGUID()) {\r\n        this._reqs = [];\r\n        this._deps = [];\r\n        this._rDeps = [];\r\n        this._index = -1;\r\n    }\r\n\r\n    public get batchId(): string {\r\n        return this._batchId;\r\n    }\r\n\r\n    /**\r\n     * The requests contained in this batch\r\n     */\r\n    protected get requests(): IODataBatchRequestInfo[] {\r\n        // we sort these each time this is accessed\r\n        return this._reqs.sort((info1, info2) => info1.index - info2.index);\r\n    }\r\n\r\n    /**\r\n     * Not meant for use directly\r\n     * \r\n     * @param batchee The IQueryable for this batch to track in order\r\n     */\r\n    public track(batchee: IQueryable<any>): void {\r\n\r\n        batchee.data.batch = this;\r\n\r\n        // we need to track the order requests are added to the batch to ensure we always\r\n        // operate on them in order\r\n        if (typeof batchee.data.batchIndex === \"undefined\" || batchee.data.batchIndex < 0) {\r\n            batchee.data.batchIndex = ++this._index;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Adds the given request context to the batch for execution\r\n     * \r\n     * @param context Details of the request to batch\r\n     */\r\n    public add<T = any>(context: IRequestContext<T>): Promise<T> {\r\n\r\n        const info: IODataBatchRequestInfo = {\r\n            id: context.requestId,\r\n            index: context.batchIndex,\r\n            method: context.method.toUpperCase(),\r\n            options: context.options,\r\n            parser: context.parser,\r\n            reject: null,\r\n            resolve: null,\r\n            url: context.url,\r\n        };\r\n\r\n        // we create a new promise that will be resolved within the batch\r\n        const p = new Promise<T>((resolve, reject) => {\r\n            info.resolve = resolve;\r\n            info.reject = reject;\r\n        });\r\n\r\n        this._reqs.push(info);\r\n\r\n        return p;\r\n    }\r\n\r\n    /**\r\n     * Adds a dependency insuring that some set of actions will occur before a batch is processed.\r\n     * MUST be cleared using the returned resolve delegate to allow batches to run\r\n     */\r\n    public addDependency(): () => void {\r\n\r\n        let resolver: () => void = () => void (0);\r\n\r\n        this._deps.push(new Promise<void>((resolve) => {\r\n            resolver = resolve;\r\n        }));\r\n\r\n        return resolver;\r\n    }\r\n\r\n    /**\r\n     * The batch's execute method will not resolve util any promises added here resolve\r\n     * \r\n     * @param p The dependent promise\r\n     */\r\n    public addResolveBatchDependency(p: Promise<any>): void {\r\n        this._rDeps.push(p);\r\n    }\r\n\r\n    /**\r\n     * Execute the current batch and resolve the associated promises\r\n     *\r\n     * @returns A promise which will be resolved once all of the batch's child promises have resolved\r\n     */\r\n    public execute(): Promise<void> {\r\n\r\n        // we need to check the dependencies twice due to how different engines handle things.\r\n        // We can get a second set of promises added during the first set resolving\r\n        return Promise.all(this._deps)\r\n            .then(() => Promise.all(this._deps))\r\n            .then(() => this.executeImpl())\r\n            .then(() => Promise.all(this._rDeps))\r\n            .then(() => void (0));\r\n    }\r\n\r\n    protected abstract executeImpl(): Promise<void>;\r\n}\r\n","import { IODataParser } from \"./parsers\";\r\nimport { RuntimeConfig, dateAdd, IPnPClientStore, PnPClientStorage } from \"@pnp/common\";\r\n\r\nexport interface ICachingOptions {\r\n    expiration?: Date;\r\n    storeName?: \"session\" | \"local\";\r\n    key: string;\r\n}\r\n\r\nexport class CachingOptions implements ICachingOptions {\r\n\r\n    protected static storage = new PnPClientStorage();\r\n\r\n    constructor(\r\n        public key: string,\r\n        public storeName: \"session\" | \"local\" = RuntimeConfig.defaultCachingStore,\r\n        public expiration = dateAdd(new Date(), \"second\", RuntimeConfig.defaultCachingTimeoutSeconds)) { }\r\n\r\n    public get store(): IPnPClientStore {\r\n        if (this.storeName === \"local\") {\r\n            return CachingOptions.storage.local;\r\n        } else {\r\n            return CachingOptions.storage.session;\r\n        }\r\n    }\r\n}\r\n\r\nexport class CachingParserWrapper<T> implements IODataParser<T> {\r\n\r\n    constructor(public parser: IODataParser<T>, public cacheOptions: CachingOptions) { }\r\n\r\n    public parse(response: Response): Promise<T> {\r\n        return this.parser.parse(response).then(r => this.cacheData(r));\r\n    }\r\n\r\n    protected cacheData(data: any): any {\r\n        if (this.cacheOptions.store !== null) {\r\n            this.cacheOptions.store.put(this.cacheOptions.key, data, this.cacheOptions.expiration);\r\n        }\r\n        return data;\r\n    }\r\n}\r\n","/**\r\n * Adds a property to a target instance\r\n * \r\n * @param target The object to whose prototype we will add a property\r\n * @param name Property name\r\n * @param factory Factory method used to produce the property value\r\n * @param path Any additional path required to produce the value\r\n */\r\nexport function addProp<T, U>(target: { prototype: any }, name: string, factory: (arg: U, p?: string) => T, path?: string): void {\r\n\r\n    Reflect.defineProperty(target.prototype, name, {\r\n        configurable: true,\r\n        enumerable: true,\r\n        get: function (this: U): T {\r\n            return factory(this, path);\r\n        },\r\n    });\r\n}\r\n","import { isFunc, isArray, ITypedHash, getGUID } from \"@pnp/common\";\r\n\r\nexport type ValidProxyMethods = \"apply\" | \"get\" | \"has\" | \"set\";\r\n\r\nexport type ExtensionDelegateType<T extends object> = { (op: string, target: T, ...rest: any[]): void };\r\n\r\nexport type ExtensionType<T extends object = {}> = Pick<ProxyHandler<T>, ValidProxyMethods> | ExtensionDelegateType<T> | ITypedHash<any>;\r\n\r\nlet _enableExtensions = false;\r\nconst globalExtensions: ExtensionType[] = [];\r\nconst factoryExtensions: Map<string, ExtensionType[]> = new Map<string, ExtensionType[]>();\r\n\r\nconst ObjExtensionsSym = Symbol.for(\"43f7a601\");\r\n\r\n/**\r\n * Creates global extensions across all invokable objects\r\n * \r\n * @param e The global extensions to apply\r\n */\r\nexport const extendGlobal = (e: ExtensionType | ExtensionType[]) => {\r\n\r\n    _enableExtensions = true;\r\n    extendCol(globalExtensions, e);\r\n};\r\n\r\n/**\r\n * Applies the supplied extensions to a single instance\r\n * \r\n * @param target Object to which extensions are applied\r\n * @param extensions Extensions to apply\r\n */\r\nexport const extendObj = <T extends object>(target: T, extensions: ExtensionType | ExtensionType[]): T => {\r\n\r\n    _enableExtensions = true;\r\n\r\n    if (!Reflect.has(target, ObjExtensionsSym)) {\r\n        Reflect.set(target, ObjExtensionsSym, []);\r\n    }\r\n\r\n    extendCol(<ExtensionType[]>Reflect.get(target, ObjExtensionsSym), extensions);\r\n\r\n    return target;\r\n};\r\n\r\n/**\r\n * Allows applying extensions to all instances created from the supplied factory\r\n * \r\n * @param factory The Invokable Factory method to extend\r\n * @param extensions Extensions to apply\r\n */\r\nexport const extendFactory = <T extends (...args: any[]) => any>(factory: T, extensions: ExtensionType | ExtensionType[]): void => {\r\n\r\n    _enableExtensions = true;\r\n\r\n    // factoryExtensions\r\n    const proto = Reflect.getPrototypeOf(factory);\r\n\r\n    if (!Reflect.has(proto, ObjExtensionsSym)) {\r\n\r\n        Reflect.defineProperty(proto, ObjExtensionsSym, {\r\n            value: getGUID(),\r\n        });\r\n    }\r\n\r\n    const key = proto[ObjExtensionsSym];\r\n\r\n    if (!factoryExtensions.has(key)) {\r\n        factoryExtensions.set(key, []);\r\n    }\r\n\r\n    extendCol(factoryExtensions.get(key), extensions);\r\n};\r\n\r\nfunction extendCol(a: ExtensionType[], e: ExtensionType | ExtensionType[]) {\r\n    if (isArray(e)) {\r\n        // @ts-ignore\r\n        a.push(...e);\r\n    } else {\r\n        // @ts-ignore\r\n        a.push(e);\r\n    }\r\n}\r\n\r\n/**\r\n * Clears all global extensions\r\n */\r\nexport const clearGlobalExtensions = () => {\r\n    globalExtensions.length = 0;\r\n};\r\n\r\n/**\r\n * Disables all extensions\r\n */\r\nexport const disableExtensions = () => {\r\n    _enableExtensions = false;\r\n};\r\n\r\n/**\r\n * Enables all extensions\r\n */\r\nexport const enableExtensions = () => {\r\n    _enableExtensions = true;\r\n};\r\n\r\n/**\r\n * Applies a set of extension previously applied to a factory using extendFactory to an object created from that factory\r\n * \r\n * @param factory \r\n * @param args \r\n */\r\nexport const applyFactoryExtensions = <T extends object = {}>(factory: (args: any[]) => T, args: any[]): T => {\r\n\r\n    let o = factory(args);\r\n\r\n    const proto = Reflect.getPrototypeOf(factory);\r\n\r\n    if (Reflect.has(proto, ObjExtensionsSym)) {\r\n\r\n        const extensions = factoryExtensions.get(Reflect.get(proto, ObjExtensionsSym));\r\n\r\n        o = extendObj(o, extensions);\r\n    }\r\n\r\n    return o;\r\n};\r\n\r\nexport function extensionOrDefault(op: ValidProxyMethods, or: (...args: any[]) => any, target: any, ...rest: any[]): any {\r\n\r\n    if (_enableExtensions) {\r\n\r\n        const extensions: ExtensionType[] = [];\r\n\r\n        // we need to first invoke extensions tied to only this object\r\n        if (Reflect.has(target, ObjExtensionsSym)) {\r\n            extensions.push(...Reflect.get(target, ObjExtensionsSym));\r\n        }\r\n\r\n        // second we need to process any global extensions\r\n        extensions.push(...globalExtensions);\r\n\r\n        for (let i = 0; i < extensions.length; i++) {\r\n            const extension = extensions[i];\r\n\r\n            let result = undefined;\r\n\r\n            if (isFunc(extension)) {\r\n\r\n                // this extension is a function which we call\r\n                result = (<any>extension)(op, target, ...rest);\r\n\r\n            } else if (op === \"get\" && Reflect.has(extension, rest[0])) {\r\n\r\n                // this extension is a named extension meaning we are overriding a specific method/property\r\n                result = Reflect.get(extension, rest[0], target);\r\n\r\n            } else if (Reflect.has(extension, op)) {\r\n\r\n                // this extension is a ProxyHandler that has a handler defined for {op} so we pass control and see if we get a result\r\n                result = Reflect.get(extension, op)(target, ...rest);\r\n            }\r\n\r\n            if (typeof result !== \"undefined\") {\r\n                // if a extension returned a result, we return that\r\n                // this means that this extension overrides any other extensions and no more are executed\r\n                // first extension in the list to return \"wins\"\r\n                return result;\r\n            }\r\n        }\r\n    }\r\n\r\n    return or(target, ...rest);\r\n}\r\n","import { IQueryable } from \"./queryable\";\r\nimport { IRequestContext } from \"./pipeline\";\r\nimport { IFetchOptions, RuntimeConfig } from \"@pnp/common\";\r\nimport { extensionOrDefault, applyFactoryExtensions } from \"./invokable-extensions\";\r\n\r\nexport type IHybrid<R = any, T = any> = T & {\r\n    (this: T, ...args: any[]): Promise<R>;\r\n};\r\n\r\nexport type IInvoker<R> = (this: IQueryable<any>, ...args: any[]) => Promise<R>;\r\n\r\nconst invokableBinder = (invoker: IInvoker<IQueryable<any>>) => <R>(constructor: { new(...args: any[]): any }): (...args: any[]) => R => {\r\n\r\n    return (...args: any[]) => {\r\n\r\n        const factory = (as: any[]) => {\r\n            const r = Object.assign(function (...ags: any[]) { return invoker.apply(r, ags); }, new constructor(...as));\r\n            Reflect.setPrototypeOf(r, constructor.prototype);\r\n            return r;\r\n        };\r\n\r\n        if (RuntimeConfig.ie11) {\r\n\r\n            return factory(args);\r\n        } else {\r\n\r\n            return new Proxy<IHybrid<R>>(applyFactoryExtensions(factory, args), {\r\n                apply: (target: any, _thisArg: any, argArray?: any) => {\r\n                    return extensionOrDefault(\"apply\", (...a: any[]) => Reflect.apply(a[0], a[1], a[2]), target, _thisArg, argArray);\r\n                },\r\n                get: (target: any, p: PropertyKey, receiver: any) => {\r\n                    return extensionOrDefault(\"get\", (...a: any[]) => Reflect.get(a[0], a[1], a[2]), target, p, receiver);\r\n                },\r\n                has: (target: any, p: PropertyKey) => {\r\n                    return extensionOrDefault(\"has\", (...a: any[]) => Reflect.has(a[0], a[1]), target, p);\r\n                },\r\n                set: (target: any, p: PropertyKey, value: any, receiver: any) => {\r\n                    return extensionOrDefault(\"set\", (...a: any[]) => Reflect.set(a[0], a[1], a[2], a[3]), target, p, value, receiver);\r\n                },\r\n            });\r\n        }\r\n    };\r\n};\r\n\r\nexport const invokableFactory = invokableBinder(function <R = any>(this: IQueryable<R>, options?: IFetchOptions): Promise<R> {\r\n    return this.defaultAction(options);\r\n});\r\n\r\nexport interface IInvokable<R = any> {\r\n    <T = R>(options?: Partial<IRequestContext<T>>): Promise<T>;\r\n}\r\n","import { isFunc, hOP } from \"@pnp/common\";\r\n\r\nexport interface IODataParser<T> {\r\n    hydrate?: (d: any) => T;\r\n    parse(r: Response): Promise<T>;\r\n}\r\n\r\nexport class ODataParser<T = any> implements IODataParser<T> {\r\n\r\n    public parse(r: Response): Promise<T> {\r\n\r\n        return new Promise<T>((resolve, reject) => {\r\n\r\n            if (this.handleError(r, reject)) {\r\n\r\n                this.parseImpl(r, resolve, reject);\r\n            }\r\n        });\r\n    }\r\n\r\n    protected parseImpl(r: Response, resolve: (value?: T | PromiseLike<T>) => void, reject: (reason?: Error) => void): void {\r\n\r\n        if ((r.headers.has(\"Content-Length\") && parseFloat(r.headers.get(\"Content-Length\")!) === 0) || r.status === 204) {\r\n\r\n            resolve(<T>{});\r\n        } else {\r\n\r\n            // patch to handle cases of 200 response with no or whitespace only bodies (#487 & #545)\r\n            r.text()\r\n                .then(txt => txt.replace(/\\s/ig, \"\").length > 0 ? JSON.parse(txt) : {})\r\n                .then(json => resolve(this.parseODataJSON<T>(json)))\r\n                .catch(e => reject(e));\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Handles a response with ok === false by parsing the body and creating a ProcessHttpClientResponseException\r\n     * which is passed to the reject delegate. This method returns true if there is no error, otherwise false\r\n     *\r\n     * @param r Current response object\r\n     * @param reject reject delegate for the surrounding promise\r\n     */\r\n    protected handleError(r: Response, reject: (err?: Error) => void): boolean {\r\n\r\n        if (!r.ok) {\r\n            HttpRequestError.init(r).then(reject);\r\n        }\r\n\r\n        return r.ok;\r\n    }\r\n\r\n    /**\r\n     * Normalizes the json response by removing the various nested levels\r\n     *\r\n     * @param json json object to parse\r\n     */\r\n    protected parseODataJSON<U>(json: any): U {\r\n\r\n        let result = json;\r\n\r\n        if (hOP(json, \"d\")) {\r\n\r\n            if (hOP(json.d, \"results\")) {\r\n\r\n                result = json.d.results;\r\n            } else {\r\n\r\n                result = json.d;\r\n            }\r\n        } else if (hOP(json, \"value\")) {\r\n\r\n            result = json.value;\r\n        }\r\n\r\n        return result;\r\n    }\r\n}\r\n\r\nexport class TextParser extends ODataParser<string> {\r\n\r\n    protected parseImpl(r: Response, resolve: (value: any) => void): void {\r\n\r\n        r.text().then(resolve);\r\n    }\r\n}\r\n\r\nexport class BlobParser extends ODataParser<Blob> {\r\n\r\n    protected parseImpl(r: Response, resolve: (value: any) => void): void {\r\n        r.blob().then(resolve);\r\n    }\r\n}\r\n\r\nexport class JSONParser extends ODataParser<any> {\r\n\r\n    protected parseImpl(r: Response, resolve: (value: any) => void): void {\r\n\r\n        r.json().then(resolve);\r\n    }\r\n}\r\n\r\nexport class BufferParser extends ODataParser<ArrayBuffer> {\r\n\r\n    protected parseImpl(r: Response, resolve: (value: any) => void): void {\r\n\r\n        if (isFunc(r.arrayBuffer)) {\r\n\r\n            r.arrayBuffer().then(resolve);\r\n        } else {\r\n\r\n            (<any>r).buffer().then(resolve);\r\n        }\r\n    }\r\n}\r\n\r\nexport class LambdaParser<T = any> extends ODataParser<T> {\r\n\r\n    constructor(private parser: (r: Response) => Promise<T>) {\r\n        super();\r\n    }\r\n\r\n    protected parseImpl(r: Response, resolve: (value: any) => void): void {\r\n\r\n        this.parser(r).then(resolve);\r\n    }\r\n}\r\n\r\nexport class HttpRequestError extends Error {\r\n\r\n    public isHttpRequestError = true;\r\n\r\n    constructor(message: string, public response: Response, public status = response.status, public statusText = response.statusText) {\r\n        super(message);\r\n    }\r\n\r\n    public static async init(r: Response): Promise<HttpRequestError> {\r\n\r\n        const t = await r.clone().text();\r\n        return new HttpRequestError(`Error making HttpClient request in queryable [${r.status}] ${r.statusText} ::> ${t}`, r.clone());\r\n    }\r\n}\r\n","import {\r\n  combine,\r\n  RuntimeConfig,\r\n  IFetchOptions,\r\n  IConfigOptions,\r\n  mergeOptions,\r\n  objectDefinedNotNull,\r\n  IRequestClient,\r\n  assign,\r\n} from \"@pnp/common\";\r\nimport { ICachingOptions } from \"./caching\";\r\nimport { Batch } from \"./batch\";\r\nimport { PipelineMethod } from \"./pipeline\";\r\nimport { IODataParser, ODataParser } from \"./parsers\";\r\n\r\nexport function cloneQueryableData(source: Partial<IQueryableData>): Partial<IQueryableData> {\r\n  let body;\r\n  // this handles bodies that cannot be JSON encoded (Blob, etc)\r\n  // Note however, even bodies that can be serialized will not be cloned.\r\n  if (source.options && source.options.body) {\r\n    body = source.options.body;\r\n    source.options.body = \"-\";\r\n  }\r\n\r\n  const s = JSON.stringify(source, (key: string, value: any) => {\r\n\r\n    switch (key) {\r\n      case \"query\":\r\n        return JSON.stringify([...(<Map<string, string>>value)]);\r\n      case \"batch\":\r\n        return \"-\";\r\n      case \"batchDependency\":\r\n        return \"-\";\r\n      case \"cachingOptions\":\r\n        return \"-\";\r\n      case \"clientFactory\":\r\n        return \"-\";\r\n      case \"parser\":\r\n        return \"-\";\r\n      default:\r\n        return value;\r\n    }\r\n  }, 0);\r\n\r\n  const parsed = JSON.parse(s, (key: any, value: any) => {\r\n    switch (key) {\r\n      case \"query\":\r\n        return new Map(JSON.parse(value));\r\n      case \"batch\":\r\n        return source.batch;\r\n      case \"batchDependency\":\r\n        return source.batchDependency;\r\n      case \"cachingOptions\":\r\n        return source.cachingOptions;\r\n      case \"clientFactory\":\r\n        return source.clientFactory;\r\n      case \"parser\":\r\n        return source.parser;\r\n      default:\r\n        return value;\r\n    }\r\n  });\r\n\r\n  if (body) {\r\n    parsed.options.body = body;\r\n    source.options.body = body;\r\n  }\r\n\r\n  return parsed;\r\n}\r\n\r\nexport interface IQueryableData<DefaultActionType = any> {\r\n  batch: Batch | null;\r\n  batchIndex: number;\r\n  batchDependency: () => void | null;\r\n  cachingOptions: ICachingOptions | null;\r\n  cloneParentCacheOptions: ICachingOptions | null;\r\n  cloneParentWasCaching: boolean;\r\n  query: Map<string, string>;\r\n  options: IFetchOptions | null;\r\n  url: string;\r\n  parentUrl: string;\r\n  useCaching: boolean;\r\n  pipes?: PipelineMethod<DefaultActionType>[];\r\n  parser?: IODataParser<DefaultActionType>;\r\n  clientFactory?: () => IRequestClient;\r\n  method?: string;\r\n}\r\n\r\nexport interface IQueryable<DefaultActionType> {\r\n  data: Partial<IQueryableData<DefaultActionType>>;\r\n  query: Map<string, string>;\r\n  append(pathPart: string): void;\r\n  inBatch(batch: Batch): this;\r\n  addBatchDependency(): () => void;\r\n  toUrlAndQuery(): string;\r\n  toUrl(): string;\r\n  concat(pathPart: string): this;\r\n  configure(options: IConfigOptions): this;\r\n  configureFrom(o: IQueryable<DefaultActionType>): this;\r\n  usingCaching(options?: ICachingOptions): this;\r\n  usingParser(parser: IODataParser<any>): this;\r\n  withPipeline(pipeline: PipelineMethod<DefaultActionType>[]): this;\r\n  defaultAction(options?: IFetchOptions): Promise<DefaultActionType>;\r\n}\r\n\r\nexport abstract class Queryable<DefaultActionType = any> implements IQueryable<DefaultActionType> {\r\n\r\n  private _data: Partial<IQueryableData<DefaultActionType>>;\r\n\r\n  constructor(dataSeed: Partial<IQueryableData<DefaultActionType>> = {}) {\r\n\r\n    this._data = Object.assign({}, {\r\n      cloneParentWasCaching: false,\r\n      options: {},\r\n      parentUrl: \"\",\r\n      parser: new ODataParser<DefaultActionType>(),\r\n      query: new Map<string, string>(),\r\n      url: \"\",\r\n      useCaching: false,\r\n    }, cloneQueryableData(dataSeed));\r\n  }\r\n\r\n  public get data(): Partial<IQueryableData<DefaultActionType>> {\r\n    return this._data;\r\n  }\r\n\r\n  public set data(value: Partial<IQueryableData<DefaultActionType>>) {\r\n    this._data = Object.assign({}, this.data, cloneQueryableData(value));\r\n  }\r\n\r\n  /**\r\n   * Gets the full url with query information\r\n   *\r\n   */\r\n  public abstract toUrlAndQuery(): string;\r\n\r\n  /**\r\n   * The default action for this \r\n   */\r\n  public abstract defaultAction(options?: IFetchOptions): Promise<DefaultActionType>;\r\n\r\n  /**\r\n  * Gets the current url\r\n  *\r\n  */\r\n  public toUrl(): string {\r\n    return this.data.url;\r\n  }\r\n\r\n  /**\r\n   * Directly concatenates the supplied string to the current url, not normalizing \"/\" chars\r\n   *\r\n   * @param pathPart The string to concatenate to the url\r\n   */\r\n  public concat(pathPart: string): this {\r\n    this.data.url += pathPart;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Provides access to the query builder for this url\r\n   *\r\n   */\r\n  public get query(): Map<string, string> {\r\n    return this.data.query;\r\n  }\r\n\r\n  /**\r\n   * Sets custom options for current object and all derived objects accessible via chaining\r\n   * \r\n   * @param options custom options\r\n   */\r\n  public configure(options: IConfigOptions): this {\r\n    mergeOptions(this.data.options, options);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Configures this instance from the configure options of the supplied instance\r\n   * \r\n   * @param o Instance from which options should be taken\r\n   */\r\n  public configureFrom(o: IQueryable<any>): this {\r\n    mergeOptions(this.data.options, o.data.options);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Enables caching for this request\r\n   *\r\n   * @param options Defines the options used when caching this request\r\n   */\r\n  public usingCaching(options?: ICachingOptions): this {\r\n    if (!RuntimeConfig.globalCacheDisable) {\r\n      this.data.useCaching = true;\r\n      if (options !== undefined) {\r\n        this.data.cachingOptions = options;\r\n      }\r\n    }\r\n    return this;\r\n  }\r\n\r\n  public usingParser(parser: IODataParser<any>): this {\r\n    this.data.parser = parser;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Allows you to set a request specific processing pipeline\r\n   * \r\n   * @param pipeline The set of methods, in order, to execute a given request\r\n   */\r\n  public withPipeline(pipeline: PipelineMethod<DefaultActionType>[]): this {\r\n    this.data.pipes = pipeline.slice(0);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Appends the given string and normalizes \"/\" chars\r\n   *\r\n   * @param pathPart The string to append\r\n   */\r\n  public append(pathPart: string): void {\r\n    this.data.url = combine(this.data.url, pathPart);\r\n  }\r\n\r\n  /**\r\n   * Adds this query to the supplied batch\r\n   *\r\n   * @example\r\n   * ```\r\n   *\r\n   * let b = pnp.sp.createBatch();\r\n   * pnp.sp.web.inBatch(b).get().then(...);\r\n   * b.execute().then(...)\r\n   * ```\r\n   */\r\n  public inBatch(batch: Batch): this {\r\n\r\n    if (this.hasBatch) {\r\n      throw Error(\"This query is already part of a batch.\");\r\n    }\r\n\r\n    if (objectDefinedNotNull(batch)) {\r\n      batch.track(this);\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Blocks a batch call from occuring, MUST be cleared by calling the returned function\r\n  */\r\n  public addBatchDependency(): () => void {\r\n    if (objectDefinedNotNull(this.data.batch)) {\r\n      return this.data.batch.addDependency();\r\n    }\r\n\r\n    return () => null;\r\n  }\r\n\r\n  /**\r\n   * Indicates if the current query has a batch associated\r\n   *\r\n   */\r\n  protected get hasBatch(): boolean {\r\n    return objectDefinedNotNull(this.data.batch);\r\n  }\r\n\r\n  /**\r\n   * The batch currently associated with this query or null\r\n   *\r\n   */\r\n  protected get batch(): Batch | null {\r\n    return this.hasBatch ? this.data.batch : null;\r\n  }\r\n\r\n  /**\r\n   * Gets the parent url used when creating this instance\r\n   *\r\n   */\r\n  protected get parentUrl(): string {\r\n    return this.data.parentUrl;\r\n  }\r\n\r\n  /**\r\n   * Clones this instance's data to target\r\n   * \r\n   * @param target Instance to which data is written\r\n   * @param settings [Optional] Settings controlling how clone is applied\r\n   */\r\n  protected cloneTo<T extends IQueryable<any>>(target: T, settings: { includeBatch?: boolean, includeQuery?: boolean } = {}): T {\r\n\r\n    // default values for settings\r\n    settings = assign({\r\n      includeBatch: true,\r\n      includeQuery: false,\r\n    }, settings);\r\n\r\n    target.data = Object.assign({}, cloneQueryableData(this.data), <Partial<IQueryableData<DefaultActionType>>>{\r\n      batch: null,\r\n      cloneParentCacheOptions: null,\r\n      cloneParentWasCaching: false,\r\n    }, cloneQueryableData(target.data));\r\n\r\n    target.configureFrom(this);\r\n\r\n    if (settings.includeBatch) {\r\n      target.inBatch(this.batch);\r\n    }\r\n\r\n    if (settings.includeQuery && this.query.size > 0) {\r\n      this.query.forEach((v, k) => target.query.set(k, v));\r\n    }\r\n\r\n    if (this.data.useCaching) {\r\n      target.data.cloneParentWasCaching = true;\r\n      target.data.cloneParentCacheOptions = this.data.cachingOptions;\r\n    }\r\n\r\n    return target;\r\n  }\r\n}\r\n","import { IRequestClient, assign, isFunc, hOP } from \"@pnp/common\";\r\nimport { LogLevel, Logger } from \"@pnp/logging\";\r\nimport { CachingOptions, CachingParserWrapper } from \"./caching\";\r\nimport { IQueryableData } from \"./queryable\";\r\n\r\n/**\r\n * Defines the context for a given request to be processed in the pipeline\r\n */\r\nexport interface IRequestContext<ReturnType> extends IQueryableData<ReturnType> {\r\n    result?: ReturnType;\r\n    clientFactory: () => IRequestClient;\r\n    hasResult: boolean;\r\n    isBatched: boolean;\r\n    requestId: string;\r\n    method: string;\r\n}\r\n\r\nexport type PipelineMethod<ReturnType> = (c: IRequestContext<ReturnType>) => Promise<IRequestContext<ReturnType>>;\r\n\r\n/**\r\n * Resolves the context's result value\r\n *\r\n * @param context The current context\r\n */\r\nfunction returnResult<T = any>(context: IRequestContext<T>): Promise<T> {\r\n\r\n    Logger.log({\r\n        data: Logger.activeLogLevel === LogLevel.Verbose ? context.result : {},\r\n        level: LogLevel.Info,\r\n        message: `[${context.requestId}] (${(new Date()).getTime()}) Returning result from pipeline. Set logging to verbose to see data.`,\r\n    });\r\n\r\n    return Promise.resolve(context.result!);\r\n}\r\n\r\n/**\r\n * Sets the result on the context\r\n */\r\nexport function setResult<T = any>(context: IRequestContext<T>, value: any): Promise<IRequestContext<T>> {\r\n\r\n    return new Promise<IRequestContext<T>>((resolve) => {\r\n\r\n        context.result = value;\r\n        context.hasResult = true;\r\n        resolve(context);\r\n    });\r\n}\r\n\r\n/**\r\n * Invokes the next method in the provided context's pipeline\r\n *\r\n * @param c The current request context\r\n */\r\nfunction next<T = any>(c: IRequestContext<T>): Promise<IRequestContext<T>> {\r\n\r\n    return c.pipes.length > 0 ? c.pipes.shift()(c) : Promise.resolve(c);\r\n}\r\n\r\n/**\r\n * Executes the current request context's pipeline\r\n *\r\n * @param context Current context\r\n */\r\nexport function pipe<T = any>(context: IRequestContext<T>): Promise<T> {\r\n\r\n    if (context.pipes.length < 1) {\r\n        Logger.write(`[${context.requestId}] (${(new Date()).getTime()}) Request pipeline contains no methods!`, LogLevel.Error);\r\n        throw Error(\"Request pipeline contains no methods!\");\r\n    }\r\n\r\n    const promise = next(context).then(ctx => returnResult(ctx)).catch((e: Error) => {\r\n        Logger.error(e);\r\n        throw e;\r\n    });\r\n\r\n    if (context.isBatched) {\r\n        // this will block the batch's execute method from returning until the child requests have been resolved\r\n        context.batch.addResolveBatchDependency(promise);\r\n    }\r\n\r\n    return promise;\r\n}\r\n\r\n/**\r\n * decorator factory applied to methods in the pipeline to control behavior\r\n */\r\nexport function requestPipelineMethod(alwaysRun = false) {\r\n\r\n    return (target: any, propertyKey: string, descriptor: PropertyDescriptor) => {\r\n\r\n        const method = descriptor.value;\r\n\r\n        descriptor.value = function (...args: any[]) {\r\n\r\n            // if we have a result already in the pipeline, pass it along and don't call the tagged method\r\n            if (!alwaysRun && args.length > 0 && hOP(args[0], \"hasResult\") && args[0].hasResult) {\r\n                Logger.write(`[${args[0].requestId}] (${(new Date()).getTime()}) Skipping request pipeline method ${propertyKey}, existing result in pipeline.`, LogLevel.Verbose);\r\n                return Promise.resolve(args[0]);\r\n            }\r\n\r\n            // apply the tagged method\r\n            Logger.write(`[${args[0].requestId}] (${(new Date()).getTime()}) Calling request pipeline method ${propertyKey}.`, LogLevel.Verbose);\r\n\r\n            // then chain the next method in the context's pipeline - allows for dynamic pipeline\r\n            return method.apply(target, args).then((ctx: IRequestContext<any>) => next(ctx));\r\n        };\r\n    };\r\n}\r\n\r\n/**\r\n * Contains the methods used within the request pipeline\r\n */\r\nexport class PipelineMethods {\r\n\r\n    /**\r\n     * Logs the start of the request\r\n     */\r\n    @requestPipelineMethod(true)\r\n    public static logStart<T = any>(context: IRequestContext<T>): Promise<IRequestContext<T>> {\r\n        return new Promise<IRequestContext<T>>(resolve => {\r\n\r\n            Logger.log({\r\n                data: Logger.activeLogLevel === LogLevel.Info ? {} : context,\r\n                level: LogLevel.Info,\r\n                message: `[${context.requestId}] (${(new Date()).getTime()}) Beginning ${context.method} request (${context.url})`,\r\n            });\r\n\r\n            resolve(context);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Handles caching of the request\r\n     */\r\n    @requestPipelineMethod()\r\n    public static caching<T = any>(context: IRequestContext<T>): Promise<IRequestContext<T>> {\r\n\r\n        return new Promise<IRequestContext<T>>(resolve => {\r\n\r\n            // handle caching, if applicable\r\n            if (context.useCaching) {\r\n\r\n                Logger.write(`[${context.requestId}] (${(new Date()).getTime()}) Caching is enabled for request, checking cache...`, LogLevel.Info);\r\n\r\n                let cacheOptions = new CachingOptions(context.url.toLowerCase());\r\n                if (context.cachingOptions !== undefined) {\r\n                    cacheOptions = assign(cacheOptions, context.cachingOptions);\r\n                }\r\n\r\n                // we may not have a valid store\r\n                if (cacheOptions.store !== null) {\r\n\r\n                    // check if we have the data in cache and if so resolve the promise and return\r\n                    let data = cacheOptions.store.get(cacheOptions.key);\r\n\r\n                    if (data !== null) {\r\n\r\n                        Logger.log({\r\n                            data: Logger.activeLogLevel === LogLevel.Info ? {} : data,\r\n                            level: LogLevel.Info,\r\n                            message: `[${context.requestId}] (${(new Date()).getTime()}) Value returned from cache.`,\r\n                        });\r\n\r\n                        // ensure we clear any held batch dependency we are resolving from the cache\r\n                        if (isFunc(context.batchDependency)) {\r\n                            context.batchDependency();\r\n                        }\r\n                        // handle the case where a parser needs to take special actions with a cached result\r\n                        if (hOP(context.parser, \"hydrate\")) {\r\n                            data = context.parser.hydrate(data);\r\n                        }\r\n                        return setResult(context, data).then(ctx => resolve(ctx));\r\n                    }\r\n                }\r\n\r\n                Logger.write(`[${context.requestId}] (${(new Date()).getTime()}) Value not found in cache.`, LogLevel.Info);\r\n\r\n                // if we don't then wrap the supplied parser in the caching parser wrapper\r\n                // and send things on their way\r\n                context.parser = new CachingParserWrapper(context.parser, cacheOptions);\r\n            }\r\n\r\n            return resolve(context);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Sends the request\r\n     */\r\n    @requestPipelineMethod()\r\n    public static send<T = any>(context: IRequestContext<T>): Promise<IRequestContext<T>> {\r\n\r\n        return new Promise<IRequestContext<T>>((resolve, reject) => {\r\n            // send or batch the request\r\n            if (context.isBatched) {\r\n\r\n                const p = context.batch.add(context);\r\n\r\n                // we release the dependency here to ensure the batch does not execute until the request is added to the batch\r\n                if (isFunc(context.batchDependency)) {\r\n                    context.batchDependency();\r\n                }\r\n\r\n                Logger.write(`[${context.requestId}] (${(new Date()).getTime()}) Batching request in batch ${context.batch.batchId}.`, LogLevel.Info);\r\n\r\n                // we set the result as the promise which will be resolved by the batch's execution\r\n                resolve(setResult(context, p));\r\n\r\n            } else {\r\n\r\n                Logger.write(`[${context.requestId}] (${(new Date()).getTime()}) Sending request.`, LogLevel.Info);\r\n\r\n                // we are not part of a batch, so proceed as normal\r\n                const client = context.clientFactory();\r\n                const opts = assign(context.options || {}, { method: context.method });\r\n                client.fetch(context.url, opts)\r\n                    .then(response => context.parser.parse(response))\r\n                    .then(result => setResult(context, result))\r\n                    .then(ctx => resolve(ctx))\r\n                    .catch(e => reject(e));\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Logs the end of the request\r\n     */\r\n    @requestPipelineMethod(true)\r\n    public static logEnd<T = any>(context: IRequestContext<T>): Promise<IRequestContext<T>> {\r\n\r\n        return new Promise<IRequestContext<T>>(resolve => {\r\n\r\n            if (context.isBatched) {\r\n\r\n                Logger.log({\r\n                    data: Logger.activeLogLevel === LogLevel.Info ? {} : context,\r\n                    level: LogLevel.Info,\r\n                    message: `[${context.requestId}] (${(new Date()).getTime()}) ${context.method} request will complete in batch ${context.batch.batchId}.`,\r\n                });\r\n\r\n            } else {\r\n\r\n                Logger.log({\r\n                    data: Logger.activeLogLevel === LogLevel.Info ? {} : context,\r\n                    level: LogLevel.Info,\r\n                    message: `[${context.requestId}] (${(new Date()).getTime()}) Completing ${context.method} request.`,\r\n                });\r\n            }\r\n\r\n            resolve(context);\r\n        });\r\n    }\r\n}\r\n\r\nexport function getDefaultPipeline() {\r\n    return [\r\n        PipelineMethods.logStart,\r\n        PipelineMethods.caching,\r\n        PipelineMethods.send,\r\n        PipelineMethods.logEnd,\r\n    ].slice(0);\r\n}\r\n","import { IODataParser, ODataParser } from \"./parsers\";\r\nimport { IFetchOptions, IRequestClient, getGUID, objectDefinedNotNull } from \"@pnp/common\";\r\nimport { IQueryableData, cloneQueryableData } from \"./queryable\";\r\nimport { PipelineMethod, pipe, getDefaultPipeline } from \"./pipeline\";\r\n\r\nexport interface IRequestOptions<T> extends IFetchOptions {\r\n    parser: IODataParser<T>;\r\n}\r\n\r\nexport interface IClientFactoryBinder {\r\n    (clientFactory: () => IRequestClient): IMethodBinder;\r\n}\r\n\r\nexport interface IPipelineBinder {\r\n    (pipeline: PipelineMethod<any>[]): IClientFactoryBinder;\r\n}\r\n\r\nexport interface IMethodBinder {\r\n    (method: string): IOperation;\r\n}\r\n\r\nexport interface IOperation {\r\n    <ReturnType>(o: Partial<IQueryableData<ReturnType>>): Promise<ReturnType>;\r\n}\r\n\r\n// first we bind the pipeline we will use for all requests within this closure\r\nexport function pipelineBinder(pipes: PipelineMethod<any>[]): IClientFactoryBinder {\r\n\r\n    // then we bind the client factory we'll use (typically done in an implementing library such as sp)\r\n    return function (clientFactory: () => IRequestClient): IMethodBinder {\r\n\r\n        // then we create a binder we can apply for each type of method (GET, POST, etc.)\r\n        return function (method: string): IOperation {\r\n\r\n            // finally we get a function back to which we can pass an IQueryableData instance and execute the request it defines\r\n            return function <ReturnType = any>(o: Partial<IQueryableData<ReturnType>>): Promise<ReturnType> {\r\n\r\n                // send the IQueryableData down the pipeline\r\n                return pipe(Object.assign({}, {\r\n                    batch: null,\r\n                    batchDependency: null,\r\n                    batchIndex: -1,\r\n                    cachingOptions: null,\r\n                    clientFactory,\r\n                    cloneParentCacheOptions: null,\r\n                    cloneParentWasCaching: false,\r\n                    hasResult: false,\r\n                    isBatched: objectDefinedNotNull(o.batch),\r\n                    method,\r\n                    options: null,\r\n                    parentUrl: \"\",\r\n                    parser: new ODataParser<ReturnType>(),\r\n                    pipes: pipes.slice(0),\r\n                    query: new Map<string, string>(),\r\n                    requestId: getGUID(),\r\n                    url: \"\",\r\n                    useCaching: /^get$/i.test(o.method) && o.useCaching,\r\n                }, cloneQueryableData(o)));\r\n            };\r\n        };\r\n    };\r\n}\r\n\r\nexport const defaultPipelineBinder: IClientFactoryBinder = pipelineBinder(getDefaultPipeline());\r\n","import { jsS, ITypedHash } from \"@pnp/common\";\r\n\r\nexport function body<T = unknown, U = any>(o: U, previous?: T): T & { body: string } {\r\n    return Object.assign({ body: jsS(o) }, previous);\r\n}\r\n\r\nexport function headers<T = unknown, U extends ITypedHash<string> = {}>(o: U, previous?: T): T & { headers: U } {\r\n    return Object.assign({ headers: o }, previous);\r\n}\r\n","import { combine, isUrlAbsolute, assign, jsS, IFetchOptions } from \"@pnp/common\";\r\nimport { Queryable, invokableFactory, IInvokable } from \"@pnp/odata\";\r\nimport { Logger, LogLevel } from \"@pnp/logging\";\r\nimport { SPBatch } from \"./batch\";\r\nimport { metadata } from \"./utils/metadata\";\r\nimport { spGet, spPost, spPostDelete, spPostDeleteETag } from \"./operations\";\r\nimport { tag } from \"./telemetry\";\r\n\r\nexport interface ISharePointQueryableConstructor<T extends ISharePointQueryable = ISharePointQueryable> {\r\n    new(baseUrl: string | ISharePointQueryable, path?: string): T;\r\n}\r\n\r\nexport type ISPInvokableFactory<R = any> = (baseUrl: string | ISharePointQueryable, path?: string) => R;\r\n\r\nexport const spInvokableFactory = <R>(f: any): ISPInvokableFactory<R> => {\r\n    return invokableFactory<R>(f);\r\n};\r\n\r\n/**\r\n * SharePointQueryable Base Class\r\n *\r\n */\r\nexport class _SharePointQueryable<GetType = any> extends Queryable<GetType> {\r\n\r\n    protected _forceCaching: boolean;\r\n\r\n    /**\r\n     * Creates a new instance of the SharePointQueryable class\r\n     *\r\n     * @constructor\r\n     * @param baseUrl A string or SharePointQueryable that should form the base part of the url\r\n     *\r\n     */\r\n    constructor(baseUrl: string | ISharePointQueryable, path?: string) {\r\n\r\n        let url = \"\";\r\n        let parentUrl = \"\";\r\n        const query = new Map<string, string>();\r\n\r\n        if (typeof baseUrl === \"string\") {\r\n            // we need to do some extra parsing to get the parent url correct if we are\r\n            // being created from just a string.\r\n\r\n            if (isUrlAbsolute(baseUrl) || baseUrl.lastIndexOf(\"/\") < 0) {\r\n                parentUrl = baseUrl;\r\n                url = combine(baseUrl, path);\r\n            } else if (baseUrl.lastIndexOf(\"/\") > baseUrl.lastIndexOf(\"(\")) {\r\n                // .../items(19)/fields\r\n                const index = baseUrl.lastIndexOf(\"/\");\r\n                parentUrl = baseUrl.slice(0, index);\r\n                path = combine(baseUrl.slice(index), path);\r\n                url = combine(parentUrl, path);\r\n            } else {\r\n                // .../items(19)\r\n                const index = baseUrl.lastIndexOf(\"(\");\r\n                parentUrl = baseUrl.slice(0, index);\r\n                url = combine(baseUrl, path);\r\n            }\r\n        } else {\r\n\r\n            parentUrl = baseUrl.toUrl();\r\n            url = combine(parentUrl, path || \"\");\r\n            const target = baseUrl.query.get(\"@target\");\r\n            if (target !== undefined) {\r\n                query.set(\"@target\", target);\r\n            }\r\n        }\r\n\r\n        // init base with correct values for data seed\r\n        super({\r\n            parentUrl,\r\n            query,\r\n            url,\r\n        });\r\n\r\n        // post init actions\r\n        if (typeof baseUrl !== \"string\") {\r\n            this.configureFrom(baseUrl);\r\n        }\r\n        this._forceCaching = false;\r\n    }\r\n\r\n    /**\r\n     * Gets the full url with query information\r\n     */\r\n    public toUrlAndQuery(): string {\r\n\r\n        const aliasedParams = new Map<string, string>(this.query);\r\n\r\n        let url = this.toUrl().replace(/'!(@.*?)::(.*?)'/ig, (match, labelName, value) => {\r\n            Logger.write(`Rewriting aliased parameter from match ${match} to label: ${labelName} value: ${value}`, LogLevel.Verbose);\r\n            aliasedParams.set(labelName, `'${value}'`);\r\n            return labelName;\r\n        });\r\n\r\n        if (aliasedParams.size > 0) {\r\n            const char = url.indexOf(\"?\") > -1 ? \"&\" : \"?\";\r\n            url += `${char}${Array.from(aliasedParams).map((v: [string, string]) => v[0] + \"=\" + v[1]).join(\"&\")}`;\r\n        }\r\n\r\n        return url;\r\n    }\r\n\r\n    /**\r\n     * Choose which fields to return\r\n     *\r\n     * @param selects One or more fields to return\r\n     */\r\n    public select(...selects: string[]): this {\r\n        if (selects.length > 0) {\r\n            this.query.set(\"$select\", selects.map(encodeURIComponent).join(\",\"));\r\n        }\r\n        return this;\r\n    }\r\n\r\n    public get<T = GetType>(options?: IFetchOptions): Promise<T> {\r\n        return spGet<T>(<any>this, options);\r\n    }\r\n\r\n    /**\r\n     * Expands fields such as lookups to get additional data\r\n     *\r\n     * @param expands The Fields for which to expand the values\r\n     */\r\n    public expand(...expands: string[]): this {\r\n        if (expands.length > 0) {\r\n            this.query.set(\"$expand\", expands.map(encodeURIComponent).join(\",\"));\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Clones this SharePointQueryable into a new SharePointQueryable instance of T\r\n     * @param factory Constructor used to create the new instance\r\n     * @param additionalPath Any additional path to include in the clone\r\n     * @param includeBatch If true this instance's batch will be added to the cloned instance\r\n     * @param includeQuery If true all of the query values will be copied to the cloned instance\r\n     */\r\n    public clone<T extends ISharePointQueryable>(factory: (...args: any[]) => T, additionalPath?: string, includeBatch = true, includeQuery = false): T {\r\n\r\n        const clone: T = super.cloneTo(factory(this, additionalPath), { includeBatch, includeQuery });\r\n\r\n        // handle sp specific clone actions\r\n        if (!includeQuery) {\r\n            // we would have already copied this over if we got the entire query\r\n            const t = \"@target\";\r\n            if (this.query.has(t)) {\r\n                clone.query.set(t, this.query.get(t));\r\n            }\r\n        }\r\n\r\n        return clone;\r\n    }\r\n\r\n    /**\r\n     * The default action for this object (unless overridden spGet)\r\n     * \r\n     * @param options optional request options\r\n     */\r\n    public defaultAction(options?: IFetchOptions): Promise<GetType> {\r\n        return spGet(this, options);\r\n    }\r\n\r\n    /**\r\n     * Gets a parent for this instance as specified\r\n     *\r\n     * @param factory The contructor for the class to create\r\n     */\r\n    protected getParent<T extends ISharePointQueryable>(\r\n        factory: ISPInvokableFactory<any>,\r\n        baseUrl: string | ISharePointQueryable = this.parentUrl,\r\n        path?: string,\r\n        batch?: SPBatch): T {\r\n\r\n        let parent = factory(baseUrl, path).configureFrom(this);\r\n\r\n        const t = \"@target\";\r\n        if (this.query.has(t)) {\r\n            parent.query.set(t, this.query.get(t));\r\n        }\r\n        if (batch !== undefined) {\r\n            parent = parent.inBatch(batch);\r\n        }\r\n        return parent;\r\n    }\r\n}\r\nexport interface ISharePointQueryable<GetType = any> extends _SharePointQueryable<GetType>, IInvokable<GetType> { }\r\nexport interface _SharePointQueryable<GetType = any> extends IInvokable<GetType> { }\r\nexport const SharePointQueryable = spInvokableFactory<ISharePointQueryable>(_SharePointQueryable);\r\n\r\n/**\r\n * Represents a REST collection which can be filtered, paged, and selected\r\n *\r\n */\r\nexport class _SharePointQueryableCollection<GetType = any[]> extends _SharePointQueryable<GetType> {\r\n\r\n    /**\r\n     * Filters the returned collection (https://msdn.microsoft.com/en-us/library/office/fp142385.aspx#bk_supported)\r\n     *\r\n     * @param filter The string representing the filter query\r\n     */\r\n    public filter(filter: string): this {\r\n        this.query.set(\"$filter\", encodeURIComponent(filter));\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Orders based on the supplied fields\r\n     *\r\n     * @param orderby The name of the field on which to sort\r\n     * @param ascending If false DESC is appended, otherwise ASC (default)\r\n     */\r\n    public orderBy(orderBy: string, ascending = true): this {\r\n        const o = \"$orderby\";\r\n        const query = this.query.has(o) ? this.query.get(o).split(\",\") : [];\r\n        query.push(`${encodeURIComponent(orderBy)} ${ascending ? \"asc\" : \"desc\"}`);\r\n        this.query.set(o, query.join(\",\"));\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Skips the specified number of items\r\n     *\r\n     * @param skip The number of items to skip\r\n     */\r\n    public skip(skip: number): this {\r\n        this.query.set(\"$skip\", skip.toString());\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Limits the query to only return the specified number of items\r\n     *\r\n     * @param top The query row limit\r\n     */\r\n    public top(top: number): this {\r\n        this.query.set(\"$top\", top.toString());\r\n        return this;\r\n    }\r\n}\r\nexport interface _SharePointQueryableCollection<GetType = any[]> extends IInvokable<GetType> { }\r\nexport interface ISharePointQueryableCollection<GetType = any[]> extends _SharePointQueryableCollection<GetType>, IInvokable<GetType> { }\r\nexport const SharePointQueryableCollection = spInvokableFactory<ISharePointQueryableCollection>(_SharePointQueryableCollection);\r\n\r\n/**\r\n * Represents an instance that can be selected\r\n *\r\n */\r\nexport class _SharePointQueryableInstance<GetType = any> extends _SharePointQueryable<GetType> {\r\n\r\n    /**\r\n     * Curries the update function into the common pieces\r\n     * \r\n     * @param type \r\n     * @param mapper \r\n     */\r\n    protected _update<Return, Props = any>(type: string, mapper: (data: any, props: Props) => Return): (props: Props) => Promise<Return> {\r\n        return (props: any) => spPost(tag.configure(this, `${type}.Update`), {\r\n            body: jsS(assign(metadata(type), props)),\r\n            headers: {\r\n                \"X-HTTP-Method\": \"MERGE\",\r\n            },\r\n        }).then((d: any) => mapper(d, props));\r\n    }\r\n}\r\nexport interface ISharePointQueryableInstance<GetType = any> extends _SharePointQueryableInstance<GetType>, IInvokable<GetType> { }\r\nexport interface _SharePointQueryableInstance<GetType = any> extends IInvokable<GetType> { }\r\nexport const SharePointQueryableInstance = spInvokableFactory<ISharePointQueryableInstance>(_SharePointQueryableInstance);\r\n\r\n/**\r\n * Adds the a delete method to the tagged class taking no parameters and calling spPostDelete\r\n */\r\nexport function deleteable(t: string) {\r\n\r\n    return function (this: ISharePointQueryable): Promise<void> {\r\n        return spPostDelete<void>(tag.configure(this, `${t}.delete`));\r\n    };\r\n}\r\n\r\nexport interface IDeleteable {\r\n    /**\r\n     * Delete this instance\r\n     */\r\n    delete(): Promise<void>;\r\n}\r\n\r\nexport function deleteableWithETag(t: string) {\r\n\r\n    return function (this: ISharePointQueryable, eTag = \"*\"): Promise<void> {\r\n        return spPostDeleteETag<void>(tag.configure(this, `${t}.delete`), {}, eTag);\r\n    };\r\n}\r\n\r\nexport interface IDeleteableWithETag {\r\n    /**\r\n     * Delete this instance\r\n     *\r\n     * @param eTag Value used in the IF-Match header, by default \"*\"\r\n     */\r\n    delete(eTag?: string): Promise<void>;\r\n}\r\n","import { defaultPipelineBinder, IOperation, cloneQueryableData, headers } from \"@pnp/odata\";\r\nimport { SPHttpClient } from \"./sphttpclient\";\r\nimport { ISharePointQueryable } from \"./sharepointqueryable\";\r\nimport { IFetchOptions, mergeOptions, objectDefinedNotNull, IRequestClient, isFunc } from \"@pnp/common\";\r\nimport { toAbsoluteUrl } from \"./utils/toabsoluteurl\";\r\n\r\nexport function registerCustomRequestClientFactory(requestClientFactory: () => IRequestClient) {\r\n    factory = isFunc(requestClientFactory) ? requestClientFactory : () => new SPHttpClient();\r\n}\r\n\r\nlet factory: () => IRequestClient = () => new SPHttpClient();\r\n\r\nconst send = (method: \"GET\" | \"POST\" | \"DELETE\" | \"PATCH\" | \"PUT\"): <T = any>(o: ISharePointQueryable, options?: IFetchOptions) => Promise<T> => {\r\n\r\n    const operation: IOperation = defaultPipelineBinder(factory)(method);\r\n\r\n    return async function <T = any>(o: ISharePointQueryable, options?: IFetchOptions): Promise<T> {\r\n\r\n        const data = cloneQueryableData(o.data);\r\n        const batchDependency = objectDefinedNotNull(data.batch) ? data.batch.addDependency() : () => { return; };\r\n        const url = await toAbsoluteUrl(o.toUrlAndQuery());\r\n\r\n        mergeOptions(data.options, options);\r\n\r\n        return operation(Object.assign({}, data, {\r\n            batchDependency,\r\n            url,\r\n        }));\r\n    };\r\n};\r\n\r\nexport const spGet = <T = any>(o: ISharePointQueryable<any>, options?: IFetchOptions): Promise<T> => {\r\n    // Fix for #304 - when we clone objects we in some cases then execute a get request\r\n    // in these cases the caching settings were getting dropped from the request\r\n    // this tracks if the object from which this was cloned was caching and applies that to an immediate get request\r\n    // does not affect objects cloned from this as we are using different fields to track the settings so it won't\r\n    // be triggered\r\n    if (o.data.cloneParentWasCaching) {\r\n        o.usingCaching(o.data.cloneParentCacheOptions);\r\n    }\r\n\r\n    // if we are forcing caching set that in the data here\r\n    if ((<any>o)._forceCaching) {\r\n        o.data.useCaching = true;\r\n    }\r\n\r\n    return send(\"GET\")(o, options);\r\n};\r\n\r\nexport const spPost = <T = any>(o: ISharePointQueryable<any>, options?: IFetchOptions): Promise<T> => send(\"POST\")(o, options);\r\n\r\nexport const spDelete = <T = any>(o: ISharePointQueryable<any>, options?: IFetchOptions): Promise<T> => send(\"DELETE\")(o, options);\r\n\r\nexport const spPatch = <T = any>(o: ISharePointQueryable<any>, options?: IFetchOptions): Promise<T> => send(\"PATCH\")(o, options);\r\n\r\nexport const spPostDelete = <T = any>(o: ISharePointQueryable<any>, options?: IFetchOptions): Promise<T> => {\r\n    const opts = Object.assign(headers({ \"X-HTTP-Method\": \"DELETE\" }), options);\r\n    return spPost<T>(o, opts);\r\n};\r\n\r\nexport const spPostDeleteETag = <T = any>(o: ISharePointQueryable<any>, options?: IFetchOptions, eTag = \"*\"): Promise<T> => {\r\n    const opts = Object.assign(headers({ \"X-HTTP-Method\": \"DELETE\", \"IF-Match\": eTag }), options);\r\n    return spPost<T>(o, opts);\r\n};\r\n","import { combine, IFetchOptions } from \"@pnp/common\";\r\nimport { Queryable, invokableFactory, IInvokable } from \"@pnp/odata\";\r\nimport { GraphEndpoints } from \"./types\";\r\nimport { graphGet } from \"./operations\";\r\n\r\nexport interface IGraphQueryableConstructor<T> {\r\n    new(baseUrl: string | IGraphQueryable, path?: string): T;\r\n}\r\n\r\nexport const graphInvokableFactory = <R>(f: any): (baseUrl: string | IGraphQueryable, path?: string) => R => {\r\n    return invokableFactory<R>(f);\r\n};\r\n\r\n/**\r\n * Queryable Base Class\r\n *\r\n */\r\nexport class _GraphQueryable<GetType = any> extends Queryable<GetType> implements IGraphQueryable<GetType> {\r\n\r\n    /**\r\n     * Creates a new instance of the Queryable class\r\n     *\r\n     * @constructor\r\n     * @param baseUrl A string or Queryable that should form the base part of the url\r\n     *\r\n     */\r\n    constructor(baseUrl: string | IGraphQueryable, path?: string) {\r\n\r\n        let url = \"\";\r\n        let parentUrl = \"\";\r\n        const query = new Map<string, string>();\r\n\r\n        if (typeof baseUrl === \"string\") {\r\n            parentUrl = baseUrl;\r\n            url = combine(parentUrl, path);\r\n        } else {\r\n            parentUrl = baseUrl.toUrl();\r\n            url = combine(parentUrl, path);\r\n        }\r\n\r\n        super({\r\n            parentUrl,\r\n            query,\r\n            url,\r\n        });\r\n\r\n        // post init actions\r\n        if (typeof baseUrl !== \"string\") {\r\n            this.configureFrom(baseUrl);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Choose which fields to return\r\n     *\r\n     * @param selects One or more fields to return\r\n     */\r\n    public select(...selects: string[]): this {\r\n        if (selects.length > 0) {\r\n            this.query.set(\"$select\", selects.map(encodeURIComponent).join(\",\"));\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Expands fields such as lookups to get additional data\r\n     *\r\n     * @param expands The Fields for which to expand the values\r\n     */\r\n    public expand(...expands: string[]): this {\r\n        if (expands.length > 0) {\r\n            this.query.set(\"$expand\", expands.map(encodeURIComponent).join(\",\"));\r\n        }\r\n        return this;\r\n    }\r\n\r\n    public defaultAction(options?: IFetchOptions): Promise<GetType> {\r\n        return graphGet(this, options);\r\n    }\r\n\r\n    public get<T = GetType>(options?: IFetchOptions): Promise<T> {\r\n        return graphGet<T>(<any>this, options);\r\n    }\r\n\r\n    /**\r\n     * Gets the full url with query information\r\n     *\r\n     */\r\n    public toUrlAndQuery(): string {\r\n\r\n        let url = this.toUrl();\r\n\r\n        if (this.query.size > 0) {\r\n            const char = url.indexOf(\"?\") > -1 ? \"&\" : \"?\";\r\n            url += `${char}${Array.from(this.query).map((v: [string, string]) => v[0] + \"=\" + v[1]).join(\"&\")}`;\r\n        }\r\n\r\n        return url;\r\n    }\r\n\r\n    public setEndpoint(endpoint: \"beta\" | \"v1.0\"): this {\r\n        this.data.url = GraphEndpoints.ensure(this.data.url, endpoint);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Clones this queryable into a new queryable instance of T\r\n     * @param factory Constructor used to create the new instance\r\n     * @param additionalPath Any additional path to include in the clone\r\n     * @param includeBatch If true this instance's batch will be added to the cloned instance\r\n     * @param includeQuery If true all of the query values will be copied to the cloned instance\r\n     */\r\n    public clone<T extends IGraphQueryable>(factory: (...args: any[]) => T, additionalPath?: string, includeBatch = true, includeQuery = false): T {\r\n\r\n        return super.cloneTo<T>(factory(this, additionalPath), { includeBatch, includeQuery });\r\n    }\r\n\r\n    /**\r\n     * Gets a parent for this instance as specified\r\n     *\r\n     * @param factory The contructor for the class to create\r\n     */\r\n    protected getParent<T extends _GraphQueryable>(\r\n        factory: IGraphQueryableConstructor<T>,\r\n        baseUrl: string | IGraphQueryable = this.parentUrl,\r\n        path?: string): T {\r\n\r\n        return new factory(baseUrl, path);\r\n    }\r\n}\r\n\r\nexport interface IGraphQueryable<GetType = any> extends _GraphQueryable<GetType>, IInvokable<GetType> { }\r\nexport interface _SharePointQueryable<GetType = any> extends IInvokable<GetType> { }\r\nexport interface _GraphQueryable<GetType = any> extends IInvokable<GetType> { }\r\nexport const GraphQueryable = graphInvokableFactory<IGraphQueryable>(_GraphQueryable);\r\n\r\n/**\r\n * Represents a REST collection which can be filtered, paged, and selected\r\n *\r\n */\r\nexport class _GraphQueryableCollection<GetType = any[]> extends _GraphQueryable<GetType> implements IGraphQueryableCollection<GetType> {\r\n\r\n    /**\r\n     *\r\n     * @param filter The string representing the filter query\r\n     */\r\n    public filter(filter: string): this {\r\n        this.query.set(\"$filter\", filter);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Orders based on the supplied fields\r\n     *\r\n     * @param orderby The name of the field on which to sort\r\n     * @param ascending If false DESC is appended, otherwise ASC (default)\r\n     */\r\n    public orderBy(orderBy: string, ascending = true): this {\r\n        const o = \"$orderby\";\r\n        const query = this.query.has(o) ? this.query.get(o).split(\",\") : [];\r\n        query.push(`${encodeURIComponent(orderBy)} ${ascending ? \"asc\" : \"desc\"}`);\r\n        this.query.set(o, query.join(\",\"));\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Limits the query to only return the specified number of items\r\n     *\r\n     * @param top The query row limit\r\n     */\r\n    public top(top: number): this {\r\n        this.query.set(\"$top\", top.toString());\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Skips a set number of items in the return set\r\n     *\r\n     * @param num Number of items to skip\r\n     */\r\n    public skip(num: number): this {\r\n        this.query.set(\"$skip\", num.toString());\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * \tTo request second and subsequent pages of Graph data\r\n     */\r\n    public skipToken(token: string): this {\r\n        this.query.set(\"$skiptoken\", token);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * \tRetrieves the total count of matching resources\r\n     */\r\n    public get count(): this {\r\n        this.query.set(\"$count\", \"true\");\r\n        return this;\r\n    }\r\n}\r\n\r\nexport interface IGraphQueryableCollection<GetType = any[]> extends IInvokable, IGraphQueryable<GetType> {\r\n\r\n    /**\r\n     * \tRetrieves the total count of matching resources\r\n     */\r\n    count: this;\r\n\r\n    /**\r\n     *\r\n     * @param filter The string representing the filter query\r\n     */\r\n    filter(filter: string): this;\r\n\r\n    /**\r\n     * Orders based on the supplied fields\r\n     *\r\n     * @param orderby The name of the field on which to sort\r\n     * @param ascending If false DESC is appended, otherwise ASC (default)\r\n     */\r\n    orderBy(orderBy: string, ascending?: boolean): this;\r\n\r\n    /**\r\n     * Limits the query to only return the specified number of items\r\n     *\r\n     * @param top The query row limit\r\n     */\r\n    top(top: number): this;\r\n\r\n    /**\r\n     * Skips a set number of items in the return set\r\n     *\r\n     * @param num Number of items to skip\r\n     */\r\n    skip(num: number): this;\r\n\r\n    /**\r\n     * \tTo request second and subsequent pages of Graph data\r\n     */\r\n    skipToken(token: string): this;\r\n}\r\nexport interface _GraphQueryableCollection extends IInvokable { }\r\nexport const GraphQueryableCollection = graphInvokableFactory<IGraphQueryableCollection>(_GraphQueryableCollection);\r\n\r\nexport class _GraphQueryableSearchableCollection extends _GraphQueryableCollection implements IGraphQueryableSearchableCollection {\r\n\r\n    /**\r\n     * \tTo request second and subsequent pages of Graph data\r\n     */\r\n    public search(query: string): this {\r\n        this.query.set(\"$search\", query);\r\n        return this;\r\n    }\r\n}\r\n\r\nexport interface IGraphQueryableSearchableCollection<GetType = any> extends IInvokable, IGraphQueryable<GetType> {\r\n    search(query: string): this;\r\n}\r\nexport interface _GraphQueryableSearchableCollection extends IInvokable { }\r\nexport const GraphQueryableSearchableCollection = graphInvokableFactory<IGraphQueryableSearchableCollection>(_GraphQueryableSearchableCollection);\r\n\r\n\r\n/**\r\n * Represents an instance that can be selected\r\n *\r\n */\r\nexport class _GraphQueryableInstance<GetType = any> extends _GraphQueryable<GetType> { }\r\n\r\nexport interface IGraphQueryableInstance<GetType = any> extends IInvokable, IGraphQueryable<GetType> { }\r\nexport interface _GraphQueryableInstance extends IInvokable { }\r\nexport const GraphQueryableInstance = graphInvokableFactory<IGraphQueryableInstance>(_GraphQueryableInstance);\r\n","import { assign, ITypedHash } from \"@pnp/common\";\r\nimport { body, headers } from \"@pnp/odata\";\r\nimport {\r\n    _SharePointQueryableInstance,\r\n    SharePointQueryableCollection,\r\n    _SharePointQueryableCollection,\r\n    ISharePointQueryableCollection,\r\n    ISharePointQueryableInstance,\r\n    spInvokableFactory,\r\n    SharePointQueryableInstance,\r\n    deleteable,\r\n    IDeleteable,\r\n} from \"../sharepointqueryable\";\r\nimport { defaultPath } from \"../decorators\";\r\nimport { IChangeQuery } from \"../types\";\r\nimport { odataUrlFrom } from \"../odata\";\r\nimport { SPBatch } from \"../batch\";\r\nimport { metadata } from \"../utils/metadata\";\r\nimport { Site, IOpenWebByIdResult } from \"../sites\";\r\nimport { spPost, spGet } from \"../operations\";\r\nimport { escapeQueryStrValue } from \"../utils/escapeQueryStrValue\";\r\nimport { tag } from \"../telemetry\";\r\n\r\n@defaultPath(\"webs\")\r\nexport class _Webs extends _SharePointQueryableCollection<IWebInfo[]> {\r\n\r\n    /**\r\n     * Adds a new web to the collection\r\n     *\r\n     * @param title The new web's title\r\n     * @param url The new web's relative url\r\n     * @param description The new web's description\r\n     * @param template The new web's template internal name (default = STS)\r\n     * @param language The locale id that specifies the new web's language (default = 1033 [English, US])\r\n     * @param inheritPermissions When true, permissions will be inherited from the new web's parent (default = true)\r\n     */\r\n    @tag(\"ws.add\")\r\n    public async add(title: string, url: string, description = \"\", template = \"STS\", language = 1033, inheritPermissions = true): Promise<IWebAddResult> {\r\n\r\n        const postBody = body({\r\n            \"parameters\":\r\n                assign(metadata(\"SP.WebCreationInformation\"),\r\n                    {\r\n                        Description: description,\r\n                        Language: language,\r\n                        Title: title,\r\n                        Url: url,\r\n                        UseSamePermissionsAsParentSite: inheritPermissions,\r\n                        WebTemplate: template,\r\n                    }),\r\n        });\r\n\r\n        const data = await spPost(this.clone(Webs, \"add\"), postBody);\r\n\r\n        return {\r\n            data,\r\n            web: Web(odataUrlFrom(data).replace(/_api\\/web\\/?/i, \"\")),\r\n        };\r\n    }\r\n}\r\nexport interface IWebs extends _Webs { }\r\nexport const Webs = spInvokableFactory<IWebs>(_Webs);\r\n\r\n/**\r\n * Describes a web\r\n *\r\n */\r\n@defaultPath(\"_api/web\")\r\nexport class _Web extends _SharePointQueryableInstance<IWebInfo> {\r\n\r\n    public delete = deleteable(\"w\");\r\n\r\n    /**\r\n     * Gets this web's subwebs\r\n     *\r\n     */\r\n    public get webs(): IWebs {\r\n        return Webs(this);\r\n    }\r\n\r\n    /**\r\n     * Gets this web's parent web and data\r\n     *\r\n     */\r\n    @tag(\"w.getParentWeb\")\r\n    public async getParentWeb(): Promise<IOpenWebByIdResult> {\r\n        const { ParentWeb } = await spGet(this.select(\"ParentWeb/Id\").expand(\"ParentWeb\"));\r\n        return ParentWeb?.Id ? Site(this.parentUrl).openWebById(ParentWeb.Id) : null;\r\n    }\r\n\r\n    /**\r\n    * Returns a collection of objects that contain metadata about subsites of the current site in which the current user is a member.\r\n    *\r\n    * @param nWebTemplateFilter Specifies the site definition (default = -1)\r\n    * @param nConfigurationFilter A 16-bit integer that specifies the identifier of a configuration (default = -1)\r\n    */\r\n    public getSubwebsFilteredForCurrentUser(nWebTemplateFilter = -1, nConfigurationFilter = -1): IWebs {\r\n        const o = this.clone(Webs, `getSubwebsFilteredForCurrentUser(nWebTemplateFilter=${nWebTemplateFilter},nConfigurationFilter=${nConfigurationFilter})`);\r\n        return tag.configure(o, \"w.getSubwebsFilteredForCurrentUser\");\r\n    }\r\n\r\n    /**\r\n     * Allows access to the web's all properties collection\r\n     */\r\n    public get allProperties(): ISharePointQueryableInstance {\r\n        return tag.configure(this.clone(SharePointQueryableInstance, \"allproperties\"), \"w.allprops\");\r\n    }\r\n\r\n    /**\r\n     * Gets a collection of WebInfos for this web's subwebs\r\n     *\r\n     */\r\n    public get webinfos(): ISharePointQueryableCollection<IWebInfosData[]> {\r\n        return tag.configure(SharePointQueryableCollection(this, \"webinfos\"), \"w.webinfos\");\r\n    }\r\n\r\n    /**\r\n     * Creates a new batch for requests within the context of this web\r\n     *\r\n     */\r\n    public createBatch(): SPBatch {\r\n        return new SPBatch(this.parentUrl);\r\n    }\r\n\r\n    /**\r\n     * Updates this web instance with the supplied properties\r\n     *\r\n     * @param properties A plain object hash of values to update for the web\r\n     */\r\n    @tag(\"w.update\")\r\n    public async update(properties: ITypedHash<any>): Promise<IWebUpdateResult> {\r\n\r\n        const postBody = body(assign(metadata(\"SP.Web\"), properties), headers({ \"X-HTTP-Method\": \"MERGE\" }));\r\n\r\n        const data = await spPost(this, postBody);\r\n\r\n        return { data, web: <any>this };\r\n    }\r\n\r\n    /**\r\n     * Applies the theme specified by the contents of each of the files specified in the arguments to the site\r\n     *\r\n     * @param colorPaletteUrl The server-relative URL of the color palette file\r\n     * @param fontSchemeUrl The server-relative URL of the font scheme\r\n     * @param backgroundImageUrl The server-relative URL of the background image\r\n     * @param shareGenerated When true, the generated theme files are stored in the root site. When false, they are stored in this web\r\n     */\r\n    @tag(\"w.applyTheme\")\r\n    public applyTheme(colorPaletteUrl: string, fontSchemeUrl: string, backgroundImageUrl: string, shareGenerated: boolean): Promise<void> {\r\n\r\n        const postBody = body({\r\n            backgroundImageUrl,\r\n            colorPaletteUrl,\r\n            fontSchemeUrl,\r\n            shareGenerated,\r\n        });\r\n\r\n        return spPost(this.clone(Web, \"applytheme\"), postBody);\r\n    }\r\n\r\n    /**\r\n     * Applies the specified site definition or site template to the Web site that has no template applied to it\r\n     *\r\n     * @param template Name of the site definition or the name of the site template\r\n     */\r\n    @tag(\"w.applyWebTemplate\")\r\n    public applyWebTemplate(template: string): Promise<void> {\r\n\r\n        const q = this.clone(Web, \"applywebtemplate\");\r\n        q.concat(`(webTemplate='${escapeQueryStrValue(template)}')`);\r\n        return spPost(q);\r\n    }\r\n\r\n    /**\r\n     * Returns a collection of site templates available for the site\r\n     *\r\n     * @param language The locale id of the site templates to retrieve (default = 1033 [English, US])\r\n     * @param includeCrossLanguage When true, includes language-neutral site templates; otherwise false (default = true)\r\n     */\r\n    public availableWebTemplates(language = 1033, includeCrossLanugage = true): ISharePointQueryableCollection {\r\n        const path = `getavailablewebtemplates(lcid=${language}, doincludecrosslanguage=${includeCrossLanugage})`;\r\n        return tag.configure(SharePointQueryableCollection(this, path), \"w.availableWebTemplates\");\r\n    }\r\n\r\n    /**\r\n     * Returns the collection of changes from the change log that have occurred within the list, based on the specified query\r\n     *\r\n     * @param query The change query\r\n     */\r\n    @tag(\"w.getChanges\")\r\n    public getChanges(query: IChangeQuery): Promise<any> {\r\n        const postBody = body({ \"query\": assign(metadata(\"SP.ChangeQuery\"), query) });\r\n        return spPost(this.clone(Web, \"getchanges\"), postBody);\r\n    }\r\n\r\n    /**\r\n     * Returns the name of the image file for the icon that is used to represent the specified file\r\n     *\r\n     * @param filename The file name. If this parameter is empty, the server returns an empty string\r\n     * @param size The size of the icon: 16x16 pixels = 0, 32x32 pixels = 1 (default = 0)\r\n     * @param progId The ProgID of the application that was used to create the file, in the form OLEServerName.ObjectName\r\n     */\r\n    @tag(\"w.mapToIcon\")\r\n    public mapToIcon(filename: string, size = 0, progId = \"\"): Promise<string> {\r\n        return spGet(this.clone(Web, `maptoicon(filename='${escapeQueryStrValue(filename)}', progid='${escapeQueryStrValue(progId)}', size=${size})`));\r\n    }\r\n\r\n    /**\r\n     * Returns the tenant property corresponding to the specified key in the app catalog site\r\n     *\r\n     * @param key Id of storage entity to be set\r\n     */\r\n    @tag(\"w.getStorageEntity\")\r\n    public getStorageEntity(key: string): Promise<IStorageEntity> {\r\n        return spGet(this.clone(Web, `getStorageEntity('${escapeQueryStrValue(key)}')`));\r\n    }\r\n\r\n    /**\r\n     * This will set the storage entity identified by the given key (MUST be called in the context of the app catalog)\r\n     *\r\n     * @param key Id of storage entity to be set\r\n     * @param value Value of storage entity to be set\r\n     * @param description Description of storage entity to be set\r\n     * @param comments Comments of storage entity to be set\r\n     */\r\n    @tag(\"w.setStorageEntity\")\r\n    public setStorageEntity(key: string, value: string, description = \"\", comments = \"\"): Promise<void> {\r\n        return spPost(this.clone(Web, `setStorageEntity`), body({\r\n            comments,\r\n            description,\r\n            key,\r\n            value,\r\n        }));\r\n    }\r\n\r\n    /**\r\n     * This will remove the storage entity identified by the given key\r\n     *\r\n     * @param key Id of storage entity to be removed\r\n     */\r\n    @tag(\"w.removeStorageEntity\")\r\n    public removeStorageEntity(key: string): Promise<void> {\r\n        return spPost(this.clone(Web, `removeStorageEntity('${escapeQueryStrValue(key)}')`));\r\n    }\r\n}\r\nexport interface IWeb extends _Web, IDeleteable { }\r\nexport const Web = spInvokableFactory<IWeb>(_Web);\r\n\r\n/**\r\n * Result from adding a web\r\n *\r\n */\r\nexport interface IWebAddResult {\r\n    data: IWebInfo;\r\n    web: IWeb;\r\n}\r\n\r\n/**\r\n * Result from updating a web\r\n *\r\n */\r\nexport interface IWebUpdateResult {\r\n    data: any;\r\n    web: IWeb;\r\n}\r\n\r\nexport interface IWebInfosData {\r\n    Configuration: number;\r\n    Created: string;\r\n    Description: string;\r\n    Id: string;\r\n    Language: number;\r\n    LastItemModifiedDate: string;\r\n    LastItemUserModifiedDate: string;\r\n    ServerRelativeUrl: string;\r\n    Title: string;\r\n    WebTemplate: string;\r\n    WebTemplateId: number;\r\n}\r\n\r\nexport interface IStorageEntity {\r\n    Value: string | null;\r\n    Comment: string | null;\r\n    Description: string | null;\r\n}\r\n\r\nexport interface IWebInfo {\r\n    AlternateCssUrl: string;\r\n    AppInstanceId: string;\r\n    ClassicWelcomePage: string | null;\r\n    Configuration: number;\r\n    Created: string;\r\n    CurrentChangeToken: { StringValue: string; };\r\n    CustomMasterUrl: string;\r\n    Description: string;\r\n    DesignPackageId: string;\r\n    DocumentLibraryCalloutOfficeWebAppPreviewersDisabled: boolean;\r\n    EnableMinimalDownload: boolean;\r\n    FooterEmphasis: number;\r\n    FooterEnabled: boolean;\r\n    FooterLayout: number;\r\n    HeaderEmphasis: number;\r\n    HeaderLayout: number;\r\n    HorizontalQuickLaunch: boolean;\r\n    Id: string;\r\n    IsHomepageModernized: boolean;\r\n    IsMultilingual: boolean;\r\n    IsRevertHomepageLinkHidden: boolean;\r\n    Language: number;\r\n    LastItemModifiedDate: string;\r\n    LastItemUserModifiedDate: string;\r\n    MasterUrl: string;\r\n    MegaMenuEnabled: boolean;\r\n    NavAudienceTargetingEnabled: boolean;\r\n    NoCrawl: boolean;\r\n    ObjectCacheEnabled: boolean;\r\n    OverwriteTranslationsOnChange: boolean;\r\n    QuickLaunchEnabled: boolean;\r\n    RecycleBinEnabled: boolean;\r\n    ResourcePath: { DecodedUrl: string; };\r\n    SearchScope: number;\r\n    ServerRelativeUrl: string;\r\n    SiteLogoUrl: string | null;\r\n    SyndicationEnabled: boolean;\r\n    TenantAdminMembersCanShare: number;\r\n    Title: string;\r\n    TreeViewEnabled: boolean;\r\n    UIVersion: number;\r\n    UIVersionConfigurationEnabled: boolean;\r\n    Url: string;\r\n    WebTemplate: string;\r\n    WelcomePage: string;\r\n}\r\n","/**\r\n * Class Decorators\r\n */\r\n\r\n/**\r\n * Decorator used to specify the default path for SharePointQueryable objects\r\n * \r\n * @param path \r\n */\r\nexport function defaultPath(path: string) {\r\n\r\n    return function <T extends { new(...args: any[]): {} }>(target: T) {\r\n\r\n        return class extends target {\r\n            constructor(...args: any[]) {\r\n                super(args[0], args.length > 1 && args[1] !== undefined ? args[1] : path);\r\n            }\r\n        };\r\n    };\r\n}\r\n\r\n // TODO::?\r\n// performance tracking method decorator\r\n// redirect to graph api\r\n\r\n\r\n\r\n\r\n","import { IFetchOptions, mergeOptions, objectDefinedNotNull } from \"@pnp/common\";\r\nimport { defaultPipelineBinder, cloneQueryableData, IOperation } from \"@pnp/odata\";\r\nimport { GraphHttpClient } from \"./graphhttpclient\";\r\nimport { IGraphQueryable } from \"./graphqueryable\";\r\nimport { toAbsoluteUrl } from \"./utils/toabsoluteurl\";\r\n\r\nconst graphClientBinder = defaultPipelineBinder(() => new GraphHttpClient());\r\n\r\nconst send = <T>(operation: IOperation): (o: IGraphQueryable<T>, options?: IFetchOptions) => Promise<T> => {\r\n\r\n    return async function <R = T>(o: IGraphQueryable<R>, options?: IFetchOptions): Promise<R> {\r\n\r\n        const data = cloneQueryableData(o.data);\r\n        const batchDependency = objectDefinedNotNull(data.batch) ? data.batch.addDependency() : () => { return; };\r\n        const url = await toAbsoluteUrl(o.toUrlAndQuery());\r\n\r\n        mergeOptions(data.options, options);\r\n\r\n        return operation(Object.assign({}, data, {\r\n            batchDependency,\r\n            url,\r\n        }));\r\n    };\r\n};\r\n\r\nexport const graphGet = <T = any>(o: IGraphQueryable<any>, options?: IFetchOptions): Promise<T> => send<T>(graphClientBinder(\"GET\"))(o, options);\r\n\r\nexport const graphPost = <T = any>(o: IGraphQueryable<any>, options?: IFetchOptions): Promise<T> => send<T>(graphClientBinder(\"POST\"))(o, options);\r\n\r\nexport const graphDelete = <T = any>(o: IGraphQueryable<any>, options?: IFetchOptions): Promise<T> => send<T>(graphClientBinder(\"DELETE\"))(o, options);\r\n\r\nexport const graphPatch = <T = any>(o: IGraphQueryable<any>, options?: IFetchOptions): Promise<T> => send<T>(graphClientBinder(\"PATCH\"))(o, options);\r\n\r\nexport const graphPut = <T = any>(o: IGraphQueryable<any>, options?: IFetchOptions): Promise<T> => send<T>(graphClientBinder(\"PUT\"))(o, options);\r\n","export function metadata(type: string) {\r\n    return {\r\n        \"__metadata\": { \"type\": type },\r\n    };\r\n}\r\n","import { assign, hOP, isArray, objectDefinedNotNull } from \"@pnp/common\";\r\nimport { body, headers } from \"@pnp/odata\";\r\nimport {\r\n    SharePointQueryable,\r\n    SharePointQueryableCollection,\r\n    ISharePointQueryableCollection,\r\n    _SharePointQueryableInstance,\r\n    _SharePointQueryableCollection,\r\n    ISharePointQueryable,\r\n    spInvokableFactory,\r\n    deleteableWithETag,\r\n    IDeleteableWithETag,\r\n} from \"../sharepointqueryable\";\r\nimport { IChangeQuery } from \"../types\";\r\nimport { odataUrlFrom } from \"../odata\";\r\nimport { metadata } from \"../utils/metadata\";\r\nimport { defaultPath } from \"../decorators\";\r\nimport { spPost } from \"../operations\";\r\nimport { escapeQueryStrValue } from \"../utils/escapeQueryStrValue\";\r\nimport { tag } from \"../telemetry\";\r\nimport { IBasePermissions } from \"../security/types\";\r\nimport { IFieldInfo } from \"../fields/types\";\r\nimport { IFormInfo } from \"../forms/types\";\r\nimport { IFolderInfo } from \"../folders/types\";\r\nimport { IViewInfo } from \"../views/types\";\r\nimport { IUserCustomActionInfo } from \"../user-custom-actions/types\";\r\nimport { IResourcePath, toResourcePath } from \"../utils/toResourcePath\";\r\n\r\n@defaultPath(\"lists\")\r\nexport class _Lists extends _SharePointQueryableCollection<IListInfo[]> {\r\n\r\n    /**\r\n     * Gets a list from the collection by guid id\r\n     *\r\n     * @param id The Id of the list (GUID)\r\n     */\r\n    public getById(id: string): IList {\r\n        return tag.configure(List(this).concat(`('${id}')`), \"ls.getById\");\r\n    }\r\n\r\n    /**\r\n     * Gets a list from the collection by title\r\n     *\r\n     * @param title The title of the list\r\n     */\r\n    public getByTitle(title: string): IList {\r\n        return tag.configure(List(this, `getByTitle('${escapeQueryStrValue(title)}')`), \"ls.getByTitle\");\r\n    }\r\n\r\n    /**\r\n     * Adds a new list to the collection\r\n     *\r\n     * @param title The new list's title\r\n     * @param description The new list's description\r\n     * @param template The list template value\r\n     * @param enableContentTypes If true content types will be allowed and enabled, otherwise they will be disallowed and not enabled\r\n     * @param additionalSettings Will be passed as part of the list creation body\r\n     */\r\n    @tag(\"ls.add\")\r\n    public async add(title: string, desc = \"\", template = 100, enableContentTypes = false, additionalSettings: Partial<IListInfo> = {}): Promise<IListAddResult> {\r\n\r\n        const addSettings = Object.assign({\r\n            \"AllowContentTypes\": enableContentTypes,\r\n            \"BaseTemplate\": template,\r\n            \"ContentTypesEnabled\": enableContentTypes,\r\n            \"Description\": desc,\r\n            \"Title\": title,\r\n        }, metadata(\"SP.List\"), additionalSettings);\r\n\r\n        const data = await spPost(this, body(addSettings));\r\n\r\n        return { data, list: this.getByTitle(addSettings.Title) };\r\n    }\r\n\r\n    /**\r\n     * Ensures that the specified list exists in the collection (note: this method not supported for batching)\r\n     *\r\n     * @param title The new list's title\r\n     * @param desc The new list's description\r\n     * @param template The list template value\r\n     * @param enableContentTypes If true content types will be allowed and enabled, otherwise they will be disallowed and not enabled\r\n     * @param additionalSettings Will be passed as part of the list creation body or used to update an existing list\r\n     */\r\n    @tag(\"ls.ensure\")\r\n    public async ensure(\r\n        title: string,\r\n        desc = \"\",\r\n        template = 100,\r\n        enableContentTypes = false,\r\n        additionalSettings: Partial<IListInfo> = {}): Promise<IListEnsureResult> {\r\n\r\n        if (this.hasBatch) {\r\n            throw Error(\"The ensure list method is not supported for use in a batch.\");\r\n        }\r\n\r\n        const addOrUpdateSettings = assign(additionalSettings, { Title: title, Description: desc, ContentTypesEnabled: enableContentTypes }, true);\r\n\r\n        const list: IList = this.getByTitle(addOrUpdateSettings.Title);\r\n\r\n        try {\r\n\r\n            // this will throw if the list doesn't exist\r\n            await list.select(\"Title\")();\r\n            const data = await list.update(addOrUpdateSettings).then(r => r.data);\r\n            return { created: false, data, list: this.getByTitle(addOrUpdateSettings.Title) };\r\n\r\n        } catch (e) {\r\n\r\n            const data = await this.add(title, desc, template, enableContentTypes, addOrUpdateSettings).then(r => r.data);\r\n            return { created: true, data, list: this.getByTitle(addOrUpdateSettings.Title) };\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets a list that is the default asset location for images or other files, which the users upload to their wiki pages.\r\n     */\r\n    @tag(\"ls.ensureSiteAssetsLibrary\")\r\n    public async ensureSiteAssetsLibrary(): Promise<IList> {\r\n        const json = await spPost(this.clone(Lists, \"ensuresiteassetslibrary\"));\r\n        return List(odataUrlFrom(json));\r\n    }\r\n\r\n    /**\r\n     * Gets a list that is the default location for wiki pages.\r\n     */\r\n    @tag(\"ls.ensureSitePagesLibrary\")\r\n    public async ensureSitePagesLibrary(): Promise<IList> {\r\n        const json = await spPost(this.clone(Lists, \"ensuresitepageslibrary\"));\r\n        return List(odataUrlFrom(json));\r\n    }\r\n}\r\nexport interface ILists extends _Lists { }\r\nexport const Lists = spInvokableFactory<ILists>(_Lists);\r\n\r\nexport class _List extends _SharePointQueryableInstance<IListInfo> {\r\n\r\n    public delete = deleteableWithETag(\"l\");\r\n\r\n    /**\r\n     * Gets the effective base permissions of this list\r\n     *\r\n     */\r\n    public get effectiveBasePermissions(): ISharePointQueryable {\r\n        return tag.configure(SharePointQueryable(this, \"EffectiveBasePermissions\"), \"l.effectiveBasePermissions\");\r\n    }\r\n\r\n    /**\r\n     * Gets the event receivers attached to this list\r\n     *\r\n     */\r\n    public get eventReceivers(): ISharePointQueryableCollection {\r\n        return tag.configure(SharePointQueryableCollection(this, \"EventReceivers\"), \"l.eventReceivers\");\r\n    }\r\n\r\n    /**\r\n     * Gets the related fields of this list\r\n     *\r\n     */\r\n    public get relatedFields(): ISharePointQueryable {\r\n        return tag.configure(SharePointQueryable(this, \"getRelatedFields\"), \"l.relatedFields\");\r\n    }\r\n\r\n    /**\r\n     * Gets the IRM settings for this list\r\n     *\r\n     */\r\n    public get informationRightsManagementSettings(): ISharePointQueryable {\r\n        return tag.configure(SharePointQueryable(this, \"InformationRightsManagementSettings\"), \"l.informationRightsManagementSettings\");\r\n    }\r\n\r\n    /**\r\n     * Updates this list intance with the supplied properties\r\n     *\r\n     * @param properties A plain object hash of values to update for the list\r\n     * @param eTag Value used in the IF-Match header, by default \"*\"\r\n     */\r\n    @tag(\"l.update\")\r\n    public async update(properties: Partial<IListInfo>, eTag = \"*\"): Promise<IListUpdateResult> {\r\n\r\n        const postBody = body(assign(metadata(\"SP.List\"), properties), headers({\r\n            \"IF-Match\": eTag,\r\n            \"X-HTTP-Method\": \"MERGE\",\r\n        }));\r\n\r\n        const data = await spPost(this, postBody);\r\n\r\n        let list: any = this;\r\n\r\n        if (hOP(properties, \"Title\")) {\r\n            list = this.getParent(List, this.parentUrl, `getByTitle('${properties.Title}')`);\r\n        }\r\n\r\n        return {\r\n            data,\r\n            list,\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Returns the collection of changes from the change log that have occurred within the list, based on the specified query.\r\n     * @param query A query that is performed against the change log.\r\n     */\r\n    @tag(\"l.getChanges\")\r\n    public getChanges(query: IChangeQuery): Promise<any> {\r\n\r\n        return spPost(this.clone(List, \"getchanges\"), body({ query: assign(metadata(\"SP.ChangeQuery\"), query) }));\r\n    }\r\n\r\n    /**\r\n     * Returns the collection of items in the list based on the provided CamlQuery\r\n     * @param query A query that is performed against the list\r\n     * @param expands An expanded array of n items that contains fields to expand in the CamlQuery\r\n     */\r\n    @tag(\"l.CAMLQuery\")\r\n    public getItemsByCAMLQuery(query: ICamlQuery, ...expands: string[]): Promise<any> {\r\n\r\n        const q = this.clone(List, \"getitems\");\r\n        return spPost(q.expand.apply(q, expands), body({ query: assign(metadata(\"SP.CamlQuery\"), query) }));\r\n    }\r\n\r\n    /**\r\n     * See: https://msdn.microsoft.com/en-us/library/office/dn292554.aspx\r\n     * @param query An object that defines the change log item query\r\n     */\r\n    @tag(\"l.ChangesSinceToken\")\r\n    public getListItemChangesSinceToken(query: IChangeLogItemQuery): Promise<string> {\r\n\r\n        const o = this.clone(List, \"getlistitemchangessincetoken\").usingParser({ parse(r: Response) { return r.text(); } });\r\n        return spPost(o, body({ \"query\": assign(metadata(\"SP.ChangeLogItemQuery\"), query) }));\r\n    }\r\n\r\n    /**\r\n     * Moves the list to the Recycle Bin and returns the identifier of the new Recycle Bin item.\r\n     */\r\n    @tag(\"l.recycle\")\r\n    public async recycle(): Promise<string> {\r\n        const data = await spPost(this.clone(List, \"recycle\"));\r\n        return hOP(data, \"Recycle\") ? data.Recycle : data;\r\n    }\r\n\r\n    /**\r\n     * Renders list data based on the view xml provided\r\n     * @param viewXml A string object representing a view xml\r\n     */\r\n    @tag(\"l.renderListData\")\r\n    public async renderListData(viewXml: string): Promise<IRenderListData> {\r\n\r\n        const q = this.clone(List, \"renderlistdata(@viewXml)\");\r\n        q.query.set(\"@viewXml\", `'${viewXml}'`);\r\n        const data = await spPost(q);\r\n\r\n        // data will be a string, so we parse it again\r\n        return JSON.parse(hOP(data, \"RenderListData\") ? data.RenderListData : data);\r\n    }\r\n\r\n    /**\r\n     * Returns the data for the specified query view\r\n     *\r\n     * @param parameters The parameters to be used to render list data as JSON string.\r\n     * @param overrideParams The parameters that are used to override and extend the regular SPRenderListDataParameters.\r\n     * @param query Allows setting of query parameters\r\n     */\r\n    @tag(\"l.AsStream\")\r\n    public renderListDataAsStream(parameters: IRenderListDataParameters, overrideParams: any = null, query = new Map<string, string>()): Promise<IRenderListDataAsStreamResult> {\r\n\r\n        if (hOP(parameters, \"RenderOptions\") && isArray(parameters.RenderOptions)) {\r\n            parameters.RenderOptions = (<RenderListDataOptions[]>parameters.RenderOptions).reduce((v, c) => v + c);\r\n        }\r\n\r\n        let bodyOptions = { parameters: assign(metadata(\"SP.RenderListDataParameters\"), parameters) };\r\n\r\n        if (objectDefinedNotNull(overrideParams)) {\r\n            bodyOptions = assign(bodyOptions, { overrideParameters: assign(metadata(\"SP.RenderListDataOverrideParameters\"), overrideParams) });\r\n        }\r\n\r\n        const clone = this.clone(List, \"RenderListDataAsStream\", true, true);\r\n\r\n        if (query && query.size > 0) {\r\n            query.forEach((v, k) => clone.query.set(k, v));\r\n        }\r\n\r\n        return spPost(clone, body(bodyOptions));\r\n    }\r\n\r\n    /**\r\n     * Gets the field values and field schema attributes for a list item.\r\n     * @param itemId Item id of the item to render form data for\r\n     * @param formId The id of the form\r\n     * @param mode Enum representing the control mode of the form (Display, Edit, New)\r\n     */\r\n    @tag(\"l.renderListFormData\")\r\n    public async renderListFormData(itemId: number, formId: string, mode: ControlMode): Promise<IListFormData> {\r\n        const data = await spPost(this.clone(List, `renderlistformdata(itemid=${itemId}, formid='${formId}', mode='${mode}')`));\r\n        // data will be a string, so we parse it again\r\n        return JSON.parse(hOP(data, \"RenderListFormData\") ? data.RenderListFormData : data);\r\n    }\r\n\r\n    /**\r\n     * Reserves a list item ID for idempotent list item creation.\r\n     */\r\n    @tag(\"l.reserveListItemId\")\r\n    public async reserveListItemId(): Promise<number> {\r\n        const data = await spPost(this.clone(List, \"reservelistitemid\"));\r\n        return hOP(data, \"ReserveListItemId\") ? data.ReserveListItemId : data;\r\n    }\r\n\r\n    /**\r\n     * Returns the ListItemEntityTypeFullName for this list, used when adding/updating list items. Does not support batching.\r\n     */\r\n    @tag(\"l.getListItemEntityTypeFullName\")\r\n    public getListItemEntityTypeFullName(): Promise<string> {\r\n        return this.clone(List, null, false).select(\"ListItemEntityTypeFullName\").get<{ ListItemEntityTypeFullName: string }>().then(o => o.ListItemEntityTypeFullName);\r\n    }\r\n\r\n    /**\r\n     * Creates an item using path (in a folder), validates and sets its field values.\r\n     *\r\n     * @param formValues The fields to change and their new values.\r\n     * @param decodedUrl Path decoded url; folder's server relative path.\r\n     * @param bNewDocumentUpdate true if the list item is a document being updated after upload; otherwise false.\r\n     * @param checkInComment Optional check in comment.\r\n     * @param additionalProps Optional set of additional properties LeafName new document file name, \r\n     */\r\n    @tag(\"l.addValidateUpdateItemUsingPath\")\r\n    public async addValidateUpdateItemUsingPath(\r\n        formValues: IListItemFormUpdateValue[],\r\n        decodedUrl: string,\r\n        bNewDocumentUpdate = false,\r\n        checkInComment?: string,\r\n        additionalProps?: {\r\n            /**\r\n             * If creating a document or folder, the name\r\n             */\r\n            leafName?: string,\r\n            /**\r\n             * 0: File, 1: Folder, 2: Web\r\n             */\r\n            objectType?: 0 | 1 | 2,\r\n        },\r\n    ): Promise<IListItemFormUpdateValue[]> {\r\n\r\n        const addProps: any = {\r\n            FolderPath: toResourcePath(decodedUrl),\r\n        };\r\n\r\n        if (objectDefinedNotNull(additionalProps)) {\r\n\r\n            if (additionalProps.leafName) {\r\n                addProps.LeafName = toResourcePath(additionalProps.leafName);\r\n            }\r\n\r\n            if (additionalProps.objectType) {\r\n                addProps.UnderlyingObjectType = additionalProps.objectType;\r\n            }\r\n        }\r\n\r\n        const res = await spPost(this.clone(List, \"AddValidateUpdateItemUsingPath()\"), body({\r\n            bNewDocumentUpdate,\r\n            checkInComment,\r\n            formValues,\r\n            listItemCreateInfo: assign(metadata(\"SP.ListItemCreationInformationUsingPath\"), addProps),\r\n        }));\r\n\r\n        return hOP(res, \"AddValidateUpdateItemUsingPath\") ? res.AddValidateUpdateItemUsingPath : res;\r\n    }\r\n\r\n    /**\r\n     * Gets the parent information for this item's list and web\r\n     */\r\n    public async getParentInfos(): Promise<IListParentInfos> {\r\n\r\n        const urlInfo: any =\r\n            await this.select(\r\n                \"Id\",\r\n                \"RootFolder/UniqueId\",\r\n                \"RootFolder/ServerRelativeUrl\",\r\n                \"RootFolder/ServerRelativePath\",\r\n                \"ParentWeb/Id\",\r\n                \"ParentWeb/Url\",\r\n                \"ParentWeb/ServerRelativeUrl\",\r\n                \"ParentWeb/ServerRelativePath\",\r\n            ).expand(\r\n                \"RootFolder\",\r\n                \"ParentWeb\")();\r\n\r\n        return {\r\n            List: {\r\n                Id: urlInfo.Id,\r\n                RootFolderServerRelativePath: urlInfo.RootFolder.ServerRelativePath,\r\n                RootFolderServerRelativeUrl: urlInfo.RootFolder.ServerRelativeUrl,\r\n                RootFolderUniqueId: urlInfo.RootFolder.UniqueId,\r\n            },\r\n            ParentWeb: {\r\n                Id: urlInfo.ParentWeb.Id,\r\n                ServerRelativePath: urlInfo.ParentWeb.ServerRelativePath,\r\n                ServerRelativeUrl: urlInfo.ParentWeb.ServerRelativeUrl,\r\n                Url: urlInfo.ParentWeb.Url,\r\n            },\r\n        };\r\n    }\r\n}\r\nexport interface IList extends _List, IDeleteableWithETag { }\r\nexport const List = spInvokableFactory<IList>(_List);\r\n\r\n/**\r\n * Represents the output of the add method\r\n */\r\nexport interface IListAddResult {\r\n    list: IList;\r\n    data: any;\r\n}\r\n\r\n/**\r\n * Represents the output of the update method\r\n */\r\nexport interface IListUpdateResult {\r\n    list: IList;\r\n    data: any;\r\n}\r\n\r\n/**\r\n * Represents the output of the ensure method\r\n */\r\nexport interface IListEnsureResult {\r\n    list: IList;\r\n    created: boolean;\r\n    data: any;\r\n}\r\n\r\n/**\r\n * Specifies a Collaborative Application Markup Language (CAML) query on a list or joined lists.\r\n */\r\nexport interface ICamlQuery {\r\n\r\n    /**\r\n     * Gets or sets a value that indicates whether the query returns dates in Coordinated Universal Time (UTC) format.\r\n     */\r\n    DatesInUtc?: boolean;\r\n\r\n    /**\r\n     * Gets or sets a value that specifies the server relative URL of a list folder from which results will be returned.\r\n     */\r\n    FolderServerRelativeUrl?: string;\r\n\r\n    /**\r\n     * Gets or sets a value that specifies the information required to get the next page of data for the list view.\r\n     */\r\n    ListItemCollectionPosition?: IListItemCollectionPosition;\r\n\r\n    /**\r\n     * Gets or sets value that specifies the XML schema that defines the list view.\r\n     */\r\n    ViewXml?: string;\r\n}\r\n\r\n/**\r\n * Specifies the information required to get the next page of data for a list view.\r\n */\r\nexport interface IListItemCollectionPosition {\r\n    /**\r\n     * Gets or sets a value that specifies information, as name-value pairs, required to get the next page of data for a list view.\r\n     */\r\n    PagingInfo: string;\r\n}\r\n\r\n/**\r\n * Represents the input parameter of the GetListItemChangesSinceToken method.\r\n */\r\nexport interface IChangeLogItemQuery {\r\n    /**\r\n     * The change token for the request.\r\n     */\r\n    ChangeToken?: string;\r\n\r\n    /**\r\n     * The XML element that defines custom filtering for the query.\r\n     */\r\n    Contains?: string;\r\n\r\n    /**\r\n     * The records from the list to return and their return order.\r\n     */\r\n    Query?: string;\r\n\r\n    /**\r\n     * The options for modifying the query.\r\n     */\r\n    QueryOptions?: string;\r\n\r\n    /**\r\n     * RowLimit\r\n     */\r\n    RowLimit?: string;\r\n\r\n    /**\r\n     * The names of the fields to include in the query result.\r\n     */\r\n    ViewFields?: string;\r\n\r\n    /**\r\n     * The GUID of the view.\r\n     */\r\n    ViewName?: string;\r\n}\r\n\r\n/**\r\n * Represents the output parameter of the renderListFormData method.\r\n */\r\nexport interface IListFormData {\r\n    ContentType?: string;\r\n    Title?: string;\r\n    Author?: string;\r\n    Editor?: string;\r\n    Created?: Date;\r\n    Modified: Date;\r\n    Attachments?: any;\r\n    ListSchema?: any;\r\n    FormControlMode?: number;\r\n    FieldControlModes?: {\r\n        Title?: number,\r\n        Author?: number,\r\n        Editor?: number,\r\n        Created?: number,\r\n        Modified?: number,\r\n        Attachments?: number,\r\n    };\r\n    WebAttributes?: {\r\n        WebUrl?: string,\r\n        EffectivePresenceEnabled?: boolean,\r\n        AllowScriptableWebParts?: boolean,\r\n        PermissionCustomizePages?: boolean,\r\n        LCID?: number,\r\n        CurrentUserId?: number,\r\n    };\r\n    ItemAttributes?: {\r\n        Id?: number,\r\n        FsObjType?: number,\r\n        ExternalListItem?: boolean,\r\n        Url?: string,\r\n        EffectiveBasePermissionsLow?: number,\r\n        EffectiveBasePermissionsHigh?: number,\r\n    };\r\n    ListAttributes?: {\r\n        Id?: string,\r\n        BaseType?: number,\r\n        Direction?: string,\r\n        ListTemplateType?: number,\r\n        DefaultItemOpen?: number,\r\n        EnableVersioning?: boolean,\r\n    };\r\n    CSRCustomLayout?: boolean;\r\n    PostBackRequired?: boolean;\r\n    PreviousPostBackHandled?: boolean;\r\n    UploadMode?: boolean;\r\n    SubmitButtonID?: string;\r\n    ItemContentTypeName?: string;\r\n    ItemContentTypeId?: string;\r\n    JSLinks?: string;\r\n}\r\n\r\n/**\r\n * Enum representing the options of the RenderOptions property on IRenderListDataParameters interface\r\n */\r\nexport enum RenderListDataOptions {\r\n    None = 0,\r\n    ContextInfo = 1,\r\n    ListData = 2,\r\n    ListSchema = 4,\r\n    MenuView = 8,\r\n    ListContentType = 16,\r\n    FileSystemItemId = 32,\r\n    ClientFormSchema = 64,\r\n    QuickLaunch = 128,\r\n    Spotlight = 256,\r\n    Visualization = 512,\r\n    ViewMetadata = 1024,\r\n    DisableAutoHyperlink = 2048,\r\n    EnableMediaTAUrls = 4096,\r\n    ParentInfo = 8192,\r\n    PageContextInfo = 16384,\r\n    ClientSideComponentManifest = 32768,\r\n}\r\n/**\r\n * Represents the parameters to be used to render list data as JSON string in the RenderListDataAsStream method of IList.\r\n */\r\nexport interface IRenderListDataParameters {\r\n    AddRequiredFields?: boolean;\r\n    AllowMultipleValueFilterForTaxonomyFields?: boolean;\r\n    AudienceTarget?: boolean;\r\n    DatesInUtc?: boolean;\r\n    DeferredRender?: boolean;\r\n    ExpandGroups?: boolean;\r\n    FirstGroupOnly?: boolean;\r\n    FolderServerRelativeUrl?: string;\r\n    ImageFieldsToTryRewriteToCdnUrls?: string;\r\n    MergeDefaultView?: boolean;\r\n    OriginalDate?: boolean;\r\n    OverrideViewXml?: string;\r\n    Paging?: string;\r\n    ReplaceGroup?: boolean;\r\n    RenderOptions?: RenderListDataOptions[] | number;\r\n    ViewXml?: string;\r\n}\r\n\r\n/**\r\n * Represents properties of a list item field and its value.\r\n */\r\nexport interface IListItemFormUpdateValue {\r\n\r\n    /**\r\n     * The error message result after validating the value for the field.\r\n     */\r\n    ErrorMessage?: string;\r\n\r\n    /**\r\n     * The internal name of the field.\r\n     */\r\n    FieldName?: string;\r\n\r\n    /**\r\n     * The value of the field, in string format.\r\n     */\r\n    FieldValue?: string;\r\n\r\n    /**\r\n     * Indicates whether there was an error result after validating the value for the field.\r\n     */\r\n    HasException?: boolean;\r\n}\r\n\r\n/**\r\n * Represents the output parameter of the renderListData method.\r\n */\r\nexport interface IRenderListData {\r\n    Row: any[];\r\n    FirstRow: number;\r\n    FolderPermissions: string;\r\n    LastRow: number;\r\n    FilterLink: string;\r\n    ForceNoHierarchy: string;\r\n    HierarchyHasIndention: string;\r\n}\r\n\r\n/**\r\n * Determines the display mode of the given control or view\r\n */\r\nexport enum ControlMode {\r\n    Display = 1,\r\n    Edit = 2,\r\n    New = 3,\r\n}\r\n\r\nexport interface IListInfo {\r\n    AllowContentTypes: boolean;\r\n    AllowDeletion: boolean;\r\n    BaseTemplate: number;\r\n    BaseType: any;\r\n    BrowserFileHandling: any;\r\n    ContentTypes: any[];\r\n    ContentTypesEnabled: boolean;\r\n    CrawlNonDefaultViews: boolean;\r\n    CreatablesInfo: any;\r\n    Created: string;\r\n    CurrentChangeToken: any;\r\n    CustomActionElements: any[];\r\n    DataSource: any;\r\n    DefaultContentApprovalWorkflowId: string;\r\n    DefaultDisplayFormUrl: string;\r\n    DefaultEditFormUrl: string;\r\n    DefaultNewFormUrl: string;\r\n    DefaultView: any;\r\n    DefaultViewPath: any;\r\n    DefaultViewUrl: string;\r\n    Description: string;\r\n    DescriptionResource: any;\r\n    Direction: string;\r\n    DocumentTemplateUrl: string;\r\n    DraftVersionVisibility: any;\r\n    EffectiveBasePermissions: IBasePermissions;\r\n    EffectiveBasePermissionsForUI: IBasePermissions;\r\n    EnableAssignToEmail: boolean;\r\n    EnableAttachments: boolean;\r\n    EnableFolderCreation: boolean;\r\n    EnableMinorVersions: boolean;\r\n    EnableModeration: boolean;\r\n    EnableRequestSignOff: boolean;\r\n    EnableVersioning: boolean;\r\n    EntityTypeName: string;\r\n    EventReceivers: any[];\r\n    ExcludeFromOfflineClient: boolean;\r\n    ExemptFromBlockDownloadOfNonViewableFiles: boolean;\r\n    Fields: Partial<IFieldInfo>[];\r\n    FileSavePostProcessingEnabled: boolean;\r\n    ForceCheckout: boolean;\r\n    Forms: IFormInfo[];\r\n    HasExternalDataSource: boolean;\r\n    Hidden: boolean;\r\n    Id: string;\r\n    ImagePath: { DecodedUrl: string; };\r\n    ImageUrl: string;\r\n    InformationRightsManagementSettings: any[];\r\n    IrmEnabled: boolean;\r\n    IrmExpire: boolean;\r\n    IrmReject: boolean;\r\n    IsApplicationList: boolean;\r\n    IsCatalog: boolean;\r\n    IsPrivate: boolean;\r\n    IsSiteAssetsLibrary: boolean;\r\n    IsSystemList: boolean;\r\n    ItemCount: number;\r\n    LastItemDeletedDate: string;\r\n    LastItemModifiedDate: string;\r\n    LastItemUserModifiedDate: string;\r\n    ListExperienceOptions: number;\r\n    ListItemEntityTypeFullName: string;\r\n    MajorVersionLimit: number;\r\n    MajorWithMinorVersionsLimit: number;\r\n    MultipleDataList: boolean;\r\n    NoCrawl: boolean;\r\n    OnQuickLaunch: boolean;\r\n    ParentWebPath: { DecodedUrl: string; };\r\n    ParentWebUrl: string;\r\n    ParserDisabled: boolean;\r\n    ReadSecurity: number;\r\n    RootFolder: IFolderInfo;\r\n    SchemaXml: string;\r\n    ServerTemplateCanCreateFolders: boolean;\r\n    TemplateFeatureId: string;\r\n    Title: string;\r\n    UserCustomActions: IUserCustomActionInfo[];\r\n    ValidationFormula: string;\r\n    ValidationMessage: string;\r\n    Views: IViewInfo[];\r\n    WorkflowAssociations: any[];\r\n    WriteSecurity: number;\r\n}\r\n\r\nexport interface IRenderListDataAsStreamResult {\r\n    CurrentFolderSpItemUrl: string;\r\n    FilterLink: string;\r\n    FirstRow: number;\r\n    FolderPermissions: string;\r\n    ForceNoHierarchy: string;\r\n    HierarchyHasIndention: string;\r\n    LastRow: number;\r\n    Row: any[];\r\n    RowLimit: number;\r\n}\r\n\r\nexport interface IListParentInfos {\r\n    List: {\r\n        Id: string;\r\n        RootFolderServerRelativePath: IResourcePath;\r\n        RootFolderServerRelativeUrl: string;\r\n        RootFolderUniqueId: string;\r\n    };\r\n    ParentWeb: {\r\n        Id: string;\r\n        ServerRelativePath: IResourcePath;\r\n        ServerRelativeUrl: string;\r\n        Url: string;\r\n    };\r\n}\r\n","import { stringIsNullOrEmpty } from \"@pnp/common\";\r\nimport { LogLevel, Logger } from \"@pnp/logging\";\r\n\r\nexport function escapeQueryStrValue(value: string): string {\r\n\r\n    if (stringIsNullOrEmpty(value)) {\r\n        return \"\";\r\n    }\r\n\r\n    // replace all instance of ' with ''\r\n\r\n    if (/!(@.*?)::(.*?)/ig.test(value)) {\r\n        // to ensure our param aliasing still works we need to treat these special or we'll hear about it\r\n        // so we encode JUST the part that will end up in the url\r\n        return value.replace(/!(@.*?)::(.*)$/ig, (match, labelName, v) => {\r\n            Logger.write(`Rewriting aliased parameter from match ${match} to label: ${labelName} value: ${v}`, LogLevel.Verbose);\r\n            return `!${labelName}::${encodeURIComponent(v.replace(/\\'/ig, \"''\"))}`;\r\n        });\r\n    } else {\r\n        return encodeURIComponent(value.replace(/\\'/ig, \"''\"));\r\n    }\r\n}\r\n","import {\r\n    SharePointQueryable,\r\n    _SharePointQueryableInstance,\r\n    ISharePointQueryableInstance,\r\n    _SharePointQueryableCollection,\r\n    ISharePointQueryable,\r\n    SharePointQueryableInstance,\r\n    spInvokableFactory,\r\n    deleteableWithETag,\r\n    IDeleteableWithETag,\r\n} from \"../sharepointqueryable\";\r\nimport { assign, ITypedHash, hOP } from \"@pnp/common\";\r\nimport { IListItemFormUpdateValue, List } from \"../lists/types\";\r\nimport { ODataParser, body, headers } from \"@pnp/odata\";\r\nimport { IList } from \"../lists\";\r\nimport { Logger, LogLevel } from \"@pnp/logging\";\r\nimport { metadata } from \"../utils/metadata\";\r\nimport { defaultPath } from \"../decorators\";\r\nimport { spPost } from \"../operations\";\r\nimport { tag } from \"../telemetry\";\r\nimport { IResourcePath } from '../utils/toResourcePath';\r\n\r\n/**\r\n * Describes a collection of Item objects\r\n *\r\n */\r\n@defaultPath(\"items\")\r\nexport class _Items extends _SharePointQueryableCollection {\r\n\r\n    /**\t\r\n    * Gets an Item by id\t\r\n    *\t\r\n    * @param id The integer id of the item to retrieve\t\r\n    */\r\n    public getById(id: number): IItem {\r\n        return tag.configure(Item(this).concat(`(${id})`), \"is.getById\");\r\n    }\r\n\r\n    /**\r\n     * Gets BCS Item by string id\r\n     *\r\n     * @param stringId The string id of the BCS item to retrieve\r\n     */\r\n    public getItemByStringId(stringId: string): IItem {\r\n        // creates an item with the parent list path and append out method call\r\n        return tag.configure(Item(this.parentUrl, `getItemByStringId('${stringId}')`), \"is.getItemByStringId\");\r\n    }\r\n\r\n    /**\r\n     * Skips the specified number of items (https://msdn.microsoft.com/en-us/library/office/fp142385.aspx#sectionSection6)\r\n     *\r\n     * @param skip The starting id where the page should start, use with top to specify pages\r\n     * @param reverse It true the PagedPrev=true parameter is added allowing backwards navigation in the collection\r\n     */\r\n    public skip(skip: number, reverse = false): this {\r\n        if (reverse) {\r\n            this.query.set(\"$skiptoken\", encodeURIComponent(`Paged=TRUE&PagedPrev=TRUE&p_ID=${skip}`));\r\n        } else {\r\n            this.query.set(\"$skiptoken\", encodeURIComponent(`Paged=TRUE&p_ID=${skip}`));\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Gets a collection designed to aid in paging through data\r\n     *\r\n     */\r\n    @tag(\"is.getPaged\")\r\n    public getPaged<T = any[]>(): Promise<PagedItemCollection<T>> {\r\n        return this.usingParser(new PagedItemCollectionParser<T>(this))();\r\n    }\r\n\r\n    /**\r\n     * Gets all the items in a list, regardless of count. Does not support batching or caching\r\n     *\r\n     *  @param requestSize Number of items to return in each request (Default: 2000)\r\n     *  @param acceptHeader Allows for setting the value of the Accept header for SP 2013 support\r\n     */\r\n    @tag(\"is.getAll\")\r\n    public getAll(requestSize = 2000, acceptHeader = \"application/json;odata=nometadata\"): Promise<any[]> {\r\n\r\n        Logger.write(\"Calling items.getAll should be done sparingly. Ensure this is the correct choice. If you are unsure, it is not.\", LogLevel.Warning);\r\n\r\n        // this will be used for the actual query\r\n        // and we set no metadata here to try and reduce traffic\r\n        const items = <IItems>Items(this, \"\").top(requestSize).configure({\r\n            headers: {\r\n                \"Accept\": acceptHeader,\r\n            },\r\n        });\r\n\r\n        // let's copy over the odata query params that can be applied\r\n        // $top - allow setting the page size this way (override what we did above)\r\n        // $select - allow picking the return fields (good behavior)\r\n        // $filter - allow setting a filter, though this may fail due for large lists\r\n        this.query.forEach((v: string, k: string) => {\r\n            if (/^\\$select|filter|top|expand$/i.test(k)) {\r\n                items.query.set(k, v);\r\n            }\r\n        });\r\n\r\n        // give back the promise\r\n        return new Promise((resolve, reject) => {\r\n\r\n            // this will eventually hold the items we return\r\n            const itemsCollector: any[] = [];\r\n\r\n            // action that will gather up our results recursively\r\n            const gatherer = (last: PagedItemCollection<any>) => {\r\n\r\n                // collect that set of results\r\n                [].push.apply(itemsCollector, last.results);\r\n\r\n                // if we have more, repeat - otherwise resolve with the collected items\r\n                if (last.hasNext) {\r\n                    last.getNext().then(gatherer).catch(reject);\r\n                } else {\r\n                    resolve(itemsCollector);\r\n                }\r\n            };\r\n\r\n            // start the cycle\r\n            items.getPaged().then(gatherer).catch(reject);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Adds a new item to the collection\r\n     *\r\n     * @param properties The new items's properties\r\n     * @param listItemEntityTypeFullName The type name of the list's entities\r\n     */\r\n    @tag(\"is.add\")\r\n    public async add(properties: ITypedHash<any> = {}, listItemEntityTypeFullName: string = null): Promise<IItemAddResult> {\r\n\r\n        const removeDependency = this.addBatchDependency();\r\n\r\n        const listItemEntityType = await this.ensureListItemEntityTypeName(listItemEntityTypeFullName);\r\n\r\n        const postBody = body(assign(metadata(listItemEntityType), properties));\r\n\r\n        const promise = spPost<{ Id: number }>(this.clone(Items, \"\"), postBody).then((data) => {\r\n            return {\r\n                data: data,\r\n                item: this.getById(data.Id),\r\n            };\r\n        });\r\n\r\n        removeDependency();\r\n\r\n        return promise;\r\n    }\r\n\r\n    /**\r\n     * Ensures we have the proper list item entity type name, either from the value provided or from the list\r\n     *\r\n     * @param candidatelistItemEntityTypeFullName The potential type name\r\n     */\r\n    private ensureListItemEntityTypeName(candidatelistItemEntityTypeFullName: string): Promise<string> {\r\n\r\n        return candidatelistItemEntityTypeFullName ?\r\n            Promise.resolve(candidatelistItemEntityTypeFullName) :\r\n            this.getParent<IList>(List).getListItemEntityTypeFullName();\r\n    }\r\n}\r\nexport interface IItems extends _Items { }\r\nexport const Items = spInvokableFactory<IItems>(_Items);\r\n\r\n/**\r\n * Descrines a single Item instance\r\n *\r\n */\r\nexport class _Item extends _SharePointQueryableInstance {\r\n\r\n    public delete = deleteableWithETag(\"i\");\r\n\r\n    /**\r\n     * Gets the effective base permissions for the item\r\n     *\r\n     */\r\n    public get effectiveBasePermissions(): ISharePointQueryable {\r\n        return tag.configure(SharePointQueryable(this, \"EffectiveBasePermissions\"), \"i.effectiveBasePermissions\");\r\n    }\r\n\r\n    /**\r\n     * Gets the effective base permissions for the item in a UI context\r\n     *\r\n     */\r\n    public get effectiveBasePermissionsForUI(): ISharePointQueryable {\r\n        return tag.configure(SharePointQueryable(this, \"EffectiveBasePermissionsForUI\"), \"i.effectiveBasePermissionsForUI\");\r\n    }\r\n\r\n    /**\r\n     * Gets the field values for this list item in their HTML representation\r\n     *\r\n     */\r\n    public get fieldValuesAsHTML(): ISharePointQueryableInstance {\r\n        return tag.configure(SharePointQueryableInstance(this, \"FieldValuesAsHTML\"), \"i.fvHTML\");\r\n    }\r\n\r\n    /**\r\n     * Gets the field values for this list item in their text representation\r\n     *\r\n     */\r\n    public get fieldValuesAsText(): ISharePointQueryableInstance {\r\n        return tag.configure(SharePointQueryableInstance(this, \"FieldValuesAsText\"), \"i.fvText\");\r\n    }\r\n\r\n    /**\r\n     * Gets the field values for this list item for use in editing controls\r\n     *\r\n     */\r\n    public get fieldValuesForEdit(): ISharePointQueryableInstance {\r\n        return tag.configure(SharePointQueryableInstance(this, \"FieldValuesForEdit\"), \"i.fvEdit\");\r\n    }\r\n\r\n    /**\r\n     * Gets the collection of versions associated with this item\r\n     */\r\n    public get versions(): IItemVersions {\r\n        return tag.configure(ItemVersions(this), \"i.versions\");\r\n    }\r\n\r\n    public get list(): IList {\r\n        return this.getParent<IList>(List, this.parentUrl.substr(0, this.parentUrl.lastIndexOf(\"/\")));\r\n    }\r\n\r\n    /**\r\n     * Updates this list intance with the supplied properties\r\n     *\r\n     * @param properties A plain object hash of values to update for the list\r\n     * @param eTag Value used in the IF-Match header, by default \"*\"\r\n     * @param listItemEntityTypeFullName The type name of the list's entities\r\n     */\r\n    public async update(properties: ITypedHash<any>, eTag = \"*\", listItemEntityTypeFullName: string = null): Promise<IItemUpdateResult> {\r\n\r\n        const removeDependency = this.addBatchDependency();\r\n\r\n        const listItemEntityType = await this.ensureListItemEntityTypeName(listItemEntityTypeFullName);\r\n\r\n        const postBody = body(assign(metadata(listItemEntityType), properties), headers({\r\n            \"IF-Match\": eTag,\r\n            \"X-HTTP-Method\": \"MERGE\",\r\n        }));\r\n\r\n        removeDependency();\r\n\r\n        const poster = tag.configure(this.clone(Item).usingParser(new ItemUpdatedParser()), \"i.update\");\r\n        const data = await spPost(poster, postBody);\r\n\r\n        return {\r\n            data,\r\n            item: this,\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Moves the list item to the Recycle Bin and returns the identifier of the new Recycle Bin item.\r\n     */\r\n    @tag(\"i.recycle\")\r\n    public recycle(): Promise<string> {\r\n        return spPost<string>(this.clone(Item, \"recycle\"));\r\n    }\r\n\r\n    /**\r\n     * Deletes the item object with options.\r\n     * \r\n     * @param parameters Specifies the options to use when deleting a item.\r\n     */\r\n    @tag(\"i.del-params\")\r\n    public async deleteWithParams(parameters: Partial<IItemDeleteParams>): Promise<void> {\r\n        return spPost(this.clone(Item, \"DeleteWithParameters\"), body({ parameters }));\r\n    }\r\n\r\n    /**\r\n     * Gets a string representation of the full URL to the WOPI frame.\r\n     * If there is no associated WOPI application, or no associated action, an empty string is returned.\r\n     *\r\n     * @param action Display mode: 0: view, 1: edit, 2: mobileView, 3: interactivePreview\r\n     */\r\n    @tag(\"i.getWopiFrameUrl\")\r\n    public async getWopiFrameUrl(action = 0): Promise<string> {\r\n        const i = this.clone(Item, \"getWOPIFrameUrl(@action)\");\r\n        i.query.set(\"@action\", <any>action);\r\n\r\n        const data = await spPost(i);\r\n\r\n        // handle verbose mode\r\n        if (hOP(data, \"GetWOPIFrameUrl\")) {\r\n            return data.GetWOPIFrameUrl;\r\n        }\r\n\r\n        return data;\r\n    }\r\n\r\n    /**\r\n     * Validates and sets the values of the specified collection of fields for the list item.\r\n     *\r\n     * @param formValues The fields to change and their new values.\r\n     * @param bNewDocumentUpdate true if the list item is a document being updated after upload; otherwise false.\r\n     */\r\n    @tag(\"i.validateUpdateListItem\")\r\n    public validateUpdateListItem(formValues: IListItemFormUpdateValue[], bNewDocumentUpdate = false): Promise<IListItemFormUpdateValue[]> {\r\n        return spPost(this.clone(Item, \"validateupdatelistitem\"), body({ formValues, bNewDocumentUpdate }));\r\n    }\r\n\r\n    /**\r\n     * Gets the parent information for this item's list and web\r\n     */\r\n    public async getParentInfos(): Promise<IItemParentInfos> {\r\n\r\n        const urlInfo: any =\r\n            await this.select(\r\n                \"Id\",\r\n                \"ParentList/Id\",\r\n                \"ParentList/RootFolder/UniqueId\",\r\n                \"ParentList/RootFolder/ServerRelativeUrl\",\r\n                \"ParentList/RootFolder/ServerRelativePath\",\r\n                \"ParentList/ParentWeb/Id\",\r\n                \"ParentList/ParentWeb/Url\",\r\n                \"ParentList/ParentWeb/ServerRelativeUrl\",\r\n                \"ParentList/ParentWeb/ServerRelativePath\",\r\n            ).expand(\r\n                \"ParentList\",\r\n                \"ParentList/RootFolder\",\r\n                \"ParentList/ParentWeb\")();\r\n\r\n        return {\r\n            Item: {\r\n                Id: urlInfo.Id,\r\n            },\r\n            ParentList: {\r\n                Id: urlInfo.ParentList.Id,\r\n                RootFolderServerRelativePath: urlInfo.ParentList.RootFolder.ServerRelativePath,\r\n                RootFolderServerRelativeUrl: urlInfo.ParentList.RootFolder.ServerRelativeUrl,\r\n                RootFolderUniqueId: urlInfo.ParentList.RootFolder.UniqueId,\r\n            },\r\n            ParentWeb: {\r\n                Id: urlInfo.ParentList.ParentWeb.Id,\r\n                ServerRelativePath: urlInfo.ParentList.ParentWeb.ServerRelativePath,\r\n                ServerRelativeUrl: urlInfo.ParentList.ParentWeb.ServerRelativeUrl,\r\n                Url: urlInfo.ParentList.ParentWeb.Url,\r\n            },\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Ensures we have the proper list item entity type name, either from the value provided or from the list\r\n     *\r\n     * @param candidatelistItemEntityTypeFullName The potential type name\r\n     */\r\n    private ensureListItemEntityTypeName(candidatelistItemEntityTypeFullName: string): Promise<string> {\r\n\r\n        return candidatelistItemEntityTypeFullName ?\r\n            Promise.resolve(candidatelistItemEntityTypeFullName) :\r\n            this.list.getListItemEntityTypeFullName();\r\n    }\r\n}\r\nexport interface IItem extends _Item, IDeleteableWithETag { }\r\nexport const Item = spInvokableFactory<IItem>(_Item);\r\n\r\n/**\r\n * Describes a collection of Version objects\r\n *\r\n */\r\n@defaultPath(\"versions\")\r\nexport class _ItemVersions extends _SharePointQueryableCollection {\r\n    /**\t\r\n     * Gets a version by id\t\r\n     *\t\r\n     * @param versionId The id of the version to retrieve\t\r\n     */\r\n    public getById(versionId: number): IItemVersion {\r\n        return tag.configure(ItemVersion(this).concat(`(${versionId})`), \"iv.getById\");\r\n    }\r\n}\r\nexport interface IItemVersions extends _ItemVersions { }\r\nexport const ItemVersions = spInvokableFactory<IItemVersions>(_ItemVersions);\r\n\r\n/**\r\n * Describes a single Version instance\r\n *\r\n */\r\nexport class _ItemVersion extends _SharePointQueryableInstance {\r\n    public delete = deleteableWithETag(\"iv\");\r\n}\r\nexport interface IItemVersion extends _ItemVersion, IDeleteableWithETag { }\r\nexport const ItemVersion = spInvokableFactory<IItemVersion>(_ItemVersion);\r\n\r\n/**\r\n * Provides paging functionality for list items\r\n */\r\nexport class PagedItemCollection<T> {\r\n\r\n    constructor(private parent: _Items, private nextUrl: string, public results: T) { }\r\n\r\n    /**\r\n     * If true there are more results available in the set, otherwise there are not\r\n     */\r\n    public get hasNext(): boolean {\r\n        return typeof this.nextUrl === \"string\" && this.nextUrl.length > 0;\r\n    }\r\n\r\n    /**\r\n     * Gets the next set of results, or resolves to null if no results are available\r\n     */\r\n    public getNext(): Promise<PagedItemCollection<T>> {\r\n\r\n        if (this.hasNext) {\r\n            const items = tag.configure(<IItems>Items(this.nextUrl, null).configureFrom(this.parent), \"ip.getNext\");\r\n            return items.getPaged<T>();\r\n        }\r\n\r\n        return new Promise<any>(r => r(null));\r\n    }\r\n}\r\n\r\nclass PagedItemCollectionParser<T = any[]> extends ODataParser<PagedItemCollection<T>> {\r\n\r\n    constructor(private _parent: _Items) {\r\n        super();\r\n    }\r\n\r\n    public parse(r: Response): Promise<PagedItemCollection<T>> {\r\n\r\n        return new Promise((resolve, reject) => {\r\n\r\n            if (this.handleError(r, reject)) {\r\n                r.json().then(json => {\r\n                    const nextUrl = hOP(json, \"d\") && hOP(json.d, \"__next\") ? json.d.__next : json[\"odata.nextLink\"];\r\n                    resolve(new PagedItemCollection<T>(this._parent, nextUrl, this.parseODataJSON(json)));\r\n                });\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\nclass ItemUpdatedParser extends ODataParser<IItemUpdateResultData> {\r\n    public parse(r: Response): Promise<IItemUpdateResultData> {\r\n\r\n        return new Promise<IItemUpdateResultData>((resolve, reject) => {\r\n\r\n            if (this.handleError(r, reject)) {\r\n                resolve({\r\n                    \"odata.etag\": r.headers.get(\"etag\"),\r\n                });\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\nexport interface IItemAddResult {\r\n    item: IItem;\r\n    data: any;\r\n}\r\n\r\nexport interface IItemUpdateResult {\r\n    item: IItem;\r\n    data: IItemUpdateResultData;\r\n}\r\n\r\nexport interface IItemUpdateResultData {\r\n    \"odata.etag\": string;\r\n}\r\n\r\nexport interface IItemDeleteParams {\r\n\r\n    /**\r\n     * If true, delete or recycle a file when the LockType \r\n     * value is SPLockType.Shared or SPLockType.None.\r\n     * When false, delete or recycle the file when\r\n     * the LockType value SPLockType.None.\r\n     */\r\n    BypassSharedLock: boolean;\r\n}\r\n\r\nexport interface IItemParentInfos {\r\n    Item: {\r\n        Id: string;\r\n    };\r\n    ParentList: {\r\n        Id: string;\r\n        RootFolderServerRelativePath: IResourcePath;\r\n        RootFolderServerRelativeUrl: string;\r\n        RootFolderUniqueId: string;\r\n    };\r\n    ParentWeb: {\r\n        Id: string;\r\n        ServerRelativePath: IResourcePath;\r\n        ServerRelativeUrl: string;\r\n        Url: string;\r\n    };\r\n}\r\n","/**\r\n * Class used to subscribe ILogListener and log messages throughout an application\r\n *\r\n */\r\nexport class Logger {\r\n\r\n  private static _instance: LoggerImpl;\r\n\r\n  /**\r\n   * Gets or sets the active log level to apply for log filtering\r\n   */\r\n  public static get activeLogLevel(): LogLevel {\r\n    return Logger.instance.activeLogLevel;\r\n  }\r\n\r\n  public static set activeLogLevel(value: LogLevel) {\r\n    Logger.instance.activeLogLevel = value;\r\n  }\r\n\r\n  private static get instance(): LoggerImpl {\r\n    if (Logger._instance === undefined || Logger._instance === null) {\r\n      Logger._instance = new LoggerImpl();\r\n    }\r\n    return Logger._instance;\r\n  }\r\n\r\n  /**\r\n   * Adds ILogListener instances to the set of subscribed listeners\r\n   *\r\n   * @param listeners One or more listeners to subscribe to this log\r\n   */\r\n  public static subscribe(...listeners: ILogListener[]): void {\r\n    listeners.forEach(listener => Logger.instance.subscribe(listener));\r\n  }\r\n\r\n  /**\r\n   * Clears the subscribers collection, returning the collection before modification\r\n   */\r\n  public static clearSubscribers(): ILogListener[] {\r\n    return Logger.instance.clearSubscribers();\r\n  }\r\n\r\n  /**\r\n   * Gets the current subscriber count\r\n   */\r\n  public static get count(): number {\r\n    return Logger.instance.count;\r\n  }\r\n\r\n  /**\r\n   * Writes the supplied string to the subscribed listeners\r\n   *\r\n   * @param message The message to write\r\n   * @param level [Optional] if supplied will be used as the level of the entry (Default: LogLevel.Info)\r\n   */\r\n  public static write(message: string, level: LogLevel = LogLevel.Info) {\r\n    Logger.instance.log({ level: level, message: message });\r\n  }\r\n\r\n  /**\r\n   * Writes the supplied string to the subscribed listeners\r\n   *\r\n   * @param json The json object to stringify and write\r\n   * @param level [Optional] if supplied will be used as the level of the entry (Default: LogLevel.Info)\r\n   */\r\n  public static writeJSON(json: any, level: LogLevel = LogLevel.Info) {\r\n    this.write(JSON.stringify(json), level);\r\n  }\r\n\r\n  /**\r\n   * Logs the supplied entry to the subscribed listeners\r\n   *\r\n   * @param entry The message to log\r\n   */\r\n  public static log(entry: ILogEntry) {\r\n    Logger.instance.log(entry);\r\n  }\r\n\r\n  /**\r\n   * Logs an error object to the subscribed listeners\r\n   * \r\n   * @param err The error object\r\n   */\r\n  public static error(err: Error) {\r\n    Logger.instance.log({ data: err, level: LogLevel.Error, message: err.message });\r\n  }\r\n}\r\n\r\nclass LoggerImpl {\r\n\r\n  constructor(public activeLogLevel: LogLevel = LogLevel.Warning, private subscribers: ILogListener[] = []) { }\r\n\r\n  public subscribe(listener: ILogListener): void {\r\n    this.subscribers.push(listener);\r\n  }\r\n\r\n  public clearSubscribers(): ILogListener[] {\r\n    const s = this.subscribers.slice(0);\r\n    this.subscribers.length = 0;\r\n    return s;\r\n  }\r\n\r\n  public get count(): number {\r\n    return this.subscribers.length;\r\n  }\r\n\r\n  public write(message: string, level: LogLevel = LogLevel.Info) {\r\n    this.log({ level: level, message: message });\r\n  }\r\n\r\n  public log(entry: ILogEntry) {\r\n    if (entry !== undefined && this.activeLogLevel <= entry.level) {\r\n      this.subscribers.map(subscriber => subscriber.log(entry));\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * A set of logging levels\r\n */\r\nexport const enum LogLevel {\r\n  Verbose = 0,\r\n  Info = 1,\r\n  Warning = 2,\r\n  Error = 3,\r\n  Off = 99,\r\n}\r\n\r\n/**\r\n * Interface that defines a log entry\r\n *\r\n */\r\nexport interface ILogEntry {\r\n  /**\r\n   * The main message to be logged\r\n   */\r\n  message: string;\r\n  /**\r\n   * The level of information this message represents\r\n   */\r\n  level: LogLevel;\r\n  /**\r\n   * Any associated data that a given logging listener may choose to log or ignore\r\n   */\r\n  data?: any;\r\n}\r\n\r\n/**\r\n * Interface that defines a log listener\r\n *\r\n */\r\nexport interface ILogListener {\r\n  /**\r\n   * Any associated data that a given logging listener may choose to log or ignore\r\n   *\r\n   * @param entry The information to be logged\r\n   */\r\n  log(entry: ILogEntry): void;\r\n}\r\n","import { ILogEntry, LogLevel, ILogListener } from \"./logger\";\r\n\r\n/**\r\n * Implementation of LogListener which logs to the console\r\n *\r\n */\r\nexport class ConsoleListener implements ILogListener {\r\n\r\n    /**\r\n     * Any associated data that a given logging listener may choose to log or ignore\r\n     *\r\n     * @param entry The information to be logged\r\n     */\r\n    public log(entry: ILogEntry): void {\r\n\r\n        const msg = this.format(entry);\r\n\r\n        switch (entry.level) {\r\n            case LogLevel.Verbose:\r\n            case LogLevel.Info:\r\n                console.log(msg);\r\n                break;\r\n            case LogLevel.Warning:\r\n                console.warn(msg);\r\n                break;\r\n            case LogLevel.Error:\r\n                console.error(msg);\r\n                break;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Formats the message\r\n     *\r\n     * @param entry The information to format into a string\r\n     */\r\n    private format(entry: ILogEntry): string {\r\n        const msg = [];\r\n        msg.push(\"Message: \" + entry.message);\r\n        if (entry.data !== undefined) {\r\n            try {\r\n                msg.push(\" Data: \" + JSON.stringify(entry.data));\r\n            } catch (e) {\r\n                msg.push(` Data: Error in stringify of supplied data ${e}`);\r\n            }\r\n        }\r\n\r\n        return msg.join(\"\");\r\n    }\r\n}\r\n\r\n/**\r\n * Implementation of LogListener which logs to the supplied function\r\n *\r\n */\r\nexport class FunctionListener implements ILogListener {\r\n\r\n    /**\r\n     * Creates a new instance of the FunctionListener class\r\n     *\r\n     * @constructor\r\n     * @param  method The method to which any logging data will be passed\r\n     */\r\n    constructor(private method: (entry: ILogEntry) => void) { }\r\n\r\n    /**\r\n     * Any associated data that a given logging listener may choose to log or ignore\r\n     *\r\n     * @param entry The information to be logged\r\n     */\r\n    public log(entry: ILogEntry): void {\r\n        this.method(entry);\r\n    }\r\n}\r\n","import { stringIsNullOrEmpty } from \"@pnp/common\";\r\n\r\nexport function extractWebUrl(candidateUrl: string): string {\r\n\r\n    if (stringIsNullOrEmpty(candidateUrl)) {\r\n        return \"\";\r\n    }\r\n\r\n    let index = candidateUrl.indexOf(\"_api/\");\r\n\r\n    if (index < 0) {\r\n        index = candidateUrl.indexOf(\"_vti_bin/\");\r\n    }\r\n\r\n    if (index > -1) {\r\n        return candidateUrl.substr(0, index);\r\n    }\r\n\r\n    // if all else fails just give them what they gave us back\r\n    return candidateUrl;\r\n}\r\n","import { ISPInvokableFactory } from \"./sharepointqueryable\";\r\nimport { assign, combine, hOP, isUrlAbsolute } from \"@pnp/common\";\r\nimport { Logger, LogLevel } from \"@pnp/logging\";\r\nimport { ODataParser } from \"@pnp/odata\";\r\nimport { extractWebUrl } from \"./utils/extractweburl\";\r\n\r\nexport function odataUrlFrom(candidate: any): string {\r\n\r\n    const parts: string[] = [];\r\n    const s = [\"odata.type\", \"odata.editLink\", \"__metadata\", \"odata.metadata\", \"odata.id\"];\r\n\r\n    if (hOP(candidate, s[0]) && candidate[s[0]] === \"SP.Web\") {\r\n\r\n        // webs return an absolute url in the id\r\n        if (hOP(candidate, s[4])) {\r\n            parts.push(candidate[s[4]]);\r\n        } else if (hOP(candidate, s[2])) {\r\n            // we are dealing with verbose, which has an absolute uri\r\n            parts.push(candidate.__metadata.uri);\r\n        }\r\n\r\n    } else {\r\n\r\n        if (hOP(candidate, s[3]) && hOP(candidate, s[1])) {\r\n            // we are dealign with minimal metadata (default)\r\n\r\n            // some entities return an abosolute url in the editlink while for others it is relative\r\n            // without the _api. This code is meant to handle both situations\r\n            const editLink = isUrlAbsolute(candidate[s[1]]) ? candidate[s[1]].split(\"_api\")[1] : candidate[s[1]];\r\n\r\n            parts.push(extractWebUrl(candidate[s[3]]), \"_api\", editLink);\r\n        } else if (hOP(candidate, s[1])) {\r\n            parts.push(\"_api\", candidate[s[1]]);\r\n        } else if (hOP(candidate, s[2])) {\r\n            // we are dealing with verbose, which has an absolute uri\r\n            parts.push(candidate.__metadata.uri);\r\n        }\r\n    }\r\n\r\n    if (parts.length < 1) {\r\n        Logger.write(\"No uri information found in ODataEntity parsing, chaining will fail for this object.\", LogLevel.Warning);\r\n        return \"\";\r\n    }\r\n\r\n    return combine(...parts);\r\n}\r\n\r\nclass SPODataEntityParserImpl<T, D> extends ODataParser<T & D> {\r\n\r\n    constructor(protected factory: ISPInvokableFactory<any>) {\r\n        super();\r\n    }\r\n\r\n    public hydrate = (d: D) => {\r\n        const o = this.factory(odataUrlFrom(d), null);\r\n        return assign(o, d);\r\n    }\r\n\r\n    public parse(r: Response): Promise<T & D> {\r\n        return super.parse(r).then((d: any) => {\r\n            const o = this.factory(odataUrlFrom(d), null);\r\n            return assign<T, D>(o, d);\r\n        });\r\n    }\r\n}\r\n\r\nclass SPODataEntityArrayParserImpl<T, D> extends ODataParser<(T & D)[]> {\r\n\r\n    constructor(protected factory: ISPInvokableFactory<T>) {\r\n        super();\r\n    }\r\n\r\n    public hydrate = (d: D[]) => {\r\n        return d.map(v => {\r\n            const o = this.factory(odataUrlFrom(v), null);\r\n            return assign(o, v);\r\n        });\r\n    }\r\n\r\n    public parse(r: Response): Promise<(T & D)[]> {\r\n        return super.parse(r).then((d: D[]) => {\r\n            return d.map(v => {\r\n                const o = this.factory(odataUrlFrom(v), null);\r\n                return assign(o, v);\r\n            });\r\n        });\r\n    }\r\n}\r\n\r\nexport function spODataEntity<T, DataType = any>(factory: ISPInvokableFactory<T>): ODataParser<T & DataType> {\r\n    return new SPODataEntityParserImpl<T, DataType>(factory);\r\n}\r\n\r\nexport function spODataEntityArray<T, DataType = any>(factory: ISPInvokableFactory<T>): ODataParser<(T & DataType)[]> {\r\n    return new SPODataEntityArrayParserImpl<T, DataType>(factory);\r\n}\r\n","import { IConfigOptions, ISPFXContext } from \"@pnp/common\";\r\nimport {\r\n    setup as _setup,\r\n    ISPConfiguration,\r\n} from \"./splibconfig\";\r\n\r\n/**\r\n * Root of the SharePoint REST module\r\n */\r\nexport class SPRest {\r\n\r\n    /** \r\n     * Creates a new instance of the SPRest class\r\n     * \r\n     * @param options Additional options\r\n     * @param baseUrl A string that should form the base part of the url\r\n     */\r\n    constructor(protected _options: IConfigOptions = {}, protected _baseUrl = \"\") { }\r\n\r\n    /**\r\n     * Configures instance with additional options and baseUrl.\r\n     * Provided configuration used by other objects in a chain\r\n     * \r\n     * @param options Additional options\r\n     * @param baseUrl A string that should form the base part of the url\r\n     */\r\n    public configure(options: IConfigOptions, baseUrl = \"\"): SPRest {\r\n        return new SPRest(options, baseUrl);\r\n    }\r\n\r\n    /**\r\n     * Global SharePoint configuration options\r\n     * \r\n     * @param config The SharePoint configuration to apply\r\n     */\r\n    public setup(config: ISPConfiguration | ISPFXContext) {\r\n\r\n        if ((<ISPFXContext>config).pageContext) {\r\n            _setup({\r\n                spfxContext: <ISPFXContext>config,\r\n            });\r\n        } else {\r\n            _setup(<ISPConfiguration>config);\r\n        }\r\n    }\r\n}\r\n\r\nexport const sp = new SPRest();\r\n","import { SharePointQueryable, _SharePointQueryableInstance, spInvokableFactory } from \"../sharepointqueryable\";\r\nimport { defaultPath } from \"../decorators\";\r\nimport { Web, IWeb } from \"../webs/types\";\r\nimport { hOP, assign } from \"@pnp/common\";\r\nimport { body } from \"@pnp/odata\";\r\nimport { odataUrlFrom } from \"../odata\";\r\nimport { spPost } from \"../operations\";\r\nimport { SPBatch } from \"../batch\";\r\nimport { escapeQueryStrValue } from \"../utils/escapeQueryStrValue\";\r\nimport { IChangeQuery } from \"../types\";\r\nimport { tag } from \"../telemetry\";\r\nimport { metadata } from \"../utils/metadata\";\r\nimport { extractWebUrl } from \"../utils/extractweburl\";\r\nimport { emptyGuid } from \"../splibconfig\";\r\n\r\n@defaultPath(\"_api/site\")\r\nexport class _Site extends _SharePointQueryableInstance {\r\n\r\n  /**\r\n  * Gets the root web of the site collection\r\n  *\r\n  */\r\n  public get rootWeb(): IWeb {\r\n    return tag.configure(Web(this, \"rootweb\"), \"si.rootWeb\");\r\n  }\r\n\r\n  /**\r\n   * Gets a Web instance representing the root web of the site collection\r\n   * correctly setup for chaining within the library\r\n   */\r\n  public async getRootWeb(): Promise<IWeb> {\r\n    const web = await this.rootWeb.select(\"Url\")<{ Url: string }>();\r\n    return tag.configure(Web(web.Url), \"si.getRootWeb\");\r\n  }\r\n\r\n  /**\r\n  * Gets the context information for this site collection\r\n  */\r\n  public async getContextInfo(): Promise<IContextInfo> {\r\n\r\n    const q = tag.configure(Site(this.parentUrl, \"_api/contextinfo\"), \"si.getContextInfo\");\r\n    const data = await spPost(q);\r\n\r\n    if (hOP(data, \"GetContextWebInformation\")) {\r\n      const info = data.GetContextWebInformation;\r\n      info.SupportedSchemaVersions = info.SupportedSchemaVersions.results;\r\n      return info;\r\n    } else {\r\n      return data;\r\n    }\r\n  }\r\n\r\n  public createBatch(): SPBatch {\r\n    return new SPBatch(this.parentUrl);\r\n  }\r\n\r\n  /**\r\n  * Deletes the current site\r\n  *\r\n  */\r\n  public async delete(): Promise<void> {\r\n\r\n    const site = await this.clone(Site, \"\").select(\"Id\")<{ Id: string }>();\r\n    const q = tag.configure(Site(this.parentUrl, \"_api/SPSiteManager/Delete\"), \"si.delete\");\r\n    await spPost(q, body({ siteId: site.Id }));\r\n  }\r\n\r\n  /**\r\n   * Gets the document libraries on a site. Static method. (SharePoint Online only)\r\n   *\r\n   * @param absoluteWebUrl The absolute url of the web whose document libraries should be returned\r\n   */\r\n  public async getDocumentLibraries(absoluteWebUrl: string): Promise<IDocumentLibraryInformation[]> {\r\n\r\n    const q = tag.configure(SharePointQueryable(\"\", \"_api/sp.web.getdocumentlibraries(@v)\"), \"si.getDocumentLibraries\");\r\n    q.query.set(\"@v\", `'${escapeQueryStrValue(absoluteWebUrl)}'`);\r\n    const data = await q();\r\n    return hOP(data, \"GetDocumentLibraries\") ? data.GetDocumentLibraries : data;\r\n  }\r\n\r\n  /**\r\n   * Gets the site url from a page url\r\n   *\r\n   * @param absolutePageUrl The absolute url of the page\r\n   */\r\n  public async getWebUrlFromPageUrl(absolutePageUrl: string): Promise<string> {\r\n\r\n    const q = tag.configure(SharePointQueryable(\"\", \"_api/sp.web.getweburlfrompageurl(@v)\"), \"si.getWebUrlFromPageUrl\");\r\n    q.query.set(\"@v\", `'${escapeQueryStrValue(absolutePageUrl)}'`);\r\n    const data = await q();\r\n    return hOP(data, \"GetWebUrlFromPageUrl\") ? data.GetWebUrlFromPageUrl : data;\r\n  }\r\n\r\n  /**\r\n   * Returns the collection of changes from the change log that have occurred within the list, based on the specified query\r\n   *\r\n   * @param query The change query\r\n   */\r\n  @tag(\"si.getChanges\")\r\n  public getChanges(query: IChangeQuery): Promise<any> {\r\n\r\n    const postBody = body({ \"query\": assign(metadata(\"SP.ChangeQuery\"), query) });\r\n    return spPost(this.clone(Web, \"getchanges\"), postBody);\r\n  }\r\n\r\n  /**\r\n  * Opens a web by id (using POST)\r\n  *\r\n  * @param webId The GUID id of the web to open\r\n  */\r\n  @tag(\"si.openWebById\")\r\n  public async openWebById(webId: string): Promise<IOpenWebByIdResult> {\r\n\r\n    const data = await spPost(this.clone(Site, `openWebById('${webId}')`));\r\n    return {\r\n      data,\r\n      web: Web(extractWebUrl(odataUrlFrom(data))),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Creates a Modern communication site.\r\n   * \r\n   * @param title The title of the site to create\r\n   * @param lcid The language to use for the site. If not specified will default to 1033 (English).\r\n   * @param shareByEmailEnabled If set to true, it will enable sharing files via Email. By default it is set to false\r\n   * @param url The fully qualified URL (e.g. https://yourtenant.sharepoint.com/sites/mysitecollection) of the site.\r\n   * @param description The description of the communication site.\r\n   * @param classification The Site classification to use. For instance 'Contoso Classified'. See https://www.youtube.com/watch?v=E-8Z2ggHcS0 for more information\r\n   * @param siteDesignId The Guid of the site design to be used.\r\n   *                     You can use the below default OOTB GUIDs:\r\n   *                     Topic: 00000000-0000-0000-0000-000000000000\r\n   *                     Showcase: 6142d2a0-63a5-4ba0-aede-d9fefca2c767\r\n   *                     Blank: f6cc5403-0d63-442e-96c0-285923709ffc \r\n   * @param hubSiteId The id of the hub site to which the new site should be associated\r\n   * @param owner Optional owner value, required if executing the method in app only mode\r\n   */\r\n  public async createCommunicationSite(\r\n    title: string,\r\n    lcid = 1033,\r\n    shareByEmailEnabled = false,\r\n    url: string,\r\n    description?: string,\r\n    classification?: string,\r\n    siteDesignId?: string,\r\n    hubSiteId?: string,\r\n    owner?: string,\r\n  ): Promise<ISiteCreationResponse> {\r\n\r\n    return this.createCommunicationSiteFromProps({\r\n      Classification: classification,\r\n      Description: description,\r\n      HubSiteId: hubSiteId,\r\n      Lcid: lcid,\r\n      Owner: owner,\r\n      ShareByEmailEnabled: shareByEmailEnabled,\r\n      SiteDesignId: siteDesignId,\r\n      Title: title,\r\n      Url: url,\r\n    });\r\n  }\r\n\r\n  public async createCommunicationSiteFromProps(props: ICreateCommSiteProps): Promise<ISiteCreationResponse> {\r\n\r\n    // handle defaults\r\n    const p = Object.assign({}, {\r\n      Classification: \"\",\r\n      Description: \"\",\r\n      HubSiteId: emptyGuid,\r\n      Lcid: 1033,\r\n      ShareByEmailEnabled: false,\r\n      SiteDesignId: emptyGuid,\r\n      WebTemplate: \"SITEPAGEPUBLISHING#0\",\r\n      WebTemplateExtensionId: emptyGuid,\r\n    }, props);\r\n\r\n    const postBody = body({\r\n      \"request\": assign(metadata(\"Microsoft.SharePoint.Portal.SPSiteCreationRequest\"), p),\r\n    });\r\n\r\n    return spPost(Site(extractWebUrl(this.toUrl()), \"/_api/SPSiteManager/Create\"), postBody);\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param url Site Url that you want to check if exists\r\n   */\r\n  public async exists(url: string): Promise<boolean> {\r\n    const postBody = body({ url });\r\n\r\n    const value = await spPost(Site(extractWebUrl(this.toUrl()), \"/_api/SP.Site.Exists\"), postBody);\r\n\r\n    return value;\r\n  }\r\n\r\n  /**\r\n  * Creates a Modern team site backed by Office 365 group. For use in SP Online only. This will not work with App-only tokens\r\n  * \r\n  * @param displayName The title or display name of the Modern team site to be created\r\n  * @param alias Alias of the underlying Office 365 Group\r\n  * @param isPublic Defines whether the Office 365 Group will be public (default), or private.\r\n  * @param lcid The language to use for the site. If not specified will default to English (1033).\r\n  * @param description The description of the site to be created.\r\n  * @param classification The Site classification to use. For instance 'Contoso Classified'. See https://www.youtube.com/watch?v=E-8Z2ggHcS0 for more information\r\n  * @param owners The Owners of the site to be created     \r\n  */\r\n  public async createModernTeamSite(\r\n    displayName: string,\r\n    alias: string,\r\n    isPublic?: boolean,\r\n    lcid?: number,\r\n    description?: string,\r\n    classification?: string,\r\n    owners?: string[],\r\n    hubSiteId?: string,\r\n    siteDesignId?: string,\r\n  ): Promise<ISiteCreationResponse> {\r\n\r\n    return this.createModernTeamSiteFromProps({\r\n      alias,\r\n      classification,\r\n      description,\r\n      displayName,\r\n      hubSiteId,\r\n      isPublic,\r\n      lcid,\r\n      owners,\r\n      siteDesignId,\r\n    });\r\n  }\r\n\r\n  public async createModernTeamSiteFromProps(props: ICreateTeamSiteProps): Promise<ISiteCreationResponse> {\r\n\r\n    // handle defaults\r\n    const p = Object.assign({}, {\r\n      classification: \"\",\r\n      description: \"\",\r\n      hubSiteId: emptyGuid,\r\n      isPublic: true,\r\n      lcid: 1033,\r\n      owners: [],\r\n    }, props);\r\n\r\n    const postBody = {\r\n      alias: p.alias,\r\n      displayName: p.displayName,\r\n      isPublic: p.isPublic,\r\n      optionalParams: {\r\n        Classification: p.classification,\r\n        CreationOptions: {\r\n          \"results\": [`SPSiteLanguage:${p.lcid}`, `HubSiteId:${p.hubSiteId}`],\r\n        },\r\n        Description: p.description,\r\n        Owners: {\r\n          \"results\": p.owners,\r\n        },\r\n      },\r\n    };\r\n\r\n    if (p.siteDesignId) {\r\n      postBody.optionalParams.CreationOptions.results.push(`implicit_formula_292aa8a00786498a87a5ca52d9f4214a_${p.siteDesignId}`);\r\n    }\r\n\r\n    return spPost(Site(extractWebUrl(this.toUrl()), \"/_api/GroupSiteManager/CreateGroupEx\"), body(postBody));\r\n  }\r\n}\r\nexport interface ISite extends _Site { }\r\nexport const Site = spInvokableFactory<ISite>(_Site);\r\n\r\n/**\r\n * The result of opening a web by id: contains the data returned as well as a chainable web instance\r\n */\r\nexport interface IOpenWebByIdResult {\r\n  data: any;\r\n  web: IWeb;\r\n}\r\n\r\n/**\r\n * This is the interface to expose data i.e. context information of a site\r\n */\r\nexport interface IContextInfo {\r\n  FormDigestTimeoutSeconds?: number;\r\n  FormDigestValue?: number;\r\n  LibraryVersion?: string;\r\n  SiteFullUrl?: string;\r\n  SupportedSchemaVersions?: string[];\r\n  WebFullUrl?: string;\r\n}\r\n\r\n/**\r\n * This is the interface to expose data for Document Library\r\n */\r\nexport interface IDocumentLibraryInformation {\r\n  AbsoluteUrl?: string;\r\n  Modified?: Date;\r\n  ModifiedFriendlyDisplay?: string;\r\n  ServerRelativeUrl?: string;\r\n  Title?: string;\r\n}\r\n\r\nexport interface ICreateCommSiteProps {\r\n  Classification?: string;\r\n  Description?: string;\r\n  HubSiteId?: string;\r\n  Lcid?: number;\r\n  Owner?: string;\r\n  ShareByEmailEnabled?: boolean;\r\n  SiteDesignId?: string;\r\n  Title: string;\r\n  Url: string;\r\n  WebTemplate?: \"SITEPAGEPUBLISHING#0\" | \"STS#3\";\r\n  WebTemplateExtensionId?: string;\r\n}\r\n\r\nexport interface ICreateTeamSiteProps {\r\n  displayName: string;\r\n  alias: string;\r\n  isPublic?: boolean;\r\n  lcid?: number;\r\n  description?: string;\r\n  classification?: string;\r\n  owners?: string[];\r\n  hubSiteId?: string;\r\n  siteDesignId?: string;\r\n}\r\n\r\nexport interface ISiteCreationResponse {\r\n  \"SiteId\": string;\r\n  \"SiteStatus\": 0 | 1 | 2 | 3;\r\n  \"SiteUrl\": string;\r\n}\r\n","import {\r\n    ILibraryConfiguration,\r\n    ITypedHash,\r\n    RuntimeConfig,\r\n    IHttpClientImpl,\r\n    FetchClient,\r\n    objectDefinedNotNull,\r\n} from \"@pnp/common\";\r\n\r\nexport const emptyGuid = \"00000000-0000-0000-0000-000000000000\";\r\n\r\nexport interface ISPConfigurationPart {\r\n    sp?: {\r\n        /**\r\n         * Any headers to apply to all requests\r\n         */\r\n        headers?: ITypedHash<string>;\r\n\r\n        /**\r\n         * The base url used for all requests\r\n         */\r\n        baseUrl?: string;\r\n\r\n        /**\r\n         * Defines a factory method used to create fetch clients\r\n         */\r\n        fetchClientFactory?: () => IHttpClientImpl;\r\n    };\r\n}\r\n\r\nexport interface ISPConfiguration extends ILibraryConfiguration, ISPConfigurationPart { }\r\n\r\nexport function setup(config: ISPConfiguration): void {\r\n    RuntimeConfig.assign(config);\r\n}\r\n\r\nexport class SPRuntimeConfigImpl {\r\n\r\n    public get headers(): ITypedHash<string> {\r\n\r\n        const spPart = RuntimeConfig.get(\"sp\");\r\n        if (spPart !== undefined && spPart.headers !== undefined) {\r\n            return spPart.headers;\r\n        }\r\n\r\n        return {};\r\n    }\r\n\r\n    public get baseUrl(): string | null {\r\n\r\n        const spPart = RuntimeConfig.get(\"sp\");\r\n        if (spPart !== undefined && spPart.baseUrl !== undefined) {\r\n            return spPart.baseUrl;\r\n        }\r\n\r\n        if (objectDefinedNotNull(RuntimeConfig.spfxContext)) {\r\n            return RuntimeConfig.spfxContext.pageContext.web.absoluteUrl;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    public get fetchClientFactory(): () => IHttpClientImpl {\r\n\r\n        const spPart = RuntimeConfig.get(\"sp\");\r\n        if (spPart !== undefined && spPart.fetchClientFactory !== undefined) {\r\n            return spPart.fetchClientFactory;\r\n        } else {\r\n            return () => new FetchClient();\r\n        }\r\n    }\r\n}\r\n\r\nexport let SPRuntimeConfig = new SPRuntimeConfigImpl();\r\n","import { _GraphQueryable } from \"./graphqueryable\";\r\nimport {\r\n    setup as _setup,\r\n    IGraphConfiguration,\r\n} from \"./graphlibconfig\";\r\nimport { GraphBatch } from \"./batch\";\r\nimport { ISPFXContext } from \"@pnp/common\";\r\n\r\nexport class GraphRest extends _GraphQueryable {\r\n\r\n    public createBatch(): GraphBatch {\r\n        return new GraphBatch();\r\n    }\r\n\r\n    public setup(config: IGraphConfiguration | ISPFXContext) {\r\n\r\n        if ((<ISPFXContext>config).pageContext) {\r\n            _setup({\r\n                spfxContext: <ISPFXContext>config,\r\n            });\r\n        } else {\r\n            _setup(<IGraphConfiguration>config);\r\n        }\r\n    }\r\n}\r\n\r\nexport let graph = new GraphRest(\"v1.0\");\r\n","import { ITypedHash } from \"./collections\";\r\n\r\n/**\r\n * Gets a callback function which will maintain context across async calls.\r\n * Allows for the calling pattern getCtxCallback(thisobj, method, methodarg1, methodarg2, ...)\r\n *\r\n * @param context The object that will be the 'this' value in the callback\r\n * @param method The method to which we will apply the context and parameters\r\n * @param params Optional, additional arguments to supply to the wrapped method when it is invoked\r\n */\r\nexport function getCtxCallback(context: any, method: Function, ...params: any[]): Function {\r\n    return function () {\r\n        method.apply(context, params);\r\n    };\r\n}\r\n\r\nexport type DateAddInterval = \"year\" | \"quarter\" | \"month\" | \"week\" | \"day\" | \"hour\" | \"minute\" | \"second\";\r\n\r\n/**\r\n * Adds a value to a date\r\n *\r\n * @param date The date to which we will add units, done in local time\r\n * @param interval The name of the interval to add, one of: ['year', 'quarter', 'month', 'week', 'day', 'hour', 'minute', 'second']\r\n * @param units The amount to add to date of the given interval\r\n *\r\n * http://stackoverflow.com/questions/1197928/how-to-add-30-minutes-to-a-javascript-date-object\r\n */\r\nexport function dateAdd(date: Date, interval: DateAddInterval, units: number): Date | undefined {\r\n    let ret: Date | undefined = new Date(date.toString()); // don't change original date\r\n    switch (interval.toLowerCase()) {\r\n        case \"year\": ret.setFullYear(ret.getFullYear() + units); break;\r\n        case \"quarter\": ret.setMonth(ret.getMonth() + 3 * units); break;\r\n        case \"month\": ret.setMonth(ret.getMonth() + units); break;\r\n        case \"week\": ret.setDate(ret.getDate() + 7 * units); break;\r\n        case \"day\": ret.setDate(ret.getDate() + units); break;\r\n        case \"hour\": ret.setTime(ret.getTime() + units * 3600000); break;\r\n        case \"minute\": ret.setTime(ret.getTime() + units * 60000); break;\r\n        case \"second\": ret.setTime(ret.getTime() + units * 1000); break;\r\n        default: ret = undefined; break;\r\n    }\r\n    return ret;\r\n}\r\n\r\n/**\r\n * Combines an arbitrary set of paths ensuring and normalizes the slashes\r\n *\r\n * @param paths 0 to n path parts to combine\r\n */\r\nexport function combine(...paths: string[]): string {\r\n\r\n    return paths\r\n        .filter(path => !stringIsNullOrEmpty(path))\r\n        .map(path => path.replace(/^[\\\\|\\/]/, \"\").replace(/[\\\\|\\/]$/, \"\"))\r\n        .join(\"/\")\r\n        .replace(/\\\\/g, \"/\");\r\n}\r\n\r\n/**\r\n * Gets a random string of chars length\r\n * \r\n * https://stackoverflow.com/questions/1349404/generate-random-string-characters-in-javascript\r\n *\r\n * @param chars The length of the random string to generate\r\n */\r\nexport function getRandomString(chars: number): string {\r\n    const text = new Array(chars);\r\n    for (let i = 0; i < chars; i++) {\r\n        text[i] = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\".charAt(Math.floor(Math.random() * 62));\r\n    }\r\n    return text.join(\"\");\r\n}\r\n\r\n/**\r\n * Gets a random GUID value\r\n *\r\n * http://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\r\n */\r\n/* tslint:disable no-bitwise */\r\nexport function getGUID(): string {\r\n    let d = Date.now();\r\n    return \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g, function (c) {\r\n        const r = (d + Math.random() * 16) % 16 | 0;\r\n        d = Math.floor(d / 16);\r\n        return (c === \"x\" ? r : (r & 0x3 | 0x8)).toString(16);\r\n    });\r\n}\r\n/* tslint:enable */\r\n\r\n/**\r\n * Determines if a given value is a function\r\n *\r\n * @param cf The thing to test for functionness\r\n */\r\nexport function isFunc(f: any): boolean {\r\n    return typeof f === \"function\";\r\n}\r\n\r\n/**\r\n * Determines if an object is both defined and not null\r\n * @param obj Object to test\r\n */\r\nexport function objectDefinedNotNull(obj: any): boolean {\r\n    return typeof obj !== \"undefined\" && obj !== null;\r\n}\r\n\r\n/**\r\n * @returns whether the provided parameter is a JavaScript Array or not.\r\n*/\r\nexport function isArray(array: any): boolean {\r\n\r\n    return Array.isArray ? Array.isArray(array) : array && typeof array.length === \"number\" && array.constructor === Array;\r\n}\r\n\r\n/**\r\n * Provides functionality to extend the given object by doing a shallow copy\r\n *\r\n * @param target The object to which properties will be copied\r\n * @param source The source object from which properties will be copied\r\n * @param noOverwrite If true existing properties on the target are not overwritten from the source\r\n * @param filter If provided allows additional filtering on what properties are copied (propName: string) => boolean\r\n *\r\n */\r\nexport function assign<T extends ITypedHash<any> = any, S extends ITypedHash<any> = any>(target: T, source: S, noOverwrite = false,\r\n    filter: (propName: string) => boolean = () => true): T & S {\r\n\r\n    if (!objectDefinedNotNull(source)) {\r\n        return <T & S>target;\r\n    }\r\n\r\n    // ensure we don't overwrite things we don't want overwritten\r\n    const check: (o: any, i: string) => Boolean = noOverwrite ? (o, i) => !(i in o) : () => true;\r\n\r\n    // final filter we will use\r\n    const f = (v: string) => check(target, v) && filter(v);\r\n\r\n    return Object.getOwnPropertyNames(source)\r\n        .filter(f)\r\n        .reduce((t: any, v: string) => {\r\n            t[v] = source[v];\r\n            return t;\r\n        }, target);\r\n}\r\n\r\n/**\r\n * Determines if a given url is absolute\r\n *\r\n * @param url The url to check to see if it is absolute\r\n */\r\nexport function isUrlAbsolute(url: string): boolean {\r\n    return /^https?:\\/\\/|^\\/\\//i.test(url);\r\n}\r\n\r\n/**\r\n * Determines if a string is null or empty or undefined\r\n *\r\n * @param s The string to test\r\n */\r\nexport function stringIsNullOrEmpty(s: string): boolean {\r\n    return s === undefined || s === null || s.length < 1;\r\n}\r\n\r\n/**\r\n * Ensures guid values are represented consistently as \"ea123463-137d-4ae3-89b8-cf3fc578ca05\"\r\n * \r\n * @param guid The candidate guid\r\n */\r\nexport function sanitizeGuid(guid: string): string {\r\n\r\n    if (stringIsNullOrEmpty(guid)) {\r\n        return guid;\r\n    }\r\n\r\n    const matches = /([0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12})/i.exec(guid);\r\n\r\n    return matches === null ? guid : matches[1];\r\n}\r\n\r\n/**\r\n * Shorthand for JSON.stringify\r\n * \r\n * @param o Any type of object\r\n */\r\nexport function jsS(o: any): string {\r\n    return JSON.stringify(o);\r\n}\r\n\r\n/**\r\n * Shorthand for Object.hasOwnProperty\r\n * \r\n * @param o Object to check for\r\n * @param p Name of the property\r\n */\r\nexport function hOP(o: any, p: string): boolean {\r\n    return Object.hasOwnProperty.call(o, p);\r\n}\r\n\r\n/**\r\n * Generates a ~unique hash code\r\n * \r\n * From: https://stackoverflow.com/questions/6122571/simple-non-secure-hash-function-for-javascript\r\n */\r\n// tslint:disable:no-bitwise\r\nexport function getHashCode(s: string): number {\r\n    let hash = 0;\r\n    if (s.length === 0) {\r\n        return hash;\r\n    }\r\n\r\n    for (let i = 0; i < s.length; i++) {\r\n        const chr = s.charCodeAt(i);\r\n        hash = ((hash << 5) - hash) + chr;\r\n        hash |= 0; // Convert to 32bit integer\r\n    }\r\n    return hash;\r\n}\r\n// tslint:enable:no-bitwise\r\n","export interface IResourcePath {\r\n    DecodedUrl: string;\r\n    __metadata: { type: \"SP.ResourcePath\" };\r\n}\r\n\r\nexport function toResourcePath(url: string): IResourcePath {\r\n    return {\r\n        DecodedUrl: url,\r\n        __metadata: { type: \"SP.ResourcePath\" },\r\n    };\r\n}\r\n","import { ILibraryConfiguration, ITypedHash, RuntimeConfig, IHttpClientImpl, SPFxAdalClient } from \"@pnp/common\";\r\n\r\nexport interface IGraphConfigurationPart {\r\n    graph?: {\r\n\r\n        /**\r\n         * The base url used for all requests (default: none)\r\n         */\r\n        baseUrl?: string;\r\n\r\n        /**\r\n         * Any headers to apply to all requests\r\n         */\r\n        headers?: ITypedHash<string>;\r\n\r\n        /**\r\n         * Defines a factory method used to create fetch clients\r\n         */\r\n        fetchClientFactory?: () => IHttpClientImpl;\r\n    };\r\n}\r\n\r\nexport interface IGraphConfiguration extends ILibraryConfiguration, IGraphConfigurationPart { }\r\n\r\nexport function setup(config: IGraphConfiguration): void {\r\n    RuntimeConfig.assign(config);\r\n}\r\n\r\nexport class GraphRuntimeConfigImpl {\r\n\r\n    public get headers(): ITypedHash<string> {\r\n\r\n        const graphPart = RuntimeConfig.get(\"graph\");\r\n        if (graphPart !== undefined && graphPart.headers !== undefined) {\r\n            return graphPart.headers;\r\n        }\r\n\r\n        return {};\r\n    }\r\n\r\n    public get baseUrl(): string {\r\n        const graphPart = RuntimeConfig.get(\"graph\");\r\n        if (graphPart !== undefined && graphPart.baseUrl !== undefined) {\r\n            return graphPart.baseUrl;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    public get fetchClientFactory(): () => IHttpClientImpl {\r\n\r\n        const graphPart = RuntimeConfig.get(\"graph\");\r\n        // use a configured factory firt\r\n        if (graphPart !== undefined && graphPart.fetchClientFactory !== undefined) {\r\n            return graphPart.fetchClientFactory;\r\n        }\r\n\r\n        // then try and use spfx context if available\r\n        if (RuntimeConfig.spfxContext !== undefined) {\r\n            return () => new SPFxAdalClient(RuntimeConfig.spfxContext);\r\n        }\r\n\r\n        throw Error(\"There is no Graph Client available, either set one using configuraiton or provide a valid SPFx Context using setup.\");\r\n    }\r\n}\r\n\r\nexport let GraphRuntimeConfig = new GraphRuntimeConfigImpl();\r\n","import { SPRest } from \"../rest\";\r\nimport { ISite, Site } from \"./types\";\r\n\r\nexport {\r\n    IOpenWebByIdResult,\r\n    ISite,\r\n    Site,\r\n    IContextInfo,\r\n    IDocumentLibraryInformation,\r\n} from \"./types\";\r\n\r\ndeclare module \"../rest\" {\r\n    interface SPRest {\r\n        readonly site: ISite;\r\n    }\r\n}\r\n\r\nReflect.defineProperty(SPRest.prototype, \"site\", {\r\n    configurable: true,\r\n    enumerable: true,\r\n    get: function (this: SPRest) {\r\n        return Site(this._baseUrl).configure(this._options);\r\n    },\r\n});\r\n","import { Web, IWeb } from \"./types\";\r\nimport { SPRest } from \"../rest\";\r\nimport { SPBatch } from \"../batch\";\r\n\r\nexport {\r\n    IWeb,\r\n    IWebs,\r\n    Web,\r\n    IWebAddResult,\r\n    IWebUpdateResult,\r\n    Webs,\r\n    IWebInfo,\r\n    IStorageEntity,\r\n    IWebInfosData,\r\n} from \"./types\";\r\n\r\ndeclare module \"../rest\" {\r\n    interface SPRest {\r\n\r\n        /**\r\n         * Access to the current web instance\r\n         */\r\n        readonly web: IWeb;\r\n\r\n        /**\r\n         * Creates a new batch object for use with the SharePointQueryable.addToBatch method\r\n         *\r\n         */\r\n        createBatch(): SPBatch;\r\n    }\r\n}\r\n\r\nReflect.defineProperty(SPRest.prototype, \"web\", {\r\n    configurable: true,\r\n    enumerable: true,\r\n    get: function (this: SPRest) {\r\n        return Web(this._baseUrl).configure(this._options);\r\n    },\r\n});\r\n\r\nSPRest.prototype.createBatch = function (this: SPRest): SPBatch {\r\n    return this.web.createBatch();\r\n};\r\n","import {\r\n    assign,\r\n    mergeHeaders,\r\n    IFetchOptions,\r\n    IRequestClient,\r\n    getCtxCallback,\r\n    IHttpClientImpl,\r\n    combine,\r\n    dateAdd,\r\n} from \"@pnp/common\";\r\nimport { SPRuntimeConfig } from \"./splibconfig\";\r\nimport { extractWebUrl } from \"./utils/extractweburl\";\r\nimport { tag } from \"./telemetry\";\r\nimport { ODataParser } from \"@pnp/odata\";\r\n\r\nexport class SPHttpClient implements IRequestClient {\r\n\r\n    protected _digestCache: IGetDigest;\r\n\r\n    constructor(protected _impl: IHttpClientImpl = SPRuntimeConfig.fetchClientFactory()) {\r\n        this._digestCache = getDigestFactory(this);\r\n    }\r\n\r\n    public async fetch(url: string, options: IFetchOptions = {}): Promise<Response> {\r\n\r\n        let opts = assign(options, { cache: \"no-cache\", credentials: \"same-origin\" }, true);\r\n\r\n        const headers = new Headers();\r\n\r\n        // first we add the global headers so they can be overwritten by any passed in locally to this call\r\n        mergeHeaders(headers, SPRuntimeConfig.headers);\r\n\r\n        // second we add the local options so we can overwrite the globals\r\n        mergeHeaders(headers, options.headers);\r\n\r\n        // lastly we apply any default headers we need that may not exist\r\n        if (!headers.has(\"Accept\")) {\r\n            headers.append(\"Accept\", \"application/json\");\r\n        }\r\n\r\n        if (!headers.has(\"Content-Type\")) {\r\n            headers.append(\"Content-Type\", \"application/json;odata=verbose;charset=utf-8\");\r\n        }\r\n\r\n        if (!headers.has(\"X-ClientService-ClientTag\")) {\r\n\r\n            const methodName = tag.getClientTag(headers);\r\n            let clientTag = `PnPCoreJS:$$Version$$:${methodName}`;\r\n\r\n            if (clientTag.length > 32) {\r\n                clientTag = clientTag.substr(0, 32);\r\n            }\r\n\r\n            headers.append(\"X-ClientService-ClientTag\", clientTag);\r\n        }\r\n\r\n        opts = assign(opts, { headers: headers });\r\n\r\n        // if we have either a request digest or an authorization header we don't need a digest\r\n        if (opts.method && opts.method.toUpperCase() !== \"GET\" && !headers.has(\"X-RequestDigest\") && !headers.has(\"Authorization\")) {\r\n\r\n            const digest = await this._digestCache(extractWebUrl(url));\r\n            headers.append(\"X-RequestDigest\", digest);\r\n        }\r\n\r\n        return this.fetchRaw(url, opts);\r\n    }\r\n\r\n    public fetchRaw(url: string, options: IFetchOptions = {}): Promise<Response> {\r\n\r\n        // here we need to normalize the headers\r\n        const rawHeaders = new Headers();\r\n        mergeHeaders(rawHeaders, options.headers);\r\n        options = assign(options, { headers: rawHeaders });\r\n\r\n        const retry = (ctx: IRetryContext): void => {\r\n\r\n            // handles setting the proper timeout for a retry\r\n            const setRetry = (response: Response) => {\r\n                let delay: number;\r\n\r\n                if (response.headers.has(\"Retry-After\")) {\r\n                    // if we have gotten a header, use that value as the delay value in seconds\r\n                    delay = parseInt(response.headers.get(\"Retry-After\"), 10) * 1000;\r\n                } else {\r\n                    // grab our current delay\r\n                    delay = ctx.delay;\r\n\r\n                    // Increment our counters.\r\n                    ctx.delay *= 2;\r\n                }\r\n\r\n                ctx.attempts++;\r\n\r\n                // If we have exceeded the retry count, reject.\r\n                if (ctx.retryCount <= ctx.attempts) {\r\n                    ctx.reject(Error(`Retry count exceeded (${ctx.retryCount}) for request. Response status: [${response.status}] ${response.statusText}`));\r\n                } else {\r\n                    // Set our retry timeout for {delay} milliseconds.\r\n                    setTimeout(getCtxCallback(this, retry, ctx), delay);\r\n                }\r\n            };\r\n\r\n            // send the actual request\r\n            this._impl.fetch(url, options).then((response) => {\r\n\r\n                if (response.status === 429) {\r\n                    // we have been throttled\r\n                    setRetry(response);\r\n                } else {\r\n                    ctx.resolve(response);\r\n                }\r\n\r\n            }).catch((response: Response) => {\r\n\r\n                if (response.status === 503 || response.status === 504) {\r\n                    // http status code 503 or 504, we can retry this\r\n                    setRetry(response);\r\n                } else {\r\n                    ctx.reject(response);\r\n                }\r\n            });\r\n        };\r\n\r\n        return new Promise((resolve, reject) => {\r\n\r\n            retry.call(this, <IRetryContext>{\r\n                attempts: 0,\r\n                delay: 100,\r\n                reject: reject,\r\n                resolve: resolve,\r\n                retryCount: 7,\r\n            });\r\n        });\r\n    }\r\n\r\n    public get(url: string, options: IFetchOptions = {}): Promise<Response> {\r\n        const opts = assign(options, { method: \"GET\" });\r\n        return this.fetch(url, opts);\r\n    }\r\n\r\n    public post(url: string, options: IFetchOptions = {}): Promise<Response> {\r\n        const opts = assign(options, { method: \"POST\" });\r\n        return this.fetch(url, opts);\r\n    }\r\n\r\n    public patch(url: string, options: IFetchOptions = {}): Promise<Response> {\r\n        const opts = assign(options, { method: \"PATCH\" });\r\n        return this.fetch(url, opts);\r\n    }\r\n\r\n    public delete(url: string, options: IFetchOptions = {}): Promise<Response> {\r\n        const opts = assign(options, { method: \"DELETE\" });\r\n        return this.fetch(url, opts);\r\n    }\r\n}\r\n\r\ninterface IRetryContext {\r\n    attempts: number;\r\n    delay: number;\r\n    reject: (reason?: any) => void;\r\n    resolve: (value?: Response | PromiseLike<Response>) => void;\r\n    retryCount: number;\r\n}\r\n\r\ninterface ICachedDigest {\r\n    expiration: Date;\r\n    value: string;\r\n}\r\n\r\ninterface IGetDigest {\r\n    (webUrl: string): Promise<string>;\r\n}\r\n\r\n// allows for the caching of digests across all HttpClient's which each have their own DigestCache wrapper.\r\nconst digests = new Map<string, ICachedDigest>();\r\n\r\nfunction getDigestFactory(client: SPHttpClient): IGetDigest {\r\n\r\n    return async (webUrl: string) => {\r\n\r\n        const cachedDigest: ICachedDigest = digests.get(webUrl);\r\n\r\n        if (cachedDigest !== undefined) {\r\n            const now = new Date();\r\n            if (now < cachedDigest.expiration) {\r\n                return cachedDigest.value;\r\n            }\r\n        }\r\n\r\n        const url = combine(webUrl, \"/_api/contextinfo\");\r\n\r\n        const headers = {\r\n            \"Accept\": \"application/json;odata=verbose\",\r\n            \"Content-Type\": \"application/json;odata=verbose;charset=utf-8\",\r\n        };\r\n\r\n        const resp = await client.fetchRaw(url, {\r\n            cache: \"no-cache\",\r\n            credentials: \"same-origin\",\r\n            headers: assign(headers, SPRuntimeConfig.headers, true),\r\n            method: \"POST\",\r\n        });\r\n\r\n        const parsed = await (new ODataParser()).parse(resp).then(r => r.GetContextWebInformation);\r\n\r\n        const newCachedDigest: ICachedDigest = {\r\n            expiration: dateAdd(new Date(), \"second\", parsed.FormDigestTimeoutSeconds),\r\n            value: parsed.FormDigestValue,\r\n        };\r\n\r\n        digests.set(webUrl, newCachedDigest);\r\n\r\n        return newCachedDigest.value;\r\n    };\r\n}\r\n","import { combine, isUrlAbsolute, hOP, safeGlobal } from \"@pnp/common\";\r\nimport { SPRuntimeConfig } from \"../splibconfig\";\r\n\r\n/**\r\n * Ensures that a given url is absolute for the current web based on context\r\n *\r\n * @param candidateUrl The url to make absolute\r\n *\r\n */\r\nexport async function toAbsoluteUrl(candidateUrl: string): Promise<string> {\r\n\r\n    if (isUrlAbsolute(candidateUrl)) {\r\n        // if we are already absolute, then just return the url\r\n        return candidateUrl;\r\n    }\r\n\r\n    if (SPRuntimeConfig.baseUrl !== null) {\r\n        // base url specified either with baseUrl of spfxContext config property\r\n        return combine(SPRuntimeConfig.baseUrl, candidateUrl);\r\n    }\r\n\r\n    if (safeGlobal._spPageContextInfo !== undefined) {\r\n\r\n        // operating in classic pages\r\n        if (hOP(safeGlobal._spPageContextInfo, \"webAbsoluteUrl\")) {\r\n            return combine(safeGlobal._spPageContextInfo.webAbsoluteUrl, candidateUrl);\r\n        } else if (hOP(safeGlobal._spPageContextInfo, \"webServerRelativeUrl\")) {\r\n            return combine(safeGlobal._spPageContextInfo.webServerRelativeUrl, candidateUrl);\r\n        }\r\n    }\r\n\r\n    // does window.location exist and have a certain path part in it?\r\n    if (safeGlobal.location !== undefined) {\r\n        const baseUrl = safeGlobal.location.toString().toLowerCase();\r\n        [\"/_layouts/\", \"/siteassets/\"].forEach((s: string) => {\r\n            const index = baseUrl.indexOf(s);\r\n            if (index > 0) {\r\n                return combine(baseUrl.substr(0, index), candidateUrl);\r\n            }\r\n        });\r\n    }\r\n\r\n    return candidateUrl;\r\n}\r\n","import { Batch, HttpRequestError } from \"@pnp/odata\";\r\nimport { getGUID, isUrlAbsolute, combine, mergeHeaders, hOP } from \"@pnp/common\";\r\nimport { Logger, LogLevel } from \"@pnp/logging\";\r\nimport { SPHttpClient } from \"./sphttpclient\";\r\nimport { SPRuntimeConfig } from \"./splibconfig\";\r\nimport { toAbsoluteUrl } from \"./utils/toabsoluteurl\";\r\n\r\n/**\r\n * Manages a batch of OData operations\r\n */\r\nexport class SPBatch extends Batch {\r\n\r\n    constructor(private baseUrl: string) {\r\n        super();\r\n    }\r\n\r\n    /**\r\n     * Parses the response from a batch request into an array of Response instances\r\n     *\r\n     * @param body Text body of the response from the batch request\r\n     */\r\n    public static ParseResponse(body: string): Response[] {\r\n\r\n        const responses: Response[] = [];\r\n        const header = \"--batchresponse_\";\r\n        // Ex. \"HTTP/1.1 500 Internal Server Error\"\r\n        const statusRegExp = new RegExp(\"^HTTP/[0-9.]+ +([0-9]+) +(.*)\", \"i\");\r\n        const lines = body.split(\"\\n\");\r\n        let state = \"batch\";\r\n        let status: number;\r\n        let statusText: string;\r\n        for (let i = 0; i < lines.length; ++i) {\r\n            const line = lines[i];\r\n            switch (state) {\r\n                case \"batch\":\r\n                    if (line.substr(0, header.length) === header) {\r\n                        state = \"batchHeaders\";\r\n                    } else {\r\n                        if (line.trim() !== \"\") {\r\n                            throw Error(`Invalid response, line ${i}`);\r\n                        }\r\n                    }\r\n                    break;\r\n                case \"batchHeaders\":\r\n                    if (line.trim() === \"\") {\r\n                        state = \"status\";\r\n                    }\r\n                    break;\r\n                case \"status\":\r\n                    const parts = statusRegExp.exec(line);\r\n                    if (parts.length !== 3) {\r\n                        throw Error(`Invalid status, line ${i}`);\r\n                    }\r\n                    status = parseInt(parts[1], 10);\r\n                    statusText = parts[2];\r\n                    state = \"statusHeaders\";\r\n                    break;\r\n                case \"statusHeaders\":\r\n                    if (line.trim() === \"\") {\r\n                        state = \"body\";\r\n                    }\r\n                    break;\r\n                case \"body\":\r\n                    responses.push((status === 204) ? new Response() : new Response(line, { status: status, statusText: statusText }));\r\n                    state = \"batch\";\r\n                    break;\r\n            }\r\n        }\r\n\r\n        if (state !== \"status\") {\r\n            throw Error(\"Unexpected end of input\");\r\n        }\r\n\r\n        return responses;\r\n    }\r\n\r\n    protected async executeImpl(): Promise<void> {\r\n\r\n        Logger.write(`[${this.batchId}] (${(new Date()).getTime()}) Executing batch with ${this.requests.length} requests.`, LogLevel.Info);\r\n\r\n        // if we don't have any requests, don't bother sending anything\r\n        // this could be due to caching further upstream, or just an empty batch\r\n        if (this.requests.length < 1) {\r\n            Logger.write(`Resolving empty batch.`, LogLevel.Info);\r\n            return;\r\n        }\r\n\r\n        // creating the client here allows the url to be populated for nodejs client as well as potentially\r\n        // any other hacks needed for other types of clients. Essentially allows the absoluteRequestUrl\r\n        // below to be correct\r\n        const client = new SPHttpClient();\r\n\r\n        // due to timing we need to get the absolute url here so we can use it for all the individual requests\r\n        // and for sending the entire batch\r\n        const absoluteRequestUrl = await toAbsoluteUrl(this.baseUrl);\r\n\r\n        // build all the requests, send them, pipe results in order to parsers\r\n        const batchBody: string[] = [];\r\n\r\n        let currentChangeSetId = \"\";\r\n\r\n        for (let i = 0; i < this.requests.length; i++) {\r\n            const reqInfo = this.requests[i];\r\n\r\n            if (reqInfo.method === \"GET\") {\r\n\r\n                if (currentChangeSetId.length > 0) {\r\n                    // end an existing change set\r\n                    batchBody.push(`--changeset_${currentChangeSetId}--\\n\\n`);\r\n                    currentChangeSetId = \"\";\r\n                }\r\n\r\n                batchBody.push(`--batch_${this.batchId}\\n`);\r\n\r\n            } else {\r\n\r\n                if (currentChangeSetId.length < 1) {\r\n                    // start new change set\r\n                    currentChangeSetId = getGUID();\r\n                    batchBody.push(`--batch_${this.batchId}\\n`);\r\n                    batchBody.push(`Content-Type: multipart/mixed; boundary=\"changeset_${currentChangeSetId}\"\\n\\n`);\r\n                }\r\n\r\n                batchBody.push(`--changeset_${currentChangeSetId}\\n`);\r\n            }\r\n\r\n            // common batch part prefix\r\n            batchBody.push(`Content-Type: application/http\\n`);\r\n            batchBody.push(`Content-Transfer-Encoding: binary\\n\\n`);\r\n\r\n            // these are the per-request headers\r\n            const headers = new Headers();\r\n\r\n            // this is the url of the individual request within the batch\r\n            const url = isUrlAbsolute(reqInfo.url) ? reqInfo.url : combine(absoluteRequestUrl, reqInfo.url);\r\n\r\n            Logger.write(`[${this.batchId}] (${(new Date()).getTime()}) Adding request ${reqInfo.method} ${url} to batch.`, LogLevel.Verbose);\r\n\r\n            if (reqInfo.method !== \"GET\") {\r\n\r\n                let method = reqInfo.method;\r\n\r\n                const castHeaders: any = reqInfo.options.headers;\r\n                if (hOP(reqInfo, \"options\") && hOP(reqInfo.options, \"headers\") && castHeaders[\"X-HTTP-Method\"] !== undefined) {\r\n\r\n                    method = castHeaders[\"X-HTTP-Method\"];\r\n                    delete castHeaders[\"X-HTTP-Method\"];\r\n                }\r\n\r\n                batchBody.push(`${method} ${url} HTTP/1.1\\n`);\r\n\r\n                headers.set(\"Content-Type\", \"application/json;odata=verbose;charset=utf-8\");\r\n\r\n            } else {\r\n                batchBody.push(`${reqInfo.method} ${url} HTTP/1.1\\n`);\r\n            }\r\n\r\n            // merge global config headers\r\n            mergeHeaders(headers, SPRuntimeConfig.headers);\r\n\r\n            // merge per-request headers\r\n            if (reqInfo.options) {\r\n                mergeHeaders(headers, reqInfo.options.headers);\r\n            }\r\n\r\n            // lastly we apply any default headers we need that may not exist\r\n            if (!headers.has(\"Accept\")) {\r\n                headers.append(\"Accept\", \"application/json\");\r\n            }\r\n\r\n            if (!headers.has(\"Content-Type\")) {\r\n                headers.append(\"Content-Type\", \"application/json;odata=verbose;charset=utf-8\");\r\n            }\r\n\r\n            if (!headers.has(\"X-ClientService-ClientTag\")) {\r\n                headers.append(\"X-ClientService-ClientTag\", \"PnPCoreJS:@pnp-$$Version$$:batch\");\r\n            }\r\n\r\n            // write headers into batch body\r\n            headers.forEach((value: string, name: string) => {\r\n                batchBody.push(`${name}: ${value}\\n`);\r\n            });\r\n\r\n            batchBody.push(\"\\n\");\r\n\r\n            if (reqInfo.options.body) {\r\n                batchBody.push(`${reqInfo.options.body}\\n\\n`);\r\n            }\r\n        }\r\n\r\n        if (currentChangeSetId.length > 0) {\r\n            // Close the changeset\r\n            batchBody.push(`--changeset_${currentChangeSetId}--\\n\\n`);\r\n            currentChangeSetId = \"\";\r\n        }\r\n\r\n        batchBody.push(`--batch_${this.batchId}--\\n`);\r\n\r\n        const batchOptions = {\r\n            \"body\": batchBody.join(\"\"),\r\n            \"headers\": {\r\n                \"Content-Type\": `multipart/mixed; boundary=batch_${this.batchId}`,\r\n            },\r\n            \"method\": \"POST\",\r\n        };\r\n\r\n        Logger.write(`[${this.batchId}] (${(new Date()).getTime()}) Sending batch request.`, LogLevel.Info);\r\n\r\n        const fetchResponse = await client.fetch(combine(absoluteRequestUrl, \"/_api/$batch\"), batchOptions);\r\n\r\n        if (!fetchResponse.ok) {\r\n            // the entire batch resulted in an error and we need to handle that better #1356\r\n            // things consistently with the rest of the http errors\r\n            throw (await HttpRequestError.init(fetchResponse));\r\n        }\r\n\r\n        const text = await fetchResponse.clone().text();\r\n        const responses = SPBatch.ParseResponse(text);\r\n\r\n        if (responses.length !== this.requests.length) {\r\n            throw Error(\"Could not properly parse responses to match requests in batch.\");\r\n        }\r\n\r\n        Logger.write(`[${this.batchId}] (${(new Date()).getTime()}) Resolving batched requests.`, LogLevel.Info);\r\n\r\n        // this structure ensures that we resolve the batched requests in the order we expect\r\n        // using async this is not guaranteed depending on the requests\r\n        return responses.reduce((p, response, index) => p.then(async _ => {\r\n\r\n            const request = this.requests[index];\r\n\r\n            Logger.write(`[${request.id}] (${(new Date()).getTime()}) Resolving request in batch ${this.batchId}.`, LogLevel.Info);\r\n\r\n            try {\r\n\r\n                request.resolve(await request.parser.parse(response));\r\n\r\n            } catch (e) {\r\n\r\n                request.reject(e);\r\n            }\r\n\r\n        }), Promise.resolve(void (0)));\r\n    }\r\n}\r\n","import {\r\n    assign,\r\n    IRequestClient,\r\n    mergeHeaders,\r\n    IFetchOptions,\r\n    IHttpClientImpl,\r\n    getCtxCallback,\r\n} from \"@pnp/common\";\r\nimport { GraphRuntimeConfig } from \"./graphlibconfig\";\r\n\r\nexport class GraphHttpClient implements IRequestClient {\r\n\r\n    private _impl: IHttpClientImpl;\r\n\r\n    constructor() {\r\n\r\n        this._impl = GraphRuntimeConfig.fetchClientFactory();\r\n    }\r\n\r\n    public fetch(url: string, options: IFetchOptions = {}): Promise<Response> {\r\n\r\n        const headers = new Headers();\r\n\r\n        // first we add the global headers so they can be overwritten by any passed in locally to this call\r\n        mergeHeaders(headers, GraphRuntimeConfig.headers);\r\n\r\n        // second we add the local options so we can overwrite the globals\r\n        mergeHeaders(headers, options.headers);\r\n\r\n        if (!headers.has(\"Content-Type\")) {\r\n            headers.append(\"Content-Type\", \"application/json\");\r\n        }\r\n\r\n        if (!headers.has(\"SdkVersion\")) {\r\n            // this marks the requests for understanding by the service\r\n            headers.append(\"SdkVersion\", \"PnPCoreJS/$$Version$$\");\r\n        }\r\n\r\n        const opts = assign(options, { headers: headers });\r\n\r\n        return this.fetchRaw(url, opts);\r\n    }\r\n\r\n    public fetchRaw(url: string, options: IFetchOptions = {}): Promise<Response> {\r\n\r\n        // here we need to normalize the headers\r\n        const rawHeaders = new Headers();\r\n        mergeHeaders(rawHeaders, options.headers);\r\n        options = assign(options, { headers: rawHeaders });\r\n\r\n        const retry = (ctx: RetryContext): void => {\r\n\r\n            this._impl.fetch(url, options).then((response) => ctx.resolve(response)).catch((response) => {\r\n\r\n                // Check if request was throttled - http status code 429\r\n                // Check if request failed due to server unavailable - http status code 503\r\n                // Check if request failed due to gateway timeout - http status code 504\r\n                if (response.status !== 429 && response.status !== 503 && response.status !== 504) {\r\n                    ctx.reject(response);\r\n                }\r\n\r\n                // grab our current delay\r\n                const delay = ctx.delay;\r\n\r\n                // Increment our counters.\r\n                ctx.delay *= 2;\r\n                ctx.attempts++;\r\n\r\n                // If we have exceeded the retry count, reject.\r\n                if (ctx.retryCount <= ctx.attempts) {\r\n                    ctx.reject(response);\r\n                }\r\n\r\n                // Set our retry timeout for {delay} milliseconds.\r\n                setTimeout(getCtxCallback(this, retry, ctx), delay);\r\n            });\r\n        };\r\n\r\n        return new Promise((resolve, reject) => {\r\n\r\n            const retryContext: RetryContext = {\r\n                attempts: 0,\r\n                delay: 100,\r\n                reject: reject,\r\n                resolve: resolve,\r\n                retryCount: 7,\r\n            };\r\n\r\n            retry.call(this, retryContext);\r\n        });\r\n    }\r\n\r\n    public get(url: string, options: IFetchOptions = {}): Promise<Response> {\r\n        const opts = assign(options, { method: \"GET\" });\r\n        return this.fetch(url, opts);\r\n    }\r\n\r\n    public post(url: string, options: IFetchOptions = {}): Promise<Response> {\r\n        const opts = assign(options, { method: \"POST\" });\r\n        return this.fetch(url, opts);\r\n    }\r\n\r\n    public patch(url: string, options: IFetchOptions = {}): Promise<Response> {\r\n        const opts = assign(options, { method: \"PATCH\" });\r\n        return this.fetch(url, opts);\r\n    }\r\n\r\n    public delete(url: string, options: IFetchOptions = {}): Promise<Response> {\r\n        const opts = assign(options, { method: \"DELETE\" });\r\n        return this.fetch(url, opts);\r\n    }\r\n}\r\n\r\ninterface RetryContext {\r\n    attempts: number;\r\n    delay: number;\r\n    reject: (reason?: any) => void;\r\n    resolve: (value?: Response | PromiseLike<Response>) => void;\r\n    retryCount: number;\r\n}\r\n","import { ITypedHash, mergeMaps, objectToMap } from \"./collections\";\r\nimport { ISPFXContext } from \"./spfxcontextinterface\";\r\n\r\nexport interface ILibraryConfiguration {\r\n\r\n    /**\r\n     * Allows caching to be global disabled, default: false\r\n     */\r\n    globalCacheDisable?: boolean;\r\n\r\n    /**\r\n     * Defines the default store used by the usingCaching method, default: session\r\n     */\r\n    defaultCachingStore?: \"session\" | \"local\";\r\n\r\n    /**\r\n     * Defines the default timeout in seconds used by the usingCaching method, default 30\r\n     */\r\n    defaultCachingTimeoutSeconds?: number;\r\n\r\n    /**\r\n     * If true a timeout expired items will be removed from the cache in intervals determined by cacheTimeoutInterval\r\n     */\r\n    enableCacheExpiration?: boolean;\r\n\r\n    /**\r\n     * Determines the interval in milliseconds at which the cache is checked to see if items have expired (min: 100)\r\n     */\r\n    cacheExpirationIntervalMilliseconds?: number;\r\n\r\n    /**\r\n     * Used to supply the current context from an SPFx webpart to the library\r\n     */\r\n    spfxContext?: ISPFXContext;\r\n\r\n    /**\r\n     * Used to place the library in ie11 compat mode. Some features may not work as expected\r\n     */\r\n    ie11?: boolean;\r\n}\r\n\r\nexport function setup(config: ILibraryConfiguration): void {\r\n    RuntimeConfig.assign(config);\r\n}\r\n\r\n// lable mapping for known config values\r\nconst s = [\r\n    \"defaultCachingStore\",\r\n    \"defaultCachingTimeoutSeconds\",\r\n    \"globalCacheDisable\",\r\n    \"enableCacheExpiration\",\r\n    \"cacheExpirationIntervalMilliseconds\",\r\n    \"spfxContext\",\r\n    \"ie11\",\r\n];\r\n\r\nexport class RuntimeConfigImpl {\r\n\r\n    constructor(private _v = new Map<string, any>()) {\r\n\r\n        // setup defaults\r\n        this._v.set(s[0], \"session\");\r\n        this._v.set(s[1], 60);\r\n        this._v.set(s[2], false);\r\n        this._v.set(s[3], false);\r\n        this._v.set(s[4], 750);\r\n        this._v.set(s[5], null);\r\n        this._v.set(s[6], false);\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param config The set of properties to add to the globa configuration instance\r\n     */\r\n    public assign(config: ITypedHash<any>): void {\r\n        this._v = mergeMaps(this._v, objectToMap(config));\r\n    }\r\n\r\n    public get(key: string): any {\r\n        return this._v.get(key);\r\n    }\r\n\r\n    public get defaultCachingStore(): \"session\" | \"local\" {\r\n        return this.get(s[0]);\r\n    }\r\n\r\n    public get defaultCachingTimeoutSeconds(): number {\r\n        return this.get(s[1]);\r\n    }\r\n\r\n    public get globalCacheDisable(): boolean {\r\n        return this.get(s[2]);\r\n    }\r\n\r\n    public get enableCacheExpiration(): boolean {\r\n        return this.get(s[3]);\r\n    }\r\n\r\n    public get cacheExpirationIntervalMilliseconds(): number {\r\n        return this.get(s[4]);\r\n    }\r\n\r\n    public get spfxContext(): ISPFXContext {\r\n        return this.get(s[5]);\r\n    }\r\n\r\n    public get ie11(): boolean {\r\n        return this.get(s[6]);\r\n    }\r\n}\r\n\r\nconst _runtimeConfig = new RuntimeConfigImpl();\r\n\r\nexport let RuntimeConfig = _runtimeConfig;\r\n","import { isFunc } from \"./util\";\r\n\r\ndeclare var Object: {\r\n    entries?: any;\r\n    keys(o: any): any;\r\n};\r\n\r\n/**\r\n * Interface defining an object with a known property type\r\n */\r\nexport interface ITypedHash<T> {\r\n    [key: string]: T;\r\n}\r\n\r\n/**\r\n * Used to calculate the object properties, with polyfill if needed\r\n */\r\nconst objectEntries: any = isFunc(Object.entries) ? Object.entries : (o: any): [any, any][] => Object.keys(o).map((k: any) => [k, o[k]]);\r\n\r\n/**\r\n * Converts the supplied object to a map\r\n * \r\n * @param o The object to map\r\n */\r\nexport function objectToMap<K, V>(o: any): Map<K, V> {\r\n    if (o !== undefined && o !== null) {\r\n        return new Map(objectEntries(o));\r\n    }\r\n    return new Map();\r\n}\r\n\r\n/**\r\n * Merges to Map instances together, overwriting values in target with matching keys, last in wins\r\n * \r\n * @param target map into which the other maps are merged\r\n * @param maps One or more maps to merge into the target \r\n */\r\nexport function mergeMaps<K, V>(target: Map<K, V>, ...maps: Map<K, V>[]): Map<K, V> {\r\n    for (let i = 0; i < maps.length; i++) {\r\n        maps[i].forEach((v: V, k: K) => {\r\n            target.set(k, v);\r\n        });\r\n    }\r\n\r\n    return target;\r\n}\r\n","// this is the ambient nodejs global var which may or may not exist\r\ndeclare var global: any;\r\n\r\n// all the things we expect to maybe exist on global\r\nexport interface IGlobal {\r\n    _spPageContextInfo?: {\r\n        webAbsoluteUrl?: string;\r\n        webServerRelativeUrl?: string\r\n    };\r\n\r\n    location?: string;\r\n\r\n    fetch(url: string, options: any): Promise<Response>;\r\n}\r\n\r\n// export either window or global\r\nexport const safeGlobal: IGlobal = typeof global === \"undefined\" ? window : global;\r\n","import { metadata } from \"./metadata\";\r\nimport { ITypedHash, assign } from \"@pnp/common\";\r\n\r\nexport interface ISPKeyValueCollection {\r\n    __metadata: {\r\n        type: \"Collection(SP.KeyValue)\";\r\n    };\r\n    results: {\r\n        __metadata: {\r\n            type: \"SP.KeyValue\",\r\n        },\r\n        Key: string;\r\n        Value: string,\r\n        ValueType: \"Edm.String\"\r\n    }[];\r\n}\r\n\r\n/**\r\n * Creates an object representing a SharePoint Collection(SP.KeyValue)\r\n * \r\n * @param obj The plain object defining the properties\r\n */\r\nexport function objectToSPKeyValueCollection(obj: ITypedHash<string | number | boolean>): ISPKeyValueCollection {\r\n\r\n    return <ISPKeyValueCollection>assign(metadata(\"Collection(SP.KeyValue)\"), {\r\n        results: Object.keys(obj).map(key => assign(metadata(\"SP.KeyValue\"), {\r\n            Key: key,\r\n            Value: Reflect.get(obj, key),\r\n            ValueType: \"Edm.String\",\r\n        })),\r\n    });\r\n}\r\n","export { graph, GraphRest } from \"./rest\";\r\n\r\nexport {\r\n    GraphBatch,\r\n} from \"./batch\";\r\n\r\nexport {\r\n    IGraphQueryableCollection,\r\n    IGraphQueryableInstance,\r\n    IGraphQueryableSearchableCollection,\r\n    GraphQueryable,\r\n    IGraphQueryable,\r\n    GraphQueryableCollection,\r\n    GraphQueryableInstance,\r\n    IGraphQueryableConstructor,\r\n    GraphQueryableSearchableCollection,\r\n} from \"./graphqueryable\";\r\n\r\nexport {\r\n    IGraphConfiguration,\r\n    IGraphConfigurationPart,\r\n} from \"./graphlibconfig\";\r\n\r\nexport * from \"./graphhttpclient\";\r\n\r\nexport * from \"./types\";\r\n\r\n","export class GraphEndpoints {\r\n\r\n    public static Beta = \"beta\";\r\n    public static V1 = \"v1.0\";\r\n\r\n    /**\r\n     * \r\n     * @param url The url to set the endpoint \r\n     */\r\n    public static ensure(url: string, endpoint: string): string {\r\n        const all = [GraphEndpoints.Beta, GraphEndpoints.V1];\r\n        let regex = new RegExp(endpoint, \"i\");\r\n        const replaces = all.filter(s => !regex.test(s)).map(s => s.replace(\".\", \"\\\\.\"));\r\n        regex = new RegExp(`/?(${replaces.join(\"|\")})/?`, \"ig\");\r\n        return url.replace(regex, `/${endpoint}/`);\r\n    }\r\n}\r\n","import { Batch, IODataBatchRequestInfo } from \"@pnp/odata\";\r\nimport { Logger, LogLevel } from \"@pnp/logging\";\r\nimport { assign, jsS, isUrlAbsolute, hOP } from \"@pnp/common\";\r\nimport { GraphRuntimeConfig } from \"./graphlibconfig\";\r\nimport { GraphHttpClient } from \"./graphhttpclient\";\r\nimport { toAbsoluteUrl } from \"./utils/toabsoluteurl\";\r\n\r\ninterface GraphBatchRequestFragment {\r\n    id: string;\r\n    method: string;\r\n    url: string;\r\n    headers?: string[][] | {\r\n        [key: string]: string;\r\n    };\r\n    body?: any;\r\n}\r\n\r\ninterface GraphBatchRequest {\r\n    requests: GraphBatchRequestFragment[];\r\n}\r\n\r\ninterface GraphBatchResponseFragment {\r\n    id: string;\r\n    status: number;\r\n    statusText?: string;\r\n    method: string;\r\n    url: string;\r\n    headers?: string[][] | {\r\n        [key: string]: string;\r\n    };\r\n    body?: any;\r\n}\r\n\r\ninterface IGraphBatchResponse {\r\n    error?: {\r\n        code: string;\r\n        innerError: { \"request-id\": string, date: string };\r\n        message: string;\r\n    };\r\n    responses: GraphBatchResponseFragment[];\r\n    nextLink?: string;\r\n}\r\n\r\nexport class GraphBatch extends Batch {\r\n\r\n    constructor(private batchUrl = \"v1.0/$batch\", private maxRequests = 20) {\r\n        super();\r\n    }\r\n\r\n    /**\r\n     * Urls come to the batch absolute, but the processor expects relative\r\n     * @param url Url to ensure is relative\r\n     */\r\n    private static makeUrlRelative(url: string): string {\r\n\r\n        if (!isUrlAbsolute(url)) {\r\n            // already not absolute, just give it back\r\n            return url;\r\n        }\r\n\r\n        let index = url.indexOf(\".com/v1.0/\");\r\n\r\n        if (index < 0) {\r\n\r\n            index = url.indexOf(\".com/beta/\");\r\n\r\n            if (index > -1) {\r\n\r\n                // beta url\r\n                return url.substr(index + 10);\r\n            }\r\n\r\n        } else {\r\n            // v1.0 url\r\n            return url.substr(index + 9);\r\n        }\r\n\r\n        // no idea\r\n        return url;\r\n    }\r\n\r\n    private static formatRequests(requests: IODataBatchRequestInfo[]): GraphBatchRequestFragment[] {\r\n\r\n        return requests.map((reqInfo, index) => {\r\n\r\n            let requestFragment: GraphBatchRequestFragment = {\r\n                id: `${++index}`,\r\n                method: reqInfo.method,\r\n                url: this.makeUrlRelative(reqInfo.url),\r\n            };\r\n\r\n            let headers = {};\r\n\r\n            // merge global config headers\r\n            if (GraphRuntimeConfig.headers !== undefined && GraphRuntimeConfig.headers !== null) {\r\n\r\n                headers = assign(headers, GraphRuntimeConfig.headers);\r\n            }\r\n\r\n            if (reqInfo.options !== undefined) {\r\n\r\n                // merge per request headers\r\n                if (reqInfo.options.headers !== undefined && reqInfo.options.headers !== null) {\r\n                    headers = assign(headers, reqInfo.options.headers);\r\n                }\r\n\r\n                // all non-get requests need their own content-type header\r\n                if (reqInfo.method !== \"GET\") {\r\n                    headers[\"Content-Type\"] = \"application/json\";\r\n                }\r\n\r\n                // add a request body\r\n                if (reqInfo.options.body !== undefined && reqInfo.options.body !== null) {\r\n\r\n                    // we need to parse the body which was previously turned into a string\r\n                    requestFragment = assign(requestFragment, {\r\n                        body: JSON.parse(reqInfo.options.body),\r\n                    });\r\n                }\r\n            }\r\n\r\n            requestFragment = assign(requestFragment, {\r\n                headers: headers,\r\n            });\r\n\r\n            return requestFragment;\r\n        });\r\n    }\r\n\r\n    private static parseResponse(requests: IODataBatchRequestInfo[], graphResponse: IGraphBatchResponse): Promise<{ nextLink: string, responses: Response[] }> {\r\n\r\n        return new Promise((resolve, reject) => {\r\n\r\n            // we need to see if we have an error and report that\r\n            if (hOP(graphResponse, \"error\")) {\r\n                return reject(Error(`Error Porcessing Batch: (${graphResponse.error.code}) ${graphResponse.error.message}`));\r\n            }\r\n\r\n            const parsedResponses: Response[] = new Array(requests.length).fill(null);\r\n\r\n            for (let i = 0; i < graphResponse.responses.length; ++i) {\r\n\r\n                const response = graphResponse.responses[i];\r\n                // we create the request id by adding 1 to the index, so we place the response by subtracting one to match\r\n                // the array of requests and make it easier to map them by index\r\n                const responseId = parseInt(response.id, 10) - 1;\r\n\r\n                if (response.status === 204) {\r\n\r\n                    parsedResponses[responseId] = new Response();\r\n                } else {\r\n\r\n                    parsedResponses[responseId] = new Response(JSON.stringify(response.body), response);\r\n                }\r\n            }\r\n\r\n            resolve({\r\n                nextLink: graphResponse.nextLink,\r\n                responses: parsedResponses,\r\n            });\r\n        });\r\n    }\r\n\r\n    protected executeImpl(): Promise<void> {\r\n\r\n        Logger.write(`[${this.batchId}] (${(new Date()).getTime()}) Executing batch with ${this.requests.length} requests.`, LogLevel.Info);\r\n\r\n        if (this.requests.length < 1) {\r\n            Logger.write(`Resolving empty batch.`, LogLevel.Info);\r\n            return Promise.resolve();\r\n        }\r\n\r\n        const client = new GraphHttpClient();\r\n\r\n        // create a working copy of our requests\r\n        const requests = this.requests.slice();\r\n        let error = false;\r\n\r\n\r\n        return new Promise(async (resolve, reject) => {\r\n\r\n            // this is the root of our promise chain\r\n            while (requests.length > 0) {\r\n\r\n                const requestsChunk = requests.splice(0, this.maxRequests);\r\n\r\n                const batchRequest: GraphBatchRequest = {\r\n                    requests: GraphBatch.formatRequests(requestsChunk),\r\n                };\r\n\r\n                const batchOptions = {\r\n                    body: jsS(batchRequest),\r\n                    headers: {\r\n                        \"Accept\": \"application/json\",\r\n                        \"Content-Type\": \"application/json\",\r\n                    },\r\n                    method: \"POST\",\r\n                };\r\n\r\n                Logger.write(`[${this.batchId}] (${(new Date()).getTime()}) Sending batch request.`, LogLevel.Info);\r\n\r\n                const queryUrl = await toAbsoluteUrl(this.batchUrl);\r\n\r\n                await client.fetch(queryUrl, batchOptions)\r\n                    .then(r => r.json())\r\n                    .then((j) => GraphBatch.parseResponse(requestsChunk, j))\r\n                    .then((parsedResponse: { nextLink: string, responses: Response[] }) => {\r\n\r\n                        Logger.write(`[${this.batchId}] (${(new Date()).getTime()}) Resolving batched requests.`, LogLevel.Info);\r\n\r\n                        parsedResponse.responses.reduce((chain, response, index) => {\r\n\r\n                            const request = requestsChunk[index];\r\n\r\n                            Logger.write(`[${this.batchId}] (${(new Date()).getTime()}) Resolving batched request ${request.method} ${request.url}.`, LogLevel.Verbose);\r\n\r\n                            return chain.then(_ => request.parser.parse(response).then(request.resolve).catch(request.reject));\r\n\r\n                        }, Promise.resolve());\r\n                    }).catch(e => {\r\n                        reject(e);\r\n                        error = true;\r\n                    });\r\n\r\n                if (error) {\r\n                    // do not continue processing on error, we can't know what the downstream effects are\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (!error) {\r\n                // if we didn't have an error go ahead and resolve the promise as successful\r\n                resolve();\r\n            }\r\n        });\r\n    }\r\n}\r\n","import { ITypedHash, mergeMaps, objectToMap, jsS } from \"@pnp/common\";\r\n\r\n/**\r\n * Interface for configuration providers\r\n *\r\n */\r\nexport interface IConfigurationProvider {\r\n\r\n    /**\r\n     * Gets the configuration from the provider\r\n     */\r\n    getConfiguration(): Promise<ITypedHash<string>>;\r\n}\r\n\r\n/**\r\n * Class used to manage the current application settings\r\n *\r\n */\r\nexport class Settings {\r\n\r\n    /**\r\n     * Creates a new instance of the settings class\r\n     *\r\n     * @constructor\r\n     */\r\n    constructor(private _settings = new Map<string, string>()) {\r\n    }\r\n\r\n    /**\r\n     * Adds a new single setting, or overwrites a previous setting with the same key\r\n     *\r\n     * @param {string} key The key used to store this setting\r\n     * @param {string} value The setting value to store\r\n     */\r\n    public add(key: string, value: string) {\r\n        this._settings.set(key, value);\r\n    }\r\n\r\n    /**\r\n     * Adds a JSON value to the collection as a string, you must use getJSON to rehydrate the object when read\r\n     *\r\n     * @param {string} key The key used to store this setting\r\n     * @param {any} value The setting value to store\r\n     */\r\n    public addJSON(key: string, value: any) {\r\n        this._settings.set(key, jsS(value));\r\n    }\r\n\r\n    /**\r\n     * Applies the supplied hash to the setting collection overwriting any existing value, or created new values\r\n     *\r\n     * @param {ITypedHash<any>} hash The set of values to add\r\n     */\r\n    public apply(hash: ITypedHash<any>): Promise<void> {\r\n        return new Promise<void>((resolve, reject) => {\r\n            try {\r\n                this._settings = mergeMaps(this._settings, objectToMap(hash));\r\n                resolve();\r\n            } catch (e) {\r\n                reject(e);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Loads configuration settings into the collection from the supplied provider and returns a Promise\r\n     *\r\n     * @param {IConfigurationProvider} provider The provider from which we will load the settings\r\n     */\r\n    public load(provider: IConfigurationProvider): Promise<void> {\r\n        return new Promise<void>((resolve, reject) => {\r\n            provider.getConfiguration().then((value) => {\r\n                this._settings = mergeMaps(this._settings, objectToMap(value));\r\n                resolve();\r\n            }).catch(reject);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Gets a value from the configuration\r\n     *\r\n     * @param {string} key The key whose value we want to return. Returns null if the key does not exist\r\n     * @return {string} string value from the configuration\r\n     */\r\n    public get(key: string): string | null {\r\n        return this._settings.get(key) || null;\r\n    }\r\n\r\n    /**\r\n     * Gets a JSON value, rehydrating the stored string to the original object\r\n     *\r\n     * @param {string} key The key whose value we want to return. Returns null if the key does not exist\r\n     * @return {any} object from the configuration\r\n     */\r\n    public getJSON(key: string): any {\r\n        const o = this.get(key);\r\n        if (o === undefined || o === null) {\r\n            return o;\r\n        }\r\n\r\n        return JSON.parse(o);\r\n    }\r\n}\r\n","import { IConfigurationProvider } from \"../configuration\";\r\nimport { ITypedHash, IPnPClientStore, PnPClientStorage } from \"@pnp/common\";\r\n\r\n/**\r\n * A caching provider which can wrap other non-caching providers\r\n *\r\n */\r\nexport default class CachingConfigurationProvider implements IConfigurationProvider {\r\n\r\n    private store: IPnPClientStore;\r\n\r\n    /**\r\n     * Creates a new caching configuration provider\r\n     * @constructor\r\n     * @param {IConfigurationProvider} wrappedProvider Provider which will be used to fetch the configuration\r\n     * @param {string} cacheKey Key that will be used to store cached items to the cache\r\n     * @param {IPnPClientStore} cacheStore OPTIONAL storage, which will be used to store cached settings.\r\n     */\r\n    constructor(private wrappedProvider: IConfigurationProvider, private cacheKey: string, cacheStore?: IPnPClientStore) {\r\n        this.wrappedProvider = wrappedProvider;\r\n        this.store = (cacheStore) ? cacheStore : this.selectPnPCache();\r\n    }\r\n\r\n    /**\r\n     * Gets the wrapped configuration providers\r\n     *\r\n     * @return {IConfigurationProvider} Wrapped configuration provider\r\n     */\r\n    public getWrappedProvider(): IConfigurationProvider {\r\n        return this.wrappedProvider;\r\n    }\r\n\r\n    /**\r\n     * Loads the configuration values either from the cache or from the wrapped provider\r\n     *\r\n     * @return {Promise<ITypedHash<string>>} Promise of loaded configuration values\r\n     */\r\n    public getConfiguration(): Promise<ITypedHash<string>> {\r\n        // Cache not available, pass control to the wrapped provider\r\n        if ((!this.store) || (!this.store.enabled)) {\r\n            return this.wrappedProvider.getConfiguration();\r\n        }\r\n\r\n        return this.store.getOrPut(this.cacheKey, () => {\r\n            return this.wrappedProvider.getConfiguration().then((providedConfig) => {\r\n                this.store.put(this.cacheKey, providedConfig);\r\n                return providedConfig;\r\n            });\r\n        });\r\n    }\r\n\r\n    private selectPnPCache(): IPnPClientStore {\r\n        const pnpCache = new PnPClientStorage();\r\n        if ((pnpCache.local) && (pnpCache.local.enabled)) {\r\n            return pnpCache.local;\r\n        }\r\n        if ((pnpCache.session) && (pnpCache.session.enabled)) {\r\n            return pnpCache.session;\r\n        }\r\n        throw Error(\"Cannot create a caching configuration provider since cache is not available.\");\r\n    }\r\n}\r\n","import { IConfigurationProvider } from \"../configuration\";\r\nimport { ITypedHash } from \"@pnp/common\";\r\nimport { default as CachingConfigurationProvider } from \"./cachingConfigurationProvider\";\r\nimport { IWeb } from \"@pnp/sp/webs\";\r\nimport \"@pnp/sp/lists/web\";\r\nimport \"@pnp/sp/items/list\";\r\n\r\n/**\r\n * A configuration provider which loads configuration values from a SharePoint list\r\n *\r\n */\r\nexport default class SPListConfigurationProvider implements IConfigurationProvider {\r\n    /**\r\n     * Creates a new SharePoint list based configuration provider\r\n     * @constructor\r\n     * @param {string} webUrl Url of the SharePoint site, where the configuration list is located\r\n     * @param {string} listTitle Title of the SharePoint list, which contains the configuration settings (optional, default: \"config\")\r\n     * @param {string} keyFieldName The name of the field in the list to use as the setting key (optional, default: \"Title\")\r\n     * @param {string} valueFieldName The name of the field in the list to use as the setting value (optional, default: \"Value\")\r\n     */\r\n    constructor(public readonly web: IWeb, public readonly listTitle = \"config\", private keyFieldName = \"Title\", private valueFieldName = \"Value\") { }\r\n\r\n    /**\r\n     * Loads the configuration values from the SharePoint list\r\n     *\r\n     * @return {Promise<ITypedHash<string>>} Promise of loaded configuration values\r\n     */\r\n    public getConfiguration(): Promise<ITypedHash<string>> {\r\n\r\n        return this.web.lists.getByTitle(this.listTitle).items.select(this.keyFieldName, this.valueFieldName)<any[]>()\r\n            .then((data: any[]) => data.reduce((c: any, item: any) => {\r\n                c[item[this.keyFieldName]] = item[this.valueFieldName];\r\n                return c;\r\n            }, {}));\r\n    }\r\n\r\n    /**\r\n     * Wraps the current provider in a cache enabled provider\r\n     *\r\n     * @return {CachingConfigurationProvider} Caching providers which wraps the current provider\r\n     */\r\n    public asCaching(cacheKey = `pnp_configcache_splist_${this.web.toUrl()}+${this.listTitle}`): CachingConfigurationProvider {\r\n        return new CachingConfigurationProvider(this, cacheKey);\r\n    }\r\n}\r\n","// reference: https://msdn.microsoft.com/en-us/library/office/dn600183.aspx\r\n\r\n/**\r\n * Represents the unique sequential location of a change within the change log.\r\n */\r\nexport interface IChangeToken {\r\n    /**\r\n     * Gets or sets a string value that contains the serialized representation of the change token generated by the protocol server.\r\n     */\r\n    StringValue: string;\r\n}\r\n\r\n/**\r\n * Defines a query that is performed against the change log.\r\n */\r\nexport interface IChangeQuery {\r\n    /**\r\n     * Gets or sets a value that specifies whether add changes are included in the query.\r\n     */\r\n    Add?: boolean;\r\n\r\n    /**\r\n     * Gets or sets a value that specifies whether changes to alerts are included in the query.\r\n     */\r\n    Alert?: boolean;\r\n\r\n    /**\r\n     * Gets or sets a value that specifies the end date and end time for changes that are returned through the query.\r\n     */\r\n    ChangeTokenEnd?: IChangeToken;\r\n\r\n    /**\r\n     * Gets or sets a value that specifies the start date and start time for changes that are returned through the query.\r\n     */\r\n    ChangeTokenStart?: IChangeToken;\r\n\r\n    /**\r\n     * Gets or sets a value that specifies whether changes to content types are included in the query.\r\n     */\r\n    ContentType?: boolean;\r\n\r\n    /**\r\n     * Gets or sets a value that specifies whether deleted objects are included in the query.\r\n     */\r\n    DeleteObject?: boolean;\r\n\r\n    /**\r\n     * Gets or sets a value that specifies whether changes to fields are included in the query.\r\n     */\r\n    Field?: boolean;\r\n\r\n    /**\r\n     * Gets or sets a value that specifies whether changes to files are included in the query.\r\n     */\r\n    File?: boolean;\r\n\r\n    /**\r\n     * Gets or sets value that specifies whether changes to folders are included in the query.\r\n     */\r\n    Folder?: boolean;\r\n\r\n    /**\r\n     * Gets or sets a value that specifies whether changes to groups are included in the query.\r\n     */\r\n    Group?: boolean;\r\n\r\n    /**\r\n     * Gets or sets a value that specifies whether adding users to groups is included in the query.\r\n     */\r\n    GroupMembershipAdd?: boolean;\r\n\r\n    /**\r\n     * Gets or sets a value that specifies whether deleting users from the groups is included in the query.\r\n     */\r\n    GroupMembershipDelete?: boolean;\r\n\r\n    /**\r\n     * Gets or sets a value that specifies whether general changes to list items are included in the query.\r\n     */\r\n    Item?: boolean;\r\n\r\n    /**\r\n     * Gets or sets a value that specifies whether changes to lists are included in the query.\r\n     */\r\n    List?: boolean;\r\n\r\n    /**\r\n     * Gets or sets a value that specifies whether move changes are included in the query.\r\n     */\r\n    Move?: boolean;\r\n\r\n    /**\r\n     * Gets or sets a value that specifies whether changes to the navigation structure of a site collection are included in the query.\r\n     */\r\n    Navigation?: boolean;\r\n\r\n    /**\r\n     * Gets or sets a value that specifies whether renaming changes are included in the query.\r\n     */\r\n    Rename?: boolean;\r\n\r\n    /**\r\n     * Gets or sets a value that specifies whether restoring items from the recycle bin or from backups is included in the query.\r\n     */\r\n    Restore?: boolean;\r\n\r\n    /**\r\n     * Gets or sets a value that specifies whether adding role assignments is included in the query.\r\n     */\r\n    RoleAssignmentAdd?: boolean;\r\n\r\n    /**\r\n     * Gets or sets a value that specifies whether adding role assignments is included in the query.\r\n     */\r\n    RoleAssignmentDelete?: boolean;\r\n\r\n    /**\r\n     * Gets or sets a value that specifies whether adding role assignments is included in the query.\r\n     */\r\n    RoleDefinitionAdd?: boolean;\r\n\r\n    /**\r\n     * Gets or sets a value that specifies whether adding role assignments is included in the query.\r\n     */\r\n    RoleDefinitionDelete?: boolean;\r\n\r\n    /**\r\n     * Gets or sets a value that specifies whether adding role assignments is included in the query.\r\n     */\r\n    RoleDefinitionUpdate?: boolean;\r\n\r\n    /**\r\n     * Gets or sets a value that specifies whether modifications to security policies are included in the query.\r\n     */\r\n    SecurityPolicy?: boolean;\r\n\r\n    /**\r\n     * Gets or sets a value that specifies whether changes to site collections are included in the query.\r\n     */\r\n    Site?: boolean;\r\n\r\n    /**\r\n     * Gets or sets a value that specifies whether updates made using the item SystemUpdate method are included in the query.\r\n     */\r\n    SystemUpdate?: boolean;\r\n\r\n    /**\r\n     * Gets or sets a value that specifies whether update changes are included in the query.\r\n     */\r\n    Update?: boolean;\r\n\r\n    /**\r\n     * Gets or sets a value that specifies whether changes to users are included in the query.\r\n     */\r\n    User?: boolean;\r\n\r\n    /**\r\n     * Gets or sets a value that specifies whether changes to views are included in the query.\r\n     */\r\n    View?: boolean;\r\n\r\n    /**\r\n     * Gets or sets a value that specifies whether changes to Web sites are included in the query.\r\n     */\r\n    Web?: boolean;\r\n}\r\n\r\n/**\r\n * Specifies the type of a principal.\r\n */\r\n/* tslint:disable:no-bitwise */\r\nexport const enum PrincipalType {\r\n    /**\r\n     * Enumeration whose value specifies no principal type.\r\n     */\r\n    None = 0,\r\n    /**\r\n     * Enumeration whose value specifies a user as the principal type.\r\n     */\r\n    User = 1,\r\n    /**\r\n     * Enumeration whose value specifies a distribution list as the principal type.\r\n     */\r\n    DistributionList = 2,\r\n    /**\r\n     * Enumeration whose value specifies a security group as the principal type.\r\n     */\r\n    SecurityGroup = 4,\r\n    /**\r\n     * Enumeration whose value specifies a group as the principal type.\r\n     */\r\n    SharePointGroup = 8,\r\n    /**\r\n     * Enumeration whose value specifies all principal types.\r\n     */\r\n    All = SharePointGroup | SecurityGroup | DistributionList | User,\r\n}\r\n/* tslint:enable:no-bitwise */\r\n\r\n/**\r\n * Specifies the source of a principal.\r\n */\r\n/* tslint:disable:no-bitwise */\r\nexport const enum PrincipalSource {\r\n    /**\r\n     * Enumeration whose value specifies no principal source.\r\n     */\r\n    None = 0,\r\n    /**\r\n     * Enumeration whose value specifies user information list as the principal source.\r\n     */\r\n    UserInfoList = 1,\r\n    /**\r\n     * Enumeration whose value specifies Active Directory as the principal source.\r\n     */\r\n    Windows = 2,\r\n    /**\r\n     * Enumeration whose value specifies the current membership provider as the principal source.\r\n     */\r\n    MembershipProvider = 4,\r\n    /**\r\n     * Enumeration whose value specifies the current role provider as the principal source.\r\n     */\r\n    RoleProvider = 8,\r\n    /**\r\n     * Enumeration whose value specifies all principal sources.\r\n     */\r\n    All = RoleProvider | MembershipProvider | Windows | UserInfoList,\r\n}\r\n/* tslint:enable:no-bitwise */\r\n\r\nexport interface IPrincipalInfo {\r\n    Department: string;\r\n    DisplayName: string;\r\n    Email: string;\r\n    JobTitle: string;\r\n    LoginName: string;\r\n    Mobile: string;\r\n    PrincipalId: number;\r\n    PrincipalType: PrincipalType;\r\n    SIPAddress: string;\r\n}\r\n\r\nexport enum PageType {\r\n    Invalid = -1,\r\n    DefaultView,\r\n    NormalView,\r\n    DialogView,\r\n    View,\r\n    DisplayForm,\r\n    DisplayFormDialog,\r\n    EditForm,\r\n    EditFormDialog,\r\n    NewForm,\r\n    NewFormDialog,\r\n    SolutionForm,\r\n    PAGE_MAXITEMS,\r\n}\r\n","const InvalidFileFolderNameCharsOnlineRegex = /[\"*:<>?/\\\\|\\x00-\\x1f\\x7f-\\x9f]/g;\r\nconst InvalidFileFolderNameCharsOnPremiseRegex = /[\"#%*:<>?/\\\\|\\x00-\\x1f\\x7f-\\x9f]/g;\r\n\r\n/**\r\n * Checks if file or folder name contains invalid characters\r\n *\r\n * @param input File or folder name to check\r\n * @param onPremise Set to true for SharePoint On-Premise\r\n * @returns True if contains invalid chars, false otherwise\r\n */\r\nexport function containsInvalidFileFolderChars(input: string, onPremise = false): boolean {\r\n    if (onPremise) {\r\n        return InvalidFileFolderNameCharsOnPremiseRegex.test(input);\r\n    } else {\r\n        return InvalidFileFolderNameCharsOnlineRegex.test(input);\r\n    }\r\n}\r\n\r\n/**\r\n * Removes invalid characters from file or folder name\r\n *\r\n * @param input File or folder name\r\n * @param replacer Value that will replace invalid characters\r\n * @param onPremise Set to true for SharePoint On-Premise\r\n * @returns File or folder name with replaced invalid characters\r\n */\r\nexport function stripInvalidFileFolderChars(input: string, replacer = \"\", onPremise = false): string {\r\n    if (onPremise) {\r\n        return input.replace(InvalidFileFolderNameCharsOnPremiseRegex, replacer);\r\n    } else {\r\n        return input.replace(InvalidFileFolderNameCharsOnlineRegex, replacer);\r\n    }\r\n}\r\n","import { combine, isUrlAbsolute, objectDefinedNotNull, RuntimeConfig, stringIsNullOrEmpty } from \"@pnp/common\";\r\nimport { GraphRuntimeConfig } from \"../graphlibconfig\";\r\n\r\n/**\r\n * Ensures that a given url is absolute for the current web based on context\r\n *\r\n * @param candidateUrl The url to make absolute\r\n *\r\n */\r\nexport async function toAbsoluteUrl(candidateUrl: string): Promise<string> {\r\n\r\n    if (isUrlAbsolute(candidateUrl)) {\r\n        // if we are already absolute, then just return the url\r\n        return candidateUrl;\r\n    }\r\n\r\n    if (!stringIsNullOrEmpty(GraphRuntimeConfig.baseUrl)) {\r\n        // base url specified either with baseUrl of spfxContext config property\r\n        return combine(GraphRuntimeConfig.baseUrl, candidateUrl);\r\n    }\r\n\r\n    if (objectDefinedNotNull(RuntimeConfig.spfxContext)) {\r\n\r\n        try {\r\n\r\n            // this may let us read the url from the graph context\r\n            const client = await RuntimeConfig.spfxContext.msGraphClientFactory.getClient();\r\n            const baseUrl: string | null = (<any>client)?.constructor?._graphBaseUrl;\r\n\r\n            if (!stringIsNullOrEmpty(baseUrl)) {\r\n                return combine(baseUrl, candidateUrl);\r\n            }\r\n\r\n            // tslint:disable-next-line: no-empty\r\n        } catch (e) { }\r\n    }\r\n\r\n    // try one last time with the default\r\n    return combine(\"https://graph.microsoft.com\", candidateUrl);\r\n}\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _Web, Web } from \"../webs/types\";\r\nimport { Lists, ILists, IList, List } from \"./types\";\r\nimport { odataUrlFrom } from \"../odata\";\r\nimport { ISharePointQueryableCollection, SharePointQueryableCollection } from \"../sharepointqueryable\";\r\nimport { escapeQueryStrValue } from \"../utils/escapeQueryStrValue\";\r\n\r\ndeclare module \"../webs/types\" {\r\n    interface _Web {\r\n        readonly lists: ILists;\r\n        readonly siteUserInfoList: IList;\r\n        readonly defaultDocumentLibrary: IList;\r\n        readonly customListTemplates: ISharePointQueryableCollection;\r\n        getList(listRelativeUrl: string): IList;\r\n        getCatalog(type: number): Promise<IList>;\r\n    }\r\n    interface IWeb {\r\n\r\n        /**\r\n         * Gets the collection of all lists that are contained in the Web site\r\n         */\r\n        readonly lists: ILists;\r\n\r\n        /**\r\n         * Gets the UserInfo list of the site collection that contains the Web site\r\n         */\r\n        readonly siteUserInfoList: IList;\r\n\r\n        /**\r\n         * Get a reference the default documents library of a web\r\n         */\r\n        readonly defaultDocumentLibrary: IList;\r\n\r\n        /**\r\n         * Gets the collection of all list definitions and list templates that are available\r\n         */\r\n        readonly customListTemplates: ISharePointQueryableCollection;\r\n\r\n        /**\r\n         * Gets a list by server relative url (list's root folder)\r\n         *\r\n         * @param listRelativeUrl The server relative path to the list's root folder (including /sites/ if applicable)\r\n         */\r\n        getList(listRelativeUrl: string): IList;\r\n\r\n        /**\r\n         * Returns the list gallery on the site\r\n         *\r\n         * @param type The gallery type - WebTemplateCatalog = 111, WebPartCatalog = 113 ListTemplateCatalog = 114,\r\n         * MasterPageCatalog = 116, SolutionCatalog = 121, ThemeCatalog = 123, DesignCatalog = 124, AppDataCatalog = 125\r\n         */\r\n        getCatalog(type: number): Promise<IList>;\r\n    }\r\n}\r\n\r\naddProp(_Web, \"lists\", Lists);\r\naddProp(_Web, \"siteUserInfoList\", List, \"siteuserinfolist\");\r\naddProp(_Web, \"defaultDocumentLibrary\", List, \"DefaultDocumentLibrary\");\r\naddProp(_Web, \"customListTemplates\", SharePointQueryableCollection, \"getcustomlisttemplates\");\r\n\r\n_Web.prototype.getList = function (this: _Web, listRelativeUrl: string): IList {\r\n    return List(this, `getList('${escapeQueryStrValue(listRelativeUrl)}')`);\r\n};\r\n\r\n_Web.prototype.getCatalog = async function (this: _Web, type: number): Promise<IList> {\r\n    const data = await this.clone(Web, `getcatalog(${type})`).select(\"Id\").get();\r\n    return List(odataUrlFrom(data));\r\n};\r\n","import {\r\n    _SharePointQueryableInstance,\r\n    ISharePointQueryableInstance,\r\n    _SharePointQueryableCollection,\r\n    spInvokableFactory,\r\n    SharePointQueryableInstance,\r\n    IDeleteableWithETag,\r\n    deleteableWithETag,\r\n} from \"../sharepointqueryable\";\r\nimport { TextParser, BlobParser, JSONParser, BufferParser, headers, body } from \"@pnp/odata\";\r\nimport { assign, getGUID, isFunc, stringIsNullOrEmpty, isUrlAbsolute } from \"@pnp/common\";\r\nimport { Item, IItem } from \"../items\";\r\nimport { odataUrlFrom } from \"../odata\";\r\nimport { defaultPath } from \"../decorators\";\r\nimport { spPost } from \"../operations\";\r\nimport { escapeQueryStrValue } from \"../utils/escapeQueryStrValue\";\r\nimport { extractWebUrl } from \"../utils/extractweburl\";\r\nimport { tag } from \"../telemetry\";\r\nimport { toResourcePath } from \"../utils/toResourcePath\";\r\n\r\n/**\r\n * Describes a collection of File objects\r\n *\r\n */\r\n@defaultPath(\"files\")\r\nexport class _Files extends _SharePointQueryableCollection<IFileInfo[]> {\r\n\r\n    /**\r\n     * Gets a File by filename\r\n     *\r\n     * @param name The name of the file, including extension.\r\n     */\r\n    public getByName(name: string): IFile {\r\n        if (/\\%#/.test(name)) {\r\n            throw Error(\"For file names containing % or # please use web.getFileByServerRelativePath\");\r\n        }\r\n        return tag.configure(File(this).concat(`('${escapeQueryStrValue(name)}')`), \"fis.getByName\");\r\n    }\r\n\r\n    /**\r\n     * Uploads a file. Not supported for batching\r\n     *\r\n     * @param url The folder-relative url of the file.\r\n     * @param content The file contents\r\n     * @param shouldOverWrite Should a file with the same name in the same location be overwritten? (default: true)\r\n     * @returns The new File and the raw response.\r\n     */\r\n    @tag(\"fis.add\")\r\n    public async add(url: string, content: any, shouldOverWrite = true): Promise<IFileAddResult> {\r\n        const response = await spPost(Files(this, `add(overwrite=${shouldOverWrite},url='${escapeQueryStrValue(url)}')`), {\r\n            body: content,\r\n        });\r\n        return {\r\n            data: response,\r\n            file: this.getByName(url),\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Adds a file using the pound percent safe methods\r\n     * \r\n     * @param url Excoded url of the file\r\n     * @param content The file content\r\n     * @param parameters Additional parameters to control method behavior\r\n     */\r\n    @tag(\"fis.addUsingPath\")\r\n    public async addUsingPath(url: string, content: string | ArrayBuffer | Blob, parameters: IAddUsingPathProps = { Overwrite: false }): Promise<IFileAddResult> {\r\n\r\n        const path = [`AddUsingPath(decodedurl='${escapeQueryStrValue(url)}'`];\r\n\r\n        if (parameters) {\r\n            if (parameters.Overwrite) {\r\n                path.push(\",Overwrite=true\");\r\n            }\r\n            if (parameters.AutoCheckoutOnInvalidData) {\r\n                path.push(\",AutoCheckoutOnInvalidData=true\");\r\n            }\r\n            if (!stringIsNullOrEmpty(parameters.XorHash)) {\r\n                path.push(`,XorHash=${escapeQueryStrValue(parameters.XorHash)}`);\r\n            }\r\n        }\r\n\r\n        path.push(\")\");\r\n\r\n        const resp: IFileInfo = await spPost(Files(this, path.join(\"\")), { body: content });\r\n\r\n        return {\r\n            data: resp,\r\n            file: File(odataUrlFrom(resp)),\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Uploads a file. Not supported for batching\r\n     *\r\n     * @param url The folder-relative url of the file.\r\n     * @param content The Blob file content to add\r\n     * @param progress A callback function which can be used to track the progress of the upload\r\n     * @param shouldOverWrite Should a file with the same name in the same location be overwritten? (default: true)\r\n     * @param chunkSize The size of each file slice, in bytes (default: 10485760)\r\n     * @returns The new File and the raw response.\r\n     */\r\n    @tag(\"fis.addChunked\")\r\n    public async addChunked(url: string, content: Blob, progress?: (data: IFileUploadProgressData) => void, shouldOverWrite = true, chunkSize = 10485760): Promise<IFileAddResult> {\r\n\r\n        const info: { ServerRelativeUrl: string } = await spPost(this.clone(Files, `add(overwrite=${shouldOverWrite},url='${escapeQueryStrValue(url)}')`, false));\r\n        const file = File(`_api/web/getFileByServerRelativeUrl('${info.ServerRelativeUrl}')`);\r\n        return await file.setContentChunked(content, progress, chunkSize);\r\n    }\r\n\r\n    /**\r\n     * Adds a ghosted file to an existing list or document library. Not supported for batching.\r\n     *\r\n     * @param fileUrl The server-relative url where you want to save the file.\r\n     * @param templateFileType The type of use to create the file.\r\n     * @returns The template file that was added and the raw response.\r\n     */\r\n    @tag(\"fis.addTemplateFile\")\r\n    public async addTemplateFile(fileUrl: string, templateFileType: TemplateFileType): Promise<IFileAddResult> {\r\n        const response = await spPost(this.clone(Files, `addTemplateFile(urloffile='${escapeQueryStrValue(fileUrl)}',templatefiletype=${templateFileType})`, false));\r\n        return {\r\n            data: response,\r\n            file: File(odataUrlFrom(response)),\r\n        };\r\n    }\r\n}\r\nexport interface IFiles extends _Files { }\r\nexport const Files = spInvokableFactory<IFiles>(_Files);\r\n\r\n/**\r\n * Describes a single File instance\r\n *\r\n */\r\nexport class _File extends _SharePointQueryableInstance<IFileInfo> {\r\n\r\n    public delete = deleteableWithETag(\"fi\");\r\n\r\n    /**\r\n     * Gets a value that specifies the list item field values for the list item corresponding to the file.\r\n     *\r\n     */\r\n    public get listItemAllFields(): ISharePointQueryableInstance {\r\n        return tag.configure(SharePointQueryableInstance(this, \"listItemAllFields\"), \"fi.listItemAllFields\");\r\n    }\r\n\r\n    /**\r\n     * Gets a collection of versions\r\n     *\r\n     */\r\n    public get versions(): IVersions {\r\n        return tag.configure(Versions(this), \"fi.versions\");\r\n    }\r\n\r\n    /**\r\n     * Approves the file submitted for content approval with the specified comment.\r\n     * Only documents in lists that are enabled for content approval can be approved.\r\n     *\r\n     * @param comment The comment for the approval.\r\n     */\r\n    @tag(\"fi.approve\")\r\n    public approve(comment = \"\"): Promise<void> {\r\n        return spPost(this.clone(File, `approve(comment='${escapeQueryStrValue(comment)}')`));\r\n    }\r\n\r\n    /**\r\n     * Stops the chunk upload session without saving the uploaded data. Does not support batching.\r\n     * If the file doesn’t already exist in the library, the partially uploaded file will be deleted.\r\n     * Use this in response to user action (as in a request to cancel an upload) or an error or exception.\r\n     * Use the uploadId value that was passed to the StartUpload method that started the upload session.\r\n     * This method is currently available only on Office 365.\r\n     *\r\n     * @param uploadId The unique identifier of the upload session.\r\n     */\r\n    @tag(\"fi.cancelUpload\")\r\n    public cancelUpload(uploadId: string): Promise<void> {\r\n        return spPost(this.clone(File, `cancelUpload(uploadId=guid'${uploadId}')`, false));\r\n    }\r\n\r\n    /**\r\n     * Checks the file in to a document library based on the check-in type.\r\n     *\r\n     * @param comment A comment for the check-in. Its length must be <= 1023.\r\n     * @param checkinType The check-in type for the file.\r\n     */\r\n    @tag(\"fi.checkin\")\r\n    public checkin(comment = \"\", checkinType = CheckinType.Major): Promise<void> {\r\n\r\n        if (comment.length > 1023) {\r\n            throw Error(\"The maximum comment length is 1023 characters.\");\r\n        }\r\n\r\n        return spPost(this.clone(File, `checkin(comment='${escapeQueryStrValue(comment)}',checkintype=${checkinType})`));\r\n    }\r\n\r\n    /**\r\n     * Checks out the file from a document library.\r\n     */\r\n    @tag(\"fi.checkout\")\r\n    public checkout(): Promise<void> {\r\n        return spPost(this.clone(File, \"checkout\"));\r\n    }\r\n\r\n    /**\r\n     * Copies the file to the destination url.\r\n     *\r\n     * @param url The absolute url or server relative url of the destination file path to copy to.\r\n     * @param shouldOverWrite Should a file with the same name in the same location be overwritten?\r\n     */\r\n    @tag(\"fi.copyTo\")\r\n    public copyTo(url: string, shouldOverWrite = true): Promise<void> {\r\n        return spPost(this.clone(File, `copyTo(strnewurl='${escapeQueryStrValue(url)}',boverwrite=${shouldOverWrite})`));\r\n    }\r\n\r\n    /**\r\n     * Copies the file by path to destination path.\r\n     * Also works with different site collections.\r\n     *\r\n     * @param destUrl The absolute url or server relative url of the destination file path to copy to.\r\n     * @param shouldOverWrite Should a file with the same name in the same location be overwritten?\r\n     * @param keepBoth Keep both if file with the same name in the same location already exists? Only relevant when shouldOverWrite is set to false.\r\n     */\r\n    @tag(\"fi.copyByPath\")\r\n    public async copyByPath(destUrl: string, shouldOverWrite: boolean, KeepBoth = false): Promise<void> {\r\n\r\n        const { ServerRelativeUrl: srcUrl, [\"odata.id\"]: absoluteUrl } = await this.select(\"ServerRelativeUrl\")();\r\n        const webBaseUrl = extractWebUrl(absoluteUrl);\r\n        const hostUrl = webBaseUrl.replace(\"://\", \"___\").split(\"/\")[0].replace(\"___\", \"://\");\r\n        await spPost(File(webBaseUrl, `/_api/SP.MoveCopyUtil.CopyFileByPath(overwrite=@a1)?@a1=${shouldOverWrite}`),\r\n            body({\r\n                destPath: toResourcePath(isUrlAbsolute(destUrl) ? destUrl : `${hostUrl}${destUrl}`),\r\n                options: {\r\n                    KeepBoth: KeepBoth,\r\n                    ResetAuthorAndCreatedOnCopy: true,\r\n                    ShouldBypassSharedLocks: true,\r\n                    __metadata: {\r\n                        type: \"SP.MoveCopyOptions\",\r\n                    },\r\n                },\r\n                srcPath: toResourcePath(isUrlAbsolute(srcUrl) ? srcUrl : `${hostUrl}${srcUrl}`),\r\n            }));\r\n    }\r\n\r\n    /**\r\n     * Denies approval for a file that was submitted for content approval.\r\n     * Only documents in lists that are enabled for content approval can be denied.\r\n     *\r\n     * @param comment The comment for the denial.\r\n     */\r\n    @tag(\"fi.deny\")\r\n    public deny(comment = \"\"): Promise<void> {\r\n        if (comment.length > 1023) {\r\n            throw Error(\"The maximum comment length is 1023 characters.\");\r\n        }\r\n        return spPost(this.clone(File, `deny(comment='${escapeQueryStrValue(comment)}')`));\r\n    }\r\n\r\n    /**\r\n     * Moves the file to the specified destination url.\r\n     *\r\n     * @param url The absolute url or server relative url of the destination file path to move to.\r\n     * @param moveOperations The bitwise MoveOperations value for how to move the file.\r\n     */\r\n    @tag(\"fi.moveTo\")\r\n    public moveTo(url: string, moveOperations = MoveOperations.Overwrite): Promise<void> {\r\n        return spPost(this.clone(File, `moveTo(newurl='${escapeQueryStrValue(url)}',flags=${moveOperations})`));\r\n    }\r\n\r\n    /**\r\n     * Moves the file by path to the specified destination url.\r\n     * Also works with different site collections.\r\n     *\r\n     * @param destUrl The absolute url or server relative url of the destination file path to move to.\r\n     * @param shouldOverWrite Should a file with the same name in the same location be overwritten?\r\n     * @param keepBoth Keep both if file with the same name in the same location already exists? Only relevant when shouldOverWrite is set to false.\r\n     */\r\n    @tag(\"fi.moveByPath\")\r\n    public async moveByPath(destUrl: string, shouldOverWrite: boolean, KeepBoth = false): Promise<void> {\r\n\r\n        const { ServerRelativeUrl: srcUrl, [\"odata.id\"]: absoluteUrl } = await this.select(\"ServerRelativeUrl\")();\r\n        const webBaseUrl = extractWebUrl(absoluteUrl);\r\n        const hostUrl = webBaseUrl.replace(\"://\", \"___\").split(\"/\")[0].replace(\"___\", \"://\");\r\n        await spPost(File(webBaseUrl, `/_api/SP.MoveCopyUtil.MoveFileByPath(overwrite=@a1)?@a1=${shouldOverWrite}`),\r\n            body({\r\n                destPath: toResourcePath(isUrlAbsolute(destUrl) ? destUrl : `${hostUrl}${destUrl}`),\r\n                options: {\r\n                    KeepBoth: KeepBoth,\r\n                    ResetAuthorAndCreatedOnCopy: false,\r\n                    ShouldBypassSharedLocks: true,\r\n                    __metadata: {\r\n                        type: \"SP.MoveCopyOptions\",\r\n                    },\r\n                },\r\n                srcPath: toResourcePath(isUrlAbsolute(srcUrl) ? srcUrl : `${hostUrl}${srcUrl}`),\r\n            }));\r\n    }\r\n\r\n    /**\r\n     * Submits the file for content approval with the specified comment.\r\n     *\r\n     * @param comment The comment for the published file. Its length must be <= 1023.\r\n     */\r\n    @tag(\"fi.publish\")\r\n    public publish(comment = \"\"): Promise<void> {\r\n        if (comment.length > 1023) {\r\n            throw Error(\"The maximum comment length is 1023 characters.\");\r\n        }\r\n        return spPost(this.clone(File, `publish(comment='${escapeQueryStrValue(comment)}')`));\r\n    }\r\n\r\n    /**\r\n     * Moves the file to the Recycle Bin and returns the identifier of the new Recycle Bin item.\r\n     *\r\n     * @returns The GUID of the recycled file.\r\n     */\r\n    @tag(\"fi.recycle\")\r\n    public recycle(): Promise<string> {\r\n        return spPost(this.clone(File, \"recycle\"));\r\n    }\r\n\r\n    /**\r\n     * Deletes the file object with options.\r\n     * \r\n     * @param parameters Specifies the options to use when deleting a file.\r\n     */\r\n    @tag(\"fi.del-params\")\r\n    public async deleteWithParams(parameters: Partial<IFileDeleteParams>): Promise<void> {\r\n        return spPost(this.clone(File, \"DeleteWithParameters\"), body({ parameters }));\r\n    }\r\n\r\n    /**\r\n     * Reverts an existing checkout for the file.\r\n     *\r\n     */\r\n    @tag(\"fi.undoCheckout\")\r\n    public undoCheckout(): Promise<void> {\r\n        return spPost(this.clone(File, \"undoCheckout\"));\r\n    }\r\n\r\n    /**\r\n     * Removes the file from content approval or unpublish a major version.\r\n     *\r\n     * @param comment The comment for the unpublish operation. Its length must be <= 1023.\r\n     */\r\n    @tag(\"fi.unpublish\")\r\n    public unpublish(comment = \"\"): Promise<void> {\r\n        if (comment.length > 1023) {\r\n            throw Error(\"The maximum comment length is 1023 characters.\");\r\n        }\r\n        return spPost(this.clone(File, `unpublish(comment='${escapeQueryStrValue(comment)}')`));\r\n    }\r\n\r\n    /**\r\n     * Checks to see if the file represented by this object exists\r\n     *\r\n     */\r\n    @tag(\"fi.exists\")\r\n    public async exists(): Promise<boolean> {\r\n        try {\r\n            const r = await this.clone(File).select(\"Exists\")();\r\n            return r.Exists;\r\n        } catch (e) {\r\n            // this treats any error here as the file not existing, which\r\n            // might not be true, but is good enough.\r\n            return false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets the contents of the file as text. Not supported in batching.\r\n     *\r\n     */\r\n    @tag(\"fi.getText\")\r\n    public getText(): Promise<string> {\r\n\r\n        return this.clone(File, \"$value\", false).usingParser(new TextParser())(headers({ \"binaryStringResponseBody\": \"true\" }));\r\n    }\r\n\r\n    /**\r\n     * Gets the contents of the file as a blob, does not work in Node.js. Not supported in batching.\r\n     *\r\n     */\r\n    @tag(\"fi.getBlob\")\r\n    public getBlob(): Promise<Blob> {\r\n\r\n        return this.clone(File, \"$value\", false).usingParser(new BlobParser())(headers({ \"binaryStringResponseBody\": \"true\" }));\r\n    }\r\n\r\n    /**\r\n     * Gets the contents of a file as an ArrayBuffer, works in Node.js. Not supported in batching.\r\n     */\r\n    @tag(\"fi.getBuffer\")\r\n    public getBuffer(): Promise<ArrayBuffer> {\r\n\r\n        return this.clone(File, \"$value\", false).usingParser(new BufferParser())(headers({ \"binaryStringResponseBody\": \"true\" }));\r\n    }\r\n\r\n    /**\r\n     * Gets the contents of a file as an ArrayBuffer, works in Node.js. Not supported in batching.\r\n     */\r\n    @tag(\"fi.getJSON\")\r\n    public getJSON(): Promise<any> {\r\n\r\n        return this.clone(File, \"$value\", false).usingParser(new JSONParser())(headers({ \"binaryStringResponseBody\": \"true\" }));\r\n    }\r\n\r\n    /**\r\n     * Sets the content of a file, for large files use setContentChunked. Not supported in batching.\r\n     *\r\n     * @param content The file content\r\n     *\r\n     */\r\n    @tag(\"fi.setContent\")\r\n    public async setContent(content: string | ArrayBuffer | Blob): Promise<IFile> {\r\n\r\n        await spPost(this.clone(File, \"$value\", false), {\r\n            body: content,\r\n            headers: {\r\n                \"X-HTTP-Method\": \"PUT\",\r\n            },\r\n        });\r\n        return File(this);\r\n    }\r\n\r\n    /**\r\n     * Gets the associated list item for this folder, loading the default properties\r\n     */\r\n    @tag(\"fi.getItem\")\r\n    public async getItem<T>(...selects: string[]): Promise<IItem & T> {\r\n\r\n        const q = this.listItemAllFields;\r\n        const d = await q.select.apply(q, selects)();\r\n        return assign(Item(odataUrlFrom(d)), d);\r\n    }\r\n\r\n    /**\r\n     * Sets the contents of a file using a chunked upload approach. Not supported in batching.\r\n     *\r\n     * @param file The file to upload\r\n     * @param progress A callback function which can be used to track the progress of the upload\r\n     * @param chunkSize The size of each file slice, in bytes (default: 10485760)\r\n     */\r\n    public async setContentChunked(file: Blob, progress?: (data: IFileUploadProgressData) => void, chunkSize = 10485760): Promise<IFileAddResult> {\r\n\r\n        if (!isFunc(progress)) {\r\n            progress = () => null;\r\n        }\r\n\r\n        const fileSize = file.size;\r\n        const totalBlocks = parseInt((fileSize / chunkSize).toString(), 10) + ((fileSize % chunkSize === 0) ? 1 : 0);\r\n        const uploadId = getGUID();\r\n\r\n        // report that we are starting\r\n        progress({ uploadId, blockNumber: 1, chunkSize, currentPointer: 0, fileSize, stage: \"starting\", totalBlocks });\r\n        let currentPointer = await this.startUpload(uploadId, file.slice(0, chunkSize));\r\n\r\n        // skip the first and last blocks\r\n        for (let i = 2; i < totalBlocks; i++) {\r\n            progress({ uploadId, blockNumber: i, chunkSize, currentPointer, fileSize, stage: \"continue\", totalBlocks });\r\n            currentPointer = await this.continueUpload(uploadId, currentPointer, file.slice(currentPointer, currentPointer + chunkSize));\r\n        }\r\n\r\n        progress({ uploadId, blockNumber: totalBlocks, chunkSize, currentPointer, fileSize, stage: \"finishing\", totalBlocks });\r\n        return this.finishUpload(uploadId, currentPointer, file.slice(currentPointer));\r\n    }\r\n\r\n    /**\r\n     * Starts a new chunk upload session and uploads the first fragment.\r\n     * The current file content is not changed when this method completes.\r\n     * The method is idempotent (and therefore does not change the result) as long as you use the same values for uploadId and stream.\r\n     * The upload session ends either when you use the CancelUpload method or when you successfully\r\n     * complete the upload session by passing the rest of the file contents through the ContinueUpload and FinishUpload methods.\r\n     * The StartUpload and ContinueUpload methods return the size of the running total of uploaded data in bytes,\r\n     * so you can pass those return values to subsequent uses of ContinueUpload and FinishUpload.\r\n     * This method is currently available only on Office 365.\r\n     *\r\n     * @param uploadId The unique identifier of the upload session.\r\n     * @param fragment The file contents.\r\n     * @returns The size of the total uploaded data in bytes.\r\n     */\r\n    @tag(\"fi.startUpload\")\r\n    protected async startUpload(uploadId: string, fragment: ArrayBuffer | Blob): Promise<number> {\r\n        let n = await spPost(this.clone(File, `startUpload(uploadId=guid'${uploadId}')`, false), { body: fragment });\r\n        if (typeof n === \"object\") {\r\n            // When OData=verbose the payload has the following shape:\r\n            // { StartUpload: \"10485760\" }\r\n            n = (n as any).StartUpload;\r\n        }\r\n        return parseFloat(n);\r\n    }\r\n\r\n    /**\r\n     * Continues the chunk upload session with an additional fragment.\r\n     * The current file content is not changed.\r\n     * Use the uploadId value that was passed to the StartUpload method that started the upload session.\r\n     * This method is currently available only on Office 365.\r\n     *\r\n     * @param uploadId The unique identifier of the upload session.\r\n     * @param fileOffset The size of the offset into the file where the fragment starts.\r\n     * @param fragment The file contents.\r\n     * @returns The size of the total uploaded data in bytes.\r\n     */\r\n    @tag(\"fi.continueUpload\")\r\n    protected async continueUpload(uploadId: string, fileOffset: number, fragment: ArrayBuffer | Blob): Promise<number> {\r\n        let n = await spPost(this.clone(File, `continueUpload(uploadId=guid'${uploadId}',fileOffset=${fileOffset})`, false), { body: fragment });\r\n        if (typeof n === \"object\") {\r\n            // When OData=verbose the payload has the following shape:\r\n            // { ContinueUpload: \"20971520\" }\r\n            n = (n as any).ContinueUpload;\r\n        }\r\n        return parseFloat(n);\r\n    }\r\n\r\n    /**\r\n     * Uploads the last file fragment and commits the file. The current file content is changed when this method completes.\r\n     * Use the uploadId value that was passed to the StartUpload method that started the upload session.\r\n     * This method is currently available only on Office 365.\r\n     *\r\n     * @param uploadId The unique identifier of the upload session.\r\n     * @param fileOffset The size of the offset into the file where the fragment starts.\r\n     * @param fragment The file contents.\r\n     * @returns The newly uploaded file.\r\n     */\r\n    @tag(\"fi.finishUpload\")\r\n    protected async finishUpload(uploadId: string, fileOffset: number, fragment: ArrayBuffer | Blob): Promise<IFileAddResult> {\r\n        const response = await spPost(this.clone(File, `finishUpload(uploadId=guid'${uploadId}',fileOffset=${fileOffset})`, false), { body: fragment });\r\n        return {\r\n            data: response,\r\n            file: File(odataUrlFrom(response)),\r\n        };\r\n    }\r\n}\r\n\r\nexport interface IFile extends _File, IDeleteableWithETag { }\r\nexport const File = spInvokableFactory<IFile>(_File);\r\n\r\n/**\r\n * Describes a collection of Version objects\r\n *\r\n */\r\n@defaultPath(\"versions\")\r\nexport class _Versions extends _SharePointQueryableCollection {\r\n\r\n    /**\t\r\n     * Gets a version by id\t\r\n     *\t\r\n     * @param versionId The id of the version to retrieve\t\r\n     */\r\n    public getById(versionId: number): IVersion {\r\n        return tag.configure(Version(this).concat(`(${versionId})`), \"vers.getById\");\r\n    }\r\n\r\n    /**\r\n     * Deletes all the file version objects in the collection.\r\n     *\r\n     */\r\n    @tag(\"vers.deleteAll\")\r\n    public deleteAll(): Promise<void> {\r\n        return spPost(Versions(this, \"deleteAll\"));\r\n    }\r\n\r\n    /**\r\n     * Deletes the specified version of the file.\r\n     *\r\n     * @param versionId The ID of the file version to delete.\r\n     */\r\n    @tag(\"vers.deleteById\")\r\n    public deleteById(versionId: number): Promise<void> {\r\n        return spPost(this.clone(Versions, `deleteById(vid=${versionId})`));\r\n    }\r\n\r\n    /**\r\n     * Recycles the specified version of the file.\r\n     *\r\n     * @param versionId The ID of the file version to delete.\r\n     */\r\n    @tag(\"vers.recycleByID\")\r\n    public recycleByID(versionId: number): Promise<void> {\r\n        return spPost(this.clone(Versions, `recycleByID(vid=${versionId})`));\r\n    }\r\n\r\n    /**\r\n     * Deletes the file version object with the specified version label.\r\n     *\r\n     * @param label The version label of the file version to delete, for example: 1.2\r\n     */\r\n    @tag(\"vers.deleteByLabel\")\r\n    public deleteByLabel(label: string): Promise<void> {\r\n        return spPost(this.clone(Versions, `deleteByLabel(versionlabel='${escapeQueryStrValue(label)}')`));\r\n    }\r\n\r\n    /**\r\n     * Recycles the file version object with the specified version label.\r\n     *\r\n     * @param label The version label of the file version to delete, for example: 1.2\r\n     */\r\n    @tag(\"vers.recycleByLabel\")\r\n    public recycleByLabel(label: string): Promise<void> {\r\n        return spPost(this.clone(Versions, `recycleByLabel(versionlabel='${escapeQueryStrValue(label)}')`));\r\n    }\r\n\r\n    /**\r\n     * Creates a new file version from the file specified by the version label.\r\n     *\r\n     * @param label The version label of the file version to restore, for example: 1.2\r\n     */\r\n    @tag(\"vers.restoreByLabel\")\r\n    public restoreByLabel(label: string): Promise<void> {\r\n        return spPost(this.clone(Versions, `restoreByLabel(versionlabel='${escapeQueryStrValue(label)}')`));\r\n    }\r\n}\r\nexport interface IVersions extends _Versions { }\r\nexport const Versions = spInvokableFactory<IVersions>(_Versions);\r\n\r\n/**\r\n * Describes a single Version instance\r\n *\r\n */\r\nexport class _Version extends _SharePointQueryableInstance {\r\n    public delete = deleteableWithETag(\"ver\");\r\n}\r\nexport interface IVersion extends _Version, IDeleteableWithETag { }\r\nexport const Version = spInvokableFactory<IVersion>(_Version);\r\n\r\n/**\r\n * Types for document check in. \r\n * Minor = 0\r\n * Major = 1\r\n * Overwrite = 2\r\n */\r\nexport enum CheckinType {\r\n    Minor = 0,\r\n    Major = 1,\r\n    Overwrite = 2,\r\n}\r\n/**\r\n * Describes file and result\r\n */\r\nexport interface IFileAddResult {\r\n    file: IFile;\r\n    data: IFileInfo;\r\n}\r\n\r\n/**\r\n * File move opertions\r\n * Overwrite = 1\r\n * AllowBrokenThickets = 8\r\n */\r\nexport enum MoveOperations {\r\n    Overwrite = 1,\r\n    AllowBrokenThickets = 8,\r\n}\r\n\r\nexport enum TemplateFileType {\r\n    StandardPage = 0,\r\n    WikiPage = 1,\r\n    FormPage = 2,\r\n    ClientSidePage = 3,\r\n}\r\n\r\n/**\r\n * Describes SharePoint file upload progress data\r\n */\r\nexport interface IFileUploadProgressData {\r\n    uploadId: string;\r\n    stage: \"starting\" | \"continue\" | \"finishing\";\r\n    blockNumber: number;\r\n    totalBlocks: number;\r\n    chunkSize: number;\r\n    currentPointer: number;\r\n    fileSize: number;\r\n}\r\n\r\nexport interface IAddUsingPathProps {\r\n    /**\r\n     * Overwrite the file if it exists\r\n     */\r\n    Overwrite: boolean;\r\n    /**\r\n     * specifies whether to auto checkout on invalid Data. It'll be useful if the list contains validation whose requirements upload will not be able to meet.\r\n     */\r\n    AutoCheckoutOnInvalidData?: boolean;\r\n    /**\r\n     * Specifies a XOR hash of the file data which should be used to ensure end-2-end data integrity, base64 representation\r\n     */\r\n    XorHash?: string;\r\n}\r\n\r\nexport interface IFileInfo {\r\n    readonly \"odata.id\": string;\r\n    CheckInComment: string;\r\n    CheckOutType: number;\r\n    ContentTag: string;\r\n    CustomizedPageStatus: number;\r\n    ETag: string;\r\n    Exists: boolean;\r\n    IrmEnabled: boolean;\r\n    Length: string;\r\n    Level: number;\r\n    LinkingUri: string | null;\r\n    LinkingUrl: string;\r\n    ListId: string;\r\n    MajorVersion: number;\r\n    MinorVersion: number;\r\n    Name: string;\r\n    ServerRelativeUrl: string;\r\n    SiteId: string;\r\n    TimeCreated: string;\r\n    TimeLastModified: string;\r\n    Title: string | null;\r\n    UIVersion: number;\r\n    UIVersionLabel: string;\r\n    UniqueId: string;\r\n    WebId: string;\r\n}\r\n\r\nexport interface IFileDeleteParams {\r\n    /**\r\n     * If true, delete or recyle a file when the LockType\r\n     * value is SPLockType.Shared or SPLockType.None.\r\n     * When false, delete or recycle the file when\r\n     * the LockType value SPLockType.None.\r\n     */\r\n    BypassSharedLock: boolean;\r\n\r\n    /**\r\n     * Gets or sets a string value that allows SPfile delete and recycle methods\r\n     * to target a file with a matching value. Use null to unconditionally delete the file.\r\n     */\r\n    ETagMatch: string;\r\n}\r\n","import {\r\n    ISharePointQueryable,\r\n    _SharePointQueryableInstance,\r\n    _SharePointQueryableCollection,\r\n    spInvokableFactory,\r\n} from \"../sharepointqueryable\";\r\nimport { spPost } from \"../operations\";\r\nimport { odataUrlFrom } from \"../odata\";\r\nimport { extractWebUrl } from \"../utils/extractweburl\";\r\nimport { File, IFile } from \"../files/types\";\r\nimport { tag } from \"../telemetry\";\r\nimport { Web } from \"../webs\";\r\nimport \"../items\";\r\n\r\nexport class _AppCatalog extends _SharePointQueryableCollection {\r\n\r\n    constructor(baseUrl: string | ISharePointQueryable, path = \"_api/web/tenantappcatalog/AvailableApps\") {\r\n        super(extractWebUrl(typeof baseUrl === \"string\" ? baseUrl : baseUrl.toUrl()), path);\r\n    }\r\n\r\n    /**\r\n     * Get details of specific app from the app catalog\r\n     * @param id - Specify the guid of the app\r\n     */\r\n    public getAppById(id: string): IApp {\r\n        return tag.configure(App(this, `getById('${id}')`), \"ac.getAppById\");\r\n    }\r\n\r\n    /**\r\n     * Synchronize a solution to the Microsoft Teams App Catalog\r\n     * @param id - Specify the guid of the app\r\n     * @param useSharePointItemId (optional) - By default this REST call requires the SP Item id of the app, not the app id.\r\n     *                            PnPjs will try to fetch the item id by default, you can still use this parameter to pass your own item id in the first parameter \r\n     */\r\n    public async syncSolutionToTeams(id: string | number, useSharePointItemId = false): Promise<void> {\r\n\r\n        // This REST call requires that you refer the list item id of the solution in the app catalog site.\r\n        let appId = null;\r\n        const webUrl = extractWebUrl(this.toUrl());\r\n\r\n        if (useSharePointItemId) {\r\n\r\n            appId = id;\r\n        } else {\r\n\r\n            const web = Web(webUrl);\r\n            const listId = (await web.lists.select(\"Id\").filter(`EntityTypeName eq 'AppCatalog'`)())[0].Id;\r\n            const listItems = await web.lists.getById(listId).items.filter(`AppProductID eq '${id}'`).top(1)();\r\n\r\n            if (listItems && listItems.length > 0) {\r\n\r\n                appId = listItems[0].Id;\r\n            } else {\r\n\r\n                throw Error(`Did not find the app with id ${id} in the appcatalog.`);\r\n            }\r\n        }\r\n\r\n        const poster = tag.configure(AppCatalog(webUrl, `_api/web/tenantappcatalog/SyncSolutionToTeams(id=${appId})`), \"ac.syncSolutionToTeams\");\r\n\r\n        return await spPost(poster, {});\r\n    }\r\n\r\n    /**\r\n     * Uploads an app package. Not supported for batching\r\n     *\r\n     * @param filename Filename to create.\r\n     * @param content app package data (eg: the .app or .sppkg file).\r\n     * @param shouldOverWrite Should an app with the same name in the same location be overwritten? (default: true)\r\n     * @returns Promise<IAppAddResult>\r\n     */\r\n    public async add(filename: string, content: string | ArrayBuffer | Blob, shouldOverWrite = true): Promise<IAppAddResult> {\r\n\r\n        // you don't add to the availableapps collection\r\n        const adder = tag.configure(AppCatalog(extractWebUrl(this.toUrl()), `_api/web/tenantappcatalog/add(overwrite=${shouldOverWrite},url='${filename}')`), \"ac.add\");\r\n\r\n        const r = await spPost(adder, {\r\n            body: content, headers: {\r\n                \"binaryStringRequestBody\": \"true\",\r\n            },\r\n        });\r\n\r\n        return {\r\n            data: r,\r\n            file: File(odataUrlFrom(r)),\r\n        };\r\n    }\r\n}\r\nexport interface IAppCatalog extends _AppCatalog {}\r\nexport const AppCatalog = spInvokableFactory<IAppCatalog>(_AppCatalog);\r\n\r\nexport class _App extends _SharePointQueryableInstance {\r\n\r\n    /**\r\n     * This method deploys an app on the app catalog. It must be called in the context\r\n     * of the tenant app catalog web or it will fail.\r\n     * \r\n     * @param skipFeatureDeployment Deploy the app to the entire tenant\r\n     */\r\n    @tag(\"app.deploy\")\r\n    public deploy(skipFeatureDeployment = false): Promise<void> {\r\n        return this.do(`Deploy(${skipFeatureDeployment})`);\r\n    }\r\n\r\n    /**\r\n     * This method retracts a deployed app on the app catalog. It must be called in the context\r\n     * of the tenant app catalog web or it will fail.\r\n     */\r\n    @tag(\"app.retract\")\r\n    public retract(): Promise<void> {\r\n        return this.do(\"Retract\");\r\n    }\r\n\r\n    /**\r\n     * This method allows an app which is already deployed to be installed on a web\r\n     */\r\n    @tag(\"app.install\")\r\n    public install(): Promise<void> {\r\n        return this.do(\"Install\");\r\n    }\r\n\r\n    /**\r\n     * This method allows an app which is already installed to be uninstalled on a web\r\n     * Note: when you use the REST API to uninstall a solution package from the site, it is not relocated to the recycle bin\r\n     */\r\n    @tag(\"app.uninstall\")\r\n    public uninstall(): Promise<void> {\r\n        return this.do(\"Uninstall\");\r\n    }\r\n\r\n    /**\r\n     * This method allows an app which is already installed to be upgraded on a web\r\n     */\r\n    @tag(\"app.upgrade\")\r\n    public upgrade(): Promise<void> {\r\n        return this.do(\"Upgrade\");\r\n    }\r\n\r\n    /**\r\n     * This method removes an app from the app catalog. It must be called in the context\r\n     * of the tenant app catalog web or it will fail.\r\n     */\r\n    @tag(\"app.remove\")\r\n    public remove(): Promise<void> {\r\n        return this.do(\"Remove\");\r\n    }\r\n\r\n    private do(path: string): Promise<void> {\r\n        return spPost(this.clone(App, path));\r\n    }\r\n}\r\nexport interface IApp extends _App {}\r\nexport const App = spInvokableFactory<IApp>(_App);\r\n\r\n/**\r\n * Result object after adding an app\r\n */\r\nexport interface IAppAddResult {\r\n    /**\r\n     * Contains metadata of the added app\r\n     */\r\n    data: any;\r\n    /**\r\n     * A File instance to the item in SharePoint\r\n     */\r\n    file: IFile;\r\n}\r\n","import { _Web } from \"../webs/types\";\r\nimport { AppCatalog, IAppCatalog } from \"./types\";\r\n\r\ndeclare module \"../webs/types\" {\r\n    interface _Web {\r\n        getAppCatalog(url?: string | _Web): IAppCatalog;\r\n    }\r\n    interface IWeb {\r\n        /**\r\n         * Gets this web (default) or the web specifed by the optional string case\r\n         * as an IAppCatalog instance\r\n         * \r\n         * @param url [Optional] Url of the web to get (default: current web)\r\n         */\r\n        getAppCatalog(url?: string | _Web): IAppCatalog;\r\n    }\r\n}\r\n\r\n_Web.prototype.getAppCatalog = function (this: _Web, url?: string | _Web): IAppCatalog {\r\n    return AppCatalog(url || this);\r\n};\r\n","import { SPRest } from \"../rest\";\r\nimport { IWeb, Web } from \"../webs/types\";\r\n\r\nimport \"./web\";\r\nimport { SharePointQueryable } from \"../sharepointqueryable\";\r\n\r\nexport {\r\n    IAppAddResult,\r\n    IApp,\r\n    IAppCatalog,\r\n    App,\r\n    AppCatalog,\r\n} from \"./types\";\r\n\r\ndeclare module \"../rest\" {\r\n    interface SPRest {\r\n        getTenantAppCatalogWeb(): Promise<IWeb>;\r\n    }\r\n}\r\n\r\nSPRest.prototype.getTenantAppCatalogWeb = async function (this: SPRest): Promise<IWeb> {\r\n    const data: { CorporateCatalogUrl: string } = await SharePointQueryable(\"/\", \"_api/SP_TenantSettings_Current\")();\r\n    return Web(data.CorporateCatalogUrl);\r\n};\r\n","import { defaultPath } from \"../decorators\";\r\nimport { spPost } from \"../operations\";\r\nimport {\r\n    _SharePointQueryableInstance,\r\n    _SharePointQueryableCollection,\r\n    spInvokableFactory,\r\n    deleteableWithETag,\r\n    IDeleteableWithETag,\r\n} from \"../sharepointqueryable\";\r\nimport { TextParser, BlobParser, JSONParser, BufferParser, ODataParser, headers } from \"@pnp/odata\";\r\nimport { tag } from \"../telemetry\";\r\n\r\n@defaultPath(\"AttachmentFiles\")\r\nexport class _Attachments extends _SharePointQueryableCollection<IAttachmentInfo[]> {\r\n\r\n    /**\r\n    * Gets a Attachment File by filename\r\n    *\r\n    * @param name The name of the file, including extension.\r\n    */\r\n    public getByName(name: string): IAttachment {\r\n        const f = tag.configure(Attachment(this), \"ats.getByName\");\r\n        f.concat(`('${name}')`);\r\n        return f;\r\n    }\r\n\r\n    /**\r\n     * Adds a new attachment to the collection. Not supported for batching.\r\n     *\r\n     * @param name The name of the file, including extension.\r\n     * @param content The Base64 file content.\r\n     */\r\n    @tag(\"ats.add\")\r\n    public async add(name: string, content: string | Blob | ArrayBuffer): Promise<IAttachmentAddResult> {\r\n        const response = await spPost(this.clone(Attachments, `add(FileName='${name}')`, false), { body: content });\r\n        return {\r\n            data: response,\r\n            file: this.getByName(name),\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Adds multiple new attachment to the collection. Not supported for batching.\r\n     *\r\n     * @param files The collection of files to add\r\n     */\r\n    @tag(\"ats.addMultiple\")\r\n    public async addMultiple(files: IAttachmentFileInfo[]): Promise<void> {\r\n\r\n        for (let i = 0; i < files.length; i++) {\r\n            await this.add(files[i].name, files[i].content);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Delete multiple attachments from the collection. Not supported for batching.\r\n     *\r\n     * @param files The collection of files to delete\r\n     */\r\n    @tag(\"ats.deleteMultiple\")\r\n    public async deleteMultiple(...files: string[]): Promise<void> {\r\n\r\n        for (let i = 0; i < files.length; i++) {\r\n            await this.getByName(files[i]).delete();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Delete multiple attachments from the collection and send to recycle bin. Not supported for batching.\r\n     *\r\n     * @param files The collection of files to be deleted and sent to recycle bin\r\n     */\r\n    @tag(\"ats.recycleMultiple\")\r\n    public async recycleMultiple(...files: string[]): Promise<void> {\r\n        for (let i = 0; i < files.length; i++) {\r\n            await this.getByName(files[i]).recycle();\r\n        }\r\n    }\r\n}\r\nexport interface IAttachments extends _Attachments { }\r\nexport const Attachments = spInvokableFactory<IAttachments>(_Attachments);\r\n\r\nexport class _Attachment extends _SharePointQueryableInstance<IAttachmentInfo> {\r\n\r\n    public delete = deleteableWithETag(\"at\");\r\n\r\n    /**\r\n     * Gets the contents of the file as text\r\n     *\r\n     */\r\n    @tag(\"at.getText\")\r\n    public getText(): Promise<string> {\r\n\r\n        return this.getParsed(new TextParser());\r\n    }\r\n\r\n    /**\r\n     * Gets the contents of the file as a blob, does not work in Node.js\r\n     *\r\n     */\r\n    @tag(\"at.getBlob\")\r\n    public getBlob(): Promise<Blob> {\r\n\r\n        return this.getParsed(new BlobParser());\r\n    }\r\n\r\n    /**\r\n     * Gets the contents of a file as an ArrayBuffer, works in Node.js\r\n     */\r\n    @tag(\"at.getBuffer\")\r\n    public getBuffer(): Promise<ArrayBuffer> {\r\n\r\n        return this.getParsed(new BufferParser());\r\n    }\r\n\r\n    /**\r\n     * Gets the contents of a file as an ArrayBuffer, works in Node.js\r\n     */\r\n    @tag(\"at.getJSON\")\r\n    public getJSON(): Promise<any> {\r\n\r\n        return this.getParsed(new JSONParser());\r\n    }\r\n\r\n    /**\r\n     * Sets the content of a file. Not supported for batching\r\n     *\r\n     * @param content The value to set for the file contents\r\n     */\r\n    @tag(\"at.setContent\")\r\n    public async setContent(content: string | ArrayBuffer | Blob): Promise<IAttachment> {\r\n\r\n        await spPost(this.clone(Attachment, \"$value\", false), headers({ \"X-HTTP-Method\": \"PUT\" }, {\r\n            body: content,\r\n        }));\r\n\r\n        return Attachment(this);\r\n    }\r\n\r\n    /**\r\n     * Delete this attachment file and send it to recycle bin\r\n     *\r\n     * @param eTag Value used in the IF-Match header, by default \"*\"\r\n     */\r\n    @tag(\"at.recycle\")\r\n    public recycle(eTag = \"*\"): Promise<void> {\r\n\r\n        return spPost(this.clone(Attachment, \"recycleObject\"), headers({\r\n            \"IF-Match\": eTag,\r\n            \"X-HTTP-Method\": \"DELETE\",\r\n        }));\r\n    }\r\n\r\n    private getParsed<T>(parser: ODataParser<T>): Promise<T> {\r\n\r\n        return this.clone(Attachment, \"$value\", false).usingParser(parser)();\r\n    }\r\n}\r\nexport interface IAttachment extends _Attachment, IDeleteableWithETag { }\r\nexport const Attachment = spInvokableFactory<IAttachment>(_Attachment);\r\n\r\nexport interface IAttachmentAddResult {\r\n    file: IAttachment;\r\n    data: IAttachmentFileInfo;\r\n}\r\n\r\nexport interface IAttachmentFileInfo {\r\n    name: string;\r\n    content: string | Blob | ArrayBuffer;\r\n}\r\n\r\nexport interface IAttachmentInfo {\r\n    FileName: string;\r\n    FileNameAsPath: {\r\n        DecodedUrl: string;\r\n    };\r\n    ServerRelativePath: {\r\n        DecodedUrl: string;\r\n    };\r\n    ServerRelativeUrl: string;\r\n}\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _Item } from \"../items/types\";\r\nimport { Attachments, IAttachments } from \"./types\";\r\n\r\ndeclare module \"../items/types\" {\r\n    interface _Item {\r\n        readonly attachmentFiles: IAttachments;\r\n    }\r\n    interface IItem {\r\n        /**\r\n         * Read the attachment files data for an item\r\n         */\r\n        readonly attachmentFiles: IAttachments;\r\n    }\r\n}\r\n\r\naddProp(_Item, \"attachmentFiles\", Attachments);\r\n","import { hOP } from \"@pnp/common\";\r\n\r\n/**\r\n * Gets the next order value 1 based for the provided collection\r\n * \r\n * @param collection Collection of orderable things\r\n */\r\nexport function getNextOrder(collection: { order: number }[]): number {\r\n    return collection.length < 1 ? 1 : (Math.max.apply(null, collection.map(i => i.order)) + 1);\r\n}\r\n\r\n/**\r\n * Normalizes the order value for all the sections, columns, and controls to be 1 based and stepped (1, 2, 3...)\r\n * \r\n * @param collection The collection to normalize\r\n */\r\nexport function reindex(collection: { order: number, columns?: { order: number }[], controls?: { order: number }[] }[]): void {\r\n\r\n    for (let i = 0; i < collection.length; i++) {\r\n        collection[i].order = i + 1;\r\n        if (hOP(collection[i], \"columns\")) {\r\n            reindex(collection[i].columns);\r\n        } else if (hOP(collection[i], \"controls\")) {\r\n            reindex(collection[i].controls);\r\n        }\r\n    }\r\n}\r\n","import { _Web } from \"../webs/types\";\r\nimport { File, IFile } from \"./types\";\r\nimport { escapeQueryStrValue } from \"../utils/escapeQueryStrValue\";\r\n\r\ndeclare module \"../webs/types\" {\r\n    interface _Web {\r\n        getFileByServerRelativeUrl(fileRelativeUrl: string): IFile;\r\n        getFileByServerRelativePath(fileRelativeUrl: string): IFile;\r\n        getFileById(uniqueId: string): IFile;\r\n        getFileByUrl(fileUrl: string): IFile;\r\n    }\r\n    interface IWeb {\r\n\r\n        /**\r\n         * Gets a file by server relative url\r\n         *\r\n         * @param fileRelativeUrl The server relative path to the file (including /sites/ if applicable)\r\n         */\r\n        getFileByServerRelativeUrl(fileRelativeUrl: string): IFile;\r\n\r\n        /**\r\n         * Gets a file by server relative url if your file name contains # and % characters\r\n         *\r\n         * @param fileRelativeUrl The server relative path to the file (including /sites/ if applicable)\r\n         */\r\n        getFileByServerRelativePath(fileRelativeUrl: string): IFile;\r\n\r\n        /**\r\n         * Gets a file by id\r\n         *\r\n         * @param uniqueId The UniqueId of the file\r\n         */\r\n        getFileById(uniqueId: string): IFile;\r\n\r\n        /**\r\n         * Gets a file from a sharing link or absolute url\r\n         * \r\n         * @param fileUrl Absolute url of the file to get\r\n         */\r\n        getFileByUrl(fileUrl: string): IFile;\r\n    }\r\n}\r\n\r\n_Web.prototype.getFileByServerRelativeUrl = function (this: _Web, fileRelativeUrl: string): IFile {\r\n    return File(this, `getFileByServerRelativeUrl('${escapeQueryStrValue(fileRelativeUrl)}')`);\r\n};\r\n\r\n_Web.prototype.getFileByServerRelativePath = function (this: _Web, fileRelativeUrl: string): IFile {\r\n    return File(this, `getFileByServerRelativePath(decodedUrl='${escapeQueryStrValue(fileRelativeUrl)}')`);\r\n};\r\n\r\n_Web.prototype.getFileById = function (this: _Web, uniqueId: string): IFile {\r\n    return File(this, `getFileById('${uniqueId}')`);\r\n};\r\n\r\n_Web.prototype.getFileByUrl = function (this: _Web, fileUrl: string): IFile {\r\n    return File(this, `getFileByUrl('!@p1::${escapeQueryStrValue(fileUrl)}')`);\r\n};\r\n","import { defaultPath } from \"../decorators\";\r\nimport {\r\n    _SharePointQueryableInstance,\r\n    _SharePointQueryableCollection,\r\n    spInvokableFactory,\r\n} from \"../sharepointqueryable\";\r\nimport { assign } from \"@pnp/common\";\r\nimport { odataUrlFrom } from \"../odata\";\r\nimport { metadata } from \"../utils/metadata\";\r\nimport { body } from \"@pnp/odata\";\r\nimport { spPost } from \"../operations\";\r\nimport { tag } from \"../telemetry\";\r\n\r\n@defaultPath(\"comments\")\r\nexport class _Comments extends _SharePointQueryableCollection<ICommentInfo[]> {\r\n\r\n    /**\r\n     * Adds a new comment to this collection\r\n     * \r\n     * @param info Comment information to add\r\n     */\r\n    @tag(\"coms.add\")\r\n    public async add(info: string | ICommentInfo): Promise<IComment & ICommentInfo> {\r\n\r\n        if (typeof info === \"string\") {\r\n            info = <ICommentInfo>{ text: info };\r\n        }\r\n\r\n        const postBody = body(assign(metadata(\"Microsoft.SharePoint.Comments.comment\"), info));\r\n\r\n        const d = await spPost(this.clone(Comments, null), postBody);\r\n\r\n        return assign(this.getById(d.id), d);\r\n    }\r\n\r\n    /**\r\n     * Gets a comment by id\r\n     * \r\n     * @param id Id of the comment to load\r\n     */\r\n    public getById(id: string | number): IComment {\r\n        return tag.configure(Comment(this).concat(`(${id})`), \"coms.getById\");\r\n    }\r\n\r\n    /**\r\n     * Deletes all the comments in this collection\r\n     */\r\n    public clear(): Promise<boolean> {\r\n        return spPost<boolean>(tag.configure(this.clone(Comments, \"DeleteAll\"), \"coms.clear\"));\r\n    }\r\n}\r\nexport interface IComments extends _Comments {}\r\nexport const Comments = spInvokableFactory<IComments>(_Comments);\r\n\r\nexport class _Comment extends _SharePointQueryableInstance<ICommentInfo> {\r\n\r\n    /**\r\n     * A comment's replies\r\n     */\r\n    public get replies(): IReplies {\r\n        return tag.configure(Replies(this), \"com.replies\");\r\n    }\r\n\r\n    /**\r\n     * Likes the comment as the current user\r\n     */\r\n    @tag(\"com.like\")\r\n    public like(): Promise<void> {\r\n        return spPost(this.clone(Comment, \"Like\"));\r\n    }\r\n\r\n    /**\r\n     * Unlikes the comment as the current user\r\n     */\r\n    @tag(\"com.unlike\")\r\n    public unlike(): Promise<void> {\r\n        return spPost(this.clone(Comment, \"Unlike\"));\r\n    }\r\n\r\n    /**\r\n     * Deletes this comment\r\n     */\r\n    @tag(\"com.delete\")\r\n    public delete(): Promise<void> {\r\n        return spPost(this.clone(Comment, \"DeleteComment\"));\r\n    }\r\n}\r\nexport interface IComment extends _Comment {}\r\nexport const Comment = spInvokableFactory<IComment>(_Comment);\r\n\r\n@defaultPath(\"replies\")\r\nexport class _Replies extends _SharePointQueryableCollection<ICommentInfo[]> {\r\n\r\n    /**\r\n     * Adds a new reply to this collection\r\n     * \r\n     * @param info Comment information to add\r\n     */\r\n    @tag(\"reps.add\")\r\n    public async add(info: string | ICommentInfo): Promise<IComment & ICommentInfo> {\r\n\r\n        if (typeof info === \"string\") {\r\n            info = <ICommentInfo>{ text: info };\r\n        }\r\n\r\n        const postBody = body(assign(metadata(\"Microsoft.SharePoint.Comments.comment\"), info));\r\n\r\n        const d = await spPost(this.clone(Replies, null), postBody);\r\n\r\n        return assign(Comment(odataUrlFrom(d)), d);\r\n    }\r\n}\r\nexport interface IReplies extends _Replies {}\r\nexport const Replies = spInvokableFactory<IReplies>(_Replies);\r\n\r\n/**\r\n * Defines the information for a comment author\r\n */\r\nexport interface ICommentAuthorData {\r\n    email: string;\r\n    id: number;\r\n    isActive: boolean;\r\n    isExternal: boolean;\r\n    jobTitle: string | null;\r\n    loginName: string;\r\n    name: string;\r\n    principalType: number;\r\n    userId: any | null;\r\n}\r\n\r\n/**\r\n * Defines the information for a comment\r\n */\r\nexport interface ICommentInfo {\r\n    author: ICommentAuthorData;\r\n    createdDate: string;\r\n    id: string;\r\n    isLikedByUser: boolean;\r\n    isReply: boolean;\r\n    itemId: number;\r\n    likeCount: number;\r\n    listId: string;\r\n    mentions: {\r\n        loginName: string;\r\n        email: string;\r\n        name: string;\r\n    } | null;\r\n    parentId: string;\r\n    replyCount: number;\r\n    text: string;\r\n}\r\n\r\nexport interface ILikeData {\r\n    name: string;\r\n    loginName: string;\r\n    id: number;\r\n    email: string;\r\n    creationDate: string;\r\n}\r\n\r\nexport interface ILikedByInformation {\r\n    likedBy: {\r\n        creationDate: string;\r\n        email: string;\r\n        id: number;\r\n        loginName: string;\r\n        name: string;\r\n    }[];\r\n    isLikedByUser: boolean;\r\n    likeCount: number;\r\n}\r\n","import { invokableFactory, body, headers, IQueryable } from \"@pnp/odata\";\r\nimport { ITypedHash, assign, getGUID, hOP, stringIsNullOrEmpty, objectDefinedNotNull, combine, isUrlAbsolute, isArray } from \"@pnp/common\";\r\nimport { IFile, IFileInfo } from \"../files/types\";\r\nimport { Item, IItem } from \"../items/types\";\r\nimport { SharePointQueryable, _SharePointQueryable, ISharePointQueryable, SharePointQueryableCollection } from \"../sharepointqueryable\";\r\nimport { metadata } from \"../utils/metadata\";\r\nimport { List } from \"../lists/types\";\r\nimport { odataUrlFrom } from \"../odata\";\r\nimport { Web, IWeb } from \"../webs/types\";\r\nimport { extractWebUrl } from \"../utils/extractweburl\";\r\nimport { Site } from \"../sites/types\";\r\nimport { spPost } from \"../operations\";\r\nimport { getNextOrder, reindex } from \"./funcs\";\r\nimport \"../files/web\";\r\nimport \"../comments/item\";\r\nimport { tag } from \"../telemetry\";\r\n\r\n/**\r\n * Page promotion state\r\n */\r\nexport const enum PromotedState {\r\n    /**\r\n     * Regular client side page\r\n     */\r\n    NotPromoted = 0,\r\n    /**\r\n     * Page that will be promoted as news article after publishing\r\n     */\r\n    PromoteOnPublish = 1,\r\n    /**\r\n     * Page that is promoted as news article\r\n     */\r\n    Promoted = 2,\r\n}\r\n\r\n/**\r\n * Type describing the available page layout types for client side \"modern\" pages\r\n */\r\nexport type ClientsidePageLayoutType = \"Article\" | \"Home\" | \"SingleWebPartAppPage\" | \"RepostPage\";\r\n\r\n/**\r\n * Column size factor. Max value is 12 (= one column), other options are 8,6,4 or 0\r\n */\r\nexport type CanvasColumnFactor = 0 | 2 | 4 | 6 | 8 | 12;\r\n\r\nfunction initFrom(o: ISharePointQueryable, url: string): IClientsidePage {\r\n    return ClientsidePage(extractWebUrl(o.toUrl()), url).configureFrom(o);\r\n}\r\n\r\n/** \r\n * Represents the data and methods associated with client side \"modern\" pages\r\n */\r\nexport class _ClientsidePage extends _SharePointQueryable implements IClientsidePage {\r\n\r\n    private _pageSettings: IClientsidePageSettingsSlice;\r\n    private _layoutPart: ILayoutPartsContent;\r\n    private _bannerImageDirty: boolean;\r\n    private _bannerImageThumbnailUrlDirty: boolean;\r\n\r\n    /**\r\n     * PLEASE DON'T USE THIS CONSTRUCTOR DIRECTLY, thank you 🐇\r\n     */\r\n    constructor(\r\n        baseUrl: string | ISharePointQueryable,\r\n        path?: string,\r\n        protected json?: Partial<IPageData>,\r\n        noInit = false,\r\n        public sections: CanvasSection[] = [],\r\n        public commentsDisabled = false) {\r\n\r\n        super(baseUrl, path);\r\n\r\n        this._bannerImageDirty = false;\r\n        this._bannerImageThumbnailUrlDirty = false;\r\n\r\n        // ensure we have a good url to build on for the pages api\r\n        if (typeof baseUrl === \"string\") {\r\n            this.data.parentUrl = \"\";\r\n            this.data.url = combine(extractWebUrl(baseUrl), path);\r\n        } else {\r\n            this.assign(initFrom(baseUrl, null), path);\r\n        }\r\n\r\n        // set a default page settings slice\r\n        this._pageSettings = { controlType: 0, pageSettingsSlice: { isDefaultDescription: true, isDefaultThumbnail: true } };\r\n\r\n        // set a default layout part\r\n        this._layoutPart = _ClientsidePage.getDefaultLayoutPart();\r\n\r\n        if (typeof json !== \"undefined\" && !noInit) {\r\n            this.fromJSON(json);\r\n        }\r\n    }\r\n\r\n    private static getDefaultLayoutPart(): ILayoutPartsContent {\r\n        return {\r\n            dataVersion: \"1.4\",\r\n            description: \"Title Region Description\",\r\n            id: \"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788\",\r\n            instanceId: \"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788\",\r\n            properties: {\r\n                authorByline: [],\r\n                authors: [],\r\n                layoutType: \"FullWidthImage\",\r\n                showPublishDate: false,\r\n                showTopicHeader: false,\r\n                textAlignment: \"Left\",\r\n                title: \"\",\r\n                topicHeader: \"\",\r\n            },\r\n            reservedHeight: 280,\r\n            serverProcessedContent: { htmlStrings: {}, searchablePlainTexts: {}, imageSources: {}, links: {} },\r\n            title: \"Title area\",\r\n        };\r\n    }\r\n\r\n    public get pageLayout(): ClientsidePageLayoutType {\r\n        return this.json.PageLayoutType;\r\n    }\r\n\r\n    public set pageLayout(value: ClientsidePageLayoutType) {\r\n        this.json.PageLayoutType = value;\r\n    }\r\n\r\n    public get bannerImageUrl(): string {\r\n        return this.json.BannerImageUrl;\r\n    }\r\n\r\n    public set bannerImageUrl(value: string) {\r\n        this.setBannerImage(value);\r\n    }\r\n\r\n    public get thumbnailUrl(): string {\r\n        return this._pageSettings.pageSettingsSlice.isDefaultThumbnail ? this.json.BannerImageUrl : this.json.BannerThumbnailUrl;\r\n    }\r\n\r\n    public set thumbnailUrl(value: string) {\r\n        this.json.BannerThumbnailUrl = value;\r\n        this._bannerImageThumbnailUrlDirty = true;\r\n        this._pageSettings.pageSettingsSlice.isDefaultThumbnail = false;\r\n    }\r\n\r\n    public get topicHeader(): string {\r\n        return objectDefinedNotNull(this.json.TopicHeader) ? this.json.TopicHeader : \"\";\r\n    }\r\n\r\n    public set topicHeader(value: string) {\r\n        this.json.TopicHeader = value;\r\n        this._layoutPart.properties.topicHeader = value;\r\n        if (stringIsNullOrEmpty(value)) {\r\n            this.showTopicHeader = false;\r\n        }\r\n    }\r\n\r\n    public get title(): string {\r\n        return this._layoutPart.properties.title;\r\n    }\r\n\r\n    public set title(value: string) {\r\n        this.json.Title = value;\r\n        this._layoutPart.properties.title = value;\r\n    }\r\n\r\n    public get reservedHeight(): number {\r\n        return this._layoutPart.reservedHeight;\r\n    }\r\n\r\n    public set reservedHeight(value: number) {\r\n        this._layoutPart.reservedHeight = value;\r\n    }\r\n\r\n    public get description(): string {\r\n        return this.json.Description;\r\n    }\r\n\r\n    public set description(value: string) {\r\n\r\n        if (!stringIsNullOrEmpty(value) && value.length > 255) {\r\n            throw Error(\"Modern Page description is limited to 255 chars.\");\r\n        }\r\n\r\n        this.json.Description = value;\r\n        if (!hOP(this._pageSettings, \"htmlAttributes\")) {\r\n            this._pageSettings.htmlAttributes = [];\r\n        }\r\n        if (this._pageSettings.htmlAttributes.indexOf(\"modifiedDescription\") < 0) {\r\n            this._pageSettings.htmlAttributes.push(\"modifiedDescription\");\r\n        }\r\n        this._pageSettings.pageSettingsSlice.isDefaultDescription = false;\r\n    }\r\n\r\n    public get layoutType(): LayoutType {\r\n        return this._layoutPart.properties.layoutType;\r\n    }\r\n\r\n    public set layoutType(value: LayoutType) {\r\n        this._layoutPart.properties.layoutType = value;\r\n    }\r\n\r\n    public get headerTextAlignment(): TextAlignment {\r\n        return this._layoutPart.properties.textAlignment;\r\n    }\r\n\r\n    public set headerTextAlignment(value: TextAlignment) {\r\n        this._layoutPart.properties.textAlignment = value;\r\n    }\r\n\r\n    public get showTopicHeader(): boolean {\r\n        return this._layoutPart.properties.showTopicHeader;\r\n    }\r\n\r\n    public set showTopicHeader(value: boolean) {\r\n        this._layoutPart.properties.showTopicHeader = value;\r\n    }\r\n\r\n    public get showPublishDate(): boolean {\r\n        return this._layoutPart.properties.showPublishDate;\r\n    }\r\n\r\n    public set showPublishDate(value: boolean) {\r\n        this._layoutPart.properties.showPublishDate = value;\r\n    }\r\n\r\n    public get hasVerticalSection(): boolean {\r\n        return this.sections.findIndex(s => s.layoutIndex === 2) > -1;\r\n    }\r\n\r\n    public get authorByLine(): string | null {\r\n        if (isArray(this.json.AuthorByline) && this.json.AuthorByline.length > 0) {\r\n            return this.json.AuthorByline[0];\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    public get verticalSection(): CanvasSection | null {\r\n        if (this.hasVerticalSection) {\r\n            return this.addVerticalSection();\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Add a section to this page\r\n     */\r\n    public addSection(): CanvasSection {\r\n        const section = new CanvasSection(this, getNextOrder(this.sections), 1);\r\n        this.sections.push(section);\r\n        return section;\r\n    }\r\n\r\n    /**\r\n     * Add a section to this page\r\n     */\r\n    public addVerticalSection(): CanvasSection {\r\n\r\n        // we can only have one vertical section so we find it if it exists\r\n        const sectionIndex = this.sections.findIndex(s => s.layoutIndex === 2);\r\n        if (sectionIndex > -1) {\r\n            return this.sections[sectionIndex];\r\n        }\r\n\r\n        const section = new CanvasSection(this, getNextOrder(this.sections), 2);\r\n        this.sections.push(section);\r\n        return section;\r\n    }\r\n\r\n    /**\r\n     * Loads this instance from the appropriate JSON data\r\n     * \r\n     * @param pageData JSON data to load (replaces any existing data)\r\n     */\r\n    public fromJSON(pageData: Partial<IPageData>): this {\r\n\r\n        this.json = pageData;\r\n\r\n        const canvasControls: IClientsideControlBaseData[] = JSON.parse(pageData.CanvasContent1);\r\n\r\n        const layouts = <ILayoutPartsContent[]>JSON.parse(pageData.LayoutWebpartsContent);\r\n        if (layouts && layouts.length > 0) {\r\n            this._layoutPart = layouts[0];\r\n        }\r\n\r\n        this.setControls(canvasControls);\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Loads this page's content from the server\r\n     */\r\n    @tag(\"csp.load\")\r\n    public async load(): Promise<IClientsidePage> {\r\n\r\n        const item = await this.getItem<{ Id: number, CommentsDisabled: boolean }>(\"Id\", \"CommentsDisabled\");\r\n        const pageData = await SharePointQueryable(this, `_api/sitepages/pages(${item.Id})`)<IPageData>();\r\n        this.commentsDisabled = item.CommentsDisabled;\r\n        return this.fromJSON(pageData);\r\n    }\r\n\r\n    /**\r\n     * Persists the content changes (sections, columns, and controls) [does not work with batching]\r\n     * \r\n     * @param publish If true the page is published, if false the changes are persisted to SharePoint but not published [Default: true]\r\n     */\r\n    @tag(\"csp.save\")\r\n    public async save(publish = true): Promise<boolean> {\r\n\r\n        if (this.json.Id === null) {\r\n            throw Error(\"The id for this page is null. If you want to create a new page, please use ClientSidePage.Create\");\r\n        }\r\n\r\n        if (this._bannerImageDirty) {\r\n\r\n            const serverRelativePath = this.bannerImageUrl;\r\n\r\n            let imgInfo: Pick<IFileInfo, \"ListId\" | \"WebId\" | \"UniqueId\" | \"Name\" | \"SiteId\">;\r\n            let webUrl: string;\r\n\r\n            const web = Web(extractWebUrl(this.toUrl()));\r\n            const batch = web.createBatch();\r\n            web.getFileByServerRelativePath(serverRelativePath.replace(/%20/ig, \" \"))\r\n                .select(\"ListId\", \"WebId\", \"UniqueId\", \"Name\", \"SiteId\").inBatch(batch)().then(r1 => imgInfo = r1);\r\n            web.select(\"Url\").inBatch(batch)().then(r2 => webUrl = r2.Url);\r\n\r\n            // we know the .then calls above will run before execute resolves, ensuring the vars are set\r\n            await batch.execute();\r\n\r\n            const f = SharePointQueryable(webUrl, \"_layouts/15/getpreview.ashx\");\r\n            f.query.set(\"guidSite\", `${imgInfo.SiteId}`);\r\n            f.query.set(\"guidWeb\", `${imgInfo.WebId}`);\r\n            f.query.set(\"guidFile\", `${imgInfo.UniqueId}`);\r\n            this.bannerImageUrl = f.toUrlAndQuery();\r\n\r\n            if (!objectDefinedNotNull(this._layoutPart.serverProcessedContent)) {\r\n                this._layoutPart.serverProcessedContent = <any>{};\r\n            }\r\n\r\n            this._layoutPart.serverProcessedContent.imageSources = { imageSource: serverRelativePath };\r\n\r\n            if (!objectDefinedNotNull(this._layoutPart.serverProcessedContent.customMetadata)) {\r\n                this._layoutPart.serverProcessedContent.customMetadata = <any>{};\r\n            }\r\n\r\n            this._layoutPart.serverProcessedContent.customMetadata.imageSource = {\r\n                listId: imgInfo.ListId,\r\n                siteId: imgInfo.SiteId,\r\n                uniqueId: imgInfo.UniqueId,\r\n                webId: imgInfo.WebId,\r\n            };\r\n            this._layoutPart.properties.webId = imgInfo.WebId;\r\n            this._layoutPart.properties.siteId = imgInfo.SiteId;\r\n            this._layoutPart.properties.listId = imgInfo.ListId;\r\n            this._layoutPart.properties.uniqueId = imgInfo.UniqueId;\r\n        }\r\n\r\n        // we try and check out the page for the user\r\n        if (!this.json.IsPageCheckedOutToCurrentUser) {\r\n            await spPost(initFrom(this, `_api/sitepages/pages(${this.json.Id})/checkoutpage`));\r\n        }\r\n\r\n        // create the body for the save request\r\n        let saveBody = Object.assign(metadata(\"SP.Publishing.SitePage\"), {\r\n            AuthorByline: this.json.AuthorByline || [],\r\n            CanvasContent1: this.getCanvasContent1(),\r\n            Description: this.description,\r\n            LayoutWebpartsContent: this.getLayoutWebpartsContent(),\r\n            Title: this.title,\r\n            TopicHeader: this.topicHeader,\r\n        });\r\n\r\n        if (this._bannerImageDirty || this._bannerImageThumbnailUrlDirty) {\r\n\r\n            const bannerImageUrlValue = this._bannerImageThumbnailUrlDirty ? this.thumbnailUrl : this.bannerImageUrl;\r\n\r\n            saveBody = assign(saveBody, {\r\n                BannerImageUrl: bannerImageUrlValue,\r\n            });\r\n        }\r\n\r\n        const updater = initFrom(this, `_api/sitepages/pages(${this.json.Id})/savepage`);\r\n        await spPost<boolean>(updater, headers({ \"if-match\": \"*\" }, body(saveBody)));\r\n\r\n        let r = true;\r\n\r\n        if (publish) {\r\n            r = await spPost(initFrom(this, `_api/sitepages/pages(${this.json.Id})/publish`));\r\n            if (r) {\r\n                this.json.IsPageCheckedOutToCurrentUser = false;\r\n            }\r\n        }\r\n\r\n        this._bannerImageDirty = false;\r\n        this._bannerImageThumbnailUrlDirty = false;\r\n\r\n        return r;\r\n    }\r\n\r\n    /**\r\n     * Discards the checkout of this page\r\n     */\r\n    @tag(\"csp.discardPageCheckout\")\r\n    public async discardPageCheckout(): Promise<void> {\r\n\r\n        if (this.json.Id === null) {\r\n            throw Error(\"The id for this page is null. If you want to create a new page, please use ClientSidePage.Create\");\r\n        }\r\n\r\n        const d = await spPost(initFrom(this, `_api/sitepages/pages(${this.json.Id})/discardPage`), body(metadata(\"SP.Publishing.SitePage\")));\r\n\r\n        this.fromJSON(d);\r\n    }\r\n\r\n    /**\r\n     * Promotes this page as a news item\r\n     */\r\n    @tag(\"csp.promoteToNews\")\r\n    public async promoteToNews(): Promise<boolean> {\r\n        return this.promoteNewsImpl(\"promoteToNews\");\r\n    }\r\n\r\n    // API is currently broken on server side\r\n    // public async demoteFromNews(): Promise<boolean> {\r\n    //     return this.promoteNewsImpl(\"demoteFromNews\");\r\n    // }\r\n\r\n    /**\r\n     * Finds a control by the specified instance id\r\n     *\r\n     * @param id Instance id of the control to find\r\n     */\r\n    public findControlById<T extends ColumnControl<any> = ColumnControl<any>>(id: string): T {\r\n        return this.findControl((c) => c.id === id);\r\n    }\r\n\r\n    /**\r\n     * Finds a control within this page's control tree using the supplied predicate\r\n     *\r\n     * @param predicate Takes a control and returns true or false, if true that control is returned by findControl\r\n     */\r\n    public findControl<T extends ColumnControl<any> = ColumnControl<any>>(predicate: (c: ColumnControl<any>) => boolean): T {\r\n        // check all sections\r\n        for (let i = 0; i < this.sections.length; i++) {\r\n            // check all columns\r\n            for (let j = 0; j < this.sections[i].columns.length; j++) {\r\n                // check all controls\r\n                for (let k = 0; k < this.sections[i].columns[j].controls.length; k++) {\r\n                    // check to see if the predicate likes this control\r\n                    if (predicate(this.sections[i].columns[j].controls[k])) {\r\n                        return <T>this.sections[i].columns[j].controls[k];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // we found nothing so give nothing back\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Creates a copy of this page\r\n     * \r\n     * @param web The web where we will create the copy\r\n     * @param pageName The file name of the new page\r\n     * @param title The title of the new page\r\n     * @param publish If true the page will be published\r\n     */\r\n    @tag(\"csp.copy\")\r\n    public async copy(web: IWeb, pageName: string, title: string, publish = true, promotedState?: PromotedState): Promise<IClientsidePage> {\r\n\r\n        const page = await CreateClientsidePage(web, pageName, title, this.pageLayout, promotedState);\r\n\r\n        // we know the method is on the class - but it is protected so not part of the interface\r\n        (<any>page).setControls(this.getControls());\r\n\r\n        // we need to do some work to set the banner image url in the copied page\r\n        if (!stringIsNullOrEmpty(this.json.BannerImageUrl)) {\r\n\r\n            // use a URL to parse things for us\r\n            const url = new URL(this.json.BannerImageUrl);\r\n\r\n            // helper function to translate the guid strings into properly formatted guids with dashes\r\n            const makeGuid = (s: string) => s.replace(/(.{8})(.{4})(.{4})(.{4})(.{12})/g, \"$1-$2-$3-$4-$5\");\r\n\r\n            // protect against errors because the serverside impl has changed, we'll just skip\r\n            if (url.searchParams.has(\"guidSite\") && url.searchParams.has(\"guidWeb\") && url.searchParams.has(\"guidFile\")) {\r\n\r\n                const guidSite = makeGuid(url.searchParams.get(\"guidSite\"));\r\n                const guidWeb = makeGuid(url.searchParams.get(\"guidWeb\"));\r\n                const guidFile = makeGuid(url.searchParams.get(\"guidFile\"));\r\n\r\n                const site = Site(extractWebUrl(this.toUrl()));\r\n                const id = await site.select(\"Id\")<{ Id: string }>();\r\n                // the site guid must match the current site's guid or we are unable to set the image\r\n                if (id.Id === guidSite) {\r\n\r\n                    const openWeb = await site.openWebById(guidWeb);\r\n                    const file = await openWeb.web.getFileById(guidFile).select(\"ServerRelativeUrl\")();\r\n\r\n                    const props: any = {};\r\n                    if (this._layoutPart.properties) {\r\n\r\n                        if (hOP(this._layoutPart.properties, \"translateX\")) {\r\n                            props.translateX = this._layoutPart.properties.translateX;\r\n                        }\r\n\r\n\r\n                        if (hOP(this._layoutPart.properties, \"translateY\")) {\r\n                            props.translateY = this._layoutPart.properties.translateY;\r\n                        }\r\n\r\n\r\n                        if (hOP(this._layoutPart.properties, \"imageSourceType\")) {\r\n                            props.imageSourceType = this._layoutPart.properties.imageSourceType;\r\n                        }\r\n\r\n\r\n                        if (hOP(this._layoutPart.properties, \"altText\")) {\r\n                            props.altText = this._layoutPart.properties.altText;\r\n                        }\r\n                    }\r\n\r\n                    page.setBannerImage(file.ServerRelativeUrl, props);\r\n                }\r\n            }\r\n        }\r\n\r\n        await page.save(publish);\r\n\r\n        return page;\r\n    }\r\n\r\n    /**\r\n     * Sets the modern page banner image\r\n     * \r\n     * @param url Url of the image to display\r\n     * @param altText Alt text to describe the image\r\n     * @param bannerProps Additional properties to control display of the banner\r\n     */\r\n    public setBannerImage(url: string, props?: IBannerImageProps): void {\r\n\r\n        if (isUrlAbsolute(url)) {\r\n            // do our best to make this a server relative url by removing the x.sharepoint.com part\r\n            url = url.replace(/^https?:\\/\\/[a-z0-9\\.]*?\\.[a-z]{2,3}\\//i, \"/\");\r\n        }\r\n\r\n        this.json.BannerImageUrl = url;\r\n        this._bannerImageDirty = true;\r\n        /*\r\n            setting the banner image resets the thumbnail image (matching UI functionality)\r\n            but if the thumbnail is dirty they are likely trying to set them both to\r\n            different values, so we allow that here.\r\n            Also allows the banner image to be updated safely with the calculated one in save()\r\n        */\r\n        if (!this._bannerImageThumbnailUrlDirty) {\r\n            this.thumbnailUrl = url;\r\n            this._pageSettings.pageSettingsSlice.isDefaultThumbnail = true;\r\n        }\r\n\r\n        // this seems to always be true, so default\r\n        this._layoutPart.properties.imageSourceType = 2;\r\n\r\n        if (objectDefinedNotNull(props)) {\r\n            if (hOP(props, \"translateX\")) {\r\n                this._layoutPart.properties.translateX = props.translateX;\r\n            }\r\n            if (hOP(props, \"translateY\")) {\r\n                this._layoutPart.properties.translateY = props.translateY;\r\n            }\r\n            if (hOP(props, \"imageSourceType\")) {\r\n                this._layoutPart.properties.imageSourceType = props.imageSourceType;\r\n            }\r\n            if (hOP(props, \"altText\")) {\r\n                this._layoutPart.properties.altText = props.altText;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Sets the banner image url from an external source. You must call save to persist the changes\r\n     * \r\n     * @param url absolute url of the external file\r\n     * @param props optional set of properties to control display of the banner image\r\n     */\r\n    public async setBannerImageFromExternalUrl(url: string, props?: IBannerImageProps): Promise<void> {\r\n\r\n        // validate and parse our input url\r\n        const fileUrl = new URL(url);\r\n\r\n        // get our page name without extension, used as a folder name when creating the file\r\n        const pageName = this.json.FileName.replace(/\\.[^/.]+$/, \"\");\r\n\r\n        // get the filename we will use\r\n        const filename = fileUrl.pathname.split(/[\\\\\\/]/i).pop();\r\n\r\n        const request = initFrom(this, \"_api/sitepages/AddImageFromExternalUrl\");\r\n        request.query.set(\"imageFileName\", `'${encodeURIComponent(filename)}'`);\r\n        request.query.set(\"pageName\", `'${encodeURIComponent(pageName)}'`);\r\n        request.query.set(\"externalUrl\", `'${encodeURIComponent(url)}'`);\r\n        request.select(\"ServerRelativeUrl\");\r\n\r\n        const result = await spPost<Pick<IFileInfo, \"ServerRelativeUrl\">>(request);\r\n        // set with the newly created relative url\r\n        this.setBannerImage(result.ServerRelativeUrl, props);\r\n    }\r\n\r\n    /**\r\n     * Sets the authors for this page from the supplied list of user integer ids\r\n     * \r\n     * @param authorId The integer id of the user to set as the author\r\n     */\r\n    public async setAuthorById(authorId: number): Promise<void> {\r\n\r\n        const userLoginData = await SharePointQueryableCollection(extractWebUrl(this.toUrl()), \"/_api/web/siteusers\")\r\n            .configureFrom(this)\r\n            .filter(`Id eq ${authorId}`)\r\n            .select(\"LoginName\")<{ LoginName: string }[]>();\r\n\r\n        if (userLoginData.length < 1) {\r\n            throw Error(`Could not find user with id ${authorId}.`);\r\n        }\r\n\r\n        return this.setAuthorByLoginName(userLoginData[0].LoginName);\r\n    }\r\n\r\n    /**\r\n     * Sets the authors for this page from the supplied list of user integer ids\r\n     * \r\n     * @param authorLoginName The login name of the user (ex: i:0#.f|membership|name@tenant.com)\r\n     */\r\n    public async setAuthorByLoginName(authorLoginName: string): Promise<void> {\r\n\r\n        const userLoginData = await SharePointQueryableCollection(extractWebUrl(this.toUrl()), \"/_api/web/siteusers\")\r\n            .configureFrom(this)\r\n            .filter(`LoginName eq '${encodeURIComponent(authorLoginName)}'`)\r\n            .select(\"UserPrincipalName\", \"Title\")<{ UserPrincipalName: string, Title: string }[]>();\r\n\r\n        if (userLoginData.length < 1) {\r\n            throw Error(`Could not find user with login name '${authorLoginName}'.`);\r\n        }\r\n\r\n        this.json.AuthorByline = [authorLoginName];\r\n        this._layoutPart.properties.authorByline = [authorLoginName];\r\n        this._layoutPart.properties.authors = [{\r\n            id: authorLoginName,\r\n            name: userLoginData[0].Title,\r\n            role: \"\",\r\n            upn: userLoginData[0].UserPrincipalName,\r\n        }];\r\n    }\r\n\r\n    /**\r\n     * Gets the list item associated with this clientside page\r\n     * \r\n     * @param selects Specific set of fields to include when getting the item\r\n     */\r\n    @tag(\"csp.getItem\")\r\n    public async getItem<T>(...selects: string[]): Promise<IItem & T> {\r\n\r\n        const initer = initFrom(this, \"/_api/lists/EnsureClientRenderedSitePagesLibrary\").select(\"EnableModeration\", \"EnableMinorVersions\", \"Id\");\r\n        const listData = await spPost<{ Id: string, \"odata.id\": string }>(initer);\r\n        const item = (List(listData[\"odata.id\"])).configureFrom(this).items.getById(this.json.Id);\r\n        const itemData: T = await item.select.apply(item, selects)();\r\n        return assign((Item(odataUrlFrom(itemData))).configureFrom(this), itemData);\r\n    }\r\n\r\n    /**\r\n     * Extends this queryable from the provided parent \r\n     * \r\n     * @param parent Parent queryable from which we will derive a base url\r\n     * @param path Additional path\r\n     */\r\n    protected assign(parent: IQueryable<any>, path?: string) {\r\n        this.data.parentUrl = parent.data.url;\r\n        this.data.url = combine(this.data.parentUrl, path || \"\");\r\n        this.configureFrom(parent);\r\n    }\r\n\r\n    protected getCanvasContent1(): string {\r\n        return JSON.stringify(this.getControls());\r\n    }\r\n\r\n    protected getLayoutWebpartsContent(): string {\r\n        if (this._layoutPart) {\r\n            return JSON.stringify([this._layoutPart]);\r\n        } else {\r\n            return JSON.stringify(null);\r\n        }\r\n    }\r\n\r\n    protected setControls(controls: IClientsideControlBaseData[]): void {\r\n\r\n        // reset the sections\r\n        this.sections = [];\r\n\r\n        if (controls && controls.length) {\r\n\r\n            for (let i = 0; i < controls.length; i++) {\r\n\r\n                // if no control type is present this is a column which we give type 0 to let us process it\r\n                const controlType = hOP(controls[i], \"controlType\") ? controls[i].controlType : 0;\r\n\r\n                switch (controlType) {\r\n\r\n                    case 0:\r\n                        // empty canvas column or page settings\r\n                        if (hOP(controls[i], \"pageSettingsSlice\")) {\r\n                            this._pageSettings = <IClientsidePageSettingsSlice>controls[i];\r\n                        } else {\r\n                            // we have an empty column\r\n                            this.mergeColumnToTree(new CanvasColumn(<IClientsidePageColumnData>controls[i]));\r\n                        }\r\n                        break;\r\n                    case 3:\r\n                        const part = new ClientsideWebpart(<IClientsideWebPartData>controls[i]);\r\n                        this.mergePartToTree(part, part.data.position);\r\n                        break;\r\n                    case 4:\r\n                        const textData = <IClientsideTextData>controls[i];\r\n                        const text = new ClientsideText(textData.innerHTML, textData);\r\n                        this.mergePartToTree(text, text.data.position);\r\n                        break;\r\n                }\r\n            }\r\n\r\n            reindex(this.sections);\r\n        }\r\n    }\r\n\r\n    protected getControls(): IClientsideControlBaseData[] {\r\n\r\n        // reindex things\r\n        reindex(this.sections);\r\n\r\n        // rollup the control changes\r\n        const canvasData: any[] = [];\r\n\r\n        this.sections.forEach(section => {\r\n            section.columns.forEach(column => {\r\n                if (column.controls.length < 1) {\r\n                    // empty column\r\n                    canvasData.push({\r\n                        displayMode: column.data.displayMode,\r\n                        emphasis: this.getEmphasisObj(section.emphasis),\r\n                        position: column.data.position,\r\n                    });\r\n                } else {\r\n                    column.controls.forEach(control => {\r\n                        control.data.emphasis = this.getEmphasisObj(section.emphasis);\r\n                        canvasData.push(control.data);\r\n                    });\r\n                }\r\n            });\r\n        });\r\n\r\n        canvasData.push(this._pageSettings);\r\n\r\n        return canvasData;\r\n    }\r\n\r\n    private getEmphasisObj(value: 0 | 1 | 2 | 3): IClientControlEmphasis {\r\n        if (value < 1 || value > 3) {\r\n            return {};\r\n        }\r\n\r\n        return { zoneEmphasis: value };\r\n    }\r\n\r\n    private async promoteNewsImpl(method: string): Promise<boolean> {\r\n\r\n        if (this.json.Id === null) {\r\n            throw Error(\"The id for this page is null.\");\r\n        }\r\n\r\n        // per bug #858 if we promote before we have ever published the last published date will\r\n        // forever not be updated correctly in the modern news web part. Because this will affect very\r\n        // few folks we just go ahead and publish for them here as that is likely what they intended.\r\n        if (stringIsNullOrEmpty(this.json.VersionInfo.LastVersionCreatedBy)) {\r\n            const lastPubData = new Date(this.json.VersionInfo.LastVersionCreated);\r\n            // no modern page should reasonable be published before the year 2000 :)\r\n            if (lastPubData.getFullYear() < 2000) {\r\n                await this.save(true);\r\n            }\r\n        }\r\n\r\n        return await spPost(initFrom(this, `_api/sitepages/pages(${this.json.Id})/${method}`), body(metadata(\"SP.Publishing.SitePage\")));\r\n    }\r\n\r\n    /**\r\n     * Merges the control into the tree of sections and columns for this page\r\n     * \r\n     * @param control The control to merge\r\n     */\r\n    private mergePartToTree(control: any, positionData: IPosition): void {\r\n\r\n        let column: CanvasColumn = null;\r\n        let sectionFactor: CanvasColumnFactor = 12;\r\n        let sectionIndex = 0;\r\n        let zoneIndex = 0;\r\n        let layoutIndex = 1;\r\n\r\n        // handle case where we don't have position data (shouldn't happen?)\r\n        if (positionData) {\r\n            if (hOP(positionData, \"zoneIndex\")) {\r\n                zoneIndex = positionData.zoneIndex;\r\n            }\r\n            if (hOP(positionData, \"sectionIndex\")) {\r\n                sectionIndex = positionData.sectionIndex;\r\n            }\r\n            if (hOP(positionData, \"sectionFactor\")) {\r\n                sectionFactor = positionData.sectionFactor;\r\n            }\r\n            if (hOP(positionData, \"layoutIndex\")) {\r\n                layoutIndex = positionData.layoutIndex;\r\n            }\r\n        }\r\n\r\n        const zoneEmphasis = control.data?.emphasis?.zoneEmphasis ?? 0;\r\n        const section = this.getOrCreateSection(zoneIndex, layoutIndex, zoneEmphasis);\r\n\r\n        const columns = section.columns.filter(c => c.order === sectionIndex);\r\n        if (columns.length < 1) {\r\n            column = section.addColumn(sectionFactor, layoutIndex);\r\n        } else {\r\n            column = columns[0];\r\n        }\r\n\r\n        control.column = column;\r\n        column.addControl(control);\r\n    }\r\n\r\n    /**\r\n     * Merges the supplied column into the tree\r\n     * \r\n     * @param column Column to merge\r\n     * @param position The position data for the column\r\n     */\r\n    private mergeColumnToTree(column: CanvasColumn): void {\r\n\r\n        const order = hOP(column.data, \"position\") && hOP(column.data.position, \"zoneIndex\") ? column.data.position.zoneIndex : 0;\r\n        const layoutIndex = hOP(column.data, \"position\") && hOP(column.data.position, \"layoutIndex\") ? column.data.position.layoutIndex : 1;\r\n        const section = this.getOrCreateSection(order, layoutIndex, column.data?.emphasis?.zoneEmphasis || 0);\r\n        column.section = section;\r\n        section.columns.push(column);\r\n    }\r\n\r\n    /**\r\n     * Handle the logic to get or create a section based on the supplied order and layoutIndex\r\n     * \r\n     * @param order Section order\r\n     * @param layoutIndex Layout Index (1 === normal, 2 === vertical section)\r\n     * @param emphasis The section emphasis\r\n     */\r\n    private getOrCreateSection(order: number, layoutIndex: number, emphasis: 0 | 1 | 2 | 3): CanvasSection {\r\n\r\n        let section: CanvasSection = null;\r\n        const sections = this.sections.filter(s => s.order === order && s.layoutIndex === layoutIndex);\r\n\r\n        if (sections.length < 1) {\r\n            section = layoutIndex === 2 ? this.addVerticalSection() : this.addSection();\r\n            section.order = order;\r\n            section.emphasis = emphasis;\r\n        } else {\r\n            section = sections[0];\r\n        }\r\n\r\n        return section;\r\n    }\r\n}\r\nexport interface IClientsidePage extends _ClientsidePage { }\r\n\r\n/**\r\n * Invokable factory for IClientSidePage instances\r\n */\r\nconst ClientsidePage = (\r\n    baseUrl: string | ISharePointQueryable,\r\n    path?: string,\r\n    json?: Partial<IPageData>,\r\n    noInit = false,\r\n    sections: CanvasSection[] = [],\r\n    commentsDisabled = false): IClientsidePage => {\r\n\r\n    return invokableFactory<IClientsidePage>(_ClientsidePage)(baseUrl, path, json, noInit, sections, commentsDisabled);\r\n};\r\n\r\n/**\r\n * Loads a client side page from the supplied IFile instance\r\n * \r\n * @param file Source IFile instance\r\n */\r\nexport const ClientsidePageFromFile = async (file: IFile): Promise<IClientsidePage> => {\r\n\r\n    const item = await file.getItem<{ Id: number }>();\r\n    const page = ClientsidePage(extractWebUrl(file.toUrl()), \"\", { Id: item.Id }, true);\r\n    return page.configureFrom(file).load();\r\n};\r\n\r\n/**\r\n * Creates a new client side page\r\n * \r\n * @param web The web or list\r\n * @param pageName The name of the page (filename)\r\n * @param title The page's title\r\n * @param PageLayoutType Layout to use when creating the page\r\n */\r\nexport const CreateClientsidePage =\r\n    async (web: IWeb, pageName: string, title: string, PageLayoutType: ClientsidePageLayoutType = \"Article\", promotedState: PromotedState = 0): Promise<IClientsidePage> => {\r\n\r\n        // patched because previously we used the full page name with the .aspx at the end\r\n        // this allows folk's existing code to work after the re-write to the new API\r\n        pageName = pageName.replace(/\\.aspx$/i, \"\");\r\n\r\n        // initialize the page, at this point a checked-out page with a junk filename will be created.\r\n        const pageInitData: IPageData = await spPost(initFrom(web, \"_api/sitepages/pages\"), body(Object.assign(metadata(\"SP.Publishing.SitePage\"), {\r\n            PageLayoutType,\r\n            PromotedState: promotedState,\r\n        })));\r\n\r\n        // now we can init our page with the save data\r\n        const newPage = ClientsidePage(web, \"\", pageInitData);\r\n        newPage.title = pageName;\r\n        await newPage.save(false);\r\n        newPage.title = title;\r\n        return newPage;\r\n    };\r\n\r\nexport class CanvasSection {\r\n\r\n    /**\r\n     * Used to track this object inside the collection at runtime\r\n     */\r\n    private _memId: string;\r\n\r\n    private _order: number;\r\n    private _layoutIndex: number;\r\n\r\n    constructor(protected page: IClientsidePage, order: number, layoutIndex: number, public columns: CanvasColumn[] = [], private _emphasis: 0 | 1 | 2 | 3 = 0) {\r\n        this._memId = getGUID();\r\n        this._order = order;\r\n        this._layoutIndex = layoutIndex;\r\n    }\r\n\r\n    public get order(): number {\r\n        return this._order;\r\n    }\r\n\r\n    public set order(value: number) {\r\n        this._order = value;\r\n        for (let i = 0; i < this.columns.length; i++) {\r\n            this.columns[i].data.position.zoneIndex = value;\r\n        }\r\n    }\r\n\r\n    public get layoutIndex(): number {\r\n        return this._layoutIndex;\r\n    }\r\n\r\n    public set layoutIndex(value: number) {\r\n        this._layoutIndex = value;\r\n        for (let i = 0; i < this.columns.length; i++) {\r\n            this.columns[i].data.position.layoutIndex = value;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Default column (this.columns[0]) for this section\r\n     */\r\n    public get defaultColumn(): CanvasColumn {\r\n\r\n        if (this.columns.length < 1) {\r\n            this.addColumn(12);\r\n        }\r\n\r\n        return this.columns[0];\r\n    }\r\n\r\n    /**\r\n     * Adds a new column to this section\r\n     */\r\n    public addColumn(factor: CanvasColumnFactor, layoutIndex = this.layoutIndex): CanvasColumn {\r\n        const column = new CanvasColumn();\r\n        column.section = this;\r\n        column.data.position.zoneIndex = this.order;\r\n        column.data.position.layoutIndex = layoutIndex;\r\n        column.data.position.sectionFactor = factor;\r\n        column.order = getNextOrder(this.columns);\r\n        this.columns.push(column);\r\n        return column;\r\n    }\r\n\r\n    /**\r\n     * Adds a control to the default column for this section\r\n     *\r\n     * @param control Control to add to the default column\r\n     */\r\n    public addControl(control: ColumnControl<any>): this {\r\n        this.defaultColumn.addControl(control);\r\n        return this;\r\n    }\r\n\r\n    public get emphasis(): 0 | 1 | 2 | 3 {\r\n        return this._emphasis;\r\n    }\r\n\r\n    public set emphasis(value: 0 | 1 | 2 | 3) {\r\n        this._emphasis = value;\r\n    }\r\n\r\n    /**\r\n     * Removes this section and all contained columns and controls from the collection\r\n     */\r\n    public remove(): void {\r\n        this.page.sections = this.page.sections.filter(section => section._memId !== this._memId);\r\n        reindex(this.page.sections);\r\n    }\r\n}\r\n\r\nexport class CanvasColumn {\r\n\r\n    public static Default: IClientsidePageColumnData = {\r\n        controlType: 0,\r\n        displayMode: 2,\r\n        emphasis: {},\r\n        position: {\r\n            layoutIndex: 1,\r\n            sectionFactor: 12,\r\n            sectionIndex: 1,\r\n            zoneIndex: 1,\r\n        },\r\n    };\r\n\r\n    private _section: CanvasSection | null;\r\n    private _memId: string;\r\n\r\n    constructor(protected json: IClientsidePageColumnData = JSON.parse(JSON.stringify(CanvasColumn.Default)), public controls: ColumnControl<any>[] = []) {\r\n        this._section = null;\r\n        this._memId = getGUID();\r\n    }\r\n\r\n    public get data(): IClientsidePageColumnData {\r\n        return this.json;\r\n    }\r\n\r\n    public get section(): CanvasSection {\r\n        return this._section;\r\n    }\r\n\r\n    public set section(section: CanvasSection) {\r\n        this._section = section;\r\n    }\r\n\r\n    public get order(): number {\r\n        return this.data.position.sectionIndex;\r\n    }\r\n\r\n    public set order(value: number) {\r\n        this.data.position.sectionIndex = value;\r\n        for (let i = 0; i < this.controls.length; i++) {\r\n            this.controls[i].data.position.zoneIndex = this.data.position.zoneIndex;\r\n            this.controls[i].data.position.layoutIndex = this.data.position.layoutIndex;\r\n            this.controls[i].data.position.sectionIndex = value;\r\n        }\r\n    }\r\n\r\n    public get factor(): CanvasColumnFactor {\r\n        return this.data.position.sectionFactor;\r\n    }\r\n\r\n    public set factor(value: CanvasColumnFactor) {\r\n        this.data.position.sectionFactor = value;\r\n    }\r\n\r\n    public addControl(control: ColumnControl<any>): this {\r\n        control.column = this;\r\n        this.controls.push(control);\r\n        return this;\r\n    }\r\n\r\n    public getControl<T extends ColumnControl<any>>(index: number): T {\r\n        return <T>this.controls[index];\r\n    }\r\n\r\n    public remove(): void {\r\n        this.section.columns = this.section.columns.filter(column => column._memId !== this._memId);\r\n        reindex(this.section.columns);\r\n    }\r\n}\r\n\r\nexport abstract class ColumnControl<T extends ICanvasControlBaseData> {\r\n\r\n    private _column: CanvasColumn | null;\r\n\r\n    constructor(protected json: T) { }\r\n\r\n    public abstract get order(): number;\r\n    public abstract set order(value: number);\r\n\r\n    public get id(): string {\r\n        return this.json.id;\r\n    }\r\n\r\n    public get data(): T {\r\n        return this.json;\r\n    }\r\n\r\n    public get column(): CanvasColumn | null {\r\n        return this._column;\r\n    }\r\n\r\n    public set column(value: CanvasColumn) {\r\n        this._column = value;\r\n        this.onColumnChange(this._column);\r\n    }\r\n\r\n    public remove(): void {\r\n        this.column.controls = this.column.controls.filter(control => control.id !== this.id);\r\n        reindex(this.column.controls);\r\n    }\r\n\r\n    protected setData(data: T) {\r\n        this.json = data;\r\n    }\r\n\r\n    protected abstract onColumnChange(col: CanvasColumn): void;\r\n}\r\n\r\nexport class ClientsideText extends ColumnControl<IClientsideTextData> {\r\n\r\n    public static Default: IClientsideTextData = {\r\n        addedFromPersistedData: false,\r\n        anchorComponentId: \"\",\r\n        controlType: 4,\r\n        displayMode: 2,\r\n        editorType: \"CKEditor\",\r\n        emphasis: {},\r\n        id: \"\",\r\n        innerHTML: \"\",\r\n        position: {\r\n            controlIndex: 1,\r\n            layoutIndex: 1,\r\n            sectionFactor: 12,\r\n            sectionIndex: 1,\r\n            zoneIndex: 1,\r\n        },\r\n    };\r\n\r\n    constructor(text: string, json: IClientsideTextData = JSON.parse(JSON.stringify(ClientsideText.Default))) {\r\n        if (stringIsNullOrEmpty(json.id)) {\r\n            json.id = getGUID();\r\n            json.anchorComponentId = json.id;\r\n        }\r\n        super(json);\r\n\r\n        this.text = text;\r\n    }\r\n\r\n    public get text(): string {\r\n        return this.data.innerHTML;\r\n    }\r\n\r\n    public set text(value: string) {\r\n        this.data.innerHTML = value;\r\n    }\r\n\r\n    public get order(): number {\r\n        return this.data.position.controlIndex;\r\n    }\r\n\r\n    public set order(value: number) {\r\n        this.data.position.controlIndex = value;\r\n    }\r\n\r\n    protected onColumnChange(col: CanvasColumn): void {\r\n        this.data.position.sectionFactor = col.factor;\r\n        this.data.position.controlIndex = getNextOrder(col.controls);\r\n        this.data.position.zoneIndex = col.data.position.zoneIndex;\r\n        this.data.position.sectionIndex = col.order;\r\n        this.data.position.layoutIndex = col.data.position.layoutIndex;\r\n    }\r\n}\r\n\r\nexport class ClientsideWebpart extends ColumnControl<IClientsideWebPartData> {\r\n\r\n    public static Default: IClientsideWebPartData = {\r\n        addedFromPersistedData: false,\r\n        controlType: 3,\r\n        displayMode: 2,\r\n        emphasis: {},\r\n        id: null,\r\n        position: {\r\n            controlIndex: 1,\r\n            layoutIndex: 1,\r\n            sectionFactor: 12,\r\n            sectionIndex: 1,\r\n            zoneIndex: 1,\r\n        },\r\n        reservedHeight: 500,\r\n        reservedWidth: 500,\r\n        webPartData: null,\r\n        webPartId: null,\r\n    };\r\n\r\n    constructor(json: IClientsideWebPartData = JSON.parse(JSON.stringify(ClientsideWebpart.Default))) {\r\n        super(json);\r\n    }\r\n\r\n    public static fromComponentDef(definition: IClientsidePageComponent): ClientsideWebpart {\r\n        const part = new ClientsideWebpart();\r\n        part.import(definition);\r\n        return part;\r\n    }\r\n\r\n    public get title(): string {\r\n        return this.data.webPartData.title;\r\n    }\r\n\r\n    public set title(value: string) {\r\n        this.data.webPartData.title = value;\r\n    }\r\n\r\n    public get description(): string {\r\n        return this.data.webPartData.description;\r\n    }\r\n\r\n    public set description(value: string) {\r\n        this.data.webPartData.description = value;\r\n    }\r\n\r\n    public get order(): number {\r\n        return this.data.position.controlIndex;\r\n    }\r\n\r\n    public set order(value: number) {\r\n        this.data.position.controlIndex = value;\r\n    }\r\n\r\n    public get height(): number {\r\n        return this.data.reservedHeight;\r\n    }\r\n\r\n    public set height(value: number) {\r\n        this.data.reservedHeight = value;\r\n    }\r\n\r\n    public get width(): number {\r\n        return this.data.reservedWidth;\r\n    }\r\n\r\n    public set width(value: number) {\r\n        this.data.reservedWidth = value;\r\n    }\r\n\r\n    public get dataVersion(): string {\r\n        return this.data.webPartData.dataVersion;\r\n    }\r\n\r\n    public set dataVersion(value: string) {\r\n        this.data.webPartData.dataVersion = value;\r\n    }\r\n\r\n    public setProperties<T = any>(properties: T): this {\r\n        this.data.webPartData.properties = assign(this.data.webPartData.properties, properties);\r\n        return this;\r\n    }\r\n\r\n    public getProperties<T = any>(): T {\r\n        return <T>this.data.webPartData.properties;\r\n    }\r\n\r\n    protected onColumnChange(col: CanvasColumn): void {\r\n        this.data.position.sectionFactor = col.factor;\r\n        this.data.position.controlIndex = getNextOrder(col.controls);\r\n        this.data.position.zoneIndex = col.data.position.zoneIndex;\r\n        this.data.position.sectionIndex = col.data.position.sectionIndex;\r\n        this.data.position.layoutIndex = col.data.position.layoutIndex;\r\n    }\r\n\r\n    protected import(component: IClientsidePageComponent): void {\r\n\r\n        const id = getGUID();\r\n        const componendId = component.Id.replace(/^\\{|\\}$/g, \"\").toLowerCase();\r\n        const manifest: IClientSidePageComponentManifest = JSON.parse(component.Manifest);\r\n        const preconfiguredEntries = manifest.preconfiguredEntries[0];\r\n\r\n        this.setData(Object.assign({}, this.data, <IClientsideWebPartData>{\r\n            id,\r\n            webPartData: {\r\n                dataVersion: \"1.0\",\r\n                description: preconfiguredEntries.description.default,\r\n                id: componendId,\r\n                instanceId: id,\r\n                properties: preconfiguredEntries.properties,\r\n                title: preconfiguredEntries.title.default,\r\n            },\r\n            webPartId: componendId,\r\n        }));\r\n    }\r\n}\r\n\r\nexport interface IPageData {\r\n    readonly \"odata.metadata\": string;\r\n    readonly \"odata.type\": \"SP.Publishing.SitePage\";\r\n    readonly \"odata.id\": string;\r\n    readonly \"odata.editLink\": string;\r\n    AbsoluteUrl: string;\r\n    AuthorByline: string[] | null;\r\n    BannerImageUrl: string;\r\n    BannerThumbnailUrl: string;\r\n    ContentTypeId: null | string;\r\n    Description: string;\r\n    DoesUserHaveEditPermission: boolean;\r\n    FileName: string;\r\n    readonly FirstPublished: string;\r\n    readonly Id: number;\r\n    IsPageCheckedOutToCurrentUser: boolean;\r\n    IsWebWelcomePage: boolean;\r\n    readonly Modified: string;\r\n    PageLayoutType: ClientsidePageLayoutType;\r\n    Path: {\r\n        DecodedUrl: string;\r\n    };\r\n    PromotedState: number;\r\n    Title: string;\r\n    TopicHeader: null | string;\r\n    readonly UniqueId: string;\r\n    Url: string;\r\n    readonly Version: string;\r\n    readonly VersionInfo: {\r\n        readonly LastVersionCreated: string;\r\n        readonly LastVersionCreatedBy: string;\r\n    };\r\n    AlternativeUrlMap: string;\r\n    CanvasContent1: string;\r\n    LayoutWebpartsContent: string;\r\n}\r\n\r\n/**\r\n * Client side webpart object (retrieved via the _api/web/GetClientSideWebParts REST call)\r\n */\r\nexport interface IClientsidePageComponent {\r\n    /**\r\n     * Component type for client side webpart object\r\n     */\r\n    ComponentType: number;\r\n    /**\r\n     * Id for client side webpart object\r\n     */\r\n    Id: string;\r\n    /**\r\n     * Manifest for client side webpart object\r\n     */\r\n    Manifest: string;\r\n    /**\r\n     * Manifest type for client side webpart object\r\n     */\r\n    ManifestType: number;\r\n    /**\r\n     * Name for client side webpart object\r\n     */\r\n    Name: string;\r\n    /**\r\n     * Status for client side webpart object\r\n     */\r\n    Status: number;\r\n}\r\n\r\ninterface IClientSidePageComponentManifest {\r\n    alias: string;\r\n    componentType: \"WebPart\" | \"\" | null;\r\n    disabledOnClassicSharepoint: boolean;\r\n    hiddenFromToolbox: boolean;\r\n    id: string;\r\n    imageLinkPropertyNames: any;\r\n    isInternal: boolean;\r\n    linkPropertyNames: boolean;\r\n    loaderConfig: any;\r\n    manifestVersion: number;\r\n    preconfiguredEntries: {\r\n        description: { default: string };\r\n        group: { default: string };\r\n        groupId: string;\r\n        iconImageUrl: string;\r\n        officeFabricIconFontName: string;\r\n        properties: ITypedHash<any>;\r\n        title: { default: string };\r\n\r\n    }[];\r\n    preloadComponents: any | null;\r\n    requiredCapabilities: any | null;\r\n    searchablePropertyNames: any | null;\r\n    supportsFullBleed: boolean;\r\n    version: string;\r\n}\r\n\r\nexport interface IClientsideControlBaseData {\r\n    controlType: number;\r\n}\r\n\r\nexport interface ICanvasControlBaseData extends IClientsideControlBaseData {\r\n    id: string;\r\n    emphasis: IClientControlEmphasis;\r\n    displayMode: number;\r\n}\r\n\r\nexport interface IClientsidePageSettingsSlice extends IClientsideControlBaseData {\r\n    htmlAttributes?: string[];\r\n    pageSettingsSlice: {\r\n        \"isDefaultDescription\": boolean;\r\n        \"isDefaultThumbnail\": boolean;\r\n    };\r\n}\r\n\r\nexport interface IClientsidePageColumnData extends IClientsideControlBaseData {\r\n    controlType: 0;\r\n    displayMode: number;\r\n    emphasis: IClientControlEmphasis;\r\n    position: IPosition;\r\n}\r\n\r\ninterface IPosition {\r\n    zoneIndex: number;\r\n    sectionIndex: number;\r\n    controlIndex?: number;\r\n    sectionFactor?: CanvasColumnFactor;\r\n    layoutIndex: number;\r\n}\r\n\r\nexport interface IClientsideTextData extends ICanvasControlBaseData {\r\n    controlType: 4;\r\n    position: IPosition;\r\n    anchorComponentId: string;\r\n    editorType: \"CKEditor\";\r\n    addedFromPersistedData: boolean;\r\n    innerHTML: string;\r\n}\r\n\r\nexport interface IClientsideWebPartData<PropertiesType = any> extends ICanvasControlBaseData {\r\n    controlType: 3;\r\n    position: IPosition;\r\n    webPartId: string;\r\n    reservedHeight: number;\r\n    reservedWidth: number;\r\n    addedFromPersistedData: boolean;\r\n    webPartData: {\r\n        id: string;\r\n        instanceId: string;\r\n        title: string;\r\n        description: string;\r\n        serverProcessedContent?: {\r\n            \"htmlStrings\": ITypedHash<string>;\r\n            \"searchablePlainTexts\": ITypedHash<string>;\r\n            \"imageSources\": ITypedHash<string>;\r\n            \"links\": ITypedHash<string>;\r\n        };\r\n        dataVersion: string;\r\n        properties: PropertiesType;\r\n    };\r\n}\r\n\r\nexport interface IClientControlEmphasis {\r\n    zoneEmphasis?: 0 | 1 | 2 | 3;\r\n}\r\n\r\nexport type LayoutType = \"FullWidthImage\" | \"NoImage\" | \"ColorBlock\" | \"CutInShape\";\r\nexport type TextAlignment = \"Left\" | \"Center\";\r\n\r\ninterface ILayoutPartsContent {\r\n    id: string;\r\n    instanceId: string;\r\n    title: string;\r\n    description: string;\r\n    serverProcessedContent: {\r\n        htmlStrings: ITypedHash<string>;\r\n        searchablePlainTexts: ITypedHash<string>;\r\n        imageSources: ITypedHash<string>;\r\n        links: ITypedHash<string>;\r\n        customMetadata?: {\r\n            imageSource?: {\r\n                siteId: string;\r\n                webId: string;\r\n                listId: string;\r\n                uniqueId: string;\r\n            },\r\n        }\r\n    };\r\n    dataVersion: string;\r\n    properties: {\r\n        title: string;\r\n        imageSourceType?: number;\r\n        layoutType: LayoutType;\r\n        textAlignment: TextAlignment;\r\n        showTopicHeader: boolean;\r\n        showPublishDate: boolean;\r\n        topicHeader: string;\r\n        authorByline: string[];\r\n        authors: {\r\n            id: string,\r\n            upn: string;\r\n            name: string;\r\n            role: string;\r\n        }[];\r\n        webId?: string;\r\n        siteId?: string;\r\n        listId?: string;\r\n        uniqueId?: string;\r\n        translateX?: number;\r\n        translateY?: number;\r\n        altText?: string;\r\n    };\r\n    reservedHeight: number;\r\n}\r\n\r\nexport interface IBannerImageProps {\r\n    altText?: string;\r\n    imageSourceType?: number;\r\n    translateX?: number;\r\n    translateY?: number;\r\n}\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _Item, Item } from \"../items/types\";\r\nimport { Comments, IComments, ILikeData, ILikedByInformation } from \"./types\";\r\nimport { spPost } from \"../operations\";\r\n\r\ndeclare module \"../items/types\" {\r\n    interface _Item {\r\n        readonly comments: IComments;\r\n        getLikedBy(): Promise<ILikeData[]>;\r\n        like(): Promise<void>;\r\n        unlike(): Promise<void>;\r\n        getLikedByInformation(): Promise<ILikedByInformation>;\r\n    }\r\n    interface IItem {\r\n        readonly comments: IComments;\r\n        /**\r\n         * Gets the collection of people who have liked this item\r\n         */\r\n        getLikedBy(): Promise<ILikeData[]>;\r\n        /**\r\n         * Likes this item as the current user\r\n         */\r\n        like(): Promise<void>;\r\n        /**\r\n         * Unlikes this item as the current user\r\n         */\r\n        unlike(): Promise<void>;\r\n        /**\r\n         * Get the like by information for a modern site page     \r\n         */\r\n        getLikedByInformation(): Promise<ILikedByInformation>;\r\n    }\r\n}\r\n\r\naddProp(_Item, \"comments\", Comments);\r\n\r\n_Item.prototype.getLikedBy = function (this: _Item): Promise<ILikeData[]> {\r\n    return spPost<ILikeData[]>(this.clone(Item, \"likedBy\"));\r\n};\r\n\r\n_Item.prototype.like = function (this: _Item): Promise<void> {\r\n    return spPost<void>(this.clone(Item, \"like\"));\r\n};\r\n\r\n_Item.prototype.unlike = function (this: _Item): Promise<void> {\r\n    return spPost<void>(this.clone(Item, \"unlike\"));\r\n};\r\n\r\n_Item.prototype.getLikedByInformation = function (this: _Item): Promise<ILikedByInformation> {\r\n    return this.clone(Item, \"likedByInformation\").expand(\"likedby\")<ILikedByInformation>();\r\n};\r\n","import { _Web, IWeb } from \"../webs/types\";\r\nimport { IClientsidePageComponent, CreateClientsidePage, IClientsidePage, ClientsidePageLayoutType, ClientsidePageFromFile, PromotedState } from \"./types\";\r\nimport { SharePointQueryableCollection } from \"../sharepointqueryable\";\r\n\r\ndeclare module \"../webs/types\" {\r\n    interface _Web {\r\n        getClientsideWebParts(): Promise<IClientsidePageComponent[]>;\r\n        addClientsidePage(pageName: string, title?: string, libraryTitle?: string, promotedState?: PromotedState): Promise<IClientsidePage>;\r\n        loadClientsidePage(path: string): Promise<IClientsidePage>;\r\n    }\r\n    interface IWeb {\r\n\r\n        /**\r\n         * Gets the collection of available client side web parts for this web instance\r\n         */\r\n        getClientsideWebParts(): Promise<IClientsidePageComponent[]>;\r\n\r\n        /**\r\n         * Creates a new client side page\r\n         *\r\n         * @param pageName Name of the new page\r\n         * @param title Display title of the new page\r\n         */\r\n        addClientsidePage(pageName: string, title?: string, PageLayoutType?: ClientsidePageLayoutType, promotedState?: PromotedState): Promise<IClientsidePage>;\r\n\r\n        /**\r\n         * Loads a page from the provided server relative path to the file\r\n         * \r\n         * @param path Server relative path to the file (ex: \"/sites/dev/sitepages/page.aspx\")\r\n         */\r\n        loadClientsidePage(path: string): Promise<IClientsidePage>;\r\n    }\r\n}\r\n\r\n_Web.prototype.getClientsideWebParts = function (): Promise<IClientsidePageComponent[]> {\r\n    return this.clone(SharePointQueryableCollection, \"GetClientSideWebParts\")();\r\n};\r\n\r\n_Web.prototype.addClientsidePage =\r\n    function (this: IWeb, pageName: string, title = pageName.replace(/\\.[^/.]+$/, \"\"), layout?: ClientsidePageLayoutType, promotedState?: PromotedState): Promise<IClientsidePage> {\r\n        return CreateClientsidePage(this, pageName, title, layout, promotedState);\r\n    };\r\n\r\n_Web.prototype.loadClientsidePage = function (this: IWeb, path: string): Promise<IClientsidePage> {\r\n    return ClientsidePageFromFile(this.getFileByServerRelativePath(path));\r\n};\r\n","import { assign, ITypedHash, isUrlAbsolute, combine } from \"@pnp/common\";\r\nimport {\r\n    SharePointQueryable,\r\n    SharePointQueryableCollection,\r\n    SharePointQueryableInstance,\r\n    _SharePointQueryableInstance,\r\n    ISharePointQueryableCollection,\r\n    _SharePointQueryableCollection,\r\n    ISharePointQueryableInstance,\r\n    ISharePointQueryable,\r\n    spInvokableFactory,\r\n    deleteableWithETag,\r\n    IDeleteableWithETag,\r\n} from \"../sharepointqueryable\";\r\nimport { odataUrlFrom } from \"../odata\";\r\nimport { IItem, Item } from \"../items/types\";\r\nimport { body } from \"@pnp/odata\";\r\nimport { defaultPath } from \"../decorators\";\r\nimport { spPost } from \"../operations\";\r\nimport { escapeQueryStrValue } from \"../utils/escapeQueryStrValue\";\r\nimport { extractWebUrl } from \"../utils/extractweburl\";\r\nimport { tag } from \"../telemetry\";\r\nimport { toResourcePath, IResourcePath } from \"../utils/toResourcePath\";\r\n\r\n@defaultPath(\"folders\")\r\nexport class _Folders extends _SharePointQueryableCollection<IFolderInfo[]> {\r\n\r\n    /**\r\n     * Gets a folder by it's name\r\n     * \r\n     * @param name Folder's name\r\n     */\r\n    public getByName(name: string): IFolder {\r\n        return tag.configure(Folder(this).concat(`('${escapeQueryStrValue(name)}')`), \"fs.getByName\");\r\n    }\r\n\r\n    /**\r\n     * Adds a new folder at the specified URL\r\n     * \r\n     * @param url \r\n     */\r\n    @tag(\"fs.add\")\r\n    public async add(url: string): Promise<IFolderAddResult> {\r\n\r\n        const data = await spPost(this.clone(Folders, `add('${escapeQueryStrValue(url)}')`));\r\n\r\n        return {\r\n            data,\r\n            folder: this.getByName(url),\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Adds a new folder by path and should be prefered over add\r\n     * \r\n     * @param serverRelativeUrl The server relative url of the new folder to create\r\n     * @param overwrite True to overwrite an existing folder, default false\r\n     */\r\n    @tag(\"fs.addUsingPath\")\r\n    public async addUsingPath(serverRelativeUrl: string, overwrite = false): Promise<IFolderAddResult> {\r\n\r\n        const data = await spPost(this.clone(Folders, `addUsingPath(DecodedUrl='${escapeQueryStrValue(serverRelativeUrl)}',overwrite=${overwrite})`));\r\n\r\n        return {\r\n            data,\r\n            folder: Folder(extractWebUrl(this.toUrl()), `_api/web/getFolderByServerRelativePath(decodedUrl='${escapeQueryStrValue(serverRelativeUrl)}')`),\r\n        };\r\n    }\r\n}\r\nexport interface IFolders extends _Folders { }\r\nexport const Folders = spInvokableFactory<IFolders>(_Folders);\r\n\r\n\r\nexport class _Folder extends _SharePointQueryableInstance<IFolderInfo> {\r\n\r\n    public delete = deleteableWithETag(\"f\");\r\n\r\n    /**\r\n     * Specifies the sequence in which content types are displayed.\r\n     *\r\n     */\r\n    public get contentTypeOrder(): ISharePointQueryableCollection {\r\n        return tag.configure(SharePointQueryableCollection(this, \"contentTypeOrder\"), \"f.contentTypeOrder\");\r\n    }\r\n\r\n    /**\r\n     * Gets this folder's sub folders\r\n     *\r\n     */\r\n    public get folders(): IFolders {\r\n        return Folders(this);\r\n    }\r\n\r\n    /**\r\n     * Gets this folder's list item field values\r\n     *\r\n     */\r\n    public get listItemAllFields(): ISharePointQueryableInstance {\r\n        return tag.configure(SharePointQueryableInstance(this, \"listItemAllFields\"), \"f.listItemAllFields\");\r\n    }\r\n\r\n    /**\r\n     * Gets the parent folder, if available\r\n     *\r\n     */\r\n    public get parentFolder(): IFolder {\r\n        return tag.configure(Folder(this, \"parentFolder\"), \"f.parentFolder\");\r\n    }\r\n\r\n    /**\r\n     * Gets this folder's properties\r\n     *\r\n     */\r\n    public get properties(): ISharePointQueryableInstance {\r\n        return tag.configure(SharePointQueryableInstance(this, \"properties\"), \"f.properties\");\r\n    }\r\n\r\n    /**\r\n     * Gets this folder's server relative url\r\n     *\r\n     */\r\n    public get serverRelativeUrl(): ISharePointQueryable {\r\n        return tag.configure(SharePointQueryable(this, \"serverRelativeUrl\"), \"f.serverRelativeUrl\");\r\n    }\r\n\r\n    /**\r\n     * Gets a value that specifies the content type order.\r\n     *\r\n     */\r\n    public get uniqueContentTypeOrder(): ISharePointQueryableCollection {\r\n        return tag.configure(SharePointQueryableCollection(this, \"uniqueContentTypeOrder\"), \"f.uniqueContentTypeOrder\");\r\n    }\r\n\r\n    /**\r\n     * Updates folder's properties\r\n     * @param props Folder's properties to update\r\n     */\r\n    public update = this._update<IFolderUpdateResult, ITypedHash<any>>(\"SP.Folder\", data => ({ data, folder: <any>this }));\r\n\r\n    /**\r\n     * Moves the folder to the Recycle Bin and returns the identifier of the new Recycle Bin item.\r\n     */\r\n    @tag(\"f.recycle\")\r\n    public recycle(): Promise<string> {\r\n        return spPost(this.clone(Folder, \"recycle\"));\r\n    }\r\n\r\n    /**\r\n     * Gets the associated list item for this folder, loading the default properties\r\n     */\r\n    @tag(\"f.getItem\")\r\n    public async getItem<T>(...selects: string[]): Promise<IItem & T> {\r\n        const q = await this.listItemAllFields.select(...selects)();\r\n        return assign(Item(odataUrlFrom(q)), q);\r\n    }\r\n\r\n    /**\r\n     * Moves a folder to destination path\r\n     *\r\n     * @param destUrl Absolute or relative URL of the destination path\r\n     */\r\n    @tag(\"f.moveTo\")\r\n    public async moveTo(destUrl: string): Promise<void> {\r\n\r\n        const urlInfo = await this.getParentInfos();\r\n\r\n        const uri = new URL(urlInfo.ParentWeb.Url);\r\n\r\n        await spPost(Folder(uri.origin, \"/_api/SP.MoveCopyUtil.MoveFolder()\"),\r\n            body({\r\n                destUrl: isUrlAbsolute(destUrl) ? destUrl : combine(uri.origin, destUrl),\r\n                srcUrl: combine(uri.origin, urlInfo.Folder.ServerRelativeUrl),\r\n            }));\r\n    }\r\n\r\n    /**\r\n     * Moves a folder by path to destination path\r\n     * Also works with different site collections.\r\n     *\r\n     * @param destUrl Absolute or relative URL of the destination path\r\n     * @param keepBoth Keep both if folder with the same name in the same location already exists?\r\n     */\r\n    @tag(\"f.moveByPath\")\r\n    public async moveByPath(destUrl: string, KeepBoth = false): Promise<void> {\r\n\r\n        const urlInfo = await this.getParentInfos();\r\n\r\n        const uri = new URL(urlInfo.ParentWeb.Url);\r\n\r\n        await spPost(Folder(uri.origin, `/_api/SP.MoveCopyUtil.MoveFolderByPath()`),\r\n            body({\r\n                destPath: toResourcePath(isUrlAbsolute(destUrl) ? destUrl : combine(uri.origin, destUrl)),\r\n                options: {\r\n                    KeepBoth,\r\n                    ResetAuthorAndCreatedOnCopy: true,\r\n                    ShouldBypassSharedLocks: true,\r\n                    __metadata: {\r\n                        type: \"SP.MoveCopyOptions\",\r\n                    },\r\n                },\r\n                srcPath: toResourcePath(combine(uri.origin, urlInfo.Folder.ServerRelativeUrl)),\r\n            }));\r\n    }\r\n\r\n    /**\r\n     * Copies a folder to destination path\r\n     *\r\n     * @param destUrl Absolute or relative URL of the destination path\r\n     */\r\n    @tag(\"f.copyTo\")\r\n    public async copyTo(destUrl: string): Promise<void> {\r\n\r\n        const urlInfo = await this.getParentInfos();\r\n\r\n        const uri = new URL(urlInfo.ParentWeb.Url);\r\n\r\n        await spPost(Folder(uri.origin, \"/_api/SP.MoveCopyUtil.CopyFolder()\"),\r\n            body({\r\n                destUrl: isUrlAbsolute(destUrl) ? destUrl : combine(uri.origin, destUrl),\r\n                srcUrl: combine(uri.origin, urlInfo.Folder.ServerRelativeUrl),\r\n            }));\r\n    }\r\n\r\n    /**\r\n     * Copies a folder by path to destination path\r\n     * Also works with different site collections.\r\n     *\r\n     * @param destUrl Absolute or relative URL of the destination path\r\n     * @param keepBoth Keep both if folder with the same name in the same location already exists?\r\n     */\r\n    @tag(\"f.copyByPath\")\r\n    public async copyByPath(destUrl: string, KeepBoth = false): Promise<void> {\r\n\r\n        const urlInfo = await this.getParentInfos();\r\n\r\n        const uri = new URL(urlInfo.ParentWeb.Url);\r\n\r\n        await spPost(Folder(uri.origin, `/_api/SP.MoveCopyUtil.CopyFolderByPath()`),\r\n            body({\r\n                destPath: toResourcePath(isUrlAbsolute(destUrl) ? destUrl : combine(uri.origin, destUrl)),\r\n                options: {\r\n                    KeepBoth: KeepBoth,\r\n                    ResetAuthorAndCreatedOnCopy: true,\r\n                    ShouldBypassSharedLocks: true,\r\n                    __metadata: {\r\n                        type: \"SP.MoveCopyOptions\",\r\n                    },\r\n                },\r\n                srcPath: toResourcePath(combine(uri.origin, urlInfo.Folder.ServerRelativeUrl)),\r\n            }));\r\n    }\r\n\r\n    /**\r\n     * Deletes the folder object with options.\r\n     * \r\n     * @param parameters Specifies the options to use when deleting a folder.\r\n     */\r\n    @tag(\"f.del-params\")\r\n    public async deleteWithParams(parameters: Partial<IFolderDeleteParams>): Promise<void> {\r\n        return spPost(this.clone(Folder, \"DeleteWithParameters\"), body({ parameters }));\r\n    }\r\n\r\n    /**\r\n     * Create the subfolder inside the current folder, as specified by the leafPath\r\n     * \r\n     * @param leafPath leafName of the new folder\r\n     */\r\n    public async addSubFolderUsingPath(leafPath: string): Promise<IFolder> {\r\n        await spPost(this.clone(Folder, \"AddSubFolderUsingPath\"), body({ leafPath: toResourcePath(leafPath) }));\r\n        return this.folders.getByName(leafPath);\r\n    }\r\n\r\n    /**\r\n     * Gets the parent information for this folder's list and web\r\n     */\r\n    public async getParentInfos(): Promise<IFolderParentInfos> {\r\n\r\n        const urlInfo: any =\r\n            await this.select(\r\n                \"ServerRelativeUrl\",\r\n                \"ListItemAllFields/ParentList/Id\",\r\n                \"ListItemAllFields/ParentList/RootFolder/UniqueId\",\r\n                \"ListItemAllFields/ParentList/RootFolder/ServerRelativeUrl\",\r\n                \"ListItemAllFields/ParentList/RootFolder/ServerRelativePath\",\r\n                \"ListItemAllFields/ParentList/ParentWeb/Id\",\r\n                \"ListItemAllFields/ParentList/ParentWeb/Url\",\r\n                \"ListItemAllFields/ParentList/ParentWeb/ServerRelativeUrl\",\r\n                \"ListItemAllFields/ParentList/ParentWeb/ServerRelativePath\",\r\n            ).expand(\r\n                \"ListItemAllFields/ParentList\",\r\n                \"ListItemAllFields/ParentList/RootFolder\",\r\n                \"ListItemAllFields/ParentList/ParentWeb\")();\r\n\r\n        return {\r\n            Folder: {\r\n                ServerRelativeUrl: urlInfo.ServerRelativeUrl,\r\n            },\r\n            ParentList: {\r\n                Id: urlInfo.ListItemAllFields.ParentList.Id,\r\n                RootFolderServerRelativePath: urlInfo.ListItemAllFields.ParentList.RootFolder.ServerRelativePath,\r\n                RootFolderServerRelativeUrl: urlInfo.ListItemAllFields.ParentList.RootFolder.ServerRelativeUrl,\r\n                RootFolderUniqueId: urlInfo.ListItemAllFields.ParentList.RootFolder.UniqueId,\r\n            },\r\n            ParentWeb: {\r\n                Id: urlInfo.ListItemAllFields.ParentList.ParentWeb.Id,\r\n                ServerRelativePath: urlInfo.ListItemAllFields.ParentList.ParentWeb.ServerRelativePath,\r\n                ServerRelativeUrl: urlInfo.ListItemAllFields.ParentList.ParentWeb.ServerRelativeUrl,\r\n                Url: urlInfo.ListItemAllFields.ParentList.ParentWeb.Url,\r\n            },\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Gets the shareable item associated with this folder\r\n     */\r\n    @tag(\"f.getShareable\")\r\n    protected async getShareable(): Promise<IItem> {\r\n        // sharing only works on the item end point, not the file one - so we create a folder instance with the item url internally\r\n        const d = await this.clone(SharePointQueryableInstance, \"listItemAllFields\", false).select(\"odata.id\")();\r\n\r\n        let shareable = Item(odataUrlFrom(d));\r\n\r\n        // we need to handle batching\r\n        if (this.hasBatch) {\r\n            shareable = shareable.inBatch(this.batch);\r\n        }\r\n\r\n        return shareable;\r\n    }\r\n}\r\nexport interface IFolder extends _Folder, IDeleteableWithETag { }\r\nexport const Folder = spInvokableFactory<IFolder>(_Folder);\r\n\r\n/**\r\n * Describes result of adding a folder\r\n */\r\nexport interface IFolderAddResult {\r\n\r\n    /**\r\n     * A folder's instance\r\n     */\r\n    folder: IFolder;\r\n\r\n    /**\r\n     * Additional data from the server \r\n     */\r\n    data: any;\r\n}\r\n\r\n/**\r\n * Describes result of updating a folder\r\n */\r\nexport interface IFolderUpdateResult {\r\n\r\n    /**\r\n     * A folder's instance\r\n     */\r\n    folder: IFolder;\r\n\r\n    /**\r\n     * Additional data from the server \r\n     */\r\n    data: any;\r\n}\r\n\r\nexport interface IFolderInfo {\r\n    readonly \"odata.id\": string;\r\n    Exists: boolean;\r\n    IsWOPIEnabled: boolean;\r\n    ItemCount: number;\r\n    Name: string;\r\n    ProgID: string | null;\r\n    ServerRelativeUrl: string;\r\n    ServerRelativePath: IResourcePath;\r\n    TimeCreated: string;\r\n    TimeLastModified: string;\r\n    UniqueId: string;\r\n    WelcomePage: string;\r\n}\r\n\r\nexport interface IFolderDeleteParams {\r\n\r\n\r\n    /**\r\n     * If true, delete or recycle a folder iff all files have\r\n     * LockType values SPLockType.Shared or SPLockType.None.\r\n     * When false, delete or recycle the folder if all files\r\n     * have  the LockType value SPLockType.None. See the <see cref=\"SPFile.SPLockType\"/> enum.\r\n     */\r\n    BypassSharedLock: boolean;\r\n\r\n    /**\r\n     * Gets or sets a string value that allows SPFolder delete\r\n     * and recycle methods to target a folder with a matching value\r\n     */\r\n    ETagMatch: string;\r\n\r\n    /**\r\n     * Gets or sets a Boolean that controls the way in which folders\r\n     * are deleted. If set to true, only empty folders will be deleted.\r\n     * If set to false, folders that are not empty may be deleted.\r\n     */\r\n    DeleteIfEmpty: boolean;\r\n}\r\n\r\nexport interface IFolderParentInfos {\r\n    Folder: {\r\n        ServerRelativeUrl: string;\r\n    };\r\n    ParentList: {\r\n        Id: string;\r\n        RootFolderServerRelativePath: IResourcePath;\r\n        RootFolderServerRelativeUrl: string;\r\n        RootFolderUniqueId: string;\r\n    };\r\n    ParentWeb: {\r\n        Id: string;\r\n        ServerRelativePath: IResourcePath;\r\n        ServerRelativeUrl: string;\r\n        Url: string;\r\n    };\r\n}\r\n","import { addProp, TextParser, headers, body } from \"@pnp/odata\";\r\nimport { _List, List } from \"../lists/types\";\r\nimport { Folder } from \"../folders/types\";\r\nimport { IFieldDefault } from \"./types\";\r\nimport { IResourcePath } from \"../utils/toResourcePath\";\r\nimport { combine, isArray } from \"@pnp/common\";\r\nimport { escapeQueryStrValue } from \"../utils/escapeQueryStrValue\";\r\nimport { Logger, LogLevel } from \"@pnp/logging\";\r\nimport { spPost } from \"../operations\";\r\nimport { SharePointQueryableCollection } from \"../presets/all\";\r\n\r\ndeclare module \"../lists/types\" {\r\n    interface _List {\r\n        getDefaultColumnValues(): Promise<IFieldDefault[]>;\r\n        setDefaultColumnValues(defaults: IFieldDefault[]): Promise<void>;\r\n    }\r\n    interface IList {\r\n        /**\r\n         * Gets the default column value for a given list\r\n         */\r\n        getDefaultColumnValues(): Promise<IFieldDefault[]>;\r\n\r\n        /**\r\n         * Replaces all the column defaults with the supplied values\r\n         *\r\n         * @param defaults\r\n         */\r\n        setDefaultColumnValues(defaults: IFieldDefault[]): Promise<void>;\r\n    }\r\n}\r\n\r\naddProp(_List, \"rootFolder\", Folder, \"rootFolder\");\r\n\r\n_List.prototype.getDefaultColumnValues = async function (this: _List): Promise<IFieldDefault[]> {\r\n\r\n    const pathPart: { ServerRelativePath: IResourcePath } = await this.rootFolder.select(\"ServerRelativePath\")();\r\n    const webUrl: { ParentWeb: { Url: string } } = await this.select(\"ParentWeb/Url\").expand(\"ParentWeb\")();\r\n    const path = combine(\"/\", pathPart.ServerRelativePath.DecodedUrl, \"Forms/client_LocationBasedDefaults.html\");\r\n    const baseFilePath = combine(webUrl.ParentWeb.Url, \"_api/web\", `getFileByServerRelativePath(decodedUrl='${escapeQueryStrValue(path)}')`);\r\n\r\n    // we do this because we don't want to import file if we don't have to\r\n    let xml = \"\";\r\n\r\n    try {\r\n\r\n        xml = await Folder(baseFilePath, \"$value\").usingParser(new TextParser())(headers({ \"binaryStringResponseBody\": \"true\" }));\r\n\r\n    } catch (e) {\r\n\r\n        // if this call fails we assume it is because the file is 404\r\n        if (e && e.status && e.status === 404) {\r\n\r\n            // return an empty array\r\n            return [];\r\n        }\r\n\r\n        throw e;\r\n    }\r\n\r\n    // get all the tags from the xml\r\n    const matches = xml.match(/<a.*?<\\/a>/ig);\r\n    const tags = matches === null ? [] : matches.map(t => t.trim());\r\n\r\n    // now we need to turn these tags of form into objects\r\n    // <a href=\"/sites/dev/My%20Title\"><DefaultValue FieldName=\"TextField\">Test</DefaultValue></a>\r\n\r\n    return tags.reduce((defVals, t) => {\r\n        const m = /<a href=\"(.*?)\">/ig.exec(t);\r\n        // if things worked out captures are:\r\n        // 0: whole string\r\n        // 1: ENCODED server relative path\r\n\r\n        if (m.length < 1) {\r\n            // this indicates an error somewhere, but we have no way to meaningfully recover\r\n            // perhaps the way the tags are stored has changed on the server? Check that first.\r\n            Logger.write(`Could not parse default column value from '${t}'`, LogLevel.Warning);\r\n            return null;\r\n        }\r\n\r\n        // return the parsed out values\r\n        const subMatches = t.match(/<DefaultValue.*?<\\/DefaultValue>/ig);\r\n        const subTags = subMatches === null ? [] : subMatches.map(st => st.trim());\r\n\r\n        subTags.map(st => {\r\n          const sm = /<DefaultValue FieldName=\"(.*?)\">(.*?)<\\/DefaultValue>/ig.exec(st);\r\n          // if things worked out captures are:\r\n          // 0: whole string\r\n          // 1: Field internal name\r\n          // 2: Default value as string\r\n\r\n          if (sm.length < 1) {\r\n            Logger.write(`Could not parse default column value from '${st}'`, LogLevel.Warning);\r\n          } else {\r\n            defVals.push({\r\n              name: sm[1],\r\n              path: decodeURIComponent(m[1]),\r\n              value: sm[2],\r\n            });\r\n          }\r\n        });\r\n\r\n        return defVals;\r\n\r\n      }, []).filter(v => v !== null);\r\n};\r\n\r\n_List.prototype.setDefaultColumnValues = async function (this: _List, defaults: IFieldDefault[]): Promise<void> {\r\n\r\n    // we need the field types from the list to map the values\r\n    const fieldDefs: { InternalName: string; TypeAsString: string; }[] = await SharePointQueryableCollection(this, \"fields\").select(\"InternalName\", \"TypeAsString\").filter(\"Hidden ne true\")();\r\n\r\n    // map the values into the right format and produce our xml elements\r\n    const tags: string[] = defaults.map(fieldDefault => {\r\n\r\n        const index = fieldDefs.findIndex(fd => fd.InternalName === fieldDefault.name);\r\n\r\n        if (index < 0) {\r\n            throw Error(`Field '${fieldDefault.name}' does not exist in the list. Please check the internal field name. Failed to set defaults.`);\r\n        }\r\n\r\n        const fieldDef = fieldDefs[index];\r\n        let value = \"\";\r\n\r\n        switch (fieldDef.TypeAsString) {\r\n            case \"Boolean\":\r\n            case \"Currency\":\r\n            case \"Text\":\r\n            case \"DateTime\":\r\n            case \"Number\":\r\n            case \"Choice\":\r\n            case \"User\":\r\n                if (isArray(fieldDefault.value)) {\r\n                    throw Error(`The type '${fieldDef.TypeAsString}' does not support multiple values.`);\r\n                }\r\n                value = `${fieldDefault.value}`;\r\n                break;\r\n\r\n            case \"MultiChoice\":\r\n                if (isArray(fieldDefault.value)) {\r\n                    value = (<any[]>fieldDefault.value).map(v => `${v}`).join(\";\");\r\n                } else {\r\n                    value = `${fieldDefault.value}`;\r\n                }\r\n                break;\r\n\r\n            case \"UserMulti\":\r\n                if (isArray(fieldDefault.value)) {\r\n                    value = (<any[]>fieldDefault.value).map(v => `${v}`).join(\";#\");\r\n                } else {\r\n                    value = `${fieldDefault.value}`;\r\n                }\r\n                break;\r\n\r\n            case \"Taxonomy\":\r\n            case \"TaxonomyFieldType\":\r\n                if (isArray(fieldDefault.value)) {\r\n                    throw Error(`The type '${fieldDef.TypeAsString}' does not support multiple values.`);\r\n                } else {\r\n                    value = `${(<any>fieldDefault.value).wssId};#${(<any>fieldDefault.value).termName}|${(<any>fieldDefault.value).termId}`;\r\n                }\r\n                break;\r\n\r\n            case \"TaxonomyMulti\":\r\n            case \"TaxonomyFieldTypeMulti\":\r\n                if (isArray(fieldDefault.value)) {\r\n                    value = (<{ wssId: string, termName: string, termId: string }[]>fieldDefault.value).map(v => `${v.wssId};#${v.termName}|${v.termId}`).join(\";#\");\r\n                }\r\n                value = `${(<any>fieldDefault.value).wssId};#${(<any>fieldDefault.value).termName}|${(<any>fieldDefault.value).termId}`;\r\n                break;\r\n        }\r\n\r\n        return `<a href=\"${fieldDefault.path.replace(/ /gi, \"%20\")}\"><DefaultValue FieldName=\"${fieldDefault.name}\">${value}</DefaultValue></a>`;\r\n    });\r\n\r\n    const xml = `<MetadataDefaults>${tags.join(\"\")}</MetadataDefaults>`;\r\n    const pathPart: { ServerRelativePath: IResourcePath } = await this.rootFolder.select(\"ServerRelativePath\")();\r\n    const webUrl: { ParentWeb: { Url: string } } = await this.select(\"ParentWeb/Url\").expand(\"ParentWeb\")();\r\n    const path = combine(\"/\", pathPart.ServerRelativePath.DecodedUrl, \"Forms\");\r\n    const baseFilePath = combine(webUrl.ParentWeb.Url, \"_api/web\", `getFolderByServerRelativePath(decodedUrl='${escapeQueryStrValue(path)}')`, \"files\");\r\n\r\n    await spPost(Folder(baseFilePath, `add(overwrite=true,url='client_LocationBasedDefaults.html')`), { body: xml });\r\n\r\n    // finally we need to ensure this list has the right event receiver added\r\n    const existingReceivers = await this.eventReceivers.filter(\"ReceiverName eq 'LocationBasedMetadataDefaultsReceiver ItemAdded'\").select(\"ReceiverId\")();\r\n\r\n    if (existingReceivers.length < 1) {\r\n        await spPost(List(this.eventReceivers, \"add\"), body({\r\n            eventReceiverCreationInformation: {\r\n                EventType: 10001,\r\n                ReceiverAssembly: \"Microsoft.Office.DocumentManagement, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c\",\r\n                ReceiverClass: \"Microsoft.Office.DocumentManagement.LocationBasedMetadataDefaultsReceiver\",\r\n                ReceiverName: \"LocationBasedMetadataDefaultsReceiver ItemAdded\",\r\n                SequenceNumber: 1000,\r\n                Synchronization: 1,\r\n            },\r\n        }));\r\n    }\r\n};\r\n","import { _SharePointQueryableInstance, _SharePointQueryableCollection } from \"../sharepointqueryable\";\r\nimport { odataUrlFrom } from \"../odata\";\r\nimport { extractWebUrl } from \"../utils/extractweburl\";\r\nimport { IResourcePath } from \"../utils/toResourcePath\";\r\nimport { Web } from \"../webs/types\";\r\nimport \"../lists/web\";\r\nimport { _Folder, Folder } from \"../folders/types\";\r\nimport { IFieldDefault, IFieldDefaultProps } from \"./types\";\r\n\r\ndeclare module \"../folders/types\" {\r\n    interface _Folder {\r\n        getDefaultColumnValues(): Promise<IFieldDefault[]>;\r\n        setDefaultColumnValues(defaults: IFieldDefaultProps[], merge?: boolean): Promise<void>;\r\n        clearDefaultColumnValues(): Promise<void>;\r\n    }\r\n    interface IFolder {\r\n        /**\r\n         * Gets the default column value for a given list\r\n         */\r\n        getDefaultColumnValues(): Promise<IFieldDefault[]>;\r\n        /**\r\n         * \r\n         * Sets the default column values for this folder\r\n         * \r\n         * @param fieldDefaults The values to set including field name and appropriate value\r\n         * @param merge If true (default) existing values will be updated and new values added, otherwise all defaults are replaced for this folder\r\n         */\r\n        setDefaultColumnValues(defaults: IFieldDefaultProps[], merge?: boolean): Promise<void>;\r\n        /**\r\n         * Clears all defaults from this folder\r\n         */\r\n        clearDefaultColumnValues(): Promise<void>;\r\n    }\r\n}\r\n\r\n_Folder.prototype.getDefaultColumnValues = async function (this: _Folder): Promise<IFieldDefault[]> {\r\n\r\n    const folderProps = await Folder(this, \"Properties\").select(\"vti_x005f_listname\")<{ vti_x005f_listname: string; }>();\r\n    const { ServerRelativePath: serRelPath } = await this.select(\"ServerRelativePath\")<{ ServerRelativePath: IResourcePath }>();\r\n\r\n    const web = Web(extractWebUrl(odataUrlFrom(folderProps)));\r\n    const docLib = web.lists.getById(folderProps.vti_x005f_listname);\r\n\r\n    // and we return the defaults associated with this folder's server relative path only\r\n    // if you want all the defaults use list.getDefaultColumnValues()\r\n    return (await docLib.getDefaultColumnValues()).filter(v => v.path.toLowerCase() === serRelPath.DecodedUrl.toLowerCase());\r\n};\r\n\r\n_Folder.prototype.setDefaultColumnValues = async function (fieldDefaults: IFieldDefaultProps[], merge = true): Promise<void> {\r\n\r\n    // we start by figuring out where we are\r\n    const folderProps = await Folder(this, \"Properties\").select(\"vti_x005f_listname\")<{ vti_x005f_listname: string; }>();\r\n\r\n    // now we create a web, list and batch to get some info we need\r\n    const web = Web(extractWebUrl(odataUrlFrom(folderProps)));\r\n    const docLib = web.lists.getById(folderProps.vti_x005f_listname);\r\n\r\n    // we need the proper folder path\r\n    const folderPath = (await this.select(\"ServerRelativePath\")()).ServerRelativePath.DecodedUrl;\r\n\r\n    // at this point we should have all the defaults to update\r\n    // and we need to get all the defaults to update the entire doc\r\n    const existingDefaults = await docLib.getDefaultColumnValues();\r\n\r\n    // we filter all defaults to remove any associated with this folder if merge is false\r\n    const filteredExistingDefaults = merge ? existingDefaults : existingDefaults.filter(f => f.path !== folderPath);\r\n\r\n    // we update / add any new defaults from those passed to this method\r\n    fieldDefaults.forEach(d => {\r\n\r\n        const existing = filteredExistingDefaults.find(ed => ed.name === d.name && ed.path === folderPath);\r\n\r\n        if (existing) {\r\n            existing.value = d.value;\r\n        } else {\r\n            filteredExistingDefaults.push({\r\n                name: d.name,\r\n                path: folderPath,\r\n                value: d.value,\r\n            });\r\n        }\r\n    });\r\n\r\n    // after this operation filteredExistingDefaults should contain all the value we want to write to the file\r\n    await docLib.setDefaultColumnValues(filteredExistingDefaults);\r\n};\r\n\r\n_Folder.prototype.clearDefaultColumnValues = async function (this: _Folder): Promise<void> {\r\n    await this.setDefaultColumnValues([], false);\r\n};\r\n","import { ITypedHash } from \"@pnp/common\";\r\nimport { body } from \"@pnp/odata\";\r\nimport {\r\n    SharePointQueryableCollection,\r\n    _SharePointQueryableInstance,\r\n    ISharePointQueryableCollection,\r\n    _SharePointQueryableCollection,\r\n    spInvokableFactory,\r\n    deleteable,\r\n    IDeleteable,\r\n} from \"../sharepointqueryable\";\r\nimport { defaultPath } from \"../decorators\";\r\nimport { metadata } from \"../utils/metadata\";\r\nimport { spPost } from \"../operations\";\r\nimport { tag } from \"../telemetry\";\r\n\r\n@defaultPath(\"contenttypes\")\r\nexport class _ContentTypes extends _SharePointQueryableCollection<IContentTypeInfo[]> {\r\n\r\n    /**\r\n     * Adds an existing contenttype to a content type collection\r\n     *\r\n     * @param contentTypeId in the following format, for example: 0x010102\r\n     */\r\n    @tag(\"cts.addAvailableContentType\")\r\n    public async addAvailableContentType(contentTypeId: string): Promise<IContentTypeAddResult> {\r\n\r\n        const data = await spPost(this.clone(ContentTypes, \"addAvailableContentType\"), body({ \"contentTypeId\": contentTypeId }));\r\n        return {\r\n            contentType: this.getById(data.id),\r\n            data: data,\r\n        };\r\n    }\r\n\r\n    /**\t\r\n     * Gets a ContentType by content type id\r\n     * @param id The id of the content type to get, in the following format, for example: 0x010102\t\r\n     */\r\n    public getById(id: string): IContentType {\r\n        return tag.configure(ContentType(this).concat(`('${id}')`), \"cts.getById\");\r\n    }\r\n\r\n    /**\r\n     * Adds a new content type to the collection\r\n     *\r\n     * @param id The desired content type id for the new content type (also determines the parent content type)\r\n     * @param name The name of the content type\r\n     * @param description The description of the content type\r\n     * @param group The group in which to add the content type\r\n     * @param additionalSettings Any additional settings to provide when creating the content type\r\n     *\r\n     */\r\n    @tag(\"cts.add\")\r\n    public async add(\r\n        id: string,\r\n        name: string,\r\n        description = \"\",\r\n        group = \"Custom Content Types\",\r\n        additionalSettings: ITypedHash<string | number | boolean> = {}): Promise<IContentTypeAddResult> {\r\n\r\n        const postBody = body(Object.assign(metadata(\"SP.ContentType\"), {\r\n            \"Description\": description,\r\n            \"Group\": group,\r\n            \"Id\": { \"StringValue\": id },\r\n            \"Name\": name,\r\n        }, additionalSettings));\r\n\r\n        const data = await spPost(this, postBody);\r\n\r\n        return { contentType: this.getById(data.id), data };\r\n    }\r\n}\r\nexport interface IContentTypes extends _ContentTypes { }\r\nexport const ContentTypes = spInvokableFactory<IContentTypes>(_ContentTypes);\r\n\r\n\r\nexport class _ContentType extends _SharePointQueryableInstance<IContentTypeInfo> {\r\n\r\n    public delete = deleteable(\"ct\");\r\n\r\n    /**\r\n     * Gets the column (also known as field) references in the content type.\r\n     */\r\n    public get fieldLinks(): IFieldLinks {\r\n        return tag.configure(FieldLinks(this), \"ct.fieldLinks\");\r\n    }\r\n\r\n    /**\r\n     * Gets a value that specifies the collection of fields for the content type.\r\n     */\r\n    public get fields(): ISharePointQueryableCollection {\r\n        return tag.configure(SharePointQueryableCollection(this, \"fields\"), \"ct.fields\");\r\n    }\r\n\r\n    /**\r\n     * Gets the parent content type of the content type.\r\n     */\r\n    public get parent(): IContentType {\r\n        return tag.configure(ContentType(this, \"parent\"), \"ct.parent\");\r\n    }\r\n\r\n    /**\r\n     * Gets a value that specifies the collection of workflow associations for the content type.\r\n     */\r\n    public get workflowAssociations(): ISharePointQueryableCollection {\r\n        return tag.configure(SharePointQueryableCollection(this, \"workflowAssociations\"), \"ct.workflowAssociations\");\r\n    }\r\n}\r\nexport interface IContentType extends _ContentType, IDeleteable { }\r\nexport const ContentType = spInvokableFactory<IContentType>(_ContentType);\r\n\r\n/**\r\n * Represents the output of adding a content type\r\n */\r\nexport interface IContentTypeAddResult {\r\n    contentType: IContentType;\r\n    data: Partial<IContentTypeInfo>;\r\n}\r\n\r\nexport interface IContentTypeInfo {\r\n    Description: string;\r\n    DisplayFormTemplateName: string;\r\n    DisplayFormUrl: string;\r\n    DocumentTemplate: string;\r\n    DocumentTemplateUrl: string;\r\n    EditFormTemplateName: string;\r\n    EditFormUrl: string;\r\n    Group: string;\r\n    Hidden: boolean;\r\n    Id: { StringValue: string; };\r\n    JSLink: string;\r\n    MobileDisplayFormUrl: string;\r\n    MobileEditFormUrl: string;\r\n    MobileNewFormUrl: string;\r\n    Name: string;\r\n    NewFormTemplateName: string;\r\n    NewFormUrl: string;\r\n    ReadOnly: boolean;\r\n    SchemaXml: string;\r\n    Scope: string;\r\n    Sealed: boolean;\r\n    StringId: string;\r\n}\r\n\r\n@defaultPath(\"fieldlinks\")\r\nexport class _FieldLinks extends _SharePointQueryableCollection<IFieldLinkInfo[]> {\r\n\r\n    /**\r\n    *  Gets a FieldLink by GUID id\t\r\n    * \r\n    * @param id The GUID id of the field link\r\n    */\r\n    public getById(id: string): IFieldLink {\r\n        return tag.configure(FieldLink(this).concat(`(guid'${id}')`), \"fls.getById\");\r\n    }\r\n}\r\nexport interface IFieldLinks extends _FieldLinks { }\r\nexport const FieldLinks = spInvokableFactory<IFieldLinks>(_FieldLinks);\r\n\r\nexport class _FieldLink extends _SharePointQueryableInstance<IFieldLinkInfo> { }\r\nexport interface IFieldLink extends _FieldLink { }\r\nexport const FieldLink = spInvokableFactory<IFieldLink>(_FieldLink);\r\n\r\nexport interface IFieldLinkInfo {\r\n    FieldInternalName: string | null;\r\n    Hidden: boolean;\r\n    Id: string;\r\n    Name: string;\r\n    Required: boolean;\r\n}\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _Web } from \"../webs/types\";\r\nimport { ContentTypes, IContentTypes } from \"./types\";\r\n\r\ndeclare module \"../webs/types\" {\r\n    interface _Web {\r\n        readonly contentTypes: IContentTypes;\r\n    }\r\n    interface IWeb {\r\n        /**\r\n         * Content types contained in this web\r\n         */\r\n        readonly contentTypes: IContentTypes;\r\n    }\r\n}\r\n\r\naddProp(_Web, \"contentTypes\", ContentTypes);\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _Item } from \"../items/types\";\r\nimport { ContentType, IContentType } from \"./types\";\r\n\r\ndeclare module \"../items/types\" {\r\n    interface _Item {\r\n        readonly contentType: IContentType;\r\n    }\r\n    interface IItem {\r\n        /**\r\n         * The content type of this item\r\n         */\r\n        readonly contentType: IContentType;\r\n    }\r\n}\r\n\r\naddProp(_Item, \"contentType\", ContentType, \"ContentType\");\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _List } from \"../lists/types\";\r\nimport { ContentTypes, IContentTypes } from \"./types\";\r\n\r\ndeclare module \"../lists/types\" {\r\n    interface _List {\r\n        readonly contentTypes: IContentTypes;\r\n    }\r\n    interface IList {\r\n        /**\r\n         * Content types available on this list\r\n         */\r\n        readonly contentTypes: IContentTypes;\r\n    }\r\n}\r\n\r\naddProp(_List, \"contentTypes\", ContentTypes);\r\n","import { body } from \"@pnp/odata\";\r\nimport {\r\n    _SharePointQueryableInstance,\r\n    _SharePointQueryableCollection,\r\n    spInvokableFactory,\r\n} from \"../sharepointqueryable\";\r\nimport { defaultPath } from \"../decorators\";\r\nimport { spPost } from \"../operations\";\r\nimport { SPBatch } from \"../batch\";\r\nimport { tag } from \"../telemetry\";\r\n\r\n@defaultPath(\"features\")\r\nexport class _Features extends _SharePointQueryableCollection<IFeatureInfo[]> {\r\n\r\n    /**\r\n     * Adds (activates) the specified feature\r\n     *\r\n     * @param id The Id of the feature (GUID)\r\n     * @param force If true the feature activation will be forced\r\n     */\r\n    @tag(\"fes.add\")\r\n    public async add(id: string, force = false): Promise<IFeatureAddResult> {\r\n\r\n        const data = await spPost(this.clone(Features, \"add\"), body({\r\n            featdefScope: 0,\r\n            featureId: id,\r\n            force: force,\r\n        }));\r\n\r\n        return {\r\n            data: data,\r\n            feature: this.getById(id),\r\n        };\r\n    }\r\n\r\n    /**\t    \r\n     * Gets a feature from the collection with the specified guid\r\n     *\t    \r\n     * @param id The Id of the feature (GUID)\t    \r\n     */\r\n    public getById(id: string): IFeature {\r\n        const feature = Feature(this);\r\n        feature.concat(`('${id}')`);\r\n        return tag.configure(feature, \"fes.getById\");\r\n    }\r\n\r\n    /**\r\n     * Removes (deactivates) a feature from the collection\r\n     *\r\n     * @param id The Id of the feature (GUID)\r\n     * @param force If true the feature deactivation will be forced\r\n     */\r\n    @tag(\"fes.remove\")\r\n    public remove(id: string, force = false): Promise<any> {\r\n\r\n        return spPost(this.clone(Features, \"remove\"), body({\r\n            featureId: id,\r\n            force: force,\r\n        }));\r\n    }\r\n}\r\nexport interface IFeatures extends _Features {}\r\nexport const Features = spInvokableFactory<IFeatures>(_Features);\r\n\r\nexport class _Feature extends _SharePointQueryableInstance<IFeatureInfo> {\r\n\r\n    /**\r\n     * Removes (deactivates) the feature\r\n     *\r\n     * @param force If true the feature deactivation will be forced\r\n     */\r\n    @tag(\"fe.deactivate\")\r\n    public async deactivate(force = false): Promise<any> {\r\n\r\n        const removeDependency = this.addBatchDependency();\r\n\r\n        const feature = await Feature(this).select(\"DefinitionId\")<{ DefinitionId: string; }>();\r\n\r\n        const promise = this.getParent<IFeatures>(Features, this.parentUrl, \"\", <SPBatch>this.batch).remove(feature.DefinitionId, force);\r\n\r\n        removeDependency();\r\n\r\n        return promise;\r\n    }\r\n}\r\nexport interface IFeature extends _Feature {}\r\nexport const Feature = spInvokableFactory<IFeature>(_Feature);\r\n\r\n/**\r\n * Result from adding (activating) a feature to the collection\r\n */\r\nexport interface IFeatureAddResult {\r\n    data: IFeatureInfo;\r\n    feature: IFeature;\r\n}\r\n\r\nexport interface IFeatureInfo {\r\n    DefinitionId: string;\r\n}\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _Site } from \"../sites/types\";\r\nimport { Features, IFeatures } from \"./types\";\r\n\r\ndeclare module \"../sites/types\" {\r\n    interface _Site {\r\n        readonly features: IFeatures;\r\n    }\r\n    interface ISite {\r\n        /**\r\n         * Access the features activated in this site\r\n         */\r\n        readonly features: IFeatures;\r\n    }\r\n}\r\n\r\naddProp(_Site, \"features\", Features);\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _Web } from \"../webs/types\";\r\nimport { Features, IFeatures } from \"./types\";\r\n\r\ndeclare module \"../webs/types\" {\r\n    interface _Web {\r\n        readonly features: IFeatures;\r\n    }\r\n    interface IWeb {\r\n        /**\r\n         * Access the features activated in this web\r\n         */\r\n        readonly features: IFeatures;\r\n    }\r\n}\r\n\r\naddProp(_Web, \"features\", Features);\r\n","import {\r\n  _SharePointQueryableInstance,\r\n  _SharePointQueryableCollection,\r\n  spInvokableFactory,\r\n  deleteable,\r\n  IDeleteable,\r\n} from \"../sharepointqueryable\";\r\nimport { assign, ITypedHash } from \"@pnp/common\";\r\nimport { metadata } from \"../utils/metadata\";\r\nimport { body, headers } from \"@pnp/odata\";\r\nimport { defaultPath } from \"../decorators\";\r\nimport { spPost } from \"../operations\";\r\nimport { tag } from \"../telemetry\";\r\n\r\n@defaultPath(\"fields\")\r\nexport class _Fields extends _SharePointQueryableCollection<IFieldInfo[]> {\r\n\r\n  /**\r\n   * Gets a field from the collection by id\r\n   *\r\n   * @param id The Id of the list\r\n   */\r\n  public getById(id: string): IField {\r\n    return tag.configure(Field(this).concat(`('${id}')`), \"fs.getById\");\r\n  }\r\n\r\n  /**\r\n   * Gets a field from the collection by title\r\n   *\r\n   * @param title The case-sensitive title of the field\r\n   */\r\n  public getByTitle(title: string): IField {\r\n    return tag.configure(Field(this, `getByTitle('${title}')`), \"fs.getByTitle\");\r\n  }\r\n\r\n  /**\r\n   * Gets a field from the collection by using internal name or title\r\n   *\r\n   * @param name The case-sensitive internal name or title of the field\r\n   */\r\n  public getByInternalNameOrTitle(name: string): IField {\r\n    return tag.configure(Field(this, `getByInternalNameOrTitle('${name}')`), \"fs.getByInternalNameOrTitle\");\r\n  }\r\n\r\n  /**\r\n   * Creates a field based on the specified schema\r\n   *\r\n   * @param xml A string or XmlSchemaFieldCreationInformation instance descrbing the field to create\r\n   */\r\n  @tag(\"fs.createFieldAsXml\")\r\n  public async createFieldAsXml(xml: string | IXmlSchemaFieldCreationInformation): Promise<IFieldAddResult> {\r\n\r\n    if (typeof xml === \"string\") {\r\n      xml = { SchemaXml: xml };\r\n    }\r\n\r\n    const postBody = body({\r\n      \"parameters\":\r\n        assign(metadata(\"SP.XmlSchemaFieldCreationInformation\"), xml),\r\n    });\r\n\r\n    const data = await spPost<{ Id: string; }>(this.clone(Fields, \"createfieldasxml\"), postBody);\r\n\r\n    return {\r\n      data,\r\n      field: this.getById(data.Id),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Adds a new field to the collection\r\n   *\r\n   * @param title The new field's title\r\n   * @param fieldType The new field's type (ex: SP.FieldText)\r\n   * @param properties Differ by type of field being created (see: https://msdn.microsoft.com/en-us/library/office/dn600182.aspx)\r\n   */\r\n  public async add(title: string, fieldType: string, properties: IFieldCreationProperties & { FieldTypeKind: number }): Promise<IFieldAddResult> {\r\n\r\n    const postBody = body(Object.assign(metadata(fieldType), {\r\n      \"Title\": title,\r\n    }, properties));\r\n\r\n    if (!tag.isTagged(this)) {\r\n      tag.configure(this, \"fs.add\");\r\n    }\r\n\r\n    const data = await spPost<{ Id: string; }>(this.clone(Fields, null), postBody);\r\n\r\n    return {\r\n      data,\r\n      field: this.getById(data.Id),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Adds a new SP.FieldText to the collection\r\n   *\r\n   * @param title The field title\r\n   * @param maxLength The maximum number of characters allowed in the value of the field.\r\n   * @param properties Differ by type of field being created (see: https://msdn.microsoft.com/en-us/library/office/dn600182.aspx)\r\n   */\r\n  @tag(\"fs.addText\")\r\n  public addText(title: string, maxLength = 255, properties?: IFieldCreationProperties): Promise<IFieldAddResult> {\r\n\r\n    const props: { FieldTypeKind: number, MaxLength: number } = {\r\n      FieldTypeKind: 2,\r\n      MaxLength: maxLength,\r\n    };\r\n\r\n    return this.add(title, \"SP.FieldText\", assign(props, properties));\r\n  }\r\n\r\n  /**\r\n   * Adds a new SP.FieldCalculated to the collection\r\n   *\r\n   * @param title The field title.\r\n   * @param formula The formula for the field.\r\n   * @param dateFormat The date and time format that is displayed in the field.\r\n   * @param outputType Specifies the output format for the field. Represents a FieldType value.\r\n   * @param properties Differ by type of field being created (see: https://msdn.microsoft.com/en-us/library/office/dn600182.aspx)\r\n   */\r\n  @tag(\"fs.addCalculated\")\r\n  public addCalculated(\r\n    title: string,\r\n    formula: string,\r\n    dateFormat: DateTimeFieldFormatType,\r\n    outputType: FieldTypes = FieldTypes.Text,\r\n    properties?: IFieldCreationProperties): Promise<IFieldAddResult> {\r\n\r\n    const props: {\r\n      DateFormat: DateTimeFieldFormatType;\r\n      FieldTypeKind: number;\r\n      Formula: string;\r\n      OutputType: FieldTypes;\r\n    } = {\r\n      DateFormat: dateFormat,\r\n      FieldTypeKind: 17,\r\n      Formula: formula,\r\n      OutputType: outputType,\r\n    };\r\n\r\n    return this.add(title, \"SP.FieldCalculated\", assign(props, properties));\r\n  }\r\n\r\n  /**\r\n   * Adds a new SP.FieldDateTime to the collection\r\n   *\r\n   * @param title The field title\r\n   * @param displayFormat The format of the date and time that is displayed in the field.\r\n   * @param calendarType Specifies the calendar type of the field.\r\n   * @param friendlyDisplayFormat The type of friendly display format that is used in the field.\r\n   * @param properties Differ by type of field being created (see: https://msdn.microsoft.com/en-us/library/office/dn600182.aspx)\r\n   */\r\n  @tag(\"fs.addDateTime\")\r\n  public addDateTime(\r\n    title: string,\r\n    displayFormat: DateTimeFieldFormatType = DateTimeFieldFormatType.DateOnly,\r\n    calendarType: CalendarType = CalendarType.Gregorian,\r\n    friendlyDisplayFormat: DateTimeFieldFriendlyFormatType = DateTimeFieldFriendlyFormatType.Unspecified,\r\n    properties?: IFieldCreationProperties): Promise<IFieldAddResult> {\r\n\r\n    const props = {\r\n      DateTimeCalendarType: calendarType,\r\n      DisplayFormat: displayFormat,\r\n      FieldTypeKind: 4,\r\n      FriendlyDisplayFormat: friendlyDisplayFormat,\r\n    };\r\n\r\n    return this.add(title, \"SP.FieldDateTime\", assign(props, properties));\r\n  }\r\n\r\n  /**\r\n   * Adds a new SP.FieldNumber to the collection\r\n   *\r\n   * @param title The field title\r\n   * @param minValue The field's minimum value\r\n   * @param maxValue The field's maximum value\r\n   * @param properties Differ by type of field being created (see: https://msdn.microsoft.com/en-us/library/office/dn600182.aspx)\r\n   */\r\n  @tag(\"fs.addNumber\")\r\n  public addNumber(\r\n    title: string,\r\n    minValue?: number,\r\n    maxValue?: number,\r\n    properties?: IFieldCreationProperties): Promise<IFieldAddResult> {\r\n\r\n    let props: { FieldTypeKind: number } = { FieldTypeKind: 9 };\r\n\r\n    if (minValue !== undefined) {\r\n      props = assign({ MinimumValue: minValue }, props);\r\n    }\r\n\r\n    if (maxValue !== undefined) {\r\n      props = assign({ MaximumValue: maxValue }, props);\r\n    }\r\n\r\n    return this.add(title, \"SP.FieldNumber\", assign(props, properties));\r\n  }\r\n\r\n  /**\r\n   * Adds a new SP.FieldCurrency to the collection\r\n   *\r\n   * @param title The field title\r\n   * @param minValue The field's minimum value\r\n   * @param maxValue The field's maximum value\r\n   * @param currencyLocalId Specifies the language code identifier (LCID) used to format the value of the field\r\n   * @param properties Differ by type of field being created (see: https://msdn.microsoft.com/en-us/library/office/dn600182.aspx)\r\n   */\r\n  @tag(\"fs.addCurrency\")\r\n  public addCurrency(\r\n    title: string,\r\n    minValue?: number,\r\n    maxValue?: number,\r\n    currencyLocalId = 1033,\r\n    properties?: IFieldCreationProperties): Promise<IFieldAddResult> {\r\n\r\n    let props: { CurrencyLocaleId: number; FieldTypeKind: number; } = {\r\n      CurrencyLocaleId: currencyLocalId,\r\n      FieldTypeKind: 10,\r\n    };\r\n\r\n    if (minValue !== undefined) {\r\n      props = assign({ MinimumValue: minValue }, props);\r\n    }\r\n\r\n    if (maxValue !== undefined) {\r\n      props = assign({ MaximumValue: maxValue }, props);\r\n    }\r\n\r\n    return this.add(title, \"SP.FieldCurrency\", assign(props, properties));\r\n  }\r\n\r\n  /**\r\n   * Adds a new SP.FieldMultiLineText to the collection\r\n   *\r\n   * @param title The field title\r\n   * @param numberOfLines Specifies the number of lines of text to display for the field.\r\n   * @param richText Specifies whether the field supports rich formatting.\r\n   * @param restrictedMode Specifies whether the field supports a subset of rich formatting.\r\n   * @param appendOnly Specifies whether all changes to the value of the field are displayed in list forms.\r\n   * @param allowHyperlink Specifies whether a hyperlink is allowed as a value of the field.\r\n   * @param properties Differ by type of field being created (see: https://msdn.microsoft.com/en-us/library/office/dn600182.aspx)\r\n   *\r\n   */\r\n  @tag(\"fs.addMultilineText\")\r\n  public addMultilineText(\r\n    title: string,\r\n    numberOfLines = 6,\r\n    richText = true,\r\n    restrictedMode = false,\r\n    appendOnly = false,\r\n    allowHyperlink = true,\r\n    properties?: IFieldCreationProperties): Promise<IFieldAddResult> {\r\n\r\n    const props = {\r\n      AllowHyperlink: allowHyperlink,\r\n      AppendOnly: appendOnly,\r\n      FieldTypeKind: 3,\r\n      NumberOfLines: numberOfLines,\r\n      RestrictedMode: restrictedMode,\r\n      RichText: richText,\r\n    };\r\n\r\n    return this.add(title, \"SP.FieldMultiLineText\", assign(props, properties));\r\n  }\r\n\r\n  /**\r\n   * Adds a new SP.FieldUrl to the collection\r\n   *\r\n   * @param title The field title\r\n   */\r\n  @tag(\"fs.addUrl\")\r\n  public addUrl(title: string, displayFormat: UrlFieldFormatType = UrlFieldFormatType.Hyperlink, properties?: IFieldCreationProperties): Promise<IFieldAddResult> {\r\n\r\n    const props = {\r\n      DisplayFormat: displayFormat,\r\n      FieldTypeKind: 11,\r\n    };\r\n\r\n    return this.add(title, \"SP.FieldUrl\", assign(props, properties));\r\n  }\r\n\r\n  /** Adds a user field to the colleciton\r\n  *\r\n  * @param title The new field's title\r\n  * @param selectionMode The selection mode of the field\r\n  * @param selectionGroup Value that specifies the identifier of the SharePoint group whose members can be selected as values of the field\r\n  * @param properties\r\n  */\r\n  @tag(\"fs.addUser\")\r\n  public addUser(title: string, selectionMode: FieldUserSelectionMode, properties?: IFieldCreationProperties): Promise<IFieldAddResult> {\r\n\r\n    const props = {\r\n      FieldTypeKind: 20,\r\n      SelectionMode: selectionMode,\r\n    };\r\n\r\n    return this.add(title, \"SP.FieldUser\", assign(props, properties));\r\n  }\r\n\r\n  /**\r\n   * Adds a SP.FieldLookup to the collection\r\n   *\r\n   * @param title The new field's title\r\n   * @param lookupListId The guid id of the list where the source of the lookup is found\r\n   * @param lookupFieldName The internal name of the field in the source list\r\n   * @param properties Set of additional properties to set on the new field\r\n   */\r\n  @tag(\"fs.addLookup\")\r\n  public async addLookup(\r\n    title: string,\r\n    lookupListId: string,\r\n    lookupFieldName: string,\r\n    properties?: IFieldCreationProperties): Promise<IFieldAddResult> {\r\n\r\n    const props = assign({\r\n      FieldTypeKind: 7,\r\n      LookupFieldName: lookupFieldName,\r\n      LookupListId: lookupListId,\r\n      Title: title,\r\n    }, properties);\r\n\r\n    const postBody = body({\r\n      \"parameters\":\r\n        assign(metadata(\"SP.FieldCreationInformation\"), props),\r\n    });\r\n\r\n    const data = await spPost<{ Id: string; }>(this.clone(Fields, \"addfield\"), postBody);\r\n\r\n    return {\r\n      data,\r\n      field: this.getById(data.Id),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Adds a new SP.FieldChoice to the collection\r\n   *\r\n   * @param title The field title.\r\n   * @param choices The choices for the field.\r\n   * @param format The display format of the available options for the field.\r\n   * @param fillIn Specifies whether the field allows fill-in values.\r\n   * @param properties Differ by type of field being created (see: https://msdn.microsoft.com/en-us/library/office/dn600182.aspx)\r\n   */\r\n  @tag(\"fs.addChoice\")\r\n  public addChoice(\r\n    title: string,\r\n    choices: string[],\r\n    format: ChoiceFieldFormatType = ChoiceFieldFormatType.Dropdown,\r\n    fillIn?: boolean,\r\n    properties?: IFieldCreationProperties): Promise<IFieldAddResult> {\r\n\r\n    const props = {\r\n      Choices: {\r\n        results: choices,\r\n      },\r\n      EditFormat: format,\r\n      FieldTypeKind: 6,\r\n      FillInChoice: fillIn,\r\n    };\r\n\r\n    return this.add(title, \"SP.FieldChoice\", assign(props, properties));\r\n  }\r\n\r\n  /**\r\n   * Adds a new SP.FieldMultiChoice to the collection\r\n   *\r\n   * @param title The field title.\r\n   * @param choices The choices for the field.\r\n   * @param fillIn Specifies whether the field allows fill-in values.\r\n   * @param properties Differ by type of field being created (see: https://msdn.microsoft.com/en-us/library/office/dn600182.aspx)\r\n   */\r\n  @tag(\"fs.addMultiChoice\")\r\n  public addMultiChoice(title: string, choices: string[], fillIn?: boolean, properties?: IFieldCreationProperties): Promise<IFieldAddResult> {\r\n\r\n    const props = {\r\n      Choices: {\r\n        results: choices,\r\n      },\r\n      FieldTypeKind: 15,\r\n      FillInChoice: fillIn,\r\n    };\r\n\r\n    return this.add(title, \"SP.FieldMultiChoice\", assign(props, properties));\r\n  }\r\n\r\n  /**\r\n   * Adds a new SP.FieldBoolean to the collection\r\n   *\r\n   * @param title The field title.\r\n   * @param properties Differ by type of field being created (see: https://msdn.microsoft.com/en-us/library/office/dn600182.aspx)\r\n   */\r\n  @tag(\"fs.addBoolean\")\r\n  public addBoolean(title: string, properties?: IFieldCreationProperties): Promise<IFieldAddResult> {\r\n\r\n    const props = {\r\n      FieldTypeKind: 8,\r\n    };\r\n\r\n    return this.add(title, \"SP.Field\", assign(props, properties));\r\n  }\r\n\r\n  /**\r\n  * Creates a secondary (dependent) lookup field, based on the Id of the primary lookup field.\r\n  *\r\n  * @param displayName The display name of the new field.\r\n  * @param primaryLookupFieldId The guid of the primary Lookup Field.\r\n  * @param showField Which field to show from the lookup list.\r\n  */\r\n  @tag(\"fs.addDependentLookupField\")\r\n  public async addDependentLookupField(displayName: string, primaryLookupFieldId: string, showField: string): Promise<IFieldAddResult> {\r\n\r\n    const path = `adddependentlookupfield(displayName='${displayName}', primarylookupfieldid='${primaryLookupFieldId}', showfield='${showField}')`;\r\n\r\n    const data = await spPost(this.clone(Fields, path));\r\n\r\n    return {\r\n      data,\r\n      field: this.getById(data.Id),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Adds a new SP.FieldLocation to the collection\r\n   *\r\n   * @param title The field title.\r\n   * @param properties Differ by type of field being created (see: https://msdn.microsoft.com/en-us/library/office/dn600182.aspx)\r\n   */\r\n  @tag(\"fs.addLocation\")\r\n  public addLocation(title: string, properties?: IFieldCreationProperties): Promise<IFieldAddResult> {\r\n\r\n    const props = { FieldTypeKind: 33 };\r\n\r\n    return this.add(title, \"SP.FieldLocation\", assign(props, properties));\r\n  }\r\n}\r\nexport interface IFields extends _Fields { }\r\nexport const Fields = spInvokableFactory<IFields>(_Fields);\r\n\r\nexport class _Field extends _SharePointQueryableInstance<IFieldInfo> {\r\n\r\n  public delete = deleteable(\"f\");\r\n\r\n  /**\r\n   * Updates this field instance with the supplied properties\r\n   *\r\n   * @param properties A plain object hash of values to update for the list\r\n   * @param fieldType The type value such as SP.FieldLookup. Optional, looked up from the field if not provided\r\n   */\r\n  @tag(\"f.update\")\r\n  public async update(properties: any, fieldType?: string): Promise<IFieldUpdateResult> {\r\n\r\n    if (typeof fieldType === \"undefined\" || fieldType === null) {\r\n      const info = await Field(this).select(\"FieldTypeKind\").configure({\r\n        headers: {\r\n          \"Accept\": \"application/json\",\r\n        },\r\n      })();\r\n      fieldType = info[\"odata.type\"];\r\n    }\r\n\r\n    const req = body(assign(metadata(fieldType), properties), headers({ \"X-HTTP-Method\": \"MERGE\" }));\r\n\r\n    const data = await spPost(this, req);\r\n\r\n    return {\r\n      data,\r\n      field: <any>this,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Sets the value of the ShowInDisplayForm property for this field.\r\n   */\r\n  @tag(\"f.setShowInDisplayForm\")\r\n  public setShowInDisplayForm(show: boolean): Promise<void> {\r\n    return spPost(this.clone(Field, `setshowindisplayform(${show})`));\r\n  }\r\n\r\n  /**\r\n   * Sets the value of the ShowInEditForm property for this field.\r\n   */\r\n  @tag(\"f.setShowInEditForm\")\r\n  public setShowInEditForm(show: boolean): Promise<void> {\r\n    return spPost(this.clone(Field, `setshowineditform(${show})`));\r\n  }\r\n\r\n  /**\r\n   * Sets the value of the ShowInNewForm property for this field.\r\n   */\r\n  @tag(\"f.setShowInNewForm\")\r\n  public setShowInNewForm(show: boolean): Promise<void> {\r\n    return spPost(this.clone(Field, `setshowinnewform(${show})`));\r\n  }\r\n}\r\nexport interface IField extends _Field, IDeleteable { }\r\nexport const Field = spInvokableFactory<IField>(_Field);\r\n\r\n/**\r\n * This interface defines the result of adding a field\r\n */\r\nexport interface IFieldAddResult {\r\n  data: Partial<IFieldInfo>;\r\n  field: IField;\r\n}\r\n\r\n/**\r\n * This interface defines the result of updating a field\r\n */\r\nexport interface IFieldUpdateResult {\r\n  data: Partial<IFieldInfo>;\r\n  field: IField;\r\n}\r\n\r\n/**\r\n * Specifies the type of the field.\r\n */\r\nexport enum FieldTypes {\r\n  Invalid = 0,\r\n  Integer = 1,\r\n  Text = 2,\r\n  Note = 3,\r\n  DateTime = 4,\r\n  Counter = 5,\r\n  Choice = 6,\r\n  Lookup = 7,\r\n  Boolean = 8,\r\n  Number = 9,\r\n  Currency = 10,\r\n  URL = 11,\r\n  Computed = 12,\r\n  Threading = 13,\r\n  Guid = 14,\r\n  MultiChoice = 15,\r\n  GridChoice = 16,\r\n  Calculated = 17,\r\n  File = 18,\r\n  Attachments = 19,\r\n  User = 20,\r\n  Recurrence = 21,\r\n  CrossProjectLink = 22,\r\n  ModStat = 23,\r\n  Error = 24,\r\n  ContentTypeId = 25,\r\n  PageSeparator = 26,\r\n  ThreadIndex = 27,\r\n  WorkflowStatus = 28,\r\n  AllDayEvent = 29,\r\n  WorkflowEventType = 30,\r\n}\r\n\r\nexport enum DateTimeFieldFormatType {\r\n  DateOnly = 0,\r\n  DateTime = 1,\r\n}\r\n\r\nexport enum DateTimeFieldFriendlyFormatType {\r\n  Unspecified = 0,\r\n  Disabled = 1,\r\n  Relative = 2,\r\n}\r\n\r\n/**\r\n * Specifies the control settings while adding a field.\r\n */\r\nexport enum AddFieldOptions {\r\n  /**\r\n   *  Specify that a new field added to the list must also be added to the default content type in the site collection\r\n   */\r\n  DefaultValue = 0,\r\n  /**\r\n   * Specify that a new field added to the list must also be added to the default content type in the site collection.\r\n   */\r\n  AddToDefaultContentType = 1,\r\n  /**\r\n   * Specify that a new field must not be added to any other content type\r\n   */\r\n  AddToNoContentType = 2,\r\n  /**\r\n   *  Specify that a new field that is added to the specified list must also be added to all content types in the site collection\r\n   */\r\n  AddToAllContentTypes = 4,\r\n  /**\r\n   * Specify adding an internal field name hint for the purpose of avoiding possible database locking or field renaming operations\r\n   */\r\n  AddFieldInternalNameHint = 8,\r\n  /**\r\n   * Specify that a new field that is added to the specified list must also be added to the default list view\r\n   */\r\n  AddFieldToDefaultView = 16,\r\n  /**\r\n   * Specify to confirm that no other field has the same display name\r\n   */\r\n  AddFieldCheckDisplayName = 32,\r\n}\r\n\r\nexport interface IXmlSchemaFieldCreationInformation {\r\n  Options?: AddFieldOptions;\r\n  SchemaXml: string;\r\n}\r\n\r\nexport enum CalendarType {\r\n  Gregorian = 1,\r\n  Japan = 3,\r\n  Taiwan = 4,\r\n  Korea = 5,\r\n  Hijri = 6,\r\n  Thai = 7,\r\n  Hebrew = 8,\r\n  GregorianMEFrench = 9,\r\n  GregorianArabic = 10,\r\n  GregorianXLITEnglish = 11,\r\n  GregorianXLITFrench = 12,\r\n  KoreaJapanLunar = 14,\r\n  ChineseLunar = 15,\r\n  SakaEra = 16,\r\n  UmAlQura = 23,\r\n}\r\n\r\nexport enum UrlFieldFormatType {\r\n  Hyperlink = 0,\r\n  Image = 1,\r\n}\r\n\r\nexport enum FieldUserSelectionMode {\r\n  PeopleAndGroups = 1,\r\n  PeopleOnly = 0,\r\n}\r\n\r\nexport interface IFieldCreationProperties extends ITypedHash<string | number | boolean> {\r\n  DefaultFormula?: string;\r\n  Description?: string;\r\n  EnforceUniqueValues?: boolean;\r\n  FieldTypeKind?: number;\r\n  Group?: string;\r\n  Hidden?: boolean;\r\n  Indexed?: boolean;\r\n  Required?: boolean;\r\n  Title?: string;\r\n  ValidationFormula?: string;\r\n  ValidationMessage?: string;\r\n}\r\n\r\nexport enum ChoiceFieldFormatType {\r\n  Dropdown,\r\n  RadioButtons,\r\n}\r\n\r\nexport interface IFieldInfo {\r\n  DefaultFormula: string | null;\r\n  DefaultValue: string | null;\r\n  Description: string;\r\n  Direction: string;\r\n  EnforceUniqueValues: boolean;\r\n  EntityPropertyName: string;\r\n  FieldTypeKind: FieldTypes;\r\n  Filterable: boolean;\r\n  FromBaseType: boolean;\r\n  Group: string;\r\n  Hidden: boolean;\r\n  Id: string;\r\n  Indexed: boolean;\r\n  IndexStatus: number;\r\n  InternalName: string;\r\n  JSLink: string;\r\n  PinnedToFiltersPane: boolean;\r\n  ReadOnlyField: boolean;\r\n  Required: boolean;\r\n  SchemaXml: string;\r\n  Scope: string;\r\n  Sealed: boolean;\r\n  ShowInFiltersPane: number;\r\n  Sortable: boolean;\r\n  StaticName: string;\r\n  Title: string;\r\n  TypeAsString: string;\r\n  TypeDisplayName: string;\r\n  TypeShortDescription: string;\r\n  ValidationFormula: string | null;\r\n  ValidationMessage: string | null;\r\n}\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _Web } from \"../webs/types\";\r\nimport { Fields, IFields } from \"./types\";\r\n\r\ndeclare module \"../webs/types\" {\r\n  interface _Web {\r\n    readonly fields: IFields;\r\n    readonly availablefields: IFields;\r\n  }\r\n  interface IWeb {\r\n    /**\r\n     * This web's collection of fields\r\n     */\r\n    readonly fields: IFields;\r\n    /**\r\n     * This web's collection of available fields\r\n     */\r\n    readonly availablefields: IFields;\r\n  }\r\n}\r\n\r\naddProp(_Web, \"fields\", Fields);\r\naddProp(_Web, \"availablefields\", Fields, \"availablefields\");\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _List } from \"../lists/types\";\r\nimport { Fields, IFields } from \"./types\";\r\n\r\ndeclare module \"../lists/types\" {\r\n  interface _List {\r\n    readonly fields: IFields;\r\n  }\r\n  interface IList {\r\n    /**\r\n     * This list's collection of fields\r\n     */\r\n    readonly fields: IFields;\r\n  }\r\n}\r\n\r\naddProp(_List, \"fields\", Fields);\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _Folder } from \"../folders/types\";\r\nimport { IFiles, Files } from \"./types\";\r\n\r\ndeclare module \"../folders/types\" {\r\n    interface _Folder {\r\n        readonly files: IFiles;\r\n    }\r\n    interface IFolder {\r\n        /**\r\n         * Folder containing files\r\n         */\r\n        readonly files: IFiles;\r\n    }\r\n}\r\n\r\naddProp(_Folder, \"files\", Files);\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _Item } from \"../items/types\";\r\nimport { File, IFile } from \"./types\";\r\n\r\ndeclare module \"../items/types\" {\r\n    interface _Item {\r\n        readonly file: IFile;\r\n    }\r\n    interface IItem {\r\n        /**\r\n         * File in sharepoint site\r\n         */\r\n        readonly file: IFile;\r\n    }\r\n}\r\n\r\naddProp(_Item, \"file\", File, \"file\");\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _Item } from \"../items/types\";\r\nimport { Folder, IFolder } from \"./types\";\r\n\r\ndeclare module \"../items/types\" {\r\n    interface _Item {\r\n        readonly folder: IFolder;\r\n\r\n    }\r\n    interface IItem {\r\n        readonly folder: IFolder;\r\n\r\n    }\r\n}\r\n\r\naddProp(_Item, \"folder\", Folder, \"folder\");\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _List } from \"../lists/types\";\r\nimport { Folder, IFolder } from \"./types\";\r\n\r\ndeclare module \"../lists/types\" {\r\n    interface _List {\r\n        readonly rootFolder: IFolder;\r\n    }\r\n    interface IList {\r\n        /**\r\n         * Root folder for this list/library\r\n         */\r\n        readonly rootFolder: IFolder;\r\n    }\r\n}\r\n\r\naddProp(_List, \"rootFolder\", Folder, \"rootFolder\");\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _Web } from \"../webs/types\";\r\nimport { Folders, IFolders, Folder, IFolder } from \"./types\";\r\nimport { escapeQueryStrValue } from \"../utils/escapeQueryStrValue\";\r\n\r\ndeclare module \"../webs/types\" {\r\n    interface _Web {\r\n        readonly folders: IFolders;\r\n        readonly rootFolder: IFolder;\r\n        getFolderByServerRelativeUrl(folderRelativeUrl: string): IFolder;\r\n        getFolderByServerRelativePath(folderRelativeUrl: string): IFolder;\r\n        getFolderById(uniqueId: string): IFolder;\r\n    }\r\n    interface IWeb {\r\n\r\n        /**\r\n         * Gets the collection of folders in this web\r\n         */\r\n        readonly folders: IFolders;\r\n\r\n        /**\r\n         * Gets the root folder of the web\r\n         */\r\n        readonly rootFolder: IFolder;\r\n\r\n        /**\r\n         * Gets a folder by server relative url\r\n         *\r\n         * @param folderRelativeUrl The server relative path to the folder (including /sites/ if applicable)\r\n         */\r\n        getFolderByServerRelativeUrl(folderRelativeUrl: string): IFolder;\r\n\r\n        /**\r\n         * Gets a folder by server relative path if your folder name contains # and % characters\r\n         * This works only in SharePoint online.\r\n         *\r\n         * @param folderRelativeUrl The server relative path to the folder (including /sites/ if applicable)\r\n         */\r\n        getFolderByServerRelativePath(folderRelativeUrl: string): IFolder;\r\n\r\n        /**\r\n         * Gets a folder by id\r\n         *\r\n         * @param uniqueId The UniqueId of the folder\r\n         */\r\n        getFolderById(uniqueId: string): IFolder;\r\n    }\r\n}\r\n\r\naddProp(_Web, \"folders\", Folders);\r\naddProp(_Web, \"rootFolder\", Folder, \"rootFolder\");\r\n\r\n_Web.prototype.getFolderByServerRelativeUrl = function (this: _Web, folderRelativeUrl: string): IFolder {\r\n    return Folder(this, `getFolderByServerRelativeUrl('${escapeQueryStrValue(folderRelativeUrl)}')`);\r\n};\r\n\r\n_Web.prototype.getFolderByServerRelativePath = function (this: _Web, folderRelativeUrl: string): IFolder {\r\n    return Folder(this, `getFolderByServerRelativePath(decodedUrl='${escapeQueryStrValue(folderRelativeUrl)}')`);\r\n};\r\n\r\n_Web.prototype.getFolderById = function (this: _Web, uniqueId: string): IFolder {\r\n    return Folder(this, `getFolderById('${uniqueId}')`);\r\n};\r\n","import {\r\n    _SharePointQueryableInstance,\r\n    _SharePointQueryableCollection,\r\n    spInvokableFactory,\r\n} from \"../sharepointqueryable\";\r\nimport { defaultPath } from \"../decorators\";\r\nimport { PageType } from \"../types\";\r\nimport { tag } from \"../telemetry\";\r\n\r\n/**\r\n * Describes a collection of Form objects\r\n *\r\n */\r\n@defaultPath(\"forms\")\r\nexport class _Forms extends _SharePointQueryableCollection<IFormInfo[]> {\r\n    /**\t\r\n     * Gets a form by id\t\r\n     *\t\r\n     * @param id The guid id of the item to retrieve\t\r\n     */\r\n    public getById(id: string): IForm {\r\n        return tag.configure(Form(this).concat(`('${id}')`), \"fos.getById\");\r\n    }\r\n}\r\nexport interface IForms extends _Forms { }\r\nexport const Forms = spInvokableFactory<IForms>(_Forms);\r\n\r\n/**\r\n * Describes a single of Form instance\r\n *\r\n */\r\nexport class _Form extends _SharePointQueryableInstance<IFormInfo> { }\r\nexport interface IForm extends _Form { }\r\nexport const Form = spInvokableFactory<IForm>(_Form);\r\n\r\nexport interface IFormInfo {\r\n    FormType: PageType;\r\n    Id: string;\r\n    ResourcePath: { DecodedUrl: string; };\r\n    DecodedUrl: string;\r\n    ServerRelativeUrl: string;\r\n}\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _List } from \"../lists/types\";\r\nimport { Forms, IForms } from \"./types\";\r\n\r\ndeclare module \"../lists/types\" {\r\n    interface _List {\r\n        readonly forms: IForms;\r\n    }\r\n    interface IList {\r\n        readonly forms: IForms;\r\n    }\r\n}\r\n\r\naddProp(_List, \"forms\", Forms, \"forms\");\r\n","import {\r\n    _SharePointQueryableInstance,\r\n    _SharePointQueryableCollection,\r\n    spInvokableFactory,\r\n} from \"../sharepointqueryable\";\r\nimport { ISerializableNavigationNode } from \"../navigation/types\";\r\nimport { defaultPath } from \"../decorators\";\r\nimport { Site, ISite } from \"../sites/types\";\r\nimport { tag } from \"../telemetry\";\r\n\r\n@defaultPath(\"_api/hubsites\")\r\nexport class _HubSites extends _SharePointQueryableCollection<IHubSiteInfo[]> {\r\n\r\n    /**\t    \r\n     * Gets a Hub Site from the collection by id\t     \r\n     *\t    \r\n     * @param id The Id of the Hub Site\t    \r\n     */\r\n    public getById(id: string): IHubSite {\r\n        return tag.configure(HubSite(this, `GetById?hubSiteId='${id}'`), \"hss.getById\");\r\n\r\n    }\r\n}\r\nexport interface IHubSites extends _HubSites { }\r\nexport const HubSites = spInvokableFactory<IHubSites>(_HubSites);\r\n\r\nexport class _HubSite extends _SharePointQueryableInstance<IHubSiteInfo> {\r\n\r\n    /**\r\n     * Gets the ISite instance associated with this hubsite\r\n     */\r\n    @tag(\"hs.getSite\")\r\n    public async getSite(): Promise<ISite> {\r\n        const d = await this.select(\"SiteUrl\")();\r\n        return Site(d.SiteUrl);\r\n    }\r\n}\r\nexport interface IHubSite extends _HubSite { }\r\nexport const HubSite = spInvokableFactory<IHubSite>(_HubSite);\r\n\r\nexport interface IHubSiteInfo {\r\n    ID: string;\r\n    Title: string;\r\n    SiteId: string;\r\n    TenantInstanceId: string;\r\n    SiteUrl: string;\r\n    LogoUrl: string;\r\n    Description: string;\r\n    Targets: string;\r\n    SiteDesignId: string;\r\n    RequiresJoinApproval: boolean;\r\n    RelatedHubSiteIds: string[];\r\n    ParentHubSiteId: string;\r\n    HideNameInNavigation: boolean;\r\n    EnablePermissionsSync: boolean;\r\n}\r\n\r\nexport interface IHubSiteWebData {\r\n    headerEmphasis: string | null;\r\n    themeKey: string | null;\r\n    name: string | null;\r\n    url: string;\r\n    logoUrl: string | null;\r\n    usesMetadataNavigation: boolean;\r\n    megaMenuEnabled: boolean;\r\n    navigation: ISerializableNavigationNode[];\r\n    isNavAudienceTargeted: boolean;\r\n    siteDesignId: string;\r\n    requiresJoinApproval: boolean;\r\n    hideNameInNavigation: boolean;\r\n    parentHubSiteId: string;\r\n    relatedHubSiteIds: string | null;\r\n}\r\n","import { _Site, Site } from \"../sites/types\";\r\nimport { spPost } from \"../operations\";\r\n\r\ndeclare module \"../sites/types\" {\r\n    interface _Site {\r\n        joinHubSite(siteId: string): Promise<void>;\r\n        registerHubSite(): Promise<void>;\r\n        unRegisterHubSite(): Promise<void>;\r\n    }\r\n    interface ISite {\r\n\r\n        /**\r\n         * Associates a site collection to a hub site.\r\n         * \r\n         * @param siteId Id of the hub site collection you want to join.\r\n         * If you want to disassociate the site collection from hub site, then\r\n         * pass the siteId as 00000000-0000-0000-0000-000000000000\r\n         */\r\n        joinHubSite(siteId: string): Promise<void>;\r\n\r\n        /**\r\n         * Registers the current site collection as hub site collection\r\n         */\r\n        registerHubSite(): Promise<void>;\r\n\r\n        /**\r\n         * Unregisters the current site collection as hub site collection.\r\n         */\r\n        unRegisterHubSite(): Promise<void>;\r\n    }\r\n}\r\n\r\n_Site.prototype.joinHubSite = async function (this: _Site, siteId: string): Promise<void> {\r\n    await spPost(this.clone(Site, `joinHubSite('${siteId}')`));\r\n};\r\n\r\n_Site.prototype.registerHubSite = async function (this: _Site): Promise<void> {\r\n    await spPost(this.clone(Site, `registerHubSite`));\r\n};\r\n\r\n_Site.prototype.unRegisterHubSite = async function (this: _Site): Promise<void> {\r\n    await spPost(this.clone(Site, `unRegisterHubSite`));\r\n};\r\n","import { _Web, Web } from \"../webs/types\";\r\nimport { IHubSiteWebData } from \"./types\";\r\nimport { spPost } from \"../operations\";\r\n\r\ndeclare module \"../webs/types\" {\r\n    interface _Web {\r\n        hubSiteData(forceRefresh?: boolean): Promise<Partial<IHubSiteWebData>>;\r\n        syncHubSiteTheme(): Promise<void>;\r\n    }\r\n    interface IWeb {\r\n\r\n        /**\r\n         * Gets hub site data for the current web.\r\n         *\r\n         * @param forceRefresh Default value is false. When false, the data is returned from the server's cache.\r\n         * When true, the cache is refreshed with the latest updates and then returned.\r\n         * Use this if you just made changes and need to see those changes right away.\r\n         */\r\n        hubSiteData(forceRefresh?: boolean): Promise<Partial<IHubSiteWebData>>;\r\n\r\n        /**\r\n         * Applies theme updates from the parent hub site collection.\r\n         */\r\n        syncHubSiteTheme(): Promise<void>;\r\n    }\r\n}\r\n\r\n_Web.prototype.hubSiteData = async function (this: _Web, forceRefresh = false): Promise<IHubSiteWebData> {\r\n    const data = await this.clone(Web, `hubSiteData(${forceRefresh})`)<IHubSiteWebData>();\r\n    if (typeof data === \"string\") {\r\n        return JSON.parse(data);\r\n    }\r\n    return data;\r\n};\r\n\r\n_Web.prototype.syncHubSiteTheme = function (this: _Web): Promise<void> {\r\n    return spPost(this.clone(Web, `syncHubSiteTheme`));\r\n};\r\n","import { SPRest } from \"../rest\";\r\nimport { HubSites, IHubSites } from \"./types\";\r\n\r\nimport \"./site\";\r\nimport \"./web\";\r\n\r\nexport {\r\n    HubSite,\r\n    HubSites,\r\n    IHubSite,\r\n    IHubSiteInfo,\r\n    IHubSiteWebData,\r\n    IHubSites,\r\n} from \"./types\";\r\n\r\ndeclare module \"../rest\" {\r\n    interface SPRest {\r\n        /**\r\n         * Lists all of the subsites\r\n         */\r\n        readonly hubSites: IHubSites;\r\n    }\r\n}\r\n\r\nReflect.defineProperty(SPRest.prototype, \"hubSites\", {\r\n    configurable: true,\r\n    enumerable: true,\r\n    get: function (this: SPRest) {\r\n        return HubSites(this._baseUrl).configure(this._options);\r\n    },\r\n});\r\n","import {\r\n    _SharePointQueryableInstance,\r\n    _SharePointQueryableCollection,\r\n    _SharePointQueryable,\r\n    spInvokableFactory,\r\n    deleteable,\r\n    IDeleteable,\r\n} from \"../sharepointqueryable\";\r\nimport { assign } from \"@pnp/common\";\r\nimport { metadata } from \"../utils/metadata\";\r\nimport { body, headers } from \"@pnp/odata\";\r\nimport { defaultPath } from \"../decorators\";\r\nimport { spPost } from \"../operations\";\r\nimport { tag } from \"../telemetry\";\r\n\r\n/**\r\n * Represents a collection of navigation nodes\r\n *\r\n */\r\nexport class _NavigationNodes extends _SharePointQueryableCollection<INavNodeInfo[]> {\r\n\r\n    /**\t    \r\n     * Gets a navigation node by id\t\r\n     *\t\r\n     * @param id The id of the node\t\r\n     */\r\n    public getById(id: number): INavigationNode {\r\n        return tag.configure(NavigationNode(this).concat(`(${id})`), \"nns.getById\");\r\n    }\r\n\r\n    /**\r\n     * Adds a new node to the collection\r\n     *\r\n     * @param title Display name of the node\r\n     * @param url The url of the node\r\n     * @param visible If true the node is visible, otherwise it is hidden (default: true)\r\n     */\r\n    @tag(\"nns.add\")\r\n    public async add(title: string, url: string, visible = true): Promise<INavigationNodeAddResult> {\r\n\r\n        const postBody = body(assign(metadata(\"SP.NavigationNode\"), {\r\n            IsVisible: visible,\r\n            Title: title,\r\n            Url: url,\r\n        }));\r\n\r\n        const data = await spPost(this.clone(NavigationNodes, null), postBody);\r\n\r\n        return {\r\n            data,\r\n            node: this.getById(data.Id),\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Moves a node to be after another node in the navigation\r\n     *\r\n     * @param nodeId Id of the node to move\r\n     * @param previousNodeId Id of the node after which we move the node specified by nodeId\r\n     */\r\n    @tag(\"nns.moveAfter\")\r\n    public moveAfter(nodeId: number, previousNodeId: number): Promise<void> {\r\n\r\n        const postBody = body({\r\n            nodeId: nodeId,\r\n            previousNodeId: previousNodeId,\r\n        });\r\n\r\n        return spPost(this.clone(NavigationNodes, \"MoveAfter\"), postBody);\r\n    }\r\n}\r\nexport interface INavigationNodes extends _NavigationNodes { }\r\nexport const NavigationNodes = spInvokableFactory<INavigationNodes>(_NavigationNodes);\r\n\r\n\r\n/**\r\n * Represents an instance of a navigation node\r\n *\r\n */\r\nexport class _NavigationNode extends _SharePointQueryableInstance<INavNodeInfo> {\r\n\r\n    public delete = deleteable(\"nn\");\r\n\r\n    /**\r\n     * Represents the child nodes of this node\r\n     */\r\n    public get children(): INavigationNodes {\r\n        return tag.configure(NavigationNodes(this, \"children\"), \"nn.children\");\r\n    }\r\n\r\n    /**\r\n     * Updates this node\r\n     * \r\n     * @param properties Properties used to update this node\r\n     */\r\n    @tag(\"nn.update\")\r\n    public async update(properties: Partial<INavNodeInfo>): Promise<INavNodeUpdateResult> {\r\n\r\n        const postBody = body(assign(metadata(\"SP.NavigationNode\"), properties), headers({ \"X-HTTP-Method\": \"MERGE\" }));\r\n\r\n        const data = await spPost(this, postBody);\r\n\r\n        return {\r\n            data,\r\n            node: <any>this,\r\n        };\r\n    }\r\n}\r\nexport interface INavigationNode extends _NavigationNode, IDeleteable { }\r\nexport const NavigationNode = spInvokableFactory<INavigationNode>(_NavigationNode);\r\n\r\nexport interface INavNodeUpdateResult {\r\n    data: any;\r\n    node: INavigationNode;\r\n}\r\n\r\n/**\r\n * Exposes the navigation components\r\n *\r\n */\r\n@defaultPath(\"navigation\")\r\nexport class _Navigation extends _SharePointQueryable {\r\n\r\n    /**\r\n     * Gets the quicklaunch navigation nodes for the current context\r\n     *\r\n     */\r\n    public get quicklaunch(): INavigationNodes {\r\n        return tag.configure(NavigationNodes(this, \"quicklaunch\"), \"n.quicklaunch\");\r\n    }\r\n\r\n    /**\r\n     * Gets the top bar navigation nodes for the current context\r\n     *\r\n     */\r\n    public get topNavigationBar(): INavigationNodes {\r\n        return tag.configure(NavigationNodes(this, \"topnavigationbar\"), \"n.topnavigationbar\");\r\n    }\r\n}\r\nexport interface INavigation {\r\n    readonly quicklaunch: INavigationNodes;\r\n    readonly topNavigationBar: INavigationNodes;\r\n}\r\nexport const Navigation = spInvokableFactory<INavigation>(_Navigation);\r\n\r\n/**\r\n * Represents the top level navigation service\r\n */\r\nexport class _NavigationService extends _SharePointQueryable {\r\n\r\n    constructor(path: string = null) {\r\n        super(\"_api/navigation\", path);\r\n    }\r\n\r\n    /**\r\n     * The MenuState service operation returns a Menu-State (dump) of a SiteMapProvider on a site.\r\n     * \r\n     * @param menuNodeKey MenuNode.Key of the start node within the SiteMapProvider If no key is provided the SiteMapProvider.RootNode will be the root of the menu state.\r\n     * @param depth Depth of the dump. If no value is provided a dump with the depth of 10 is returned\r\n     * @param mapProviderName The name identifying the SiteMapProvider to be used\r\n     * @param customProperties comma seperated list of custom properties to be returned.\r\n     */\r\n    @tag(\"ns.getMenuState\")\r\n    public getMenuState(menuNodeKey: string = null, depth = 10, mapProviderName: string = null, customProperties: string = null): Promise<IMenuNodeCollection> {\r\n\r\n        return spPost(<any>NavigationService(\"MenuState\"), body({\r\n            customProperties,\r\n            depth,\r\n            mapProviderName,\r\n            menuNodeKey,\r\n        }));\r\n    }\r\n\r\n    /**\r\n     * Tries to get a SiteMapNode.Key for a given URL within a site collection.\r\n     * \r\n     * @param currentUrl A url representing the SiteMapNode\r\n     * @param mapProviderName The name identifying the SiteMapProvider to be used\r\n     */\r\n    @tag(\"ns.getMenuNodeKey\")\r\n    public getMenuNodeKey(currentUrl: string, mapProviderName: string = null): Promise<string> {\r\n\r\n        return spPost(<any>NavigationService(\"MenuNodeKey\"), body({\r\n            currentUrl,\r\n            mapProviderName,\r\n        }));\r\n    }\r\n}\r\nexport interface INavigationService extends _NavigationService { }\r\nexport const NavigationService = (path?: string) => <INavigationService>new _NavigationService(path);\r\n\r\nexport interface IMenuNode {\r\n    CustomProperties: any[];\r\n    FriendlyUrlSegment: string;\r\n    IsDeleted: boolean;\r\n    IsHidden: boolean;\r\n    Key: string;\r\n    Nodes: IMenuNode[];\r\n    NodeType: number;\r\n    SimpleUrl: string;\r\n    Title: string;\r\n}\r\n\r\nexport interface IMenuNodeCollection {\r\n    FriendlyUrlPrefix: string;\r\n    Nodes: IMenuNode[];\r\n    SimpleUrl: string;\r\n    SPSitePrefix: string;\r\n    SPWebPrefix: string;\r\n    StartingNodeKey: string;\r\n    StartingNodeTitle: string;\r\n    Version: Date;\r\n}\r\n\r\nexport interface ISerializableNavigationNode {\r\n    Id: number;\r\n    Title: string;\r\n    Url: string;\r\n    IsDocLib: boolean;\r\n    IsExternal: boolean;\r\n    ParentId: number;\r\n    ListTemplateType: number;\r\n    AudienceIds: string[];\r\n    Children: ISerializableNavigationNode[];\r\n}\r\n\r\n/**\r\n * Result from adding a navigation node\r\n *\r\n */\r\nexport interface INavigationNodeAddResult {\r\n    data: INavNodeInfo;\r\n    node: INavigationNode;\r\n}\r\n\r\n/**\r\n * Represents the information describing a navigation node\r\n */\r\nexport interface INavNodeInfo {\r\n    AudienceIds: string[] | null;\r\n    Id: number;\r\n    IsDocLib: boolean;\r\n    IsExternal: boolean;\r\n    IsVisible: boolean;\r\n    ListTemplateType: number;\r\n    Title: string;\r\n    Url: string;\r\n}\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _Web } from \"../webs/types\";\r\nimport { Navigation, INavigation } from \"./types\";\r\n\r\ndeclare module \"../webs/types\" {\r\n    interface _Web {\r\n        navigation: INavigation;\r\n    }\r\n    interface IWeb {\r\n\r\n        /**\r\n         * Gets a navigation object that represents navigation on the Web site,\r\n         * including the Quick Launch area and the top navigation bar\r\n         */\r\n        navigation: INavigation;\r\n    }\r\n}\r\n\r\naddProp(_Web, \"navigation\", Navigation);\r\n","import { SPRest } from \"../rest\";\r\nimport { NavigationService, INavigationService } from \"./types\";\r\n\r\nimport \"./web\";\r\n\r\nexport {\r\n    INavNodeUpdateResult,\r\n    INavigation,\r\n    INavigationNode,\r\n    INavigationNodeAddResult,\r\n    INavigationNodes,\r\n    INavigationService,\r\n    Navigation,\r\n    NavigationNode,\r\n    NavigationNodes,\r\n    NavigationService,\r\n    IMenuNode,\r\n    IMenuNodeCollection,\r\n    ISerializableNavigationNode,\r\n    INavNodeInfo,\r\n} from \"./types\";\r\n\r\ndeclare module \"../rest\" {\r\n    interface SPRest {\r\n        readonly navigation: INavigationService;\r\n    }\r\n}\r\n\r\nReflect.defineProperty(SPRest.prototype, \"navigation\", {\r\n    configurable: true,\r\n    enumerable: true,\r\n    get: function (this: SPRest) {\r\n        return NavigationService().configure(this._options);\r\n    },\r\n});\r\n","import {\r\n    _SharePointQueryableInstance,\r\n    SharePointQueryableCollection,\r\n    ISharePointQueryableCollection,\r\n    _SharePointQueryable,\r\n    ISharePointQueryable,\r\n    spInvokableFactory,\r\n} from \"../sharepointqueryable\";\r\nimport { assign } from \"@pnp/common\";\r\nimport { metadata } from \"../utils/metadata\";\r\nimport { body } from \"@pnp/odata\";\r\nimport { PrincipalType, PrincipalSource } from \"../types\";\r\nimport { defaultPath } from \"../decorators\";\r\nimport { spPost } from \"../operations\";\r\n\r\nexport class _Profiles extends _SharePointQueryableInstance {\r\n\r\n    private clientPeoplePickerQuery: ClientPeoplePickerQuery;\r\n    private profileLoader: ProfileLoader;\r\n\r\n    /**\r\n     * Creates a new instance of the UserProfileQuery class\r\n     *\r\n     * @param baseUrl The url or SharePointQueryable which forms the parent of this user profile query\r\n     */\r\n    constructor(baseUrl: string | ISharePointQueryable, path = \"_api/sp.userprofiles.peoplemanager\") {\r\n        super(baseUrl, path);\r\n\r\n        this.clientPeoplePickerQuery = (new ClientPeoplePickerQuery(baseUrl)).configureFrom(this);\r\n        this.profileLoader = (new ProfileLoader(baseUrl)).configureFrom(this);\r\n    }\r\n\r\n    /**\r\n     * The url of the edit profile page for the current user\r\n     */\r\n    public get editProfileLink(): Promise<string> {\r\n        return this.clone(Profiles, \"EditProfileLink\").get();\r\n    }\r\n\r\n    /**\r\n     * A boolean value that indicates whether the current user's \"People I'm Following\" list is public\r\n     */\r\n    public get isMyPeopleListPublic(): Promise<boolean> {\r\n        return this.clone(Profiles, \"IsMyPeopleListPublic\").get();\r\n    }\r\n\r\n    /**\r\n     * A boolean value that indicates whether the current user is being followed by the specified user\r\n     *\r\n     * @param loginName The account name of the user\r\n     */\r\n    public amIFollowedBy(loginName: string): Promise<boolean> {\r\n        const q = this.clone(Profiles, \"amifollowedby(@v)\");\r\n        q.query.set(\"@v\", `'${encodeURIComponent(loginName)}'`);\r\n        return q.get();\r\n    }\r\n\r\n    /**\r\n     * A boolean value that indicates whether the current user is following the specified user\r\n     *\r\n     * @param loginName The account name of the user\r\n     */\r\n    public amIFollowing(loginName: string): Promise<boolean> {\r\n        const q = this.clone(Profiles, \"amifollowing(@v)\");\r\n        q.query.set(\"@v\", `'${encodeURIComponent(loginName)}'`);\r\n        return q.get();\r\n    }\r\n\r\n    /**\r\n     * Gets tags that the current user is following\r\n     *\r\n     * @param maxCount The maximum number of tags to retrieve (default is 20)\r\n     */\r\n    public getFollowedTags(maxCount = 20): Promise<string[]> {\r\n        return this.clone(Profiles, `getfollowedtags(${maxCount})`).get();\r\n    }\r\n\r\n    /**\r\n     * Gets the people who are following the specified user\r\n     *\r\n     * @param loginName The account name of the user\r\n     */\r\n    public getFollowersFor(loginName: string): Promise<any[]> {\r\n        const q = this.clone(Profiles, \"getfollowersfor(@v)\");\r\n        q.query.set(\"@v\", `'${encodeURIComponent(loginName)}'`);\r\n        return q.get();\r\n    }\r\n\r\n    /**\r\n     * Gets the people who are following the current user\r\n     *\r\n     */\r\n    public get myFollowers(): ISharePointQueryableCollection {\r\n        return SharePointQueryableCollection(this, \"getmyfollowers\");\r\n    }\r\n\r\n    /**\r\n     * Gets user properties for the current user\r\n     *\r\n     */\r\n    public get myProperties(): _SharePointQueryableInstance {\r\n        return new _Profiles(this, \"getmyproperties\");\r\n    }\r\n\r\n    /**\r\n     * Gets the people who the specified user is following\r\n     *\r\n     * @param loginName The account name of the user.\r\n     */\r\n    public getPeopleFollowedBy(loginName: string): Promise<any[]> {\r\n        const q = this.clone(Profiles, \"getpeoplefollowedby(@v)\");\r\n        q.query.set(\"@v\", `'${encodeURIComponent(loginName)}'`);\r\n        return q.get();\r\n    }\r\n\r\n    /**\r\n     * Gets user properties for the specified user.\r\n     *\r\n     * @param loginName The account name of the user.\r\n     */\r\n    public getPropertiesFor(loginName: string): Promise<any> {\r\n        const q = this.clone(Profiles, \"getpropertiesfor(@v)\");\r\n        q.query.set(\"@v\", `'${encodeURIComponent(loginName)}'`);\r\n        return q.get();\r\n    }\r\n\r\n    /**\r\n     * Gets the 20 most popular hash tags over the past week, sorted so that the most popular tag appears first\r\n     *\r\n     */\r\n    public get trendingTags(): Promise<IHashTagCollection> {\r\n        const q = this.clone(Profiles, null);\r\n        q.concat(\".gettrendingtags\");\r\n        return q.get();\r\n    }\r\n\r\n    /**\r\n     * Gets the specified user profile property for the specified user\r\n     *\r\n     * @param loginName The account name of the user\r\n     * @param propertyName The case-sensitive name of the property to get\r\n     */\r\n    public getUserProfilePropertyFor(loginName: string, propertyName: string): Promise<string> {\r\n        const q = this.clone(Profiles, `getuserprofilepropertyfor(accountname=@v, propertyname='${propertyName}')`);\r\n        q.query.set(\"@v\", `'${encodeURIComponent(loginName)}'`);\r\n        return q.get();\r\n    }\r\n\r\n    /**\r\n     * Removes the specified user from the user's list of suggested people to follow\r\n     *\r\n     * @param loginName The account name of the user\r\n     */\r\n    public hideSuggestion(loginName: string): Promise<void> {\r\n        const q = this.clone(Profiles, \"hidesuggestion(@v)\");\r\n        q.query.set(\"@v\", `'${encodeURIComponent(loginName)}'`);\r\n        return spPost(q);\r\n    }\r\n\r\n    /**\r\n     * A boolean values that indicates whether the first user is following the second user\r\n     *\r\n     * @param follower The account name of the user who might be following the followee\r\n     * @param followee The account name of the user who might be followed by the follower\r\n     */\r\n    public isFollowing(follower: string, followee: string): Promise<boolean> {\r\n        const q = this.clone(Profiles, null);\r\n        q.concat(`.isfollowing(possiblefolloweraccountname=@v, possiblefolloweeaccountname=@y)`);\r\n        q.query.set(\"@v\", `'${encodeURIComponent(follower)}'`);\r\n        q.query.set(\"@y\", `'${encodeURIComponent(followee)}'`);\r\n        return q.get();\r\n    }\r\n\r\n    /**\r\n     * Uploads and sets the user profile picture (Users can upload a picture to their own profile only). Not supported for batching.\r\n     *\r\n     * @param profilePicSource Blob data representing the user's picture in BMP, JPEG, or PNG format of up to 4.76MB\r\n     */\r\n    public setMyProfilePic(profilePicSource: Blob): Promise<void> {\r\n\r\n        return new Promise<void>((resolve, reject) => {\r\n            const reader = new FileReader();\r\n            reader.onload = async (e: any) => {\r\n                const buffer = e.target.result;\r\n                try {\r\n                    await spPost(Profiles(this, \"setmyprofilepicture\"), { body: buffer });\r\n                    resolve();\r\n                } catch (e) {\r\n                    reject(e);\r\n                }\r\n            };\r\n            reader.readAsArrayBuffer(profilePicSource);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Sets single value User Profile property\r\n     *\r\n     * @param accountName The account name of the user\r\n     * @param propertyName Property name\r\n     * @param propertyValue Property value\r\n     */\r\n    public setSingleValueProfileProperty(accountName: string, propertyName: string, propertyValue: string): Promise<void> {\r\n\r\n        return spPost(this.clone(Profiles, \"SetSingleValueProfileProperty\"), body({\r\n            accountName: accountName,\r\n            propertyName: propertyName,\r\n            propertyValue: propertyValue,\r\n        }));\r\n    }\r\n\r\n    /**\r\n     * Sets multi valued User Profile property\r\n     *\r\n     * @param accountName The account name of the user\r\n     * @param propertyName Property name\r\n     * @param propertyValues Property values\r\n     */\r\n    public setMultiValuedProfileProperty(accountName: string, propertyName: string, propertyValues: string[]): Promise<void> {\r\n\r\n        return spPost(this.clone(Profiles, \"SetMultiValuedProfileProperty\"), body({\r\n            accountName: accountName,\r\n            propertyName: propertyName,\r\n            propertyValues: propertyValues,\r\n        }));\r\n    }\r\n\r\n    /**\r\n     * Provisions one or more users' personal sites. (My Site administrator on SharePoint Online only)\r\n     *\r\n     * @param emails The email addresses of the users to provision sites for\r\n     */\r\n    public createPersonalSiteEnqueueBulk(...emails: string[]): Promise<void> {\r\n        return this.profileLoader.createPersonalSiteEnqueueBulk(emails);\r\n    }\r\n\r\n    /**\r\n     * Gets the user profile of the site owner\r\n     *\r\n     */\r\n    public get ownerUserProfile(): Promise<IUserProfile> {\r\n        return this.profileLoader.ownerUserProfile;\r\n    }\r\n\r\n    /**\r\n     * Gets the user profile for the current user\r\n     */\r\n    public get userProfile(): Promise<any> {\r\n        return this.profileLoader.userProfile;\r\n    }\r\n\r\n    /**\r\n     * Enqueues creating a personal site for this user, which can be used to share documents, web pages, and other files\r\n     *\r\n     * @param interactiveRequest true if interactively (web) initiated request, or false (default) if non-interactively (client) initiated request\r\n     */\r\n    public createPersonalSite(interactiveRequest = false): Promise<void> {\r\n        return this.profileLoader.createPersonalSite(interactiveRequest);\r\n    }\r\n\r\n    /**\r\n     * Sets the privacy settings for this profile\r\n     *\r\n     * @param share true to make all social data public; false to make all social data private\r\n     */\r\n    public shareAllSocialData(share: boolean): Promise<void> {\r\n        return this.profileLoader.shareAllSocialData(share);\r\n    }\r\n\r\n    /**\r\n     * Resolves user or group using specified query parameters\r\n     *\r\n     * @param queryParams The query parameters used to perform resolve\r\n     */\r\n    public clientPeoplePickerResolveUser(queryParams: IClientPeoplePickerQueryParameters): Promise<IPeoplePickerEntity> {\r\n        return this.clientPeoplePickerQuery.clientPeoplePickerResolveUser(queryParams);\r\n    }\r\n\r\n    /**\r\n     * Searches for users or groups using specified query parameters\r\n     *\r\n     * @param queryParams The query parameters used to perform search\r\n     */\r\n    public clientPeoplePickerSearchUser(queryParams: IClientPeoplePickerQueryParameters): Promise<IPeoplePickerEntity[]> {\r\n        return this.clientPeoplePickerQuery.clientPeoplePickerSearchUser(queryParams);\r\n    }\r\n}\r\nexport interface IProfiles extends _Profiles { }\r\nexport const Profiles = spInvokableFactory<IProfiles>(_Profiles);\r\n\r\n@defaultPath(\"_api/sp.userprofiles.profileloader.getprofileloader\")\r\nclass ProfileLoader extends _SharePointQueryable {\r\n\r\n    /**\r\n     * Provisions one or more users' personal sites. (My Site administrator on SharePoint Online only) Doesn't support batching\r\n     *\r\n     * @param emails The email addresses of the users to provision sites for\r\n     */\r\n    public createPersonalSiteEnqueueBulk(emails: string[]): Promise<void> {\r\n\r\n        return spPost(this.clone(ProfileLoaderFactory, \"createpersonalsiteenqueuebulk\", false), body({ \"emailIDs\": emails }));\r\n    }\r\n\r\n    /**\r\n     * Gets the user profile of the site owner.\r\n     *\r\n     */\r\n    public get ownerUserProfile(): Promise<IUserProfile> {\r\n        let q = this.getParent(ProfileLoaderFactory, this.parentUrl, \"_api/sp.userprofiles.profileloader.getowneruserprofile\");\r\n\r\n        if (this.hasBatch) {\r\n            q = q.inBatch(this.batch);\r\n        }\r\n\r\n        return spPost(q);\r\n    }\r\n\r\n    /**\r\n     * Gets the user profile of the current user.\r\n     *\r\n     */\r\n    public get userProfile(): Promise<IUserProfile> {\r\n        return spPost(this.clone(ProfileLoaderFactory, \"getuserprofile\"));\r\n    }\r\n\r\n    /**\r\n     * Enqueues creating a personal site for this user, which can be used to share documents, web pages, and other files.\r\n     *\r\n     * @param interactiveRequest true if interactively (web) initiated request, or false (default) if non-interactively (client) initiated request\r\n     */\r\n    public createPersonalSite(interactiveRequest = false): Promise<void> {\r\n        return spPost(this.clone(ProfileLoaderFactory, `getuserprofile/createpersonalsiteenque(${interactiveRequest})`));\r\n    }\r\n\r\n    /**\r\n     * Sets the privacy settings for this profile\r\n     *\r\n     * @param share true to make all social data public; false to make all social data private.\r\n     */\r\n    public shareAllSocialData(share: boolean): Promise<void> {\r\n        return spPost(this.clone(ProfileLoaderFactory, `getuserprofile/shareallsocialdata(${share})`));\r\n    }\r\n}\r\n\r\nconst ProfileLoaderFactory = (baseUrl: string | ISharePointQueryable, path?: string) => {\r\n    return new ProfileLoader(baseUrl, path);\r\n};\r\n\r\n@defaultPath(\"_api/sp.ui.applicationpages.clientpeoplepickerwebserviceinterface\")\r\nclass ClientPeoplePickerQuery extends _SharePointQueryable {\r\n\r\n    /**\r\n     * Resolves user or group using specified query parameters\r\n     *\r\n     * @param queryParams The query parameters used to perform resolve\r\n     */\r\n    public async clientPeoplePickerResolveUser(queryParams: IClientPeoplePickerQueryParameters): Promise<IPeoplePickerEntity> {\r\n        const q = this.clone(ClientPeoplePickerFactory, null);\r\n        q.concat(\".clientpeoplepickerresolveuser\");\r\n        const res = await spPost<string | { ClientPeoplePickerResolveUser: string }>(q, this.getBodyFrom(queryParams));\r\n\r\n        return JSON.parse(typeof res === \"object\" ? res.ClientPeoplePickerResolveUser : res);\r\n    }\r\n\r\n    /**\r\n     * Searches for users or groups using specified query parameters\r\n     *\r\n     * @param queryParams The query parameters used to perform search\r\n     */\r\n    public async clientPeoplePickerSearchUser(queryParams: IClientPeoplePickerQueryParameters): Promise<IPeoplePickerEntity[]> {\r\n        const q = this.clone(ClientPeoplePickerFactory, null);\r\n        q.concat(\".clientpeoplepickersearchuser\");\r\n        const res = await spPost<string | { ClientPeoplePickerSearchUser: string }>(q, this.getBodyFrom(queryParams));\r\n\r\n        return JSON.parse(typeof res === \"object\" ? res.ClientPeoplePickerSearchUser : res);\r\n    }\r\n\r\n    /**\r\n     * Creates ClientPeoplePickerQueryParameters request body\r\n     *\r\n     * @param queryParams The query parameters to create request body\r\n     */\r\n    private getBodyFrom(queryParams: IClientPeoplePickerQueryParameters): { body: string } {\r\n        return body({ \"queryParams\": assign(metadata(\"SP.UI.ApplicationPages.ClientPeoplePickerQueryParameters\"), queryParams) });\r\n    }\r\n}\r\n\r\nconst ClientPeoplePickerFactory = (baseUrl: string | ISharePointQueryable, path?: string) => {\r\n    return new ClientPeoplePickerQuery(baseUrl, path);\r\n};\r\n\r\n/**\r\n * Client people picker query parameters\r\n */\r\nexport interface IClientPeoplePickerQueryParameters {\r\n    /**\r\n     * Gets or sets a value that specifies whether e-mail addresses can be used to perform search.\r\n     */\r\n    AllowEmailAddresses?: boolean;\r\n    /**\r\n     * Gets or sets a value that specifies whether multiple entities are allowed.\r\n     */\r\n    AllowMultipleEntities?: boolean;\r\n    /**\r\n     * Gets or sets a value that specifies whether only e-mail addresses can be used to perform search.\r\n     */\r\n    AllowOnlyEmailAddresses?: boolean;\r\n    /**\r\n     * Gets or sets a value that specifies whether all URL zones are used to perform search.\r\n     */\r\n    AllUrlZones?: boolean;\r\n    /**\r\n     * Gets or sets a value that specifies claim providers that are used to perform search.\r\n     */\r\n    EnabledClaimProviders?: string;\r\n    /**\r\n     * Gets or sets a value that specifies whether claims are forced (if yes, multiple results for single entity can be returned).\r\n     */\r\n    ForceClaims?: boolean;\r\n    /**\r\n     * Gets or sets a value that specifies limit of results returned.\r\n     */\r\n    MaximumEntitySuggestions: number;\r\n    /**\r\n     * Gets or sets a value that specifies principal sources to perform search.\r\n     */\r\n    PrincipalSource?: PrincipalSource;\r\n    /**\r\n     * Gets or sets a value that specifies principal types to search for.\r\n     */\r\n    PrincipalType?: PrincipalType;\r\n    /**\r\n     * Gets or sets a value that specifies additional query settings.\r\n     */\r\n    QuerySettings?: IPeoplePickerQuerySettings;\r\n    /**\r\n     * Gets or sets a value that specifies the term to search for.\r\n     */\r\n    QueryString: string;\r\n    /**\r\n     * Gets or sets a value that specifies ID of the SharePoint Group that will be used to perform search.\r\n     */\r\n    SharePointGroupID?: number;\r\n    /**\r\n     * Gets or sets a value that specifies URL zones that are used to perform search.\r\n     */\r\n    UrlZone?: UrlZone;\r\n    /**\r\n     * Gets or sets a value that specifies whether search is limited to specific URL zone.\r\n     */\r\n    UrlZoneSpecified?: boolean;\r\n    /**\r\n     * Gets or sets a value that specifies GUID of the Web Application that is used to perform search.\r\n     */\r\n    WebApplicationID?: string;\r\n}\r\n\r\nexport interface IHashTagCollection {\r\n    Items: IHashTag[];\r\n}\r\n\r\n/**\r\n * People picker query settings\r\n */\r\nexport interface IPeoplePickerQuerySettings {\r\n    ExcludeAllUsersOnTenantClaim?: boolean;\r\n}\r\n\r\n/**\r\n * People picker entity\r\n */\r\nexport interface IPeoplePickerEntity {\r\n    Description: string;\r\n    DisplayText: string;\r\n    EntityData: IPeoplePickerEntityData;\r\n    EntityType: string;\r\n    IsResolved: boolean;\r\n    Key: string;\r\n    MultipleMatches: IPeoplePickerEntityData[];\r\n    ProviderDisplayName: string;\r\n    ProviderName: string;\r\n}\r\n\r\n/**\r\n * People picker entity data\r\n */\r\nexport interface IPeoplePickerEntityData {\r\n    AccountName?: string;\r\n    Department?: string;\r\n    Email?: string;\r\n    IsAltSecIdPresent?: string;\r\n    MobilePhone?: string;\r\n    ObjectId?: string;\r\n    OtherMails?: string;\r\n    PrincipalType?: string;\r\n    SPGroupID?: string;\r\n    SPUserID?: string;\r\n    Title?: string;\r\n}\r\n\r\n/**\r\n * Specifies the originating zone of a request received.\r\n */\r\nexport const enum UrlZone {\r\n    /**\r\n     * Specifies the default zone used for requests unless another zone is specified.\r\n     */\r\n    DefaultZone,\r\n    /**\r\n     * Specifies an intranet zone.\r\n     */\r\n    Intranet,\r\n    /**\r\n     * Specifies an Internet zone.\r\n     */\r\n    Internet,\r\n    /**\r\n     * Specifies a custom zone.\r\n     */\r\n    Custom,\r\n    /**\r\n     * Specifies an extranet zone.\r\n     */\r\n    Extranet,\r\n}\r\n\r\nexport interface IHashTag {\r\n    /**\r\n     * The hash tag's internal name.\r\n     */\r\n    Name?: string;\r\n    /**\r\n     * The number of times that the hash tag is used.\r\n     */\r\n    UseCount?: number;\r\n}\r\n\r\nexport interface IFollowedContent {\r\n    FollowedDocumentsUrl: string;\r\n    FollowedSitesUrl: string;\r\n}\r\n\r\nexport interface IUserProfile {\r\n    /**\r\n     * An object containing the user's FollowedDocumentsUrl and FollowedSitesUrl.\r\n     */\r\n    FollowedContent?: IFollowedContent;\r\n    /**\r\n     * The account name of the user. (SharePoint Online only)\r\n     */\r\n    AccountName?: string;\r\n    /**\r\n     * The display name of the user. (SharePoint Online only)\r\n     */\r\n    DisplayName?: string;\r\n    /**\r\n     * The FirstRun flag of the user. (SharePoint Online only)\r\n     */\r\n    O15FirstRunExperience?: number;\r\n    /**\r\n     * The personal site of the user.\r\n     */\r\n    PersonalSite?: string;\r\n    /**\r\n     * The capabilities of the user's personal site. Represents a bitwise PersonalSiteCapabilities value:\r\n     * None = 0; Profile Value = 1; Social Value = 2; Storage Value = 4; MyTasksDashboard Value = 8; Education Value = 16; Guest Value = 32.\r\n     */\r\n    PersonalSiteCapabilities?: number;\r\n    /**\r\n     * The error thrown when the user's personal site was first created, if any. (SharePoint Online only)\r\n     */\r\n    PersonalSiteFirstCreationError?: string;\r\n    /**\r\n     * The date and time when the user's personal site was first created. (SharePoint Online only)\r\n     */\r\n    PersonalSiteFirstCreationTime?: Date;\r\n    /**\r\n     * The status for the state of the personal site instantiation\r\n     */\r\n    PersonalSiteInstantiationState?: number;\r\n    /**\r\n     * The date and time when the user's personal site was last created. (SharePoint Online only)\r\n     */\r\n    PersonalSiteLastCreationTime?: Date;\r\n    /**\r\n     * The number of attempts made to create the user's personal site. (SharePoint Online only)\r\n     */\r\n    PersonalSiteNumberOfRetries?: number;\r\n    /**\r\n     * Indicates whether the user's picture is imported from Exchange.\r\n     */\r\n    PictureImportEnabled?: boolean;\r\n    /**\r\n     * The public URL of the personal site of the current user. (SharePoint Online only)\r\n     */\r\n    PublicUrl?: string;\r\n    /**\r\n     * The URL used to create the user's personal site.\r\n     */\r\n    UrlToCreatePersonalSite?: string;\r\n}\r\n","import { SPRest } from \"../rest\";\r\nimport { Profiles, IProfiles } from \"./types\";\r\n\r\nexport {\r\n    IProfiles,\r\n    Profiles,\r\n    IClientPeoplePickerQueryParameters,\r\n    IFollowedContent,\r\n    IHashTag,\r\n    IHashTagCollection,\r\n    IPeoplePickerEntity,\r\n    IPeoplePickerEntityData,\r\n    IPeoplePickerQuerySettings,\r\n    IUserProfile,\r\n    UrlZone,\r\n} from \"./types\";\r\n\r\ndeclare module \"../rest\" {\r\n    interface SPRest {\r\n        readonly profiles: IProfiles;\r\n    }\r\n}\r\n\r\nReflect.defineProperty(SPRest.prototype, \"profiles\", {\r\n    configurable: true,\r\n    enumerable: true,\r\n    get: function (this: SPRest) {\r\n        return Profiles(this._baseUrl);\r\n    },\r\n});\r\n","import { dateAdd, hOP } from \"@pnp/common\";\r\nimport {\r\n    _SharePointQueryableInstance,\r\n    SharePointQueryableCollection,\r\n    ISharePointQueryableCollection,\r\n    _SharePointQueryableCollection,\r\n    spInvokableFactory,\r\n} from \"../sharepointqueryable\";\r\nimport { defaultPath } from \"../decorators\";\r\nimport { spODataEntity } from \"../odata\";\r\nimport { spPost } from \"../operations\";\r\nimport { tag } from \"../telemetry\";\r\n\r\n@defaultPath(\"regionalsettings\")\r\nexport class _RegionalSettings extends _SharePointQueryableInstance<IRegionalSettingsInfo> {\r\n\r\n    /**\r\n     * Gets the collection of languages used in a server farm.\r\n     * ** Please use getInstalledLanguages instead of this method **\r\n     */\r\n    public get installedLanguages(): ISharePointQueryableCollection<{ Items: IInstalledLanguageInfo[] }> {\r\n        console.warn(\"Deprecated: RegionalSettings.installedLanguages is deprecated, please use RegionalSettings.getInstalledLanguages\");\r\n        return <any>tag.configure(SharePointQueryableCollection(this, \"installedlanguages\"), \"rs.installedLanguages\");\r\n    }\r\n\r\n    /**\r\n     * Gets time zone\r\n     */\r\n    public get timeZone(): ITimeZone {\r\n        return tag.configure(TimeZone(this), \"rs.tz\");\r\n    }\r\n\r\n    /**\r\n     * Gets time zones\r\n     */\r\n    public get timeZones(): ITimeZones {\r\n        return tag.configure(TimeZones(this), \"rs.tzs\");\r\n    }\r\n\r\n    /**\r\n     * Gets the collection of languages used in a server farm.\r\n     */\r\n    public async getInstalledLanguages(): Promise<IInstalledLanguageInfo[]> {\r\n        const results: { Items: IInstalledLanguageInfo[] } = await tag.configure(SharePointQueryableCollection(this, \"installedlanguages\"), \"rs.getInstalledLanguages\")();\r\n        return results.Items;\r\n    }\r\n}\r\nexport interface IRegionalSettings extends _RegionalSettings { }\r\nexport const RegionalSettings = spInvokableFactory<IRegionalSettings>(_RegionalSettings);\r\n\r\n@defaultPath(\"timezone\")\r\nexport class _TimeZone extends _SharePointQueryableInstance<ITimeZoneInfo> {\r\n\r\n    /**\r\n     * Gets an Local Time by UTC Time\r\n     *\r\n     * @param utcTime UTC Time as Date or ISO String\r\n     */\r\n    @tag(\"tz.utcToLocalTime\")\r\n    public async utcToLocalTime(utcTime: string | Date): Promise<string> {\r\n\r\n        let dateIsoString: string;\r\n\r\n        if (typeof utcTime === \"string\") {\r\n            dateIsoString = utcTime;\r\n        } else {\r\n            dateIsoString = utcTime.toISOString();\r\n        }\r\n\r\n        const res = await spPost(this.clone(TimeZone, `utctolocaltime('${dateIsoString}')`));\r\n        return hOP(res, \"UTCToLocalTime\") ? res.UTCToLocalTime : res;\r\n    }\r\n\r\n    /**\r\n     * Gets an UTC Time by Local Time\r\n     *\r\n     * @param localTime Local Time as Date or ISO String\r\n     */\r\n    @tag(\"tz.localTimeToUTC\")\r\n    public async localTimeToUTC(localTime: string | Date): Promise<string> {\r\n\r\n        let dateIsoString: string;\r\n\r\n        if (typeof localTime === \"string\") {\r\n            dateIsoString = localTime;\r\n        } else {\r\n            dateIsoString = dateAdd(localTime, \"minute\", localTime.getTimezoneOffset() * -1).toISOString();\r\n        }\r\n\r\n        const res = await spPost(this.clone(TimeZone, `localtimetoutc('${dateIsoString}')`));\r\n\r\n        return hOP(res, \"LocalTimeToUTC\") ? res.LocalTimeToUTC : res;\r\n    }\r\n}\r\nexport interface ITimeZone extends _TimeZone { }\r\nexport const TimeZone = spInvokableFactory<ITimeZone>(_TimeZone);\r\n\r\n@defaultPath(\"timezones\")\r\nexport class _TimeZones extends _SharePointQueryableCollection<ITimeZoneInfo[]> {\r\n\r\n    /**\r\n     * Gets an TimeZone by id (see: https://msdn.microsoft.com/en-us/library/office/jj247008.aspx)\r\n     *\r\n     * @param id The integer id of the timezone to retrieve\r\n     */\r\n    @tag(\"tzs.getById\")\r\n    public getById(id: number): Promise<ITimeZone & ITimeZoneInfo> {\r\n        // do the post and merge the result into a TimeZone instance so the data and methods are available\r\n        return spPost(this.clone(TimeZones, `GetById(${id})`).usingParser(spODataEntity(TimeZone)));\r\n    }\r\n}\r\nexport interface ITimeZones extends _TimeZones { }\r\nexport const TimeZones = spInvokableFactory<ITimeZones>(_TimeZones);\r\n\r\n/**\r\n * This is the data for Regional Settings\r\n */\r\nexport interface IRegionalSettingsInfo {\r\n    AdjustHijriDays: number;\r\n    AlternateCalendarType: number;\r\n    AM: string;\r\n    CalendarType: number;\r\n    Collation: number;\r\n    CollationLCID: number;\r\n    DateFormat: number;\r\n    DateSeparator: string;\r\n    DecimalSeparator: string;\r\n    DigitGrouping: string;\r\n    FirstDayOfWeek: number;\r\n    FirstWeekOfYear: number;\r\n    IsEastAsia: boolean;\r\n    IsRightToLeft: boolean;\r\n    IsUIRightToLeft: boolean;\r\n    ListSeparator: string;\r\n    LocaleId: number;\r\n    NegativeSign: string;\r\n    NegNumberMode: number;\r\n    PM: string;\r\n    PositiveSign: string;\r\n    ShowWeeks: boolean;\r\n    ThousandSeparator: string;\r\n    Time24: boolean;\r\n    TimeMarkerPosition: number;\r\n    TimeSeparator: string;\r\n    WorkDayEndHour: number;\r\n    WorkDays: number;\r\n    WorkDayStartHour: number;\r\n}\r\n\r\nexport interface IInstalledLanguageInfo {\r\n    DisplayName: string;\r\n    LanguageTag: string;\r\n    Lcid: number;\r\n}\r\n\r\nexport interface ITimeZoneInfo {\r\n    Description: string;\r\n    Id: number;\r\n    Information: {\r\n        Bias: number;\r\n        DaylightBias: number;\r\n        StandardBias: number;\r\n    };\r\n}\r\n\r\nexport interface IUserResources {\r\n    /**\r\n     * Gets the resource string for the title\r\n     */\r\n    titleResource(cultureName: string): Promise<string>;\r\n    /**\r\n     * Gets the resource string for the title description\r\n     */\r\n    descriptionResource(cultureName: string): Promise<string>;\r\n}\r\n","import { _SharePointQueryable, SharePointQueryable } from \"../sharepointqueryable\";\r\nimport { spPost } from \"../operations\";\r\nimport { body } from \"@pnp/odata\";\r\n\r\nexport function getValueForUICultureBinder(propName: string): (this: _SharePointQueryable, cultureName: string) => Promise<string> {\r\n    return function (this: _SharePointQueryable, cultureName: string): Promise<string> {\r\n        return spPost(this.clone(SharePointQueryable, `${propName}/getValueForUICulture`), body({ cultureName }));\r\n    };\r\n}\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _Web } from \"../webs/types\";\r\nimport { RegionalSettings, IRegionalSettings, IUserResources } from \"./types\";\r\nimport { getValueForUICultureBinder } from \"./funcs\";\r\n\r\ndeclare module \"../webs/types\" {\r\n    interface _Web extends IUserResources {\r\n        regionalSettings: IRegionalSettings;\r\n    }\r\n    interface IWeb extends IUserResources {\r\n        /**\r\n         * Regional settings for this web\r\n         */\r\n        regionalSettings: IRegionalSettings;\r\n    }\r\n}\r\n\r\naddProp(_Web, \"regionalSettings\", RegionalSettings);\r\n\r\n_Web.prototype.titleResource = getValueForUICultureBinder(\"titleResource\");\r\n_Web.prototype.descriptionResource = getValueForUICultureBinder(\"descriptionResource\");\r\n","import {\r\n    _SharePointQueryableInstance,\r\n    _SharePointQueryableCollection,\r\n    spInvokableFactory,\r\n    deleteable,\r\n    IDeleteable,\r\n} from \"../sharepointqueryable\";\r\nimport { assign, ITypedHash } from \"@pnp/common\";\r\nimport { body } from \"@pnp/odata\";\r\nimport { defaultPath } from \"../decorators\";\r\nimport { spPost } from \"../operations\";\r\nimport { tag } from \"../telemetry\";\r\nimport { IBasePermissions } from \"../security\";\r\nimport { metadata } from \"../utils/metadata\";\r\n\r\n@defaultPath(\"usercustomactions\")\r\nexport class _UserCustomActions extends _SharePointQueryableCollection<IUserCustomActionInfo[]> {\r\n\r\n    /**\t   \r\n     * Returns the user custom action with the specified id\t     \r\n     *\t    \r\n     * @param id The GUID id of the user custom action to retrieve\t     \r\n     */\r\n    public getById(id: string): IUserCustomAction {\r\n        return tag.configure(UserCustomAction(this).concat(`('${id}')`), \"ucas.getById\");\r\n    }\r\n\r\n    /**\r\n     * Creates a user custom action\r\n     *\r\n     * @param properties The information object of property names and values which define the new user custom action\r\n     */\r\n    @tag(\"ucas.add\")\r\n    public async add(properties: ITypedHash<any>): Promise<IUserCustomActionAddResult> {\r\n        const data = await spPost(this, body(assign(metadata(\"SP.UserCustomAction\"), properties)));\r\n        return {\r\n            action: this.getById(data.Id),\r\n            data,\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Deletes all user custom actions in the collection\r\n     */\r\n    @tag(\"ucas.clear\")\r\n    public clear(): Promise<void> {\r\n        return spPost(this.clone(UserCustomActions, \"clear\"));\r\n    }\r\n}\r\nexport interface IUserCustomActions extends _UserCustomActions { }\r\nexport const UserCustomActions = spInvokableFactory<IUserCustomActions>(_UserCustomActions);\r\n\r\nexport class _UserCustomAction extends _SharePointQueryableInstance<IUserCustomActionInfo> {\r\n\r\n    public delete = deleteable(\"uca\");\r\n\r\n    /**\r\n    * Updates this user custom action with the supplied properties\r\n    *\r\n    * @param properties An information object of property names and values to update for this user custom action\r\n    */\r\n    public update: any = this._update<IUserCustomActionUpdateResult, ITypedHash<any>>(\"SP.UserCustomAction\", (data) => ({ data, action: <any>this }));\r\n}\r\nexport interface IUserCustomAction extends _UserCustomAction, IDeleteable { }\r\nexport const UserCustomAction = spInvokableFactory<IUserCustomAction>(_UserCustomAction);\r\n\r\n/**\r\n * Result from adding a user custom action\r\n */\r\nexport interface IUserCustomActionAddResult {\r\n    /*\r\n     * The raw data returned from the add operation\r\n     */\r\n    data: any;\r\n\r\n    /*\r\n     * The added UserCustomAction\r\n     */\r\n    action: IUserCustomAction;\r\n}\r\n\r\n/**\r\n * Result from udating a user custom action\r\n */\r\nexport interface IUserCustomActionUpdateResult {\r\n    /*\r\n     * The raw data returned from the update operation\r\n     */\r\n    data: any;\r\n\r\n    /*\r\n     * The updated UserCustomAction\r\n     */\r\n    action: IUserCustomAction;\r\n}\r\n\r\nexport enum UserCustomActionRegistrationType {\r\n    None,\r\n    List,\r\n    ContentType,\r\n    ProgId,\r\n    FileType,\r\n}\r\n\r\nexport enum UserCustomActionScope {\r\n    Unknown,\r\n    Site = 2,\r\n    Web,\r\n    List,\r\n}\r\n\r\nexport interface IUserCustomActionInfo {\r\n    CommandUIExtension: string;\r\n    Description: string;\r\n    Group: string;\r\n    Id: string;\r\n    ImageUrl: string;\r\n    Location: string;\r\n    Name: string;\r\n    RegistrationId: string;\r\n    RegistrationType: UserCustomActionRegistrationType;\r\n    Rights: IBasePermissions;\r\n    Scope: UserCustomActionScope;\r\n    ScriptBlock: string;\r\n    ScriptSrc: string;\r\n    Sequence: number;\r\n    Title: string;\r\n    Url: string;\r\n    VersionOfUserCustomAction: string;\r\n}\r\n","import { _UserCustomAction } from \"../user-custom-actions/types\";\r\nimport { getValueForUICultureBinder } from \"./funcs\";\r\nimport { IUserResources } from \"./types\";\r\n\r\ndeclare module \"../user-custom-actions/types\" {\r\n    interface _UserCustomAction extends IUserResources {}\r\n    interface IUserCustomAction extends IUserResources {}\r\n}\r\n\r\n_UserCustomAction.prototype.titleResource = getValueForUICultureBinder(\"titleResource\");\r\n_UserCustomAction.prototype.descriptionResource = getValueForUICultureBinder(\"descriptionResource\");\r\n","import { _List } from \"../lists/types\";\r\nimport { getValueForUICultureBinder } from \"./funcs\";\r\nimport { IUserResources } from \"./types\";\r\n\r\ndeclare module \"../lists/types\" {\r\n    interface _List extends IUserResources {}\r\n    interface IList extends IUserResources {}\r\n}\r\n\r\n_List.prototype.titleResource = getValueForUICultureBinder(\"titleResource\");\r\n_List.prototype.descriptionResource = getValueForUICultureBinder(\"descriptionResource\");\r\n","import { _Field } from \"../fields/types\";\r\nimport { getValueForUICultureBinder } from \"./funcs\";\r\nimport { IUserResources } from \"./types\";\r\n\r\ndeclare module \"../fields/types\" {\r\n    interface _Field extends IUserResources {}\r\n    interface IField extends IUserResources {}\r\n}\r\n\r\n_Field.prototype.titleResource = getValueForUICultureBinder(\"titleResource\");\r\n_Field.prototype.descriptionResource = getValueForUICultureBinder(\"descriptionResource\");\r\n","import { _ContentType } from \"../content-types/types\";\r\nimport { getValueForUICultureBinder } from \"./funcs\";\r\nimport { IUserResources } from \"./types\";\r\n\r\ndeclare module \"../content-types/types\" {\r\n    interface _ContentType extends IUserResources {}\r\n    interface IContentType extends IUserResources {}\r\n}\r\n\r\n_ContentType.prototype.titleResource = getValueForUICultureBinder(\"titleResource\");\r\n_ContentType.prototype.descriptionResource = getValueForUICultureBinder(\"descriptionResource\");\r\n","import { _SharePointQueryable, ISharePointQueryable } from \"../sharepointqueryable\";\r\nimport { extractWebUrl } from \"../utils/extractweburl\";\r\nimport { defaultPath } from \"../decorators\";\r\nimport { spPost } from \"../operations\";\r\nimport { body } from \"@pnp/odata\";\r\nimport { tag } from \"../telemetry\";\r\n\r\n@defaultPath(\"_api/SP.RelatedItemManager\")\r\nexport class _RelatedItemManager extends _SharePointQueryable implements IRelatedItemManager {\r\n\r\n    @tag(\"rim.getRelatedItems\")\r\n    public getRelatedItems(sourceListName: string, sourceItemId: number): Promise<IRelatedItem[]> {\r\n\r\n        const query = this.clone(<any>RelatedItemManager, null);\r\n        query.concat(\".GetRelatedItems\");\r\n\r\n        return spPost(query, body({\r\n            SourceItemID: sourceItemId,\r\n            SourceListName: sourceListName,\r\n        }));\r\n    }\r\n\r\n    @tag(\"rim.getPageOneRelatedItems\")\r\n    public getPageOneRelatedItems(sourceListName: string, sourceItemId: number): Promise<IRelatedItem[]> {\r\n\r\n        const query = this.clone(<any>RelatedItemManager, null);\r\n        query.concat(\".GetPageOneRelatedItems\");\r\n\r\n        return spPost(query, body({\r\n            SourceItemID: sourceItemId,\r\n            SourceListName: sourceListName,\r\n        }));\r\n    }\r\n\r\n    @tag(\"rim.addSingleLink\")\r\n    public addSingleLink(sourceListName: string,\r\n        sourceItemId: number,\r\n        sourceWebUrl: string,\r\n        targetListName: string,\r\n        targetItemID: number,\r\n        targetWebUrl: string,\r\n        tryAddReverseLink = false): Promise<void> {\r\n\r\n        const query = this.clone(<any>RelatedItemManager, null);\r\n        query.concat(\".AddSingleLink\");\r\n\r\n        return spPost(query, body({\r\n            SourceItemID: sourceItemId,\r\n            SourceListName: sourceListName,\r\n            SourceWebUrl: sourceWebUrl,\r\n            TargetItemID: targetItemID,\r\n            TargetListName: targetListName,\r\n            TargetWebUrl: targetWebUrl,\r\n            TryAddReverseLink: tryAddReverseLink,\r\n        }));\r\n    }\r\n\r\n    @tag(\"rim.ToUrl\")\r\n    public addSingleLinkToUrl(sourceListName: string, sourceItemId: number, targetItemUrl: string, tryAddReverseLink = false): Promise<void> {\r\n\r\n        const query = this.clone(<any>RelatedItemManager, null);\r\n        query.concat(\".AddSingleLinkToUrl\");\r\n\r\n        return spPost(query, body({\r\n            SourceItemID: sourceItemId,\r\n            SourceListName: sourceListName,\r\n            TargetItemUrl: targetItemUrl,\r\n            TryAddReverseLink: tryAddReverseLink,\r\n        }));\r\n    }\r\n\r\n    @tag(\"rim.FromUrl\")\r\n    public addSingleLinkFromUrl(sourceItemUrl: string, targetListName: string, targetItemId: number, tryAddReverseLink = false): Promise<void> {\r\n\r\n        const query = this.clone(<any>RelatedItemManager, null);\r\n        query.concat(\".AddSingleLinkFromUrl\");\r\n\r\n        return spPost(query, body({\r\n            SourceItemUrl: sourceItemUrl,\r\n            TargetItemID: targetItemId,\r\n            TargetListName: targetListName,\r\n            TryAddReverseLink: tryAddReverseLink,\r\n        }));\r\n    }\r\n\r\n    @tag(\"rim.deleteSingleLink\")\r\n    public deleteSingleLink(sourceListName: string,\r\n        sourceItemId: number,\r\n        sourceWebUrl: string,\r\n        targetListName: string,\r\n        targetItemId: number,\r\n        targetWebUrl: string,\r\n        tryDeleteReverseLink = false): Promise<void> {\r\n\r\n        const query = this.clone(<any>RelatedItemManager, null);\r\n        query.concat(\".DeleteSingleLink\");\r\n\r\n        return spPost(query, body({\r\n            SourceItemID: sourceItemId,\r\n            SourceListName: sourceListName,\r\n            SourceWebUrl: sourceWebUrl,\r\n            TargetItemID: targetItemId,\r\n            TargetListName: targetListName,\r\n            TargetWebUrl: targetWebUrl,\r\n            TryDeleteReverseLink: tryDeleteReverseLink,\r\n        }));\r\n    }\r\n}\r\n\r\nexport interface IRelatedItemManager {\r\n\r\n    /**\r\n     * Gets all the related items for the given item specification\r\n     * \r\n     * @param sourceListName The list name or list id\r\n     * @param sourceItemId The item id\r\n     */\r\n    getRelatedItems(sourceListName: string, sourceItemId: number): Promise<IRelatedItem[]>;\r\n\r\n    /**\r\n     * Gets the first page of related items for the given item specification\r\n     * \r\n     * @param sourceListName The list name or list id\r\n     * @param sourceItemId The item id\r\n     */\r\n    getPageOneRelatedItems(sourceListName: string, sourceItemId: number): Promise<IRelatedItem[]>;\r\n\r\n    /**\r\n     * Adds a single link using full specifications for source and target\r\n     * \r\n     * @param sourceListName The source list name or list id\r\n     * @param sourceItemId The source item id\r\n     * @param sourceWebUrl The source web absolute url\r\n     * @param targetListName The target list name or list id\r\n     * @param targetItemID The target item id\r\n     * @param targetWebUrl The target web absolute url\r\n     * @param tryAddReverseLink If set to true try to add the reverse link (will not return error if it fails)\r\n     */\r\n    addSingleLink(sourceListName: string,\r\n        sourceItemId: number,\r\n        sourceWebUrl: string,\r\n        targetListName: string,\r\n        targetItemID: number,\r\n        targetWebUrl: string,\r\n        tryAddReverseLink?: boolean): Promise<void>;\r\n\r\n    /**\r\n     * Adds a related item link from an item specified by list name and item id, to an item specified by url\r\n     *\r\n     * @param sourceListName The source list name or list id\r\n     * @param sourceItemId The source item id\r\n     * @param targetItemUrl The target item url\r\n     * @param tryAddReverseLink If set to true try to add the reverse link (will not return error if it fails)\r\n     */\r\n    addSingleLinkToUrl(sourceListName: string, sourceItemId: number, targetItemUrl: string, tryAddReverseLink?: boolean): Promise<void>;\r\n\r\n    /**\r\n     * Adds a related item link from an item specified by url, to an item specified by list name and item id\r\n     *\r\n     * @param sourceItemUrl The source item url\r\n     * @param targetListName The target list name or list id\r\n     * @param targetItemId The target item id\r\n     * @param tryAddReverseLink If set to true try to add the reverse link (will not return error if it fails)\r\n     */\r\n    addSingleLinkFromUrl(sourceItemUrl: string, targetListName: string, targetItemId: number, tryAddReverseLink?: boolean): Promise<void>;\r\n\r\n    /**\r\n     * Deletes a single link\r\n     * \r\n     * @param sourceListName \r\n     * @param sourceItemId \r\n     * @param sourceWebUrl \r\n     * @param targetListName \r\n     * @param targetItemId \r\n     * @param targetWebUrl \r\n     * @param tryDeleteReverseLink \r\n     */\r\n    deleteSingleLink(sourceListName: string,\r\n        sourceItemId: number,\r\n        sourceWebUrl: string,\r\n        targetListName: string,\r\n        targetItemId: number,\r\n        targetWebUrl: string,\r\n        tryDeleteReverseLink?: boolean): Promise<void>;\r\n}\r\n\r\nexport const RelatedItemManager = (url: string | ISharePointQueryable): IRelatedItemManager => new _RelatedItemManager(extractWebUrl(typeof url === \"string\" ? url : url.toUrl()));\r\n\r\nexport interface IRelatedItem {\r\n    ListId: string;\r\n    ItemId: number;\r\n    Url: string;\r\n    Title: string;\r\n    WebId: string;\r\n    IconUrl: string;\r\n}\r\n","import { _SharePointQueryableInstance, ISharePointQueryable } from \"../sharepointqueryable\";\r\nimport { assign, hOP, getHashCode, objectDefinedNotNull, isArray, IConfigOptions } from \"@pnp/common\";\r\nimport { metadata } from \"../utils/metadata\";\r\nimport { CachingOptions, body } from \"@pnp/odata\";\r\nimport { ISearchQuery, ISearchResponse, ISearchResult, ISearchBuilder, SearchQueryInit } from \"./types\";\r\nimport { spPost } from \"../operations\";\r\nimport { defaultPath } from \"../decorators\";\r\nimport { tag } from \"../telemetry\";\r\n\r\nconst funcs = new Map<string, string>([\r\n    [\"text\", \"Querytext\"],\r\n    [\"template\", \"QueryTemplate\"],\r\n    [\"sourceId\", \"SourceId\"],\r\n    [\"trimDuplicatesIncludeId\", \"\"],\r\n    [\"startRow\", \"\"],\r\n    [\"rowLimit\", \"\"],\r\n    [\"rankingModelId\", \"\"],\r\n    [\"rowsPerPage\", \"\"],\r\n    [\"selectProperties\", \"\"],\r\n    [\"culture\", \"\"],\r\n    [\"timeZoneId\", \"\"],\r\n    [\"refinementFilters\", \"\"],\r\n    [\"refiners\", \"\"],\r\n    [\"hiddenConstraints\", \"\"],\r\n    [\"sortList\", \"\"],\r\n    [\"timeout\", \"\"],\r\n    [\"hithighlightedProperties\", \"\"],\r\n    [\"clientType\", \"\"],\r\n    [\"personalizationData\", \"\"],\r\n    [\"resultsURL\", \"\"],\r\n    [\"queryTag\", \"\"],\r\n    [\"properties\", \"\"],\r\n    [\"queryTemplatePropertiesUrl\", \"\"],\r\n    [\"reorderingRules\", \"\"],\r\n    [\"hitHighlightedMultivaluePropertyLimit\", \"\"],\r\n    [\"collapseSpecification\", \"\"],\r\n    [\"uiLanguage\", \"\"],\r\n    [\"desiredSnippetLength\", \"\"],\r\n    [\"maxSnippetLength\", \"\"],\r\n    [\"summaryLength\", \"\"],\r\n]);\r\n\r\nconst props = new Map<string, string>([]);\r\n\r\nfunction toPropCase(str: string) {\r\n    return str.replace(/^(.)/, ($1) => $1.toUpperCase());\r\n}\r\n\r\n/**\r\n * Creates a new instance of the SearchQueryBuilder\r\n * \r\n * @param queryText Initial query text\r\n * @param _query Any initial query configuration\r\n */\r\nexport function SearchQueryBuilder(queryText = \"\", _query = {}): ISearchBuilder {\r\n\r\n    return new Proxy(<any>{\r\n        query: Object.assign({\r\n            Querytext: queryText,\r\n        }, _query),\r\n    },\r\n        {\r\n            get(self, propertyKey, proxy) {\r\n\r\n                const pk = propertyKey.toString();\r\n\r\n                if (pk === \"toSearchQuery\") {\r\n                    return () => self.query;\r\n                }\r\n\r\n                if (funcs.has(pk)) {\r\n                    return (...value: any[]) => {\r\n                        const mappedPk = funcs.get(pk);\r\n                        self.query[mappedPk.length > 0 ? mappedPk : toPropCase(pk)] = value.length > 1 ? value : value[0];\r\n                        return proxy;\r\n                    };\r\n                }\r\n                const propKey = props.has(pk) ? props.get(pk) : toPropCase(pk);\r\n                self.query[propKey] = true;\r\n                return proxy;\r\n            },\r\n        });\r\n}\r\n\r\nconst queryRegex = /_api\\/search\\/postquery$/i;\r\n\r\n/**\r\n * Describes the search API\r\n *\r\n */\r\n@defaultPath(\"_api/search/postquery\")\r\nexport class _Search extends _SharePointQueryableInstance {\r\n\r\n    /**\r\n     * @returns Promise\r\n     */\r\n    @tag(\"se.execute\")\r\n    public async execute(queryInit: SearchQueryInit): Promise<SearchResults> {\r\n\r\n        const query = this.parseQuery(queryInit);\r\n\r\n        const postBody = body({\r\n            request: assign(\r\n                metadata(\"Microsoft.Office.Server.Search.REST.SearchRequest\"),\r\n                Object.assign(\r\n                    {},\r\n                    query,\r\n                    {\r\n                        HitHighlightedProperties: this.fixArrProp(query.HitHighlightedProperties),\r\n                        Properties: this.fixArrProp(query.Properties),\r\n                        RefinementFilters: this.fixArrProp(query.RefinementFilters),\r\n                        ReorderingRules: this.fixArrProp(query.ReorderingRules),\r\n                        SelectProperties: this.fixArrProp(query.SelectProperties),\r\n                        SortList: this.fixArrProp(query.SortList),\r\n                    })),\r\n        });\r\n\r\n        // if we are using caching with this search request, then we need to handle some work upfront to enable that\r\n        if (this.data.useCaching) {\r\n\r\n            // force use of the cache for this request if .usingCaching was called\r\n            this._forceCaching = true;\r\n\r\n            // because all the requests use the same url they would collide in the cache we use a special key\r\n            const cacheKey = `PnPjs.SearchWithCaching(${getHashCode(postBody.body)})`;\r\n\r\n            if (objectDefinedNotNull(this.data.cachingOptions)) {\r\n                // if our key ends in the postquery url we overwrite it\r\n                if (queryRegex.test(this.data.cachingOptions.key)) {\r\n                    this.data.cachingOptions.key = cacheKey;\r\n                }\r\n            } else {\r\n                this.data.cachingOptions = new CachingOptions(cacheKey);\r\n            }\r\n        }\r\n\r\n        const data = await spPost(this, postBody);\r\n        return new SearchResults(data, this.toUrl(), query);\r\n    }\r\n\r\n    /**\r\n     * Fix array property\r\n     *\r\n     * @param prop property to fix for container struct\r\n     */\r\n    private fixArrProp(prop: any): { results: any[] } {\r\n        if (typeof prop === \"undefined\") {\r\n            return ({ results: [] });\r\n        }\r\n\r\n        return { results: isArray(prop) ? prop : [prop] };\r\n    }\r\n\r\n    /**\r\n     * Translates one of the query initializers into a SearchQuery instance\r\n     * \r\n     * @param query \r\n     */\r\n    private parseQuery(query: SearchQueryInit): ISearchQuery {\r\n\r\n        let finalQuery: ISearchQuery;\r\n\r\n        if (typeof query === \"string\") {\r\n            finalQuery = { Querytext: query };\r\n        } else if ((query as ISearchBuilder).toSearchQuery) {\r\n            finalQuery = (query as ISearchBuilder).toSearchQuery();\r\n        } else {\r\n            finalQuery = <ISearchQuery>query;\r\n        }\r\n\r\n        return finalQuery;\r\n    }\r\n}\r\n\r\nexport interface ISearch {\r\n    (queryInit: SearchQueryInit): Promise<SearchResults>;\r\n}\r\n\r\nexport const Search = (baseUrl: string | ISharePointQueryable, options: IConfigOptions = {}): ISearch => (queryInit: SearchQueryInit) => {\r\n    return (new _Search(baseUrl)).configure(options).execute(queryInit);\r\n};\r\n\r\nexport class SearchResults {\r\n\r\n    constructor(rawResponse: any,\r\n        private _url: string,\r\n        private _query: ISearchQuery,\r\n        private _raw: ISearchResponse = null,\r\n        private _primary: ISearchResult[] = null) {\r\n\r\n        this._url = this._url.replace(queryRegex, \"\");\r\n        this._raw = rawResponse.postquery ? rawResponse.postquery : rawResponse;\r\n    }\r\n\r\n    public get ElapsedTime(): number {\r\n        return this?.RawSearchResults?.ElapsedTime || 0;\r\n    }\r\n\r\n    public get RowCount(): number {\r\n        return this?.RawSearchResults?.PrimaryQueryResult?.RelevantResults?.RowCount || 0;\r\n    }\r\n\r\n    public get TotalRows(): number {\r\n        return this?.RawSearchResults?.PrimaryQueryResult?.RelevantResults?.TotalRows || 0;\r\n    }\r\n\r\n    public get TotalRowsIncludingDuplicates(): number {\r\n        return this?.RawSearchResults?.PrimaryQueryResult?.RelevantResults?.TotalRowsIncludingDuplicates || 0;\r\n    }\r\n\r\n    public get RawSearchResults(): ISearchResponse {\r\n        return this._raw;\r\n    }\r\n\r\n    public get PrimarySearchResults(): ISearchResult[] {\r\n        if (this._primary === null) {\r\n            this._primary = this.formatSearchResults(this._raw?.PrimaryQueryResult?.RelevantResults?.Table?.Rows || null);\r\n        }\r\n        return this._primary;\r\n    }\r\n\r\n    /**\r\n     * Gets a page of results\r\n     *\r\n     * @param pageNumber Index of the page to return. Used to determine StartRow\r\n     * @param pageSize Optional, items per page (default = 10)\r\n     */\r\n    public getPage(pageNumber: number, pageSize?: number): Promise<SearchResults> {\r\n\r\n        // if we got all the available rows we don't have another page\r\n        if (this.TotalRows < this.RowCount) {\r\n            return Promise.resolve(null);\r\n        }\r\n\r\n        // if pageSize is supplied, then we use that regardless of any previous values\r\n        // otherwise get the previous RowLimit or default to 10\r\n        const rows = pageSize !== undefined ? pageSize : hOP(this._query, \"RowLimit\") ? this._query.RowLimit : 10;\r\n\r\n        const query: ISearchQuery = assign(this._query, {\r\n            RowLimit: rows,\r\n            StartRow: rows * (pageNumber - 1),\r\n        });\r\n\r\n        // we have reached the end\r\n        if (query.StartRow > this.TotalRows) {\r\n            return Promise.resolve(null);\r\n        }\r\n\r\n        return Search(this._url)(query);\r\n    }\r\n\r\n    /**\r\n     * Formats a search results array\r\n     *\r\n     * @param rawResults The array to process\r\n     */\r\n    protected formatSearchResults(rawResults: any): ISearchResult[] {\r\n\r\n        const results = new Array<ISearchResult>();\r\n\r\n        if (typeof (rawResults) === \"undefined\" || rawResults == null) {\r\n            return [];\r\n        }\r\n\r\n        const tempResults = rawResults.results ? rawResults.results : rawResults;\r\n\r\n        for (const tempResult of tempResults) {\r\n\r\n            const cells: { Key: string, Value: any }[] = tempResult.Cells.results ? tempResult.Cells.results : tempResult.Cells;\r\n\r\n            results.push(cells.reduce((res, cell) => {\r\n\r\n                Reflect.defineProperty(res, cell.Key,\r\n                    {\r\n                        configurable: false,\r\n                        enumerable: true,\r\n                        value: cell.Value,\r\n                        writable: false,\r\n                    });\r\n\r\n                return res;\r\n\r\n            }, {}));\r\n        }\r\n\r\n        return results;\r\n    }\r\n}\r\n","export type SearchQueryInit = string | ISearchQuery | ISearchBuilder;\r\n\r\nexport interface ISearchBuilder {\r\n    query: any;\r\n    readonly bypassResultTypes: this;\r\n    readonly enableStemming: this;\r\n    readonly enableInterleaving: this;\r\n    readonly enableFql: this;\r\n    readonly enableNicknames: this;\r\n    readonly enablePhonetic: this;\r\n    readonly trimDuplicates: this;\r\n    readonly processBestBets: this;\r\n    readonly enableQueryRules: this;\r\n    readonly enableSorting: this;\r\n    readonly generateBlockRankLog: this;\r\n    readonly processPersonalFavorites: this;\r\n    readonly enableOrderingHitHighlightedProperty: this;\r\n\r\n    culture(culture: number): this;\r\n    rowLimit(n: number): this;\r\n    startRow(n: number): this;\r\n    sourceId(id: string): this;\r\n    text(queryText: string): this;\r\n    template(template: string): this;\r\n    trimDuplicatesIncludeId(n: number): this;\r\n    rankingModelId(id: string): this;\r\n    rowsPerPage(n: number): this;\r\n    selectProperties(...properties: string[]): this;\r\n    timeZoneId(id: number): this;\r\n    refinementFilters(...filters: string[]): this;\r\n    refiners(refiners: string): this;\r\n    hiddenConstraints(constraints: string): this;\r\n    sortList(...sorts: ISort[]): this;\r\n    timeout(milliseconds: number): this;\r\n    hithighlightedProperties(...properties: string[]): this;\r\n    clientType(clientType: string): this;\r\n    personalizationData(data: string): this;\r\n    resultsURL(url: string): this;\r\n    queryTag(tags: string): this;\r\n    properties(...properties: ISearchProperty[]): this;\r\n    queryTemplatePropertiesUrl(url: string): this;\r\n    reorderingRules(...rules: IReorderingRule[]): this;\r\n    hitHighlightedMultivaluePropertyLimit(limit: number): this;\r\n    collapseSpecification(spec: string): this;\r\n    uiLanguage(lang: number): this;\r\n    desiredSnippetLength(len: number): this;\r\n    maxSnippetLength(len: number): this;\r\n    summaryLength(len: number): this;\r\n\r\n    /* included method */\r\n    toSearchQuery(): ISearchQuery;\r\n}\r\n\r\n/**\r\n * Describes the SearchQuery interface\r\n */\r\nexport interface ISearchQuery {\r\n\r\n    /**\r\n     * A string that contains the text for the search query.\r\n     */\r\n    Querytext?: string;\r\n\r\n    /**\r\n     * A string that contains the text that replaces the query text, as part of a query transform.\r\n     */\r\n    QueryTemplate?: string;\r\n\r\n    /**\r\n     * A Boolean value that specifies whether the result tables that are returned for\r\n     * the result block are mixed with the result tables that are returned for the original query.\r\n     */\r\n    EnableInterleaving?: boolean;\r\n\r\n    /**\r\n     * A Boolean value that specifies whether stemming is enabled.\r\n     */\r\n    EnableStemming?: boolean;\r\n\r\n    /**\r\n     * A Boolean value that specifies whether duplicate items are removed from the results.\r\n     */\r\n    TrimDuplicates?: boolean;\r\n\r\n    /**\r\n     * A Boolean value that specifies whether the exact terms in the search query are used to find matches, or if nicknames are used also.\r\n     */\r\n    EnableNicknames?: boolean;\r\n\r\n    /**\r\n     * A Boolean value that specifies whether the query uses the FAST Query Language (FQL).\r\n     */\r\n    EnableFQL?: boolean;\r\n\r\n    /**\r\n     * A Boolean value that specifies whether the phonetic forms of the query terms are used to find matches.\r\n     */\r\n    EnablePhonetic?: boolean;\r\n\r\n    /**\r\n     * A Boolean value that specifies whether to perform result type processing for the query.\r\n     */\r\n    BypassResultTypes?: boolean;\r\n\r\n    /**\r\n     * A Boolean value that specifies whether to return best bet results for the query.\r\n     * This parameter is used only when EnableQueryRules is set to true, otherwise it is ignored.\r\n     */\r\n    ProcessBestBets?: boolean;\r\n\r\n    /**\r\n     * A Boolean value that specifies whether to enable query rules for the query.\r\n     */\r\n    EnableQueryRules?: boolean;\r\n\r\n    /**\r\n     * A Boolean value that specifies whether to sort search results.\r\n     */\r\n    EnableSorting?: boolean;\r\n\r\n    /**\r\n     * Specifies whether to return block rank log information in the BlockRankLog property of the interleaved result table.\r\n     * A block rank log contains the textual information on the block score and the documents that were de-duplicated.\r\n     */\r\n    GenerateBlockRankLog?: boolean;\r\n\r\n    /**\r\n     * The result source ID to use for executing the search query.\r\n     */\r\n    SourceId?: string;\r\n\r\n    /**\r\n     * The ID of the ranking model to use for the query.\r\n     */\r\n    RankingModelId?: string;\r\n\r\n    /**\r\n     * The first row that is included in the search results that are returned.\r\n     * You use this parameter when you want to implement paging for search results.\r\n     */\r\n    StartRow?: number;\r\n\r\n    /**\r\n     * The maximum number of rows overall that are returned in the search results.\r\n     * Compared to RowsPerPage, RowLimit is the maximum number of rows returned overall.\r\n     */\r\n    RowLimit?: number;\r\n\r\n    /**\r\n     * The maximum number of rows to return per page.\r\n     * Compared to RowLimit, RowsPerPage refers to the maximum number of rows to return per page,\r\n     * and is used primarily when you want to implement paging for search results.\r\n     */\r\n    RowsPerPage?: number;\r\n\r\n    /**\r\n     * The managed properties to return in the search results.\r\n     */\r\n    SelectProperties?: string[];\r\n\r\n    /**\r\n     * The locale ID (LCID) for the query.\r\n     */\r\n    Culture?: number;\r\n\r\n    /**\r\n     * The set of refinement filters used when issuing a refinement query (FQL)\r\n     */\r\n    RefinementFilters?: string[];\r\n\r\n    /**\r\n     * The set of refiners to return in a search result.\r\n     */\r\n    Refiners?: string;\r\n\r\n    /**\r\n     * The additional query terms to append to the query.\r\n     */\r\n    HiddenConstraints?: string;\r\n\r\n    /**\r\n     * The list of properties by which the search results are ordered.\r\n     */\r\n    SortList?: ISort[];\r\n\r\n    /**\r\n     * The amount of time in milliseconds before the query request times out.\r\n     */\r\n    Timeout?: number;\r\n\r\n    /**\r\n     * The properties to highlight in the search result summary when the property value matches the search terms entered by the user.\r\n     */\r\n    HitHighlightedProperties?: string[];\r\n\r\n    /**\r\n     * The type of the client that issued the query.\r\n     */\r\n    ClientType?: string;\r\n\r\n    /**\r\n     * The GUID for the user who submitted the search query.\r\n     */\r\n    PersonalizationData?: string;\r\n\r\n    /**\r\n     * The URL for the search results page.\r\n     */\r\n    ResultsUrl?: string;\r\n\r\n    /**\r\n     * Custom tags that identify the query. You can specify multiple query tags\r\n     */\r\n    QueryTag?: string;\r\n\r\n    /**\r\n     * Properties to be used to configure the search query\r\n     */\r\n    Properties?: ISearchProperty[];\r\n\r\n    /**\r\n     *  A Boolean value that specifies whether to return personal favorites with the search results.\r\n     */\r\n    ProcessPersonalFavorites?: boolean;\r\n\r\n    /**\r\n     * The location of the queryparametertemplate.xml file. This file is used to enable anonymous users to make Search REST queries.\r\n     */\r\n    QueryTemplatePropertiesUrl?: string;\r\n\r\n    /**\r\n     * Special rules for reordering search results.\r\n     * These rules can specify that documents matching certain conditions are ranked higher or lower in the results.\r\n     * This property applies only when search results are sorted based on rank.\r\n     */\r\n    ReorderingRules?: IReorderingRule[];\r\n\r\n    /**\r\n     * The number of properties to show hit highlighting for in the search results.\r\n     */\r\n    HitHighlightedMultivaluePropertyLimit?: number;\r\n\r\n    /**\r\n     * A Boolean value that specifies whether the hit highlighted properties can be ordered.\r\n     */\r\n    EnableOrderingHitHighlightedProperty?: boolean;\r\n\r\n    /**\r\n     * The managed properties that are used to determine how to collapse individual search results.\r\n     * Results are collapsed into one or a specified number of results if they match any of the individual collapse specifications.\r\n     * In a collapse specification, results are collapsed if their properties match all individual properties in the collapse specification.\r\n     */\r\n    CollapseSpecification?: string;\r\n\r\n    /**\r\n     * The locale identifier (LCID) of the user interface\r\n     */\r\n    UIlanguage?: number;\r\n\r\n    /**\r\n     * The preferred number of characters to display in the hit-highlighted summary generated for a search result.\r\n     */\r\n    DesiredSnippetLength?: number;\r\n\r\n    /**\r\n     * The maximum number of characters to display in the hit-highlighted summary generated for a search result.\r\n     */\r\n    MaxSnippetLength?: number;\r\n\r\n    /**\r\n     * The number of characters to display in the result summary for a search result.\r\n     */\r\n    SummaryLength?: number;\r\n\r\n}\r\n\r\n/**\r\n * Provides hints at the properties which may be available on the result object\r\n */\r\nexport interface ISearchResult {\r\n\r\n    Rank?: number;\r\n    DocId?: number;\r\n    WorkId?: number;\r\n    Title?: string;\r\n    Author?: string;\r\n    Size?: number;\r\n    Path?: string;\r\n    Description?: string;\r\n    Write?: Date;\r\n    LastModifiedTime?: Date;\r\n    CollapsingStatus?: number;\r\n    HitHighlightedSummary?: string;\r\n    HitHighlightedProperties?: string;\r\n    contentclass?: string;\r\n    PictureThumbnailURL?: string;\r\n    ServerRedirectedURL?: string;\r\n    ServerRedirectedEmbedURL?: string;\r\n    ServerRedirectedPreviewURL?: string;\r\n    FileExtension?: string;\r\n    ContentTypeId?: string;\r\n    ParentLink?: string;\r\n    ViewsLifeTime?: number;\r\n    ViewsRecent?: number;\r\n    SectionNames?: string;\r\n    SectionIndexes?: string;\r\n    SiteLogo?: string;\r\n    SiteDescription?: string;\r\n    importance?: number;\r\n    SiteName?: string;\r\n    IsDocument?: boolean;\r\n    FileType?: string;\r\n    IsContainer?: boolean;\r\n    WebTemplate?: string;\r\n    SPWebUrl?: string;\r\n    UniqueId?: string;\r\n    ProgId?: string;\r\n    OriginalPath?: string;\r\n    RenderTemplateId?: string;\r\n    PartitionId?: string;\r\n    UrlZone?: number;\r\n    Culture?: string;\r\n}\r\n\r\nexport interface ISearchResponse {\r\n    ElapsedTime: number;\r\n    Properties?: { Key: string, Value: any, ValueType: string }[];\r\n    PrimaryQueryResult?: IResultTableCollection;\r\n    SecondaryQueryResults?: IResultTableCollection;\r\n    SpellingSuggestion?: string;\r\n    TriggeredRules?: any[];\r\n}\r\n\r\nexport interface IResultTableCollection {\r\n\r\n    QueryErrors?: Map<string, any>;\r\n    QueryId?: string;\r\n    QueryRuleId?: string;\r\n    CustomResults?: IResultTable;\r\n    RefinementResults?: IResultTable;\r\n    RelevantResults?: IResultTable;\r\n    SpecialTermResults?: IResultTable;\r\n}\r\n\r\nexport interface IRefiner {\r\n    Name: string;\r\n    Entries: { RefinementCount: string; RefinementName: string; RefinementToken: string; RefinementValue: string; }[];\r\n}\r\n\r\nexport interface IResultTable {\r\n    GroupTemplateId?: string;\r\n    ItemTemplateId?: string;\r\n    Properties?: { Key: string, Value: any, ValueType: string }[];\r\n    Table?: { Rows: { Cells: { Key: string, Value: any, ValueType: string }[] }[] };\r\n    Refiners?: IRefiner[];\r\n    ResultTitle?: string;\r\n    ResultTitleUrl?: string;\r\n    RowCount?: number;\r\n    TableType?: string;\r\n    TotalRows?: number;\r\n    TotalRowsIncludingDuplicates?: number;\r\n}\r\n\r\n/**\r\n * Defines how search results are sorted.\r\n */\r\nexport interface ISort {\r\n\r\n    /**\r\n     * The name for a property by which the search results are ordered.\r\n     */\r\n    Property: string;\r\n\r\n    /**\r\n     * The direction in which search results are ordered.\r\n     */\r\n    Direction: SortDirection;\r\n}\r\n\r\n/**\r\n * Defines one search property\r\n */\r\nexport interface ISearchProperty {\r\n    Name: string;\r\n    Value: ISearchPropertyValue;\r\n}\r\n\r\n/**\r\n * Defines one search property value. Set only one of StrlVal/BoolVal/IntVal/StrArray.\r\n */\r\nexport interface ISearchPropertyValue {\r\n    StrVal?: string;\r\n    BoolVal?: boolean;\r\n    IntVal?: number;\r\n    StrArray?: string[];\r\n    QueryPropertyValueTypeIndex: QueryPropertyValueType;\r\n}\r\n\r\n/**\r\n * defines the SortDirection enum\r\n */\r\nexport enum SortDirection {\r\n    Ascending = 0,\r\n    Descending = 1,\r\n    FQLFormula = 2,\r\n}\r\n\r\n/**\r\n * Defines how ReorderingRule interface, used for reordering results\r\n */\r\nexport interface IReorderingRule {\r\n\r\n    /**\r\n     * The value to match on\r\n     */\r\n    MatchValue: string;\r\n\r\n    /**\r\n     * The rank boosting\r\n     */\r\n    Boost: number;\r\n\r\n    /**\r\n    * The rank boosting\r\n    */\r\n    MatchType: ReorderingRuleMatchType;\r\n}\r\n\r\n/**\r\n * defines the ReorderingRuleMatchType  enum\r\n */\r\nexport enum ReorderingRuleMatchType {\r\n    ResultContainsKeyword = 0,\r\n    TitleContainsKeyword = 1,\r\n    TitleMatchesKeyword = 2,\r\n    UrlStartsWith = 3,\r\n    UrlExactlyMatches = 4,\r\n    ContentTypeIs = 5,\r\n    FileExtensionMatches = 6,\r\n    ResultHasTag = 7,\r\n    ManualCondition = 8,\r\n}\r\n\r\n/**\r\n * Specifies the type value for the property\r\n */\r\nexport enum QueryPropertyValueType {\r\n    None = 0,\r\n    StringType = 1,\r\n    Int32Type = 2,\r\n    BooleanType = 3,\r\n    StringArrayType = 4,\r\n    UnSupportedType = 5,\r\n}\r\n\r\nexport class SearchBuiltInSourceId {\r\n    public static readonly Documents = \"e7ec8cee-ded8-43c9-beb5-436b54b31e84\";\r\n    public static readonly ItemsMatchingContentType = \"5dc9f503-801e-4ced-8a2c-5d1237132419\";\r\n    public static readonly ItemsMatchingTag = \"e1327b9c-2b8c-4b23-99c9-3730cb29c3f7\";\r\n    public static readonly ItemsRelatedToCurrentUser = \"48fec42e-4a92-48ce-8363-c2703a40e67d\";\r\n    public static readonly ItemsWithSameKeywordAsThisItem = \"5c069288-1d17-454a-8ac6-9c642a065f48\";\r\n    public static readonly LocalPeopleResults = \"b09a7990-05ea-4af9-81ef-edfab16c4e31\";\r\n    public static readonly LocalReportsAndDataResults = \"203fba36-2763-4060-9931-911ac8c0583b\";\r\n    public static readonly LocalSharePointResults = \"8413cd39-2156-4e00-b54d-11efd9abdb89\";\r\n    public static readonly LocalVideoResults = \"78b793ce-7956-4669-aa3b-451fc5defebf\";\r\n    public static readonly Pages = \"5e34578e-4d08-4edc-8bf3-002acf3cdbcc\";\r\n    public static readonly Pictures = \"38403c8c-3975-41a8-826e-717f2d41568a\";\r\n    public static readonly Popular = \"97c71db1-58ce-4891-8b64-585bc2326c12\";\r\n    public static readonly RecentlyChangedItems = \"ba63bbae-fa9c-42c0-b027-9a878f16557c\";\r\n    public static readonly RecommendedItems = \"ec675252-14fa-4fbe-84dd-8d098ed74181\";\r\n    public static readonly Wiki = \"9479bf85-e257-4318-b5a8-81a180f5faa1\";\r\n}\r\n","import { _SharePointQueryableInstance, ISharePointQueryable } from \"../sharepointqueryable\";\r\nimport { hOP, IConfigOptions } from \"@pnp/common\";\r\nimport { defaultPath } from \"../decorators\";\r\nimport { tag } from \"../telemetry\";\r\n\r\n@defaultPath(\"_api/search/suggest\")\r\nexport class _Suggest extends _SharePointQueryableInstance {\r\n\r\n    @tag(\"su.execute\")\r\n    public async execute(query: ISuggestQuery): Promise<ISuggestResult> {\r\n\r\n        this.mapQueryToQueryString(query);\r\n\r\n        const response = await this.get();\r\n        const mapper = hOP(response, \"suggest\") ? (s_1: string) => response.suggest[s_1].results : (s_2: string) => response[s_2];\r\n\r\n        return {\r\n            PeopleNames: mapper(\"PeopleNames\"),\r\n            PersonalResults: mapper(\"PersonalResults\"),\r\n            Queries: mapper(\"Queries\"),\r\n        };\r\n    }\r\n\r\n    private mapQueryToQueryString(query: ISuggestQuery): void {\r\n\r\n        const setProp = (q: ISuggestQuery) => (checkProp: string) => (sp: string) => {\r\n            if (hOP(q, checkProp)) {\r\n                this.query.set(sp, q[checkProp].toString());\r\n            }\r\n        };\r\n\r\n        this.query.set(\"querytext\", `'${query.querytext}'`);\r\n\r\n        const querySetter = setProp(query);\r\n\r\n        querySetter(\"count\")(\"inumberofquerysuggestions\");\r\n        querySetter(\"personalCount\")(\"inumberofresultsuggestions\");\r\n        querySetter(\"preQuery\")(\"fprequerysuggestions\");\r\n        querySetter(\"hitHighlighting\")(\"fhithighlighting\");\r\n        querySetter(\"capitalize\")(\"fcapitalizefirstletters\");\r\n        querySetter(\"culture\")(\"culture\");\r\n        querySetter(\"stemming\")(\"enablestemming\");\r\n        querySetter(\"includePeople\")(\"showpeoplenamesuggestions\");\r\n        querySetter(\"queryRules\")(\"enablequeryrules\");\r\n        querySetter(\"prefixMatch\")(\"fprefixmatchallterms\");\r\n    }\r\n}\r\n\r\nexport interface ISuggest {\r\n    (query: ISuggestQuery): Promise<ISuggestResult>;\r\n}\r\n\r\nexport const Suggest = (baseUrl: string | ISharePointQueryable, options: IConfigOptions = {}): ISuggest => (query: ISuggestQuery) => {\r\n    return (new _Suggest(baseUrl)).configure(options).execute(query);\r\n};\r\n\r\n/**\r\n * Defines a query execute against the search/suggest endpoint (see https://msdn.microsoft.com/en-us/library/office/dn194079.aspx)\r\n */\r\nexport interface ISuggestQuery {\r\n\r\n    [key: string]: string | number | boolean;\r\n\r\n    /**\r\n     * A string that contains the text for the search query.\r\n     */\r\n    querytext: string;\r\n\r\n    /**\r\n     * The number of query suggestions to retrieve. Must be greater than zero (0). The default value is 5.\r\n     */\r\n    count?: number;\r\n\r\n    /**\r\n     * The number of personal results to retrieve. Must be greater than zero (0). The default value is 5.\r\n     */\r\n    personalCount?: number;\r\n\r\n    /**\r\n     * A Boolean value that specifies whether to retrieve pre-query or post-query suggestions. true to return pre-query suggestions; otherwise, false. The default value is false.\r\n     */\r\n    preQuery?: boolean;\r\n\r\n    /**\r\n     * A Boolean value that specifies whether to hit-highlight or format in bold the query suggestions. true to format in bold the terms in the returned query suggestions\r\n     * that match terms in the specified query; otherwise, false. The default value is true.\r\n     */\r\n    hitHighlighting?: boolean;\r\n\r\n    /**\r\n     * A Boolean value that specifies whether to capitalize the first letter in each term in the returned query suggestions. true to capitalize the first letter in each term;\r\n     * otherwise, false. The default value is false.\r\n     */\r\n    capitalize?: boolean;\r\n\r\n    /**\r\n     * The locale ID (LCID) for the query (see https://msdn.microsoft.com/en-us/library/cc233982.aspx).\r\n     */\r\n    culture?: string;\r\n\r\n    /**\r\n     * A Boolean value that specifies whether stemming is enabled. true to enable stemming; otherwise, false. The default value is true.\r\n     */\r\n    stemming?: boolean;\r\n\r\n    /**\r\n     * A Boolean value that specifies whether to include people names in the returned query suggestions. true to include people names in the returned query suggestions;\r\n     * otherwise, false. The default value is true.\r\n     */\r\n    includePeople?: boolean;\r\n\r\n    /**\r\n     * A Boolean value that specifies whether to turn on query rules for this query. true to turn on query rules; otherwise, false. The default value is true.\r\n     */\r\n    queryRules?: boolean;\r\n\r\n    /**\r\n     * A Boolean value that specifies whether to return query suggestions for prefix matches. true to return query suggestions based on prefix matches, otherwise, false when\r\n     * query suggestions should match the full query word.\r\n     */\r\n    prefixMatch?: boolean;\r\n}\r\n\r\nexport interface ISuggestResult {\r\n    readonly PeopleNames: string[];\r\n    readonly PersonalResults: IPersonalResultSuggestion[];\r\n    readonly Queries: any[];\r\n}\r\n\r\nexport interface IPersonalResultSuggestion {\r\n    readonly HighlightedTitle?: string;\r\n    readonly IsBestBet?: boolean;\r\n    readonly Title?: string;\r\n    readonly TypeId?: string;\r\n    readonly Url?: string;\r\n}\r\n","import { SPRest } from \"../rest\";\r\nimport { SearchQueryInit } from \"./types\";\r\nimport { _Search } from \"./query\";\r\nimport { ICachingOptions } from \"@pnp/odata\";\r\nimport { SearchResults, Search } from \"./query\";\r\nimport { ISuggestQuery, ISuggestResult, Suggest } from \"./suggest\";\r\n\r\nexport * from \"./types\";\r\n\r\nexport {\r\n    ISearch,\r\n    SearchQueryBuilder,\r\n    SearchResults,\r\n    Search,\r\n} from \"./query\";\r\n\r\nexport {\r\n    ISuggest,\r\n    IPersonalResultSuggestion,\r\n    ISuggestQuery,\r\n    ISuggestResult,\r\n    Suggest,\r\n} from \"./suggest\";\r\n\r\ndeclare module \"../rest\" {\r\n    interface SPRest {\r\n        /**\r\n         * Conduct a search\r\n         * \r\n         * @param query Parameters for the search\r\n         */\r\n        search(query: SearchQueryInit): Promise<SearchResults>;\r\n        /**\r\n         * Conduct a search with caching enabled\r\n         * \r\n         * @param query Parameters for the search\r\n         * @param options Optional, caching options\r\n         */\r\n        searchWithCaching(query: SearchQueryInit, options?: ICachingOptions): Promise<SearchResults>;\r\n        /**\r\n         * Conduct a suggest search query\r\n         * \r\n         * @param query Parameters for the search\r\n         */\r\n        searchSuggest(query: string | ISuggestQuery): Promise<ISuggestResult>;\r\n    }\r\n}\r\n\r\nSPRest.prototype.search = function (this: SPRest, query: SearchQueryInit): Promise<SearchResults> {\r\n\r\n    return Search(this._baseUrl, this._options)(query);\r\n};\r\n\r\nSPRest.prototype.searchWithCaching = function (this: SPRest, query: SearchQueryInit, options?: ICachingOptions): Promise<SearchResults> {\r\n\r\n    return (new _Search(this._baseUrl)).configure(this._options).usingCaching(options).execute(query);\r\n};\r\n\r\nSPRest.prototype.searchSuggest = function (this: SPRest, query: string | ISuggestQuery): Promise<ISuggestResult> {\r\n\r\n    return Suggest(this._baseUrl, this._options)(typeof query === \"string\" ? { querytext: query } : query);\r\n};\r\n","import {\r\n    _SharePointQueryableInstance,\r\n    _SharePointQueryableCollection,\r\n    spInvokableFactory,\r\n    IDeleteable,\r\n    deleteable,\r\n} from \"../sharepointqueryable\";\r\nimport { SiteGroups, ISiteGroups } from \"../site-groups/types\";\r\nimport { ITypedHash, assign } from \"@pnp/common\";\r\nimport { metadata } from \"../utils/metadata\";\r\nimport { body } from \"@pnp/odata\";\r\nimport { defaultPath } from \"../decorators\";\r\nimport { spPost } from \"../operations\";\r\nimport { PrincipalType } from \"../types\";\r\nimport { tag } from \"../telemetry\";\r\n\r\n@defaultPath(\"siteusers\")\r\nexport class _SiteUsers extends _SharePointQueryableCollection<ISiteUserInfo[]> {\r\n\r\n    /**\r\n     * Gets a user from the collection by id\r\n     *\r\n     * @param id The id of the user to retrieve\r\n     */\r\n    public getById(id: number): ISiteUser {\r\n        return tag.configure(SiteUser(this, `getById(${id})`), \"sus.getById\");\r\n    }\r\n\r\n    /**\r\n     * Gets a user from the collection by email\r\n     *\r\n     * @param email The email address of the user to retrieve\r\n     */\r\n    public getByEmail(email: string): ISiteUser {\r\n        return tag.configure(SiteUser(this, `getByEmail('${email}')`), \"sus.getByEmail\");\r\n    }\r\n\r\n    /**\r\n     * Gets a user from the collection by login name\r\n     *\r\n     * @param loginName The login name of the user to retrieve\r\n     */\r\n    public getByLoginName(loginName: string): ISiteUser {\r\n        return tag.configure(SiteUser(this).concat(`('!@v::${encodeURIComponent(loginName)}')`), \"sus.getByLoginName\");\r\n    }\r\n\r\n    /**\r\n     * Removes a user from the collection by id\r\n     *\r\n     * @param id The id of the user to remove\r\n     */\r\n    @tag(\"sus.remId\")\r\n    public removeById(id: number): Promise<any> {\r\n        return spPost(this.clone(SiteUsers, `removeById(${id})`));\r\n    }\r\n\r\n    /**\r\n     * Removes a user from the collection by login name\r\n     *\r\n     * @param loginName The login name of the user to remove\r\n     */\r\n    @tag(\"sus.remLoginName\")\r\n    public removeByLoginName(loginName: string): Promise<any> {\r\n        const o = this.clone(SiteUsers, `removeByLoginName(@v)`);\r\n        o.query.set(\"@v\", `'${encodeURIComponent(loginName)}'`);\r\n        return spPost(o);\r\n    }\r\n\r\n    /**\r\n     * Adds a user to a site collection\r\n     *\r\n     * @param loginName The login name of the user to add  to a site collection\r\n     *\r\n     */\r\n    @tag(\"sus.add\")\r\n    public async add(loginName: string): Promise<ISiteUser> {\r\n        await spPost(this, body(assign(metadata(\"SP.User\"), { LoginName: loginName })));\r\n        return this.getByLoginName(loginName);\r\n    }\r\n}\r\nexport interface ISiteUsers extends _SiteUsers { }\r\nexport const SiteUsers = spInvokableFactory<ISiteUsers>(_SiteUsers);\r\n\r\n/**\r\n * Describes a single user\r\n *\r\n */\r\nexport class _SiteUser extends _SharePointQueryableInstance<ISiteUserInfo> {\r\n\r\n    public delete = deleteable(\"su\");\r\n\r\n    /**\r\n     * Gets the groups for this user\r\n     *\r\n     */\r\n    public get groups(): ISiteGroups {\r\n        return tag.configure(SiteGroups(this, \"groups\"), \"su.groups\");\r\n    }\r\n\r\n    /**\r\n    * Updates this user instance with the supplied properties\r\n    *\r\n    * @param properties A plain object of property names and values to update for the user\r\n    */\r\n    public update: (props: ITypedHash<any>) => Promise<IUserUpdateResult> = this._update<IUserUpdateResult, ITypedHash<any>>(\"SP.User\", data => ({ data, user: <any>this }));\r\n}\r\nexport interface ISiteUser extends _SiteUser, IDeleteable { }\r\nexport const SiteUser = spInvokableFactory<ISiteUser>(_SiteUser);\r\n\r\nexport interface ISiteUserInfo extends ISiteUserProps {\r\n\r\n    Expiration: string;\r\n    IsEmailAuthenticationGuestUser: boolean;\r\n    UserId: {\r\n        NameId: string;\r\n        NameIdIssuer: string;\r\n    };\r\n    UserPrincipalName: string | null;\r\n}\r\n\r\n/**\r\n * Describes a single user properties\r\n *\r\n */\r\nexport interface ISiteUserProps {\r\n\r\n    /**\r\n     * Contains Site user email\r\n     * \r\n     */\r\n    Email: string;\r\n\r\n    /**\r\n     * Contains Site user Id\r\n     * \r\n     */\r\n    Id: number;\r\n\r\n    /**\r\n     * Site user IsHiddenInUI\r\n     * \r\n     */\r\n    IsHiddenInUI: boolean;\r\n\r\n    /**\r\n     * Site user IsShareByEmailGuestUser \r\n     * \r\n     */\r\n    IsShareByEmailGuestUser: boolean;\r\n\r\n    /**\r\n     * Describes if Site user Is Site Admin \r\n     * \r\n     */\r\n    IsSiteAdmin: boolean;\r\n\r\n    /**\r\n     * Site user LoginName\r\n     * \r\n     */\r\n    LoginName: string;\r\n\r\n    /**\r\n     * Site user Principal type\r\n     * \r\n     */\r\n    PrincipalType: number | PrincipalType;\r\n\r\n    /**\r\n     * Site user Title\r\n     * \r\n     */\r\n    Title: string;\r\n}\r\n\r\n/**\r\n * Properties that provide both a getter, and a setter.\r\n *\r\n */\r\nexport interface IUserUpdateResult {\r\n    user: ISiteUser;\r\n    data: any;\r\n}\r\n\r\n/**\r\n * Result from ensuring a user\r\n *\r\n */\r\nexport interface IWebEnsureUserResult {\r\n    data: ISiteUserProps;\r\n    user: ISiteUser;\r\n}\r\n","import { assign, hOP } from \"@pnp/common\";\r\nimport { body, headers } from \"@pnp/odata\";\r\nimport {\r\n    _SharePointQueryableInstance,\r\n    SharePointQueryableCollection,\r\n    ISharePointQueryableCollection,\r\n    _SharePointQueryableCollection,\r\n    spInvokableFactory,\r\n    IDeleteable,\r\n    deleteable,\r\n} from \"../sharepointqueryable\";\r\nimport { SiteGroups, ISiteGroups } from \"../site-groups/types\";\r\nimport { metadata } from \"../utils/metadata\";\r\nimport { defaultPath } from \"../decorators\";\r\nimport { spPost } from \"../operations\";\r\nimport { tag } from \"../telemetry\";\r\n\r\nexport type SecurableQueryable = _SharePointQueryableInstance & ISecurableMethods;\r\n\r\n/**\r\n * Describes a set of role assignments for the current scope\r\n *\r\n */\r\n@defaultPath(\"roleassignments\")\r\nexport class _RoleAssignments extends _SharePointQueryableCollection<IRoleAssignmentInfo[]> {\r\n\r\n    /**\t\r\n     * Gets the role assignment associated with the specified principal id from the collection.\t\r\n     *\t\r\n     * @param id The id of the role assignment\t\r\n     */\r\n    public getById(id: number): IRoleAssignment {\r\n        return RoleAssignment(this).concat(`(${id})`);\r\n    }\r\n\r\n    /**\r\n     * Adds a new role assignment with the specified principal and role definitions to the collection\r\n     *\r\n     * @param principalId The id of the user or group to assign permissions to\r\n     * @param roleDefId The id of the role definition that defines the permissions to assign\r\n     *\r\n     */\r\n    public async add(principalId: number, roleDefId: number): Promise<void> {\r\n        await spPost(this.clone(RoleAssignments, `addroleassignment(principalid=${principalId}, roledefid=${roleDefId})`));\r\n    }\r\n\r\n    /**\r\n     * Removes the role assignment with the specified principal and role definition from the collection\r\n     *\r\n     * @param principalId The id of the user or group in the role assignment\r\n     * @param roleDefId The id of the role definition in the role assignment\r\n     *\r\n     */\r\n    public async remove(principalId: number, roleDefId: number): Promise<void> {\r\n        await spPost(this.clone(RoleAssignments, `removeroleassignment(principalid=${principalId}, roledefid=${roleDefId})`));\r\n    }\r\n}\r\nexport interface IRoleAssignments extends _RoleAssignments { }\r\nexport const RoleAssignments = spInvokableFactory<IRoleAssignments>(_RoleAssignments);\r\n\r\n/**\r\n * Describes a role assignment\r\n *\r\n */\r\nexport class _RoleAssignment extends _SharePointQueryableInstance<IRoleAssignmentInfo> {\r\n\r\n    public delete = deleteable(\"ra\");\r\n\r\n    /**\r\n     * Gets the groups that directly belong to the access control list (ACL) for this securable object\r\n     *\r\n     */\r\n    public get groups(): ISiteGroups {\r\n        return tag.configure(SiteGroups(this, \"groups\"), \"ra.groups\");\r\n    }\r\n\r\n    /**\r\n     * Gets the role definition bindings for this role assignment\r\n     *\r\n     */\r\n    public get bindings(): ISharePointQueryableCollection {\r\n        return SharePointQueryableCollection(this, \"roledefinitionbindings\");\r\n    }\r\n}\r\nexport interface IRoleAssignment extends _RoleAssignment, IDeleteable { }\r\nexport const RoleAssignment = spInvokableFactory<IRoleAssignment>(_RoleAssignment);\r\n\r\n/**\r\n * Describes a collection of role definitions\r\n *\r\n */\r\n@defaultPath(\"roledefinitions\")\r\nexport class _RoleDefinitions extends _SharePointQueryableCollection<IRoleDefinitionInfo[]> {\r\n\r\n    /**\t   \r\n     * Gets the role definition with the specified id from the collection\t    \r\n     *\t     \r\n     * @param id The id of the role definition\t     \r\n     *\t     \r\n     */\r\n    public getById(id: number): IRoleDefinition {\r\n        return RoleDefinition(this, `getById(${id})`);\r\n    }\r\n\r\n    /**\r\n     * Gets the role definition with the specified name\r\n     *\r\n     * @param name The name of the role definition\r\n     *\r\n     */\r\n    public getByName(name: string): IRoleDefinition {\r\n        return RoleDefinition(this, `getbyname('${name}')`);\r\n    }\r\n\r\n    /**\r\n     * Gets the role definition with the specified role type\r\n     *\r\n     * @param roleTypeKind The roletypekind of the role definition (None=0, Guest=1, Reader=2, Contributor=3, WebDesigner=4, Administrator=5, Editor=6, System=7)\r\n     *\r\n     */\r\n    public getByType(roleTypeKind: RoleTypeKind): IRoleDefinition {\r\n        return RoleDefinition(this, `getbytype(${roleTypeKind})`);\r\n    }\r\n\r\n    /**\r\n     * Creates a role definition\r\n     *\r\n     * @param name The new role definition's name\r\n     * @param description The new role definition's description\r\n     * @param order The order in which the role definition appears\r\n     * @param basePermissions The permissions mask for this role definition, high and low values need to be converted to string\r\n     *\r\n     */\r\n    public async add(name: string, description: string, order: number, basePermissions: IBasePermissions): Promise<IRoleDefinitionAddResult> {\r\n        const postBody = body({\r\n            BasePermissions: { \"High\": basePermissions.High.toString(), \"Low\": basePermissions.Low.toString() },\r\n            Description: description,\r\n            Name: name,\r\n            Order: order,\r\n            __metadata: { \"type\": \"SP.RoleDefinition\" },\r\n        });\r\n\r\n        const data = await spPost(this, postBody);\r\n\r\n        return {\r\n            data: data,\r\n            definition: this.getById(data.Id),\r\n        };\r\n    }\r\n}\r\nexport interface IRoleDefinitions extends _RoleDefinitions { }\r\nexport const RoleDefinitions = spInvokableFactory<IRoleDefinitions>(_RoleDefinitions);\r\n\r\n/**\r\n * Describes a role definition\r\n *\r\n */\r\nexport class _RoleDefinition extends _SharePointQueryableInstance<IRoleDefinitionInfo> {\r\n\r\n    public delete = deleteable(\"rd\");\r\n\r\n    /**\r\n     * Updates this role definition with the supplied properties\r\n     *\r\n     * @param properties A plain object hash of values to update for the role definition\r\n     */\r\n    /* tslint:disable no-string-literal */\r\n    public async update(properties: Partial<IRoleDefinitionInfo>): Promise<IRoleDefinitionUpdateResult> {\r\n\r\n        const s = [\"BasePermissions\"];\r\n        if (hOP(properties, s[0]) !== undefined) {\r\n            properties[s[0]] = assign(metadata(`SP.${s[0]}`), properties[s[0]]);\r\n\r\n            const bpObj = properties[s[0]];\r\n            bpObj.High = bpObj.High.toString();\r\n            bpObj.Low = bpObj.Low.toString();\r\n        }\r\n\r\n        const postBody = body(assign(metadata(\"SP.RoleDefinition\"), properties), headers({ \"X-HTTP-Method\": \"MERGE\" }));\r\n\r\n        const data = await spPost(this, postBody);\r\n\r\n        let definition: IRoleDefinition = <any>this;\r\n        if (hOP(properties, \"Name\")) {\r\n            const parent = this.getParent<IRoleDefinitions>(RoleDefinitions, this.parentUrl, \"\");\r\n            definition = parent.getByName((<string>properties[\"Name\"]));\r\n        }\r\n        return {\r\n            data,\r\n            definition,\r\n        };\r\n    }\r\n    /* tslint:enable */\r\n}\r\nexport interface IRoleDefinition extends _RoleDefinition, IDeleteable { }\r\nexport const RoleDefinition = spInvokableFactory<IRoleDefinition>(_RoleDefinition);\r\n\r\nexport interface ISecurableMethods {\r\n    readonly roleAssignments: IRoleAssignments;\r\n    readonly firstUniqueAncestorSecurableObject: _SharePointQueryableInstance;\r\n    getUserEffectivePermissions(loginName: string): Promise<IBasePermissions>;\r\n    getCurrentUserEffectivePermissions(): Promise<IBasePermissions>;\r\n    breakRoleInheritance(copyRoleAssignments?: boolean, clearSubscopes?: boolean): Promise<any>;\r\n    resetRoleInheritance(): Promise<any>;\r\n    userHasPermissions(loginName: string, permission: PermissionKind): Promise<boolean>;\r\n    currentUserHasPermissions(permission: PermissionKind): Promise<boolean>;\r\n    hasPermissions(value: IBasePermissions, perm: PermissionKind): boolean;\r\n}\r\n\r\n/**\r\n * Result from updating a role definition\r\n *\r\n */\r\nexport interface IRoleDefinitionUpdateResult {\r\n    definition: IRoleDefinition;\r\n    data: any;\r\n}\r\n\r\n/**\r\n * Result from adding a role definition\r\n *\r\n */\r\nexport interface IRoleDefinitionAddResult {\r\n    definition: IRoleDefinition;\r\n    data: any;\r\n}\r\n\r\nexport interface IBasePermissions {\r\n    Low: number;\r\n    High: number;\r\n}\r\n\r\nexport interface IRoleAssignmentInfo {\r\n    PrincipalId: number;\r\n}\r\n\r\nexport interface IRoleDefinitionInfo {\r\n    BasePermissions: IBasePermissions;\r\n    Description: string;\r\n    Hidden: boolean;\r\n    Id: number;\r\n    Name: string;\r\n    Order: number;\r\n    RoleTypeKind: RoleTypeKind;\r\n}\r\n\r\nexport type RoleTypeKind = 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7;\r\n\r\nexport enum PermissionKind {\r\n\r\n    /**\r\n     * Has no permissions on the Site. Not available through the user interface.\r\n     */\r\n    EmptyMask = 0,\r\n\r\n    /**\r\n     * View items in lists, documents in document libraries, and Web discussion comments.\r\n     */\r\n    ViewListItems = 1,\r\n\r\n    /**\r\n     * Add items to lists, documents to document libraries, and Web discussion comments.\r\n     */\r\n    AddListItems = 2,\r\n\r\n    /**\r\n     * Edit items in lists, edit documents in document libraries, edit Web discussion comments\r\n     * in documents, and customize Web Part Pages in document libraries.\r\n     */\r\n    EditListItems = 3,\r\n\r\n    /**\r\n     * Delete items from a list, documents from a document library, and Web discussion\r\n     * comments in documents.\r\n     */\r\n    DeleteListItems = 4,\r\n\r\n    /**\r\n     * Approve a minor version of a list item or document.\r\n     */\r\n    ApproveItems = 5,\r\n\r\n    /**\r\n     * View the source of documents with server-side file handlers.\r\n     */\r\n    OpenItems = 6,\r\n\r\n    /**\r\n     * View past versions of a list item or document.\r\n     */\r\n    ViewVersions = 7,\r\n\r\n    /**\r\n     * Delete past versions of a list item or document.\r\n     */\r\n    DeleteVersions = 8,\r\n\r\n    /**\r\n     * Discard or check in a document which is checked out to another user.\r\n     */\r\n    CancelCheckout = 9,\r\n\r\n    /**\r\n     * Create, change, and delete personal views of lists.\r\n     */\r\n    ManagePersonalViews = 10,\r\n\r\n    /**\r\n     * Create and delete lists, add or remove columns in a list, and add or remove public views of a list.\r\n     */\r\n    ManageLists = 12,\r\n\r\n    /**\r\n     * View forms, views, and application pages, and enumerate lists.\r\n     */\r\n    ViewFormPages = 13,\r\n\r\n    /**\r\n     * Make content of a list or document library retrieveable for anonymous users through SharePoint search.\r\n     * The list permissions in the site do not change.\r\n     */\r\n    AnonymousSearchAccessList = 14,\r\n\r\n    /**\r\n     * Allow users to open a Site, list, or folder to access items inside that container.\r\n     */\r\n    Open = 17,\r\n\r\n    /**\r\n     * View pages in a Site.\r\n     */\r\n    ViewPages = 18,\r\n\r\n    /**\r\n     * Add, change, or delete HTML pages or Web Part Pages, and edit the Site using\r\n     * a Windows SharePoint Services compatible editor.\r\n     */\r\n    AddAndCustomizePages = 19,\r\n\r\n    /**\r\n     * Apply a theme or borders to the entire Site.\r\n     */\r\n    ApplyThemeAndBorder = 20,\r\n\r\n    /**\r\n     * Apply a style sheet (.css file) to the Site.\r\n     */\r\n    ApplyStyleSheets = 21,\r\n\r\n    /**\r\n     * View reports on Site usage.\r\n     */\r\n    ViewUsageData = 22,\r\n\r\n    /**\r\n     * Create a Site using Self-Service Site Creation.\r\n     */\r\n    CreateSSCSite = 23,\r\n\r\n    /**\r\n     * Create subsites such as team sites, Meeting Workspace sites, and Document Workspace sites.\r\n     */\r\n    ManageSubwebs = 24,\r\n\r\n    /**\r\n     * Create a group of users that can be used anywhere within the site collection.\r\n     */\r\n    CreateGroups = 25,\r\n\r\n    /**\r\n     * Create and change permission levels on the Site and assign permissions to users\r\n     * and groups.\r\n     */\r\n    ManagePermissions = 26,\r\n\r\n    /**\r\n     * Enumerate files and folders in a Site using Microsoft Office SharePoint Designer\r\n     * and WebDAV interfaces.\r\n     */\r\n    BrowseDirectories = 27,\r\n\r\n    /**\r\n     * View information about users of the Site.\r\n     */\r\n    BrowseUserInfo = 28,\r\n\r\n    /**\r\n     * Add or remove personal Web Parts on a Web Part Page.\r\n     */\r\n    AddDelPrivateWebParts = 29,\r\n\r\n    /**\r\n     * Update Web Parts to display personalized information.\r\n     */\r\n    UpdatePersonalWebParts = 30,\r\n\r\n    /**\r\n     * Grant the ability to perform all administration tasks for the Site as well as\r\n     * manage content, activate, deactivate, or edit properties of Site scoped Features\r\n     * through the object model or through the user interface (UI). When granted on the\r\n     * root Site of a Site Collection, activate, deactivate, or edit properties of\r\n     * site collection scoped Features through the object model. To browse to the Site\r\n     * Collection Features page and activate or deactivate Site Collection scoped Features\r\n     * through the UI, you must be a Site Collection administrator.\r\n     */\r\n    ManageWeb = 31,\r\n\r\n    /**\r\n     * Content of lists and document libraries in the Web site will be retrieveable for anonymous users through\r\n     * SharePoint search if the list or document library has AnonymousSearchAccessList set.\r\n     */\r\n    AnonymousSearchAccessWebLists = 32,\r\n\r\n    /**\r\n     * Use features that launch client applications. Otherwise, users must work on documents\r\n     * locally and upload changes.\r\n     */\r\n    UseClientIntegration = 37,\r\n\r\n    /**\r\n     * Use SOAP, WebDAV, or Microsoft Office SharePoint Designer interfaces to access the Site.\r\n     */\r\n    UseRemoteAPIs = 38,\r\n\r\n    /**\r\n     * Manage alerts for all users of the Site.\r\n     */\r\n    ManageAlerts = 39,\r\n\r\n    /**\r\n     * Create e-mail alerts.\r\n     */\r\n    CreateAlerts = 40,\r\n\r\n    /**\r\n     * Allows a user to change his or her user information, such as adding a picture.\r\n     */\r\n    EditMyUserInfo = 41,\r\n\r\n    /**\r\n     * Enumerate permissions on Site, list, folder, document, or list item.\r\n     */\r\n    EnumeratePermissions = 63,\r\n\r\n    /**\r\n     * Has all permissions on the Site. Not available through the user interface.\r\n     */\r\n    FullMask = 65,\r\n}\r\n","import { IPrincipalInfo } from \"../types\";\r\nimport { _Web } from \"../webs/types\";\r\nimport { _File } from \"../files/types\";\r\nimport { _Item } from \"../items/types\";\r\nimport { _Folder } from \"../folders/types\";\r\n\r\nexport type ShareableQueryable = _Web | _File | _Folder | _Item;\r\n\r\n/**\r\n * Indicates the role of the sharing link\r\n */\r\nexport enum SharingRole {\r\n    None = 0,\r\n    View = 1,\r\n    Edit = 2,\r\n    Owner = 3,\r\n}\r\n\r\nexport enum SPSharedObjectType {\r\n    Unknown = 0,\r\n    File = 1,\r\n    Folder = 2,\r\n    Item = 3,\r\n    List = 4,\r\n    Web = 5,\r\n    Max = 6,\r\n}\r\n\r\nexport enum SharingDomainRestrictionMode {\r\n    None = 0,\r\n    AllowList = 1,\r\n    BlockList = 2,\r\n}\r\n\r\nexport enum SharingOperationStatusCode {\r\n    /**\r\n     * The share operation completed without errors.\r\n     */\r\n    CompletedSuccessfully = 0,\r\n    /**\r\n     * The share operation completed and generated requests for access.\r\n     */\r\n    AccessRequestsQueued = 1,\r\n    /**\r\n     * The share operation failed as there were no resolved users.\r\n     */\r\n    NoResolvedUsers = -1,\r\n    /**\r\n     * The share operation failed due to insufficient permissions.\r\n     */\r\n    AccessDenied = -2,\r\n    /**\r\n     * The share operation failed when attempting a cross site share, which is not supported.\r\n     */\r\n    CrossSiteRequestNotSupported = -3,\r\n    /**\r\n     * The sharing operation failed due to an unknown error.\r\n     */\r\n    UnknowError = -4,\r\n    /**\r\n     * The text you typed is too long. Please shorten it.\r\n     */\r\n    EmailBodyTooLong = -5,\r\n    /**\r\n     * The maximum number of unique scopes in the list has been exceeded.\r\n     */\r\n    ListUniqueScopesExceeded = -6,\r\n    /**\r\n     * The share operation failed because a sharing capability is disabled in the site.\r\n     */\r\n    CapabilityDisabled = -7,\r\n    /**\r\n     * The specified object for the share operation is not supported.\r\n     */\r\n    ObjectNotSupported = -8,\r\n    /**\r\n     * A SharePoint group cannot contain another SharePoint group.\r\n     */\r\n    NestedGroupsNotSupported = -9,\r\n}\r\n\r\nexport enum SharingLinkKind {\r\n    /**\r\n     * Uninitialized link\r\n     */\r\n    Uninitialized = 0,\r\n    /**\r\n     * Direct link to the object being shared\r\n     */\r\n    Direct = 1,\r\n    /**\r\n     * Organization-shareable link to the object being shared with view permissions\r\n     */\r\n    OrganizationView = 2,\r\n    /**\r\n     * Organization-shareable link to the object being shared with edit permissions\r\n     */\r\n    OrganizationEdit = 3,\r\n    /**\r\n     * View only anonymous link\r\n     */\r\n    AnonymousView = 4,\r\n    /**\r\n     * Read/Write anonymous link\r\n     */\r\n    AnonymousEdit = 5,\r\n    /**\r\n     * Flexible sharing Link where properties can change without affecting link URL\r\n     */\r\n    Flexible = 6,\r\n}\r\n\r\nexport interface ISharedFuncs {\r\n    /**\r\n     * Gets a link suitable for sharing for this item\r\n     *\r\n     * @param kind The type of link to share\r\n     * @param expiration The optional expiration date\r\n     */\r\n    getShareLink(kind: SharingLinkKind, expiration?: Date): Promise<IShareLinkResponse>;\r\n    /**\r\n     * Checks Permissions on the list of Users and returns back role the users have on the Item.\r\n     *\r\n     * @param recipients The array of Entities for which Permissions need to be checked.\r\n     */\r\n    checkSharingPermissions(recipients: ISharingRecipient[]): Promise<ISharingEntityPermission[]>;\r\n    /**\r\n     * Get Sharing Information.\r\n     *\r\n     * @param request The SharingInformationRequest Object.\r\n     * @param expands Expand more fields.\r\n     * \r\n     */\r\n    getSharingInformation(request?: ISharingInformationRequest, expands?: string[]): Promise<ISharingInformation>;\r\n    /**\r\n     * Gets the sharing settings of an item.\r\n     *\r\n     * @param useSimplifiedRoles Determines whether to use simplified roles.\r\n     */\r\n    getObjectSharingSettings(useSimplifiedRoles?: boolean): Promise<IObjectSharingSettings>;\r\n    /**\r\n     * Unshare this item\r\n     */\r\n    unshare(): Promise<ISharingResult>;\r\n    /**\r\n     * Deletes a sharing link by kind\r\n     *\r\n     * @param kind Deletes a sharing link by the kind of link\r\n     */\r\n    deleteSharingLinkByKind(kind: SharingLinkKind): Promise<void>;\r\n    /**\r\n     * Removes the specified link to the item.\r\n     *\r\n     * @param kind The kind of link to be deleted.\r\n     * @param shareId\r\n     */\r\n    unshareLink(kind: SharingLinkKind, shareId?: string): Promise<void>;\r\n}\r\n\r\nexport interface IShareObjectOptions {\r\n    url?: string;\r\n    loginNames?: string | string[];\r\n    role: SharingRole;\r\n    emailData?: ISharingEmailData;\r\n    group?: RoleType;\r\n    propagateAcl?: boolean;\r\n    includeAnonymousLinkInEmail?: boolean;\r\n    useSimplifiedRoles?: boolean;\r\n}\r\n\r\n/**\r\n * Represents email data.\r\n */\r\nexport interface ISharingEmailData {\r\n\r\n    /**\r\n     * The e-mail subject.\r\n     */\r\n    subject?: string;\r\n\r\n    /**\r\n     * The e-mail body.\r\n     */\r\n    body: string;\r\n}\r\n\r\nexport interface IShareLinkSettings {\r\n    /**\r\n     * The optional unique identifier of an existing sharing link to be retrieved and updated if necessary.\r\n     */\r\n    shareId?: string;\r\n\r\n    /**\r\n     * The kind of the sharing link to be created.\r\n     */\r\n    linkKind: SharingLinkKind;\r\n\r\n    /**\r\n     * A date/time string for which the format conforms to the ISO 8601:2004(E) complete representation for calendar date and time of day and\r\n     * which represents the time and date of expiry for the anonymous link. Both the minutes and hour value must be specified for the\r\n     * difference between the local and UTC time. Midnight is represented as 00:00:00.\r\n     */\r\n    expiration?: string;\r\n\r\n    /**\r\n     * The role to be used for the sharing link. This is required for Flexible links, and ignored for legacy link kinds.\r\n     */\r\n    role?: SharingRole;\r\n\r\n    /**\r\n     * Indicates if the sharing link, should support anonymous access. This is required for Flexible links, and ignored for legacy link kinds.\r\n     */\r\n    allowAnonymousAccess?: boolean;\r\n}\r\n\r\nexport interface IShareLinkRequest {\r\n\r\n    /**\r\n     * A string of JSON representing users in people picker format. Only needed if an e-mail notification should be sent.\r\n     */\r\n    peoplePickerInput?: string;\r\n\r\n    /**\r\n     * Whether to create the link or not if it doesn't exist yet.\r\n     */\r\n    createLink: boolean;\r\n\r\n    /**\r\n     * The e-mail data. Only needed if an e-mail notification should be sent.\r\n     */\r\n    emailData?: ISharingEmailData;\r\n\r\n    /**\r\n     * The settings for the sharing link to be created/updated\r\n     */\r\n    settings: IShareLinkSettings;\r\n}\r\n\r\n/**\r\n * Represents a response for sharing a link\r\n */\r\nexport interface IShareLinkResponse {\r\n    /**\r\n     * A SharingLinkInfo that represents the sharing link. Will be populated if sharing operation is returning a sharing link.\r\n     */\r\n    sharingLinkInfo: ISharingLinkInfo;\r\n}\r\n\r\nexport interface ISharingLinkInfo {\r\n\r\n    AllowsAnonymousAccess: boolean;\r\n    Created: string;\r\n    CreatedBy: IPrincipalInfo;\r\n    Expiration: string;\r\n    IsActive: boolean;\r\n    IsEditLink: boolean;\r\n    IsFormsLink: boolean;\r\n    IsUnhealthy: boolean;\r\n    LastModified: string;\r\n    LastModifiedBy: IPrincipalInfo;\r\n    LinkKind: SharingLinkKind;\r\n    ShareId: string;\r\n    Url: string;\r\n}\r\n\r\nexport interface ISharingResult {\r\n\r\n    /**\r\n     * The relative URL of a page which can be navigated to, to show permissions.\r\n     */\r\n    PermissionsPageRelativeUrl?: string;\r\n\r\n    /**\r\n     * A collection of users which have new pending access requests as a result of sharing.\r\n     */\r\n    UsersWithAccessRequests?: any[]; // SPSharingUserCollection\r\n\r\n    /**\r\n     * An enumeration which summarizes the result of the sharing operation.\r\n     */\r\n    StatusCode?: SharingOperationStatusCode;\r\n\r\n    /**\r\n     * An error message about the failure if sharing was unsuccessful.\r\n     */\r\n    ErrorMessage?: string;\r\n\r\n    /**\r\n     * A list of UserSharingResults from attempting to share a securable with unique permissions.\r\n     */\r\n    UniquelyPermissionedUsers?: IUserSharingResult[];\r\n    /**\r\n     * Groups which were granted permissions.\r\n     */\r\n    GroupsSharedWith?: any[]; // SPGroupCollection\r\n\r\n    /**\r\n     * The SharePoint group users were added to, if any were added to a group.\r\n     */\r\n    GroupUsersAddedTo?: any; // SPGroup\r\n\r\n    /**\r\n     * A list of users being added to a SharePoint permissions goup\r\n     */\r\n    UsersAddedToGroup?: IUserSharingResult[];\r\n\r\n    /**\r\n     * A list of SPInvitationCreationResult for external users being invited to have access.\r\n     */\r\n    InvitedUsers?: IInvitationCreationResult[];\r\n\r\n    /**\r\n     * The name of the securable being shared.\r\n     */\r\n    Name?: string;\r\n\r\n    /**\r\n     * The url of the securable being shared.\r\n     */\r\n    Url?: string;\r\n\r\n    /**\r\n     * IconUrl\r\n     */\r\n    IconUrl?: string;\r\n}\r\n\r\nexport interface IInvitationCreationResult {\r\n    Succeeded?: boolean;\r\n    Email?: string;\r\n    InvitationLink?: string;\r\n}\r\n\r\nexport interface IUserSharingResult {\r\n    IsUserKnown?: boolean;\r\n    Status?: boolean;\r\n    Message?: string;\r\n    User?: string;\r\n    DisplayName?: string;\r\n    Email?: string;\r\n    CurrentRole?: SharingRole;\r\n    AllowedRoles?: SharingRole[];\r\n    InvitationLink?: string;\r\n}\r\n\r\nexport interface ISharingRecipient {\r\n    email?: string;\r\n    alias?: string;\r\n}\r\n\r\nexport interface ISharingEntityPermission {\r\n    /**\r\n     * The Input Entity provided to the Call.\r\n     */\r\n    inputEntity: string;\r\n    /**\r\n     * The Resolved Entity after resolving using PeoplePicker API.\r\n     */\r\n    resolvedEntity: string;\r\n    /**\r\n     * Does the Entity have Access to the Securable Object\r\n     */\r\n    hasAccess: boolean;\r\n    /**\r\n     * Role of the Entity on ListItem\r\n     */\r\n    role: SharingRole;\r\n}\r\n\r\nexport interface ISharingInformationRequest {\r\n    /**\r\n     * Max Principal's to return.\r\n     */\r\n    maxPrincipalsToReturn: number;\r\n    /**\r\n     * Supported Features (For future use by Office Client).\r\n     */\r\n    clientSupportedFeatures: string;\r\n}\r\n\r\nexport interface IObjectSharingSettings {\r\n    /**\r\n     * The URL pointing to the containing SPWeb object\r\n     */\r\n    WebUrl: string;\r\n    /**\r\n     * The unique ID of the parent list (if applicable)\r\n     */\r\n    ListId?: string;\r\n    /**\r\n     * The list item ID (if applicable)\r\n     */\r\n    ItemId?: string;\r\n    /**\r\n     * The object title\r\n     */\r\n    ItemName: string;\r\n    /**\r\n     * The server relative object URL\r\n     */\r\n    ItemUrl: string;\r\n    /**\r\n     * Contains information about the sharing state of a shareable object\r\n     */\r\n    ObjectSharingInformation: any; // SPObjectSharingInformation\r\n    /**\r\n     * Boolean indicating whether the sharing context operates under the access request mode\r\n     */\r\n    AccessRequestMode: boolean;\r\n    /**\r\n     * Boolean indicating whether the sharing context operates under the permissions only mode\r\n     * (i.e. adding to a group or hiding the groups dropdown in the SharePoint UI)\r\n     */\r\n    PermissionsOnlyMode: boolean;\r\n    /**\r\n     * URL of the site from which the shared object inherits permissions\r\n     */\r\n    InheritingWebLink: string;\r\n    /**\r\n     * Boolean flag denoting if guest users are enabled for the site collection\r\n     */\r\n    ShareByEmailEnabled: boolean;\r\n    /**\r\n     * Boolean indicating whether the current user is a guest user\r\n     */\r\n    IsGuestUser: boolean;\r\n    /**\r\n     * Boolean indicating whether the site has the standard \"Editor\" role\r\n     */\r\n    HasEditRole: boolean;\r\n    /**\r\n     * Boolean indicating whether the site has the standard \"Reader\" role\r\n     */\r\n    HasReadRole: boolean;\r\n    /**\r\n     * Boolean indicating whether the object to share is a picture library\r\n     */\r\n    IsPictureLibrary: boolean;\r\n    /**\r\n     * Boolean indicating whether the folder object can be shared\r\n     */\r\n    CanShareFolder: boolean;\r\n    /**\r\n     * Boolean indicating whether email invitations can be sent\r\n     */\r\n    CanSendEmail: boolean;\r\n    /**\r\n     * Default share link type\r\n     */\r\n    DefaultShareLinkType: SharingLinkKind;\r\n    /**\r\n     * Boolean indicating whether the object to share supports ACL propagation\r\n     */\r\n    SupportsAclPropagation: boolean;\r\n    /**\r\n     * Boolean indicating whether the current user can only share within the tenancy\r\n     */\r\n    CanCurrentUserShareInternally: boolean;\r\n    /**\r\n     * Boolean indicating whether the current user can share outside the tenancy, by inviting external users\r\n     */\r\n    CanCurrentUserShareExternally: boolean;\r\n    /**\r\n     * Boolean indicating whether the current user can retrieve an anonymous View link, if one has already been created\r\n     * If one has not been created, the user cannot create one\r\n     */\r\n    CanCurrentUserRetrieveReadonlyLink: boolean;\r\n    /**\r\n     * Boolean indicating whether the current user can create or disable an anonymous Edit link\r\n     */\r\n    CanCurrentUserManageReadonlyLink: boolean;\r\n    /**\r\n     * Boolean indicating whether the current user can retrieve an anonymous Edit link, if one has already been created\r\n     * If one has not been created, the user cannot create one\r\n     */\r\n    CanCurrentUserRetrieveReadWriteLink: boolean;\r\n    /**\r\n     * Boolean indicating whether the current user can create or disable an anonymous Edit link\r\n     */\r\n    CanCurrentUserManageReadWriteLink: boolean;\r\n    /**\r\n     * Boolean indicating whether the current user can retrieve an organization View link, if one has already been created\r\n     * If one has not been created, the user cannot create one\r\n     */\r\n    CanCurrentUserRetrieveOrganizationReadonlyLink: boolean;\r\n    /**\r\n     * Boolean indicating whether the current user can create or disable an organization Edit link\r\n     */\r\n    CanCurrentUserManageOrganizationReadonlyLink: boolean;\r\n    /**\r\n     * Boolean indicating whether the current user can retrieve an organization Edit link, if one has already been created\r\n     * If one has not been created, the user cannot create one\r\n     */\r\n    CanCurrentUserRetrieveOrganizationReadWriteLink: boolean;\r\n    /**\r\n     * Boolean indicating whether the current user can create or disable an organization Edit link\r\n     */\r\n    CanCurrentUserManageOrganizationReadWriteLink: boolean;\r\n    /**\r\n     * Boolean indicating whether the current user can make use of Share-By-Link\r\n     */\r\n    CanSendLink: boolean;\r\n    /**\r\n     * Boolean indicating whether the client logic should warn the user\r\n     * that they are about to share with external email addresses.\r\n     */\r\n    ShowExternalSharingWarning: boolean;\r\n    /**\r\n     * A list of SharingPermissionInformation objects that can be used to share\r\n     */\r\n    SharingPermissions: any[]; // SPSharingPermissionInformationCollection\r\n    /**\r\n     * A dictionary object that lists the display name and the id of\r\n     * the SharePoint simplified roles (edit, view)\r\n     */\r\n    SimplifiedRoles: { [key: string]: string };\r\n    /**\r\n     * A dictionary object that lists the display name and the id of the SharePoint groups\r\n     */\r\n    GroupsList: { [key: string]: string };\r\n    /**\r\n     * A dictionary object that lists the display name and the id of the SharePoint regular roles\r\n     */\r\n    Roles: { [key: string]: string };\r\n    /**\r\n     * An object containing the SharePoint UI specific sharing settings.\r\n     */\r\n    SharePointSettings: any; // SharePointSharingSettings\r\n    /**\r\n     * Boolean indicating whether the current user is a site collection administrator\r\n     */\r\n    IsUserSiteAdmin: boolean;\r\n    /**\r\n     * A value that indicates number of days an anonymous link can be valid before it expires\r\n     */\r\n    RequiredAnonymousLinkExpirationInDays: number;\r\n}\r\n\r\nexport interface ISharingInformation {\r\n    /**\r\n     * External Sharing.\r\n     */\r\n    canAddExternalPrincipal?: boolean;\r\n    /**\r\n     * Internal Sharing.\r\n     */\r\n    canAddInternalPrincipal?: boolean;\r\n    /**\r\n     * Can Send Email.\r\n     */\r\n    canSendEmail?: boolean;\r\n    /**\r\n     * Can Use Simplified Roles present in Roles Enum.\r\n     */\r\n    canUseSimplifiedRoles?: boolean;\r\n    /**\r\n     * Has Unique Permissions.\r\n     */\r\n    hasUniquePermissions?: boolean;\r\n    /**\r\n     * Current Users Role on the Item.\r\n     */\r\n    currentRole?: SharingRole;\r\n    /**\r\n     * Does the User+Item require Approval from Admin for Sharing.\r\n     */\r\n    requiresAccessApproval?: boolean;\r\n    /**\r\n     * (Owners only)Whether there are pending access requests for the securable object.\r\n     */\r\n    hasPendingAccessRequests?: boolean;\r\n    /**\r\n     * (Owners only)The link to the access requests page for the securable object, or an empty string if the link is not available.\r\n     */\r\n    pendingAccessRequestsLink?: string;\r\n    /**\r\n     * sharedObjectType\r\n     */\r\n    sharedObjectType?: SPSharedObjectType;\r\n    /**\r\n     * Url for the Securable Object (Encoded).\r\n     */\r\n    directUrl?: string;\r\n    /**\r\n     * Parent Web Url for the Securable Object (Encoded).\r\n     */\r\n    webUrl?: string;\r\n    /**\r\n     * Default SharingLinkKind.\r\n     */\r\n    defaultLinkKind?: SharingLinkKind;\r\n    /**\r\n     * Tenant's SharingDomainRestrictionMode.\r\n     */\r\n    domainRestrictionMode?: SharingDomainRestrictionMode;\r\n    /**\r\n     * Tenant's RestrictedDomains.\r\n     */\r\n    RestrictedDomains?: string;\r\n    /**\r\n     * Tenant's Anonymous Link Expiration Restriction in Days.\r\n     */\r\n    anonymousLinkExpirationRestrictionDays?: number;\r\n    /**\r\n     * The PermissionCollection that are on the Securable Object (Princpals & Links)\r\n     */\r\n    permissionsInformation?: any; // PermissionCollection\r\n    /**\r\n     * PickerSettings used by the PeoplePicker Control.\r\n     */\r\n    pickerSettings?: any; // PickerSettings\r\n}\r\n\r\nexport enum RoleType {\r\n    None = 0,\r\n    Guest = 1,\r\n    Reader = 2,\r\n    Contributor = 3,\r\n    WebDesigner = 4,\r\n    Administrator = 5,\r\n}\r\n","import {\r\n    _SharePointQueryableInstance,\r\n    _SharePointQueryableCollection,\r\n    spInvokableFactory,\r\n} from \"../sharepointqueryable\";\r\nimport { SiteUsers, ISiteUsers } from \"../site-users/types\";\r\nimport { assign, ITypedHash, hOP } from \"@pnp/common\";\r\nimport { metadata } from \"../utils/metadata\";\r\nimport { body } from \"@pnp/odata\";\r\nimport { defaultPath } from \"../decorators\";\r\nimport { spPost } from \"../operations\";\r\nimport { tag } from \"../telemetry\";\r\n\r\n@defaultPath(\"sitegroups\")\r\nexport class _SiteGroups extends _SharePointQueryableCollection<ISiteGroupInfo[]> {\r\n\r\n    /**\t\r\n     * Gets a group from the collection by id\t\r\n     *\t\r\n     * @param id The id of the group to retrieve\t\r\n     */\r\n    public getById(id: number): ISiteGroup {\r\n        return tag.configure(SiteGroup(this).concat(`(${id})`), \"sgs.getById\");\r\n    }\r\n\r\n    /**\r\n     * Adds a new group to the site collection\r\n     *\r\n     * @param properties The group properties object of property names and values to be set for the group\r\n     */\r\n    public async add(properties: ITypedHash<any>): Promise<IGroupAddResult> {\r\n\r\n        const postBody = body(assign(metadata(\"SP.Group\"), properties));\r\n\r\n        const data = await spPost(tag.configure(this, \"sgs.add\"), postBody);\r\n        return {\r\n            data,\r\n            group: this.getById(data.Id),\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Gets a group from the collection by name\r\n     *\r\n     * @param groupName The name of the group to retrieve\r\n     */\r\n    public getByName(groupName: string): ISiteGroup {\r\n        return tag.configure(SiteGroup(this, `getByName('${groupName}')`), \"sgs.getByName\");\r\n    }\r\n\r\n    /**\r\n     * Removes the group with the specified member id from the collection\r\n     *\r\n     * @param id The id of the group to remove\r\n     */\r\n    @tag(\"sgs.removeById\")\r\n    public removeById(id: number): Promise<void> {\r\n        return spPost(this.clone(SiteGroups, `removeById('${id}')`));\r\n    }\r\n\r\n    /**\r\n     * Removes the cross-site group with the specified name from the collection\r\n     *\r\n     * @param loginName The name of the group to remove\r\n     */\r\n    @tag(\"sgs.removeByLoginName\")\r\n    public removeByLoginName(loginName: string): Promise<any> {\r\n        return spPost(this.clone(SiteGroups, `removeByLoginName('${loginName}')`));\r\n    }\r\n}\r\nexport interface ISiteGroups extends _SiteGroups { }\r\nexport const SiteGroups = spInvokableFactory<ISiteGroups>(_SiteGroups);\r\n\r\nexport class _SiteGroup extends _SharePointQueryableInstance<ISiteGroupInfo> {\r\n\r\n    /**\r\n     * Gets the users for this group\r\n     *\r\n     */\r\n    public get users(): ISiteUsers {\r\n        return tag.configure(SiteUsers(this, \"users\"), \"sg.users\");\r\n    }\r\n\r\n    /**\r\n     * Updates the group with the given property values\r\n     * \r\n     * @param props The group properties object of property names and values to be set for the group\r\n     */\r\n    public update = this._update<IGroupUpdateResult, ITypedHash<any>>(\"SP.Group\", (d, p) => {\r\n\r\n        let retGroup: ISiteGroup = this;\r\n\r\n        if (hOP(p, \"Title\")) {\r\n            /* tslint:disable-next-line no-string-literal */\r\n            retGroup = this.getParent(SiteGroup, this.parentUrl, `getByName('${p[\"Title\"]}')`);\r\n        }\r\n\r\n        return {\r\n            data: d,\r\n            group: retGroup,\r\n        };\r\n    });\r\n\r\n    /**\r\n     * Set the owner of a group using a user id\r\n     * @param userId the id of the user that will be set as the owner of the current group\r\n     */\r\n    @tag(\"sg.setUserAsOwner\")\r\n    public setUserAsOwner(userId: number): Promise<any> {\r\n        return spPost(this.clone(SiteGroup, `SetUserAsOwner(${userId})`));\r\n    }\r\n}\r\nexport interface ISiteGroup extends _SiteGroup { }\r\nexport const SiteGroup = spInvokableFactory<ISiteGroup>(_SiteGroup);\r\n\r\n/**\r\n * Result from updating a group\r\n *\r\n */\r\nexport interface IGroupUpdateResult {\r\n    group: ISiteGroup;\r\n    data: any;\r\n}\r\n\r\n/**\r\n * Results from adding a group\r\n *\r\n */\r\nexport interface IGroupAddResult {\r\n    group: ISiteGroup;\r\n    data: any;\r\n}\r\n\r\nexport interface ISiteGroupInfo {\r\n    AllowMembersEditMembership: boolean;\r\n    AllowRequestToJoinLeave: boolean;\r\n    AutoAcceptRequestToJoinLeave: boolean;\r\n    Description: string;\r\n    Id: number;\r\n    IsHiddenInUI: boolean;\r\n    LoginName: string;\r\n    OnlyAllowMembersViewMembership: boolean;\r\n    OwnerTitle: string;\r\n    PrincipalType: number;\r\n    RequestToJoinLeaveEmailSetting: string | null;\r\n    Title: string;\r\n}\r\n","import { SecurableQueryable, IBasePermissions, PermissionKind } from \"./types\";\r\nimport { _SharePointQueryableInstance, _SharePointQueryable, SharePointQueryableInstance, SharePointQueryable } from \"../sharepointqueryable\";\r\nimport { hOP } from \"@pnp/common\";\r\nimport { spPost } from \"../operations\";\r\n\r\n/**\r\n* Gets the effective permissions for the user supplied\r\n*\r\n* @param loginName The claims username for the user (ex: i:0#.f|membership|user@domain.com)\r\n*/\r\nexport async function getUserEffectivePermissions(this: SecurableQueryable, loginName: string): Promise<IBasePermissions> {\r\n\r\n    const q = this.clone(SharePointQueryableInstance, \"getUserEffectivePermissions(@user)\");\r\n    q.query.set(\"@user\", `'${encodeURIComponent(loginName)}'`);\r\n    const r = await q.get<any>();\r\n    // handle verbose mode\r\n    return hOP(r, \"GetUserEffectivePermissions\") ? r.GetUserEffectivePermissions : r;\r\n}\r\n\r\n/**\r\n * Gets the effective permissions for the current user\r\n */\r\nexport async function getCurrentUserEffectivePermissions(this: SecurableQueryable): Promise<IBasePermissions> {\r\n\r\n    const q = this.clone(SharePointQueryable, \"EffectiveBasePermissions\");\r\n    return q.get<any>().then(r => {\r\n        // handle verbose mode\r\n        return hOP(r, \"EffectiveBasePermissions\") ? r.EffectiveBasePermissions : r;\r\n    });\r\n}\r\n\r\n/**\r\n * Breaks the security inheritance at this level optinally copying permissions and clearing subscopes\r\n *\r\n * @param copyRoleAssignments If true the permissions are copied from the current parent scope\r\n * @param clearSubscopes Optional. true to make all child securable objects inherit role assignments from the current object\r\n */\r\nexport async function breakRoleInheritance(this: SecurableQueryable, copyRoleAssignments = false, clearSubscopes = false): Promise<void> {\r\n    await spPost(this.clone(SharePointQueryable, `breakroleinheritance(copyroleassignments=${copyRoleAssignments}, clearsubscopes=${clearSubscopes})`));\r\n}\r\n\r\n/**\r\n * Removes the local role assignments so that it re-inherit role assignments from the parent object.\r\n *\r\n */\r\nexport async function resetRoleInheritance(this: SecurableQueryable): Promise<void> {\r\n    await spPost(this.clone(SharePointQueryable, \"resetroleinheritance\"));\r\n}\r\n\r\n/**\r\n * Determines if a given user has the appropriate permissions\r\n *\r\n * @param loginName The user to check\r\n * @param permission The permission being checked\r\n */\r\nexport async function userHasPermissions(this: SecurableQueryable, loginName: string, permission: PermissionKind): Promise<boolean> {\r\n\r\n    const perms = await getUserEffectivePermissions.call(this, loginName);\r\n    return this.hasPermissions(perms, permission);\r\n}\r\n\r\n/**\r\n * Determines if the current user has the requested permissions\r\n *\r\n * @param permission The permission we wish to check\r\n */\r\nexport async function currentUserHasPermissions(this: SecurableQueryable, permission: PermissionKind): Promise<boolean> {\r\n\r\n    const perms = await getCurrentUserEffectivePermissions.call(this);\r\n    return this.hasPermissions(perms, permission);\r\n}\r\n\r\n/**\r\n * Taken from sp.js, checks the supplied permissions against the mask\r\n *\r\n * @param value The security principal's permissions on the given object\r\n * @param perm The permission checked against the value\r\n */\r\n/* tslint:disable:no-bitwise */\r\nexport function hasPermissions(value: IBasePermissions, perm: PermissionKind): boolean {\r\n\r\n    if (!perm) {\r\n        return true;\r\n    }\r\n    if (perm === PermissionKind.FullMask) {\r\n        return (value.High & 32767) === 32767 && value.Low === 65535;\r\n    }\r\n\r\n    perm = perm - 1;\r\n    let num = 1;\r\n\r\n    if (perm >= 0 && perm < 32) {\r\n        num = num << perm;\r\n        return 0 !== (value.Low & num);\r\n    } else if (perm >= 32 && perm < 64) {\r\n        num = num << perm - 32;\r\n        return 0 !== (value.High & num);\r\n    }\r\n    return false;\r\n}\r\n/* tslint:enable */\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _Item } from \"../items/types\";\r\nimport { RoleAssignments, ISecurableMethods } from \"./types\";\r\nimport { _SharePointQueryableInstance, SharePointQueryableInstance } from \"../sharepointqueryable\";\r\nimport {\r\n    getUserEffectivePermissions,\r\n    getCurrentUserEffectivePermissions,\r\n    breakRoleInheritance,\r\n    resetRoleInheritance,\r\n    userHasPermissions,\r\n    currentUserHasPermissions,\r\n    hasPermissions,\r\n} from \"./funcs\";\r\n\r\ndeclare module \"../items/types\" {\r\n    interface _Item extends ISecurableMethods { }\r\n    interface IItem extends ISecurableMethods { }\r\n}\r\n\r\naddProp(_Item, \"roleAssignments\", RoleAssignments);\r\naddProp(_Item, \"firstUniqueAncestorSecurableObject\", SharePointQueryableInstance);\r\n\r\n_Item.prototype.getUserEffectivePermissions = getUserEffectivePermissions;\r\n_Item.prototype.getCurrentUserEffectivePermissions = getCurrentUserEffectivePermissions;\r\n_Item.prototype.breakRoleInheritance = breakRoleInheritance;\r\n_Item.prototype.resetRoleInheritance = resetRoleInheritance;\r\n_Item.prototype.userHasPermissions = userHasPermissions;\r\n_Item.prototype.currentUserHasPermissions = currentUserHasPermissions;\r\n_Item.prototype.hasPermissions = hasPermissions;\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _List } from \"../lists/types\";\r\nimport { RoleAssignments, ISecurableMethods } from \"./types\";\r\nimport { SharePointQueryableInstance } from \"../sharepointqueryable\";\r\nimport {\r\n    getUserEffectivePermissions,\r\n    getCurrentUserEffectivePermissions,\r\n    breakRoleInheritance,\r\n    resetRoleInheritance,\r\n    userHasPermissions,\r\n    currentUserHasPermissions,\r\n    hasPermissions,\r\n} from \"./funcs\";\r\n\r\ndeclare module \"../lists/types\" {\r\n    interface _List extends ISecurableMethods { }\r\n    interface IList extends ISecurableMethods { }\r\n}\r\n\r\naddProp(_List, \"roleAssignments\", RoleAssignments);\r\naddProp(_List, \"firstUniqueAncestorSecurableObject\", SharePointQueryableInstance);\r\n\r\n_List.prototype.getUserEffectivePermissions = getUserEffectivePermissions;\r\n_List.prototype.getCurrentUserEffectivePermissions = getCurrentUserEffectivePermissions;\r\n_List.prototype.breakRoleInheritance = breakRoleInheritance;\r\n_List.prototype.resetRoleInheritance = resetRoleInheritance;\r\n_List.prototype.userHasPermissions = userHasPermissions;\r\n_List.prototype.currentUserHasPermissions = currentUserHasPermissions;\r\n_List.prototype.hasPermissions = hasPermissions;\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _Web } from \"../webs/types\";\r\nimport { RoleDefinitions, IRoleDefinitions, RoleAssignments, ISecurableMethods } from \"./types\";\r\nimport { SharePointQueryableInstance } from \"../sharepointqueryable\";\r\nimport {\r\n    getUserEffectivePermissions,\r\n    getCurrentUserEffectivePermissions,\r\n    breakRoleInheritance,\r\n    resetRoleInheritance,\r\n    userHasPermissions,\r\n    currentUserHasPermissions,\r\n    hasPermissions,\r\n} from \"./funcs\";\r\n\r\ndeclare module \"../webs/types\" {\r\n    interface _Web extends ISecurableMethods {\r\n        roleDefinitions: IRoleDefinitions;\r\n    }\r\n    interface IWeb extends ISecurableMethods {\r\n        roleDefinitions: IRoleDefinitions;\r\n    }\r\n}\r\n\r\naddProp(_Web, \"roleDefinitions\", RoleDefinitions);\r\naddProp(_Web, \"roleAssignments\", RoleAssignments);\r\naddProp(_Web, \"firstUniqueAncestorSecurableObject\", SharePointQueryableInstance);\r\n\r\n_Web.prototype.getUserEffectivePermissions = getUserEffectivePermissions;\r\n_Web.prototype.getCurrentUserEffectivePermissions = getCurrentUserEffectivePermissions;\r\n_Web.prototype.breakRoleInheritance = breakRoleInheritance;\r\n_Web.prototype.resetRoleInheritance = resetRoleInheritance;\r\n_Web.prototype.userHasPermissions = userHasPermissions;\r\n_Web.prototype.currentUserHasPermissions = currentUserHasPermissions;\r\n_Web.prototype.hasPermissions = hasPermissions;\r\n","import { body } from \"@pnp/odata\";\r\nimport { jsS, assign } from \"@pnp/common\";\r\nimport { SharePointQueryableCollection, _SharePointQueryableInstance, SharePointQueryableInstance } from \"../sharepointqueryable\";\r\nimport { extractWebUrl } from \"../utils/extractweburl\";\r\nimport { Web, _Web } from \"../webs/types\";\r\nimport { _File } from \"../files/types\";\r\nimport {\r\n    ShareableQueryable,\r\n    ISharingResult,\r\n    SharingRole,\r\n    IShareObjectOptions,\r\n    SharingLinkKind,\r\n    IShareLinkResponse,\r\n    ISharingInformationRequest,\r\n    ISharingRecipient,\r\n    ISharingEntityPermission,\r\n    ISharingInformation,\r\n    IObjectSharingSettings,\r\n    ISharingEmailData,\r\n    RoleType,\r\n} from \"./types\";\r\nimport { spPost } from \"../operations\";\r\nimport { tag } from \"../telemetry\";\r\nimport { RoleDefinitions } from \"../security/types\";\r\nimport { emptyGuid } from \"../splibconfig\";\r\n\r\n/**\r\n * Shares an object based on the supplied options\r\n *\r\n * @param options The set of options to send to the ShareObject method\r\n * @param bypass If true any processing is skipped and the options are sent directly to the ShareObject method\r\n */\r\nexport async function shareObject(o: ShareableQueryable, options: IShareObjectOptions, bypass = false): Promise<ISharingResult> {\r\n\r\n    if (bypass) {\r\n\r\n        // if the bypass flag is set send the supplied parameters directly to the service\r\n        return sendShareObjectRequest(o, options);\r\n    }\r\n\r\n    // extend our options with some defaults\r\n    options = assign(options, {\r\n        group: null,\r\n        includeAnonymousLinkInEmail: false,\r\n        propagateAcl: false,\r\n        useSimplifiedRoles: true,\r\n    }, true);\r\n\r\n    const roleValue = await getRoleValue(options.role, options.group);\r\n\r\n    // handle the multiple input types\r\n    if (!Array.isArray(options.loginNames)) {\r\n        options.loginNames = [options.loginNames];\r\n    }\r\n\r\n    const userStr = jsS(options.loginNames.map(Key => ({ Key })));\r\n\r\n    let postBody = {\r\n        peoplePickerInput: userStr,\r\n        roleValue: roleValue,\r\n        url: options.url,\r\n    };\r\n\r\n    if (options.emailData !== undefined && options.emailData !== null) {\r\n        postBody = assign(postBody, {\r\n            emailBody: options.emailData.body,\r\n            emailSubject: options.emailData.subject !== undefined ? options.emailData.subject : \"Shared with you.\",\r\n            sendEmail: true,\r\n        });\r\n    }\r\n\r\n    return sendShareObjectRequest(o, postBody);\r\n}\r\n\r\n/**\r\n * Gets a sharing link for the supplied\r\n *\r\n * @param kind The kind of link to share\r\n * @param expiration The optional expiration for this link\r\n */\r\nexport function getShareLink(this: ShareableQueryable, kind: SharingLinkKind, expiration: Date = null): Promise<IShareLinkResponse> {\r\n\r\n    // date needs to be an ISO string or null\r\n    const expString = expiration !== null ? expiration.toISOString() : null;\r\n\r\n    // clone using the factory and send the request\r\n    const o = tag.configure(this.clone(SharePointQueryableInstance, \"shareLink\"), \"sh.getShareLink\");\r\n    return spPost<IShareLinkResponse>(o, body({\r\n        request: {\r\n            createLink: true,\r\n            emailData: null,\r\n            settings: {\r\n                expiration: expString,\r\n                linkKind: kind,\r\n            },\r\n        },\r\n    }));\r\n}\r\n\r\n/**\r\n * Checks Permissions on the list of Users and returns back role the users have on the Item.\r\n *\r\n * @param recipients The array of Entities for which Permissions need to be checked.\r\n */\r\nexport function checkPermissions(this: ShareableQueryable, recipients: ISharingRecipient[]): Promise<ISharingEntityPermission[]> {\r\n\r\n    const o = tag.configure(this.clone(SharePointQueryableInstance, \"checkPermissions\"), \"sh.checkPermissions\");\r\n    return spPost<ISharingEntityPermission[]>(o, body({ recipients }));\r\n}\r\n\r\n/**\r\n * Get Sharing Information.\r\n *\r\n * @param request The SharingInformationRequest Object.\r\n * @param expands Expand more fields.\r\n * \r\n */\r\nexport function getSharingInformation(this: ShareableQueryable, request: ISharingInformationRequest = null, expands: string[] = []): Promise<ISharingInformation> {\r\n\r\n    const o = tag.configure(this.clone(SharePointQueryableInstance, \"getSharingInformation\"), \"sh.getSharingInformation\");\r\n    return spPost(o.expand(...expands), body({ request }));\r\n}\r\n\r\n/**\r\n * Gets the sharing settings of an item.\r\n *\r\n * @param useSimplifiedRoles Determines whether to use simplified roles.\r\n */\r\nexport function getObjectSharingSettings(this: ShareableQueryable, useSimplifiedRoles = true): Promise<IObjectSharingSettings> {\r\n\r\n    const o = tag.configure(this.clone(SharePointQueryableInstance, \"getObjectSharingSettings\"), \"sh.getObjectSharingSettings\");\r\n    return spPost<IObjectSharingSettings>(o, body({ useSimplifiedRoles }));\r\n}\r\n\r\n/**\r\n * Unshares this object\r\n */\r\nexport function unshareObject(this: ShareableQueryable): Promise<ISharingResult> {\r\n\r\n    return spPost(tag.configure(this.clone(SharePointQueryableInstance, \"unshareObject\"), \"sh.unshareObject\"));\r\n}\r\n\r\n/**\r\n * Deletes a link by type\r\n *\r\n * @param kind Deletes a sharing link by the kind of link\r\n */\r\nexport function deleteLinkByKind(this: ShareableQueryable, linkKind: SharingLinkKind): Promise<void> {\r\n\r\n    return spPost(tag.configure(this.clone(SharePointQueryableInstance, \"deleteLinkByKind\"), \"sh.deleteLinkByKind\"), body({ linkKind }));\r\n}\r\n\r\n/**\r\n * Removes the specified link to the item.\r\n *\r\n * @param kind The kind of link to be deleted.\r\n * @param shareId\r\n */\r\nexport function unshareLink(this: ShareableQueryable, linkKind: SharingLinkKind, shareId = emptyGuid): Promise<void> {\r\n\r\n    return spPost(tag.configure(this.clone(SharePointQueryableInstance, \"unshareLink\"), \"sh.unshareLink\"), body({ linkKind, shareId }));\r\n}\r\n\r\n/**\r\n * Shares this instance with the supplied users\r\n *\r\n * @param loginNames Resolved login names to share\r\n * @param role The role\r\n * @param requireSignin True to require the user is authenticated, otherwise false\r\n * @param propagateAcl True to apply this share to all children\r\n * @param emailData If supplied an email will be sent with the indicated properties\r\n */\r\nexport async function shareWith(\r\n    o: ShareableQueryable,\r\n    loginNames: string | string[],\r\n    role: SharingRole,\r\n    requireSignin = false,\r\n    propagateAcl = false,\r\n    emailData?: ISharingEmailData): Promise<ISharingResult> {\r\n\r\n    // handle the multiple input types\r\n    if (!Array.isArray(loginNames)) {\r\n        loginNames = [loginNames];\r\n    }\r\n\r\n    const userStr = jsS(loginNames.map(login => { return { Key: login }; }));\r\n    const roleFilter = role === SharingRole.Edit ? RoleType.Contributor : RoleType.Reader;\r\n\r\n    // start by looking up the role definition id we need to set the roleValue\r\n    // remove need to reference Web here, which created a circular build issue\r\n    const w = SharePointQueryableCollection(\"_api/web\", \"roledefinitions\");\r\n    const def = await w.select(\"Id\").filter(`RoleTypeKind eq ${roleFilter}`).get();\r\n    if (!Array.isArray(def) || def.length < 1) {\r\n        throw Error(`Could not locate a role defintion with RoleTypeKind ${roleFilter}`);\r\n    }\r\n    let postBody = {\r\n        includeAnonymousLinkInEmail: requireSignin,\r\n        peoplePickerInput: userStr,\r\n        propagateAcl: propagateAcl,\r\n        roleValue: `role:${def[0].Id}`,\r\n        useSimplifiedRoles: true,\r\n    };\r\n    if (emailData !== undefined) {\r\n        postBody = assign(postBody, {\r\n            emailBody: emailData.body,\r\n            emailSubject: emailData.subject !== undefined ? emailData.subject : \"\",\r\n            sendEmail: true,\r\n        });\r\n    }\r\n\r\n    return spPost<ISharingResult>(tag.configure(o.clone(SharePointQueryableInstance, \"shareObject\"), \"sh.shareWith\"), body(postBody));\r\n}\r\n\r\nfunction sendShareObjectRequest(o: ShareableQueryable, options: any): Promise<ISharingResult> {\r\n\r\n    const w = tag.configure(Web(extractWebUrl(o.toUrl()), \"/_api/SP.Web.ShareObject\"), \"sh.sendShareObjectRequest\");\r\n    return spPost(w.expand(\"UsersWithAccessRequests\", \"GroupsSharedWith\"), body(options));\r\n}\r\n\r\n/**\r\n * Calculates the roleValue string used in the sharing query\r\n *\r\n * @param role The Sharing Role\r\n * @param group The Group type\r\n */\r\nasync function getRoleValue(role: SharingRole, group: RoleType): Promise<string> {\r\n\r\n    // we will give group precedence, because we had to make a choice\r\n    if (group !== undefined && group !== null) {\r\n\r\n        switch (group) {\r\n            case RoleType.Contributor:\r\n                const g1 = await Web(\"_api/web\", \"associatedmembergroup\").select(\"Id\")<{ Id: number; }>();\r\n                return `group: ${g1.Id}`;\r\n            case RoleType.Reader:\r\n            case RoleType.Guest:\r\n                const g2 = await Web(\"_api/web\", \"associatedvisitorgroup\").select(\"Id\")<{ Id: number; }>();\r\n                return `group: ${g2.Id}`;\r\n            default:\r\n                throw Error(\"Could not determine role value for supplied value. Contributor, Reader, and Guest are supported\");\r\n        }\r\n    } else {\r\n\r\n        const roleFilter = role === SharingRole.Edit ? RoleType.Contributor : RoleType.Reader;\r\n        const def = await RoleDefinitions(\"_api/web\").select(\"Id\").top(1).filter(`RoleTypeKind eq ${roleFilter}`)<{ Id: number; }[]>();\r\n        if (def.length < 1) {\r\n            throw Error(\"Could not locate associated role definition for supplied role. Edit and View are supported\");\r\n        }\r\n        return `role: ${def[0].Id}`;\r\n    }\r\n}\r\n\r\n","import { _File } from \"../files/types\";\r\nimport {\r\n    ISharingEmailData,\r\n    ISharingResult,\r\n    SharingRole,\r\n    ISharedFuncs,\r\n} from \"./types\";\r\nimport {\r\n    shareWith,\r\n    getShareLink,\r\n    checkPermissions,\r\n    getSharingInformation,\r\n    getObjectSharingSettings,\r\n    unshareObject,\r\n    deleteLinkByKind,\r\n    unshareLink,\r\n} from \"./funcs\";\r\n\r\ndeclare module \"../files/types\" {\r\n    interface _File extends ISharedFuncs {\r\n        shareWith(loginNames: string | string[], role?: SharingRole, requireSignin?: boolean, emailData?: ISharingEmailData): Promise<ISharingResult>;\r\n    }\r\n    interface IFile extends ISharedFuncs {\r\n        /**\r\n         * Shares this item with one or more users\r\n         *\r\n         * @param loginNames string or string[] of resolved login names to which this item will be shared\r\n         * @param role The role (View | Edit) applied to the share\r\n         * @param shareEverything Share everything in this folder, even items with unique permissions.\r\n         * @param requireSignin If true the user must signin to view link, otherwise anyone with the link can access the resource\r\n         * @param emailData Optional, if inlucded an email will be sent. Note subject currently has no effect.\r\n         */\r\n        shareWith(loginNames: string | string[], role?: SharingRole, requireSignin?: boolean, emailData?: ISharingEmailData): Promise<ISharingResult>;\r\n    }\r\n}\r\n\r\n_File.prototype.shareWith = function (\r\n    this: _File,\r\n    loginNames: string | string[],\r\n    role: SharingRole = SharingRole.View,\r\n    requireSignin = false,\r\n    emailData?: ISharingEmailData): Promise<ISharingResult> {\r\n\r\n    return shareWith(this, loginNames, role, requireSignin, false, emailData);\r\n};\r\n\r\n_File.prototype.getShareLink = getShareLink;\r\n_File.prototype.checkSharingPermissions = checkPermissions;\r\n_File.prototype.getSharingInformation = getSharingInformation;\r\n_File.prototype.getObjectSharingSettings = getObjectSharingSettings;\r\n_File.prototype.unshare = unshareObject;\r\n_File.prototype.deleteSharingLinkByKind = deleteLinkByKind;\r\n_File.prototype.unshareLink = unshareLink;\r\n","import {\r\n    _Folder,\r\n} from \"../folders/types\";\r\nimport {\r\n    ISharingEmailData,\r\n    ISharingResult,\r\n    SharingRole,\r\n    ISharedFuncs,\r\n    ISharingInformationRequest,\r\n    SharingLinkKind,\r\n    ISharingRecipient,\r\n} from \"./types\";\r\n\r\ndeclare module \"../folders/types\" {\r\n    interface _Folder extends ISharedFuncs {\r\n        shareWith(loginNames: string | string[], role?: SharingRole, requireSignin?: boolean, shareEverything?: boolean, emailData?: ISharingEmailData): Promise<ISharingResult>;\r\n    }\r\n    interface IFolder extends ISharedFuncs {\r\n        shareWith(loginNames: string | string[], role?: SharingRole, requireSignin?: boolean, shareEverything?: boolean, emailData?: ISharingEmailData): Promise<ISharingResult>;\r\n    }\r\n}\r\n\r\n_Folder.prototype.shareWith = async function (\r\n    loginNames: string | string[],\r\n    role: SharingRole = SharingRole.View,\r\n    requireSignin = false,\r\n    shareEverything = false,\r\n    emailData?: ISharingEmailData): Promise<ISharingResult> {\r\n\r\n    const dependency = this.addBatchDependency();\r\n\r\n    const shareable = await this.getShareable();\r\n    dependency();\r\n    return shareable.shareWith(loginNames, role, requireSignin, shareEverything, emailData);\r\n};\r\n\r\n_Folder.prototype.getShareLink = async function (this: _Folder, kind: SharingLinkKind, expiration: Date = null): Promise<any> {\r\n    const dependency = this.addBatchDependency();\r\n\r\n    const shareable = await this.getShareable();\r\n    dependency();\r\n    return shareable.getShareLink(kind, expiration);\r\n};\r\n\r\n_Folder.prototype.checkSharingPermissions = async function (this: _Folder, recipients: ISharingRecipient[]): Promise<any> {\r\n    const dependency = this.addBatchDependency();\r\n\r\n    const shareable = await this.getShareable();\r\n    dependency();\r\n    return shareable.checkSharingPermissions(recipients);\r\n};\r\n\r\n_Folder.prototype.getSharingInformation = async function (this: _Folder, request?: ISharingInformationRequest, expands?: string[]): Promise<any> {\r\n    const dependency = this.addBatchDependency();\r\n\r\n    const shareable = await this.getShareable();\r\n    dependency();\r\n    return shareable.getSharingInformation(request, expands);\r\n};\r\n\r\n_Folder.prototype.getObjectSharingSettings = async function (this: _Folder, useSimplifiedRoles = true): Promise<any> {\r\n    const dependency = this.addBatchDependency();\r\n\r\n    const shareable = await this.getShareable();\r\n    dependency();\r\n    return shareable.getObjectSharingSettings(useSimplifiedRoles);\r\n};\r\n\r\n_Folder.prototype.unshare = async function (this: _Folder): Promise<any> {\r\n    const dependency = this.addBatchDependency();\r\n\r\n    const shareable = await this.getShareable();\r\n    dependency();\r\n    return shareable.unshare();\r\n};\r\n\r\n_Folder.prototype.deleteSharingLinkByKind = async function (this: _Folder, kind: SharingLinkKind): Promise<any> {\r\n    const dependency = this.addBatchDependency();\r\n\r\n    const shareable = await this.getShareable();\r\n    dependency();\r\n    return shareable.deleteSharingLinkByKind(kind);\r\n};\r\n\r\n_Folder.prototype.unshareLink = async function (this: _Folder, kind: SharingLinkKind, shareId?: string): Promise<any> {\r\n    const dependency = this.addBatchDependency();\r\n\r\n    const shareable = await this.getShareable();\r\n    dependency();\r\n    return shareable.unshareLink(kind, shareId);\r\n};\r\n","import { _Item } from \"../items/types\";\r\nimport {\r\n    ISharingEmailData,\r\n    ISharingResult,\r\n    SharingRole,\r\n    ISharedFuncs,\r\n} from \"./types\";\r\n\r\nimport {\r\n    shareWith,\r\n    getShareLink,\r\n    checkPermissions,\r\n    getSharingInformation,\r\n    getObjectSharingSettings,\r\n    unshareObject,\r\n    deleteLinkByKind,\r\n    unshareLink,\r\n} from \"./funcs\";\r\n\r\ndeclare module \"../items/types\" {\r\n    interface _Item extends ISharedFuncs {\r\n        shareWith(loginNames: string | string[], role?: SharingRole, requireSignin?: boolean, emailData?: ISharingEmailData): Promise<ISharingResult>;\r\n    }\r\n    interface IItem extends ISharedFuncs {\r\n        /**\r\n         * Shares this item with one or more users\r\n         *\r\n         * @param loginNames string or string[] of resolved login names to which this item will be shared\r\n         * @param role The role (View | Edit) applied to the share\r\n         * @param emailData Optional, if inlucded an email will be sent. Note subject currently has no effect.\r\n         */\r\n        shareWith(loginNames: string | string[], role?: SharingRole, requireSignin?: boolean, emailData?: ISharingEmailData): Promise<ISharingResult>;\r\n    }\r\n}\r\n\r\n\r\n_Item.prototype.shareWith = function (\r\n    this: _Item,\r\n    loginNames: string | string[],\r\n    role: SharingRole = SharingRole.View,\r\n    requireSignin = false,\r\n    emailData?: ISharingEmailData): Promise<ISharingResult> {\r\n\r\n    return shareWith(this, loginNames, role, requireSignin, false, emailData);\r\n};\r\n\r\n_Item.prototype.getShareLink = getShareLink;\r\n_Item.prototype.checkSharingPermissions = checkPermissions;\r\n_Item.prototype.getSharingInformation = getSharingInformation;\r\n_Item.prototype.getObjectSharingSettings = getObjectSharingSettings;\r\n_Item.prototype.unshare = unshareObject;\r\n_Item.prototype.deleteSharingLinkByKind = deleteLinkByKind;\r\n_Item.prototype.unshareLink = unshareLink;\r\n","import { _Web, Web } from \"../webs/types\";\r\nimport { ISharingEmailData, ISharingResult, SharingRole } from \"./types\";\r\nimport { _SharePointQueryableInstance } from \"../sharepointqueryable\";\r\nimport { extractWebUrl } from \"../utils/extractweburl\";\r\nimport { RoleType } from \"./types\";\r\nimport { shareObject } from \"./funcs\";\r\nimport { combine } from \"@pnp/common\";\r\nimport { body } from \"@pnp/odata\";\r\nimport { spPost } from \"../operations\";\r\n\r\n/**\r\n * Extend _Web\r\n */\r\ndeclare module \"../webs/types\" {\r\n    interface _Web {\r\n        shareWith: (loginNames: string | string[], role?: SharingRole, emailData?: ISharingEmailData) => Promise<ISharingResult>;\r\n        shareObject: (url: string,\r\n            loginNames: string | string[],\r\n            role: SharingRole,\r\n            emailData?: ISharingEmailData,\r\n            group?: RoleType,\r\n            propagateAcl?: boolean,\r\n            includeAnonymousLinkInEmail?: boolean,\r\n            useSimplifiedRoles?: boolean) => Promise<ISharingResult>;\r\n        shareObjectRaw(options: any): Promise<ISharingResult>;\r\n        unshareObject(url: string): Promise<ISharingResult>;\r\n    }\r\n    interface IWeb {\r\n        shareWith: (loginNames: string | string[], role?: SharingRole, emailData?: ISharingEmailData) => Promise<ISharingResult>;\r\n        shareObject: (url: string,\r\n            loginNames: string | string[],\r\n            role: SharingRole,\r\n            emailData?: ISharingEmailData,\r\n            group?: RoleType,\r\n            propagateAcl?: boolean,\r\n            includeAnonymousLinkInEmail?: boolean,\r\n            useSimplifiedRoles?: boolean) => Promise<ISharingResult>;\r\n        shareObjectRaw(options: any): Promise<ISharingResult>;\r\n        unshareObject(url: string): Promise<ISharingResult>;\r\n    }\r\n}\r\n\r\n/**\r\n * Shares this web with the supplied users\r\n * @param loginNames The resolved login names to share\r\n * @param role The role to share this web\r\n * @param emailData Optional email data\r\n */\r\n_Web.prototype.shareWith = async function (\r\n    this: _Web,\r\n    loginNames: string | string[],\r\n    role: SharingRole = SharingRole.View,\r\n    emailData?: ISharingEmailData): Promise<ISharingResult> {\r\n\r\n    const dependency = this.addBatchDependency();\r\n    // remove need to reference Web here, which created a circular build issue\r\n    const web = new _SharePointQueryableInstance(extractWebUrl(this.toUrl()), \"/_api/web/url\");\r\n\r\n    const url = await web.get();\r\n    dependency();\r\n\r\n    return this.shareObject(combine(url, \"/_layouts/15/aclinv.aspx?forSharing=1&mbypass=1\"), loginNames, role, emailData);\r\n};\r\n\r\n/**\r\n * Provides direct access to the static web.ShareObject method\r\n *\r\n * @param url The url to share\r\n * @param loginNames Resolved loginnames string[] of a single login name string\r\n * @param roleValue Role value\r\n * @param emailData Optional email data\r\n * @param groupId Optional group id\r\n * @param propagateAcl\r\n * @param includeAnonymousLinkInEmail\r\n * @param useSimplifiedRoles\r\n */\r\n_Web.prototype.shareObject = function (\r\n    this: _Web,\r\n    url: string,\r\n    loginNames: string | string[],\r\n    role: SharingRole,\r\n    emailData?: ISharingEmailData,\r\n    group?: RoleType,\r\n    propagateAcl = false,\r\n    includeAnonymousLinkInEmail = false,\r\n    useSimplifiedRoles = true): Promise<ISharingResult> {\r\n\r\n    return shareObject(this, {\r\n        emailData: emailData,\r\n        group: group,\r\n        includeAnonymousLinkInEmail: includeAnonymousLinkInEmail,\r\n        loginNames: loginNames,\r\n        propagateAcl: propagateAcl,\r\n        role: role,\r\n        url: url,\r\n        useSimplifiedRoles: useSimplifiedRoles,\r\n    });\r\n};\r\n\r\n/**\r\n * Supplies a method to pass any set of arguments to ShareObject\r\n *\r\n * @param options The set of options to send to ShareObject\r\n */\r\n_Web.prototype.shareObjectRaw = function (this: _Web, options: any): Promise<ISharingResult> {\r\n    return shareObject(this, options, true);\r\n};\r\n\r\n/**\r\n * Supplies a method to pass any set of arguments to ShareObject\r\n *\r\n * @param options The set of options to send to ShareObject\r\n */\r\n_Web.prototype.unshareObject = function (this: _Web, url: string): Promise<ISharingResult> {\r\n    return spPost(Web(this, \"unshareObject\"), body({ url }));\r\n};\r\n","import { _SharePointQueryable, ISharePointQueryable } from \"../sharepointqueryable\";\r\nimport { extractWebUrl } from \"../utils/extractweburl\";\r\nimport { headers, body } from \"@pnp/odata\";\r\nimport { spPost } from \"../operations\";\r\nimport { hOP } from \"@pnp/common\";\r\nimport { tag } from \"../telemetry\";\r\n\r\nexport class _SiteDesigns extends _SharePointQueryable {\r\n\r\n    constructor(baseUrl: string | ISharePointQueryable, methodName = \"\") {\r\n        const url = typeof baseUrl === \"string\" ? baseUrl : baseUrl.toUrl();\r\n        super(extractWebUrl(url), `_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.${methodName}`);\r\n    }\r\n\r\n    public execute<T>(props: any): Promise<T> {\r\n        return spPost<T>(this, body(props, headers({ \"Content-Type\": \"application/json;charset=utf-8\" })));\r\n    }\r\n\r\n    /**\r\n     * Creates a new site design available to users when they create a new site from the SharePoint home page.\r\n     * \r\n     * @param creationInfo A sitedesign creation information object\r\n     */\r\n    @tag(\"sd.createSiteDesign\")\r\n    public createSiteDesign(creationInfo: ISiteDesignCreationInfo): Promise<ISiteDesignInfo> {\r\n        return this.clone(SiteDesignsCloneFactory, `CreateSiteDesign`).execute<ISiteDesignInfo>({ info: creationInfo });\r\n    }\r\n\r\n    /**\r\n     * Applies a site design to an existing site collection.\r\n     *\r\n     * @param siteDesignId The ID of the site design to apply.\r\n     * @param webUrl The URL of the site collection where you want to apply the site design.\r\n     */\r\n    @tag(\"sd.applySiteDesign\")\r\n    public applySiteDesign(siteDesignId: string, webUrl: string): Promise<void> {\r\n        return this.clone(SiteDesignsCloneFactory, `ApplySiteDesign`).execute<void>({ siteDesignId: siteDesignId, \"webUrl\": webUrl });\r\n    }\r\n\r\n    /**\r\n     * Gets the list of available site designs\r\n     */\r\n    @tag(\"sd.getSiteDesigns\")\r\n    public getSiteDesigns(): Promise<ISiteDesignInfo[]> {\r\n        return this.clone(SiteDesignsCloneFactory, `GetSiteDesigns`).execute<ISiteDesignInfo[]>({});\r\n    }\r\n\r\n    /**\r\n     * Gets information about a specific site design.\r\n     * @param id The ID of the site design to get information about.\r\n     */\r\n    @tag(\"sd.getSiteDesignMetadata\")\r\n    public getSiteDesignMetadata(id: string): Promise<ISiteDesignInfo> {\r\n        return this.clone(SiteDesignsCloneFactory, `GetSiteDesignMetadata`).execute<ISiteDesignInfo>({ id: id });\r\n    }\r\n\r\n    /**\r\n     * Updates a site design with new values. In the REST call, all parameters are optional except the site script Id.\r\n     * If you had previously set the IsDefault parameter to TRUE and wish it to remain true, you must pass in this parameter again (otherwise it will be reset to FALSE). \r\n     * @param updateInfo A sitedesign update information object\r\n     */\r\n    @tag(\"sd.updateSiteDesign\")\r\n    public updateSiteDesign(updateInfo: ISiteDesignUpdateInfo): Promise<ISiteDesignInfo> {\r\n        return this.clone(SiteDesignsCloneFactory, `UpdateSiteDesign`).execute<ISiteDesignInfo>({ updateInfo: updateInfo });\r\n    }\r\n\r\n    /**\r\n     * Deletes a site design.\r\n     * @param id The ID of the site design to delete.\r\n     */\r\n    @tag(\"sd.deleteSiteDesign\")\r\n    public deleteSiteDesign(id: string): Promise<void> {\r\n        return this.clone(SiteDesignsCloneFactory, `DeleteSiteDesign`).execute<void>({ id: id });\r\n    }\r\n\r\n    /**\r\n     * Gets a list of principals that have access to a site design.\r\n     * @param id The ID of the site design to get rights information from.\r\n     */\r\n    @tag(\"sd.getSiteDesignRights\")\r\n    public getSiteDesignRights(id: string): Promise<ISiteDesignPrincipals[]> {\r\n        return this.clone(SiteDesignsCloneFactory, `GetSiteDesignRights`).execute<ISiteDesignPrincipals[]>({ id: id });\r\n    }\r\n\r\n    /**\r\n     * Grants access to a site design for one or more principals.\r\n     * @param id The ID of the site design to grant rights on.\r\n     * @param principalNames An array of one or more principals to grant view rights. \r\n     *                       Principals can be users or mail-enabled security groups in the form of \"alias\" or \"alias@<domain name>.com\"\r\n     * @param grantedRights Always set to 1. This represents the View right.\r\n     */\r\n    @tag(\"sd.grantSiteDesignRights\")\r\n    public grantSiteDesignRights(id: string, principalNames: string[], grantedRights = 1): Promise<void> {\r\n        return this.clone(SiteDesignsCloneFactory, `GrantSiteDesignRights`)\r\n            .execute<void>({\r\n                \"grantedRights\": grantedRights.toString(),\r\n                \"id\": id,\r\n                \"principalNames\": principalNames,\r\n            });\r\n    }\r\n\r\n    /**\r\n     * Revokes access from a site design for one or more principals.\r\n     * @param id The ID of the site design to revoke rights from.\r\n     * @param principalNames An array of one or more principals to revoke view rights from. \r\n     *                       If all principals have rights revoked on the site design, the site design becomes viewable to everyone.\r\n     */\r\n    @tag(\"sd.revokeSiteDesignRights\")\r\n    public revokeSiteDesignRights(id: string, principalNames: string[]): Promise<void> {\r\n        return this.clone(SiteDesignsCloneFactory, `RevokeSiteDesignRights`)\r\n            .execute<void>({\r\n                \"id\": id,\r\n                \"principalNames\": principalNames,\r\n            });\r\n    }\r\n\r\n    /**\r\n     * Adds a site design task on the specified web url to be invoked asynchronously.\r\n     * @param webUrl The absolute url of the web on where to create the task\r\n     * @param siteDesignId The ID of the site design to create a task for\r\n     */\r\n    @tag(\"sd.addSiteDesignTask\")\r\n    public addSiteDesignTask(webUrl: string, siteDesignId: string): Promise<ISiteDesignTask> {\r\n        return this.clone(SiteDesignsCloneFactory, `AddSiteDesignTask`)\r\n            .execute<ISiteDesignTask>({ \"webUrl\": webUrl, \"siteDesignId\": siteDesignId });\r\n    }\r\n\r\n    /**\r\n     * Adds a site design task on the current web to be invoked asynchronously.\r\n     * @param siteDesignId The ID of the site design to create a task for\r\n     */\r\n    @tag(\"sd.addSiteDesignTaskToCurrentWeb\")\r\n    public addSiteDesignTaskToCurrentWeb(siteDesignId: string): Promise<ISiteDesignTask> {\r\n        return this.clone(SiteDesignsCloneFactory, `AddSiteDesignTaskToCurrentWeb`)\r\n            .execute<ISiteDesignTask>({ \"siteDesignId\": siteDesignId });\r\n    }\r\n\r\n    /**\r\n     * Retrieves the site design task, if the task has finished running null will be returned\r\n     * @param id The ID of the site design task\r\n     */\r\n    @tag(\"sd.getSiteDesignTask\")\r\n    public async getSiteDesignTask(id: string): Promise<ISiteDesignTask> {\r\n        const task = await this.clone(SiteDesignsCloneFactory, `GetSiteDesignTask`)\r\n            .execute<ISiteDesignTask>({ \"taskId\": id });\r\n\r\n        return hOP(task, \"ID\") ? task : null;\r\n    }\r\n\r\n    /**\r\n     * Retrieves a list of site design that have run on a specific web\r\n     * @param webUrl The url of the web where the site design was applied\r\n     * @param siteDesignId (Optional) the site design ID, if not provided will return all site design runs\r\n     */\r\n    @tag(\"sd.getSiteDesignRun\")\r\n    public getSiteDesignRun(webUrl: string, siteDesignId?: string): Promise<ISiteDesignRun[]> {\r\n        return this.clone(SiteDesignsCloneFactory, `GetSiteDesignRun`)\r\n            .execute<ISiteDesignRun[]>({ \"webUrl\": webUrl, siteDesignId: siteDesignId });\r\n    }\r\n\r\n    /**\r\n     * Retrieves the status of a site design that has been run or is still running\r\n     * @param webUrl The url of the web where the site design was applied\r\n     * @param runId the run ID\r\n     */\r\n    @tag(\"sd.getSiteDesignRunStatus\")\r\n    public getSiteDesignRunStatus(webUrl: string, runId: string): Promise<ISiteScriptActionStatus[]> {\r\n        return this.clone(SiteDesignsCloneFactory, `GetSiteDesignRunStatus`)\r\n            .execute<ISiteScriptActionStatus[]>({ \"webUrl\": webUrl, runId: runId });\r\n    }\r\n}\r\nexport interface ISiteDesigns extends _SiteDesigns { }\r\nexport const SiteDesigns = (baseUrl: string | ISharePointQueryable, methodName?: string): ISiteDesigns => new _SiteDesigns(baseUrl, methodName);\r\n\r\ntype SiteDesignsCloneType = ISiteDesigns & ISharePointQueryable & { execute<T>(props: any): Promise<T> };\r\nconst SiteDesignsCloneFactory = (baseUrl: string | ISharePointQueryable, methodName = \"\"): SiteDesignsCloneType => <any>SiteDesigns(baseUrl, methodName);\r\n\r\n/**\r\n * Result from creating or retrieving a site design\r\n *\r\n */\r\nexport interface ISiteDesignInfo {\r\n    /**\r\n     * The ID of the site design to apply.\r\n     */\r\n    Id: string;\r\n    /**\r\n     * The display name of the site design.\r\n     */\r\n    Title: string;\r\n    /**\r\n     * Identifies which base template to add the design to. Use the value 64 for the Team site template, and the value 68 for the Communication site template.\r\n     */\r\n    WebTemplate: string;\r\n    /**\r\n     * An array of one or more site scripts. Each is identified by an ID. The scripts will run in the order listed.\r\n     */\r\n    SiteScriptIds: string[];\r\n    /**\r\n     * The display description of site design.\r\n     */\r\n    Description: string;\r\n    /**\r\n     * The URL of a preview image. If none is specified, SharePoint uses a generic image.\r\n     */\r\n    PreviewImageUrl: string;\r\n    /**\r\n     * The alt text description of the image for accessibility.\r\n     */\r\n    PreviewImageAltText: string;\r\n    /**\r\n     * True if the site design is applied as the default site design; otherwise, false. \r\n     * For more information see Customize a default site design https://docs.microsoft.com/en-us/sharepoint/dev/declarative-customization/customize-default-site-design.\r\n     */\r\n    IsDefault: boolean;\r\n    /**\r\n     * The version number of the site design\r\n     */\r\n    Version: string;\r\n}\r\n\r\n/**\r\n * Data for creating a site design\r\n *\r\n */\r\nexport interface ISiteDesignCreationInfo {\r\n    /**\r\n     * The display name of the site design.\r\n     */\r\n    Title: string;\r\n    /**\r\n     * Identifies which base template to add the design to. Use the value 64 for the Team site template, and the value 68 for the Communication site template.\r\n     */\r\n    WebTemplate: string;\r\n    /**\r\n     * An array of one or more site scripts. Each is identified by an ID. The scripts will run in the order listed.\r\n     */\r\n    SiteScriptIds?: string[];\r\n    /**\r\n     * (Optional) The display description of site design.\r\n     */\r\n    Description?: string;\r\n    /**\r\n     * (Optional) The URL of a preview image. If none is specified, SharePoint uses a generic image.\r\n     */\r\n    PreviewImageUrl?: string;\r\n    /**\r\n     * (Optional) The alt text description of the image for accessibility.\r\n     */\r\n    PreviewImageAltText?: string;\r\n    /**\r\n     * (Optional) True if the site design is applied as the default site design; otherwise, false. \r\n     * For more information see Customize a default site design https://docs.microsoft.com/en-us/sharepoint/dev/declarative-customization/customize-default-site-design.\r\n     */\r\n    IsDefault?: boolean;\r\n}\r\n\r\n/**\r\n * Data for updating a site design\r\n *\r\n */\r\nexport interface ISiteDesignUpdateInfo {\r\n    /**\r\n     * The ID of the site design to apply.\r\n     */\r\n    Id: string;\r\n    /**\r\n     * (Optional) The new display name of the updated site design.\r\n     */\r\n    Title?: string;\r\n    /**\r\n     * (Optional) The new template to add the site design to. Use the value 64 for the Team site template, and the value 68 for the Communication site template.\r\n     */\r\n    WebTemplate?: string;\r\n    /**\r\n     * (Optional) A new array of one or more site scripts. Each is identified by an ID. The scripts run in the order listed.\r\n     */\r\n    SiteScriptIds?: string[];\r\n    /**\r\n     * (Optional) The new display description of the updated site design.\r\n     */\r\n    Description?: string;\r\n    /**\r\n     * (Optional) The new URL of a preview image.\r\n     */\r\n    PreviewImageUrl?: string;\r\n    /**\r\n     * (Optional) The new alt text description of the image for accessibility.\r\n     */\r\n    PreviewImageAltText?: string;\r\n    /**\r\n     * (Optional) True if the site design is applied as the default site design; otherwise, false. \r\n     * For more information see Customize a default site design https://docs.microsoft.com/en-us/sharepoint/dev/declarative-customization/customize-default-site-design. \r\n     * If you had previously set the IsDefault parameter to TRUE and wish it to remain true, you must pass in this parameter again (otherwise it will be reset to FALSE).\r\n     */\r\n    IsDefault?: boolean;\r\n}\r\n\r\n/**\r\n * Result from retrieving the rights for a site design\r\n *\r\n */\r\nexport interface ISiteDesignPrincipals {\r\n    /**\r\n     * Display name\r\n     */\r\n    DisplayName: string;\r\n    /**\r\n     * The principal name\r\n     */\r\n    PrincipalName: string;\r\n    /**\r\n     * The principal name\r\n     */\r\n    Rights: number;\r\n}\r\n\r\nexport interface ISiteDesignTask {\r\n    /**\r\n     * The ID of the site design task\r\n     */\r\n    ID: string;\r\n    /**\r\n     * Logonname of the user who created the task\r\n     */\r\n    LogonName: string;\r\n    /**\r\n     * The ID of the site design the task is running on\r\n     */\r\n    SiteDesignID: string;\r\n    /**\r\n     * The ID of the site collection\r\n     */\r\n    SiteID: string;\r\n    /**\r\n     * The ID of the web\r\n     */\r\n    WebID: string;\r\n}\r\n\r\nexport interface ISiteScriptActionStatus {\r\n    /**\r\n     * Action index\r\n     */\r\n    ActionIndex: number;\r\n    /**\r\n     * Action key\r\n     */\r\n    ActionKey: string;\r\n    /**\r\n     * Action title\r\n     */\r\n    ActionTitle: string;\r\n    /**\r\n     * Last modified\r\n     */\r\n    LastModified: number;\r\n    /**\r\n     * Ordinal index\r\n     */\r\n    OrdinalIndex: string;\r\n    /**\r\n     * Outcome code\r\n     */\r\n    OutcomeCode: number;\r\n    /**\r\n    * Outcome text\r\n    */\r\n    OutcomeText: string;\r\n    /**\r\n     * Site script id\r\n     */\r\n    SiteScriptID: string;\r\n    /**\r\n     * Site script index\r\n     */\r\n    SiteScriptIndex: number;\r\n    /**\r\n     * Site script title\r\n     */\r\n    SiteScriptTitle: string;\r\n}\r\n\r\nexport interface ISiteDesignRun {\r\n    /**\r\n     * The ID of the site design run\r\n     */\r\n    ID: string;\r\n    /**\r\n     * The ID of the site design that was applied\r\n     */\r\n    SiteDesignID: string;\r\n    /**\r\n     * The title of the site design that was applied\r\n     */\r\n    SiteDesignTitle: string;\r\n    /**\r\n     * The version of the site design that was applied\r\n     */\r\n    SiteDesignVersion: number;\r\n    /**\r\n     * The site id where the site design was applied\r\n     */\r\n    SiteID: string;\r\n    /**\r\n     * The start time when the site design was applied\r\n     */\r\n    StartTime: number;\r\n    /**\r\n     * The web id where the site design was applied\r\n     */\r\n    WebID: string;\r\n}\r\n","import { _Web } from \"../webs/types\";\r\nimport { ISiteDesignRun, SiteDesigns, ISiteDesignTask, ISiteScriptActionStatus } from \"./types\";\r\n\r\ndeclare module \"../webs/types\" {\r\n\r\n    interface _Web {\r\n        getSiteDesignRuns(siteDesignId?: string): Promise<ISiteDesignRun[]>;\r\n        addSiteDesignTask(siteDesignId: string): Promise<ISiteDesignTask>;\r\n        getSiteDesignRunStatus(runId: string): Promise<ISiteScriptActionStatus[]>;\r\n    }\r\n\r\n    interface IWeb {\r\n        /**\r\n         * Retrieves a list of site design that have run on the current web\r\n         * @param siteDesignId (Optional) the site design ID, if not provided will return all site design runs\r\n         */\r\n        getSiteDesignRuns(siteDesignId?: string): Promise<ISiteDesignRun[]>;\r\n        /**\r\n         * Adds a site design task on the current web to be invoked asynchronously.\r\n         * @param siteDesignId The ID of the site design to create a task for\r\n         */\r\n        addSiteDesignTask(siteDesignId: string): Promise<ISiteDesignTask>;\r\n        /**\r\n         * Retrieves the status of a site design that has been run or is still running\r\n         * @param runId the run ID\r\n         */\r\n        getSiteDesignRunStatus(runId: string): Promise<ISiteScriptActionStatus[]>;\r\n    }\r\n}\r\n\r\n_Web.prototype.getSiteDesignRuns = function (this: _Web, siteDesignId?: string): Promise<ISiteDesignRun[]> {\r\n    return SiteDesigns(this, \"\").getSiteDesignRun(undefined, siteDesignId);\r\n};\r\n\r\n_Web.prototype.addSiteDesignTask = function (this: _Web, siteDesignId: string): Promise<ISiteDesignTask> {\r\n    return SiteDesigns(this, \"\").addSiteDesignTaskToCurrentWeb(siteDesignId);\r\n};\r\n\r\n_Web.prototype.getSiteDesignRunStatus = function (this: _Web, runId: string): Promise<ISiteScriptActionStatus[]> {\r\n    return SiteDesigns(this, \"\").getSiteDesignRunStatus(undefined, runId);\r\n};\r\n","import \"./web\";\r\nimport { SPRest } from \"../rest\";\r\nimport { ISiteDesigns, SiteDesigns } from \"./types\";\r\n\r\nexport {\r\n    ISiteDesignCreationInfo,\r\n    ISiteDesignInfo,\r\n    ISiteDesignPrincipals,\r\n    ISiteDesignUpdateInfo,\r\n    ISiteDesigns,\r\n    SiteDesigns,\r\n    ISiteDesignRun,\r\n    ISiteDesignTask,\r\n    ISiteScriptActionStatus,\r\n} from \"./types\";\r\n\r\ndeclare module \"../rest\" {\r\n    interface SPRest {\r\n        readonly siteDesigns: ISiteDesigns;\r\n    }\r\n}\r\n\r\nReflect.defineProperty(SPRest.prototype, \"siteDesigns\", {\r\n    configurable: true,\r\n    enumerable: true,\r\n    get: function (this: SPRest) {\r\n        return SiteDesigns(this._baseUrl);\r\n    },\r\n});\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _Web, Web } from \"../webs/types\";\r\nimport { ISiteGroups, SiteGroups, ISiteGroup } from \"./types\";\r\nimport { spPost } from \"../operations\";\r\nimport { escapeQueryStrValue } from \"../utils/escapeQueryStrValue\";\r\nimport \"../security/web\";\r\n\r\ndeclare module \"../webs/types\" {\r\n\r\n    interface _Web {\r\n        readonly siteGroups: ISiteGroups;\r\n        readonly associatedOwnerGroup: ISiteGroup;\r\n        readonly associatedMemberGroup: ISiteGroup;\r\n        readonly associatedVisitorGroup: ISiteGroup;\r\n        createDefaultAssociatedGroups(groupNameSeed: string, siteOwner: string, copyRoleAssignments?: boolean, clearSubscopes?: boolean, siteOwner2?: string): Promise<void>;\r\n    }\r\n    interface IWeb {\r\n\r\n        /**\r\n         * Returns the site groups of this web\r\n         */\r\n        readonly siteGroups: ISiteGroups;\r\n\r\n        /**\r\n         * The web's owner group\r\n         */\r\n        readonly associatedOwnerGroup: ISiteGroup;\r\n\r\n        /**\r\n         * The web's member group\r\n         */\r\n        readonly associatedMemberGroup: ISiteGroup;\r\n\r\n        /**\r\n         * The web's visitor group\r\n         */\r\n        readonly associatedVisitorGroup: ISiteGroup;\r\n\r\n        /**\r\n         * Creates the default associated groups (Members, Owners, Visitors) and gives them the default permissions on the site.\r\n         * The target site must have unique permissions and no associated members / owners / visitors groups\r\n         *\r\n         * @param groupNameSeed The base group name. E.g. 'TestSite' would produce 'TestSite Members' etc.\r\n         * @param siteOwner The user login name to be added to the site Owners group. Default is the current user\r\n         * @param copyRoleAssignments Optional. If true the permissions are copied from the current parent scope\r\n         * @param clearSubscopes Optional. true to make all child securable objects inherit role assignments from the current object\r\n         * @param siteOwner2 Optional. The second user login name to be added to the site Owners group. Default is empty\r\n         */\r\n        createDefaultAssociatedGroups(groupNameSeed: string, siteOwner: string, copyRoleAssignments?: boolean, clearSubscopes?: boolean, siteOwner2?: string): Promise<void>;\r\n    }\r\n}\r\n\r\naddProp(_Web, \"siteGroups\", SiteGroups);\r\naddProp(_Web, \"associatedOwnerGroup\", SiteGroups, \"associatedownergroup\");\r\naddProp(_Web, \"associatedMemberGroup\", SiteGroups, \"associatedmembergroup\");\r\naddProp(_Web, \"associatedVisitorGroup\", SiteGroups, \"associatedvisitorgroup\");\r\n\r\n_Web.prototype.createDefaultAssociatedGroups = async function (\r\n    this: _Web,\r\n    groupNameSeed: string,\r\n    siteOwner: string,\r\n    copyRoleAssignments = false,\r\n    clearSubscopes = true,\r\n    siteOwner2?: string): Promise<void> {\r\n\r\n    await this.breakRoleInheritance(copyRoleAssignments, clearSubscopes);\r\n\r\n    const q = this.clone(Web, \"createDefaultAssociatedGroups(userLogin=@u,userLogin2=@v,groupNameSeed=@s)\");\r\n    q.query.set(\"@u\", `'${escapeQueryStrValue(siteOwner || \"\")}'`);\r\n    q.query.set(\"@v\", `'${escapeQueryStrValue(siteOwner2 || \"\")}'`);\r\n    q.query.set(\"@s\", `'${escapeQueryStrValue(groupNameSeed || \"\")}'`);\r\n    return spPost(q);\r\n};\r\n\r\n","import { body } from \"@pnp/odata\";\r\nimport { spPost } from \"../operations\";\r\nimport { ISharePointQueryable, _SharePointQueryable } from \"../sharepointqueryable\";\r\nimport { extractWebUrl } from \"../utils/extractweburl\";\r\nimport { tag } from \"../telemetry\";\r\nimport { escapeQueryStrValue } from \"../utils/escapeQueryStrValue\";\r\n\r\nexport class _SiteScripts extends _SharePointQueryable {\r\n\r\n    constructor(baseUrl: string | ISharePointQueryable, methodName = \"\") {\r\n        const url = typeof baseUrl === \"string\" ? baseUrl : baseUrl.toUrl();\r\n        super(extractWebUrl(url), `_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.${methodName}`);\r\n    }\r\n\r\n    public execute<T>(props: any): Promise<T> {\r\n        return spPost<T>(this, body(props));\r\n    }\r\n\r\n    /**\r\n     * Gets a list of information on all existing site scripts.\r\n     */\r\n    @tag(\"ss.getSiteScripts\")\r\n    public getSiteScripts(): Promise<ISiteScriptInfo[]> {\r\n        return this.clone(SiteScriptsCloneFactory, \"GetSiteScripts\", true).execute<ISiteScriptInfo[]>({});\r\n    }\r\n\r\n    /**\r\n     * Creates a new site script.\r\n     * \r\n     * @param title The display name of the site script.\r\n     * @param content JSON value that describes the script. For more information, see JSON reference.\r\n     */\r\n    @tag(\"ss.createSiteScript\")\r\n    public createSiteScript(title: string, description: string, content: any): Promise<ISiteScriptInfo> {\r\n        return this.clone(SiteScriptsCloneFactory,\r\n            `CreateSiteScript(Title=@title,Description=@desc)?@title='${escapeQueryStrValue(title)}'&@desc='${escapeQueryStrValue(description)}'`)\r\n            .execute<ISiteScriptInfo>(content);\r\n    }\r\n\r\n    /**\r\n     * Gets information about a specific site script. It also returns the JSON of the script.\r\n     * \r\n     * @param id The ID of the site script to get information about.\r\n     */\r\n    @tag(\"ss.getSiteScriptMetadata\")\r\n    public getSiteScriptMetadata(id: string): Promise<ISiteScriptInfo> {\r\n        return this.clone(SiteScriptsCloneFactory, \"GetSiteScriptMetadata\").execute<ISiteScriptInfo>({ id });\r\n    }\r\n\r\n    /**\r\n     * Deletes a site script.\r\n     * \r\n     * @param id The ID of the site script to delete.\r\n     */\r\n    @tag(\"ss.deleteSiteScript\")\r\n    public deleteSiteScript(id: string): Promise<void> {\r\n        return this.clone(SiteScriptsCloneFactory, \"DeleteSiteScript\").execute<void>({ id });\r\n    }\r\n\r\n    /**\r\n     * Updates a site script with new values. In the REST call, all parameters are optional except the site script Id.\r\n     * \r\n     * @param siteScriptUpdateInfo Object that contains the information to update a site script. \r\n     *                             Make sure you stringify the content object or pass it in the second 'content' parameter\r\n     * @param content (Optional) A new JSON script defining the script actions. For more information, see Site design JSON schema.\r\n     */\r\n    @tag(\"ss.updateSiteScript\")\r\n    public updateSiteScript(updateInfo: ISiteScriptUpdateInfo, content?: any): Promise<ISiteScriptInfo> {\r\n\r\n        if (content) {\r\n            updateInfo.Content = JSON.stringify(content);\r\n        }\r\n\r\n        return this.clone(SiteScriptsCloneFactory, \"UpdateSiteScript\").execute<ISiteScriptInfo>({ updateInfo });\r\n    }\r\n\r\n    /**\r\n     * Gets the site script syntax (JSON) for a specific list\r\n     * @param listUrl The absolute url of the list to retrieve site script\r\n     */\r\n    @tag(\"ss.getSiteScriptFromList\")\r\n    public getSiteScriptFromList(listUrl: string): Promise<string> {\r\n        return this.clone(SiteScriptsCloneFactory, `GetSiteScriptFromList`).execute<string>({ listUrl });\r\n    }\r\n\r\n    /**\r\n     * Gets the site script syntax (JSON) for a specific web\r\n     * @param webUrl The absolute url of the web to retrieve site script\r\n     * @param extractInfo configuration object to specify what to extract\r\n     */\r\n    @tag(\"ss.getSiteScriptFromWeb\")\r\n    public getSiteScriptFromWeb(webUrl: string, info: ISiteScriptSerializationInfo): Promise<ISiteScriptSerializationResult> {\r\n        return this.clone(SiteScriptsCloneFactory, `getSiteScriptFromWeb`).execute<ISiteScriptSerializationResult>({ webUrl, info });\r\n    }\r\n\r\n    /**\r\n     * Executes the indicated site design action on the indicated web.\r\n     * \r\n     * @param webUrl The absolute url of the web to retrieve site script\r\n     * @param extractInfo configuration object to specify what to extract\r\n     */\r\n    @tag(\"ss.executeSiteScriptAction\")\r\n    public executeSiteScriptAction(actionDefinition: string): Promise<ISiteScriptActionResult> {\r\n        return this.clone(SiteScriptsCloneFactory, `executeSiteScriptAction`).execute<ISiteScriptActionResult>({ actionDefinition });\r\n    }\r\n}\r\nexport interface ISiteScripts extends _SiteScripts { }\r\nexport const SiteScripts = (baseUrl: string | ISharePointQueryable, methodName?: string): ISiteScripts => new _SiteScripts(baseUrl, methodName);\r\n\r\ntype SiteScriptsCloneType = ISiteScripts & ISharePointQueryable & { execute<T>(props: any): Promise<T> };\r\nconst SiteScriptsCloneFactory = (baseUrl: string | ISharePointQueryable, methodName = \"\"): SiteScriptsCloneType => <any>SiteScripts(baseUrl, methodName);\r\n\r\n/**\r\n * Result from creating or retrieving a site script\r\n *\r\n */\r\nexport interface ISiteScriptInfo {\r\n    /**\r\n     * The ID of the site script to apply\r\n     */\r\n    Id: string;\r\n    /**\r\n     * The display name of the site script\r\n     */\r\n    Title: string;\r\n    /**\r\n     * The description for the site script\r\n     */\r\n    Description: string;\r\n    /**\r\n     * The JSON data/definition for the site script\r\n     */\r\n    Content: string;\r\n    /**\r\n     * The version number of the site script\r\n     */\r\n    Version: string;\r\n}\r\n\r\n/**\r\n * Data for updating a site script\r\n *\r\n */\r\nexport interface ISiteScriptUpdateInfo {\r\n    /**\r\n     * The ID of the site script to update\r\n     */\r\n    Id: string;\r\n    /**\r\n     * (Optional) The new display name for the updated site script\r\n     */\r\n    Title?: string;\r\n    /**\r\n     * (Optional) The new description for the updated site script\r\n     */\r\n    Description?: string;\r\n    /**\r\n     * (Optional) The new JSON data/definition for the updated site script\r\n     */\r\n    Content?: string;\r\n    /**\r\n     * (Optional) The new version for the updated site script\r\n     */\r\n    Version?: string;\r\n}\r\n\r\nexport interface ISiteScriptSerializationInfo {\r\n    /**\r\n     * (Optional) Include branding\r\n     */\r\n    IncludeBranding?: boolean;\r\n    /**\r\n     * (Optional) Lists to include e.g. [\"Lists/MyList\"]\r\n     */\r\n    IncludedLists?: string[];\r\n    /**\r\n     * (Optional) Include links to exported items\r\n     */\r\n    IncludeLinksToExportedItems?: boolean;\r\n    /**\r\n     * (Optional) Include regional settings\r\n     */\r\n    IncludeRegionalSettings?: boolean;\r\n    /**\r\n     * (Optional) Include site external sharing capability\r\n     */\r\n    IncludeSiteExternalSharingCapability?: boolean;\r\n    /**\r\n     * (Optional) Include theme\r\n     */\r\n    IncludeTheme?: boolean;\r\n}\r\n\r\nexport interface ISiteScriptSerializationResult {\r\n    /**\r\n     * The site script in JSON format\r\n     */\r\n    JSON: string;\r\n    /**\r\n    * A collection of warnings\r\n    */\r\n    Warnings: string[];\r\n}\r\n\r\nexport interface ISiteScriptActionResult {\r\n\r\n    /**\r\n     * The title of the action.\r\n     */\r\n    Title: string;\r\n\r\n    /**\r\n     * Text associated with the outcome of the action. If this is present, it is usually an error message.\r\n     */\r\n    OutcomeText: string;\r\n\r\n    /**\r\n     * Indicates the outcome of the action.\r\n     */\r\n    Outcome: SiteScriptActionOutcome;\r\n\r\n    /**\r\n     * Indicates the target of the action.\r\n     */\r\n    Target: string;\r\n}\r\n\r\nexport enum SiteScriptActionOutcome {\r\n\r\n    /**\r\n     * The stage was deemed to have completed successfully.\r\n     */\r\n    Success = 0,\r\n\r\n    /**\r\n     * The stage was deemed to have failed to complete successfully (non-blocking, rest of recipe\r\n     * execution should still be able to proceed).\r\n     */\r\n    Failure = 1,\r\n\r\n    /**\r\n     * No action was taken for this stage / this stage was skipped.\r\n     */\r\n    NoOp = 2,\r\n\r\n    /**\r\n     * There was an exception but the operation succeeded. This is analagous to the operation completing\r\n     * in a \"yellow\" state.\r\n     */\r\n    SucceededWithException = 3,\r\n}\r\n","import { _Web } from \"../webs/types\";\r\nimport { SiteScripts } from \"./types\";\r\nimport { ISiteScriptSerializationInfo, ISiteScriptSerializationResult } from \"./types\";\r\n\r\ndeclare module \"../webs/types\" {\r\n    interface _Web {\r\n        getSiteScript(extractInfo?: ISiteScriptSerializationInfo): Promise<ISiteScriptSerializationResult>;\r\n    }\r\n\r\n    interface IWeb {\r\n        /**\r\n         * Gets the site script syntax (JSON) for the current web\r\n         * @param extractInfo configuration object to specify what to extract\r\n         */\r\n        getSiteScript(extractInfo?: ISiteScriptSerializationInfo): Promise<ISiteScriptSerializationResult>;\r\n    }\r\n}\r\n\r\n_Web.prototype.getSiteScript = function (this: _Web, extractInfo?: ISiteScriptSerializationInfo): Promise<ISiteScriptSerializationResult> {\r\n    return SiteScripts(this.toUrl(), \"\").getSiteScriptFromWeb(undefined, extractInfo);\r\n};\r\n","import { combine } from \"@pnp/common\";\r\nimport { _List, List } from \"../lists/types\";\r\nimport { SiteScripts } from \"./types\";\r\nimport \"../folders/list\";\r\nimport { _Web, Web } from \"../webs/types\";\r\nimport { extractWebUrl } from \"../utils/extractweburl\";\r\n\r\ndeclare module \"../lists/types\" {\r\n    interface _List {\r\n        getSiteScript(): Promise<string>;\r\n    }\r\n\r\n    interface IList {\r\n        /**\r\n         * Gets the site script syntax (JSON) from the current list\r\n         */\r\n        getSiteScript(): Promise<string>;\r\n    }\r\n}\r\n\r\n_List.prototype.getSiteScript = async function (this: _List): Promise<string> {\r\n\r\n    const rootFolder = await this.clone(List).rootFolder.get<{ Name: string }>();\r\n    const web = await Web(extractWebUrl(this.toUrl())).select(\"Url\").get();\r\n    const absoluteListUrl = combine(web.Url, \"Lists\", rootFolder.Name);\r\n    return SiteScripts(this, \"\").getSiteScriptFromList(absoluteListUrl);\r\n};\r\n","import \"./web\";\r\nimport \"./list\";\r\nimport { SPRest } from \"../rest\";\r\nimport { ISiteScripts, SiteScripts } from \"./types\";\r\n\r\nexport {\r\n    SiteScripts,\r\n    ISiteScripts,\r\n    ISiteScriptInfo,\r\n    ISiteScriptUpdateInfo,\r\n    ISiteScriptSerializationInfo,\r\n    ISiteScriptSerializationResult,\r\n} from \"./types\";\r\n\r\ndeclare module \"../rest\" {\r\n    interface SPRest {\r\n        readonly siteScripts: ISiteScripts;\r\n    }\r\n}\r\n\r\nReflect.defineProperty(SPRest.prototype, \"siteScripts\", {\r\n    configurable: true,\r\n    enumerable: true,\r\n    get: function (this: SPRest) {\r\n        return SiteScripts(this._baseUrl);\r\n    },\r\n});\r\n","import { addProp, body } from \"@pnp/odata\";\r\nimport { _Web, Web } from \"../webs/types\";\r\nimport { ISiteUsers, SiteUsers, ISiteUser, SiteUser, IWebEnsureUserResult } from \"./types\";\r\nimport { odataUrlFrom } from \"../odata\";\r\nimport { spPost } from \"../operations\";\r\n\r\ndeclare module \"../webs/types\" {\r\n    interface _Web {\r\n        readonly siteUsers: ISiteUsers;\r\n        readonly currentUser: ISiteUser;\r\n        ensureUser(loginName: string): Promise<IWebEnsureUserResult>;\r\n        getUserById(id: number): ISiteUser;\r\n    }\r\n    interface IWeb {\r\n\r\n        /**\r\n         * The site users\r\n         */\r\n        readonly siteUsers: ISiteUsers;\r\n\r\n        /**\r\n         * Information on the current user\r\n         */\r\n        readonly currentUser: ISiteUser;\r\n\r\n        /**\r\n        * Checks whether the specified login name belongs to a valid user in the web. If the user doesn't exist, adds the user to the web.\r\n        *\r\n        * @param loginName The login name of the user (ex: i:0#.f|membership|user@domain.onmicrosoft.com)\r\n        */\r\n        ensureUser(loginName: string): Promise<IWebEnsureUserResult>;\r\n\r\n        /**\r\n         * Returns the user corresponding to the specified member identifier for the current site\r\n         *\r\n         * @param id The id of the user\r\n         */\r\n        getUserById(id: number): ISiteUser;\r\n    }\r\n}\r\n\r\naddProp(_Web, \"siteUsers\", SiteUsers);\r\naddProp(_Web, \"currentUser\", SiteUser, \"currentuser\");\r\n\r\n_Web.prototype.ensureUser = async function (this: _Web, logonName: string): Promise<IWebEnsureUserResult> {\r\n\r\n    const data = await spPost(this.clone(Web, \"ensureuser\"), body({ logonName }));\r\n    return {\r\n        data,\r\n        user: SiteUser(odataUrlFrom(data)),\r\n    };\r\n};\r\n\r\n_Web.prototype.getUserById = function (id: number): ISiteUser {\r\n    return SiteUser(this, `getUserById(${id})`);\r\n};\r\n","import {\r\n  _SharePointQueryableInstance,\r\n  ISharePointQueryable,\r\n  spInvokableFactory,\r\n  _SharePointQueryable,\r\n} from \"../sharepointqueryable\";\r\nimport { defaultPath } from \"../decorators\";\r\nimport { hOP, IFetchOptions } from \"@pnp/common\";\r\nimport { metadata } from \"../utils/metadata\";\r\nimport { body } from \"@pnp/odata\";\r\nimport { spPost } from \"../operations\";\r\nimport { tag } from \"../telemetry\";\r\n\r\n@defaultPath(\"_api/social.following\")\r\nexport class _Social extends _SharePointQueryableInstance implements ISocial {\r\n\r\n  public get my(): IMySocial {\r\n    return MySocial(this);\r\n  }\r\n\r\n  @tag(\"soc.getFollowedSitesUri\")\r\n  public async getFollowedSitesUri(): Promise<string> {\r\n    const r = await this.clone(SocialCloneFactory, \"FollowedSitesUri\").get();\r\n    return r.FollowedSitesUri || r;\r\n  }\r\n\r\n  @tag(\"soc.getFollowedDocumentsUri\")\r\n    public async getFollowedDocumentsUri(): Promise<string> {\r\n    const r = await this.clone(SocialCloneFactory, \"FollowedDocumentsUri\").get();\r\n    return r.FollowedDocumentsUri || r;\r\n  }\r\n\r\n  @tag(\"soc.follow\")\r\n  public async follow(actorInfo: ISocialActorInfo): Promise<SocialFollowResult> {\r\n    return await spPost(this.clone(SocialCloneFactory, \"follow\"), this.createSocialActorInfoRequestBody(actorInfo));\r\n  }\r\n\r\n  @tag(\"soc.isFollowed\")\r\n  public async isFollowed(actorInfo: ISocialActorInfo): Promise<boolean> {\r\n    return await spPost(this.clone(SocialCloneFactory, \"isfollowed\"), this.createSocialActorInfoRequestBody(actorInfo));\r\n  }\r\n\r\n  @tag(\"soc.stopFollowing\")\r\n  public async stopFollowing(actorInfo: ISocialActorInfo): Promise<void> {\r\n    return await spPost(this.clone(SocialCloneFactory, \"stopfollowing\"), this.createSocialActorInfoRequestBody(actorInfo));\r\n  }\r\n\r\n  private createSocialActorInfoRequestBody(actorInfo: ISocialActorInfo): IFetchOptions {\r\n    return body({\r\n      \"actor\":\r\n        Object.assign(metadata(\"SP.Social.SocialActorInfo\"), {\r\n          Id: null,\r\n        }, actorInfo),\r\n    });\r\n  }\r\n}\r\n\r\n/**\r\n * Describes the public methods for the Social interface\r\n */\r\nexport interface ISocial {\r\n  /**\r\n   * Access to the curren't user's social data\r\n   */\r\n  readonly my: IMySocial;\r\n  /**\r\n   * Get a list of followed sites for the current user.\r\n   */\r\n  getFollowedSitesUri(): Promise<string>;\r\n  /**\r\n   * Get a list of followed documents for the current user.\r\n   */\r\n  getFollowedDocumentsUri(): Promise<string>;\r\n  /**\r\n   * Follow an actor for the current user.\r\n   *\r\n   * @param actorInfo Provide the actor to follow.\r\n   */\r\n  follow(actorInfo: ISocialActorInfo): Promise<SocialFollowResult>;\r\n  /**\r\n   * Check if the current user is following the actor.\r\n   *\r\n   * @param actorInfo Provide the actor to check.\r\n   */\r\n  isFollowed(actorInfo: ISocialActorInfo): Promise<boolean>;\r\n  /**\r\n   * Stop following an actor for the current user.\r\n   *\r\n   * @param actorInfo Provide the actor to stop following.\r\n   */\r\n  stopFollowing(actorInfo: ISocialActorInfo): Promise<void>;\r\n}\r\n\r\n/**\r\n * Get a new Social instance for the particular Url\r\n */\r\nexport const Social = (baseUrl: string | ISharePointQueryable): ISocial => new _Social(baseUrl);\r\nconst SocialCloneFactory = (baseUrl: string | ISharePointQueryable, paths?: string): ISocial & ISharePointQueryable => new _Social(baseUrl, paths);\r\n\r\n/**\r\n * Current user's Social instance\r\n */\r\n@defaultPath(\"my\")\r\nexport class _MySocial extends _SharePointQueryableInstance implements IMySocial {\r\n\r\n  @tag(\"msoc.followed\")\r\n  public async followed(types: SocialActorTypes): Promise<ISocialActor[]> {\r\n    const r = await this.clone(MySocialCloneFactory, `followed(types=${types})`)();\r\n    return hOP(r, \"Followed\") ? r.Followed.results : r;\r\n  }\r\n\r\n  @tag(\"msoc.followedCount\")\r\n  public async followedCount(types: SocialActorTypes): Promise<number> {\r\n    const r = await this.clone(MySocialCloneFactory, `followedcount(types=${types})`)();\r\n    return r.FollowedCount || r;\r\n  }\r\n\r\n  @tag(\"msoc.followers\")\r\n  public async followers(): Promise<ISocialActor[]> {\r\n    const r = await this.clone(MySocialCloneFactory, \"followers\")();\r\n    return hOP(r, \"Followers\") ? r.Followers.results : r;\r\n  }\r\n\r\n  @tag(\"msoc.suggestions\")\r\n  public async suggestions(): Promise<ISocialActor[]> {\r\n    const r = await this.clone(MySocialCloneFactory, \"suggestions\")();\r\n    return hOP(r, \"Suggestions\") ? r.Suggestions.results : r;\r\n  }\r\n}\r\n\r\n/**\r\n * Defines the public methods exposed by the my endpoint\r\n */\r\nexport interface IMySocial {\r\n\r\n  /**\r\n   * Allow access to the v2 invokable\r\n   */\r\n  (this: IMySocial): Promise<IMySocialData>;\r\n\r\n  /**\r\n   * Gets this user's data\r\n   */\r\n  get(): Promise<IMySocialData>;\r\n  /**\r\n   * Gets users, documents, sites, and tags that the current user is following.\r\n   * \r\n   * @param types Bitwise set of SocialActorTypes to retrieve\r\n   */\r\n  followed(types: SocialActorTypes): Promise<ISocialActor[]>;\r\n  /**\r\n   * Gets the count of users, documents, sites, and tags that the current user is following.\r\n   * \r\n   * @param types Bitwise set of SocialActorTypes to retrieve\r\n   */\r\n  followedCount(types: SocialActorTypes): Promise<number>;\r\n  /**\r\n   * Gets the users who are following the current user.\r\n   */\r\n  followers(): Promise<ISocialActor[]>;\r\n  /**\r\n   * Gets users who the current user might want to follow.\r\n   */\r\n  suggestions(): Promise<ISocialActor[]>;\r\n}\r\n\r\n/**\r\n * Invokable factory for IMySocial instances\r\n */\r\nexport const MySocial = spInvokableFactory<IMySocial>(_MySocial);\r\nconst MySocialCloneFactory = (baseUrl: string | ISharePointQueryable, path?: string): IMySocial & ISharePointQueryable => <any>MySocial(baseUrl, path);\r\n\r\n/**\r\n * Social actor info\r\n *\r\n */\r\nexport interface ISocialActorInfo {\r\n  AccountName?: string;\r\n  ActorType: SocialActorType;\r\n  ContentUri?: string;\r\n  Id?: string;\r\n  TagGuid?: string;\r\n}\r\n\r\n/**\r\n * Social actor type\r\n *\r\n */\r\nexport const enum SocialActorType {\r\n  User,\r\n  Document,\r\n  Site,\r\n  Tag,\r\n}\r\n\r\n/**\r\n * Social actor type\r\n *\r\n */\r\n/* tslint:disable:no-bitwise */\r\nexport const enum SocialActorTypes {\r\n  None = 0,\r\n  User = 1 << SocialActorType.User,\r\n  Document = 1 << SocialActorType.Document,\r\n  Site = 1 << SocialActorType.Site,\r\n  Tag = 1 << SocialActorType.Tag,\r\n  /**\r\n   * The set excludes documents and sites that do not have feeds.\r\n   */\r\n  ExcludeContentWithoutFeeds = 268435456,\r\n  /**\r\n   * The set includes group sites\r\n   */\r\n  IncludeGroupsSites = 536870912,\r\n  /**\r\n   * The set includes only items created within the last 24 hours\r\n   */\r\n  WithinLast24Hours = 1073741824,\r\n}\r\n/* tslint:enable */\r\n\r\n/**\r\n * Result from following\r\n *\r\n */\r\nexport const enum SocialFollowResult {\r\n  Ok = 0,\r\n  AlreadyFollowing = 1,\r\n  LimitReached = 2,\r\n  InternalError = 3,\r\n}\r\n\r\n/**\r\n * Specifies an exception or status code.\r\n */\r\nexport const enum SocialStatusCode {\r\n  /**\r\n   * The operation completed successfully\r\n   */\r\n  OK,\r\n  /**\r\n   * The request is invalid.\r\n   */\r\n  InvalidRequest,\r\n  /**\r\n   *  The current user is not authorized to perform the operation.\r\n   */\r\n  AccessDenied,\r\n  /**\r\n   * The target of the operation was not found.\r\n   */\r\n  ItemNotFound,\r\n  /**\r\n   * The operation is invalid for the target's current state. \r\n   */\r\n  InvalidOperation,\r\n  /**\r\n   * The operation completed without modifying the target.\r\n   */\r\n  ItemNotModified,\r\n  /**\r\n   * The operation failed because an internal error occurred.\r\n   */\r\n  InternalError,\r\n  /**\r\n   * The operation failed because the server could not access the distributed cache.\r\n   */\r\n  CacheReadError,\r\n  /**\r\n   * The operation succeeded but the server could not update the distributed cache.\r\n   */\r\n  CacheUpdateError,\r\n  /**\r\n   * No personal site exists for the current user, and no further information is available.\r\n   */\r\n  PersonalSiteNotFound,\r\n  /**\r\n   * No personal site exists for the current user, and a previous attempt to create one failed.\r\n   */\r\n  FailedToCreatePersonalSite,\r\n  /**\r\n   * No personal site exists for the current user, and a previous attempt to create one was not authorized.\r\n   */\r\n  NotAuthorizedToCreatePersonalSite,\r\n  /**\r\n   * No personal site exists for the current user, and no attempt should be made to create one.\r\n   */\r\n  CannotCreatePersonalSite,\r\n  /**\r\n   * The operation was rejected because an internal limit had been reached.\r\n   */\r\n  LimitReached,\r\n  /**\r\n   * The operation failed because an error occurred during the processing of the specified attachment.\r\n   */\r\n  AttachmentError,\r\n  /**\r\n   * The operation succeeded with recoverable errors; the returned data is incomplete.\r\n   */\r\n  PartialData,\r\n  /**\r\n   * A required SharePoint feature is not enabled.\r\n   */\r\n  FeatureDisabled,\r\n  /**\r\n   * The site's storage quota has been exceeded.\r\n   */\r\n  StorageQuotaExceeded,\r\n  /**\r\n   * The operation failed because the server could not access the database.\r\n   */\r\n  DatabaseError,\r\n}\r\n\r\nexport interface ISocialActor {\r\n  /**\r\n   * Gets the actor type.\r\n   */\r\n  ActorType: SocialActorType;\r\n  /**\r\n   * Gets the actor's unique identifier.\r\n   */\r\n  Id: string;\r\n  /**\r\n   * Gets the actor's canonical URI.\r\n   */\r\n  Uri: string;\r\n  /**\r\n   * Gets the actor's display name.\r\n   */\r\n  Name: string;\r\n  /**\r\n   * Returns true if the current user is following the actor, false otherwise.\r\n   */\r\n  IsFollowed: boolean;\r\n  /**\r\n   * Gets a code that indicates recoverable errors that occurred during actor retrieval\r\n   */\r\n  Status: SocialStatusCode;\r\n  /**\r\n   * Returns true if the Actor can potentially be followed, false otherwise.\r\n   */\r\n  CanFollow: boolean;\r\n  /**\r\n   * Gets the actor's image URI. Only valid when ActorType is User, Document, or Site\r\n   */\r\n  ImageUri: string;\r\n  /**\r\n   * Gets the actor's account name. Only valid when ActorType is User\r\n   */\r\n  AccountName: string;\r\n  /**\r\n   * Gets the actor's email address. Only valid when ActorType is User\r\n   */\r\n  EmailAddress: string;\r\n  /**\r\n   * Gets the actor's title. Only valid when ActorType is User\r\n   */\r\n  Title: string;\r\n  /**\r\n   * Gets the text of the actor's most recent post. Only valid when ActorType is User\r\n   */\r\n  StatusText: string;\r\n  /**\r\n   * Gets the URI of the actor's personal site. Only valid when ActorType is User\r\n   */\r\n  PersonalSiteUri: string;\r\n  /**\r\n   * Gets the URI of the actor's followed content folder. Only valid when this represents the current user\r\n   */\r\n  FollowedContentUri: string;\r\n  /**\r\n   * Gets the actor's content URI. Only valid when ActorType is Document, or Site\r\n   */\r\n  ContentUri: string;\r\n  /**\r\n   * Gets the actor's library URI. Only valid when ActorType is Document\r\n   */\r\n  LibraryUri: string;\r\n  /**\r\n   * Gets the actor's tag GUID. Only valid when ActorType is Tag\r\n   */\r\n  TagGuid: string;\r\n}\r\n\r\n/**\r\n * Defines the properties returned from the my endpoint\r\n */\r\nexport interface IMySocialData {\r\n  SocialActor: ISocialActor;\r\n  MyFollowedDocumentsUri: string;\r\n  MyFollowedSitesUri: string;\r\n}\r\n","import { ISocial, Social } from \"./types\";\r\nimport { SPRest } from \"../rest\";\r\n\r\nexport {\r\n  IMySocial,\r\n  ISocial,\r\n  IMySocialData,\r\n  ISocialActor,\r\n  ISocialActorInfo,\r\n  MySocial,\r\n  Social,\r\n  SocialActorType,\r\n  SocialActorTypes,\r\n  SocialFollowResult,\r\n  SocialStatusCode,\r\n} from \"./types\";\r\n\r\ndeclare module \"../rest\" {\r\n  interface SPRest {\r\n    /**\r\n     * Access to the social instance which allows you to track followed sites, people and docs.\r\n     */\r\n    readonly social: ISocial;\r\n  }\r\n}\r\n\r\nReflect.defineProperty(SPRest.prototype, \"social\", {\r\n  configurable: true,\r\n  enumerable: true,\r\n  get: function (this: SPRest) {\r\n    return Social(this._baseUrl);\r\n  },\r\n});\r\n","import { _SharePointQueryable, ISharePointQueryable, spInvokableFactory } from \"../sharepointqueryable\";\r\nimport { assign, ITypedHash } from \"@pnp/common\";\r\nimport { SPBatch } from \"../batch\";\r\nimport { ICachingOptions, body } from \"@pnp/odata\";\r\nimport { odataUrlFrom } from \"../odata\";\r\nimport { IPrincipalInfo, PrincipalType, PrincipalSource } from \"../types\";\r\nimport { metadata } from \"../utils/metadata\";\r\nimport { File, IFile } from \"../files/types\";\r\nimport { extractWebUrl } from \"../utils/extractweburl\";\r\nimport { spPost } from \"../operations\";\r\nimport { tag } from \"../telemetry\";\r\nimport { objectToSPKeyValueCollection } from \"../utils/objectToSPKeyValueCollection\";\r\n\r\nexport class _Utilities extends _SharePointQueryable implements IUtilities {\r\n    constructor(baseUrl: string | ISharePointQueryable, methodName: string) {\r\n        const url = typeof baseUrl === \"string\" ? baseUrl : baseUrl.toUrl();\r\n        super(extractWebUrl(url), `_api/SP.Utilities.Utility.${methodName}`);\r\n    }\r\n\r\n    public excute<T>(props: any): Promise<T> {\r\n        return spPost(this, body(props));\r\n    }\r\n\r\n    public sendEmail(props: IEmailProperties): Promise<void> {\r\n        const params = {\r\n            properties: assign(metadata(\"SP.Utilities.EmailProperties\"), {\r\n                Body: props.Body,\r\n                From: props.From,\r\n                Subject: props.Subject,\r\n            }),\r\n        };\r\n\r\n        if (props.To && props.To.length > 0) {\r\n\r\n            params.properties = assign(params.properties, {\r\n                To: { results: props.To },\r\n            });\r\n        }\r\n\r\n        if (props.CC && props.CC.length > 0) {\r\n\r\n            params.properties = assign(params.properties, {\r\n                CC: { results: props.CC },\r\n            });\r\n        }\r\n\r\n        if (props.BCC && props.BCC.length > 0) {\r\n\r\n            params.properties = assign(params.properties, {\r\n                BCC: { results: props.BCC },\r\n            });\r\n        }\r\n\r\n        if (props.AdditionalHeaders) {\r\n\r\n            params.properties = assign(params.properties, {\r\n                AdditionalHeaders: objectToSPKeyValueCollection(props.AdditionalHeaders),\r\n            });\r\n        }\r\n\r\n        return tag.configure(this.clone(UtilitiesCloneFactory, \"SendEmail\", true), \"u.sendEmail\").excute<void>(params);\r\n    }\r\n\r\n    public getCurrentUserEmailAddresses(): Promise<string> {\r\n        return tag.configure(this.clone(UtilitiesCloneFactory, \"GetCurrentUserEmailAddresses\", true), \"u.getCurrentUserEmailAddresses\").excute<string>({});\r\n    }\r\n\r\n    public resolvePrincipal(input: string,\r\n        scopes: PrincipalType,\r\n        sources: PrincipalSource,\r\n        inputIsEmailOnly: boolean,\r\n        addToUserInfoList: boolean,\r\n        matchUserInfoList = false): Promise<IPrincipalInfo> {\r\n        const params = {\r\n            addToUserInfoList,\r\n            input,\r\n            inputIsEmailOnly,\r\n            matchUserInfoList,\r\n            scopes,\r\n            sources,\r\n        };\r\n\r\n        const clone = this.clone(UtilitiesCloneFactory, \"ResolvePrincipalInCurrentContext\", true);\r\n        return tag.configure(clone, \"u.ResolvePrincipalInCurrentContext\").excute<IPrincipalInfo>(params);\r\n    }\r\n\r\n    public searchPrincipals(input: string, scopes: PrincipalType, sources: PrincipalSource, groupName: string, maxCount: number): Promise<IPrincipalInfo[]> {\r\n        const params = {\r\n            groupName: groupName,\r\n            input: input,\r\n            maxCount: maxCount,\r\n            scopes: scopes,\r\n            sources: sources,\r\n        };\r\n\r\n        const clone = this.clone(UtilitiesCloneFactory, \"SearchPrincipalsUsingContextWeb\", true);\r\n        return tag.configure(clone, \"u.SearchPrincipalsUsingContextWeb\").excute<IPrincipalInfo[]>(params);\r\n    }\r\n\r\n    public createEmailBodyForInvitation(pageAddress: string): Promise<string> {\r\n        const params = {\r\n            pageAddress: pageAddress,\r\n        };\r\n\r\n        const clone = this.clone(UtilitiesCloneFactory, \"CreateEmailBodyForInvitation\", true);\r\n        return tag.configure(clone, \"u.CreateEmailBodyForInvitation\").excute<string>(params);\r\n    }\r\n\r\n    public expandGroupsToPrincipals(inputs: string[], maxCount = 30): Promise<IPrincipalInfo[]> {\r\n        const params = {\r\n            inputs: inputs,\r\n            maxCount: maxCount,\r\n        };\r\n\r\n        const clone = this.clone(UtilitiesCloneFactory, \"ExpandGroupsToPrincipals\", true);\r\n        return tag.configure(clone, \"u.ExpandGroupsToPrincipals\").excute<IPrincipalInfo[]>(params);\r\n    }\r\n\r\n    public async createWikiPage(info: IWikiPageCreationInfo): Promise<ICreateWikiPageResult> {\r\n\r\n        const clone = this.clone(UtilitiesCloneFactory, \"CreateWikiPageInContextWeb\", true);\r\n        const newPage = await tag.configure(clone, \"u.CreateWikiPageInContextWeb\").excute<ICreateWikiPageResult>({ parameters: info });\r\n\r\n        return {\r\n            data: newPage,\r\n            file: File(odataUrlFrom(newPage)),\r\n        } as ICreateWikiPageResult;\r\n    }\r\n}\r\n\r\n/**\r\n * Describes the SharePoint utility methods\r\n */\r\nexport interface IUtilities {\r\n    /**\r\n     * Gives you the ability to cache returned data in an easy way.\r\n     * @param options instance of ICachingOptions\r\n     */\r\n    usingCaching(options?: ICachingOptions): this;\r\n\r\n    /**\r\n     * Gives you the ability to batch multiple requests into a single request to SharePoint.\r\n     * @param batch instance of SPBatch\r\n     */\r\n    inBatch(batch: SPBatch): this;\r\n\r\n    /**\r\n     * This methods will send an e-mail based on the incoming properties of the IEmailProperties parameter.\r\n     * @param props IEmailProperties object\r\n     */\r\n    sendEmail(props: IEmailProperties): Promise<void>;\r\n\r\n    /**\r\n     * This method returns the current user's email addresses known to SharePoint.\r\n     */\r\n    getCurrentUserEmailAddresses(): Promise<string>;\r\n\r\n    /**\r\n     * Gets information about a principal that matches the specified Search criteria.\r\n     * @param email E-mail address\r\n     * @param scopes Specifies the type to be used when searching for a principal\r\n     * @param sources Specifies the source to be used when searching for a principal.\r\n     * @param inputIsEmailOnly Specifies whether only the e-mail address will be used when searching for a principal.\r\n     * @param addToUserInfoList Specifies whether the user should be added to the hidden user info list.\r\n     * @param matchUserInfoList [Optional] By default false\r\n     */\r\n    resolvePrincipal(email: string,\r\n        scopes: PrincipalType,\r\n        sources: PrincipalSource,\r\n        inputIsEmailOnly: boolean,\r\n        addToUserInfoList: boolean,\r\n        matchUserInfoList?: boolean): Promise<IPrincipalInfo>;\r\n\r\n    /**\r\n    * Gets information about the principals that match the specified search criteria.\r\n    * @param input Specifies the value to be used when searching for a principal.\r\n    * @param scopes Specifies the type to be used when searching for a principal.\r\n    * @param sources Specifies the source to be used when searching for a principal.\r\n    * @param groupName Specifies the collection of users to be used when searching for a principal.\r\n    * @param maxCount Specifies the maximum number of principals to be returned in the list.\r\n    */\r\n    searchPrincipals(input: string, scopes: PrincipalType, sources: PrincipalSource, groupName: string, maxCount: number): Promise<IPrincipalInfo[]>;\r\n\r\n    /**\r\n     * Gets the external (outside the firewall) URL to a document or resource in a site.\r\n     * @param pageAddress Specifies the URI for the document or resource. It must be a URL.\r\n     */\r\n    createEmailBodyForInvitation(pageAddress: string): Promise<string>;\r\n\r\n    /**\r\n     * Resolves the principals contained within the supplied groups.\r\n     * @param inputs A collection of groups to be expanded.\r\n     * @param maxCount Specifies the maximum number of principals to be returned.\r\n     */\r\n    expandGroupsToPrincipals(inputs: string[], maxCount?: number): Promise<IPrincipalInfo[]>;\r\n\r\n    /**\r\n     * Creates a new Wiki page.\r\n     * @param info Instance of IWikiPageCreationInfo.\r\n     */\r\n    createWikiPage(info: IWikiPageCreationInfo): Promise<ICreateWikiPageResult>;\r\n}\r\n\r\nexport const Utilities = spInvokableFactory<IUtilities>(_Utilities);\r\ntype UtilitiesCloneType = IUtilities & ISharePointQueryable & { excute<T>(props: any): Promise<T> };\r\nconst UtilitiesCloneFactory = (baseUrl: string | ISharePointQueryable, path?: string): UtilitiesCloneType => <any>Utilities(baseUrl, path);\r\n\r\nexport interface ICreateWikiPageResult {\r\n    /**\r\n     * The returned Wiki page represented by raw data.\r\n     */\r\n    data: any;\r\n\r\n    /**\r\n     * The returned Wiki page represented as a file which can be further updated.\r\n     */\r\n    file: IFile;\r\n}\r\n\r\nexport interface IEmailProperties {\r\n    /**\r\n     * The list of receivers represented by a string array.\r\n     */\r\n    To: string[];\r\n\r\n    /**\r\n     * The list of receivers as CC (carbon copy) represented by a string array.\r\n     * This is optional.\r\n     */\r\n    CC?: string[];\r\n\r\n    /**\r\n     * The list of receivers as BCC (blind carbon copy) represented by a string array.\r\n     * This is optional.\r\n     */\r\n    BCC?: string[];\r\n\r\n    /**\r\n     * The subject of the email.\r\n     */\r\n    Subject: string;\r\n\r\n    /**\r\n     * The body of the email.\r\n     */\r\n    Body: string;\r\n\r\n    /**\r\n     * The additional headers appened to the request in key/value pairs.\r\n     */\r\n    AdditionalHeaders?: ITypedHash<string>;\r\n\r\n    /**\r\n     * The from address of the email.\r\n     * This is optional.\r\n     */\r\n    From?: string;\r\n}\r\n\r\nexport interface IWikiPageCreationInfo {\r\n    /**\r\n     * The server-relative-url of the wiki page to be created.\r\n     */\r\n    ServerRelativeUrl: string;\r\n\r\n    /**\r\n     * The wiki content to be set in the wiki page.\r\n     */\r\n    WikiHtmlContent: string;\r\n}\r\n","import { SPRest } from \"../rest\";\r\nimport { IUtilities, Utilities } from \"./types\";\r\n\r\nexport {\r\n    ICreateWikiPageResult,\r\n    IEmailProperties,\r\n    IUtilities,\r\n    IWikiPageCreationInfo,\r\n    Utilities,\r\n} from \"./types\";\r\n\r\ndeclare module \"../rest\" {\r\n    interface SPRest {\r\n        readonly utility: IUtilities;\r\n    }\r\n}\r\n\r\nReflect.defineProperty(SPRest.prototype, \"utility\", {\r\n    configurable: true,\r\n    enumerable: true,\r\n    get: function (this: SPRest) {\r\n        return Utilities(this._baseUrl, \"\");\r\n    },\r\n});\r\n","import {\r\n    _SharePointQueryableInstance,\r\n    _SharePointQueryableCollection,\r\n    spInvokableFactory,\r\n} from \"../sharepointqueryable\";\r\nimport { body, headers } from \"@pnp/odata\";\r\nimport { defaultPath } from \"../decorators\";\r\nimport { spPost, spDelete, spPatch } from \"../operations\";\r\nimport { tag } from \"../telemetry\";\r\n\r\n@defaultPath(\"subscriptions\")\r\nexport class _Subscriptions extends _SharePointQueryableCollection {\r\n\r\n    /**\r\n    * Returns all the webhook subscriptions or the specified webhook subscription\r\n    *\r\n    * @param subscriptionId The id of a specific webhook subscription to retrieve, omit to retrieve all the webhook subscriptions\r\n    */\r\n    public getById(subscriptionId: string): ISubscription {\r\n\r\n        return tag.configure(Subscription(this).concat(`('${subscriptionId}')`), \"subs.getById\");\r\n    }\r\n\r\n    /**\r\n     * Creates a new webhook subscription\r\n     *\r\n     * @param notificationUrl The url to receive the notifications\r\n     * @param expirationDate The date and time to expire the subscription in the form YYYY-MM-ddTHH:mm:ss+00:00 (maximum of 6 months)\r\n     * @param clientState A client specific string (optional)\r\n     */\r\n    @tag(\"subs.add\")\r\n    public async add(notificationUrl: string, expirationDate: string, clientState?: string): Promise<ISubscriptionAddResult> {\r\n\r\n        const postBody: any = {\r\n            \"expirationDateTime\": expirationDate,\r\n            \"notificationUrl\": notificationUrl,\r\n            \"resource\": this.toUrl(),\r\n        };\r\n\r\n        if (clientState) {\r\n            postBody.clientState = clientState;\r\n        }\r\n\r\n        const data = await spPost(this, body(postBody, headers({ \"Content-Type\": \"application/json\" })));\r\n\r\n        return { data, subscription: this.getById(data.id) };\r\n    }\r\n}\r\nexport interface ISubscriptions extends _Subscriptions { }\r\nexport const Subscriptions = spInvokableFactory<ISubscriptions>(_Subscriptions);\r\n\r\nexport class _Subscription extends _SharePointQueryableInstance {\r\n\r\n    /**\r\n     * Renews this webhook subscription\r\n     *\r\n     * @param expirationDate The date and time to expire the subscription in the form YYYY-MM-ddTHH:mm:ss+00:00 (maximum of 6 months, optional)\r\n     * @param notificationUrl The url to receive the notifications (optional)\r\n     * @param clientState A client specific string (optional)\r\n     */\r\n    @tag(\"sub.update\")\r\n    public async update(expirationDate?: string, notificationUrl?: string, clientState?: string): Promise<ISubscriptionUpdateResult> {\r\n\r\n        const postBody: any = {};\r\n\r\n        if (expirationDate) {\r\n            postBody.expirationDateTime = expirationDate;\r\n        }\r\n\r\n        if (notificationUrl) {\r\n            postBody.notificationUrl = notificationUrl;\r\n        }\r\n\r\n        if (clientState) {\r\n            postBody.clientState = clientState;\r\n        }\r\n\r\n        const data = await spPatch(this, body(postBody, headers({ \"Content-Type\": \"application/json\" })));\r\n\r\n        return { data, subscription: this };\r\n    }\r\n\r\n    /**\r\n     * Removes this webhook subscription\r\n     *\r\n     */\r\n    @tag(\"sub.delete\")\r\n    public delete(): Promise<void> {\r\n        return spDelete(this);\r\n    }\r\n}\r\nexport interface ISubscription extends _Subscription { }\r\nexport const Subscription = spInvokableFactory<ISubscription>(_Subscription);\r\n\r\n/**\r\n * Result from adding a new subscription\r\n *\r\n */\r\nexport interface ISubscriptionAddResult {\r\n    subscription: ISubscription;\r\n    data: any;\r\n}\r\n\r\n/**\r\n * Result from updating a subscription\r\n *\r\n */\r\nexport interface ISubscriptionUpdateResult {\r\n    subscription: ISubscription;\r\n    data: any;\r\n}\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _List } from \"../lists/types\";\r\nimport { Subscriptions, ISubscriptions } from \"./types\";\r\n\r\ndeclare module \"../lists/types\" {\r\n    interface _List {\r\n        readonly subscriptions: ISubscriptions;\r\n    }\r\n    interface IList {\r\n        /**\r\n         * Gets the collection of webhooks created for this list\r\n         *\r\n         */\r\n        readonly subscriptions: ISubscriptions;\r\n    }\r\n}\r\n\r\naddProp(_List, \"subscriptions\", Subscriptions);\r\n","import { defaultPath } from \"../decorators\";\r\nimport { _SharePointQueryableCollection, spInvokableFactory, _SharePointQueryableInstance } from \"../sharepointqueryable\";\r\nimport { tag } from \"../telemetry\";\r\n\r\n/**\r\n * Describes a collection of Form objects\r\n *\r\n */\r\n@defaultPath(\"_api/v2.1/termstore\")\r\nexport class _TermStore extends _SharePointQueryableInstance<ITermStoreInfo> {\r\n\r\n    /**\r\n     * Gets the term groups associated with this tenant\r\n     */\r\n    public get groups(): ITermGroups {\r\n        return tag.configure(TermGroups(this), \"txts.groups\");\r\n    }\r\n\r\n    /**\r\n     * Gets the term sets associated with this tenant\r\n     */\r\n    public get sets(): ITermSets {\r\n        return tag.configure(TermSets(this), \"txts.sets\");\r\n    }\r\n}\r\nexport interface ITermStore extends _TermStore { }\r\nexport const TermStore = spInvokableFactory<ITermStore>(_TermStore);\r\n\r\n\r\n@defaultPath(\"groups\")\r\nexport class _TermGroups extends _SharePointQueryableCollection<ITermGroupInfo[]> {\r\n\r\n    /**\r\n     * Gets a term group by id\r\n     * \r\n     * @param id Id of the term group to access\r\n     */\r\n    public getById(id: string): ITermGroup {\r\n        return tag.configure(TermGroup(this, id), \"txtgs.getById\");\r\n    }\r\n}\r\nexport interface ITermGroups extends _TermGroups { }\r\nexport const TermGroups = spInvokableFactory<ITermGroups>(_TermGroups);\r\n\r\nexport class _TermGroup extends _SharePointQueryableInstance<ITermGroupInfo> {\r\n\r\n    /**\r\n     * Gets the term sets associated with this tenant\r\n     */\r\n    public get sets(): ITermSets {\r\n        return tag.configure(TermSets(this, \"sets\"), \"txtg.sets\");\r\n    }\r\n}\r\nexport interface ITermGroup extends _TermGroup { }\r\nexport const TermGroup = spInvokableFactory<ITermGroup>(_TermGroup);\r\n\r\n\r\n@defaultPath(\"sets\")\r\nexport class _TermSets extends _SharePointQueryableCollection<ITermSetInfo[]> {\r\n\r\n    /**\r\n     * Gets a term group by id\r\n     * \r\n     * @param id Id of the term group to access\r\n     */\r\n    public getById(id: string): ITermSet {\r\n        return tag.configure(TermSet(this, id), \"txts.getById\");\r\n    }\r\n}\r\nexport interface ITermSets extends _TermSets { }\r\nexport const TermSets = spInvokableFactory<ITermSets>(_TermSets);\r\n\r\nexport class _TermSet extends _SharePointQueryableInstance<ITermSetInfo> {\r\n\r\n    // public get terms(): ITerms {\r\n    //     return Terms(this);\r\n    // }\r\n\r\n    public get parentGroup(): ITermGroup {\r\n        return tag.configure(TermGroup(this, \"parentGroup\"), \"txts.parentGroup\");\r\n    }\r\n\r\n    public get children(): IChildren {\r\n        return tag.configure(Children(this), \"txts.children\");\r\n    }\r\n\r\n    public get relations(): IRelations {\r\n        return tag.configure(Relations(this), \"txts.relations\");\r\n    }\r\n\r\n    public getTermById(id: string): ITerm {\r\n        return tag.configure(this.clone(Term, `terms/${id}`), \"txts.getTermById\");\r\n    }\r\n}\r\nexport interface ITermSet extends _TermSet { }\r\nexport const TermSet = spInvokableFactory<ITermSet>(_TermSet);\r\n\r\n// @defaultPath(\"terms\")\r\n// export class _Terms extends _SharePointQueryableCollection<ITermInfo[]> {\r\n\r\n//     /**\r\n//      * Gets a term group by id\r\n//      *\r\n//      * @param id Id of the term group to access\r\n//      */\r\n//     public getById(id: string): ITerm {\r\n//         return Term(this, id);\r\n//     }\r\n// }\r\n// export interface ITerms extends _Terms { }\r\n// export const Terms = spInvokableFactory<ITerms>(_Terms);\r\n\r\n@defaultPath(\"children\")\r\nexport class _Children extends _SharePointQueryableCollection<ITermInfo[]> { }\r\nexport interface IChildren extends _Children { }\r\nexport const Children = spInvokableFactory<IChildren>(_Children);\r\n\r\nexport class _Term extends _SharePointQueryableInstance<ITermInfo> {\r\n\r\n    public get parent(): ITerm {\r\n        return tag.configure(Term(this, \"parent\"), \"txt.parent\");\r\n    }\r\n\r\n    public get children(): IChildren {\r\n        return tag.configure(Children(this), \"txt.children\");\r\n    }\r\n\r\n    public get relations(): IRelations {\r\n        return tag.configure(Relations(this), \"txt.relations\");\r\n    }\r\n\r\n    public get set(): ITermSet {\r\n        return tag.configure(TermSet(this, \"set\"), \"txt.set\");\r\n    }\r\n}\r\nexport interface ITerm extends _Term { }\r\nexport const Term = spInvokableFactory<ITerm>(_Term);\r\n\r\n\r\n@defaultPath(\"relations\")\r\nexport class _Relations extends _SharePointQueryableCollection<IRelationInfo[]> {\r\n    /**\r\n     * Gets a term group by id\r\n     * \r\n     * @param id Id of the term group to access\r\n     */\r\n    public getById(id: string): IRelation {\r\n        return tag.configure(Relation(this, id), \"txrs.getById\");\r\n    }\r\n}\r\nexport interface IRelations extends _Relations { }\r\nexport const Relations = spInvokableFactory<IRelations>(_Relations);\r\n\r\nexport class _Relation extends _SharePointQueryableInstance<IRelationInfo> {\r\n\r\n    public get fromTerm(): ITerm {\r\n        return tag.configure(Term(this, \"fromTerm\"), \"txr.fromTerm\");\r\n    }\r\n\r\n    public get toTerm(): ITerm {\r\n        return tag.configure(Term(this, \"toTerm\"), \"txr.toTerm\");\r\n    }\r\n\r\n    public get set(): ITermSet {\r\n        return tag.configure(TermSet(this, \"set\"), \"txr.set\");\r\n    }\r\n}\r\nexport interface IRelation extends _Relation { }\r\nexport const Relation = spInvokableFactory<IRelation>(_Relation);\r\n\r\n\r\n// save these for when we are creating update types\r\n// Partial<Pick<ITermGroupInfo, \"name\" | \"description\">>\r\n// Omit<ITermGroupInfo, \"managers\" | \"contributors\" | \"createdDateTime\" | \"lastModifiedDateTime\">\r\n\r\n\r\nexport interface ITermStoreInfo {\r\n    id: string;\r\n    name: string;\r\n    defaultLanguageTag: string;\r\n    languageTags: string[];\r\n    administrators?: ITaxonomyUserInfo;\r\n}\r\n\r\nexport interface ITermGroupInfo {\r\n    id: string;\r\n    description: string;\r\n    name: string;\r\n    displayName: string;\r\n    createdDateTime: string;\r\n    lastModifiedDateTime: string;\r\n    type: string;\r\n    scope: \"global\" | \"system\" | \"siteCollection\";\r\n    managers?: ITaxonomyUserInfo[];\r\n    contributors?: ITaxonomyUserInfo[];\r\n}\r\n\r\nexport interface ITermSetInfo {\r\n    id: string;\r\n    localizedNames: { name: string, languageTag: string }[];\r\n    description: string;\r\n    createdDateTime: string;\r\n    properties: ITaxonomyProperty[];\r\n}\r\n\r\nexport interface ITermInfo {\r\n    id: string;\r\n    labels: { name: string, isDefault: boolean, languageTag: string }[];\r\n    createdDateTime: string;\r\n    lastModifiedDateTime: string;\r\n    descriptions: { description: string, languageTag: string }[];\r\n    properties: ITaxonomyProperty[];\r\n}\r\n\r\nexport interface IRelationInfo {\r\n    id: string;\r\n    relationType: string;\r\n}\r\n\r\nexport interface ITaxonomyUserInfo {\r\n    user: {\r\n        displayName: string;\r\n        email: string;\r\n        id: string;\r\n    };\r\n}\r\n\r\nexport interface ITaxonomyProperty {\r\n    key: string;\r\n    value: string;\r\n}\r\n","import { SPRest } from \"../rest\";\r\nimport { ITermStore, TermStore } from \"./types\";\r\n\r\nexport {\r\n    ITermStore,\r\n    TermStore,\r\n    ITaxonomyUserInfo,\r\n    ITermGroup,\r\n    ITermGroupInfo,\r\n    ITermGroups,\r\n    ITermSetInfo,\r\n    ITermSets,\r\n    ITermStoreInfo,\r\n    TermGroup,\r\n    TermGroups,\r\n    TermSets,\r\n    ITaxonomyProperty,\r\n    ITermInfo,\r\n    ITermSet,\r\n    TermSet,\r\n    IRelation,\r\n    IRelationInfo,\r\n    IRelations,\r\n    ITerm,\r\n    Relation,\r\n    Relations,\r\n    Term,\r\n    Children,\r\n    IChildren,\r\n} from \"./types\";\r\n\r\ndeclare module \"../rest\" {\r\n    interface SPRest {\r\n        readonly termStore: ITermStore;\r\n    }\r\n}\r\n\r\nReflect.defineProperty(SPRest.prototype, \"termStore\", {\r\n    configurable: true,\r\n    enumerable: true,\r\n    get: function (this: SPRest) {\r\n        return TermStore(this._baseUrl).configure(this._options);\r\n    },\r\n});\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _List } from \"../lists/types\";\r\nimport { UserCustomActions, IUserCustomActions } from \"./types\";\r\n\r\ndeclare module \"../lists/types\" {\r\n    interface _List {\r\n        readonly userCustomActions: IUserCustomActions;\r\n    }\r\n\r\n    interface IList {\r\n        /**\r\n         * Get all custom actions on a list\r\n         */\r\n        readonly userCustomActions: IUserCustomActions;\r\n    }\r\n}\r\n\r\naddProp(_List, \"userCustomActions\", UserCustomActions);\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _Web } from \"../webs/types\";\r\nimport { UserCustomActions, IUserCustomActions } from \"./types\";\r\n\r\ndeclare module \"../webs/types\" {\r\n    interface _Web {\r\n        /**\r\n         * Gets a newly refreshed collection of the SPWeb's SPUserCustomActionCollection\r\n         */\r\n        readonly userCustomActions: IUserCustomActions;\r\n    }\r\n\r\n    interface IWeb {\r\n        /**\r\n         * Gets a newly refreshed collection of the SPWeb's SPUserCustomActionCollection\r\n         */\r\n        readonly userCustomActions: IUserCustomActions;\r\n    }\r\n}\r\n\r\naddProp(_Web, \"userCustomActions\", UserCustomActions);\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _Site } from \"../sites/types\";\r\nimport { UserCustomActions, IUserCustomActions } from \"./types\";\r\n\r\ndeclare module \"../sites/types\" {\r\n    interface _Site {\r\n        readonly userCustomActions: IUserCustomActions;\r\n    }\r\n\r\n    interface ISite {\r\n        /**\r\n         * Get all custom actions on a site collection\r\n         */\r\n        readonly userCustomActions: IUserCustomActions;\r\n    }\r\n}\r\n\r\naddProp(_Site, \"userCustomActions\", UserCustomActions);\r\n","import { ITypedHash } from \"@pnp/common\";\r\nimport { body } from \"@pnp/odata\";\r\nimport {\r\n    _SharePointQueryableInstance,\r\n    _SharePointQueryableCollection,\r\n    spInvokableFactory,\r\n    IDeleteable,\r\n    deleteable,\r\n} from \"../sharepointqueryable\";\r\nimport { metadata } from \"../utils/metadata\";\r\nimport { defaultPath } from \"../decorators\";\r\nimport { spPost } from \"../operations\";\r\nimport { tag } from \"../telemetry\";\r\n\r\n@defaultPath(\"views\")\r\nexport class _Views extends _SharePointQueryableCollection<IViewInfo[]> {\r\n\r\n    /**\t  \r\n     * Gets a view by guid id\t    \r\n     *\t   \r\n     * @param id The GUID id of the view\t    \r\n     */\r\n    public getById(id: string): IView {\r\n        return View(this).concat(`('${id}')`);\r\n    }\r\n\r\n    /**\r\n     * Gets a view by title (case-sensitive)\r\n     *\r\n     * @param title The case-sensitive title of the view\r\n     */\r\n    public getByTitle(title: string): IView {\r\n        return View(this, `getByTitle('${title}')`);\r\n    }\r\n\r\n    /**\r\n     * Adds a new view to the collection\r\n     *\r\n     * @param title The new views's title\r\n     * @param personalView True if this is a personal view, otherwise false, default = false\r\n     * @param additionalSettings Will be passed as part of the view creation body\r\n     */\r\n    @tag(\"vs.add\")\r\n    public async add(title: string, personalView = false, additionalSettings: ITypedHash<any> = {}): Promise<IViewAddResult> {\r\n\r\n        const postBody = body(Object.assign(metadata(\"SP.View\"), {\r\n            \"PersonalView\": personalView,\r\n            \"Title\": title,\r\n        }, additionalSettings));\r\n\r\n        const data = await spPost(this.clone(Views, null), postBody);\r\n\r\n        return {\r\n            data,\r\n            view: this.getById(data.Id),\r\n        };\r\n    }\r\n}\r\nexport interface IViews extends _Views { }\r\nexport const Views = spInvokableFactory<IViews>(_Views);\r\n\r\nexport class _View extends _SharePointQueryableInstance<IViewInfo> {\r\n\r\n    public delete = deleteable(\"vw\");\r\n\r\n    public get fields(): IViewFields {\r\n        return ViewFields(this);\r\n    }\r\n\r\n    /**\r\n     * Updates this view intance with the supplied properties\r\n     *\r\n     * @param properties A plain object hash of values to update for the view\r\n     */\r\n    public update: any = this._update<IViewUpdateResult, ITypedHash<any>>(\"SP.View\", data => ({ data, view: <any>this }));\r\n\r\n    /**\r\n     * Returns the list view as HTML.\r\n     *\r\n     */\r\n    @tag(\"v.renderAsHtml\")\r\n    public renderAsHtml(): Promise<string> {\r\n        return this.clone(View, \"renderashtml\")();\r\n    }\r\n\r\n    /**\r\n     * Sets the view schema\r\n     * \r\n     * @param viewXml The view XML to set\r\n     */\r\n    @tag(\"v.setViewXml\")\r\n    public setViewXml(viewXml: string): Promise<void> {\r\n        return spPost(this.clone(View, \"SetViewXml\"), body({ viewXml }));\r\n    }\r\n}\r\nexport interface IView extends _View, IDeleteable { }\r\nexport const View = spInvokableFactory<IView>(_View);\r\n\r\n@defaultPath(\"viewfields\")\r\nexport class _ViewFields extends _SharePointQueryableCollection<{ SchemaXml: string; }> {\r\n\r\n    /**\r\n     * Gets a value that specifies the XML schema that represents the collection.\r\n     */\r\n    @tag(\"vfs.getSchemaXml\")\r\n    public getSchemaXml(): Promise<string> {\r\n        return this.clone(ViewFields, \"schemaxml\")();\r\n    }\r\n\r\n    /**\r\n     * Adds the field with the specified field internal name or display name to the collection.\r\n     *\r\n     * @param fieldTitleOrInternalName The case-sensitive internal name or display name of the field to add.\r\n     */\r\n    @tag(\"vfs.add\")\r\n    public add(fieldTitleOrInternalName: string): Promise<void> {\r\n        return spPost(this.clone(ViewFields, `addviewfield('${fieldTitleOrInternalName}')`));\r\n    }\r\n\r\n    /**\r\n     * Moves the field with the specified field internal name to the specified position in the collection.\r\n     *\r\n     * @param field The case-sensitive internal name of the field to move.\r\n     * @param index The zero-based index of the new position for the field.\r\n     */\r\n    @tag(\"vfs.move\")\r\n    public move(field: string, index: number): Promise<void> {\r\n        return spPost(this.clone(ViewFields, \"moveviewfieldto\"), body({ field, index }));\r\n    }\r\n\r\n    /**\r\n     * Removes all the fields from the collection.\r\n     */\r\n    @tag(\"vfs.removeAll\")\r\n    public removeAll(): Promise<void> {\r\n        return spPost(this.clone(ViewFields, \"removeallviewfields\"));\r\n    }\r\n\r\n    /**\r\n     * Removes the field with the specified field internal name from the collection.\r\n     *\r\n     * @param fieldInternalName The case-sensitive internal name of the field to remove from the view.\r\n     */\r\n    @tag(\"vfs.remove\")\r\n    public remove(fieldInternalName: string): Promise<void> {\r\n        return spPost(this.clone(ViewFields, `removeviewfield('${fieldInternalName}')`));\r\n    }\r\n}\r\nexport interface IViewFields extends _ViewFields { }\r\nexport const ViewFields = spInvokableFactory<IViewFields>(_ViewFields);\r\n\r\nexport interface IViewAddResult {\r\n    view: IView;\r\n    data: IViewInfo;\r\n}\r\n\r\nexport interface IViewUpdateResult {\r\n    view: IView;\r\n    data: IViewInfo;\r\n}\r\n\r\nexport enum ViewScope {\r\n    DefaultValue,\r\n    Recursive,\r\n    RecursiveAll,\r\n    FilesOnly,\r\n}\r\n\r\nexport interface IViewInfo {\r\n    EditorModified: boolean;\r\n    Formats: string | null;\r\n    Hidden: boolean;\r\n    HtmlSchemaXml: string;\r\n    Id: string;\r\n    ImageUrl: string;\r\n    IncludeRootFolder: boolean;\r\n    JSLink: string;\r\n    ListViewXml: string;\r\n    Method: string | null;\r\n    MobileDefaultView: boolean;\r\n    MobileView: boolean;\r\n    ModerationType: string | null;\r\n    NewDocumentTemplates: string;\r\n    OrderedView: boolean;\r\n    Paged: boolean;\r\n    PersonalView: boolean;\r\n    ReadOnlyView: boolean;\r\n    RequiresClientIntegration: boolean;\r\n    RowLimit: number;\r\n    Scope: ViewScope;\r\n    ServerRelativePath: { DecodedUrl: string; };\r\n    ServerRelativeUrl: string;\r\n    StyleId: string | null;\r\n    TabularView: boolean;\r\n    Threaded: boolean;\r\n    Title: string;\r\n    Toolbar: string;\r\n    ToolbarTemplateName: string | null;\r\n    ViewData: string | null;\r\n    ViewJoins: string | null;\r\n    ViewProjectedFields: { SchemaXml: string } | null;\r\n    ViewQuery: string;\r\n    ViewType: string;\r\n    VisualizationInfo: any | null;\r\n}\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _List } from \"../lists/types\";\r\nimport { Views, IViews, IView, View } from \"./types\";\r\n\r\ndeclare module \"../lists/types\" {\r\n    interface _List {\r\n        readonly views: IViews;\r\n        readonly defaultView: IView;\r\n        getView(id: string): IView;\r\n    }\r\n    interface IList {\r\n        /**\r\n         * Gets the views on this list\r\n         */\r\n        readonly views: IViews;\r\n        /**\r\n         * Gets the default view for this list\r\n         */\r\n        readonly defaultView: IView;\r\n        /**\r\n         * Gets a view by view guid id\r\n         *\r\n         */\r\n        getView(id: string): IView;\r\n    }\r\n}\r\n\r\naddProp(_List, \"views\", Views);\r\naddProp(_List, \"defaultView\", View, \"DefaultView\");\r\n\r\n_List.prototype.getView = function (this: _List, viewId: string): IView {\r\n    return View(this, `getView('${viewId}')`);\r\n};\r\n","import {\r\n    _SharePointQueryableInstance,\r\n    _SharePointQueryableCollection,\r\n    ISharePointQueryableInstance,\r\n    _SharePointQueryable,\r\n    ISharePointQueryable,\r\n    spInvokableFactory,\r\n    SharePointQueryable,\r\n    SharePointQueryableInstance,\r\n} from \"../sharepointqueryable\";\r\nimport { body } from \"@pnp/odata\";\r\nimport { spPost } from \"../operations\";\r\nimport { tag } from \"../telemetry\";\r\n\r\nexport class _LimitedWebPartManager extends _SharePointQueryable implements ILimitedWebPartManager {\r\n\r\n    public get scope(): ISharePointQueryable {\r\n        return tag.configure(SharePointQueryable(this, \"Scope\"), \"f.scope\");\r\n    }\r\n\r\n    public get webparts(): IWebPartDefinitions {\r\n        return WebPartDefinitions(this, \"webparts\");\r\n    }\r\n\r\n    public export(id: string): Promise<string> {\r\n        return spPost(this.clone(LimitedWebPartManagerCloneFactory, \"ExportWebPart\"), body({ webPartId: id }));\r\n    }\r\n\r\n    public import(xml: string): Promise<any> {\r\n        return spPost(this.clone(LimitedWebPartManagerCloneFactory, \"ImportWebPart\"), body({ webPartXml: xml }));\r\n    }\r\n}\r\n\r\nexport interface ILimitedWebPartManager {\r\n\r\n    /**\r\n     * Gets the scope of this web part manager (User = 0 or Shared = 1)\r\n     */\r\n    readonly scope: ISharePointQueryable;\r\n\r\n    /**\r\n     * Gets the set of web part definitions contained by this web part manager\r\n     */\r\n    readonly webparts: IWebPartDefinitions;\r\n\r\n    /**\r\n     * Exports a webpart definition\r\n     *\r\n     * @param id the GUID id of the definition to export\r\n     */\r\n    export(id: string): Promise<string>;\r\n\r\n    /**\r\n     * Imports a webpart\r\n     *\r\n     * @param xml webpart definition which must be valid XML in the .dwp or .webpart format\r\n     */\r\n    import(xml: string): Promise<any>;\r\n}\r\n\r\nexport const LimitedWebPartManager = (baseUrl: string | ISharePointQueryable, path?: string): ILimitedWebPartManager => new _LimitedWebPartManager(baseUrl, path);\r\n\r\ntype LimitedWebPartManagerCloneType = ILimitedWebPartManager & ISharePointQueryable;\r\nconst LimitedWebPartManagerCloneFactory = (baseUrl: string | ISharePointQueryable, path?: string): LimitedWebPartManagerCloneType => <any>LimitedWebPartManager(baseUrl, path);\r\n\r\nexport class _WebPartDefinitions extends _SharePointQueryableCollection {\r\n\r\n    /**\r\n     * Gets a web part definition from the collection by id\r\n     *\r\n     * @param id The storage ID of the SPWebPartDefinition to retrieve\r\n     */\r\n    public getById(id: string): IWebPartDefinition {\r\n        return WebPartDefinition(this, `getbyid('${id}')`);\r\n    }\r\n\r\n    /**\r\n     * Gets a web part definition from the collection by storage id\r\n     *\r\n     * @param id The WebPart.ID of the SPWebPartDefinition to retrieve\r\n     */\r\n    public getByControlId(id: string): IWebPartDefinition {\r\n        return WebPartDefinition(this, `getByControlId('${id}')`);\r\n    }\r\n}\r\nexport interface IWebPartDefinitions extends _WebPartDefinitions { }\r\nexport const WebPartDefinitions = spInvokableFactory<IWebPartDefinitions>(_WebPartDefinitions);\r\n\r\nexport class _WebPartDefinition extends _SharePointQueryableInstance {\r\n\r\n    /**\r\n    * Gets the webpart information associated with this definition\r\n    */\r\n    public get webpart(): ISharePointQueryableInstance {\r\n        return SharePointQueryableInstance(this, \"webpart\");\r\n    }\r\n\r\n    /**\r\n     * Saves changes to the Web Part made using other properties and methods on the SPWebPartDefinition object\r\n     */\r\n    public saveChanges(): Promise<any> {\r\n        return spPost(this.clone(WebPartDefinition, \"SaveWebPartChanges\"));\r\n    }\r\n\r\n    /**\r\n     * Moves the Web Part to a different location on a Web Part Page\r\n     *\r\n     * @param zoneId The ID of the Web Part Zone to which to move the Web Part\r\n     * @param zoneIndex A Web Part zone index that specifies the position at which the Web Part is to be moved within the destination Web Part zone\r\n     */\r\n    public moveTo(zoneId: string, zoneIndex: number): Promise<void> {\r\n        return spPost(this.clone(WebPartDefinition, `MoveWebPartTo(zoneID='${zoneId}', zoneIndex=${zoneIndex})`));\r\n    }\r\n\r\n    /**\r\n     * Closes the Web Part. If the Web Part is already closed, this method does nothing\r\n     */\r\n    public close(): Promise<void> {\r\n        return spPost(this.clone(WebPartDefinition, \"CloseWebPart\"));\r\n    }\r\n\r\n    /**\r\n     * Opens the Web Part. If the Web Part is already closed, this method does nothing\r\n     */\r\n    public open(): Promise<void> {\r\n        return spPost(this.clone(WebPartDefinition, \"OpenWebPart\"));\r\n    }\r\n\r\n    /**\r\n     * Removes a webpart from a page, all settings will be lost\r\n     */\r\n    public delete(): Promise<void> {\r\n        return spPost(this.clone(WebPartDefinition, \"DeleteWebPart\"));\r\n    }\r\n}\r\nexport interface IWebPartDefinition extends _WebPartDefinition { }\r\nexport const WebPartDefinition = spInvokableFactory<IWebPartDefinition>(_WebPartDefinition);\r\n\r\nexport enum WebPartsPersonalizationScope {\r\n    User = 0,\r\n    Shared = 1,\r\n}\r\n","import { _File } from \"../files/types\";\r\nimport { WebPartsPersonalizationScope, ILimitedWebPartManager, LimitedWebPartManager } from \"./types\";\r\n\r\ndeclare module \"../files/types\" {\r\n    interface _File {\r\n        getLimitedWebPartManager(scope?: WebPartsPersonalizationScope): ILimitedWebPartManager;\r\n    }\r\n    interface IFile {\r\n        /**\r\n         * Specifies the control set used to access, modify, or add Web Parts associated with this Web Part Page and view.\r\n         * An exception is thrown if the file is not an ASPX page.\r\n         *\r\n         * @param scope The WebPartsPersonalizationScope view on the Web Parts page.\r\n         */\r\n        getLimitedWebPartManager(scope?: WebPartsPersonalizationScope): ILimitedWebPartManager;\r\n    }\r\n}\r\n\r\n_File.prototype.getLimitedWebPartManager = function (this: _File, scope = WebPartsPersonalizationScope.Shared): ILimitedWebPartManager {\r\n    return LimitedWebPartManager(this, `getLimitedWebPartManager(scope=${scope})`);\r\n};\r\n","import { SPRest } from \"../rest\";\r\n\r\nimport \"../appcatalog\";\r\nimport \"../attachments\";\r\nimport \"../clientside-pages\";\r\nimport \"../column-defaults\";\r\nimport \"../comments\";\r\nimport \"../content-types\";\r\nimport \"../features\";\r\nimport \"../fields\";\r\nimport \"../files\";\r\nimport \"../folders\";\r\nimport \"../forms\";\r\nimport \"../hubsites\";\r\nimport \"../items\";\r\nimport \"../lists\";\r\nimport \"../navigation\";\r\nimport \"../profiles\";\r\nimport \"../regional-settings\";\r\nimport \"../related-items\";\r\nimport \"../search\";\r\nimport \"../security\";\r\nimport \"../sharing\";\r\nimport \"../site-designs\";\r\nimport \"../site-groups\";\r\nimport \"../site-scripts\";\r\nimport \"../site-users\";\r\nimport \"../sites\";\r\nimport \"../social\";\r\nimport \"../sputilities\";\r\nimport \"../subscriptions\";\r\nimport \"../taxonomy\";\r\nimport \"../user-custom-actions\";\r\nimport \"../views\";\r\nimport \"../webparts\";\r\nimport \"../webs\";\r\n\r\nexport * from \"../appcatalog\";\r\nexport * from \"../attachments\";\r\nexport * from \"../clientside-pages\";\r\nexport * from \"../column-defaults\";\r\nexport * from \"../comments\";\r\nexport * from \"../content-types\";\r\nexport * from \"../features\";\r\nexport * from \"../fields\";\r\nexport * from \"../files\";\r\nexport * from \"../folders\";\r\nexport * from \"../forms\";\r\nexport * from \"../hubsites\";\r\nexport * from \"../items\";\r\nexport * from \"../lists\";\r\nexport * from \"../navigation\";\r\nexport { spODataEntity, spODataEntityArray } from \"../odata\";\r\nexport * from \"../profiles\";\r\nexport * from \"../regional-settings\";\r\nexport * from \"../related-items\";\r\nexport * from \"../search\";\r\nexport * from \"../security\";\r\nexport * from \"../sharing\";\r\nexport * from \"../site-designs\";\r\nexport * from \"../site-groups\";\r\nexport * from \"../site-scripts\";\r\nexport * from \"../site-users\";\r\nexport * from \"../sites\";\r\nexport * from \"../social\";\r\nexport * from \"../sputilities\";\r\nexport * from \"../subscriptions\";\r\nexport * from \"../taxonomy\";\r\nexport * from \"../user-custom-actions\";\r\nexport * from \"../views\";\r\nexport * from \"../webparts\";\r\nexport * from \"../webs\";\r\nexport * from \"../index\";\r\n\r\nexport const sp = new SPRest();\r\n","import { IGraphQueryable } from \"./graphqueryable\";\r\nimport { graphDelete, graphPatch, graphPost } from \"./operations\";\r\nimport { body, headers } from \"@pnp/odata\";\r\n\r\n/**\r\n * Decorator used to specify the default path for Queryable objects\r\n * \r\n * @param path \r\n */\r\nexport function defaultPath(path: string) {\r\n\r\n    return function <T extends { new(...args: any[]): {} }>(target: T) {\r\n\r\n        return class extends target {\r\n            constructor(...args: any[]) {\r\n                super(args[0], args.length > 1 && args[1] !== undefined ? args[1] : path);\r\n            }\r\n        };\r\n    };\r\n}\r\n\r\n/**\r\n * Adds the delete method to the tagged class\r\n */\r\nexport function deleteable() {\r\n    return function <T extends { new(...args: any[]): {} }>(target: T) {\r\n\r\n        return class extends target {\r\n            public delete(this: IGraphQueryable): Promise<void> {\r\n                return graphDelete(this);\r\n            }\r\n        };\r\n    };\r\n}\r\n\r\nexport interface IDeleteable {\r\n    /**\r\n     * Delete this instance\r\n     */\r\n    delete(): Promise<void>;\r\n}\r\n\r\n/**\r\n * Adds the delete method to the tagged class\r\n */\r\nexport function deleteableWithETag() {\r\n    return function <T extends { new(...args: any[]): {} }>(target: T) {\r\n\r\n        return class extends target {\r\n            public delete(this: IGraphQueryable, eTag = \"*\"): Promise<void> {\r\n                return graphDelete(this, headers({\r\n                        \"If-Match\": eTag,\r\n                }));\r\n            }\r\n        };\r\n    };\r\n}\r\n\r\nexport interface IDeleteableWithETag {\r\n    /**\r\n     * Delete this instance\r\n     */\r\n    delete(eTag?: string): Promise<void>;\r\n}\r\n\r\n/**\r\n * Adds the update method to the tagged class\r\n */\r\nexport function updateable() {\r\n    return function <T extends { new(...args: any[]): {} }>(target: T) {\r\n\r\n        return class extends target {\r\n            public update(this: IGraphQueryable, props: any): Promise<void> {\r\n                return graphPatch(this, body(props));\r\n            }\r\n        };\r\n    };\r\n}\r\n\r\nexport interface IUpdateable<T = any> {\r\n    /**\r\n     * Update the properties of an event object\r\n     * \r\n     * @param props Set of properties to update\r\n     */\r\n    update(props: T): Promise<void>;\r\n}\r\n\r\n/**\r\n * Adds the update method to the tagged class\r\n */\r\nexport function updateableWithETag() {\r\n    return function <T extends { new(...args: any[]): {} }>(target: T) {\r\n\r\n        return class extends target {\r\n            public update(this: IGraphQueryable, props: any, eTag = \"*\"): Promise<void> {\r\n                return graphPatch(this, body(props, headers({\r\n                    \"If-Match\": eTag,\r\n                })));\r\n            }\r\n        };\r\n    };\r\n}\r\n\r\nexport interface IUpdateableWithETag<T = any> {\r\n    /**\r\n     * Update the properties of an event object\r\n     * \r\n     * @param props Set of properties to update\r\n     */\r\n    update(props: T, eTag?: string): Promise<void>;\r\n}\r\n\r\n/**\r\n * Adds the add method to the tagged class\r\n */\r\nexport function addable() {\r\n    return function <T extends { new(...args: any[]): {} }>(target: T) {\r\n\r\n        return class extends target {\r\n            public add(this: IGraphQueryable, props: any): Promise<void> {\r\n                return graphPost(this, body(props));\r\n            }\r\n        };\r\n    };\r\n}\r\n\r\nexport interface IAddable<T = any, R = { id: string }> {\r\n    /**\r\n     * Adds a new item to this collection\r\n     * \r\n     * @param props properties used to create the new thread\r\n     */\r\n    add(props: T): Promise<R>;\r\n}\r\n\r\n/**\r\n * Adds the getById method to a collection\r\n */\r\nexport function getById<R>(factory: (...args: any[]) => R) {\r\n    return function <T extends { new(...args: any[]): {} }>(target: T) {\r\n\r\n        return class extends target {\r\n            public getById(this: IGraphQueryable, id: string): R {\r\n                return factory(this, id);\r\n            }\r\n        };\r\n    };\r\n}\r\nexport interface IGetById<R = any, T = string> {\r\n    /**\r\n     * Adds a new item to this collection\r\n     * \r\n     * @param props properties used to create the new thread\r\n     */\r\n    getById(id: T): R;\r\n}\r\n","import { body } from \"@pnp/odata\";\r\nimport {\r\n    ConversationThread as IConversationThreadType,\r\n    Post as IPostType,\r\n    Recipient as IRecipientType,\r\n    Conversation as IConversationType,\r\n    User as IUserType,\r\n} from \"@microsoft/microsoft-graph-types\";\r\nimport {\r\n    _GraphQueryableCollection,\r\n    _GraphQueryableInstance,\r\n    graphInvokableFactory,\r\n} from \"../graphqueryable\";\r\nimport { defaultPath, updateable, IUpdateable, deleteable, IDeleteable, addable, IAddable, getById, IGetById } from \"../decorators\";\r\nimport { graphPost, graphDelete } from \"../operations\";\r\n\r\n/**\r\n * Conversation\r\n */\r\n@updateable()\r\n@deleteable()\r\nexport class _Conversation extends _GraphQueryableInstance<IConversationType> {\r\n\r\n    /**\r\n     * Get all the threads in a group conversation.\r\n     */\r\n    public get threads(): IThreads {\r\n        return Threads(this);\r\n    }\r\n}\r\nexport interface IConversation extends _Conversation, IUpdateable<IConversationType>, IDeleteable { }\r\nexport const Conversation = graphInvokableFactory<IConversation>(_Conversation);\r\n\r\n/**\r\n * Conversations\r\n */\r\n@defaultPath(\"conversations\")\r\n@addable()\r\n@getById(Conversation)\r\nexport class _Conversations extends _GraphQueryableCollection<IConversationType[]> { }\r\nexport interface IConversations extends _Conversations, IGetById<IConversation>, IAddable<IConversationType> { }\r\nexport const Conversations = graphInvokableFactory<IConversations>(_Conversations);\r\n\r\n/**\r\n * Thread\r\n */\r\n@deleteable()\r\nexport class _Thread extends _GraphQueryableInstance {\r\n\r\n    /**\r\n     * Get all the threads in a group conversation.\r\n     */\r\n    public get posts(): IPosts {\r\n        return Posts(this);\r\n    }\r\n\r\n    /**\r\n     * Reply to a thread in a group conversation and add a new post to it\r\n     * \r\n     * @param post Contents of the post \r\n     */\r\n    public reply(post: IPostType): Promise<void> {\r\n        return graphPost(this.clone(Thread, \"reply\"), body(post));\r\n    }\r\n}\r\nexport interface IThread extends _Thread, IDeleteable { }\r\nexport const Thread = graphInvokableFactory<IThread>(_Thread);\r\n\r\n/**\r\n * Threads\r\n */\r\n@defaultPath(\"threads\")\r\n@addable()\r\n@getById(Thread)\r\nexport class _Threads extends _GraphQueryableCollection<IConversationThreadType[]> { }\r\nexport interface IThreads extends _Threads, IGetById<IThread>, IAddable<IConversationThreadType, { id: string }> { }\r\nexport const Threads = graphInvokableFactory<IThreads>(_Threads);\r\n\r\n\r\n/**\r\n * Post\r\n */\r\n@deleteable()\r\nexport class _Post extends _GraphQueryableInstance<IPostType> {\r\n    /**\r\n     * Forward a post to a recipient\r\n     */\r\n    public forward(info: IPostForwardInfo): Promise<void> {\r\n        return graphPost(this.clone(Post, \"forward\"), body(info));\r\n    }\r\n\r\n    /**\r\n     * Reply to a thread in a group conversation and add a new post to it\r\n     * \r\n     * @param post Contents of the post \r\n     */\r\n    public reply(post: IPostType): Promise<void> {\r\n        return graphPost(this.clone(Post, \"reply\"), body(post));\r\n    }\r\n}\r\nexport interface IPost extends _Post, IDeleteable { }\r\nexport const Post = graphInvokableFactory<IPost>(_Post);\r\n\r\n/**\r\n * Posts\r\n */\r\n@defaultPath(\"posts\")\r\n@addable()\r\n@getById(Post)\r\nexport class _Posts extends _GraphQueryableCollection<IPostType[]> { }\r\nexport interface IPosts extends _Posts, IGetById<IPost>, IAddable<IPostType> { }\r\nexport const Posts = graphInvokableFactory<IPosts>(_Posts);\r\n\r\n/**\r\n * Senders\r\n */\r\nexport class _Senders extends _GraphQueryableCollection<IUserType[]> {\r\n\r\n    /**\r\n     * Add a new user or group to this senders collection\r\n     * @param id The full @odata.id value to add (ex: https://graph.microsoft.com/v1.0/users/user@contoso.com)\r\n     */\r\n    public add(id: string): Promise<any> {\r\n        return graphPost(this.clone(Senders, \"$ref\"), body({ \"@odata.id\": id }));\r\n    }\r\n\r\n    /**\r\n     * Removes the entity from the collection\r\n     * \r\n     * @param id The full @odata.id value to remove (ex: https://graph.microsoft.com/v1.0/users/user@contoso.com)\r\n     */\r\n    public remove(id: string): Promise<void> {\r\n        const remover = this.clone(Senders, \"$ref\");\r\n        remover.query.set(\"$id\", id);\r\n        return graphDelete(remover);\r\n    }\r\n}\r\nexport interface ISenders extends _Senders { }\r\nexport const Senders = graphInvokableFactory<ISenders>(_Senders);\r\n\r\n/**\r\n * Information used to forward a post\r\n */\r\nexport interface IPostForwardInfo {\r\n    comment?: string;\r\n    toRecipients: IRecipientType[];\r\n}\r\n","import { Attachment as IAttachmentType } from \"@microsoft/microsoft-graph-types\";\r\nimport { body } from \"@pnp/odata\";\r\nimport { _GraphQueryableCollection, _GraphQueryableInstance, graphInvokableFactory } from \"../graphqueryable\";\r\nimport { graphPost } from \"../operations\";\r\nimport { defaultPath, getById, IGetById } from \"../decorators\";\r\nimport { type } from \"../utils/type\";\r\n\r\n/**\r\n * Attachment\r\n */\r\nexport class _Attachment extends _GraphQueryableInstance<IAttachmentType> { }\r\nexport interface IAttachment extends _Attachment { }\r\nexport const Attachment = graphInvokableFactory<IAttachment>(_Attachment);\r\n\r\n/**\r\n * Attachments\r\n */\r\n@defaultPath(\"attachments\")\r\n@getById(Attachment)\r\nexport class _Attachments extends _GraphQueryableCollection<IAttachmentType[]> {\r\n\r\n    /**\r\n     * Add attachment to this collection\r\n     * \r\n     * @param name Name given to the attachment file\r\n     * @param bytes File content\r\n     */\r\n    public addFile(name: string, bytes: string | Blob): Promise<IAttachmentType> {\r\n\r\n        return graphPost(this, body(type(\"#microsoft.graph.fileAttachment\", {\r\n            contentBytes: bytes,\r\n            name,\r\n        })));\r\n    }\r\n}\r\nexport interface IAttachments extends _Attachments, IGetById<IAttachment> {}\r\nexport const Attachments = graphInvokableFactory<IAttachments>(_Attachments);\r\n","export function type<T = unknown>(n: string, a: T): T & { \"@odata.type\": string} {\r\n    return Object.assign({ \"@odata.type\": n }, a);\r\n}\r\n","import { _Post } from \"../conversations/types\";\r\nimport { addProp } from \"@pnp/odata\";\r\nimport { Attachments, IAttachments } from \"./types\";\r\n\r\ndeclare module \"../conversations/types\" {\r\n    interface _Post {\r\n        readonly attachments: IAttachments;\r\n    }\r\n    interface IPost {\r\n        readonly attachments: IAttachments;\r\n    }\r\n}\r\n\r\naddProp(_Post, \"attachments\", Attachments);\r\n","import { _GraphQueryableCollection, _GraphQueryableInstance, graphInvokableFactory } from \"../graphqueryable\";\r\nimport { DirectoryObject as IDirectoryObjectType } from \"@microsoft/microsoft-graph-types\";\r\nimport { defaultPath, getById, IGetById, deleteable, IDeleteable } from \"../decorators\";\r\nimport { body } from \"@pnp/odata\";\r\nimport { graphPost } from \"../operations\";\r\n\r\n/**\r\n * Represents a Directory Object entity\r\n */\r\n@deleteable()\r\nexport class _DirectoryObject<GetType = IDirectoryObjectType> extends _GraphQueryableInstance<GetType> {\r\n\r\n  /**\r\n   * Returns all the groups and directory roles that the specified Directory Object is a member of. The check is transitive\r\n   * \r\n   * @param securityEnabledOnly \r\n   */\r\n  public getMemberObjects(securityEnabledOnly = false): Promise<string[]> {\r\n    return graphPost(this.clone(DirectoryObject, \"getMemberObjects\"), body({ securityEnabledOnly }));\r\n  }\r\n\r\n  /**\r\n   * Returns all the groups that the specified Directory Object is a member of. The check is transitive\r\n   * \r\n   * @param securityEnabledOnly \r\n   */\r\n  public getMemberGroups(securityEnabledOnly = false): Promise<string[]> {\r\n    return graphPost(this.clone(DirectoryObject, \"getMemberGroups\"), body({ securityEnabledOnly }));\r\n  }\r\n\r\n  /**\r\n   * Check for membership in a specified list of groups, and returns from that list those groups of which the specified user, group, or directory object is a member. \r\n   * This function is transitive.\r\n   * @param groupIds A collection that contains the object IDs of the groups in which to check membership. Up to 20 groups may be specified.\r\n   */\r\n  public checkMemberGroups(groupIds: String[]): Promise<string[]> {\r\n    return graphPost(this.clone(DirectoryObject, \"checkMemberGroups\"), body({ groupIds }));\r\n  }\r\n}\r\n\r\nexport interface IDirectoryObject<GetType = IDirectoryObjectType> extends _DirectoryObject, IDeleteable { }\r\nexport const DirectoryObject = graphInvokableFactory<IDirectoryObject>(_DirectoryObject);\r\n\r\n/**\r\n * Describes a collection of Directory Objects\r\n *\r\n */\r\n@defaultPath(\"directoryObjects\")\r\n@getById(DirectoryObject)\r\nexport class _DirectoryObjects<GetType = IDirectoryObjectType[]> extends _GraphQueryableCollection<GetType> {\r\n  /**\r\n  * Returns the directory objects specified in a list of ids. NOTE: The directory objects returned are the full objects containing all their properties. \r\n  * The $select query option is not available for this operation.\r\n  * \r\n  * @param ids A collection of ids for which to return objects. You can specify up to 1000 ids.\r\n  * @param type A collection of resource types that specifies the set of resource collections to search. Default is directoryObject.\r\n  */\r\n  public getByIds(ids: string[], type: DirectoryObjectTypes = DirectoryObjectTypes.directoryObject): Promise<IDirectoryObjectType[]> {\r\n    return graphPost(this.clone(DirectoryObjects, \"getByIds\"), body({ ids, type }));\r\n  }\r\n}\r\nexport interface IDirectoryObjects extends _DirectoryObjects, IGetById<IDirectoryObjectType> { }\r\nexport const DirectoryObjects = graphInvokableFactory<IDirectoryObjects>(_DirectoryObjects);\r\n\r\n/**\r\n * DirectoryObjectTypes\r\n */\r\nexport enum DirectoryObjectTypes {\r\n  /**\r\n   * Directory Objects\r\n   */\r\n  directoryObject,\r\n  /**\r\n   * User\r\n   */\r\n  user,\r\n  /**\r\n   * Group\r\n   */\r\n  group,\r\n  /**\r\n   * Device\r\n   */\r\n  device,\r\n}\r\n","import { assign, ITypedHash } from \"@pnp/common\";\r\nimport { Event as IEventType, Group as IGroupType } from \"@microsoft/microsoft-graph-types\";\r\nimport { body } from \"@pnp/odata\";\r\nimport { _GraphQueryableInstance, _GraphQueryableCollection, graphInvokableFactory } from \"../graphqueryable\";\r\nimport { defaultPath, deleteable, IDeleteable, updateable, IUpdateable, getById, IGetById } from \"../decorators\";\r\nimport { graphPost } from \"../operations\";\r\nimport { _DirectoryObject, _DirectoryObjects } from \"../directory-objects/types\";\r\n\r\nexport enum GroupType {\r\n    /**\r\n     * Office 365 (aka unified group)\r\n     */\r\n    Office365,\r\n    /**\r\n     * Dynamic membership\r\n     */\r\n    Dynamic,\r\n    /**\r\n     * Security\r\n     */\r\n    Security,\r\n}\r\n\r\n/**\r\n * Represents a group entity\r\n */\r\n@deleteable()\r\n@updateable()\r\nexport class _Group extends _DirectoryObject<IGroupType> {\r\n    /**\r\n     * Add the group to the list of the current user's favorite groups. Supported for only Office 365 groups\r\n     */\r\n    public addFavorite(): Promise<void> {\r\n        return graphPost(this.clone(Group, \"addFavorite\"));\r\n    }\r\n    /**\r\n     * Remove the group from the list of the current user's favorite groups. Supported for only Office 365 groups\r\n     */\r\n    public removeFavorite(): Promise<void> {\r\n        return graphPost(this.clone(Group, \"removeFavorite\"));\r\n    }\r\n    /**\r\n     * Reset the unseenCount of all the posts that the current user has not seen since their last visit\r\n     */\r\n    public resetUnseenCount(): Promise<void> {\r\n        return graphPost(this.clone(Group, \"resetUnseenCount\"));\r\n    }\r\n    /**\r\n     * Calling this method will enable the current user to receive email notifications for this group,\r\n     * about new posts, events, and files in that group. Supported for only Office 365 groups\r\n     */\r\n    public subscribeByMail(): Promise<void> {\r\n        return graphPost(this.clone(Group, \"subscribeByMail\"));\r\n    }\r\n    /**\r\n     * Calling this method will prevent the current user from receiving email notifications for this group\r\n     * about new posts, events, and files in that group. Supported for only Office 365 groups\r\n     */\r\n    public unsubscribeByMail(): Promise<void> {\r\n        return graphPost(this.clone(Group, \"unsubscribeByMail\"));\r\n    }\r\n    /**\r\n     * Get the occurrences, exceptions, and single instances of events in a calendar view defined by a time range, from the default calendar of a group\r\n     * \r\n     * @param start Start date and time of the time range\r\n     * @param end End date and time of the time range\r\n     */\r\n    public getCalendarView(start: Date, end: Date): Promise<IEventType[]> {\r\n\r\n        const view = this.clone(Group, \"calendarView\");\r\n        view.query.set(\"startDateTime\", start.toISOString());\r\n        view.query.set(\"endDateTime\", end.toISOString());\r\n        return view();\r\n    }\r\n}\r\nexport interface IGroup extends _Group, IDeleteable, IUpdateable { }\r\nexport const Group = graphInvokableFactory<IGroup>(_Group);\r\n\r\n/**\r\n * Describes a collection of Field objects\r\n *\r\n */\r\n@defaultPath(\"groups\")\r\n@getById(Group)\r\nexport class _Groups extends _GraphQueryableCollection<IGroupType[]> {\r\n\r\n    /**\r\n     * Create a new group as specified in the request body.\r\n     * \r\n     * @param name Name to display in the address book for the group\r\n     * @param mailNickname Mail alias for the group\r\n     * @param groupType Type of group being created\r\n     * @param additionalProperties A plain object collection of additional properties you want to set on the new group\r\n     */\r\n    public async add(name: string, mailNickname: string, groupType: GroupType, additionalProperties: ITypedHash<any> = {}): Promise<IGroupAddResult> {\r\n\r\n        let postBody = assign({\r\n            displayName: name,\r\n            mailEnabled: groupType === GroupType.Office365,\r\n            mailNickname: mailNickname,\r\n            securityEnabled: groupType !== GroupType.Office365,\r\n        }, additionalProperties);\r\n\r\n        // include a group type if required\r\n        if (groupType !== GroupType.Security) {\r\n\r\n            postBody = assign(postBody, {\r\n                groupTypes: groupType === GroupType.Office365 ? [\"Unified\"] : [\"DynamicMembership\"],\r\n            });\r\n        }\r\n\r\n        const data = await graphPost(this, body(postBody));\r\n\r\n        return {\r\n            data,\r\n            group: (<any>this).getById(data.id),\r\n        };\r\n    }\r\n}\r\nexport interface IGroups extends _Groups, IGetById<IGroup> { }\r\nexport const Groups = graphInvokableFactory<IGroups>(_Groups);\r\n\r\n/**\r\n * IGroupAddResult\r\n */\r\nexport interface IGroupAddResult {\r\n    group: IGroup;\r\n    data: any;\r\n}\r\n","import { IGraphQueryable, GraphQueryableCollection, IGraphQueryableCollection } from \"../graphqueryable\";\r\nimport { Event as IEvent } from \"@microsoft/microsoft-graph-types\";\r\n\r\n/**\r\n * Get the occurrences, exceptions, and single instances of events in a calendar view defined by a time range,\r\n * from the user's default calendar, or from some other calendar of the user's\r\n * \r\n * @param this IGraphQueryable instance\r\n * @param start start time\r\n * @param end end time\r\n */\r\nexport function calendarView(this: IGraphQueryable, start: string, end: string): IGraphQueryableCollection<ICalendarViewInfo[]> {\r\n\r\n    const query = this.clone(GraphQueryableCollection, \"calendarView\");\r\n    query.query.set(\"startDateTime\", encodeURIComponent(start));\r\n    query.query.set(\"endDateTime\", encodeURIComponent(end));\r\n    return query;\r\n}\r\n\r\n/**\r\n * Temporary until graph types include this type\r\n */\r\nexport interface ICalendarViewInfo extends IEvent {\r\n    \"@odata.etag\": string;\r\n}\r\n","import { body } from \"@pnp/odata\";\r\nimport { Event as IEventType, Calendar as ICalendarType } from \"@microsoft/microsoft-graph-types\";\r\nimport { _GraphQueryableCollection, _GraphQueryableInstance, graphInvokableFactory } from \"../graphqueryable\";\r\nimport { defaultPath, IDeleteable, deleteable, IUpdateable, updateable, getById, IGetById } from \"../decorators\";\r\nimport { graphPost } from \"../operations\";\r\nimport { calendarView } from \"./funcs\";\r\n\r\n/**\r\n * Calendar\r\n */\r\nexport class _Calendar extends _GraphQueryableInstance<ICalendarType> {\r\n\r\n    public get events(): IEvents {\r\n        return Events(this);\r\n    }\r\n\r\n    public calendarView = calendarView;\r\n}\r\nexport interface ICalendar extends _Calendar { }\r\nexport const Calendar = graphInvokableFactory<ICalendar>(_Calendar);\r\n\r\n/**\r\n * Calendars\r\n */\r\n@defaultPath(\"calendars\")\r\n@getById(Calendar)\r\nexport class _Calendars extends _GraphQueryableCollection<ICalendarType[]> { }\r\nexport interface ICalendars<GetType = any> extends _Calendars, IGetById<ICalendar> { }\r\nexport const Calendars = graphInvokableFactory<ICalendars>(_Calendars);\r\n\r\n/**\r\n * Event\r\n */\r\n@deleteable()\r\n@updateable()\r\nexport class _Event extends _GraphQueryableInstance<IEventType> { }\r\nexport interface IEvent extends _Event, IDeleteable, IUpdateable { }\r\nexport const Event = graphInvokableFactory<IEvent>(_Event);\r\n\r\n/**\r\n * Events\r\n */\r\n@defaultPath(\"events\")\r\n@getById(Event)\r\nexport class _Events extends _GraphQueryableCollection<IEventType[]> {\r\n\r\n    /**\r\n     * Adds a new event to the collection\r\n     * \r\n     * @param properties The set of properties used to create the event\r\n     */\r\n    public async add(properties: IEventType): Promise<IEventAddResult> {\r\n\r\n        const data = await graphPost(this, body(properties));\r\n\r\n        return {\r\n            data,\r\n            event: (<any>this).getById(data.id),\r\n        };\r\n    }\r\n}\r\nexport interface IEvents extends _Events, IGetById<IEvent> { }\r\nexport const Events = graphInvokableFactory<IEvents>(_Events);\r\n\r\n/**\r\n * EventAddResult\r\n */\r\nexport interface IEventAddResult {\r\n    data: IEventType;\r\n    event: IEvent;\r\n}\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _Group } from \"../groups/types\";\r\nimport { Calendar, ICalendar, IEvents, Events } from \"./types\";\r\n\r\ndeclare module \"../groups/types\" {\r\n    interface _Group {\r\n        readonly calendar: ICalendar;\r\n        readonly attachmentFiles: ICalendar;\r\n        readonly events: IEvents;\r\n    }\r\n    interface IGroup {\r\n        readonly calendar: ICalendar;\r\n        readonly attachmentFiles: ICalendar;\r\n        readonly events: IEvents;\r\n    }\r\n}\r\n\r\naddProp(_Group, \"calendar\", Calendar, \"calendar\");\r\naddProp(_Group, \"events\", Events);\r\n","import { _GraphQueryableCollection, graphInvokableFactory, _GraphQueryableInstance } from \"../graphqueryable\";\r\nimport { User as IUserType, Person as IPersonType } from \"@microsoft/microsoft-graph-types\";\r\nimport { _DirectoryObject, DirectoryObjects, IDirectoryObjects } from \"../directory-objects/types\";\r\nimport { defaultPath, updateable, deleteable, IUpdateable, IDeleteable, getById, IGetById } from \"../decorators\";\r\n\r\n@updateable()\r\n@deleteable()\r\nexport class _User extends _DirectoryObject<IUserType> {\r\n    /**\r\n    * The groups and directory roles associated with the user\r\n    */\r\n    public get memberOf(): IDirectoryObjects {\r\n        return DirectoryObjects(this, \"memberOf\");\r\n    }\r\n\r\n    /**\r\n     * Retrieve a collection of person objects ordered by their relevance to the user\r\n     */\r\n    public get people(): IPeople {\r\n        return People(this);\r\n    }\r\n}\r\nexport interface IUser extends _User, IUpdateable<IUserType>, IDeleteable { }\r\nexport const User = graphInvokableFactory<IUser>(_User);\r\n\r\n@defaultPath(\"users\")\r\n@getById(User)\r\nexport class _Users extends _GraphQueryableCollection<IUserType[]> { }\r\nexport interface IUsers extends _Users, IGetById<IUser> { }\r\nexport const Users = graphInvokableFactory<IUsers>(_Users);\r\n\r\n@defaultPath(\"people\")\r\nexport class _People extends _GraphQueryableCollection<IPersonType[]> {}\r\nexport interface IPeople extends _People { }\r\nexport const People = graphInvokableFactory<IPeople>(_People);\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _User } from \"../users/types\";\r\nimport { Calendar, ICalendar, IEvents, Events, Calendars, ICalendars } from \"./types\";\r\nimport { calendarView, ICalendarViewInfo } from \"./funcs\";\r\nimport { IGraphQueryableCollection } from \"../graphqueryable\";\r\n\r\ndeclare module \"../users/types\" {\r\n    interface _User {\r\n        readonly calendar: ICalendar;\r\n        readonly calendars: ICalendars;\r\n        readonly attachmentFiles: ICalendar;\r\n        readonly events: IEvents;\r\n        calendarView(start: string, end: string): IGraphQueryableCollection<ICalendarViewInfo[]>;\r\n    }\r\n    interface IUser {\r\n        readonly calendar: ICalendar;\r\n        readonly calendars: ICalendars;\r\n        readonly attachmentFiles: ICalendar;\r\n        readonly events: IEvents;\r\n        calendarView(start: string, end: string): IGraphQueryableCollection<ICalendarViewInfo[]>;\r\n    }\r\n}\r\n\r\naddProp(_User, \"calendar\", Calendar, \"calendar\");\r\naddProp(_User, \"calendars\", Calendars, \"calendars\");\r\naddProp(_User, \"events\", Events);\r\n\r\n_User.prototype.calendarView = calendarView;\r\n","import { _GraphQueryableCollection, _GraphQueryableInstance, graphInvokableFactory } from \"../graphqueryable\";\r\nimport { ITypedHash, assign } from \"@pnp/common\";\r\nimport { Contact as IContactType, ContactFolder as IContactFolderType, EmailAddress as IEmailAddressType } from \"@microsoft/microsoft-graph-types\";\r\nimport { defaultPath, updateable, deleteable, IUpdateable, IDeleteable, getById, IGetById } from \"../decorators\";\r\nimport { graphPost } from \"../operations\";\r\nimport { body } from \"@pnp/odata\";\r\n\r\n/**\r\n * Contact\r\n */\r\n@updateable()\r\n@deleteable()\r\nexport class _Contact extends _GraphQueryableInstance<IContactType> { }\r\nexport interface IContact extends _Contact, IUpdateable<IContactType>, IDeleteable { }\r\nexport const Contact = graphInvokableFactory<IContact>(_Contact);\r\n\r\n/**\r\n * Contacts\r\n */\r\n@defaultPath(\"contacts\")\r\n@getById(Contact)\r\nexport class _Contacts extends _GraphQueryableCollection<IContactType[]> {\r\n\r\n    /**\r\n    * Create a new Contact for the user.\r\n    * \r\n    * @param givenName The contact's given name.\r\n    * @param surName The contact's surname.\r\n    * @param emailAddresses The contact's email addresses.\r\n    * @param businessPhones The contact's business phone numbers.\r\n    * @param additionalProperties A plain object collection of additional properties you want to set on the new contact\r\n    */\r\n    public async add(\r\n        givenName: string,\r\n        surName: string,\r\n        emailAddresses: IEmailAddressType[],\r\n        businessPhones: string[],\r\n        additionalProperties: ITypedHash<any> = {}): Promise<IContactAddResult> {\r\n\r\n        const postBody = assign({ businessPhones, emailAddresses, givenName, surName }, additionalProperties);\r\n\r\n        const data = await graphPost(this, body(postBody));\r\n\r\n        return {\r\n            contact: (<any>this).getById(data.id),\r\n            data,\r\n        };\r\n    }\r\n}\r\nexport interface IContacts extends _Contacts, IGetById<IContact> { }\r\nexport const Contacts = graphInvokableFactory<IContacts>(_Contacts);\r\n\r\n/**\r\n * Contact Folder\r\n */\r\n@deleteable()\r\n@updateable()\r\nexport class _ContactFolder extends _GraphQueryableInstance<IContactFolderType> {\r\n    /**\r\n     * Gets the contacts in this contact folder\r\n     */\r\n    public get contacts(): IContacts {\r\n        return Contacts(this);\r\n    }\r\n\r\n    /**\r\n    * Gets the contacts in this contact folder\r\n    */\r\n    public get childFolders(): IContactFolders {\r\n        return ContactFolders(this, \"childFolders\");\r\n    }\r\n}\r\nexport interface IContactFolder extends _ContactFolder, IUpdateable, IDeleteable { }\r\nexport const ContactFolder = graphInvokableFactory<IContactFolder>(_ContactFolder);\r\n\r\n/**\r\n * Contact Folders\r\n */\r\n@defaultPath(\"contactFolders\")\r\n@getById(ContactFolder)\r\nexport class _ContactFolders extends _GraphQueryableCollection<IContactFolderType[]> {\r\n\r\n    /**\r\n     * Create a new Contact Folder for the user.\r\n     * \r\n     * @param displayName The folder's display name.\r\n     * @param parentFolderId The ID of the folder's parent folder.\r\n     */\r\n    public async add(displayName: string, parentFolderId?: string): Promise<IContactFolderAddResult> {\r\n\r\n        const postBody = {\r\n            displayName: displayName,\r\n            parentFolderId: parentFolderId,\r\n        };\r\n\r\n        const data = await graphPost(this, body(postBody));\r\n\r\n        return {\r\n            contactFolder: (<any>this).getById(data.id),\r\n            data,\r\n        };\r\n    }\r\n}\r\nexport interface IContactFolders extends _ContactFolders, IGetById<IContactFolder> { }\r\nexport const ContactFolders = graphInvokableFactory<IContactFolders>(_ContactFolders);\r\n\r\n/**\r\n * IContactFolderAddResult\r\n */\r\nexport interface IContactFolderAddResult {\r\n    data: IContactFolderType;\r\n    contactFolder: IContactFolder;\r\n}\r\n\r\n/**\r\n * IContactAddResult\r\n */\r\nexport interface IContactAddResult {\r\n    data: IContactType;\r\n    contact: IContact;\r\n}\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _User } from \"../users/types\";\r\nimport { IContacts, Contacts, ContactFolders, IContactFolders } from \"./types\";\r\n\r\ndeclare module \"../users/types\" {\r\n    interface _User {\r\n        readonly contacts: IContacts;\r\n        readonly contactFolders: IContactFolders;\r\n    }\r\n    interface IUser {\r\n        readonly contacts: IContacts;\r\n        readonly contactFolders: IContactFolders;\r\n    }\r\n}\r\n\r\naddProp(_User, \"contacts\", Contacts);\r\naddProp(_User, \"contactFolders\", ContactFolders);\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _Group } from \"../groups/types\";\r\nimport { Conversations, IConversations, ISenders, Senders } from \"./types\";\r\n\r\ndeclare module \"../groups/types\" {\r\n    interface _Group {\r\n        readonly conversations: IConversations;\r\n        readonly acceptedSenders: ISenders;\r\n        readonly rejectedSenders: ISenders;\r\n    }\r\n    interface IGroup {\r\n        readonly conversations: IConversations;\r\n        readonly acceptedSenders: ISenders;\r\n        readonly rejectedSenders: ISenders;\r\n    }\r\n}\r\n\r\naddProp(_Group, \"conversations\", Conversations);\r\naddProp(_Group, \"acceptedSenders\", Senders, \"acceptedsenders\");\r\naddProp(_Group, \"rejectedSenders\", Senders, \"rejectedsenders\");\r\n","import { GraphRest } from \"../rest\";\r\nimport { IDirectoryObjects, DirectoryObjects } from \"./types\";\r\n\r\nexport {\r\n    IDirectoryObject,\r\n    DirectoryObjectTypes,\r\n    DirectoryObject,\r\n    DirectoryObjects,\r\n    IDirectoryObjects,\r\n} from \"./types\";\r\n\r\ndeclare module \"../rest\" {\r\n    interface GraphRest {\r\n        readonly directoryObjects: IDirectoryObjects;\r\n    }\r\n}\r\n\r\nReflect.defineProperty(GraphRest.prototype, \"directoryObjects\", {\r\n    configurable: true,\r\n    enumerable: true,\r\n    get: function (this: GraphRest) {\r\n        return DirectoryObjects(this);\r\n    },\r\n});\r\n","import { GraphRest } from \"../rest\";\r\nimport { IGroups, Groups } from \"./types\";\r\n\r\nexport {\r\n    Group,\r\n    GroupType,\r\n    Groups,\r\n    IGroup,\r\n    IGroupAddResult,\r\n    IGroups,\r\n} from \"./types\";\r\n\r\ndeclare module \"../rest\" {\r\n    interface GraphRest {\r\n        readonly groups: IGroups;\r\n    }\r\n}\r\n\r\nReflect.defineProperty(GraphRest.prototype, \"groups\", {\r\n    configurable: true,\r\n    enumerable: true,\r\n    get: function (this: GraphRest) {\r\n        return Groups(this);\r\n    },\r\n});\r\n","import {\r\n    OfficeGraphInsights as IOfficeGraphInsightsType,\r\n    Trending as ITrendingInsightType,\r\n    UsedInsight as IUsedInsightType,\r\n    SharedInsight as ISharedInsightType,\r\n    Entity as IEntityType,\r\n} from \"@microsoft/microsoft-graph-types\";\r\nimport {\r\n    _GraphQueryableInstance,\r\n    _GraphQueryableCollection,\r\n    graphInvokableFactory,\r\n} from \"../graphqueryable\";\r\nimport { defaultPath, getById, IGetById } from \"../decorators\";\r\n\r\n/**\r\n * Represents a insights entity\r\n */\r\n@defaultPath(\"insights\")\r\nexport class _Insights extends _GraphQueryableInstance<IOfficeGraphInsightsType> {\r\n\r\n    public get trending(): ITrendingInsights {\r\n        return TrendingInsights(this);\r\n    }\r\n\r\n    public get used(): IUsedInsights {\r\n        return UsedInsights(this);\r\n    }\r\n\r\n    public get shared(): ISharedInsights {\r\n        return SharedInsights(this);\r\n    }\r\n}\r\nexport interface IInsights extends _Insights {}\r\nexport const Insights = graphInvokableFactory<IInsights>(_Insights);\r\n\r\n/**\r\n * Describes a Trending Insight instance\r\n */\r\nexport class _TrendingInsight extends _GraphQueryableInstance<ITrendingInsightType> {\r\n    public get resource(): IResource {\r\n        return Resource(this);\r\n    }\r\n}\r\nexport interface ITrendingInsight extends _TrendingInsight { }\r\nexport const TrendingInsight = graphInvokableFactory<ITrendingInsight>(_TrendingInsight);\r\n\r\n/**\r\n * Describes a collection of Trending Insight objects\r\n *\r\n */\r\n@defaultPath(\"trending\")\r\n@getById(TrendingInsight)\r\nexport class _TrendingInsights extends _GraphQueryableCollection<ITrendingInsightType[]> {}\r\nexport interface ITrendingInsights extends _TrendingInsights, IGetById<ITrendingInsight> {}\r\nexport const TrendingInsights = graphInvokableFactory<ITrendingInsights>(_TrendingInsights);\r\n\r\n/**\r\n * Describes a Used Insight instance\r\n */\r\nexport class _UsedInsight extends _GraphQueryableInstance<IUsedInsightType> {\r\n    public get resource(): IResource {\r\n        return Resource(this);\r\n    }\r\n}\r\nexport interface IUsedInsight extends _UsedInsight { }\r\nexport const UsedInsight = graphInvokableFactory<IUsedInsight>(_UsedInsight);\r\n\r\n/**\r\n * Describes a collection of Used Insight objects\r\n *\r\n */\r\n@defaultPath(\"used\")\r\n@getById(UsedInsight)\r\nexport class _UsedInsights extends _GraphQueryableCollection<IUsedInsightType[]> {}\r\nexport interface IUsedInsights extends _UsedInsights, IGetById<IUsedInsight> {}\r\nexport const UsedInsights = graphInvokableFactory<IUsedInsights>(_UsedInsights);\r\n\r\n/**\r\n * Describes a Shared Insight instance\r\n */\r\nexport class _SharedInsight extends _GraphQueryableInstance<ISharedInsightType> {\r\n    public get resource(): IResource {\r\n        return Resource(this);\r\n    }\r\n}\r\nexport interface ISharedInsight extends _SharedInsight { }\r\nexport const SharedInsight = graphInvokableFactory<ISharedInsight>(_SharedInsight);\r\n\r\n/**\r\n * Describes a collection of Shared Insight objects\r\n *\r\n */\r\n@defaultPath(\"shared\")\r\n@getById(SharedInsight)\r\nexport class _SharedInsights extends _GraphQueryableCollection<ISharedInsightType[]> {}\r\nexport interface ISharedInsights extends _SharedInsights, IGetById<ISharedInsight> {}\r\nexport const SharedInsights = graphInvokableFactory<ISharedInsights>(_SharedInsights);\r\n\r\n/**\r\n * Describes a Resource Entity instance\r\n */\r\n@defaultPath(\"resource\")\r\nexport class _Resource extends _GraphQueryableInstance<IEntityType> {}\r\nexport interface IResource extends _Resource { }\r\nexport const Resource = graphInvokableFactory<IResource>(_Resource);\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _User } from \"../users/types\";\r\nimport { IInsights, Insights } from \"./types\";\r\n\r\ndeclare module \"../users/types\" {\r\n    interface _User {\r\n        readonly insights: IInsights;\r\n    }\r\n    interface IUser {\r\n        readonly insights: IInsights;\r\n    }\r\n}\r\n\r\naddProp(_User, \"insights\", Insights);\r\n","import { ITypedHash, assign } from \"@pnp/common\";\r\nimport { body } from \"@pnp/odata\";\r\nimport { Invitation as IInvitationType } from \"@microsoft/microsoft-graph-types\";\r\nimport { _GraphQueryableCollection, graphInvokableFactory } from \"../graphqueryable\";\r\nimport { defaultPath } from \"../decorators\";\r\nimport { graphPost } from \"../operations\";\r\n\r\n/**\r\n * Invitations\r\n */\r\n@defaultPath(\"invitations\")\r\nexport class _Invitations extends _GraphQueryableCollection<IInvitationType[]> {\r\n\r\n    /**\r\n     * Create a new Invitation via invitation manager.\r\n     * \r\n     * @param invitedUserEmailAddress The email address of the user being invited.\r\n     * @param inviteRedirectUrl The URL user should be redirected to once the invitation is redeemed.\r\n     * @param additionalProperties A plain object collection of additional properties you want to set in the invitation\r\n     */\r\n    public async create(invitedUserEmailAddress: string, inviteRedirectUrl: string, additionalProperties: ITypedHash<any> = {}): Promise<IInvitationAddResult> {\r\n\r\n        const postBody = assign({ inviteRedirectUrl, invitedUserEmailAddress }, additionalProperties);\r\n\r\n        const data = await graphPost<IInvitationType>(this, body(postBody));\r\n\r\n        return { data };\r\n    }\r\n}\r\nexport interface IInvitations extends _Invitations {}\r\nexport const Invitations = graphInvokableFactory<IInvitations>(_Invitations);\r\n\r\n/**\r\n * IInvitationAddResult\r\n */\r\nexport interface IInvitationAddResult {\r\n    data: IInvitationType;\r\n}\r\n","import { GraphRest } from \"../rest\";\r\nimport { IInvitations, Invitations } from \"./types\";\r\n\r\nexport {\r\n    IInvitationAddResult,\r\n    IInvitations,\r\n    Invitations,\r\n} from \"./types\";\r\n\r\ndeclare module \"../rest\" {\r\n    interface GraphRest {\r\n        readonly invitations: IInvitations;\r\n    }\r\n}\r\n\r\nReflect.defineProperty(GraphRest.prototype, \"invitations\", {\r\n    configurable: true,\r\n    enumerable: true,\r\n    get: function (this: GraphRest) {\r\n        return Invitations(this);\r\n    },\r\n});\r\n","import { body } from \"@pnp/odata\";\r\nimport { User as IMemberType } from \"@microsoft/microsoft-graph-types\";\r\nimport { _GraphQueryableCollection, _GraphQueryableInstance, graphInvokableFactory } from \"../graphqueryable\";\r\nimport { defaultPath, getById, IGetById } from \"../decorators\";\r\nimport { graphDelete, graphPost } from \"../operations\";\r\n\r\n/**\r\n * Member\r\n */\r\nexport class _Member extends _GraphQueryableInstance<IMemberType> {\r\n    /**\r\n     * Removes this Member\r\n     */\r\n    public remove(): Promise<void> {\r\n        return graphDelete(this.clone(Member, \"$ref\"));\r\n    }\r\n}\r\nexport interface IMember extends _Member { }\r\nexport const Member = graphInvokableFactory<IMember>(_Member);\r\n\r\n/**\r\n * Members\r\n */\r\n@defaultPath(\"members\")\r\n@getById(Member)\r\nexport class _Members extends _GraphQueryableCollection<IMemberType[]> {\r\n\r\n    /**\r\n     * Use this API to add a member to an Office 365 group, a security group or a mail-enabled security group through\r\n     * the members navigation property. You can add users or other groups.\r\n     * Important: You can add only users to Office 365 groups.\r\n     * \r\n     * @param id Full @odata.id of the directoryObject, user, or group object you want to add (ex: `https://graph.microsoft.com/v1.0/directoryObjects/${id}`)\r\n     */\r\n    public add(id: string): Promise<any> {\r\n        return graphPost(this.clone(Members, \"$ref\"), body({ \"@odata.id\": id }));\r\n    }\r\n}\r\nexport interface IMembers extends _Members, IGetById<IMember> { }\r\nexport const Members = graphInvokableFactory<IMembers>(_Members);\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _Group } from \"../groups/types\";\r\nimport { IMembers, Members } from \"./types\";\r\n\r\ndeclare module \"../groups/types\" {\r\n    interface _Group {\r\n        readonly owners: IMembers;\r\n        readonly members: IMembers;\r\n    }\r\n    interface IGroup {\r\n        readonly owners: IMembers;\r\n        readonly members: IMembers;\r\n    }\r\n}\r\n\r\naddProp(_Group, \"owners\", Members, \"owners\");\r\naddProp(_Group, \"members\", Members);\r\n","import { Message as IMessageType, MailFolder as IMailFolderType, MailboxSettings as IMailboxSettingsType } from \"@microsoft/microsoft-graph-types\";\r\nimport { _GraphQueryableCollection, _GraphQueryableInstance, graphInvokableFactory } from \"../graphqueryable\";\r\nimport { defaultPath, getById, addable, IGetById, IAddable, updateable, IUpdateable } from \"../decorators\";\r\n\r\n/**\r\n * Message\r\n */\r\nexport class _Message extends _GraphQueryableInstance<IMessageType> { }\r\nexport interface IMessage extends _Message { }\r\nexport const Message = graphInvokableFactory<IMessage>(_Message);\r\n\r\n/**\r\n * Messages\r\n */\r\n@defaultPath(\"messages\")\r\n@getById(Message)\r\n@addable()\r\nexport class _Messages extends _GraphQueryableCollection<IMessageType[]> { }\r\nexport interface IMessages extends _Messages, IGetById<IMessage>, IAddable<IMessageType> { }\r\nexport const Messages = graphInvokableFactory<IMessages>(_Messages);\r\n\r\n/**\r\n * MailFolder\r\n */\r\nexport class _MailFolder extends _GraphQueryableInstance<IMailFolderType> { }\r\nexport interface IMailFolder extends _MailFolder { }\r\nexport const MailFolder = graphInvokableFactory<IMailFolder>(_MailFolder);\r\n\r\n/**\r\n * MailFolders\r\n */\r\n@defaultPath(\"mailFolders\")\r\n@getById(MailFolder)\r\n@addable()\r\nexport class _MailFolders extends _GraphQueryableCollection<IMailFolderType[]> { }\r\nexport interface IMailFolders extends _MailFolders, IGetById<IMailFolder>, IAddable<IMailFolderType> { }\r\nexport const MailFolders = graphInvokableFactory<IMailFolders>(_MailFolders);\r\n\r\n/**\r\n * MailboxSettings\r\n */\r\n@defaultPath(\"mailboxSettings\")\r\n@updateable()\r\nexport class _MailboxSettings extends _GraphQueryableInstance<IMailboxSettingsType> { }\r\nexport interface IMailboxSettings extends _MailboxSettings, IUpdateable<IMailboxSettingsType> { }\r\nexport const MailboxSettings = graphInvokableFactory<IMailboxSettings>(_MailboxSettings);\r\n","import { addProp, body } from \"@pnp/odata\";\r\nimport { _User, User } from \"../users/types\";\r\nimport { IMessages, Messages, IMailboxSettings, MailboxSettings, IMailFolders, MailFolders, IMessage } from \"./types\";\r\nimport { graphPost } from \"../operations\";\r\n\r\ndeclare module \"../users/types\" {\r\n    interface _User {\r\n        readonly messages: IMessages;\r\n        readonly mailboxSettings: IMailboxSettings;\r\n        readonly mailFolders: IMailFolders;\r\n        sendMail(message: IMessage): Promise<void>;\r\n    }\r\n    interface IUser {\r\n        readonly messages: IMessages;\r\n        readonly mailboxSettings: IMailboxSettings;\r\n        readonly mailFolders: IMailFolders;\r\n        sendMail(message: IMessage): Promise<void>;\r\n    }\r\n}\r\n\r\naddProp(_User, \"messages\", Messages);\r\naddProp(_User, \"mailboxSettings\", MailboxSettings);\r\naddProp(_User, \"mailFolders\", MailFolders);\r\n\r\n_User.prototype.sendMail = function (this: _User, message: IMessage): Promise<void> {\r\n    return graphPost(this.clone(User, \"sendMail\"), body(message));\r\n};\r\n","import {\r\n    GraphQueryableInstance,\r\n    GraphQueryableCollection,\r\n    _GraphQueryableInstance,\r\n    IGraphQueryableInstance,\r\n    IGraphQueryableCollection,\r\n    _GraphQueryableCollection,\r\n    graphInvokableFactory,\r\n} from \"../graphqueryable\";\r\nimport { Drive as IDriveType } from \"@microsoft/microsoft-graph-types\";\r\nimport { assign, combine, safeGlobal } from \"@pnp/common\";\r\nimport { defaultPath, getById, IGetById, deleteable, IDeleteable, updateable, IUpdateable } from \"../decorators\";\r\nimport { body, BlobParser } from \"@pnp/odata\";\r\nimport { graphPatch, graphPut } from \"../operations\";\r\n\r\n/**\r\n * Describes a Drive instance\r\n *\r\n */\r\n@defaultPath(\"drive\")\r\nexport class _Drive extends _GraphQueryableInstance<IDriveType> {\r\n\r\n    public get root(): IRoot {\r\n        return Root(this);\r\n    }\r\n\r\n    public get list(): IGraphQueryableInstance {\r\n        return this.clone(GraphQueryableInstance, \"list\");\r\n    }\r\n\r\n    public get recent(): IDriveItems {\r\n        return DriveItems(this, \"recent\");\r\n    }\r\n\r\n    public get sharedWithMe(): IDriveItems {\r\n        return DriveItems(this, \"sharedWithMe\");\r\n    }\r\n\r\n    public getItemById(id: string): IDriveItem {\r\n        return DriveItem(this, combine(\"items\", id));\r\n    }\r\n}\r\nexport interface IDrive extends _Drive {}\r\nexport const Drive = graphInvokableFactory<IDrive>(_Drive);\r\n\r\n/**\r\n * Describes a collection of Drive objects\r\n *\r\n */\r\n@defaultPath(\"drives\")\r\n@getById(Drive)\r\nexport class _Drives extends _GraphQueryableCollection<IDriveType[]> { }\r\nexport interface IDrives extends _Drives, IGetById<IDrive> { }\r\nexport const Drives = graphInvokableFactory<IDrives>(_Drives);\r\n\r\n/**\r\n * Describes a Root instance\r\n *\r\n */\r\n@defaultPath(\"root\")\r\nexport class _Root extends _GraphQueryableInstance<IDrive> {\r\n\r\n    public get children(): IDriveItems {\r\n        return DriveItems(this, \"children\");\r\n    }\r\n\r\n    public search(query: string): Promise<any> {\r\n        const searcher = this.clone(Root);\r\n        searcher.query.set(\"search\", `'${query}'`);\r\n        return searcher();\r\n    }\r\n\r\n    public get thumbnails(): IGraphQueryableCollection {\r\n        return this.clone(GraphQueryableCollection, \"thumbnails\");\r\n    }\r\n}\r\nexport interface IRoot extends _Root {}\r\nexport const Root = graphInvokableFactory<IRoot>(_Root);\r\n\r\n/**\r\n * Describes a Drive Item instance\r\n *\r\n */\r\n@deleteable()\r\n@updateable()\r\nexport class _DriveItem extends _GraphQueryableInstance<any> {\r\n\r\n    public get children(): IDriveItems {\r\n        return DriveItems(this, \"children\");\r\n    }\r\n\r\n    public get thumbnails(): IGraphQueryableCollection {\r\n        return this.clone(GraphQueryableCollection, \"thumbnails\");\r\n    }\r\n\r\n    public get versions(): IGraphQueryableCollection<IDriveItemVersionInfo> {\r\n        return <any>this.clone(GraphQueryableCollection, \"versions\");\r\n    }\r\n\r\n    public move(parentReference: { id: \"string\" }, name: string): Promise<void> {\r\n        return graphPatch(this, body(assign(parentReference, { name })));\r\n    }\r\n\r\n    public async getContent(): Promise<Blob> {\r\n        const info = await this();\r\n        const r = await safeGlobal.fetch(info[\"@microsoft.graph.downloadUrl\"], {\r\n            headers: {\r\n                \"accept\": \"application/json\",\r\n            },\r\n            method: \"GET\",\r\n            responseType: \"arraybuffer\",\r\n        });\r\n\r\n        const p = new BlobParser();\r\n        return p.parse(r);\r\n    }\r\n\r\n    public setContent(content: any): Promise<{ id: string, name: string, size: number }> {\r\n        return graphPut(this.clone(DriveItem, \"content\"), {\r\n            body: content,\r\n        });\r\n    }\r\n}\r\nexport interface IDriveItem extends _DriveItem, IDeleteable, IUpdateable {}\r\nexport const DriveItem = graphInvokableFactory<IDriveItem>(_DriveItem);\r\n\r\n/**\r\n * Describes a collection of Drive Item objects\r\n *\r\n */\r\n@getById(DriveItem)\r\nexport class _DriveItems extends _GraphQueryableCollection { }\r\nexport interface IDriveItems extends _DriveItems, IGetById<IDriveItem> { }\r\nexport const DriveItems = graphInvokableFactory<IDriveItems>(_DriveItems);\r\n\r\n/**\r\n * IDriveItemAddResult\r\n */\r\nexport interface IDriveItemAddResult {\r\n    data: any;\r\n    driveItem: IDriveItem;\r\n}\r\n\r\nexport interface IDriveItemVersionInfo {\r\n    id: string;\r\n    lastModifiedBy: {\r\n        user: {\r\n            id: string;\r\n            displayName: string;\r\n        },\r\n    };\r\n    lastModifiedDateTime: string;\r\n    size: number;\r\n}\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _User } from \"../users/types\";\r\nimport { IDrive, Drive, IDrives, Drives } from \"./types\";\r\n\r\ndeclare module \"../users/types\" {\r\n    interface _User {\r\n        readonly drive: IDrive;\r\n        readonly drives: IDrives;\r\n    }\r\n    interface IUser {\r\n        readonly drive: IDrive;\r\n        readonly drives: IDrives;\r\n    }\r\n}\r\n\r\naddProp(_User, \"drive\", Drive);\r\naddProp(_User, \"drives\", Drives);\r\n","import { body } from \"@pnp/odata\";\r\nimport { Notebook as INotebookType, Onenote as IOnenoteType, OnenoteSection as ISectionType, OnenotePage as IOnenotePageType } from \"@microsoft/microsoft-graph-types\";\r\nimport {\r\n    GraphQueryableCollection,\r\n    _GraphQueryableInstance,\r\n    _GraphQueryableCollection,\r\n    IGraphQueryableCollection,\r\n    graphInvokableFactory,\r\n} from \"../graphqueryable\";\r\nimport { defaultPath, getById, IGetById } from \"../decorators\";\r\nimport { graphPost } from \"../operations\";\r\n\r\n/**\r\n * Represents a onenote entity\r\n */\r\n@defaultPath(\"onenote\")\r\nexport class _OneNote extends _GraphQueryableInstance<IOnenoteType> {\r\n\r\n    public get notebooks(): INotebooks {\r\n        return Notebooks(this);\r\n    }\r\n\r\n    public get sections(): ISections {\r\n        return Sections(this);\r\n    }\r\n\r\n    public get pages(): IGraphQueryableCollection<IOnenotePageType[]> {\r\n        return this.clone(GraphQueryableCollection, \"pages\");\r\n    }\r\n}\r\nexport interface IOneNote extends _OneNote {}\r\nexport const OneNote = graphInvokableFactory<IOneNote>(_OneNote);\r\n\r\n\r\n/**\r\n * Describes a notebook instance\r\n *\r\n */\r\nexport class _Notebook extends _GraphQueryableInstance<INotebookType> {\r\n    public get sections(): ISections {\r\n        return Sections(this);\r\n    }\r\n}\r\nexport interface INotebook extends _Notebook {}\r\nexport const Notebook = graphInvokableFactory<INotebook>(_Notebook);\r\n\r\n/**\r\n * Describes a collection of Notebook objects\r\n *\r\n */\r\n@defaultPath(\"notebooks\")\r\n@getById(Notebook)\r\nexport class _Notebooks extends _GraphQueryableCollection<INotebookType[]> {\r\n    /**\r\n     * Create a new notebook as specified in the request body.\r\n     * \r\n     * @param displayName Notebook display name\r\n     */\r\n    public async add(displayName: string): Promise<INotebookAddResult> {\r\n\r\n        const data = await graphPost(this, body({ displayName }));\r\n\r\n        return {\r\n            data,\r\n            notebook: (<any>this).getById(data.id),\r\n        };\r\n    }\r\n}\r\nexport interface INotebooks extends _Notebooks, IGetById<INotebook> {}\r\nexport const Notebooks = graphInvokableFactory<INotebooks>(_Notebooks);\r\n\r\n\r\n/**\r\n * Describes a sections instance\r\n */\r\nexport class _Section extends _GraphQueryableInstance<ISectionType> { }\r\nexport interface ISection extends _Section { }\r\nexport const Section = graphInvokableFactory<ISection>(_Section);\r\n\r\n/**\r\n * Describes a collection of Sections objects\r\n *\r\n */\r\n@defaultPath(\"sections\")\r\n@getById(Section)\r\nexport class _Sections extends _GraphQueryableCollection<ISectionType[]> {\r\n    /**\r\n     * Adds a new section\r\n     * \r\n     * @param displayName New section display name\r\n     */\r\n    public async add(displayName: string): Promise<ISectionAddResult> {\r\n\r\n        const data = await graphPost(this, body({ displayName }));\r\n\r\n        return {\r\n            data,\r\n            section: (<any>this).getById(data.id),\r\n        };\r\n    }\r\n}\r\nexport interface ISections extends _Sections, IGetById<ISection> {}\r\nexport const Sections = graphInvokableFactory<ISections>(_Sections);\r\n\r\n/**\r\n * INotebookAddResult\r\n */\r\nexport interface INotebookAddResult {\r\n    data: any;\r\n    notebook: INotebook;\r\n}\r\n\r\n/**\r\n * ISectionAddResult\r\n */\r\nexport interface ISectionAddResult {\r\n    data: any;\r\n    section: ISection;\r\n}\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _User } from \"../users/types\";\r\nimport { IOneNote, OneNote } from \"./types\";\r\n\r\ndeclare module \"../users/types\" {\r\n    interface _User {\r\n        readonly onenote: IOneNote;\r\n    }\r\n    interface IUser {\r\n        readonly onenote: IOneNote;\r\n    }\r\n}\r\n\r\naddProp(_User, \"onenote\", OneNote);\r\n","import { _GraphQueryableInstance, graphInvokableFactory } from \"../graphqueryable\";\r\nimport { BlobParser, BufferParser } from \"@pnp/odata\";\r\nimport { Photo as IPhotoType } from \"@microsoft/microsoft-graph-types\";\r\nimport { defaultPath } from \"../decorators\";\r\nimport { graphPatch } from \"../operations\";\r\n\r\n@defaultPath(\"photo\")\r\nexport class _Photo extends _GraphQueryableInstance<IPhotoType> {\r\n    /**\r\n     * Gets the image bytes as a blob (browser)\r\n     */\r\n    public getBlob(): Promise<Blob> {\r\n        return this.clone(Photo, \"$value\", false).usingParser(new BlobParser())<Blob>();\r\n    }\r\n\r\n    /**\r\n     * Gets the image file bytes as a Buffer (node.js)\r\n     */\r\n    public getBuffer(): Promise<ArrayBuffer> {\r\n        return this.clone(Photo, \"$value\", false).usingParser(new BufferParser())<ArrayBuffer>();\r\n    }\r\n\r\n    /**\r\n     * Sets the file bytes\r\n     * \r\n     * @param content Image file contents, max 4 MB\r\n     */\r\n    public setContent(content: ArrayBuffer | Blob): Promise<void> {\r\n        return graphPatch(this.clone(Photo, \"$value\", false), { body: content });\r\n    }\r\n}\r\nexport interface IPhoto extends _Photo { }\r\nexport const Photo = graphInvokableFactory<IPhoto>(_Photo);\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _Group } from \"../groups/types\";\r\nimport { Photo, IPhoto } from \"./types\";\r\n\r\ndeclare module \"../groups/types\" {\r\n    interface _Group {\r\n        readonly photo: IPhoto;\r\n    }\r\n    interface IGroup {\r\n        readonly photo: IPhoto;\r\n    }\r\n}\r\n\r\naddProp(_Group, \"photo\", Photo);\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _User } from \"../users/types\";\r\nimport { Photo, IPhoto } from \"./types\";\r\n\r\ndeclare module \"../users/types\" {\r\n    interface _User {\r\n        readonly photo: IPhoto;\r\n    }\r\n    interface IUser {\r\n        readonly photo: IPhoto;\r\n    }\r\n}\r\n\r\naddProp(_User, \"photo\", Photo);\r\n","import { ITypedHash, assign } from \"@pnp/common\";\r\nimport {\r\n    PlannerPlan as IPlannerPlanType,\r\n    PlannerPlanDetails as IPlannerPlanDetailsType,\r\n    PlannerTask as IPlannerTaskType,\r\n    PlannerTaskDetails as IPlannerTaskDetailsType,\r\n    PlannerBucket as IPlannerBucketType,\r\n    Planner as IPlannerType,\r\n} from \"@microsoft/microsoft-graph-types\";\r\nimport { body } from \"@pnp/odata\";\r\nimport { _GraphQueryableInstance, _GraphQueryableCollection, graphInvokableFactory } from \"../graphqueryable\";\r\nimport { getById, IGetById, deleteableWithETag, IDeleteableWithETag, updateableWithETag, IUpdateableWithETag } from \"../decorators\";\r\nimport { graphPost } from \"../operations\";\r\nimport { defaultPath } from \"../decorators\";\r\n\r\n/**\r\n * Planner\r\n */\r\n@defaultPath(\"planner\")\r\nexport class _Planner extends _GraphQueryableInstance<IPlannerType> {\r\n\r\n    // Should Only be able to get by id, or else error occur\r\n    public get plans(): IPlans {\r\n        return Plans(this);\r\n    }\r\n\r\n    // Should Only be able to get by id, or else error occur\r\n    public get tasks(): ITasks {\r\n        return Tasks(this);\r\n    }\r\n\r\n    // Should Only be able to get by id, or else error occur\r\n    public get buckets(): IBuckets {\r\n        return Buckets(this);\r\n    }\r\n}\r\nexport interface IPlanner extends _Planner { }\r\nexport const Planner = graphInvokableFactory<IPlanner>(_Planner);\r\n\r\n/**\r\n * Details\r\n */\r\n@defaultPath(\"details\")\r\n@updateableWithETag()\r\nexport class _PlanDetails extends _GraphQueryableInstance<IPlannerPlanDetailsType> { }\r\nexport interface IPlanDetails extends _PlanDetails, IUpdateableWithETag<IPlannerPlanDetailsType> { }\r\nexport const PlanDetails = graphInvokableFactory<ITaskDetails>(_PlanDetails);\r\n\r\n/**\r\n * Plan\r\n */\r\n@updateableWithETag()\r\n@deleteableWithETag()\r\nexport class _Plan extends _GraphQueryableInstance<IPlannerPlanType> {\r\n\r\n    public get tasks(): ITasks {\r\n        return Tasks(this);\r\n    }\r\n\r\n    public get buckets(): IBuckets {\r\n        return Buckets(this);\r\n    }\r\n\r\n    public get details(): IPlanDetails {\r\n        return PlanDetails(this);\r\n    }\r\n}\r\nexport interface IPlan extends _Plan, IUpdateableWithETag<IPlannerPlanType>, IDeleteableWithETag { }\r\nexport const Plan = graphInvokableFactory<IPlan>(_Plan);\r\n\r\n@defaultPath(\"plans\")\r\n@getById(Plan)\r\nexport class _Plans extends _GraphQueryableCollection<IPlannerPlanType[]> {\r\n    /**\r\n     * Create a new Planner Plan.\r\n     * \r\n     * @param owner Id of Group object.\r\n     * @param title The Title of the Plan.\r\n     */\r\n    public async add(owner: string, title: string): Promise<IPlanAddResult> {\r\n\r\n        const data = await graphPost(this, body({ owner, title }));\r\n\r\n        return {\r\n            data,\r\n            plan: (<any>this).getById(data.id),\r\n        };\r\n    }\r\n}\r\nexport interface IPlans extends _Plans, IGetById<IPlan> { }\r\nexport const Plans = graphInvokableFactory<IPlans>(_Plans);\r\n\r\n/**\r\n * Details\r\n */\r\n@defaultPath(\"details\")\r\n@updateableWithETag()\r\nexport class _TaskDetails extends _GraphQueryableInstance<IPlannerTaskDetailsType> { }\r\nexport interface ITaskDetails extends _TaskDetails, IUpdateableWithETag<IPlannerTaskDetailsType> { }\r\nexport const TaskDetails = graphInvokableFactory<ITaskDetails>(_TaskDetails);\r\n\r\n/**\r\n * Task\r\n */\r\n@updateableWithETag()\r\n@deleteableWithETag()\r\nexport class _Task extends _GraphQueryableInstance<IPlannerTaskType> {\r\n    public get details(): ITaskDetails {\r\n        return TaskDetails(this);\r\n    }\r\n}\r\nexport interface ITask extends _Task, IUpdateableWithETag<IPlannerTaskType>, IDeleteableWithETag { }\r\nexport const Task = graphInvokableFactory<ITask>(_Task);\r\n\r\n/**\r\n * Tasks\r\n */\r\n@defaultPath(\"tasks\")\r\n@getById(Task)\r\nexport class _Tasks extends _GraphQueryableCollection<IPlannerTaskType[]> {\r\n    /**\r\n     * Create a new Planner Task.\r\n     * \r\n     * @param planId Id of Plan.\r\n     * @param title The Title of the Task.\r\n     * @param assignments Assign the task\r\n     * @param bucketId Id of Bucket\r\n     */\r\n    public async add(planId: string, title: string, assignments?: ITypedHash<any>, bucketId?: string): Promise<ITaskAddResult> {\r\n\r\n        let postBody = assign({\r\n            planId,\r\n            title,\r\n        }, assignments);\r\n\r\n        if (bucketId) {\r\n            postBody = assign(postBody, {\r\n                bucketId: bucketId,\r\n            });\r\n        }\r\n\r\n        const data = await graphPost(this, body(postBody));\r\n\r\n        return {\r\n            data,\r\n            task: (<any>this).getById(data.id),\r\n        };\r\n    }\r\n}\r\nexport interface ITasks extends _Tasks, IGetById<ITask> { }\r\nexport const Tasks = graphInvokableFactory<ITasks>(_Tasks);\r\n\r\n/**\r\n * Bucket\r\n */\r\n@updateableWithETag()\r\n@deleteableWithETag()\r\nexport class _Bucket extends _GraphQueryableInstance<IPlannerBucketType> {\r\n    public get tasks(): ITasks {\r\n        return Tasks(this);\r\n    }\r\n}\r\nexport interface IBucket extends _Bucket, IUpdateableWithETag<IPlannerBucketType>, IDeleteableWithETag { }\r\nexport const Bucket = graphInvokableFactory<IBucket>(_Bucket);\r\n\r\n\r\n/**\r\n * Buckets\r\n */\r\n@defaultPath(\"buckets\")\r\n@getById(Bucket)\r\nexport class _Buckets extends _GraphQueryableCollection<IPlannerBucketType[]> {\r\n    /**\r\n     * Create a new Bucket.\r\n     * \r\n     * @param name Name of Bucket object.\r\n     * @param planId The Id of the Plan.\r\n     * @param oderHint Hint used to order items of this type in a list view.\r\n     */\r\n    public async add(name: string, planId: string, orderHint?: string): Promise<IBucketAddResult> {\r\n\r\n        const postBody = {\r\n            name: name,\r\n            orderHint: orderHint ? orderHint : \"\",\r\n            planId: planId,\r\n        };\r\n\r\n        const data = await graphPost(this, body(postBody));\r\n\r\n        return {\r\n            bucket: (<any>this).getById(data.id),\r\n            data,\r\n        };\r\n    }\r\n}\r\nexport interface IBuckets extends _Buckets, IGetById<IBucket> { }\r\nexport const Buckets = graphInvokableFactory<IBuckets>(_Buckets);\r\n\r\nexport interface IBucketAddResult {\r\n    data: IPlannerBucketType;\r\n    bucket: IBucket;\r\n}\r\n\r\nexport interface IPlanAddResult {\r\n    data: IPlannerPlanType;\r\n    plan: IPlan;\r\n}\r\n\r\nexport interface ITaskAddResult {\r\n    data: IPlannerTaskType;\r\n    task: ITask;\r\n}\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _Group } from \"../groups/types\";\r\nimport { IPlans, Plans } from \"./types\";\r\n\r\ndeclare module \"../groups/types\" {\r\n    interface _Group {\r\n        readonly plans: IPlans;\r\n    }\r\n    interface IGroup {\r\n        readonly plans: IPlans;\r\n    }\r\n}\r\n\r\naddProp(_Group, \"plans\", Plans, \"planner/plans\");\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _User } from \"../users/types\";\r\nimport { ITasks, Tasks } from \"./types\";\r\n\r\ndeclare module \"../users/types\" {\r\n    interface _User {\r\n        readonly tasks: ITasks;\r\n    }\r\n    interface IUser {\r\n        readonly tasks: ITasks;\r\n    }\r\n}\r\n\r\naddProp(_User, \"tasks\", Tasks, \"planner/tasks\");\r\n","import { GraphRest } from \"../rest\";\r\nimport { IPlanner, Planner } from \"./types\";\r\n\r\nimport \"./groups\";\r\nimport \"./users\";\r\n\r\nexport {\r\n    Bucket,\r\n    Buckets,\r\n    IBucket,\r\n    IBucketAddResult,\r\n    IBuckets,\r\n    IPlan,\r\n    IPlanAddResult,\r\n    IPlanner,\r\n    IPlans,\r\n    ITask,\r\n    ITaskAddResult,\r\n    ITasks,\r\n    ITaskDetails,\r\n    Plan,\r\n    Planner,\r\n    Plans,\r\n    Task,\r\n    Tasks,\r\n    TaskDetails,\r\n    PlanDetails,\r\n} from \"./types\";\r\n\r\ndeclare module \"../rest\" {\r\n    interface GraphRest {\r\n        readonly planner: IPlanner;\r\n    }\r\n}\r\n\r\nReflect.defineProperty(GraphRest.prototype, \"planner\", {\r\n    configurable: true,\r\n    enumerable: true,\r\n    get: function (this: GraphRest) {\r\n        return Planner(this);\r\n    },\r\n});\r\n","import { _GraphQueryableInstance, _GraphQueryableCollection, graphInvokableFactory } from \"../graphqueryable\";\r\nimport { assign } from \"@pnp/common\";\r\nimport { body } from \"@pnp/odata\";\r\nimport { Subscription as ISubscriptionType } from \"@microsoft/microsoft-graph-types\";\r\nimport { defaultPath, deleteable, IDeleteable, IUpdateable, updateable, getById, IGetById } from \"../decorators\";\r\nimport { graphPost } from \"../operations\";\r\n\r\n/**\r\n * Subscription\r\n */\r\n@deleteable()\r\n@updateable()\r\nexport class _Subscription extends _GraphQueryableInstance<ISubscriptionType> { }\r\nexport interface ISubscription extends _Subscription, IDeleteable, IUpdateable<ISubscriptionType> { }\r\nexport const Subscription = graphInvokableFactory<ISubscription>(_Subscription);\r\n\r\n/**\r\n * Subscriptions\r\n */\r\n@defaultPath(\"subscriptions\")\r\n@getById(Subscription)\r\nexport class _Subscriptions extends _GraphQueryableCollection<ISubscriptionType[]> {\r\n    /**\r\n     * Create a new Subscription.\r\n     * \r\n     * @param changeType Indicates the type of change in the subscribed resource that will raise a notification. The supported values are: created, updated, deleted.\r\n     * @param notificationUrl The URL of the endpoint that will receive the notifications. This URL must make use of the HTTPS protocol.\r\n     * @param resource Specifies the resource that will be monitored for changes. Do not include the base URL (https://graph.microsoft.com/v1.0/).\r\n     * @param expirationDateTime Specifies the date and time when the webhook subscription expires. The time is in UTC.\r\n     * @param props A plain object collection of additional properties you want to set on the new subscription\r\n     * \r\n     */\r\n    public async add(changeType: string, notificationUrl: string, resource: string, expirationDateTime: string, props: ISubscriptionType = {}): Promise<ISubAddResult> {\r\n\r\n        const postBody = assign({\r\n            changeType,\r\n            expirationDateTime,\r\n            notificationUrl,\r\n            resource,\r\n        }, props);\r\n\r\n        const data = await graphPost(this, body(postBody));\r\n\r\n        return {\r\n            data,\r\n            subscription: (<any>this).getById(data.id),\r\n        };\r\n    }\r\n}\r\nexport interface ISubscriptions extends _Subscriptions, IGetById<ISubscription> {}\r\nexport const Subscriptions = graphInvokableFactory<ISubscriptions>(_Subscriptions);\r\n\r\n/**\r\n * ISubAddResult\r\n */\r\nexport interface ISubAddResult {\r\n    data: ISubscriptionType;\r\n    subscription: ISubscription;\r\n}\r\n","import { GraphRest } from \"../rest\";\r\nimport { Subscriptions, ISubscriptions } from \"./types\";\r\n\r\nexport {\r\n    ISubscription,\r\n    ISubAddResult,\r\n    ISubscriptions,\r\n    Subscription,\r\n    Subscriptions,\r\n} from \"./types\";\r\n\r\ndeclare module \"../rest\" {\r\n    interface GraphRest {\r\n        readonly subscriptions: ISubscriptions;\r\n    }\r\n}\r\n\r\nReflect.defineProperty(GraphRest.prototype, \"subscriptions\", {\r\n    configurable: true,\r\n    enumerable: true,\r\n    get: function (this: GraphRest) {\r\n        return Subscriptions(this);\r\n    },\r\n});\r\n","import { _GraphQueryableInstance, _GraphQueryableCollection, graphInvokableFactory } from \"../graphqueryable\";\r\nimport { body } from \"@pnp/odata\";\r\nimport { assign } from \"@pnp/common\";\r\nimport { updateable, IUpdateable, getById, IGetById, deleteable, IDeleteable } from \"../decorators\";\r\nimport { graphPost } from \"../operations\";\r\nimport { defaultPath } from \"../decorators\";\r\n\r\n/**\r\n * Represents a Microsoft Team\r\n */\r\n@defaultPath(\"team\")\r\n@updateable()\r\nexport class _Team extends _GraphQueryableInstance<ITeamProperties> {\r\n\r\n    public get channels(): IChannels {\r\n        return Channels(this);\r\n    }\r\n\r\n    /**\r\n     * Archives this Team\r\n     * \r\n     * @param shouldSetSpoSiteReadOnlyForMembers Should members have Read-only in associated Team Site\r\n     */\r\n    public archive(shouldSetSpoSiteReadOnlyForMembers = false): Promise<void> {\r\n        return graphPost(this.clone(Team, \"archive\"), body({ shouldSetSpoSiteReadOnlyForMembers }));\r\n    }\r\n\r\n    /**\r\n    * Unarchives this Team\r\n    */\r\n    public unarchive(): Promise<void> {\r\n        return graphPost(this.clone(Team, \"unarchive\"));\r\n    }\r\n\r\n    /**\r\n     * Clones this Team\r\n     * @param name The name of the new Group\r\n     * @param description Optional description of the group\r\n     * @param partsToClone Parts to clone ex: apps,tabs,settings,channels,members\r\n     * @param visibility Set visibility to public or private \r\n     */\r\n    public cloneTeam(name: string, description = \"\", partsToClone = \"apps,tabs,settings,channels,members\", visibility: \"public\" | \"private\" = \"private\"): Promise<void> {\r\n\r\n        const postBody = {\r\n            description: description ? description : \"\",\r\n            displayName: name,\r\n            mailNickname: name,\r\n            partsToClone,\r\n            visibility,\r\n        };\r\n\r\n        // TODO:: we need to get the Location header from the response and return an operation\r\n        // instance that folks can query to see if/when this is complete\r\n        // it could just have a single method getResult (or whatever) that returns a promise that\r\n        // resolves when the operation is successful or rejects when it is not\r\n        return graphPost(this.clone(Team, \"clone\"), body(postBody));\r\n    }\r\n}\r\nexport interface ITeam extends _Team, IUpdateable<ITeamProperties> { }\r\nexport const Team = graphInvokableFactory<ITeam>(_Team);\r\n\r\n/**\r\n * Teams\r\n */\r\n@defaultPath(\"teams\")\r\n@getById(Team)\r\nexport class _Teams extends _GraphQueryableCollection<ITeamProperties[]> { }\r\nexport interface ITeams extends _Teams, IGetById<ITeam> { }\r\nexport const Teams = graphInvokableFactory<ITeams>(_Teams);\r\n\r\n/**\r\n * Channel\r\n */\r\nexport class _Channel extends _GraphQueryableInstance {\r\n    public get tabs(): ITabs {\r\n        return Tabs(this);\r\n    }\r\n}\r\nexport interface IChannel extends _Channel { }\r\nexport const Channel = graphInvokableFactory<IChannel>(_Channel);\r\n\r\n/**\r\n * Channels\r\n */\r\n@defaultPath(\"channels\")\r\n@getById(Channel)\r\nexport class _Channels extends _GraphQueryableCollection {\r\n\r\n    /**\r\n     * Creates a new Channel in the Team\r\n     * @param displayName The display name of the new channel\r\n     * @param description Optional description of the channel\r\n     * \r\n     */\r\n    public async add(displayName: string, description = \"\"): Promise<IChannelCreateResult> {\r\n\r\n        const postBody = {\r\n            description,\r\n            displayName,\r\n        };\r\n\r\n        const data = await graphPost(this, body(postBody));\r\n\r\n        return {\r\n            channel: (<any>this).getById(data.id),\r\n            data,\r\n        };\r\n    }\r\n}\r\nexport interface IChannels extends _Channels, IGetById<IChannel> { }\r\nexport const Channels = graphInvokableFactory<IChannels>(_Channels);\r\n\r\n/**\r\n * Tab\r\n */\r\n@defaultPath(\"tab\")\r\n@updateable()\r\n@deleteable()\r\nexport class _Tab extends _GraphQueryableInstance { }\r\nexport interface ITab extends _Tab, IUpdateable, IDeleteable { }\r\nexport const Tab = graphInvokableFactory<ITab>(_Tab);\r\n\r\n/**\r\n * Tabs\r\n */\r\n@defaultPath(\"tabs\")\r\n@getById(Tab)\r\nexport class _Tabs extends _GraphQueryableCollection {\r\n\r\n    /**\r\n     * Adds a tab to the cahnnel\r\n     * @param name The name of the new Tab\r\n     * @param appUrl The url to an app ex: https://graph.microsoft.com/beta/appCatalogs/teamsApps/12345678-9abc-def0-123456789a\r\n     * @param tabsConfiguration visit https://developer.microsoft.com/en-us/graph/docs/api-reference/v1.0/api/teamstab_add for reference\r\n     */\r\n    public async add(name: string, appUrl: string, properties: ITabsConfiguration): Promise<ITabCreateResult> {\r\n\r\n        const postBody = assign({\r\n            displayName: name,\r\n            \"teamsApp@odata.bind\": appUrl,\r\n        }, properties);\r\n\r\n        const data = await graphPost(this, body(postBody));\r\n\r\n        return {\r\n            data,\r\n            tab: (<any>this).getById(data.id),\r\n        };\r\n    }\r\n}\r\nexport interface ITabs extends _Tabs, IGetById<ITab> { }\r\nexport const Tabs = graphInvokableFactory<ITabs>(_Tabs);\r\n\r\nexport interface ITeamUpdateResult {\r\n    data: any;\r\n    team: ITeam;\r\n}\r\n\r\nexport interface IChannelCreateResult {\r\n    data: any;\r\n    channel: IChannel;\r\n}\r\n\r\nexport interface ITabCreateResult {\r\n    data: any;\r\n    tab: ITab;\r\n}\r\n\r\nexport interface ITabUpdateResult {\r\n    data: any;\r\n    tab: ITab;\r\n}\r\n\r\n/**\r\n * Defines the properties for a Team\r\n * \r\n * TODO:: remove this once typings are present in graph types package\r\n */\r\nexport interface ITeamProperties {\r\n\r\n    memberSettings?: {\r\n        \"allowCreateUpdateChannels\"?: boolean;\r\n        \"allowDeleteChannels\"?: boolean;\r\n        \"allowAddRemoveApps\"?: boolean;\r\n        \"allowCreateUpdateRemoveTabs\"?: boolean;\r\n        \"allowCreateUpdateRemoveConnectors\"?: boolean;\r\n    };\r\n\r\n    guestSettings?: {\r\n        \"allowCreateUpdateChannels\"?: boolean;\r\n        \"allowDeleteChannels\"?: boolean;\r\n    };\r\n\r\n    messagingSettings?: {\r\n        \"allowUserEditMessages\"?: boolean;\r\n        \"allowUserDeleteMessages\"?: boolean;\r\n        \"allowOwnerDeleteMessages\"?: boolean;\r\n        \"allowTeamMentions\"?: boolean;\r\n        \"allowChannelMentions\"?: boolean;\r\n    };\r\n\r\n    funSettings?: {\r\n        \"allowGiphy\"?: boolean;\r\n        \"giphyContentRating\"?: \"strict\" | string,\r\n        \"allowStickersAndMemes\"?: boolean;\r\n        \"allowCustomMemes\"?: boolean;\r\n    };\r\n}\r\n\r\nexport interface ITabsConfiguration {\r\n    configuration: {\r\n        \"entityId\": string;\r\n        \"contentUrl\": string;\r\n        \"websiteUrl\": string;\r\n        \"removeUrl\": string;\r\n    };\r\n}\r\n\r\nexport interface ITeamCreateResult {\r\n    data: any;\r\n    team: ITeam;\r\n}\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _User } from \"../users/types\";\r\nimport { ITeams, Teams } from \"./types\";\r\n\r\ndeclare module \"../users/types\" {\r\n    interface _User {\r\n        readonly joinedTeams: ITeams;\r\n    }\r\n    interface IUser {\r\n        readonly joinedTeams: ITeams;\r\n    }\r\n}\r\n\r\naddProp(_User, \"joinedTeams\", Teams, \"joinedTeams\");\r\n","import { addProp, body } from \"@pnp/odata\";\r\nimport { GraphRest } from \"../rest\";\r\nimport { _Group, Group } from \"../groups/types\";\r\nimport { ITeamCreateResult, ITeamProperties, ITeam, Team, ITeams, Teams } from \"./types\";\r\nimport { graphPut } from \"../operations\";\r\n\r\nimport \"./users\";\r\n\r\nexport {\r\n    Channel,\r\n    Channels,\r\n    IChannel,\r\n    IChannelCreateResult,\r\n    IChannels,\r\n    ITab,\r\n    ITabCreateResult,\r\n    ITabUpdateResult,\r\n    ITabs,\r\n    ITabsConfiguration,\r\n    ITeam,\r\n    ITeamCreateResult,\r\n    ITeamProperties,\r\n    ITeamUpdateResult,\r\n    ITeams,\r\n    Tab,\r\n    Tabs,\r\n    Team,\r\n    Teams,\r\n} from \"./types\";\r\n\r\ndeclare module \"../groups/types\" {\r\n    interface _Group {\r\n        readonly team: ITeam;\r\n        createTeam(properties: ITeamProperties): Promise<ITeamCreateResult>;\r\n    }\r\n    interface IGroup {\r\n        readonly team: ITeam;\r\n        createTeam(properties: ITeamProperties): Promise<ITeamCreateResult>;\r\n    }\r\n}\r\n\r\naddProp(_Group, \"team\", Team);\r\n\r\n_Group.prototype.createTeam = async function (this: _Group, props: ITeamProperties): Promise<ITeamCreateResult> {\r\n\r\n    const data = await graphPut(this.clone(Group, \"team\"), body(props));\r\n\r\n    return {\r\n        data,\r\n        team: this.team,\r\n    };\r\n};\r\n\r\ndeclare module \"../rest\" {\r\n    interface GraphRest {\r\n        readonly teams: ITeams;\r\n    }\r\n}\r\n\r\nReflect.defineProperty(GraphRest.prototype, \"teams\", {\r\n    configurable: true,\r\n    enumerable: true,\r\n    get: function (this: GraphRest) {\r\n        return Teams(this);\r\n    },\r\n});\r\n","import { GraphRest } from \"../rest\";\r\nimport { IUser, User, IUsers, Users } from \"./types\";\r\n\r\nexport {\r\n    IUser,\r\n    IUsers,\r\n    User,\r\n    Users,\r\n    IPeople,\r\n    People,\r\n} from \"./types\";\r\n\r\ndeclare module \"../rest\" {\r\n    interface GraphRest {\r\n        readonly me: IUser;\r\n        readonly users: IUsers;\r\n    }\r\n}\r\n\r\nReflect.defineProperty(GraphRest.prototype, \"me\", {\r\n    configurable: true,\r\n    enumerable: true,\r\n    get: function (this: GraphRest) {\r\n        return User(this, \"me\");\r\n    },\r\n});\r\n\r\nReflect.defineProperty(GraphRest.prototype, \"users\", {\r\n    configurable: true,\r\n    enumerable: true,\r\n    get: function (this: GraphRest) {\r\n        return Users(this);\r\n    },\r\n});\r\n","import { assign, objectDefinedNotNull } from \"./util\";\r\nimport { ISPFXContext } from \"./spfxcontextinterface\";\r\nimport { safeGlobal } from \"./safe-global\";\r\n\r\nexport interface IConfigOptions {\r\n    headers?: string[][] | { [key: string]: string } | Headers;\r\n    mode?: \"navigate\" | \"same-origin\" | \"no-cors\" | \"cors\";\r\n    credentials?: \"omit\" | \"same-origin\" | \"include\";\r\n    cache?: \"default\" | \"no-store\" | \"reload\" | \"no-cache\" | \"force-cache\" | \"only-if-cached\";\r\n}\r\n\r\nexport interface IFetchOptions extends IConfigOptions {\r\n    method?: string;\r\n    body?: any;\r\n}\r\n\r\nexport interface IHttpClientImpl {\r\n    fetch(url: string, options: IFetchOptions): Promise<Response>;\r\n}\r\n\r\nexport interface IRequestClient {\r\n    fetch(url: string, options?: IFetchOptions): Promise<Response>;\r\n    fetchRaw(url: string, options?: IFetchOptions): Promise<Response>;\r\n    get(url: string, options?: IFetchOptions): Promise<Response>;\r\n    post(url: string, options?: IFetchOptions): Promise<Response>;\r\n    patch(url: string, options?: IFetchOptions): Promise<Response>;\r\n    delete(url: string, options?: IFetchOptions): Promise<Response>;\r\n}\r\n\r\nexport function mergeHeaders(target: Headers, source: HeadersInit): void {\r\n\r\n    if (objectDefinedNotNull(source)) {\r\n        const temp = new Request(\"\", { headers: source });\r\n        temp.headers.forEach((value: string, name: string) => {\r\n            target.append(name, value);\r\n        });\r\n    }\r\n}\r\n\r\nexport function mergeOptions(target: IConfigOptions, source: IConfigOptions): void {\r\n\r\n    if (objectDefinedNotNull(source)) {\r\n        const headers = assign(target.headers || {}, source.headers!);\r\n        target = assign(target, source);\r\n        target.headers = headers;\r\n    }\r\n}\r\n\r\n/**\r\n * Parses out the root of the request url to use as the resource when getting the token\r\n * \r\n  * @param url The url to parse\r\n */\r\nexport function getADALResource(url: string): string {\r\n    const u = new URL(url);\r\n    return `${u.protocol}//${u.hostname}`;\r\n}\r\n\r\n/**\r\n * Makes requests using the global/window fetch API\r\n */\r\nexport class FetchClient implements IHttpClientImpl {\r\n\r\n    public fetch(url: string, options: IFetchOptions): Promise<Response> {\r\n\r\n        return safeGlobal.fetch(url, options);\r\n    }\r\n}\r\n\r\n/**\r\n * Makes requests using the fetch API adding the supplied token to the Authorization header\r\n */\r\nexport class BearerTokenFetchClient extends FetchClient {\r\n\r\n    constructor(private _token: string | null) {\r\n        super();\r\n    }\r\n\r\n    public get token() {\r\n        return this._token || \"\";\r\n    }\r\n\r\n    public set token(token: string) {\r\n        this._token = token;\r\n    }\r\n\r\n    public fetch(url: string, options: IFetchOptions = {}): Promise<Response> {\r\n\r\n        const headers = new Headers();\r\n\r\n        mergeHeaders(headers, options.headers);\r\n\r\n        headers.set(\"Authorization\", `Bearer ${this._token}`);\r\n\r\n        options.headers = headers;\r\n\r\n        return super.fetch(url, options);\r\n    }\r\n}\r\n\r\n/**\r\n * Client wrapping the aadTokenProvider available from SPFx >= 1.6\r\n */\r\nexport class SPFxAdalClient extends BearerTokenFetchClient {\r\n\r\n    /**\r\n     * \r\n     * @param context provide the appropriate SPFx Context object\r\n     */\r\n    constructor(private context: ISPFXContext) {\r\n        super(null);\r\n    }\r\n\r\n    /**\r\n     * Executes a fetch request using the supplied url and options\r\n     * \r\n     * @param url Absolute url of the request\r\n     * @param options Any options\r\n     */\r\n    public async fetch(url: string, options: IFetchOptions): Promise<Response> {\r\n\r\n        const token = await this.getToken(getADALResource(url));\r\n        this.token = token;\r\n        return super.fetch(url, options);\r\n    }\r\n\r\n    /**\r\n     * Gets an AAD token for the provided resource using the SPFx AADTokenProvider\r\n     * \r\n     * @param resource Resource for which a token is to be requested (ex: https://graph.microsoft.com)\r\n     */\r\n    public async getToken(resource: string): Promise<string> {\r\n\r\n        const provider = await this.context.aadTokenProviderFactory.getTokenProvider();\r\n        return provider.getToken(resource);\r\n    }\r\n}\r\n","import { dateAdd, getCtxCallback, jsS, objectDefinedNotNull } from \"./util\";\r\nimport { RuntimeConfig } from \"./libconfig\";\r\n\r\n/**\r\n * A wrapper class to provide a consistent interface to browser based storage\r\n *\r\n */\r\nexport class PnPClientStorageWrapper implements IPnPClientStore {\r\n\r\n    /**\r\n     * True if the wrapped storage is available; otherwise, false\r\n     */\r\n    public enabled: boolean;\r\n\r\n    /**\r\n     * Creates a new instance of the PnPClientStorageWrapper class\r\n     *\r\n     * @constructor\r\n     */\r\n    constructor(private store: Storage, public defaultTimeoutMinutes = -1) {\r\n\r\n        this.enabled = this.test();\r\n\r\n        // if the cache timeout is enabled call the handler\r\n        // this will clear any expired items and set the timeout function\r\n        if (RuntimeConfig.enableCacheExpiration) {\r\n            this.cacheExpirationHandler();\r\n        }\r\n    }\r\n\r\n    public static bind(store: Storage): IPnPClientStore {\r\n        return new PnPClientStorageWrapper(typeof (store) === \"undefined\" ? new MemoryStorage() : store);\r\n    }\r\n\r\n    /**\r\n     * Get a value from storage, or null if that value does not exist\r\n     *\r\n     * @param key The key whose value we want to retrieve\r\n     */\r\n    public get<T>(key: string): T | null {\r\n\r\n        if (!this.enabled) {\r\n            return null;\r\n        }\r\n\r\n        const o = this.store.getItem(key);\r\n\r\n        if (!objectDefinedNotNull(o)) {\r\n            return null;\r\n        }\r\n\r\n        const persistable = JSON.parse(o);\r\n\r\n        if (new Date(persistable.expiration) <= new Date()) {\r\n            this.delete(key);\r\n            return null;\r\n\r\n        } else {\r\n\r\n            return persistable.value as T;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Adds a value to the underlying storage\r\n     *\r\n     * @param key The key to use when storing the provided value\r\n     * @param o The value to store\r\n     * @param expire Optional, if provided the expiration of the item, otherwise the default is used\r\n     */\r\n    public put(key: string, o: any, expire?: Date): void {\r\n        if (this.enabled) {\r\n            this.store.setItem(key, this.createPersistable(o, expire));\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Deletes a value from the underlying storage\r\n     *\r\n     * @param key The key of the pair we want to remove from storage\r\n     */\r\n    public delete(key: string): void {\r\n        if (this.enabled) {\r\n            this.store.removeItem(key);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets an item from the underlying storage, or adds it if it does not exist using the supplied getter function\r\n     *\r\n     * @param key The key to use when storing the provided value\r\n     * @param getter A function which will upon execution provide the desired value\r\n     * @param expire Optional, if provided the expiration of the item, otherwise the default is used\r\n     */\r\n    public async getOrPut<T>(key: string, getter: () => Promise<T>, expire?: Date): Promise<T> {\r\n\r\n        if (!this.enabled) {\r\n            return getter();\r\n        }\r\n\r\n        let o = this.get<T>(key);\r\n\r\n        if (o === null) {\r\n            o = await getter();\r\n            this.put(key, o, expire);\r\n        }\r\n\r\n        return o;\r\n    }\r\n\r\n    /**\r\n     * Deletes any expired items placed in the store by the pnp library, leaves other items untouched\r\n     */\r\n    public async deleteExpired(): Promise<void> {\r\n\r\n        if (!this.enabled) {\r\n            return;\r\n        }\r\n\r\n        for (let i = 0; i < this.store.length; i++) {\r\n            const key = this.store.key(i);\r\n            if (key !== null) {\r\n                // test the stored item to see if we stored it\r\n                if (/[\"|']?pnp[\"|']? ?: ?1/i.test(<string>this.store.getItem(key))) {\r\n                    // get those items as get will delete from cache if they are expired\r\n                    await this.get(key);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Used to determine if the wrapped storage is available currently\r\n     */\r\n    private test(): boolean {\r\n        const str = \"t\";\r\n        try {\r\n            this.store.setItem(str, str);\r\n            this.store.removeItem(str);\r\n            return true;\r\n        } catch (e) {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Creates the persistable to store\r\n     */\r\n    private createPersistable(o: any, expire?: Date): string {\r\n        if (expire === undefined) {\r\n\r\n            // ensure we are by default inline with the global library setting\r\n            let defaultTimeout = RuntimeConfig.defaultCachingTimeoutSeconds;\r\n            if (this.defaultTimeoutMinutes > 0) {\r\n                defaultTimeout = this.defaultTimeoutMinutes * 60;\r\n            }\r\n            expire = dateAdd(new Date(), \"second\", defaultTimeout);\r\n        }\r\n\r\n        return jsS({ pnp: 1, expiration: expire, value: o });\r\n    }\r\n\r\n    /**\r\n     * Deletes expired items added by this library in this.store and sets a timeout to call itself\r\n     */\r\n    private cacheExpirationHandler(): void {\r\n\r\n        if (!this.enabled) {\r\n            return;\r\n        }\r\n\r\n        this.deleteExpired().then(_ => {\r\n\r\n            // call ourself in the future\r\n            setTimeout(getCtxCallback(this, this.cacheExpirationHandler), RuntimeConfig.cacheExpirationIntervalMilliseconds);\r\n        }).catch(console.error);\r\n    }\r\n}\r\n\r\n/**\r\n * Interface which defines the operations provided by a client storage object\r\n */\r\nexport interface IPnPClientStore {\r\n    /**\r\n     * True if the wrapped storage is available; otherwise, false\r\n     */\r\n    enabled: boolean;\r\n\r\n    /**\r\n     * Get a value from storage, or null if that value does not exist\r\n     *\r\n     * @param key The key whose value we want to retrieve\r\n     */\r\n    get(key: string): any;\r\n\r\n    /**\r\n     * Adds a value to the underlying storage\r\n     *\r\n     * @param key The key to use when storing the provided value\r\n     * @param o The value to store\r\n     * @param expire Optional, if provided the expiration of the item, otherwise the default is used\r\n     */\r\n    put(key: string, o: any, expire?: Date): void;\r\n\r\n    /**\r\n     * Deletes a value from the underlying storage\r\n     *\r\n     * @param key The key of the pair we want to remove from storage\r\n     */\r\n    delete(key: string): void;\r\n\r\n    /**\r\n     * Gets an item from the underlying storage, or adds it if it does not exist using the supplied getter function\r\n     *\r\n     * @param key The key to use when storing the provided value\r\n     * @param getter A function which will upon execution provide the desired value\r\n     * @param expire Optional, if provided the expiration of the item, otherwise the default is used\r\n     */\r\n    getOrPut<T>(key: string, getter: () => Promise<T>, expire?: Date): Promise<T>;\r\n\r\n    /**\r\n     * Removes any expired items placed in the store by the pnp library, leaves other items untouched\r\n     */\r\n    deleteExpired(): Promise<void>;\r\n}\r\n\r\n/**\r\n * A thin implementation of in-memory storage for use in nodejs\r\n */\r\nclass MemoryStorage {\r\n\r\n    constructor(private _store = new Map<string, any>()) { }\r\n\r\n    public get length(): number {\r\n        return this._store.size;\r\n    }\r\n\r\n    public clear(): void {\r\n        this._store.clear();\r\n    }\r\n\r\n    public getItem(key: string): any {\r\n        return this._store.get(key);\r\n    }\r\n\r\n    public key(index: number): string {\r\n        return Array.from(this._store)[index][0];\r\n    }\r\n\r\n    public removeItem(key: string): void {\r\n        this._store.delete(key);\r\n    }\r\n\r\n    public setItem(key: string, data: string): void {\r\n        this._store.set(key, data);\r\n    }\r\n\r\n    [key: string]: any;\r\n    [index: number]: string;\r\n}\r\n\r\n/**\r\n * A class that will establish wrappers for both local and session storage\r\n */\r\nexport class PnPClientStorage {\r\n\r\n    /**\r\n     * Creates a new instance of the PnPClientStorage class\r\n     *\r\n     * @constructor\r\n     */\r\n    constructor(private _local: IPnPClientStore | null = null, private _session: IPnPClientStore | null = null) { }\r\n\r\n    /**\r\n     * Provides access to the local storage of the browser\r\n     */\r\n    public get local(): IPnPClientStore {\r\n\r\n        if (this._local === null) {\r\n            this._local = new PnPClientStorageWrapper(typeof (localStorage) === \"undefined\" ? new MemoryStorage() : localStorage);\r\n        }\r\n\r\n        return this._local;\r\n    }\r\n\r\n    /**\r\n     * Provides access to the session storage of the browser\r\n     */\r\n    public get session(): IPnPClientStore {\r\n\r\n        if (this._session === null) {\r\n            this._session = new PnPClientStorageWrapper(typeof (sessionStorage) === \"undefined\" ? new MemoryStorage() : sessionStorage);\r\n        }\r\n\r\n        return this._session;\r\n    }\r\n}\r\n","import { addProp } from \"@pnp/odata\";\r\nimport { _List } from \"../lists/types\";\r\nimport { Items, IItems } from \"./types\";\r\n\r\ndeclare module \"../lists/types\" {\r\n    interface _List {\r\n        readonly items: IItems;\r\n    }\r\n    interface IList {\r\n        readonly items: IItems;\r\n    }\r\n}\r\n\r\naddProp(_List, \"items\", Items);\r\n","import * as SPNS from \"@pnp/sp/presets/all\";\r\n\r\nexport {\r\n    SPNS,\r\n};\r\n","import * as GraphNS from \"@pnp/graph/presets/all\";\r\n\r\nexport {\r\n    GraphNS,\r\n};\r\n","import { ILibraryConfiguration, RuntimeConfig } from \"@pnp/common\";\r\nimport { ISPConfigurationPart } from \"@pnp/sp\";\r\n\r\nexport interface PnPConfiguration extends ILibraryConfiguration, ISPConfigurationPart { }\r\n\r\nexport function setup(config: PnPConfiguration): void {\r\n    RuntimeConfig.assign(config);\r\n}\r\n","import { assign, IHttpClientImpl } from \"@pnp/common\";\r\n\r\n/**\r\n * Makes requests using the SP.RequestExecutor library.\r\n */\r\nexport class SPRequestExecutorClient implements IHttpClientImpl {\r\n    /**\r\n     * Fetches a URL using the SP.RequestExecutor library.\r\n     */\r\n    public fetch(url: string, options: any): Promise<Response> {\r\n        if (SP === undefined || SP.RequestExecutor === undefined) {\r\n            throw Error(\"SP.RequestExecutor is undefined. Load the SP.RequestExecutor.js library (/_layouts/15/SP.RequestExecutor.js) before loading the PnP JS Core library.\");\r\n        }\r\n\r\n        const addinWebUrl = url.substring(0, url.indexOf(\"/_api\")),\r\n            executor = new SP.RequestExecutor(addinWebUrl);\r\n\r\n        let headers: { [key: string]: string; } = {},\r\n            iterator: IterableIterator<[string, string]>,\r\n            temp: IteratorResult<[string, string]>;\r\n\r\n        if (options.headers && options.headers instanceof Headers) {\r\n            iterator = <IterableIterator<[string, string]>>options.headers.entries();\r\n            temp = iterator.next();\r\n            while (!temp.done) {\r\n                headers[temp.value[0]] = temp.value[1];\r\n                temp = iterator.next();\r\n            }\r\n        } else {\r\n            headers = <any>options.headers;\r\n        }\r\n\r\n        return new Promise((resolve, reject) => {\r\n\r\n            let requestOptions = {\r\n                error: (error: SP.ResponseInfo) => {\r\n                    reject(this.convertToResponse(error));\r\n                },\r\n                headers: headers,\r\n                method: options.method,\r\n                success: (response: SP.ResponseInfo) => {\r\n                    resolve(this.convertToResponse(response));\r\n                },\r\n                url: url,\r\n            };\r\n\r\n            if (options.body) {\r\n                requestOptions = assign(requestOptions, { body: options.body });\r\n            } else {\r\n                requestOptions = assign(requestOptions, { binaryStringRequestBody: true });\r\n            }\r\n            executor.executeAsync(requestOptions);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Converts a SharePoint REST API response to a fetch API response.\r\n     */\r\n    private convertToResponse = (spResponse: SP.ResponseInfo): Response => {\r\n        const responseHeaders = new Headers();\r\n\r\n        if (spResponse.headers !== undefined) {\r\n            for (const h in spResponse.headers) {\r\n                if (spResponse.headers[h]) {\r\n                    responseHeaders.append(h, spResponse.headers[h]);\r\n                }\r\n            }\r\n        }\r\n\r\n        // Cannot have an empty string body when creating a Response with status 204\r\n        const body = spResponse.statusCode === 204 ? null : spResponse.body;\r\n\r\n        return new Response(body, {\r\n            headers: responseHeaders,\r\n            status: spResponse.statusCode,\r\n            statusText: spResponse.statusText,\r\n        });\r\n    }\r\n}\r\n","import {\r\n    SPRest,\r\n} from \"@pnp/sp\";\r\n\r\nimport { Web, IWeb } from \"@pnp/sp/webs\";\r\nimport { Site, ISite } from \"@pnp/sp/sites\";\r\n\r\nimport {\r\n    isUrlAbsolute,\r\n    combine,\r\n} from \"@pnp/common\";\r\n\r\nimport { ISharePointQueryable } from \"@pnp/sp\";\r\n\r\nexport class SPRestAddIn extends SPRest {\r\n\r\n    /**\r\n     * Begins a cross-domain, host site scoped REST request, for use in add-in webs\r\n     *\r\n     * @param addInWebUrl The absolute url of the add-in web\r\n     * @param hostWebUrl The absolute url of the host web\r\n     */\r\n    public crossDomainSite(addInWebUrl: string, hostWebUrl: string): ISite {\r\n        return this._cdImpl(Site, addInWebUrl, hostWebUrl, \"site\");\r\n    }\r\n\r\n    /**\r\n     * Begins a cross-domain, host web scoped REST request, for use in add-in webs\r\n     *\r\n     * @param addInWebUrl The absolute url of the add-in web\r\n     * @param hostWebUrl The absolute url of the host web\r\n     */\r\n    public crossDomainWeb(addInWebUrl: string, hostWebUrl: string): IWeb {\r\n        return this._cdImpl(Web, addInWebUrl, hostWebUrl, \"web\");\r\n    }\r\n\r\n    /**\r\n     * Implements the creation of cross domain REST urls\r\n     *\r\n     * @param factory The constructor of the object to create Site | Web\r\n     * @param addInWebUrl The absolute url of the add-in web\r\n     * @param hostWebUrl The absolute url of the host web\r\n     * @param urlPart String part to append to the url \"site\" | \"web\"\r\n     */\r\n    private _cdImpl<T extends ISharePointQueryable>(\r\n        factory: (...args: any[]) => T,\r\n        addInWebUrl: string,\r\n        hostWebUrl: string,\r\n        urlPart: string): T {\r\n\r\n        if (!isUrlAbsolute(addInWebUrl)) {\r\n            throw Error(\"The addInWebUrl parameter must be an absolute url.\");\r\n        }\r\n\r\n        if (!isUrlAbsolute(hostWebUrl)) {\r\n            throw Error(\"The hostWebUrl parameter must be an absolute url.\");\r\n        }\r\n\r\n        const url = combine(addInWebUrl, \"_api/SP.AppContextSite(@target)\");\r\n\r\n        const instance = factory(url, urlPart);\r\n        instance.query.set(\"@target\", \"'\" + encodeURIComponent(hostWebUrl) + \"'\");\r\n        return instance.configure(this._options);\r\n    }\r\n}\r\n\r\nexport const sp = new SPRestAddIn();\r\n","import { Logger } from \"@pnp/logging\";\r\nimport {\r\n    PnPClientStorage,\r\n    dateAdd,\r\n    combine,\r\n    getCtxCallback,\r\n    getRandomString,\r\n    getGUID,\r\n    isFunc,\r\n    objectDefinedNotNull,\r\n    isArray,\r\n    assign,\r\n    isUrlAbsolute,\r\n    stringIsNullOrEmpty,\r\n    sanitizeGuid,\r\n} from \"@pnp/common\";\r\nimport { Settings } from \"@pnp/config-store\";\r\nimport { sp as _sp, SPRestAddIn } from \"@pnp/sp-addinhelpers\";\r\nimport { setup as _setup, PnPConfiguration } from \"./pnplibconfig\";\r\nimport { graph as _graph } from \"@pnp/graph\";\r\n\r\n// trigger attachment of all functionality to mimic the previous pnpjs impl\r\nimport \"@pnp/sp/presets/all\";\r\nimport \"@pnp/graph/presets/all\";\r\n\r\n/**\r\n * Re-export everything from the dependencies to match the previous pattern\r\n */\r\nexport * from \"@pnp/common\";\r\nexport * from \"@pnp/logging\";\r\nexport * from \"@pnp/config-store\";\r\nexport * from \"@pnp/odata\";\r\nexport * from \"./sp-ns\";\r\nexport * from \"./graph-ns\";\r\n\r\n/**\r\n * Utility methods\r\n */\r\nexport const util = {\r\n    assign,\r\n    combine,\r\n    dateAdd,\r\n    getCtxCallback,\r\n    getGUID,\r\n    getRandomString,\r\n    isArray,\r\n    isFunc,\r\n    isUrlAbsolute,\r\n    objectDefinedNotNull,\r\n    sanitizeGuid,\r\n    stringIsNullOrEmpty,\r\n};\r\n\r\n/**\r\n * Provides access to the SharePoint REST interface\r\n */\r\nexport const sp = <SPRestAddIn>_sp;\r\n\r\n/**\r\n * Provides access to the SharePoint REST interface\r\n */\r\nexport const graph = _graph;\r\n\r\n/**\r\n * Provides access to local and session storage\r\n */\r\nexport const storage: PnPClientStorage = new PnPClientStorage();\r\n\r\n/**\r\n * Global configuration instance to which providers can be added\r\n */\r\nexport const config = new Settings();\r\n\r\n/**\r\n * Global logging instance to which subscribers can be registered and messages written\r\n */\r\nexport const log = Logger;\r\n\r\n/**\r\n * Allows for the configuration of the library\r\n */\r\nexport const setup: (config: PnPConfiguration) => void = _setup;\r\n\r\n// creating this class instead of directly assigning to default fixes a previous issue\r\nconst Def = {\r\n    /**\r\n     * Global configuration instance to which providers can be added\r\n     */\r\n    config,\r\n    /**\r\n     * Provides access to the Graph REST interface\r\n     */\r\n    graph,\r\n    /**\r\n     * Global logging instance to which subscribers can be registered and messages written\r\n     */\r\n    log,\r\n    /**\r\n     * Provides access global setup method\r\n     */\r\n    setup,\r\n    /**\r\n     * Provides access to the SharePoint REST interface\r\n     */\r\n    sp,\r\n    /**\r\n     * Provides access to local and session storage\r\n     */\r\n    storage,\r\n    /**\r\n     * Utility methods\r\n     */\r\n    util,\r\n};\r\n\r\n/**\r\n * Enables use of the import pnp from syntax\r\n */\r\nexport default Def;\r\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n"],"sourceRoot":""}