/*! For license information please see pnp.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.pnp=t():e.pnp=t()}(self,(function(){return(()=>{"use strict";var e={132:(e,t,r)=>{r.r(t),r.d(t,{Batch:()=>z,BearerTokenFetchClient:()=>M,BlobParser:()=>pe,BufferParser:()=>ye,CachingConfigurationProvider:()=>G,CachingOptions:()=>K,CachingParserWrapper:()=>Q,ConsoleListener:()=>l,DefaultRuntime:()=>B,FetchClient:()=>N,FunctionListener:()=>c,GraphNS:()=>s,HttpRequestError:()=>me,JSONParser:()=>ge,LambdaParser:()=>fe,LogLevel:()=>i,Logger:()=>o,ODataParser:()=>de,PipelineMethods:()=>we,PnPClientStorage:()=>H,PnPClientStorageWrapper:()=>j,Queryable:()=>be,Runtime:()=>L,SPFxAdalClient:()=>q,SPListConfigurationProvider:()=>kt,SPNS:()=>n,Settings:()=>V,TextParser:()=>he,addProp:()=>X,assign:()=>v,body:()=>Re,clearGlobalExtensions:()=>se,cloneQueryableData:()=>ve,combine:()=>h,config:()=>kl,dateAdd:()=>d,default:()=>El,defaultPipelineBinder:()=>Ue,disableExtensions:()=>oe,enableExtensions:()=>ae,extendFactory:()=>ne,extendGlobal:()=>te,extendObj:()=>re,getADALResource:()=>E,getCtxCallback:()=>u,getDefaultPipeline:()=>Ce,getGUID:()=>g,getHashCode:()=>w,getRandomString:()=>p,graph:()=>$l,hOP:()=>T,headers:()=>De,invokableFactory:()=>ce,isArray:()=>m,isFunc:()=>y,isUrlAbsolute:()=>b,jsS:()=>I,log:()=>_l,mergeHeaders:()=>_,mergeMaps:()=>U,mergeOptions:()=>O,objectDefinedNotNull:()=>f,objectToMap:()=>x,onRuntimeCreate:()=>F,pipe:()=>Ie,pipelineBinder:()=>xe,requestPipelineMethod:()=>Te,safeGlobal:()=>k,sanitizeGuid:()=>P,setResult:()=>Se,setup:()=>Ol,sp:()=>Bl,storage:()=>Al,stringIsNullOrEmpty:()=>S,util:()=>Ll});var n={};r.r(n),r.d(n,{AddFieldOptions:()=>Sn,App:()=>Ur,AppCatalog:()=>Cr,Attachment:()=>Lr,Attachments:()=>Dr,CalendarType:()=>Pn,CanvasColumn:()=>zr,CanvasSection:()=>Gr,CheckinType:()=>Ir,Children:()=>Os,ChoiceFieldFormatType:()=>wn,ClientsidePageFromFile:()=>Hr,ClientsideText:()=>Qr,ClientsideWebpart:()=>Xr,ColumnControl:()=>Kr,Comment:()=>Or,Comments:()=>kr,ContentType:()=>sn,ContentTypes:()=>rn,ControlMode:()=>wt,CreateClientsidePage:()=>Vr,DateTimeFieldFormatType:()=>vn,DateTimeFieldFriendlyFormatType:()=>bn,Feature:()=>hn,Features:()=>un,Field:()=>fn,FieldLink:()=>ln,FieldLinks:()=>an,FieldTypes:()=>mn,FieldUserSelectionMode:()=>Tn,Fields:()=>gn,File:()=>vr,Files:()=>fr,Folder:()=>en,Folders:()=>Yr,Form:()=>Un,Forms:()=>xn,HubSite:()=>Ln,HubSites:()=>Dn,Item:()=>Rt,ItemVersion:()=>Lt,ItemVersions:()=>Ft,Items:()=>xt,LimitedWebPartManager:()=>Ys,List:()=>It,Lists:()=>St,MoveOperations:()=>Tr,MySocial:()=>fs,Navigation:()=>On,NavigationNode:()=>kn,NavigationNodes:()=>$n,NavigationService:()=>Nn,PageType:()=>Et,PagedItemCollection:()=>Bt,PermissionKind:()=>ki,PrincipalSource:()=>Ot,PrincipalType:()=>_t,Profiles:()=>qn,PromotedState:()=>Mr,QueryPropertyValueType:()=>Si,RegionalSettings:()=>Kn,RelatedItemManager:()=>ai,Relation:()=>Ws,Relations:()=>js,RenderListDataOptions:()=>Tt,ReorderingRuleMatchType:()=>bi,Replies:()=>Nr,RoleAssignment:()=>Li,RoleAssignments:()=>Fi,RoleDefinition:()=>Ai,RoleDefinitions:()=>$i,RoleType:()=>qi,SPBatch:()=>at,SPHttpClient:()=>$e,SPRest:()=>ut,SPSharedObjectType:()=>Oi,Search:()=>gi,SearchBuiltInSourceId:()=>Pi,SearchQueryBuilder:()=>di,SearchResults:()=>yi,SharePointQueryable:()=>Ke,SharePointQueryableCollection:()=>Xe,SharePointQueryableInstance:()=>Ye,SharingDomainRestrictionMode:()=>Ei,SharingLinkKind:()=>Mi,SharingOperationStatusCode:()=>Ni,SharingRole:()=>_i,Site:()=>pt,SiteDesigns:()=>os,SiteGroup:()=>Ri,SiteGroups:()=>xi,SiteScripts:()=>cs,SiteUser:()=>wi,SiteUsers:()=>Ti,Social:()=>ps,SocialActorType:()=>vs,SocialActorTypes:()=>bs,SocialFollowResult:()=>Ss,SocialStatusCode:()=>Ps,SortDirection:()=>vi,Subscription:()=>Us,Subscriptions:()=>Cs,Suggest:()=>mi,TemplateFileType:()=>wr,Term:()=>Ms,TermGroup:()=>Bs,TermGroups:()=>Ls,TermSet:()=>ks,TermSets:()=>As,TermStore:()=>Ds,Terms:()=>Ns,TimeZone:()=>Xn,TimeZones:()=>Yn,UrlFieldFormatType:()=>In,UrlZone:()=>Gn,UserCustomAction:()=>ni,UserCustomActionRegistrationType:()=>ii,UserCustomActionScope:()=>si,UserCustomActions:()=>ti,Utilities:()=>Is,Version:()=>Pr,Versions:()=>Sr,View:()=>zs,ViewFields:()=>Qs,ViewScope:()=>Xs,Views:()=>Vs,Web:()=>mt,WebPartDefinition:()=>to,WebPartDefinitions:()=>eo,WebPartsPersonalizationScope:()=>ro,Webs:()=>yt,containsInvalidFileFolderChars:()=>jt,defaultPath:()=>tt,extractWebUrl:()=>Le,objectToSPKeyValueCollection:()=>Nt,registerCustomRequestClientFactory:()=>_e,sp:()=>no,spDelete:()=>je,spGet:()=>Me,spInvokableFactory:()=>Ge,spODataEntity:()=>st,spODataEntityArray:()=>ot,spPatch:()=>We,spPost:()=>qe,spPostDelete:()=>He,spPostDeleteETag:()=>Ve,stripInvalidFileFolderChars:()=>Wt,toAbsoluteUrl:()=>ke});var i,s={};r.r(s),r.d(s,{Attachment:()=>Co,Attachments:()=>Uo,Bucket:()=>pl,Buckets:()=>yl,Calendar:()=>No,Calendars:()=>qo,Channel:()=>wl,Channels:()=>xl,Contact:()=>Zo,ContactFolder:()=>na,ContactFolders:()=>sa,Contacts:()=>ta,Conversation:()=>po,Conversations:()=>yo,DirectoryObject:()=>Do,DirectoryObjectTypes:()=>Bo,DirectoryObjects:()=>Lo,Drive:()=>$a,DriveItem:()=>Na,DriveItems:()=>qa,Drives:()=>ka,Event:()=>Wo,Events:()=>Vo,GraphBatch:()=>Kt,GraphEndpoints:()=>Jt,GraphHttpClient:()=>Gt,GraphQueryable:()=>cr,GraphQueryableCollection:()=>dr,GraphQueryableInstance:()=>gr,GraphQueryableSearchableCollection:()=>hr,GraphRest:()=>Qt,Group:()=>ko,GroupType:()=>$o,Groups:()=>Oo,Insights:()=>aa,Invitations:()=>Sa,MailFolder:()=>Ua,MailFolders:()=>Da,MailboxSettings:()=>La,Member:()=>Pa,Members:()=>Ta,Message:()=>wa,Messages:()=>xa,Notebook:()=>Ha,Notebooks:()=>Ga,OneNote:()=>Wa,People:()=>Jo,Photo:()=>Ja,Plan:()=>nl,PlanDetails:()=>tl,Planner:()=>Za,Plans:()=>sl,Post:()=>Po,Posts:()=>To,Resource:()=>va,Root:()=>Oa,Section:()=>za,Sections:()=>Qa,Senders:()=>wo,SharedInsight:()=>ga,SharedInsights:()=>fa,Subscription:()=>ml,Subscriptions:()=>bl,Tab:()=>Rl,Tabs:()=>Fl,Task:()=>cl,TaskDetails:()=>al,Tasks:()=>dl,Team:()=>Pl,Teams:()=>Tl,Thread:()=>mo,Threads:()=>bo,TrendingInsight:()=>la,TrendingInsights:()=>ua,UsedInsight:()=>da,UsedInsights:()=>pa,User:()=>zo,Users:()=>Qo,graph:()=>Xt,graphDelete:()=>ir,graphGet:()=>rr,graphPatch:()=>sr,graphPost:()=>nr,graphPut:()=>or,registerCustomRequestClientFactory:()=>Yt,toAbsoluteUrl:()=>zt});class o{static get activeLogLevel(){return o.instance.activeLogLevel}static set activeLogLevel(e){o.instance.activeLogLevel=e}static get instance(){return void 0!==o._instance&&null!==o._instance||(o._instance=new a),o._instance}static subscribe(...e){e.forEach((e=>o.instance.subscribe(e)))}static clearSubscribers(){return o.instance.clearSubscribers()}static get count(){return o.instance.count}static write(e,t=1){o.instance.log({level:t,message:e})}static writeJSON(e,t=1){this.write(JSON.stringify(e),t)}static log(e){o.instance.log(e)}static error(e){o.instance.log({data:e,level:3,message:e.message})}}class a{constructor(e=2,t=[]){this.activeLogLevel=e,this.subscribers=t}subscribe(e){this.subscribers.push(e)}clearSubscribers(){const e=this.subscribers.slice(0);return this.subscribers.length=0,e}get count(){return this.subscribers.length}write(e,t=1){this.log({level:t,message:e})}log(e){void 0!==e&&this.activeLogLevel<=e.level&&this.subscribers.map((t=>t.log(e)))}}!function(e){e[e.Verbose=0]="Verbose",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Off=99]="Off"}(i||(i={}));class l{log(e){const t=this.format(e);switch(e.level){case 0:case 1:console.log(t);break;case 2:console.warn(t);break;case 3:console.error(t)}}format(e){const t=[];if(t.push("Message: "+e.message),void 0!==e.data)try{t.push(" Data: "+JSON.stringify(e.data))}catch(e){t.push(` Data: Error in stringify of supplied data ${e}`)}return t.join("")}}class c{constructor(e){this.method=e}log(e){this.method(e)}}function u(e,t,...r){return function(){t.apply(e,r)}}function d(e,t,r){let n=new Date(e.toString());switch(t.toLowerCase()){case"year":n.setFullYear(n.getFullYear()+r);break;case"quarter":n.setMonth(n.getMonth()+3*r);break;case"month":n.setMonth(n.getMonth()+r);break;case"week":n.setDate(n.getDate()+7*r);break;case"day":n.setDate(n.getDate()+r);break;case"hour":n.setTime(n.getTime()+36e5*r);break;case"minute":n.setTime(n.getTime()+6e4*r);break;case"second":n.setTime(n.getTime()+1e3*r);break;default:n=void 0}return n}function h(...e){return e.filter((e=>!S(e))).map((e=>e.replace(/^[\\|/]/,"").replace(/[\\|/]$/,""))).join("/").replace(/\\/g,"/")}function p(e){const t=new Array(e);for(let r=0;r<e;r++)t[r]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return t.join("")}function g(){let e=Date.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){const r=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?r:3&r|8).toString(16)}))}function y(e){return"function"==typeof e}function f(e){return null!=e}function m(e){return Array.isArray?Array.isArray(e):e&&"number"==typeof e.length&&e.constructor===Array}function v(e,t,r=!1,n=(()=>!0)){if(!f(t))return e;const i=r?(e,t)=>!(t in e):()=>!0;return Object.getOwnPropertyNames(t).filter((t=>i(e,t)&&n(t))).reduce(((e,r)=>(e[r]=t[r],e)),e)}function b(e){return/^https?:\/\/|^\/\//i.test(e)}function S(e){return null==e||e.length<1}function P(e){if(S(e))return e;const t=/([0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12})/i.exec(e);return null===t?e:t[1]}function I(e){return JSON.stringify(e)}function T(e,t){return Object.hasOwnProperty.call(e,t)}function w(e){let t=0;if(0===e.length)return t;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return t}const C=y(Object.entries)?Object.entries:e=>Object.keys(e).map((t=>[t,e[t]]));function x(e){return f(e)?new Map(C(e)):new Map}function U(e,...t){for(let r=0;r<t.length;r++)t[r].forEach(((t,r)=>{"string"==typeof r&&"spfxContext"!==r&&"[object Object]"===Object.prototype.toString.call(t)?e.set(r,Object.assign({},e.get(r)||{},t)):e.set(r,t)}));return e}const R=["defaultCachingStore","defaultCachingTimeoutSeconds","globalCacheDisable","enableCacheExpiration","cacheExpirationIntervalMilliseconds","spfxContext","ie11"],D=[];function F(e){D.indexOf(e)<0&&(e(B),D.push(e))}class L{constructor(e=new Map){this._v=e;const t=(e,t)=>{this._v.has(e)||this._v.set(e,t)};t(R[0],"session"),t(R[1],60),t(R[2],!1),t(R[3],!1),t(R[4],750),t(R[5],null),t(R[6],!1),D.forEach((e=>e(this)))}assign(e){this._v=U(this._v,x(e))}get(e){return this._v.get(e)}export(){const e=new Map;for(const[t,r]of this._v)"__isDefault__"!==t&&e.set(t,r);return e}}const B=new L(new Map([["__isDefault__",!0]]));function $(e,t,r,n){var i,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,r,o):i(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o}function A(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))}Object.create,Object.create;const k=void 0===r.g?window:r.g;function _(e,t){f(t)&&new Request("",{headers:t}).headers.forEach(((t,r)=>{e.append(r,t)}))}function O(e,t){if(f(t)){const r=v(e.headers||{},t.headers);(e=v(e,t)).headers=r}}function E(e){const t=new URL(e);return`${t.protocol}//${t.hostname}`}class N{fetch(e,t){return k.fetch(e,t)}}class M extends N{constructor(e){super(),this._token=e}get token(){return this._token||""}set token(e){this._token=e}fetch(e,t={}){const r=new Headers;return _(r,t.headers),r.set("Authorization",`Bearer ${this._token}`),t.headers=r,super.fetch(e,t)}}class q extends M{constructor(e){super(null),this.context=e}fetch(e,t){const r=Object.create(null,{fetch:{get:()=>super.fetch}});return A(this,void 0,void 0,(function*(){const n=yield this.getToken(E(e));return this.token=n,r.fetch.call(this,e,t)}))}getToken(e){return A(this,void 0,void 0,(function*(){return(yield this.context.aadTokenProviderFactory.getTokenProvider()).getToken(e)}))}}class j{constructor(e,t=-1){this.store=e,this.defaultTimeoutMinutes=t,this.enabled=this.test(),B.get("enableCacheExpiration")&&this.cacheExpirationHandler()}static bind(e){return new j(void 0===e?new W:e)}get(e){if(!this.enabled)return null;const t=this.store.getItem(e);if(!f(t))return null;const r=JSON.parse(t);return new Date(r.expiration)<=new Date?(this.delete(e),null):r.value}put(e,t,r){this.enabled&&this.store.setItem(e,this.createPersistable(t,r))}delete(e){this.enabled&&this.store.removeItem(e)}getOrPut(e,t,r){return A(this,void 0,void 0,(function*(){if(!this.enabled)return t();let n=this.get(e);return null===n&&(n=yield t(),this.put(e,n,r)),n}))}deleteExpired(){return A(this,void 0,void 0,(function*(){if(this.enabled)for(let e=0;e<this.store.length;e++){const t=this.store.key(e);null!==t&&/["|']?pnp["|']? ?: ?1/i.test(this.store.getItem(t))&&(yield this.get(t))}}))}test(){try{return this.store.setItem("t","t"),this.store.removeItem("t"),!0}catch(e){return!1}}createPersistable(e,t){if(void 0===t){let e=B.get("defaultCachingTimeoutSeconds");this.defaultTimeoutMinutes>0&&(e=60*this.defaultTimeoutMinutes),t=d(new Date,"second",e)}return I({pnp:1,expiration:t,value:e})}cacheExpirationHandler(){this.enabled&&this.deleteExpired().then((()=>{setTimeout(u(this,this.cacheExpirationHandler),B.get("cacheExpirationIntervalMilliseconds"))})).catch(console.error)}}class W{constructor(e=new Map){this._store=e}get length(){return this._store.size}clear(){this._store.clear()}getItem(e){return this._store.get(e)}key(e){return Array.from(this._store)[e][0]}removeItem(e){this._store.delete(e)}setItem(e,t){this._store.set(e,t)}}class H{constructor(e=null,t=null){this._local=e,this._session=t}get local(){return null===this._local&&(this._local=new j("undefined"==typeof localStorage?new W:localStorage)),this._local}get session(){return null===this._session&&(this._session=new j("undefined"==typeof sessionStorage?new W:sessionStorage)),this._session}}class V{constructor(e=new Map){this._settings=e}add(e,t){this._settings.set(e,t)}addJSON(e,t){this._settings.set(e,I(t))}apply(e){return new Promise(((t,r)=>{try{this._settings=U(this._settings,x(e)),t()}catch(e){r(e)}}))}load(e){return new Promise(((t,r)=>{e.getConfiguration().then((e=>{this._settings=U(this._settings,x(e)),t()})).catch(r)}))}get(e){return this._settings.get(e)||null}getJSON(e){const t=this.get(e);return null==t?t:JSON.parse(t)}}class G{constructor(e,t,r){this.wrappedProvider=e,this.cacheKey=t,this.wrappedProvider=e,this.store=r||this.selectPnPCache()}getWrappedProvider(){return this.wrappedProvider}getConfiguration(){return this.store&&this.store.enabled?this.store.getOrPut(this.cacheKey,(()=>this.wrappedProvider.getConfiguration().then((e=>(this.store.put(this.cacheKey,e),e))))):this.wrappedProvider.getConfiguration()}selectPnPCache(){const e=new H;if(e.local&&e.local.enabled)return e.local;if(e.session&&e.session.enabled)return e.session;throw Error("Cannot create a caching configuration provider since cache is not available.")}}class z{constructor(e=g()){this._batchId=e,this._reqs=[],this._deps=[],this._rDeps=[],this._index=-1}get batchId(){return this._batchId}get requests(){return this._reqs.sort(((e,t)=>e.index-t.index))}track(e){e.data.batch=this,(void 0===e.data.batchIndex||e.data.batchIndex<0)&&(e.data.batchIndex=++this._index)}add(e){const t={id:e.requestId,index:e.batchIndex,method:e.method.toUpperCase(),options:e.options,parser:e.parser,reject:null,resolve:null,url:e.url},r=new Promise(((e,r)=>{t.resolve=e,t.reject=r}));return this._reqs.push(t),r}addDependency(){let e=()=>{};return this._deps.push(new Promise((t=>{e=t}))),e}addResolveBatchDependency(e){this._rDeps.push(e)}execute(){return Promise.all(this._deps).then((()=>Promise.all(this._deps))).then((()=>this.executeImpl())).then((()=>Promise.all(this._rDeps))).then((()=>{}))}}class K{constructor(e,t,r){this.key=e,this.storeName=t,this.expiration=r}get store(){return"local"===this.storeName?K.storage.local:K.storage.session}}K.storage=new H;class Q{constructor(e,t){this.parser=e,this.cacheOptions=t}parse(e){return this.parser.parse(e).then((e=>this.cacheData(e)))}cacheData(e){return null!==this.cacheOptions.store&&this.cacheOptions.store.put(this.cacheOptions.key,e,this.cacheOptions.expiration),e}}function X(e,t,r,n){Reflect.defineProperty(e.prototype,t,{configurable:!0,enumerable:!0,get:function(){return r(this,n)}})}let J=!1;const Y=[],Z=new Map,ee=Symbol.for("43f7a601"),te=e=>{J=!0,ie(Y,e)},re=(e,t)=>(J=!0,Reflect.has(e,ee)||Reflect.set(e,ee,[]),ie(Reflect.get(e,ee),t),e),ne=(e,t)=>{J=!0;const r=Reflect.getPrototypeOf(e);Reflect.has(r,ee)||Reflect.defineProperty(r,ee,{value:g()});const n=r[ee];Z.has(n)||Z.set(n,[]),ie(Z.get(n),t)};function ie(e,t){Array.isArray(t)?e.push(...t):e.push(t)}const se=()=>{Y.length=0},oe=()=>{J=!1},ae=()=>{J=!0};function le(e,t,r,...n){if(J){const t=[];Reflect.has(r,ee)&&t.push(...Reflect.get(r,ee)),t.push(...Y);for(let i=0;i<t.length;i++){const s=t[i];let o;if(y(s)?o=s(e,r,...n):"get"===e&&Reflect.has(s,n[0])?o=Reflect.get(s,n[0],r):Reflect.has(s,e)&&(o=Reflect.get(s,e)(r,...n)),void 0!==o)return o}}return t(r,...n)}const ce=(ue=function(e){return this.defaultAction(e)},e=>(...t)=>{const r=t=>{const r=Object.assign((function(...e){return ue.call(r,...e)}),new e(...t));return Reflect.setPrototypeOf(r,e.prototype),r};return B.get("ie11")?r(t):new Proxy(((e,t)=>{let r=e(t);const n=Reflect.getPrototypeOf(e);if(Reflect.has(n,ee)){const e=Z.get(Reflect.get(n,ee));r=re(r,e)}return r})(r,t),{apply:(e,t,r)=>le("apply",((...e)=>Reflect.apply(e[0],e[1],e[2])),e,t,r),get:(e,t,r)=>le("get",((...e)=>Reflect.get(e[0],e[1],e[2])),e,t,r),has:(e,t)=>le("has",((...e)=>Reflect.has(e[0],e[1])),e,t),set:(e,t,r,n)=>le("set",((...e)=>Reflect.set(e[0],e[1],e[2],e[3])),e,t,r,n)})});var ue;class de{parse(e){return new Promise(((t,r)=>{this.handleError(e,r)&&this.parseImpl(e,t,r)}))}parseImpl(e,t,r){e.headers.has("Content-Length")&&0===parseFloat(e.headers.get("Content-Length"))||204===e.status?t({}):e.text().then((e=>e.replace(/\s/gi,"").length>0?JSON.parse(e):{})).then((e=>t(this.parseODataJSON(e)))).catch((e=>r(e)))}handleError(e,t){return e.ok||me.init(e).then(t),e.ok}parseODataJSON(e){let t=e;return T(e,"d")?t=T(e.d,"results")?e.d.results:e.d:T(e,"value")&&(t=e.value),t}}class he extends de{parseImpl(e,t){e.text().then(t)}}class pe extends de{parseImpl(e,t){e.blob().then(t)}}class ge extends de{parseImpl(e,t){e.json().then(t)}}class ye extends de{parseImpl(e,t){y(e.arrayBuffer)?e.arrayBuffer().then(t):e.buffer().then(t)}}class fe extends de{constructor(e){super(),this.parser=e}parseImpl(e,t){this.parser(e).then(t)}}class me extends Error{constructor(e,t,r=t.status,n=t.statusText){super(e),this.response=t,this.status=r,this.statusText=n,this.isHttpRequestError=!0}static init(e){return A(this,void 0,void 0,(function*(){const t=yield e.clone().text();return new me(`Error making HttpClient request in queryable [${e.status}] ${e.statusText} ::> ${t}`,e.clone())}))}}function ve(e){let t;e.options&&e.options.body&&(t=e.options.body,e.options.body="-");const r=JSON.stringify(e,((e,t)=>{switch(e){case"query":return JSON.stringify([...t]);case"batch":case"batchDependency":case"cachingOptions":case"clientFactory":case"parser":return"-";default:return t}}),0),n=JSON.parse(r,((t,r)=>{switch(t){case"query":return new Map(JSON.parse(r));case"batch":case"batchDependency":case"cachingOptions":case"clientFactory":case"parser":return e[t];default:return r}}));return t&&(n.options.body=t,e.options.body=t),n}class be{constructor(e={}){this._data=Object.assign({},{cloneParentWasCaching:!1,options:{},parentUrl:"",parser:new de,query:new Map,url:"",useCaching:!1},ve(e)),this._runtime=null}get data(){return this._data}set data(e){this._data=Object.assign({},this.data,ve(e))}getRuntime(){return null===this._runtime?B:this._runtime}setRuntime(...e){return e[0]instanceof L?this._runtime=e[0]:(this._runtime=e[0]?new L(B.export()):new L,e.length>1&&f(e[1])&&this._runtime.assign(e[1])),this}toUrl(){return this.data.url}concat(e){return this.data.url+=e,this}get query(){return this.data.query}configure(e){return O(this.data.options,e),this}configureFrom(e){O(this.data.options,e.data.options);const t=e.getRuntime();return t.get("__isDefault__")||this.setRuntime(t),this}usingCaching(e){const t=this.getRuntime();if(!t.get("globalCacheDisable")){if(this.data.useCaching=!0,"string"==typeof e){if(S(e))throw Error("Cache key cannot be empty.");e={key:e}}const r={expiration:d(new Date,"second",t.get("defaultCachingTimeoutSeconds")),storeName:t.get("defaultCachingStore")};this.data.cachingOptions=v(r,e)}return this}usingParser(e){return this.data.parser=e,this}withPipeline(e){return this.data.pipes=e.slice(0),this}append(e){this.data.url=h(this.data.url,e)}inBatch(e){if(this.hasBatch)throw Error("This query is already part of a batch.");return f(e)&&e.track(this),this}addBatchDependency(){return f(this.data.batch)?this.data.batch.addDependency():()=>null}get hasBatch(){return f(this.data.batch)}get batch(){return this.hasBatch?this.data.batch:null}get parentUrl(){return this.data.parentUrl}cloneTo(e,t={}){return t=v({includeBatch:!0,includeQuery:!1},t),e.data=Object.assign({},ve(this.data),{batch:null,cloneParentCacheOptions:null,cloneParentWasCaching:!1},ve(e.data)),e.configureFrom(this),t.includeBatch&&e.inBatch(this.batch),t.includeQuery&&this.query.size>0&&this.query.forEach(((t,r)=>e.query.set(r,t))),this.data.useCaching&&(e.data.cloneParentWasCaching=!0,e.data.cloneParentCacheOptions=this.data.cachingOptions),e}}function Se(e,t){return new Promise((r=>{e.result=t,e.hasResult=!0,r(e)}))}function Pe(e){return e.pipes.length>0?e.pipes.shift()(e):Promise.resolve(e)}function Ie(e){if(e.pipes.length<1)throw o.write(`[${e.requestId}] (${(new Date).getTime()}) Request pipeline contains no methods!`,3),Error("Request pipeline contains no methods!");const t=Pe(e).then((e=>function(e){return o.log({data:0===o.activeLogLevel?e.result:{},level:1,message:`[${e.requestId}] (${(new Date).getTime()}) Returning result from pipeline. Set logging to verbose to see data.`}),Promise.resolve(e.result)}(e))).catch((e=>{throw o.error(e),e}));return e.isBatched&&e.batch.addResolveBatchDependency(t),t}function Te(e=!1){return(t,r,n)=>{const i=n.value;n.value=function(...n){return!e&&n.length>0&&T(n[0],"hasResult")&&n[0].hasResult?(o.write(`[${n[0].requestId}] (${(new Date).getTime()}) Skipping request pipeline method ${r}, existing result in pipeline.`,0),Promise.resolve(n[0])):(o.write(`[${n[0].requestId}] (${(new Date).getTime()}) Calling request pipeline method ${r}.`,0),i.apply(t,n).then((e=>Pe(e))))}}}class we{static logStart(e){return new Promise((t=>{o.log({data:1===o.activeLogLevel?{}:e,level:1,message:`[${e.requestId}] (${(new Date).getTime()}) Beginning ${e.method} request (${e.url})`}),t(e)}))}static caching(e){return new Promise((t=>{if(e.useCaching){o.write(`[${e.requestId}] (${(new Date).getTime()}) Caching is enabled for request, checking cache...`,1);let r=new K(e.url.toLowerCase());if(void 0!==e.cachingOptions&&(r=v(r,e.cachingOptions)),null!==r.store){let n=r.store.get(r.key);if(null!==n)return o.log({data:1===o.activeLogLevel?{}:n,level:1,message:`[${e.requestId}] (${(new Date).getTime()}) Value returned from cache.`}),y(e.batchDependency)&&e.batchDependency(),T(e.parser,"hydrate")&&(n=e.parser.hydrate(n)),Se(e,n).then((e=>t(e)))}o.write(`[${e.requestId}] (${(new Date).getTime()}) Value not found in cache.`,1),e.parser=new Q(e.parser,r)}return t(e)}))}static send(e){return new Promise(((t,r)=>{if(e.isBatched){const r=e.batch.add(e);y(e.batchDependency)&&e.batchDependency(),o.write(`[${e.requestId}] (${(new Date).getTime()}) Batching request in batch ${e.batch.batchId}.`,1),t(Se(e,r))}else{o.write(`[${e.requestId}] (${(new Date).getTime()}) Sending request.`,1);const n=e.clientFactory(),i=v(e.options||{},{method:e.method});n.fetch(e.url,i).then((t=>e.parser.parse(t))).then((t=>Se(e,t))).then((e=>t(e))).catch((e=>r(e)))}}))}static logEnd(e){return new Promise((t=>{e.isBatched?o.log({data:1===o.activeLogLevel?{}:e,level:1,message:`[${e.requestId}] (${(new Date).getTime()}) ${e.method} request will complete in batch ${e.batch.batchId}.`}):o.log({data:1===o.activeLogLevel?{}:e,level:1,message:`[${e.requestId}] (${(new Date).getTime()}) Completing ${e.method} request.`}),t(e)}))}}function Ce(){return[we.logStart,we.caching,we.send,we.logEnd].slice(0)}function xe(e){return function(t){return function(r){return function(n){return Ie(Object.assign({},{batch:null,batchDependency:null,batchIndex:-1,cachingOptions:null,clientFactory:t,cloneParentCacheOptions:null,cloneParentWasCaching:!1,hasResult:!1,isBatched:f(n.batch),method:r,options:null,parentUrl:"",parser:new de,pipes:e.slice(0),query:new Map,requestId:g(),url:"",useCaching:/^get$/i.test(n.method)&&n.useCaching},ve(n)))}}}}$([Te(!0)],we,"logStart",null),$([Te()],we,"caching",null),$([Te()],we,"send",null),$([Te(!0)],we,"logEnd",null);const Ue=xe(Ce());function Re(e,t){return Object.assign({body:I(e)},t)}function De(e,t){return Object.assign({headers:e},t)}function Fe(e){return{__metadata:{type:e}}}function Le(e){if(S(e))return"";let t=e.indexOf("_api/");return t<0&&(t=e.indexOf("_vti_bin/")),t>-1?e.substr(0,t):e}function Be(e){return function(t,r,n){void 0===n&&(n=Object.getOwnPropertyDescriptor(t,r));const i=n.value;return n.value=function(...t){return A(this,void 0,void 0,(function*(){return this.configure(De({"X-PnPjs-Tracking":e})),i.apply(this,t)}))},n}}Be.getClientTag=(e,t=!0)=>{if(e.has("X-PnPjs-Tracking")){const r=e.get("X-PnPjs-Tracking");if(t&&e.delete("X-PnPjs-Tracking"),!S(r))return r}return""},Be.configure=(e,t)=>e.configure(De({"X-PnPjs-Tracking":t})),Be.isTagged=e=>e.data.options.headers&&e.data.options.headers["X-PnPjs-Tracking"];class $e{constructor(...e){var t;if(e[0]instanceof L?this._runtime=e[0]:(this._runtime=e.length>1&&e[1]instanceof L?e[1]:B,this._impl=e[0]),this._impl=(null===(t=this._runtime.get("sp"))||void 0===t?void 0:t.fetchClientFactory())||null,null===this._impl)throw Error("Could not generate fetchClientFactory in SPHttpClient.");this._digestCache=function(e){return t=>A(this,void 0,void 0,(function*(){var r,n;const i=Ae.get(t);if(void 0!==i&&new Date<i.expiration)return i.value;const s=h(t,"/_api/contextinfo"),o=yield e.fetchRaw(s,{cache:"no-cache",credentials:"same-origin",headers:v({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose;charset=utf-8"},null===(n=null===(r=e._runtime.get("sp"))||void 0===r?void 0:r.sp)||void 0===n?void 0:n.headers,!0),method:"POST"}),a=yield(new de).parse(o).then((e=>e.GetContextWebInformation)),l={expiration:d(new Date,"second",a.FormDigestTimeoutSeconds),value:a.FormDigestValue};return Ae.set(t,l),l.value}))}(this)}fetch(e,t={}){var r,n;return A(this,void 0,void 0,(function*(){let i=v(t,{cache:"no-cache",credentials:"same-origin"},!0);const s=new Headers;if(_(s,null===(n=null===(r=this._runtime.get("sp"))||void 0===r?void 0:r.sp)||void 0===n?void 0:n.headers),_(s,t.headers),s.has("Accept")||s.append("Accept","application/json"),s.has("Content-Type")||s.append("Content-Type","application/json;odata=verbose;charset=utf-8"),!s.has("X-ClientService-ClientTag")){let e=`PnPCoreJS:2.1.0-beta10:${Be.getClientTag(s)}`;e.length>32&&(e=e.substr(0,32)),s.append("X-ClientService-ClientTag",e)}if(i=v(i,{headers:s}),i.method&&"GET"!==i.method.toUpperCase()&&!s.has("X-RequestDigest")&&!s.has("Authorization")){const t=yield this._digestCache(Le(e));s.append("X-RequestDigest",t)}return this.fetchRaw(e,i)}))}fetchRaw(e,t={}){const r=new Headers;_(r,t.headers),t=v(t,{headers:r});const n=r=>{const i=e=>{let t;e.headers.has("Retry-After")?t=1e3*parseInt(e.headers.get("Retry-After"),10):(t=r.delay,r.delay*=2),r.attempts++,r.retryCount<=r.attempts?r.reject(Error(`Retry count exceeded (${r.retryCount}) for request. Response status: [${e.status}] ${e.statusText}`)):setTimeout(u(this,n,r),t)};this._impl.fetch(e,t).then((e=>{429===e.status?i(e):r.resolve(e)})).catch((e=>{503===e.status||504===e.status?i(e):r.reject(e)}))};return new Promise(((e,t)=>{n.call(this,{attempts:0,delay:100,reject:t,resolve:e,retryCount:7})}))}get(e,t={}){const r=v(t,{method:"GET"});return this.fetch(e,r)}post(e,t={}){const r=v(t,{method:"POST"});return this.fetch(e,r)}patch(e,t={}){const r=v(t,{method:"PATCH"});return this.fetch(e,r)}delete(e,t={}){const r=v(t,{method:"DELETE"});return this.fetch(e,r)}}const Ae=new Map;function ke(e,t=B){var r,n;return A(this,void 0,void 0,(function*(){if(b(e))return e;const i=null===(r=t.get("sp"))||void 0===r?void 0:r.baseUrl,s=null===(n=t.get("sp"))||void 0===n?void 0:n.fetchClientFactory;if(!S(i))return h(i,e);const o=t.get("spfxContext");if(o)return h(o.pageContext.web.absoluteUrl,e);if(s){const t=s();if(T(t,"siteUrl"))return h(t.siteUrl,e)}if(void 0!==k._spPageContextInfo){if(T(k._spPageContextInfo,"webAbsoluteUrl"))return h(k._spPageContextInfo.webAbsoluteUrl,e);if(T(k._spPageContextInfo,"webServerRelativeUrl"))return h(k._spPageContextInfo.webServerRelativeUrl,e)}if(void 0!==k.location){const t=k.location.toString().toLowerCase();["/_layouts/","/siteassets/","/sitepages/"].forEach((r=>{const n=t.indexOf(r);if(n>0)return h(t.substr(0,n),e)}))}return e}))}function _e(e){Ee=y(e)?()=>e:Oe}const Oe=e=>()=>new $e(e);let Ee=Oe;const Ne=e=>function(t,r){return A(this,void 0,void 0,(function*(){const n=t.getRuntime(),i=Ue(Ee(n))(e),s=ve(t.data),o=f(s.batch)?s.batch.addDependency():()=>{},a=yield ke(t.toUrlAndQuery(),n);return O(s.options,r),i(Object.assign({},s,{batchDependency:o,url:a}))}))},Me=(e,t)=>(e.data.cloneParentWasCaching&&e.usingCaching(e.data.cloneParentCacheOptions),e._forceCaching&&(e.data.useCaching=!0),Ne("GET")(e,t)),qe=(e,t)=>Ne("POST")(e,t),je=(e,t)=>Ne("DELETE")(e,t),We=(e,t)=>Ne("PATCH")(e,t),He=(e,t)=>{const r=Object.assign(De({"X-HTTP-Method":"DELETE"}),t);return qe(e,r)},Ve=(e,t,r="*")=>{const n=Object.assign(De({"X-HTTP-Method":"DELETE","IF-Match":r}),t);return qe(e,n)},Ge=e=>ce(e);class ze extends be{constructor(e,t){let r="",n="";const i=new Map;if("string"==typeof e)if(b(e)||e.lastIndexOf("/")<0)n=e,r=h(e,t);else if(e.lastIndexOf("/")>e.lastIndexOf("(")){const i=e.lastIndexOf("/");n=e.slice(0,i),t=h(e.slice(i),t),r=h(n,t)}else{const i=e.lastIndexOf("(");n=e.slice(0,i),r=h(e,t)}else{n=e.toUrl(),r=h(n,t||"");const s=e.query.get("@target");void 0!==s&&i.set("@target",s)}super({parentUrl:n,query:i,url:r}),"string"!=typeof e&&this.configureFrom(e),this._forceCaching=!1}toUrlAndQuery(){const e=new Map(this.query);let t=this.toUrl().replace(/'!(@.*?)::(.*?)'/gi,((t,r,n)=>(o.write(`Rewriting aliased parameter from match ${t} to label: ${r} value: ${n}`,0),e.set(r,`'${n}'`),r)));if(e.size>0){const r=t.indexOf("?")>-1?"&":"?";t+=`${r}${Array.from(e).map((e=>e[0]+"="+e[1])).join("&")}`}return t}select(...e){return e.length>0&&this.query.set("$select",e.map(encodeURIComponent).join(",")),this}get(e){return Me(this,e)}expand(...e){return e.length>0&&this.query.set("$expand",e.map(encodeURIComponent).join(",")),this}clone(e,t,r=!0,n=!1){const i=super.cloneTo(e(this,t),{includeBatch:r,includeQuery:n});if(!n){const e="@target";this.query.has(e)&&i.query.set(e,this.query.get(e))}return i}defaultAction(e){return Me(this,e)}getParent(e,t=this.parentUrl,r,n){let i=e(t,r).configureFrom(this);const s="@target";return this.query.has(s)&&i.query.set(s,this.query.get(s)),void 0!==n&&(i=i.inBatch(n)),i}}const Ke=Ge(ze);class Qe extends ze{filter(e){return this.query.set("$filter",encodeURIComponent(e)),this}orderBy(e,t=!0){const r="$orderby",n=this.query.has(r)?this.query.get(r).split(","):[];return n.push(`${encodeURIComponent(e)} ${t?"asc":"desc"}`),this.query.set(r,n.join(",")),this}skip(e){return this.query.set("$skip",e.toString()),this}top(e){return this.query.set("$top",e.toString()),this}}const Xe=Ge(Qe);class Je extends ze{_update(e,t){return r=>qe(Be.configure(this,`${e}.Update`),{body:I(v(Fe(e),r)),headers:{"X-HTTP-Method":"MERGE"}}).then((e=>t(e,r)))}}const Ye=Ge(Je);function Ze(e){return function(){return He(Be.configure(this,`${e}.delete`))}}function et(e){return function(t="*"){return Ve(Be.configure(this,`${e}.delete`),{},t)}}function tt(e){return function(t){return class extends t{constructor(...t){super(t[0],t.length>1&&void 0!==t[1]?t[1]:e)}}}}function rt(e){const t=[],r=["odata.type","odata.editLink","__metadata","odata.metadata","odata.id"];if(T(e,r[0])&&"SP.Web"===e[r[0]])T(e,r[4])?t.push(e[r[4]]):T(e,r[2])&&t.push(e.__metadata.uri);else if(T(e,r[3])&&T(e,r[1])){const n=b(e[r[1]])?e[r[1]].split("_api")[1]:e[r[1]];t.push(Le(e[r[3]]),"_api",n)}else T(e,r[1])?t.push("_api",e[r[1]]):T(e,r[2])&&t.push(e.__metadata.uri);return t.length<1?(o.write("No uri information found in ODataEntity parsing, chaining will fail for this object.",2),""):h(...t)}class nt extends de{constructor(e){super(),this.factory=e,this.hydrate=e=>v(this.factory(rt(e),null),e)}parse(e){return super.parse(e).then((e=>v(this.factory(rt(e),null),e)))}}class it extends de{constructor(e){super(),this.factory=e,this.hydrate=e=>e.map((e=>v(this.factory(rt(e),null),e)))}parse(e){return super.parse(e).then((e=>e.map((e=>v(this.factory(rt(e),null),e)))))}}function st(e){return new nt(e)}function ot(e){return new it(e)}class at extends z{constructor(e,t=B){super(),this.url=e,this.runtime=t}static ParseResponse(e){const t=[],r="--batchresponse_",n=new RegExp("^HTTP/[0-9.]+ +([0-9]+) +(.*)","i"),i=e.split("\n");let s,o,a="batch";for(let e=0;e<i.length;++e){const l=i[e];switch(a){case"batch":if(l.substr(0,r.length)===r)a="batchHeaders";else if(""!==l.trim())throw Error(`Invalid response, line ${e}`);break;case"batchHeaders":""===l.trim()&&(a="status");break;case"status":{const t=n.exec(l);if(3!==t.length)throw Error(`Invalid status, line ${e}`);s=parseInt(t[1],10),o=t[2],a="statusHeaders";break}case"statusHeaders":""===l.trim()&&(a="body");break;case"body":t.push(204===s?new Response:new Response(l,{status:s,statusText:o})),a="batch"}}if("status"!==a)throw Error("Unexpected end of input");return t}executeImpl(){var e;return A(this,void 0,void 0,(function*(){if(o.write(`[${this.batchId}] (${(new Date).getTime()}) Executing batch with ${this.requests.length} requests.`,1),this.requests.length<1)return void o.write("Resolving empty batch.",1);const t=new $e(this.runtime),r=yield ke(this.url,this.runtime),n=[];let i="";for(let t=0;t<this.requests.length;t++){const s=this.requests[t];"GET"===s.method?(i.length>0&&(n.push(`--changeset_${i}--\n\n`),i=""),n.push(`--batch_${this.batchId}\n`)):(i.length<1&&(i=g(),n.push(`--batch_${this.batchId}\n`),n.push(`Content-Type: multipart/mixed; boundary="changeset_${i}"\n\n`)),n.push(`--changeset_${i}\n`)),n.push("Content-Type: application/http\n"),n.push("Content-Transfer-Encoding: binary\n\n");const a=new Headers,l=b(s.url)?s.url:h(r,s.url);if(o.write(`[${this.batchId}] (${(new Date).getTime()}) Adding request ${s.method} ${l} to batch.`,0),"GET"!==s.method){let e=s.method;const t=s.options.headers;T(s,"options")&&T(s.options,"headers")&&void 0!==t["X-HTTP-Method"]&&(e=t["X-HTTP-Method"],delete t["X-HTTP-Method"]),n.push(`${e} ${l} HTTP/1.1\n`),a.set("Content-Type","application/json;odata=verbose;charset=utf-8")}else n.push(`${s.method} ${l} HTTP/1.1\n`);_(a,null===(e=this.runtime.get("sp"))||void 0===e?void 0:e.headers),s.options&&_(a,s.options.headers),a.has("Accept")||a.append("Accept","application/json"),a.has("Content-Type")||a.append("Content-Type","application/json;odata=verbose;charset=utf-8"),a.has("X-ClientService-ClientTag")||a.append("X-ClientService-ClientTag","PnPCoreJS:@pnp-2.1.0-beta10:batch"),a.forEach(((e,t)=>{n.push(`${t}: ${e}\n`)})),n.push("\n"),s.options.body&&n.push(`${s.options.body}\n\n`)}i.length>0&&(n.push(`--changeset_${i}--\n\n`),i=""),n.push(`--batch_${this.batchId}--\n`);const s={body:n.join(""),headers:{"Content-Type":`multipart/mixed; boundary=batch_${this.batchId}`},method:"POST"};o.write(`[${this.batchId}] (${(new Date).getTime()}) Sending batch request.`,1);const a=yield t.fetch(h(r,"/_api/$batch"),s);if(!a.ok)throw yield me.init(a);const l=yield a.clone().text(),c=at.ParseResponse(l);if(c.length!==this.requests.length)throw Error("Could not properly parse responses to match requests in batch.");return o.write(`[${this.batchId}] (${(new Date).getTime()}) Resolving batched requests.`,1),c.reduce(((e,t,r)=>e.then((()=>A(this,void 0,void 0,(function*(){const e=this.requests[r];o.write(`[${e.id}] (${(new Date).getTime()}) Resolving request in batch ${this.batchId}.`,1);try{e.resolve(yield e.parser.parse(t))}catch(t){e.reject(t)}}))))),Promise.resolve(void 0))}))}}const lt="00000000-0000-0000-0000-000000000000";function ct(e,t=B){t.assign(e)}F((e=>{const t=e.get("sp"),r=Object.assign({},{fetchClientFactory:()=>new N},t);e.assign({sp:r})}));class ut{constructor(e={},t="",r=B){this._options=e,this._baseUrl=t,this._runtime=r}configure(e,t=""){return new ut(e,t)}setup(e){e.pageContext?ct({spfxContext:e},this._runtime):ct(e,this._runtime)}createIsolated(e){return A(this,void 0,void 0,(function*(){e=Object.assign({baseUrl:"",cloneGlobal:!0,config:{},options:{}},e||{});const{baseUrl:t,cloneGlobal:r,options:n,config:i}=e,s=r?new L(B.export()):new L;return s.assign(i),new ut(n,t,s)}))}childConfigHook(e){return e({options:this._options,baseUrl:this._baseUrl,runtime:this._runtime})}}function dt(e){return S(e)?"":/!(@.*?)::(.*?)/gi.test(e)?e.replace(/!(@.*?)::(.*)$/gi,((e,t,r)=>(o.write(`Rewriting aliased parameter from match ${e} to label: ${t} value: ${r}`,0),`!${t}::${encodeURIComponent(r.replace(/'/gi,"''"))}`))):encodeURIComponent(e.replace(/'/gi,"''"))}new ut;let ht=class extends Je{get rootWeb(){return Be.configure(mt(this,"rootweb"),"si.rootWeb")}getChanges(e){const t=Re({query:v(Fe("SP.ChangeQuery"),e)});return qe(this.clone(mt,"getchanges"),t)}openWebById(e){return A(this,void 0,void 0,(function*(){const t=yield qe(this.clone(pt,`openWebById('${e}')`));return{data:t,web:mt(Le(rt(t)))}}))}getRootWeb(){return A(this,void 0,void 0,(function*(){const e=yield this.rootWeb.select("Url")();return Be.configure(mt(e.Url),"si.getRootWeb")}))}getContextInfo(){return A(this,void 0,void 0,(function*(){const e=Be.configure(pt(this.parentUrl,"_api/contextinfo"),"si.getContextInfo"),t=yield qe(e);if(T(t,"GetContextWebInformation")){const e=t.GetContextWebInformation;return e.SupportedSchemaVersions=e.SupportedSchemaVersions.results,e}return t}))}createBatch(){return new at(this.parentUrl,this.getRuntime())}delete(){return A(this,void 0,void 0,(function*(){const e=yield this.clone(pt,"").select("Id")(),t=Be.configure(pt(this.parentUrl,"_api/SPSiteManager/Delete"),"si.delete");yield qe(t,Re({siteId:e.Id}))}))}getDocumentLibraries(e){return A(this,void 0,void 0,(function*(){const t=Be.configure(Ke("","_api/sp.web.getdocumentlibraries(@v)"),"si.getDocumentLibraries");t.query.set("@v",`'${dt(e)}'`);const r=yield t();return T(r,"GetDocumentLibraries")?r.GetDocumentLibraries:r}))}getWebUrlFromPageUrl(e){return A(this,void 0,void 0,(function*(){const t=Be.configure(Ke("","_api/sp.web.getweburlfrompageurl(@v)"),"si.getWebUrlFromPageUrl");t.query.set("@v",`'${dt(e)}'`);const r=yield t();return T(r,"GetWebUrlFromPageUrl")?r.GetWebUrlFromPageUrl:r}))}createCommunicationSite(e,t=1033,r=!1,n,i,s,o,a,l){return A(this,void 0,void 0,(function*(){return this.createCommunicationSiteFromProps({Classification:s,Description:i,HubSiteId:a,Lcid:t,Owner:l,ShareByEmailEnabled:r,SiteDesignId:o,Title:e,Url:n})}))}createCommunicationSiteFromProps(e){return A(this,void 0,void 0,(function*(){const t=Object.assign({},{Classification:"",Description:"",HubSiteId:lt,Lcid:1033,ShareByEmailEnabled:!1,SiteDesignId:lt,WebTemplate:"SITEPAGEPUBLISHING#0",WebTemplateExtensionId:lt},e),r=Re({request:v(Fe("Microsoft.SharePoint.Portal.SPSiteCreationRequest"),t)});return qe(pt(Le(this.toUrl()),"/_api/SPSiteManager/Create"),r)}))}exists(e){return A(this,void 0,void 0,(function*(){const t=Re({url:e});return yield qe(pt(Le(this.toUrl()),"/_api/SP.Site.Exists"),t)}))}createModernTeamSite(e,t,r,n,i,s,o,a,l){return A(this,void 0,void 0,(function*(){return this.createModernTeamSiteFromProps({alias:t,classification:s,description:i,displayName:e,hubSiteId:a,isPublic:r,lcid:n,owners:o,siteDesignId:l})}))}createModernTeamSiteFromProps(e){return A(this,void 0,void 0,(function*(){const t=Object.assign({},{classification:"",description:"",hubSiteId:lt,isPublic:!0,lcid:1033,owners:[]},e),r={alias:t.alias,displayName:t.displayName,isPublic:t.isPublic,optionalParams:{Classification:t.classification,CreationOptions:{results:[`SPSiteLanguage:${t.lcid}`,`HubSiteId:${t.hubSiteId}`]},Description:t.description,Owners:{results:t.owners}}};return t.siteDesignId&&r.optionalParams.CreationOptions.results.push(`implicit_formula_292aa8a00786498a87a5ca52d9f4214a_${t.siteDesignId}`),qe(pt(Le(this.toUrl()),"/_api/GroupSiteManager/CreateGroupEx"),Re(r))}))}};$([Be("si.getChanges")],ht.prototype,"getChanges",null),$([Be("si.openWebById")],ht.prototype,"openWebById",null),ht=$([tt("_api/site")],ht);const pt=Ge(ht);Reflect.defineProperty(ut.prototype,"site",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>pt(t).configure(e).setRuntime(r)))}});let gt=class extends Qe{add(e,t,r="",n="STS",i=1033,s=!0){return A(this,void 0,void 0,(function*(){const o=Re({parameters:v(Fe("SP.WebCreationInformation"),{Description:r,Language:i,Title:e,Url:t,UseSamePermissionsAsParentSite:s,WebTemplate:n})}),a=yield qe(this.clone(yt,"add"),o);return{data:a,web:mt(rt(a).replace(/_api\/web\/?/i,""))}}))}};$([Be("ws.add")],gt.prototype,"add",null),gt=$([tt("webs")],gt);const yt=Ge(gt);let ft=class extends Je{constructor(){super(...arguments),this.delete=Ze("w")}get webs(){return yt(this)}get allProperties(){return Be.configure(this.clone(Ye,"allproperties"),"w.allprops")}get webinfos(){return Be.configure(Xe(this,"webinfos"),"w.webinfos")}getParentWeb(){return A(this,void 0,void 0,(function*(){const{ParentWeb:e}=yield Me(this.select("ParentWeb/Id").expand("ParentWeb"));return(null==e?void 0:e.Id)?pt(this.parentUrl).openWebById(e.Id):null}))}update(e){return A(this,void 0,void 0,(function*(){const t=Re(v(Fe("SP.Web"),e),De({"X-HTTP-Method":"MERGE"}));return{data:yield qe(this,t),web:this}}))}applyTheme(e,t,r,n){const i=Re({backgroundImageUrl:r,colorPaletteUrl:e,fontSchemeUrl:t,shareGenerated:n});return qe(this.clone(mt,"applytheme"),i)}applyWebTemplate(e){const t=this.clone(mt,"applywebtemplate");return t.concat(`(webTemplate='${dt(e)}')`),qe(t)}getChanges(e){const t=Re({query:v(Fe("SP.ChangeQuery"),e)});return qe(this.clone(mt,"getchanges"),t)}mapToIcon(e,t=0,r=""){return Me(this.clone(mt,`maptoicon(filename='${dt(e)}', progid='${dt(r)}', size=${t})`))}getStorageEntity(e){return Me(this.clone(mt,`getStorageEntity('${dt(e)}')`))}setStorageEntity(e,t,r="",n=""){return qe(this.clone(mt,"setStorageEntity"),Re({comments:n,description:r,key:e,value:t}))}removeStorageEntity(e){return qe(this.clone(mt,`removeStorageEntity('${dt(e)}')`))}getSubwebsFilteredForCurrentUser(e=-1,t=-1){const r=this.clone(yt,`getSubwebsFilteredForCurrentUser(nWebTemplateFilter=${e},nConfigurationFilter=${t})`);return Be.configure(r,"w.getSubwebsFilteredForCurrentUser")}createBatch(){return new at(this.parentUrl,this.getRuntime())}availableWebTemplates(e=1033,t=!0){const r=`getavailablewebtemplates(lcid=${e}, doincludecrosslanguage=${t})`;return Be.configure(Xe(this,r),"w.availableWebTemplates")}};$([Be("w.getParentWeb")],ft.prototype,"getParentWeb",null),$([Be("w.update")],ft.prototype,"update",null),$([Be("w.applyTheme")],ft.prototype,"applyTheme",null),$([Be("w.applyWebTemplate")],ft.prototype,"applyWebTemplate",null),$([Be("w.getChanges")],ft.prototype,"getChanges",null),$([Be("w.mapToIcon")],ft.prototype,"mapToIcon",null),$([Be("w.getStorageEntity")],ft.prototype,"getStorageEntity",null),$([Be("w.setStorageEntity")],ft.prototype,"setStorageEntity",null),$([Be("w.removeStorageEntity")],ft.prototype,"removeStorageEntity",null),ft=$([tt("_api/web")],ft);const mt=Ge(ft);function vt(e){return{DecodedUrl:e,__metadata:{type:"SP.ResourcePath"}}}let bt=class extends Qe{getById(e){return Be.configure(It(this).concat(`('${e}')`),"ls.getById")}getByTitle(e){return Be.configure(It(this,`getByTitle('${dt(e)}')`),"ls.getByTitle")}add(e,t="",r=100,n=!1,i={}){return A(this,void 0,void 0,(function*(){const s=Object.assign({AllowContentTypes:n,BaseTemplate:r,ContentTypesEnabled:n,Description:t,Title:e},Fe("SP.List"),i);return{data:yield qe(this,Re(s)),list:this.getByTitle(s.Title)}}))}ensure(e,t="",r=100,n=!1,i={}){return A(this,void 0,void 0,(function*(){if(this.hasBatch)throw Error("The ensure list method is not supported for use in a batch.");const s=v(i,{Title:e,Description:t,ContentTypesEnabled:n},!0),o=this.getByTitle(s.Title);try{return yield o.select("Title")(),{created:!1,data:yield o.update(s).then((e=>e.data)),list:this.getByTitle(s.Title)}}catch(i){return{created:!0,data:yield this.add(e,t,r,n,s).then((e=>e.data)),list:this.getByTitle(s.Title)}}}))}ensureSiteAssetsLibrary(){return A(this,void 0,void 0,(function*(){const e=yield qe(this.clone(St,"ensuresiteassetslibrary"));return It(rt(e))}))}ensureSitePagesLibrary(){return A(this,void 0,void 0,(function*(){const e=yield qe(this.clone(St,"ensuresitepageslibrary"));return It(rt(e))}))}};$([Be("ls.add")],bt.prototype,"add",null),$([Be("ls.ensure")],bt.prototype,"ensure",null),$([Be("ls.ensureSiteAssetsLibrary")],bt.prototype,"ensureSiteAssetsLibrary",null),$([Be("ls.ensureSitePagesLibrary")],bt.prototype,"ensureSitePagesLibrary",null),bt=$([tt("lists")],bt);const St=Ge(bt);class Pt extends Je{constructor(){super(...arguments),this.delete=et("l")}get effectiveBasePermissions(){return Be.configure(Ke(this,"EffectiveBasePermissions"),"l.effectiveBasePermissions")}get eventReceivers(){return Be.configure(Xe(this,"EventReceivers"),"l.eventReceivers")}get relatedFields(){return Be.configure(Ke(this,"getRelatedFields"),"l.relatedFields")}get informationRightsManagementSettings(){return Be.configure(Ke(this,"InformationRightsManagementSettings"),"l.informationRightsManagementSettings")}update(e,t="*"){return A(this,void 0,void 0,(function*(){const r=Re(v(Fe("SP.List"),e),De({"IF-Match":t,"X-HTTP-Method":"MERGE"}));return{data:yield qe(this,r),list:T(e,"Title")?this.getParent(It,this.parentUrl,`getByTitle('${e.Title}')`):It(this)}}))}getChanges(e){return qe(this.clone(It,"getchanges"),Re({query:v(Fe("SP.ChangeQuery"),e)}))}getItemsByCAMLQuery(e,...t){const r=this.clone(It,"getitems");return qe(r.expand(...t),Re({query:v(Fe("SP.CamlQuery"),e)}))}getListItemChangesSinceToken(e){const t=this.clone(It,"getlistitemchangessincetoken").usingParser({parse:e=>e.text()});return qe(t,Re({query:v(Fe("SP.ChangeLogItemQuery"),e)}))}recycle(){return A(this,void 0,void 0,(function*(){const e=yield qe(this.clone(It,"recycle"));return T(e,"Recycle")?e.Recycle:e}))}renderListData(e){return A(this,void 0,void 0,(function*(){const t=this.clone(It,"renderlistdata(@viewXml)");t.query.set("@viewXml",`'${e}'`);const r=yield qe(t);return JSON.parse(T(r,"RenderListData")?r.RenderListData:r)}))}renderListDataAsStream(e,t=null,r=new Map){T(e,"RenderOptions")&&m(e.RenderOptions)&&(e.RenderOptions=e.RenderOptions.reduce(((e,t)=>e+t)));let n={parameters:v(Fe("SP.RenderListDataParameters"),e)};f(t)&&(n=v(n,{overrideParameters:v(Fe("SP.RenderListDataOverrideParameters"),t)}));const i=this.clone(It,"RenderListDataAsStream",!0,!0);return r&&r.size>0&&r.forEach(((e,t)=>i.query.set(t,e))),qe(i,Re(n))}renderListFormData(e,t,r){return A(this,void 0,void 0,(function*(){const n=yield qe(this.clone(It,`renderlistformdata(itemid=${e}, formid='${t}', mode='${r}')`));return JSON.parse(T(n,"RenderListFormData")?n.RenderListFormData:n)}))}reserveListItemId(){return A(this,void 0,void 0,(function*(){const e=yield qe(this.clone(It,"reservelistitemid"));return T(e,"ReserveListItemId")?e.ReserveListItemId:e}))}getListItemEntityTypeFullName(){return this.clone(It,null,!1).select("ListItemEntityTypeFullName").get().then((e=>e.ListItemEntityTypeFullName))}addValidateUpdateItemUsingPath(e,t,r=!1,n,i){return A(this,void 0,void 0,(function*(){const s={FolderPath:vt(t)};f(i)&&(i.leafName&&(s.LeafName=vt(i.leafName)),i.objectType&&(s.UnderlyingObjectType=i.objectType));const o=yield qe(this.clone(It,"AddValidateUpdateItemUsingPath()"),Re({bNewDocumentUpdate:r,checkInComment:n,formValues:e,listItemCreateInfo:v(Fe("SP.ListItemCreationInformationUsingPath"),s)}));return T(o,"AddValidateUpdateItemUsingPath")?o.AddValidateUpdateItemUsingPath:o}))}getParentInfos(){return A(this,void 0,void 0,(function*(){const e=yield this.select("Id","RootFolder/UniqueId","RootFolder/ServerRelativeUrl","RootFolder/ServerRelativePath","ParentWeb/Id","ParentWeb/Url","ParentWeb/ServerRelativeUrl","ParentWeb/ServerRelativePath").expand("RootFolder","ParentWeb")();return{List:{Id:e.Id,RootFolderServerRelativePath:e.RootFolder.ServerRelativePath,RootFolderServerRelativeUrl:e.RootFolder.ServerRelativeUrl,RootFolderUniqueId:e.RootFolder.UniqueId},ParentWeb:{Id:e.ParentWeb.Id,ServerRelativePath:e.ParentWeb.ServerRelativePath,ServerRelativeUrl:e.ParentWeb.ServerRelativeUrl,Url:e.ParentWeb.Url}}}))}}$([Be("l.update")],Pt.prototype,"update",null),$([Be("l.getChanges")],Pt.prototype,"getChanges",null),$([Be("l.CAMLQuery")],Pt.prototype,"getItemsByCAMLQuery",null),$([Be("l.ChangesSinceToken")],Pt.prototype,"getListItemChangesSinceToken",null),$([Be("l.recycle")],Pt.prototype,"recycle",null),$([Be("l.renderListData")],Pt.prototype,"renderListData",null),$([Be("l.AsStream")],Pt.prototype,"renderListDataAsStream",null),$([Be("l.renderListFormData")],Pt.prototype,"renderListFormData",null),$([Be("l.reserveListItemId")],Pt.prototype,"reserveListItemId",null),$([Be("l.getListItemEntityTypeFullName")],Pt.prototype,"getListItemEntityTypeFullName",null),$([Be("l.addValidateUpdateItemUsingPath")],Pt.prototype,"addValidateUpdateItemUsingPath",null);const It=Ge(Pt);var Tt,wt;!function(e){e[e.None=0]="None",e[e.ContextInfo=1]="ContextInfo",e[e.ListData=2]="ListData",e[e.ListSchema=4]="ListSchema",e[e.MenuView=8]="MenuView",e[e.ListContentType=16]="ListContentType",e[e.FileSystemItemId=32]="FileSystemItemId",e[e.ClientFormSchema=64]="ClientFormSchema",e[e.QuickLaunch=128]="QuickLaunch",e[e.Spotlight=256]="Spotlight",e[e.Visualization=512]="Visualization",e[e.ViewMetadata=1024]="ViewMetadata",e[e.DisableAutoHyperlink=2048]="DisableAutoHyperlink",e[e.EnableMediaTAUrls=4096]="EnableMediaTAUrls",e[e.ParentInfo=8192]="ParentInfo",e[e.PageContextInfo=16384]="PageContextInfo",e[e.ClientSideComponentManifest=32768]="ClientSideComponentManifest"}(Tt||(Tt={})),function(e){e[e.Display=1]="Display",e[e.Edit=2]="Edit",e[e.New=3]="New"}(wt||(wt={})),X(ft,"lists",St),X(ft,"siteUserInfoList",It,"siteuserinfolist"),X(ft,"defaultDocumentLibrary",It,"DefaultDocumentLibrary"),X(ft,"customListTemplates",Xe,"getcustomlisttemplates"),ft.prototype.getList=function(e){return It(this,`getList('${dt(e)}')`)},ft.prototype.getCatalog=function(e){return A(this,void 0,void 0,(function*(){const t=yield this.clone(mt,`getcatalog(${e})`).select("Id").get();return It(rt(t))}))};let Ct=class extends Qe{getById(e){return Be.configure(Rt(this).concat(`(${e})`),"is.getById")}getItemByStringId(e){return Be.configure(Rt(this.parentUrl,`getItemByStringId('${e}')`),"is.getItemByStringId")}skip(e,t=!1){return t?this.query.set("$skiptoken",encodeURIComponent(`Paged=TRUE&PagedPrev=TRUE&p_ID=${e}`)):this.query.set("$skiptoken",encodeURIComponent(`Paged=TRUE&p_ID=${e}`)),this}getPaged(){return this.usingParser(new $t(this))()}getAll(e=2e3,t="application/json;odata=nometadata"){o.write("Calling items.getAll should be done sparingly. Ensure this is the correct choice. If you are unsure, it is not.",2);const r=xt(this,"").top(e).configure({headers:{Accept:t}});return this.query.forEach(((e,t)=>{/^\$select|filter|top|expand$/i.test(t)&&r.query.set(t,e)})),new Promise(((e,t)=>{const n=[],i=r=>{[].push.apply(n,r.results),r.hasNext?r.getNext().then(i).catch(t):e(n)};r.getPaged().then(i).catch(t)}))}add(e={},t=null){return A(this,void 0,void 0,(function*(){const r=this.addBatchDependency(),n=Re(v(Fe(yield this.ensureListItemEntityTypeName(t)),e)),i=qe(this.clone(xt,""),n).then((e=>({data:e,item:this.getById(e.Id)})));return r(),i}))}ensureListItemEntityTypeName(e){return e?Promise.resolve(e):this.getParent(It).getListItemEntityTypeFullName()}};$([Be("is.getPaged")],Ct.prototype,"getPaged",null),$([Be("is.getAll")],Ct.prototype,"getAll",null),$([Be("is.add")],Ct.prototype,"add",null),Ct=$([tt("items")],Ct);const xt=Ge(Ct);class Ut extends Je{constructor(){super(...arguments),this.delete=et("i")}get effectiveBasePermissions(){return Be.configure(Ke(this,"EffectiveBasePermissions"),"i.effectiveBasePermissions")}get effectiveBasePermissionsForUI(){return Be.configure(Ke(this,"EffectiveBasePermissionsForUI"),"i.effectiveBasePermissionsForUI")}get fieldValuesAsHTML(){return Be.configure(Ye(this,"FieldValuesAsHTML"),"i.fvHTML")}get fieldValuesAsText(){return Be.configure(Ye(this,"FieldValuesAsText"),"i.fvText")}get fieldValuesForEdit(){return Be.configure(Ye(this,"FieldValuesForEdit"),"i.fvEdit")}get versions(){return Be.configure(Ft(this),"i.versions")}get list(){return this.getParent(It,this.parentUrl.substr(0,this.parentUrl.lastIndexOf("/")))}update(e,t="*",r=null){return A(this,void 0,void 0,(function*(){const n=this.addBatchDependency(),i=Re(v(Fe(yield this.ensureListItemEntityTypeName(r)),e),De({"IF-Match":t,"X-HTTP-Method":"MERGE"}));n();const s=Be.configure(this.clone(Rt).usingParser(new At),"i.update");return{data:yield qe(s,i),item:this}}))}recycle(){return qe(this.clone(Rt,"recycle"))}deleteWithParams(e){return A(this,void 0,void 0,(function*(){return qe(this.clone(Rt,"DeleteWithParameters"),Re({parameters:e}))}))}getWopiFrameUrl(e=0){return A(this,void 0,void 0,(function*(){const t=this.clone(Rt,"getWOPIFrameUrl(@action)");t.query.set("@action",e);const r=yield qe(t);return T(r,"GetWOPIFrameUrl")?r.GetWOPIFrameUrl:r}))}validateUpdateListItem(e,t=!1){return qe(this.clone(Rt,"validateupdatelistitem"),Re({formValues:e,bNewDocumentUpdate:t}))}getParentInfos(){return A(this,void 0,void 0,(function*(){const e=yield this.select("Id","ParentList/Id","ParentList/RootFolder/UniqueId","ParentList/RootFolder/ServerRelativeUrl","ParentList/RootFolder/ServerRelativePath","ParentList/ParentWeb/Id","ParentList/ParentWeb/Url","ParentList/ParentWeb/ServerRelativeUrl","ParentList/ParentWeb/ServerRelativePath").expand("ParentList","ParentList/RootFolder","ParentList/ParentWeb")();return{Item:{Id:e.Id},ParentList:{Id:e.ParentList.Id,RootFolderServerRelativePath:e.ParentList.RootFolder.ServerRelativePath,RootFolderServerRelativeUrl:e.ParentList.RootFolder.ServerRelativeUrl,RootFolderUniqueId:e.ParentList.RootFolder.UniqueId},ParentWeb:{Id:e.ParentList.ParentWeb.Id,ServerRelativePath:e.ParentList.ParentWeb.ServerRelativePath,ServerRelativeUrl:e.ParentList.ParentWeb.ServerRelativeUrl,Url:e.ParentList.ParentWeb.Url}}}))}ensureListItemEntityTypeName(e){return e?Promise.resolve(e):this.list.getListItemEntityTypeFullName()}}$([Be("i.recycle")],Ut.prototype,"recycle",null),$([Be("i.del-params")],Ut.prototype,"deleteWithParams",null),$([Be("i.getWopiFrameUrl")],Ut.prototype,"getWopiFrameUrl",null),$([Be("i.validateUpdateListItem")],Ut.prototype,"validateUpdateListItem",null);const Rt=Ge(Ut);let Dt=class extends Qe{getById(e){return Be.configure(Lt(this).concat(`(${e})`),"iv.getById")}};Dt=$([tt("versions")],Dt);const Ft=Ge(Dt),Lt=Ge(class extends Je{constructor(){super(...arguments),this.delete=et("iv")}});class Bt{constructor(e,t,r){this.parent=e,this.nextUrl=t,this.results=r}get hasNext(){return"string"==typeof this.nextUrl&&this.nextUrl.length>0}getNext(){return this.hasNext?Be.configure(xt(this.nextUrl,null).configureFrom(this.parent),"ip.getNext").getPaged():new Promise((e=>e(null)))}}class $t extends de{constructor(e){super(),this._parent=e}parse(e){return new Promise(((t,r)=>{this.handleError(e,r)&&e.json().then((e=>{const r=T(e,"d")&&T(e.d,"__next")?e.d.__next:e["odata.nextLink"];t(new Bt(this._parent,r,this.parseODataJSON(e)))}))}))}}class At extends de{parse(e){return new Promise(((t,r)=>{this.handleError(e,r)&&t({"odata.etag":e.headers.get("etag")})}))}}X(Pt,"items",xt);class kt{constructor(e,t="config",r="Title",n="Value"){this.web=e,this.listTitle=t,this.keyFieldName=r,this.valueFieldName=n}getConfiguration(){return this.web.lists.getByTitle(this.listTitle).items.select(this.keyFieldName,this.valueFieldName)().then((e=>e.reduce(((e,t)=>(e[t[this.keyFieldName]]=t[this.valueFieldName],e)),{})))}asCaching(e=`pnp_configcache_splist_${this.web.toUrl()}+${this.listTitle}`){return new G(this,e)}}var _t,Ot,Et;function Nt(e){return v(Fe("Collection(SP.KeyValue)"),{results:Object.keys(e).map((t=>v(Fe("SP.KeyValue"),{Key:t,Value:Reflect.get(e,t),ValueType:"Edm.String"})))})}!function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.DistributionList=2]="DistributionList",e[e.SecurityGroup=4]="SecurityGroup",e[e.SharePointGroup=8]="SharePointGroup",e[e.All=15]="All"}(_t||(_t={})),function(e){e[e.None=0]="None",e[e.UserInfoList=1]="UserInfoList",e[e.Windows=2]="Windows",e[e.MembershipProvider=4]="MembershipProvider",e[e.RoleProvider=8]="RoleProvider",e[e.All=15]="All"}(Ot||(Ot={})),function(e){e[e.Invalid=-1]="Invalid",e[e.DefaultView=0]="DefaultView",e[e.NormalView=1]="NormalView",e[e.DialogView=2]="DialogView",e[e.View=3]="View",e[e.DisplayForm=4]="DisplayForm",e[e.DisplayFormDialog=5]="DisplayFormDialog",e[e.EditForm=6]="EditForm",e[e.EditFormDialog=7]="EditFormDialog",e[e.NewForm=8]="NewForm",e[e.NewFormDialog=9]="NewFormDialog",e[e.SolutionForm=10]="SolutionForm",e[e.PAGE_MAXITEMS=11]="PAGE_MAXITEMS"}(Et||(Et={}));const Mt=/["*:<>?/\\|\x00-\x1f\x7f-\x9f]/g,qt=/["#%*:<>?/\\|\x00-\x1f\x7f-\x9f]/g;function jt(e,t=!1){return t?qt.test(e):Mt.test(e)}function Wt(e,t="",r=!1){return r?e.replace(qt,t):e.replace(Mt,t)}Reflect.defineProperty(ut.prototype,"web",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>mt(t).configure(e).setRuntime(r)))}}),ut.prototype.createBatch=function(){return this.web.createBatch()};const Ht=new class extends ut{crossDomainSite(e,t){return this._cdImpl(pt,e,t,"site")}crossDomainWeb(e,t){return this._cdImpl(mt,e,t,"web")}_cdImpl(e,t,r,n){if(!b(t))throw Error("The addInWebUrl parameter must be an absolute url.");if(!b(r))throw Error("The hostWebUrl parameter must be an absolute url.");const i=e(h(t,"_api/SP.AppContextSite(@target)"),n);return i.query.set("@target","'"+encodeURIComponent(r)+"'"),this.childConfigHook((({options:e,runtime:t})=>i.configure(e).setRuntime(t)))}};function Vt(e,t=B){t.assign(e)}F((e=>{const t=e.get("graph"),r=Object.assign({},{fetchClientFactory:()=>{const t=e.get("spfxContext");if(f(t))return new q(t);throw Error("There is no Graph Client available, either set one using configuraiton or provide a valid SPFx Context.")}},t);e.assign({graph:r})}));class Gt{constructor(...e){e[0]instanceof L?this._runtime=e[0]:(this._runtime=e.length>1&&e[1]instanceof L?e[1]:B,this._impl=e[0]),this._impl=this._runtime.get("graph").fetchClientFactory()}fetch(e,t={}){var r;const n=new Headers;_(n,null===(r=this._runtime.get("graph"))||void 0===r?void 0:r.headers),_(n,t.headers),n.has("Content-Type")||n.append("Content-Type","application/json"),n.has("SdkVersion")||n.append("SdkVersion","PnPCoreJS/2.1.0-beta10");const i=v(t,{headers:n});return this.fetchRaw(e,i)}fetchRaw(e,t={}){const r=new Headers;_(r,t.headers),t=v(t,{headers:r});const n=r=>{this._impl.fetch(e,t).then((e=>r.resolve(e))).catch((e=>{429!==e.status&&503!==e.status&&504!==e.status&&r.reject(e);const t=r.delay;r.delay*=2,r.attempts++,r.retryCount<=r.attempts&&r.reject(e),setTimeout(u(this,n,r),t)}))};return new Promise(((e,t)=>{const r={attempts:0,delay:100,reject:t,resolve:e,retryCount:7};n.call(this,r)}))}get(e,t={}){const r=v(t,{method:"GET"});return this.fetch(e,r)}post(e,t={}){const r=v(t,{method:"POST"});return this.fetch(e,r)}patch(e,t={}){const r=v(t,{method:"PATCH"});return this.fetch(e,r)}delete(e,t={}){const r=v(t,{method:"DELETE"});return this.fetch(e,r)}}function zt(e,t=B){var r,n,i;return A(this,void 0,void 0,(function*(){if(b(e))return e;let s=null===(r=t.get("graph"))||void 0===r?void 0:r.baseUrl;if(!S(s))return h(s,e);const o=t.get("spfxContext");if(f(o))try{const t=yield o.msGraphClientFactory.getClient();if(s=null===(i=null===(n=t)||void 0===n?void 0:n.constructor)||void 0===i?void 0:i._graphBaseUrl,!S(s))return h(s,e)}catch(e){}return h("https://graph.microsoft.com",e)}))}class Kt extends z{constructor(e="v1.0/$batch",t=20,r=B){super(),this.batchUrl=e,this.maxRequests=t,this.runtime=r}setRuntime(e){return this.runtime=e,this}executeImpl(){return A(this,void 0,void 0,(function*(){if(o.write(`[${this.batchId}] (${(new Date).getTime()}) Executing batch with ${this.requests.length} requests.`,1),this.requests.length<1)return o.write("Resolving empty batch.",1),Promise.resolve();const e=new Gt(this.runtime),t=this.requests.slice();for(;t.length>0;){const r=t.splice(0,this.maxRequests),n={body:I({requests:this.formatRequests(r)}),headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"};o.write(`[${this.batchId}] (${(new Date).getTime()}) Sending batch request.`,1);const i=yield zt(this.batchUrl,this.runtime);yield e.fetch(i,n).then((e=>e.json())).then((e=>this.parseResponse(r,e))).then((e=>{o.write(`[${this.batchId}] (${(new Date).getTime()}) Resolving batched requests.`,1),e.responses.reduce(((e,t,n)=>{const i=r[n];return o.write(`[${this.batchId}] (${(new Date).getTime()}) Resolving batched request ${i.method} ${i.url}.`,0),e.then((()=>i.parser.parse(t).then(i.resolve).catch(i.reject)))}),Promise.resolve())})).catch((e=>{throw e}))}}))}makeUrlRelative(e){if(!b(e))return e;let t=e.indexOf("/v1.0/");return t<0?(t=e.indexOf("/beta/"),t>-1?e.substr(t+6):e):e.substr(t+5)}formatRequests(e){return e.map(((e,t)=>{var r;let n={id:""+ ++t,method:e.method,url:this.makeUrlRelative(e.url)},i={};return i=v(i,null===(r=this.runtime.get("graph"))||void 0===r?void 0:r.headers),void 0!==e.options&&(void 0!==e.options.headers&&null!==e.options.headers&&(i=v(i,e.options.headers)),"GET"!==e.method&&(i["Content-Type"]="application/json"),void 0!==e.options.body&&null!==e.options.body&&(n=v(n,{body:JSON.parse(e.options.body)}))),n=v(n,{headers:i}),n}))}parseResponse(e,t){return new Promise(((r,n)=>{if(T(t,"error"))return n(Error(`Error Porcessing Batch: (${t.error.code}) ${t.error.message}`));const i=new Array(e.length).fill(null);for(let e=0;e<t.responses.length;++e){const r=t.responses[e],n=parseInt(r.id,10)-1;204===r.status?i[n]=new Response:i[n]=new Response(JSON.stringify(r.body),r)}r({nextLink:t.nextLink,responses:i})}))}}class Qt{constructor(e={},t="v1.0",r=B){this._options=e,this._baseUrl=t,this._runtime=r}createBatch(){return(new Kt).setRuntime(this._runtime)}setup(e){e.pageContext?Vt({spfxContext:e},this._runtime):Vt(e,this._runtime)}createIsolated(e){return A(this,void 0,void 0,(function*(){e=Object.assign({baseUrl:"v1.0",cloneGlobal:!0,config:{},options:{}},e||{});const{baseUrl:t,cloneGlobal:r,options:n,config:i}=e,s=r?new L(B.export()):new L;return s.assign(i),new Qt(n,t,s)}))}childConfigHook(e){return e({options:this._options,baseUrl:this._baseUrl,runtime:this._runtime})}}const Xt=new Qt;class Jt{static ensure(e,t){const r=[Jt.Beta,Jt.V1];let n=new RegExp(t,"i");const i=r.filter((e=>!n.test(e))).map((e=>e.replace(".","\\.")));return n=new RegExp(`/?(${i.join("|")})/?`,"ig"),e.replace(n,`/${t}/`)}}function Yt(e){er=y(e)?()=>e:Zt}Jt.Beta="beta",Jt.V1="v1.0";const Zt=e=>()=>new Gt(e);let er=Zt;const tr=e=>function(t,r){return A(this,void 0,void 0,(function*(){const n=t.getRuntime(),i=Ue(er(n))(e),s=ve(t.data),o=f(s.batch)?s.batch.addDependency():()=>{},a=yield zt(t.toUrlAndQuery(),n);return O(s.options,r),i(Object.assign({},s,{batchDependency:o,url:a}))}))},rr=(e,t)=>tr("GET")(e,t),nr=(e,t)=>tr("POST")(e,t),ir=(e,t)=>tr("DELETE")(e,t),sr=(e,t)=>tr("PATCH")(e,t),or=(e,t)=>tr("PUT")(e,t),ar=e=>ce(e);class lr extends be{constructor(e,t){let r="",n="";const i=new Map;"string"==typeof e?(n=e,r=h(n,t)):(n=e.toUrl(),r=h(n,t)),super({parentUrl:n,query:i,url:r}),"string"!=typeof e&&this.configureFrom(e)}select(...e){return e.length>0&&this.query.set("$select",e.map(encodeURIComponent).join(",")),this}expand(...e){return e.length>0&&this.query.set("$expand",e.map(encodeURIComponent).join(",")),this}defaultAction(e){return rr(this,e)}get(e){return rr(this,e)}toUrlAndQuery(){let e=this.toUrl();if(this.query.size>0){const t=e.indexOf("?")>-1?"&":"?";e+=`${t}${Array.from(this.query).map((e=>e[0]+"="+e[1])).join("&")}`}return e}setEndpoint(e){return this.data.url=Jt.ensure(this.data.url,e),this}clone(e,t,r=!0,n=!1){return super.cloneTo(e(this,t),{includeBatch:r,includeQuery:n})}getParent(e,t=this.parentUrl,r){return new e(t,r)}}const cr=ar(lr);class ur extends lr{filter(e){return this.query.set("$filter",e),this}orderBy(e,t=!0){const r="$orderby",n=this.query.has(r)?this.query.get(r).split(","):[];return n.push(`${encodeURIComponent(e)} ${t?"asc":"desc"}`),this.query.set(r,n.join(",")),this}top(e){return this.query.set("$top",e.toString()),this}skip(e){return this.query.set("$skip",e.toString()),this}skipToken(e){return this.query.set("$skiptoken",e),this}get count(){return this.query.set("$count","true"),this}}const dr=ar(ur),hr=ar(class extends ur{search(e){return this.query.set("$search",e),this}});class pr extends lr{}const gr=ar(pr);let yr=class extends Qe{getByName(e){if(/%#/.test(e))throw Error("For file names containing % or # please use web.getFileByServerRelativePath");return Be.configure(vr(this).concat(`('${dt(e)}')`),"fis.getByName")}add(e,t,r=!0){return A(this,void 0,void 0,(function*(){return{data:yield qe(fr(this,`add(overwrite=${r},url='${dt(e)}')`),{body:t}),file:this.getByName(e)}}))}addUsingPath(e,t,r={Overwrite:!1}){return A(this,void 0,void 0,(function*(){const n=[`AddUsingPath(decodedurl='${dt(e)}'`];r&&(r.Overwrite&&n.push(",Overwrite=true"),r.AutoCheckoutOnInvalidData&&n.push(",AutoCheckoutOnInvalidData=true"),S(r.XorHash)||n.push(`,XorHash=${dt(r.XorHash)}`)),n.push(")");const i=yield qe(fr(this,n.join("")),{body:t});return{data:i,file:vr(rt(i))}}))}addChunked(e,t,r,n=!0,i=10485760){return A(this,void 0,void 0,(function*(){const s=yield qe(this.clone(fr,`add(overwrite=${n},url='${dt(e)}')`,!1)),o=vr(rt(s));return yield o.setContentChunked(t,r,i)}))}addTemplateFile(e,t){return A(this,void 0,void 0,(function*(){const r=yield qe(this.clone(fr,`addTemplateFile(urloffile='${dt(e)}',templatefiletype=${t})`,!1));return{data:r,file:vr(rt(r))}}))}};$([Be("fis.add")],yr.prototype,"add",null),$([Be("fis.addUsingPath")],yr.prototype,"addUsingPath",null),$([Be("fis.addChunked")],yr.prototype,"addChunked",null),$([Be("fis.addTemplateFile")],yr.prototype,"addTemplateFile",null),yr=$([tt("files")],yr);const fr=Ge(yr);class mr extends Je{constructor(){super(...arguments),this.delete=et("fi")}get listItemAllFields(){return Be.configure(Ye(this,"listItemAllFields"),"fi.listItemAllFields")}get versions(){return Be.configure(Sr(this),"fi.versions")}approve(e=""){return qe(this.clone(vr,`approve(comment='${dt(e)}')`))}cancelUpload(e){return qe(this.clone(vr,`cancelUpload(uploadId=guid'${e}')`,!1))}checkin(e="",t=Ir.Major){if(e.length>1023)throw Error("The maximum comment length is 1023 characters.");return qe(this.clone(vr,`checkin(comment='${dt(e)}',checkintype=${t})`))}checkout(){return qe(this.clone(vr,"checkout"))}copyTo(e,t=!0){return qe(this.clone(vr,`copyTo(strnewurl='${dt(e)}',boverwrite=${t})`))}copyByPath(e,t,r=!1){return A(this,void 0,void 0,(function*(){const{ServerRelativeUrl:n,"odata.id":i}=yield this.select("ServerRelativeUrl")(),s=Le(i),o=s.replace("://","___").split("/")[0].replace("___","://");yield qe(vr(s,`/_api/SP.MoveCopyUtil.CopyFileByPath(overwrite=@a1)?@a1=${t}`),Re({destPath:vt(b(e)?e:`${o}${e}`),options:{KeepBoth:r,ResetAuthorAndCreatedOnCopy:!0,ShouldBypassSharedLocks:!0,__metadata:{type:"SP.MoveCopyOptions"}},srcPath:vt(b(n)?n:`${o}${n}`)}))}))}deny(e=""){if(e.length>1023)throw Error("The maximum comment length is 1023 characters.");return qe(this.clone(vr,`deny(comment='${dt(e)}')`))}moveTo(e,t=Tr.Overwrite){return qe(this.clone(vr,`moveTo(newurl='${dt(e)}',flags=${t})`))}moveByPath(e,t,r=!1){return A(this,void 0,void 0,(function*(){const{ServerRelativeUrl:n,"odata.id":i}=yield this.select("ServerRelativeUrl")(),s=Le(i),o=s.replace("://","___").split("/")[0].replace("___","://");yield qe(vr(s,`/_api/SP.MoveCopyUtil.MoveFileByPath(overwrite=@a1)?@a1=${t}`),Re({destPath:vt(b(e)?e:`${o}${e}`),options:{KeepBoth:r,ResetAuthorAndCreatedOnCopy:!1,ShouldBypassSharedLocks:!0,__metadata:{type:"SP.MoveCopyOptions"}},srcPath:vt(b(n)?n:`${o}${n}`)}))}))}publish(e=""){if(e.length>1023)throw Error("The maximum comment length is 1023 characters.");return qe(this.clone(vr,`publish(comment='${dt(e)}')`))}recycle(){return qe(this.clone(vr,"recycle"))}deleteWithParams(e){return A(this,void 0,void 0,(function*(){return qe(this.clone(vr,"DeleteWithParameters"),Re({parameters:e}))}))}undoCheckout(){return qe(this.clone(vr,"undoCheckout"))}unpublish(e=""){if(e.length>1023)throw Error("The maximum comment length is 1023 characters.");return qe(this.clone(vr,`unpublish(comment='${dt(e)}')`))}exists(){return A(this,void 0,void 0,(function*(){try{return(yield this.clone(vr).select("Exists")()).Exists}catch(e){return!1}}))}getText(){return this.clone(vr,"$value",!1).usingParser(new he)(De({binaryStringResponseBody:"true"}))}getBlob(){return this.clone(vr,"$value",!1).usingParser(new pe)(De({binaryStringResponseBody:"true"}))}getBuffer(){return this.clone(vr,"$value",!1).usingParser(new ye)(De({binaryStringResponseBody:"true"}))}getJSON(){return this.clone(vr,"$value",!1).usingParser(new ge)(De({binaryStringResponseBody:"true"}))}setContent(e){return A(this,void 0,void 0,(function*(){return yield qe(this.clone(vr,"$value",!1),{body:e,headers:{"X-HTTP-Method":"PUT"}}),vr(this)}))}getItem(...e){return A(this,void 0,void 0,(function*(){const t=this.listItemAllFields,r=yield t.select(...e)();return v(Rt(rt(r)),r)}))}setContentChunked(e,t,r=10485760){return A(this,void 0,void 0,(function*(){y(t)||(t=()=>null);const n=e.size,i=parseInt((n/r).toString(),10)+(n%r==0?1:0),s=g();t({uploadId:s,blockNumber:1,chunkSize:r,currentPointer:0,fileSize:n,stage:"starting",totalBlocks:i});let o=yield this.startUpload(s,e.slice(0,r));for(let a=2;a<i;a++)t({uploadId:s,blockNumber:a,chunkSize:r,currentPointer:o,fileSize:n,stage:"continue",totalBlocks:i}),o=yield this.continueUpload(s,o,e.slice(o,o+r));return t({uploadId:s,blockNumber:i,chunkSize:r,currentPointer:o,fileSize:n,stage:"finishing",totalBlocks:i}),this.finishUpload(s,o,e.slice(o))}))}startUpload(e,t){return A(this,void 0,void 0,(function*(){let r=yield qe(this.clone(vr,`startUpload(uploadId=guid'${e}')`,!1),{body:t});return"object"==typeof r&&(r=r.StartUpload),parseFloat(r)}))}continueUpload(e,t,r){return A(this,void 0,void 0,(function*(){let n=yield qe(this.clone(vr,`continueUpload(uploadId=guid'${e}',fileOffset=${t})`,!1),{body:r});return"object"==typeof n&&(n=n.ContinueUpload),parseFloat(n)}))}finishUpload(e,t,r){return A(this,void 0,void 0,(function*(){const n=yield qe(this.clone(vr,`finishUpload(uploadId=guid'${e}',fileOffset=${t})`,!1),{body:r});return{data:n,file:vr(rt(n))}}))}}$([Be("fi.approve")],mr.prototype,"approve",null),$([Be("fi.cancelUpload")],mr.prototype,"cancelUpload",null),$([Be("fi.checkin")],mr.prototype,"checkin",null),$([Be("fi.checkout")],mr.prototype,"checkout",null),$([Be("fi.copyTo")],mr.prototype,"copyTo",null),$([Be("fi.copyByPath")],mr.prototype,"copyByPath",null),$([Be("fi.deny")],mr.prototype,"deny",null),$([Be("fi.moveTo")],mr.prototype,"moveTo",null),$([Be("fi.moveByPath")],mr.prototype,"moveByPath",null),$([Be("fi.publish")],mr.prototype,"publish",null),$([Be("fi.recycle")],mr.prototype,"recycle",null),$([Be("fi.del-params")],mr.prototype,"deleteWithParams",null),$([Be("fi.undoCheckout")],mr.prototype,"undoCheckout",null),$([Be("fi.unpublish")],mr.prototype,"unpublish",null),$([Be("fi.exists")],mr.prototype,"exists",null),$([Be("fi.getText")],mr.prototype,"getText",null),$([Be("fi.getBlob")],mr.prototype,"getBlob",null),$([Be("fi.getBuffer")],mr.prototype,"getBuffer",null),$([Be("fi.getJSON")],mr.prototype,"getJSON",null),$([Be("fi.setContent")],mr.prototype,"setContent",null),$([Be("fi.getItem")],mr.prototype,"getItem",null),$([Be("fi.startUpload")],mr.prototype,"startUpload",null),$([Be("fi.continueUpload")],mr.prototype,"continueUpload",null),$([Be("fi.finishUpload")],mr.prototype,"finishUpload",null);const vr=Ge(mr);let br=class extends Qe{getById(e){return Be.configure(Pr(this).concat(`(${e})`),"vers.getById")}deleteAll(){return qe(Sr(this,"deleteAll"))}deleteById(e){return qe(this.clone(Sr,`deleteById(vid=${e})`))}recycleByID(e){return qe(this.clone(Sr,`recycleByID(vid=${e})`))}deleteByLabel(e){return qe(this.clone(Sr,`deleteByLabel(versionlabel='${dt(e)}')`))}recycleByLabel(e){return qe(this.clone(Sr,`recycleByLabel(versionlabel='${dt(e)}')`))}restoreByLabel(e){return qe(this.clone(Sr,`restoreByLabel(versionlabel='${dt(e)}')`))}};$([Be("vers.deleteAll")],br.prototype,"deleteAll",null),$([Be("vers.deleteById")],br.prototype,"deleteById",null),$([Be("vers.recycleByID")],br.prototype,"recycleByID",null),$([Be("vers.deleteByLabel")],br.prototype,"deleteByLabel",null),$([Be("vers.recycleByLabel")],br.prototype,"recycleByLabel",null),$([Be("vers.restoreByLabel")],br.prototype,"restoreByLabel",null),br=$([tt("versions")],br);const Sr=Ge(br),Pr=Ge(class extends Je{constructor(){super(...arguments),this.delete=et("ver")}});var Ir,Tr,wr;!function(e){e[e.Minor=0]="Minor",e[e.Major=1]="Major",e[e.Overwrite=2]="Overwrite"}(Ir||(Ir={})),function(e){e[e.Overwrite=1]="Overwrite",e[e.AllowBrokenThickets=8]="AllowBrokenThickets"}(Tr||(Tr={})),function(e){e[e.StandardPage=0]="StandardPage",e[e.WikiPage=1]="WikiPage",e[e.FormPage=2]="FormPage",e[e.ClientSidePage=3]="ClientSidePage"}(wr||(wr={}));const Cr=Ge(class extends Qe{constructor(e,t="_api/web/tenantappcatalog/AvailableApps"){super(Le("string"==typeof e?e:e.toUrl()),t)}getAppById(e){return Be.configure(Ur(this,`getById('${e}')`),"ac.getAppById")}syncSolutionToTeams(e,t=!1){return A(this,void 0,void 0,(function*(){let r=null;const n=Le(this.toUrl());if(t)r=e;else{const t=mt(n),i=(yield t.lists.select("Id").filter("EntityTypeName eq 'AppCatalog'")())[0].Id,s=yield t.lists.getById(i).items.filter(`AppProductID eq '${e}'`).top(1)();if(!(s&&s.length>0))throw Error(`Did not find the app with id ${e} in the appcatalog.`);r=s[0].Id}const i=Be.configure(Cr(n,`_api/web/tenantappcatalog/SyncSolutionToTeams(id=${r})`),"ac.syncSolutionToTeams");return yield qe(i,{})}))}add(e,t,r=!0){return A(this,void 0,void 0,(function*(){const n=Be.configure(Cr(Le(this.toUrl()),`_api/web/tenantappcatalog/add(overwrite=${r},url='${e}')`),"ac.add"),i=yield qe(n,{body:t,headers:{binaryStringRequestBody:"true"}});return{data:i,file:vr(rt(i))}}))}});class xr extends Je{deploy(e=!1){return this.do(`Deploy(${e})`)}retract(){return this.do("Retract")}install(){return this.do("Install")}uninstall(){return this.do("Uninstall")}upgrade(){return this.do("Upgrade")}remove(){return this.do("Remove")}do(e){return qe(this.clone(Ur,e))}}$([Be("app.deploy")],xr.prototype,"deploy",null),$([Be("app.retract")],xr.prototype,"retract",null),$([Be("app.install")],xr.prototype,"install",null),$([Be("app.uninstall")],xr.prototype,"uninstall",null),$([Be("app.upgrade")],xr.prototype,"upgrade",null),$([Be("app.remove")],xr.prototype,"remove",null);const Ur=Ge(xr);ft.prototype.getAppCatalog=function(e){return Cr(e||this)},ut.prototype.getTenantAppCatalogWeb=function(){return A(this,void 0,void 0,(function*(){return this.childConfigHook((({options:e,runtime:t})=>A(this,void 0,void 0,(function*(){const r=yield Ke("/","_api/SP_TenantSettings_Current").configure(e).setRuntime(t)();return mt(r.CorporateCatalogUrl).configure(e).setRuntime(t)}))))}))};let Rr=class extends Qe{getByName(e){const t=Be.configure(Lr(this),"ats.getByName");return t.concat(`('${e}')`),t}add(e,t){return A(this,void 0,void 0,(function*(){return{data:yield qe(this.clone(Dr,`add(FileName='${e}')`,!1),{body:t}),file:this.getByName(e)}}))}addMultiple(e){return A(this,void 0,void 0,(function*(){for(let t=0;t<e.length;t++)yield this.add(e[t].name,e[t].content)}))}deleteMultiple(...e){return A(this,void 0,void 0,(function*(){for(let t=0;t<e.length;t++)yield this.getByName(e[t]).delete()}))}recycleMultiple(...e){return A(this,void 0,void 0,(function*(){for(let t=0;t<e.length;t++)yield this.getByName(e[t]).recycle()}))}};$([Be("ats.add")],Rr.prototype,"add",null),$([Be("ats.addMultiple")],Rr.prototype,"addMultiple",null),$([Be("ats.deleteMultiple")],Rr.prototype,"deleteMultiple",null),$([Be("ats.recycleMultiple")],Rr.prototype,"recycleMultiple",null),Rr=$([tt("AttachmentFiles")],Rr);const Dr=Ge(Rr);class Fr extends Je{constructor(){super(...arguments),this.delete=et("at")}getText(){return this.getParsed(new he)}getBlob(){return this.getParsed(new pe)}getBuffer(){return this.getParsed(new ye)}getJSON(){return this.getParsed(new ge)}setContent(e){return A(this,void 0,void 0,(function*(){return yield qe(this.clone(Lr,"$value",!1),De({"X-HTTP-Method":"PUT"},{body:e})),Lr(this)}))}recycle(e="*"){return qe(this.clone(Lr,"recycleObject"),De({"IF-Match":e,"X-HTTP-Method":"DELETE"}))}getParsed(e){return this.clone(Lr,"$value",!1).usingParser(e)()}}$([Be("at.getText")],Fr.prototype,"getText",null),$([Be("at.getBlob")],Fr.prototype,"getBlob",null),$([Be("at.getBuffer")],Fr.prototype,"getBuffer",null),$([Be("at.getJSON")],Fr.prototype,"getJSON",null),$([Be("at.setContent")],Fr.prototype,"setContent",null),$([Be("at.recycle")],Fr.prototype,"recycle",null);const Lr=Ge(Fr);function Br(e){return e.length<1?1:Math.max.apply(null,e.map((e=>e.order)))+1}function $r(e){for(let t=0;t<e.length;t++)e[t].order=t+1,T(e[t],"columns")?$r(e[t].columns):T(e[t],"controls")&&$r(e[t].controls)}X(Ut,"attachmentFiles",Dr),ft.prototype.getFileByServerRelativeUrl=function(e){return vr(this,`getFileByServerRelativeUrl('${dt(e)}')`)},ft.prototype.getFileByServerRelativePath=function(e){return vr(this,`getFileByServerRelativePath(decodedUrl='${dt(e)}')`)},ft.prototype.getFileById=function(e){return vr(this,`getFileById('${e}')`)},ft.prototype.getFileByUrl=function(e){return vr(this,`getFileByUrl('!@p1::${dt(e)}')`)};let Ar=class extends Qe{add(e){return A(this,void 0,void 0,(function*(){"string"==typeof e&&(e={text:e});const t=Re(v(Fe("Microsoft.SharePoint.Comments.comment"),e)),r=yield qe(this.clone(kr,null),t);return v(this.getById(r.id),r)}))}getById(e){return Be.configure(Or(this).concat(`(${e})`),"coms.getById")}clear(){return qe(Be.configure(this.clone(kr,"DeleteAll"),"coms.clear"))}};$([Be("coms.add")],Ar.prototype,"add",null),Ar=$([tt("comments")],Ar);const kr=Ge(Ar);class _r extends Je{get replies(){return Be.configure(Nr(this),"com.replies")}like(){return qe(this.clone(Or,"Like"))}unlike(){return qe(this.clone(Or,"Unlike"))}delete(){return qe(this.clone(Or,"DeleteComment"))}}$([Be("com.like")],_r.prototype,"like",null),$([Be("com.unlike")],_r.prototype,"unlike",null),$([Be("com.delete")],_r.prototype,"delete",null);const Or=Ge(_r);let Er=class extends Qe{add(e){return A(this,void 0,void 0,(function*(){"string"==typeof e&&(e={text:e});const t=Re(v(Fe("Microsoft.SharePoint.Comments.comment"),e)),r=yield qe(this.clone(Nr,null),t);return v(Or(rt(r)),r)}))}};$([Be("reps.add")],Er.prototype,"add",null),Er=$([tt("replies")],Er);const Nr=Ge(Er);var Mr;function qr(e,t){return Wr(Le(e.toUrl()),t).configureFrom(e)}X(Ut,"comments",kr),Ut.prototype.getLikedBy=function(){return qe(this.clone(Rt,"likedBy"))},Ut.prototype.like=function(){return qe(this.clone(Rt,"like"))},Ut.prototype.unlike=function(){return qe(this.clone(Rt,"unlike"))},Ut.prototype.getLikedByInformation=function(){return this.clone(Rt,"likedByInformation").expand("likedby")()},function(e){e[e.NotPromoted=0]="NotPromoted",e[e.PromoteOnPublish=1]="PromoteOnPublish",e[e.Promoted=2]="Promoted"}(Mr||(Mr={}));class jr extends ze{constructor(e,t,r,n=!1,i=[],s=!1){super(e,t),this.json=r,this.sections=i,this.commentsDisabled=s,this._bannerImageDirty=!1,this._bannerImageThumbnailUrlDirty=!1,"string"==typeof e?(this.data.parentUrl="",this.data.url=h(Le(e),t)):this.assign(qr(e,null),t),this._pageSettings={controlType:0,pageSettingsSlice:{isDefaultDescription:!0,isDefaultThumbnail:!0}},this._layoutPart=jr.getDefaultLayoutPart(),void 0===r||n||this.fromJSON(r)}static getDefaultLayoutPart(){return{dataVersion:"1.4",description:"Title Region Description",id:"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",instanceId:"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",properties:{authorByline:[],authors:[],layoutType:"FullWidthImage",showPublishDate:!1,showTopicHeader:!1,textAlignment:"Left",title:"",topicHeader:""},reservedHeight:280,serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{},links:{}},title:"Title area"}}get pageLayout(){return this.json.PageLayoutType}set pageLayout(e){this.json.PageLayoutType=e}get bannerImageUrl(){return this.json.BannerImageUrl}set bannerImageUrl(e){this.setBannerImage(e)}get thumbnailUrl(){return this._pageSettings.pageSettingsSlice.isDefaultThumbnail?this.json.BannerImageUrl:this.json.BannerThumbnailUrl}set thumbnailUrl(e){this.json.BannerThumbnailUrl=e,this._bannerImageThumbnailUrlDirty=!0,this._pageSettings.pageSettingsSlice.isDefaultThumbnail=!1}get topicHeader(){return f(this.json.TopicHeader)?this.json.TopicHeader:""}set topicHeader(e){this.json.TopicHeader=e,this._layoutPart.properties.topicHeader=e,S(e)&&(this.showTopicHeader=!1)}get title(){return this._layoutPart.properties.title}set title(e){this.json.Title=e,this._layoutPart.properties.title=e}get reservedHeight(){return this._layoutPart.reservedHeight}set reservedHeight(e){this._layoutPart.reservedHeight=e}get description(){return this.json.Description}set description(e){if(!S(e)&&e.length>255)throw Error("Modern Page description is limited to 255 chars.");this.json.Description=e,T(this._pageSettings,"htmlAttributes")||(this._pageSettings.htmlAttributes=[]),this._pageSettings.htmlAttributes.indexOf("modifiedDescription")<0&&this._pageSettings.htmlAttributes.push("modifiedDescription"),this._pageSettings.pageSettingsSlice.isDefaultDescription=!1}get layoutType(){return this._layoutPart.properties.layoutType}set layoutType(e){this._layoutPart.properties.layoutType=e}get headerTextAlignment(){return this._layoutPart.properties.textAlignment}set headerTextAlignment(e){this._layoutPart.properties.textAlignment=e}get showTopicHeader(){return this._layoutPart.properties.showTopicHeader}set showTopicHeader(e){this._layoutPart.properties.showTopicHeader=e}get showPublishDate(){return this._layoutPart.properties.showPublishDate}set showPublishDate(e){this._layoutPart.properties.showPublishDate=e}get hasVerticalSection(){return this.sections.findIndex((e=>2===e.layoutIndex))>-1}get authorByLine(){return m(this.json.AuthorByline)&&this.json.AuthorByline.length>0?this.json.AuthorByline[0]:null}get verticalSection(){return this.hasVerticalSection?this.addVerticalSection():null}addSection(){const e=new Gr(this,Br(this.sections),1);return this.sections.push(e),e}addVerticalSection(){const e=this.sections.findIndex((e=>2===e.layoutIndex));if(e>-1)return this.sections[e];const t=new Gr(this,Br(this.sections),2);return this.sections.push(t),t}fromJSON(e){this.json=e;const t=JSON.parse(e.CanvasContent1),r=JSON.parse(e.LayoutWebpartsContent);return r&&r.length>0&&(this._layoutPart=r[0]),this.setControls(t),this}load(){return A(this,void 0,void 0,(function*(){const e=yield this.getItem("Id","CommentsDisabled"),t=yield Ke(this,`_api/sitepages/pages(${e.Id})`)();return this.commentsDisabled=e.CommentsDisabled,this.fromJSON(t)}))}save(e=!0){return A(this,void 0,void 0,(function*(){if(null===this.json.Id)throw Error("The id for this page is null. If you want to create a new page, please use ClientSidePage.Create");if(this._bannerImageDirty){const e=this.bannerImageUrl;let t,r;const n=mt(Le(this.toUrl())),i=n.createBatch();n.getFileByServerRelativePath(e.replace(/%20/gi," ")).select("ListId","WebId","UniqueId","Name","SiteId").inBatch(i)().then((e=>t=e)),n.select("Url").inBatch(i)().then((e=>r=e.Url)),yield i.execute();const s=Ke(r,"_layouts/15/getpreview.ashx");s.query.set("guidSite",`${t.SiteId}`),s.query.set("guidWeb",`${t.WebId}`),s.query.set("guidFile",`${t.UniqueId}`),this.bannerImageUrl=s.toUrlAndQuery(),f(this._layoutPart.serverProcessedContent)||(this._layoutPart.serverProcessedContent={}),this._layoutPart.serverProcessedContent.imageSources={imageSource:e},f(this._layoutPart.serverProcessedContent.customMetadata)||(this._layoutPart.serverProcessedContent.customMetadata={}),this._layoutPart.serverProcessedContent.customMetadata.imageSource={listId:t.ListId,siteId:t.SiteId,uniqueId:t.UniqueId,webId:t.WebId},this._layoutPart.properties.webId=t.WebId,this._layoutPart.properties.siteId=t.SiteId,this._layoutPart.properties.listId=t.ListId,this._layoutPart.properties.uniqueId=t.UniqueId}this.json.IsPageCheckedOutToCurrentUser||(yield qe(qr(this,`_api/sitepages/pages(${this.json.Id})/checkoutpage`)));let t=Object.assign(Fe("SP.Publishing.SitePage"),{AuthorByline:this.json.AuthorByline||[],CanvasContent1:this.getCanvasContent1(),Description:this.description,LayoutWebpartsContent:this.getLayoutWebpartsContent(),Title:this.title,TopicHeader:this.topicHeader});(this._bannerImageDirty||this._bannerImageThumbnailUrlDirty)&&(t=v(t,{BannerImageUrl:this._bannerImageThumbnailUrlDirty?this.thumbnailUrl:this.bannerImageUrl}));const r=qr(this,`_api/sitepages/pages(${this.json.Id})/savepage`);yield qe(r,De({"if-match":"*"},Re(t)));let n=!0;return e&&(n=yield qe(qr(this,`_api/sitepages/pages(${this.json.Id})/publish`)),n&&(this.json.IsPageCheckedOutToCurrentUser=!1)),this._bannerImageDirty=!1,this._bannerImageThumbnailUrlDirty=!1,n}))}discardPageCheckout(){return A(this,void 0,void 0,(function*(){if(null===this.json.Id)throw Error("The id for this page is null. If you want to create a new page, please use ClientSidePage.Create");const e=yield qe(qr(this,`_api/sitepages/pages(${this.json.Id})/discardPage`),Re(Fe("SP.Publishing.SitePage")));this.fromJSON(e)}))}promoteToNews(){return A(this,void 0,void 0,(function*(){return this.promoteNewsImpl("promoteToNews")}))}findControlById(e){return this.findControl((t=>t.id===e))}findControl(e){for(let t=0;t<this.sections.length;t++)for(let r=0;r<this.sections[t].columns.length;r++)for(let n=0;n<this.sections[t].columns[r].controls.length;n++)if(e(this.sections[t].columns[r].controls[n]))return this.sections[t].columns[r].controls[n];return null}copy(e,t,r,n=!0,i){return A(this,void 0,void 0,(function*(){const s=yield Vr(e,t,r,this.pageLayout,i);if(s.setControls(this.getControls()),!S(this.json.BannerImageUrl)){const e=new URL(this.json.BannerImageUrl),t=e=>e.replace(/(.{8})(.{4})(.{4})(.{4})(.{12})/g,"$1-$2-$3-$4-$5");if(e.searchParams.has("guidSite")&&e.searchParams.has("guidWeb")&&e.searchParams.has("guidFile")){const r=t(e.searchParams.get("guidSite")),n=t(e.searchParams.get("guidWeb")),i=t(e.searchParams.get("guidFile")),o=pt(Le(this.toUrl()));if((yield o.select("Id")()).Id===r){const e=yield o.openWebById(n),t=yield e.web.getFileById(i).select("ServerRelativeUrl")(),r={};this._layoutPart.properties&&(T(this._layoutPart.properties,"translateX")&&(r.translateX=this._layoutPart.properties.translateX),T(this._layoutPart.properties,"translateY")&&(r.translateY=this._layoutPart.properties.translateY),T(this._layoutPart.properties,"imageSourceType")&&(r.imageSourceType=this._layoutPart.properties.imageSourceType),T(this._layoutPart.properties,"altText")&&(r.altText=this._layoutPart.properties.altText)),s.setBannerImage(t.ServerRelativeUrl,r)}}}return yield s.save(n),s}))}setBannerImage(e,t){b(e)&&(e=e.replace(/^https?:\/\/[a-z0-9.]*?\.[a-z]{2,3}\//i,"/")),this.json.BannerImageUrl=e,this._bannerImageDirty=!0,this._bannerImageThumbnailUrlDirty||(this.thumbnailUrl=e,this._pageSettings.pageSettingsSlice.isDefaultThumbnail=!0),this._layoutPart.properties.imageSourceType=2,f(t)&&(T(t,"translateX")&&(this._layoutPart.properties.translateX=t.translateX),T(t,"translateY")&&(this._layoutPart.properties.translateY=t.translateY),T(t,"imageSourceType")&&(this._layoutPart.properties.imageSourceType=t.imageSourceType),T(t,"altText")&&(this._layoutPart.properties.altText=t.altText))}setBannerImageFromExternalUrl(e,t){return A(this,void 0,void 0,(function*(){const r=new URL(e),n=this.json.FileName.replace(/\.[^/.]+$/,""),i=r.pathname.split(/[\\/]/i).pop(),s=qr(this,"_api/sitepages/AddImageFromExternalUrl");s.query.set("imageFileName",`'${encodeURIComponent(i)}'`),s.query.set("pageName",`'${encodeURIComponent(n)}'`),s.query.set("externalUrl",`'${encodeURIComponent(e)}'`),s.select("ServerRelativeUrl");const o=yield qe(s);this.setBannerImage(o.ServerRelativeUrl,t)}))}setAuthorById(e){return A(this,void 0,void 0,(function*(){const t=yield Xe(Le(this.toUrl()),"/_api/web/siteusers").configureFrom(this).filter(`Id eq ${e}`).select("LoginName")();if(t.length<1)throw Error(`Could not find user with id ${e}.`);return this.setAuthorByLoginName(t[0].LoginName)}))}setAuthorByLoginName(e){return A(this,void 0,void 0,(function*(){const t=yield Xe(Le(this.toUrl()),"/_api/web/siteusers").configureFrom(this).filter(`LoginName eq '${encodeURIComponent(e)}'`).select("UserPrincipalName","Title")();if(t.length<1)throw Error(`Could not find user with login name '${e}'.`);this.json.AuthorByline=[e],this._layoutPart.properties.authorByline=[e],this._layoutPart.properties.authors=[{id:e,name:t[0].Title,role:"",upn:t[0].UserPrincipalName}]}))}getItem(...e){return A(this,void 0,void 0,(function*(){const t=qr(this,"/_api/lists/EnsureClientRenderedSitePagesLibrary").select("EnableModeration","EnableMinorVersions","Id"),r=yield qe(t),n=It(r["odata.id"]).configureFrom(this).items.getById(this.json.Id),i=yield n.select(...e)();return v(Rt(rt(i)).configureFrom(this),i)}))}assign(e,t){this.data.parentUrl=e.data.url,this.data.url=h(this.data.parentUrl,t||""),this.configureFrom(e)}getCanvasContent1(){return JSON.stringify(this.getControls())}getLayoutWebpartsContent(){return this._layoutPart?JSON.stringify([this._layoutPart]):JSON.stringify(null)}setControls(e){if(this.sections=[],e&&e.length){for(let t=0;t<e.length;t++)switch(T(e[t],"controlType")?e[t].controlType:0){case 0:T(e[t],"pageSettingsSlice")?this._pageSettings=e[t]:this.mergeColumnToTree(new zr(e[t]));break;case 3:{const r=new Xr(e[t]);this.mergePartToTree(r,r.data.position);break}case 4:{const r=e[t],n=new Qr(r.innerHTML,r);this.mergePartToTree(n,n.data.position);break}}$r(this.sections)}}getControls(){$r(this.sections);const e=[];return this.sections.forEach((t=>{t.columns.forEach((r=>{r.controls.length<1?e.push({displayMode:r.data.displayMode,emphasis:this.getEmphasisObj(t.emphasis),position:r.data.position}):r.controls.forEach((r=>{r.data.emphasis=this.getEmphasisObj(t.emphasis),e.push(r.data)}))}))})),e.push(this._pageSettings),e}getEmphasisObj(e){return e<1||e>3?{}:{zoneEmphasis:e}}promoteNewsImpl(e){return A(this,void 0,void 0,(function*(){if(null===this.json.Id)throw Error("The id for this page is null.");return S(this.json.VersionInfo.LastVersionCreatedBy)&&new Date(this.json.VersionInfo.LastVersionCreated).getFullYear()<2e3&&(yield this.save(!0)),yield qe(qr(this,`_api/sitepages/pages(${this.json.Id})/${e}`),Re(Fe("SP.Publishing.SitePage")))}))}mergePartToTree(e,t){var r,n,i;let s=null,o=12,a=0,l=0,c=1;t&&(T(t,"zoneIndex")&&(l=t.zoneIndex),T(t,"sectionIndex")&&(a=t.sectionIndex),T(t,"sectionFactor")&&(o=t.sectionFactor),T(t,"layoutIndex")&&(c=t.layoutIndex));const u=null!==(i=null===(n=null===(r=e.data)||void 0===r?void 0:r.emphasis)||void 0===n?void 0:n.zoneEmphasis)&&void 0!==i?i:0,d=this.getOrCreateSection(l,c,u),h=d.columns.filter((e=>e.order===a));s=h.length<1?d.addColumn(o,c):h[0],e.column=s,s.addControl(e)}mergeColumnToTree(e){var t,r;const n=T(e.data,"position")&&T(e.data.position,"zoneIndex")?e.data.position.zoneIndex:0,i=T(e.data,"position")&&T(e.data.position,"layoutIndex")?e.data.position.layoutIndex:1,s=this.getOrCreateSection(n,i,(null===(r=null===(t=e.data)||void 0===t?void 0:t.emphasis)||void 0===r?void 0:r.zoneEmphasis)||0);e.section=s,s.columns.push(e)}getOrCreateSection(e,t,r){let n=null;const i=this.sections.filter((r=>r.order===e&&r.layoutIndex===t));return i.length<1?(n=2===t?this.addVerticalSection():this.addSection(),n.order=e,n.emphasis=r):n=i[0],n}}$([Be("csp.load")],jr.prototype,"load",null),$([Be("csp.save")],jr.prototype,"save",null),$([Be("csp.discardPageCheckout")],jr.prototype,"discardPageCheckout",null),$([Be("csp.promoteToNews")],jr.prototype,"promoteToNews",null),$([Be("csp.copy")],jr.prototype,"copy",null),$([Be("csp.getItem")],jr.prototype,"getItem",null);const Wr=(e,t,r,n=!1,i=[],s=!1)=>ce(jr)(e,t,r,n,i,s),Hr=e=>A(void 0,void 0,void 0,(function*(){const t=yield e.getItem();return Wr(Le(e.toUrl()),"",{Id:t.Id},!0).configureFrom(e).load()})),Vr=(e,t,r,n="Article",i=0)=>A(void 0,void 0,void 0,(function*(){t=t.replace(/\.aspx$/i,"");const s=yield qe(qr(e,"_api/sitepages/pages"),Re(Object.assign(Fe("SP.Publishing.SitePage"),{PageLayoutType:n,PromotedState:i}))),o=Wr(e,"",s);return o.title=t,yield o.save(!1),o.title=r,o}));class Gr{constructor(e,t,r,n=[],i=0){this.page=e,this.columns=n,this._emphasis=i,this._memId=g(),this._order=t,this._layoutIndex=r}get order(){return this._order}set order(e){this._order=e;for(let t=0;t<this.columns.length;t++)this.columns[t].data.position.zoneIndex=e}get layoutIndex(){return this._layoutIndex}set layoutIndex(e){this._layoutIndex=e;for(let t=0;t<this.columns.length;t++)this.columns[t].data.position.layoutIndex=e}get defaultColumn(){return this.columns.length<1&&this.addColumn(12),this.columns[0]}addColumn(e,t=this.layoutIndex){const r=new zr;return r.section=this,r.data.position.zoneIndex=this.order,r.data.position.layoutIndex=t,r.data.position.sectionFactor=e,r.order=Br(this.columns),this.columns.push(r),r}addControl(e){return this.defaultColumn.addControl(e),this}get emphasis(){return this._emphasis}set emphasis(e){this._emphasis=e}remove(){this.page.sections=this.page.sections.filter((e=>e._memId!==this._memId)),$r(this.page.sections)}}class zr{constructor(e=JSON.parse(JSON.stringify(zr.Default)),t=[]){this.json=e,this.controls=t,this._section=null,this._memId=g()}get data(){return this.json}get section(){return this._section}set section(e){this._section=e}get order(){return this.data.position.sectionIndex}set order(e){this.data.position.sectionIndex=e;for(let t=0;t<this.controls.length;t++)this.controls[t].data.position.zoneIndex=this.data.position.zoneIndex,this.controls[t].data.position.layoutIndex=this.data.position.layoutIndex,this.controls[t].data.position.sectionIndex=e}get factor(){return this.data.position.sectionFactor}set factor(e){this.data.position.sectionFactor=e}addControl(e){return e.column=this,this.controls.push(e),this}getControl(e){return this.controls[e]}remove(){this.section.columns=this.section.columns.filter((e=>e._memId!==this._memId)),$r(this.section.columns)}}zr.Default={controlType:0,displayMode:2,emphasis:{},position:{layoutIndex:1,sectionFactor:12,sectionIndex:1,zoneIndex:1}};class Kr{constructor(e){this.json=e}get id(){return this.json.id}get data(){return this.json}get column(){return this._column}set column(e){this._column=e,this.onColumnChange(this._column)}remove(){this.column.controls=this.column.controls.filter((e=>e.id!==this.id)),$r(this.column.controls)}setData(e){this.json=e}}class Qr extends Kr{constructor(e,t=JSON.parse(JSON.stringify(Qr.Default))){S(t.id)&&(t.id=g(),t.anchorComponentId=t.id),super(t),this.text=e}get text(){return this.data.innerHTML}set text(e){this.data.innerHTML=e}get order(){return this.data.position.controlIndex}set order(e){this.data.position.controlIndex=e}onColumnChange(e){this.data.position.sectionFactor=e.factor,this.data.position.controlIndex=Br(e.controls),this.data.position.zoneIndex=e.data.position.zoneIndex,this.data.position.sectionIndex=e.order,this.data.position.layoutIndex=e.data.position.layoutIndex}}Qr.Default={addedFromPersistedData:!1,anchorComponentId:"",controlType:4,displayMode:2,editorType:"CKEditor",emphasis:{},id:"",innerHTML:"",position:{controlIndex:1,layoutIndex:1,sectionFactor:12,sectionIndex:1,zoneIndex:1}};class Xr extends Kr{constructor(e=JSON.parse(JSON.stringify(Xr.Default))){super(e)}static fromComponentDef(e){const t=new Xr;return t.import(e),t}get title(){return this.data.webPartData.title}set title(e){this.data.webPartData.title=e}get description(){return this.data.webPartData.description}set description(e){this.data.webPartData.description=e}get order(){return this.data.position.controlIndex}set order(e){this.data.position.controlIndex=e}get height(){return this.data.reservedHeight}set height(e){this.data.reservedHeight=e}get width(){return this.data.reservedWidth}set width(e){this.data.reservedWidth=e}get dataVersion(){return this.data.webPartData.dataVersion}set dataVersion(e){this.data.webPartData.dataVersion=e}setProperties(e){return this.data.webPartData.properties=v(this.data.webPartData.properties,e),this}getProperties(){return this.data.webPartData.properties}onColumnChange(e){this.data.position.sectionFactor=e.factor,this.data.position.controlIndex=Br(e.controls),this.data.position.zoneIndex=e.data.position.zoneIndex,this.data.position.sectionIndex=e.data.position.sectionIndex,this.data.position.layoutIndex=e.data.position.layoutIndex}import(e){const t=g(),r=e.Id.replace(/^\{|\}$/g,"").toLowerCase(),n=JSON.parse(e.Manifest).preconfiguredEntries[0];this.setData(Object.assign({},this.data,{id:t,webPartData:{dataVersion:"1.0",description:n.description.default,id:r,instanceId:t,properties:n.properties,title:n.title.default},webPartId:r}))}}Xr.Default={addedFromPersistedData:!1,controlType:3,displayMode:2,emphasis:{},id:null,position:{controlIndex:1,layoutIndex:1,sectionFactor:12,sectionIndex:1,zoneIndex:1},reservedHeight:500,reservedWidth:500,webPartData:null,webPartId:null},ft.prototype.getClientsideWebParts=function(){return this.clone(Xe,"GetClientSideWebParts")()},ft.prototype.addClientsidePage=function(e,t=e.replace(/\.[^/.]+$/,""),r,n){return Vr(this,e,t,r,n)},ft.prototype.loadClientsidePage=function(e){return Hr(this.getFileByServerRelativePath(e))};let Jr=class extends Qe{getByName(e){return Be.configure(en(this).concat(`('${dt(e)}')`),"fs.getByName")}add(e){return A(this,void 0,void 0,(function*(){return{data:yield qe(this.clone(Yr,`add('${dt(e)}')`)),folder:this.getByName(e)}}))}addUsingPath(e,t=!1){return A(this,void 0,void 0,(function*(){return{data:yield qe(this.clone(Yr,`addUsingPath(DecodedUrl='${dt(e)}',overwrite=${t})`)),folder:en(Le(this.toUrl()),`_api/web/getFolderByServerRelativePath(decodedUrl='${dt(e)}')`)}}))}};$([Be("fs.add")],Jr.prototype,"add",null),$([Be("fs.addUsingPath")],Jr.prototype,"addUsingPath",null),Jr=$([tt("folders")],Jr);const Yr=Ge(Jr);class Zr extends Je{constructor(){super(...arguments),this.delete=et("f"),this.update=this._update("SP.Folder",(e=>({data:e,folder:this})))}get contentTypeOrder(){return Be.configure(Xe(this,"contentTypeOrder"),"f.contentTypeOrder")}get folders(){return Yr(this)}get listItemAllFields(){return Be.configure(Ye(this,"listItemAllFields"),"f.listItemAllFields")}get parentFolder(){return Be.configure(en(this,"parentFolder"),"f.parentFolder")}get properties(){return Be.configure(Ye(this,"properties"),"f.properties")}get serverRelativeUrl(){return Be.configure(Ke(this,"serverRelativeUrl"),"f.serverRelativeUrl")}get uniqueContentTypeOrder(){return Be.configure(Xe(this,"uniqueContentTypeOrder"),"f.uniqueContentTypeOrder")}recycle(){return qe(this.clone(en,"recycle"))}getItem(...e){return A(this,void 0,void 0,(function*(){const t=yield this.listItemAllFields.select(...e)();return v(Rt(rt(t)),t)}))}moveTo(e){return A(this,void 0,void 0,(function*(){const t=yield this.getParentInfos(),r=new URL(t.ParentWeb.Url);yield qe(en(r.origin,"/_api/SP.MoveCopyUtil.MoveFolder()"),Re({destUrl:b(e)?e:h(r.origin,e),srcUrl:h(r.origin,t.Folder.ServerRelativeUrl)}))}))}moveByPath(e,t=!1){return A(this,void 0,void 0,(function*(){const r=yield this.getParentInfos(),n=new URL(r.ParentWeb.Url);yield qe(en(n.origin,"/_api/SP.MoveCopyUtil.MoveFolderByPath()"),Re({destPath:vt(b(e)?e:h(n.origin,e)),options:{KeepBoth:t,ResetAuthorAndCreatedOnCopy:!0,ShouldBypassSharedLocks:!0,__metadata:{type:"SP.MoveCopyOptions"}},srcPath:vt(h(n.origin,r.Folder.ServerRelativeUrl))}))}))}copyTo(e){return A(this,void 0,void 0,(function*(){const t=yield this.getParentInfos(),r=new URL(t.ParentWeb.Url);yield qe(en(r.origin,"/_api/SP.MoveCopyUtil.CopyFolder()"),Re({destUrl:b(e)?e:h(r.origin,e),srcUrl:h(r.origin,t.Folder.ServerRelativeUrl)}))}))}copyByPath(e,t=!1){return A(this,void 0,void 0,(function*(){const r=yield this.getParentInfos(),n=new URL(r.ParentWeb.Url);yield qe(en(n.origin,"/_api/SP.MoveCopyUtil.CopyFolderByPath()"),Re({destPath:vt(b(e)?e:h(n.origin,e)),options:{KeepBoth:t,ResetAuthorAndCreatedOnCopy:!0,ShouldBypassSharedLocks:!0,__metadata:{type:"SP.MoveCopyOptions"}},srcPath:vt(h(n.origin,r.Folder.ServerRelativeUrl))}))}))}deleteWithParams(e){return A(this,void 0,void 0,(function*(){return qe(this.clone(en,"DeleteWithParameters"),Re({parameters:e}))}))}addSubFolderUsingPath(e){return A(this,void 0,void 0,(function*(){return yield qe(this.clone(en,"AddSubFolderUsingPath"),Re({leafPath:vt(e)})),this.folders.getByName(e)}))}getParentInfos(){return A(this,void 0,void 0,(function*(){const e=yield this.select("ServerRelativeUrl","ListItemAllFields/ParentList/Id","ListItemAllFields/ParentList/RootFolder/UniqueId","ListItemAllFields/ParentList/RootFolder/ServerRelativeUrl","ListItemAllFields/ParentList/RootFolder/ServerRelativePath","ListItemAllFields/ParentList/ParentWeb/Id","ListItemAllFields/ParentList/ParentWeb/Url","ListItemAllFields/ParentList/ParentWeb/ServerRelativeUrl","ListItemAllFields/ParentList/ParentWeb/ServerRelativePath").expand("ListItemAllFields/ParentList","ListItemAllFields/ParentList/RootFolder","ListItemAllFields/ParentList/ParentWeb")();return{Folder:{ServerRelativeUrl:e.ServerRelativeUrl},ParentList:{Id:e.ListItemAllFields.ParentList.Id,RootFolderServerRelativePath:e.ListItemAllFields.ParentList.RootFolder.ServerRelativePath,RootFolderServerRelativeUrl:e.ListItemAllFields.ParentList.RootFolder.ServerRelativeUrl,RootFolderUniqueId:e.ListItemAllFields.ParentList.RootFolder.UniqueId},ParentWeb:{Id:e.ListItemAllFields.ParentList.ParentWeb.Id,ServerRelativePath:e.ListItemAllFields.ParentList.ParentWeb.ServerRelativePath,ServerRelativeUrl:e.ListItemAllFields.ParentList.ParentWeb.ServerRelativeUrl,Url:e.ListItemAllFields.ParentList.ParentWeb.Url}}}))}getShareable(){return A(this,void 0,void 0,(function*(){const e=yield this.clone(Ye,"listItemAllFields",!1).select("odata.id")();let t=Rt(rt(e));return this.hasBatch&&(t=t.inBatch(this.batch)),t}))}}$([Be("f.recycle")],Zr.prototype,"recycle",null),$([Be("f.getItem")],Zr.prototype,"getItem",null),$([Be("f.moveTo")],Zr.prototype,"moveTo",null),$([Be("f.moveByPath")],Zr.prototype,"moveByPath",null),$([Be("f.copyTo")],Zr.prototype,"copyTo",null),$([Be("f.copyByPath")],Zr.prototype,"copyByPath",null),$([Be("f.del-params")],Zr.prototype,"deleteWithParams",null),$([Be("f.getShareable")],Zr.prototype,"getShareable",null);const en=Ge(Zr);X(Pt,"rootFolder",en,"rootFolder"),Pt.prototype.getDefaultColumnValues=function(){return A(this,void 0,void 0,(function*(){const e=yield this.rootFolder.select("ServerRelativePath")(),t=yield this.select("ParentWeb/Url").expand("ParentWeb")(),r=h("/",e.ServerRelativePath.DecodedUrl,"Forms/client_LocationBasedDefaults.html"),n=h(t.ParentWeb.Url,"_api/web",`getFileByServerRelativePath(decodedUrl='${dt(r)}')`);let i="";try{i=yield en(n,"$value").usingParser(new he)(De({binaryStringResponseBody:"true"}))}catch(e){if(e&&e.status&&404===e.status)return[];throw e}const s=i.match(/<a.*?<\/a>/gi);return(null===s?[]:s.map((e=>e.trim()))).reduce(((e,t)=>{const r=/<a href="(.*?)">/gi.exec(t);if(r.length<1)return o.write(`Could not parse default column value from '${t}'`,2),null;const n=t.match(/<DefaultValue.*?<\/DefaultValue>/gi);return(null===n?[]:n.map((e=>e.trim()))).map((t=>{const n=/<DefaultValue FieldName="(.*?)">(.*?)<\/DefaultValue>/gi.exec(t);n.length<1?o.write(`Could not parse default column value from '${t}'`,2):e.push({name:n[1],path:decodeURIComponent(r[1]),value:n[2]})})),e}),[]).filter((e=>null!==e))}))},Pt.prototype.setDefaultColumnValues=function(e){return A(this,void 0,void 0,(function*(){const t=yield Xe(this,"fields").select("InternalName","TypeAsString").filter("Hidden ne true")(),r=`<MetadataDefaults>${e.map((e=>{const r=t.findIndex((t=>t.InternalName===e.name));if(r<0)throw Error(`Field '${e.name}' does not exist in the list. Please check the internal field name. Failed to set defaults.`);const n=t[r];let i="";switch(n.TypeAsString){case"Boolean":case"Currency":case"Text":case"DateTime":case"Number":case"Choice":case"User":if(m(e.value))throw Error(`The type '${n.TypeAsString}' does not support multiple values.`);i=`${e.value}`;break;case"MultiChoice":i=m(e.value)?e.value.map((e=>`${e}`)).join(";"):`${e.value}`;break;case"UserMulti":i=m(e.value)?e.value.map((e=>`${e}`)).join(";#"):`${e.value}`;break;case"Taxonomy":case"TaxonomyFieldType":if(m(e.value))throw Error(`The type '${n.TypeAsString}' does not support multiple values.`);i=`${e.value.wssId};#${e.value.termName}|${e.value.termId}`;break;case"TaxonomyMulti":case"TaxonomyFieldTypeMulti":m(e.value)&&(i=e.value.map((e=>`${e.wssId};#${e.termName}|${e.termId}`)).join(";#")),i=`${e.value.wssId};#${e.value.termName}|${e.value.termId}`}return`<a href="${e.path.replace(/ /gi,"%20")}"><DefaultValue FieldName="${e.name}">${i}</DefaultValue></a>`})).join("")}</MetadataDefaults>`,n=yield this.rootFolder.select("ServerRelativePath")(),i=yield this.select("ParentWeb/Url").expand("ParentWeb")(),s=h("/",n.ServerRelativePath.DecodedUrl,"Forms"),o=h(i.ParentWeb.Url,"_api/web",`getFolderByServerRelativePath(decodedUrl='${dt(s)}')`,"files");yield qe(en(o,"add(overwrite=true,url='client_LocationBasedDefaults.html')"),{body:r}),(yield this.eventReceivers.filter("ReceiverName eq 'LocationBasedMetadataDefaultsReceiver ItemAdded'").select("ReceiverId")()).length<1&&(yield qe(It(this.eventReceivers,"add"),Re({eventReceiverCreationInformation:{EventType:10001,ReceiverAssembly:"Microsoft.Office.DocumentManagement, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c",ReceiverClass:"Microsoft.Office.DocumentManagement.LocationBasedMetadataDefaultsReceiver",ReceiverName:"LocationBasedMetadataDefaultsReceiver ItemAdded",SequenceNumber:1e3,Synchronization:1}})))}))},Zr.prototype.getDefaultColumnValues=function(){return A(this,void 0,void 0,(function*(){const e=yield en(this,"Properties").select("vti_x005f_listname")(),{ServerRelativePath:t}=yield this.select("ServerRelativePath")(),r=mt(Le(rt(e))).lists.getById(e.vti_x005f_listname);return(yield r.getDefaultColumnValues()).filter((e=>e.path.toLowerCase()===t.DecodedUrl.toLowerCase()))}))},Zr.prototype.setDefaultColumnValues=function(e,t=!0){return A(this,void 0,void 0,(function*(){const r=yield en(this,"Properties").select("vti_x005f_listname")(),n=mt(Le(rt(r))).lists.getById(r.vti_x005f_listname),i=(yield this.select("ServerRelativePath")()).ServerRelativePath.DecodedUrl,s=yield n.getDefaultColumnValues(),o=t?s:s.filter((e=>e.path!==i));e.forEach((e=>{const t=o.find((t=>t.name===e.name&&t.path===i));t?t.value=e.value:o.push({name:e.name,path:i,value:e.value})})),yield n.setDefaultColumnValues(o)}))},Zr.prototype.clearDefaultColumnValues=function(){return A(this,void 0,void 0,(function*(){yield this.setDefaultColumnValues([],!1)}))};let tn=class extends Qe{addAvailableContentType(e){return A(this,void 0,void 0,(function*(){const t=yield qe(this.clone(rn,"addAvailableContentType"),Re({contentTypeId:e}));return{contentType:this.getById(t.id),data:t}}))}getById(e){return Be.configure(sn(this).concat(`('${e}')`),"cts.getById")}add(e,t,r="",n="Custom Content Types",i={}){return A(this,void 0,void 0,(function*(){const s=Re(Object.assign(Fe("SP.ContentType"),{Description:r,Group:n,Id:{StringValue:e},Name:t},i)),o=yield qe(this,s);return{contentType:this.getById(o.id),data:o}}))}};$([Be("cts.addAvailableContentType")],tn.prototype,"addAvailableContentType",null),$([Be("cts.add")],tn.prototype,"add",null),tn=$([tt("contenttypes")],tn);const rn=Ge(tn);class nn extends Je{constructor(){super(...arguments),this.delete=Ze("ct")}get fieldLinks(){return Be.configure(an(this),"ct.fieldLinks")}get fields(){return Be.configure(Xe(this,"fields"),"ct.fields")}get parent(){return Be.configure(sn(this,"parent"),"ct.parent")}get workflowAssociations(){return Be.configure(Xe(this,"workflowAssociations"),"ct.workflowAssociations")}}const sn=Ge(nn);let on=class extends Qe{getById(e){return Be.configure(ln(this).concat(`(guid'${e}')`),"fls.getById")}};on=$([tt("fieldlinks")],on);const an=Ge(on),ln=Ge(class extends Je{});X(ft,"contentTypes",rn),X(Ut,"contentType",sn,"ContentType"),X(Pt,"contentTypes",rn);let cn=class extends Qe{add(e,t=!1){return A(this,void 0,void 0,(function*(){return{data:yield qe(this.clone(un,"add"),Re({featdefScope:0,featureId:e,force:t})),feature:this.getById(e)}}))}getById(e){const t=hn(this);return t.concat(`('${e}')`),Be.configure(t,"fes.getById")}remove(e,t=!1){return qe(this.clone(un,"remove"),Re({featureId:e,force:t}))}};$([Be("fes.add")],cn.prototype,"add",null),$([Be("fes.remove")],cn.prototype,"remove",null),cn=$([tt("features")],cn);const un=Ge(cn);class dn extends Je{deactivate(e=!1){return A(this,void 0,void 0,(function*(){const t=this.addBatchDependency(),r=yield hn(this).select("DefinitionId")(),n=this.getParent(un,this.parentUrl,"",this.batch).remove(r.DefinitionId,e);return t(),n}))}}$([Be("fe.deactivate")],dn.prototype,"deactivate",null);const hn=Ge(dn);X(ht,"features",un),X(ft,"features",un);let pn=class extends Qe{createFieldAsXml(e){return A(this,void 0,void 0,(function*(){"string"==typeof e&&(e={SchemaXml:e});const t=Re({parameters:v(Fe("SP.XmlSchemaFieldCreationInformation"),e)}),r=yield qe(this.clone(gn,"createfieldasxml"),t);return{data:r,field:this.getById(r.Id)}}))}getById(e){return Be.configure(fn(this).concat(`('${e}')`),"fs.getById")}getByTitle(e){return Be.configure(fn(this,`getByTitle('${e}')`),"fs.getByTitle")}getByInternalNameOrTitle(e){return Be.configure(fn(this,`getByInternalNameOrTitle('${e}')`),"fs.getByInternalNameOrTitle")}add(e,t,r){return A(this,void 0,void 0,(function*(){const n=Re(Object.assign(Fe(t),{Title:e},r));Be.isTagged(this)||Be.configure(this,"fs.add");const i=yield qe(this.clone(gn,null),n);return{data:i,field:this.getById(i.Id)}}))}addText(e,t=255,r){const n={FieldTypeKind:2,MaxLength:t};return this.add(e,"SP.FieldText",v(n,r))}addCalculated(e,t,r,n=mn.Text,i){const s={DateFormat:r,FieldTypeKind:17,Formula:t,OutputType:n};return this.add(e,"SP.FieldCalculated",v(s,i))}addDateTime(e,t=vn.DateOnly,r=Pn.Gregorian,n=bn.Unspecified,i){const s={DateTimeCalendarType:r,DisplayFormat:t,FieldTypeKind:4,FriendlyDisplayFormat:n};return this.add(e,"SP.FieldDateTime",v(s,i))}addNumber(e,t,r,n){let i={FieldTypeKind:9};return void 0!==t&&(i=v({MinimumValue:t},i)),void 0!==r&&(i=v({MaximumValue:r},i)),this.add(e,"SP.FieldNumber",v(i,n))}addCurrency(e,t,r,n=1033,i){let s={CurrencyLocaleId:n,FieldTypeKind:10};return void 0!==t&&(s=v({MinimumValue:t},s)),void 0!==r&&(s=v({MaximumValue:r},s)),this.add(e,"SP.FieldCurrency",v(s,i))}addMultilineText(e,t=6,r=!0,n=!1,i=!1,s=!0,o){const a={AllowHyperlink:s,AppendOnly:i,FieldTypeKind:3,NumberOfLines:t,RestrictedMode:n,RichText:r};return this.add(e,"SP.FieldMultiLineText",v(a,o))}addUrl(e,t=In.Hyperlink,r){const n={DisplayFormat:t,FieldTypeKind:11};return this.add(e,"SP.FieldUrl",v(n,r))}addUser(e,t,r){const n={FieldTypeKind:20,SelectionMode:t};return this.add(e,"SP.FieldUser",v(n,r))}addLookup(e,t,r,n){return A(this,void 0,void 0,(function*(){const i=v({FieldTypeKind:7,LookupFieldName:r,LookupListId:t,Title:e},n),s=Re({parameters:v(Fe("SP.FieldCreationInformation"),i)}),o=yield qe(this.clone(gn,"addfield"),s);return{data:o,field:this.getById(o.Id)}}))}addChoice(e,t,r=wn.Dropdown,n,i){const s={Choices:{results:t},EditFormat:r,FieldTypeKind:6,FillInChoice:n};return this.add(e,"SP.FieldChoice",v(s,i))}addMultiChoice(e,t,r,n){const i={Choices:{results:t},FieldTypeKind:15,FillInChoice:r};return this.add(e,"SP.FieldMultiChoice",v(i,n))}addBoolean(e,t){return this.add(e,"SP.Field",v({FieldTypeKind:8},t))}addDependentLookupField(e,t,r){return A(this,void 0,void 0,(function*(){const n=`adddependentlookupfield(displayName='${e}', primarylookupfieldid='${t}', showfield='${r}')`,i=yield qe(this.clone(gn,n));return{data:i,field:this.getById(i.Id)}}))}addLocation(e,t){return this.add(e,"SP.FieldLocation",v({FieldTypeKind:33},t))}};$([Be("fs.createFieldAsXml")],pn.prototype,"createFieldAsXml",null),$([Be("fs.addText")],pn.prototype,"addText",null),$([Be("fs.addCalculated")],pn.prototype,"addCalculated",null),$([Be("fs.addDateTime")],pn.prototype,"addDateTime",null),$([Be("fs.addNumber")],pn.prototype,"addNumber",null),$([Be("fs.addCurrency")],pn.prototype,"addCurrency",null),$([Be("fs.addMultilineText")],pn.prototype,"addMultilineText",null),$([Be("fs.addUrl")],pn.prototype,"addUrl",null),$([Be("fs.addUser")],pn.prototype,"addUser",null),$([Be("fs.addLookup")],pn.prototype,"addLookup",null),$([Be("fs.addChoice")],pn.prototype,"addChoice",null),$([Be("fs.addMultiChoice")],pn.prototype,"addMultiChoice",null),$([Be("fs.addBoolean")],pn.prototype,"addBoolean",null),$([Be("fs.addDependentLookupField")],pn.prototype,"addDependentLookupField",null),$([Be("fs.addLocation")],pn.prototype,"addLocation",null),pn=$([tt("fields")],pn);const gn=Ge(pn);class yn extends Je{constructor(){super(...arguments),this.delete=Ze("f")}update(e,t){return A(this,void 0,void 0,(function*(){if(null==t){const e=yield fn(this).select("FieldTypeKind").configure({headers:{Accept:"application/json"}})();t=e["odata.type"]}const r=Re(v(Fe(t),e),De({"X-HTTP-Method":"MERGE"}));return{data:yield qe(this,r),field:this}}))}setShowInDisplayForm(e){return qe(this.clone(fn,`setshowindisplayform(${e})`))}setShowInEditForm(e){return qe(this.clone(fn,`setshowineditform(${e})`))}setShowInNewForm(e){return qe(this.clone(fn,`setshowinnewform(${e})`))}}$([Be("f.update")],yn.prototype,"update",null),$([Be("f.setShowInDisplayForm")],yn.prototype,"setShowInDisplayForm",null),$([Be("f.setShowInEditForm")],yn.prototype,"setShowInEditForm",null),$([Be("f.setShowInNewForm")],yn.prototype,"setShowInNewForm",null);const fn=Ge(yn);var mn,vn,bn,Sn,Pn,In,Tn,wn;!function(e){e[e.Invalid=0]="Invalid",e[e.Integer=1]="Integer",e[e.Text=2]="Text",e[e.Note=3]="Note",e[e.DateTime=4]="DateTime",e[e.Counter=5]="Counter",e[e.Choice=6]="Choice",e[e.Lookup=7]="Lookup",e[e.Boolean=8]="Boolean",e[e.Number=9]="Number",e[e.Currency=10]="Currency",e[e.URL=11]="URL",e[e.Computed=12]="Computed",e[e.Threading=13]="Threading",e[e.Guid=14]="Guid",e[e.MultiChoice=15]="MultiChoice",e[e.GridChoice=16]="GridChoice",e[e.Calculated=17]="Calculated",e[e.File=18]="File",e[e.Attachments=19]="Attachments",e[e.User=20]="User",e[e.Recurrence=21]="Recurrence",e[e.CrossProjectLink=22]="CrossProjectLink",e[e.ModStat=23]="ModStat",e[e.Error=24]="Error",e[e.ContentTypeId=25]="ContentTypeId",e[e.PageSeparator=26]="PageSeparator",e[e.ThreadIndex=27]="ThreadIndex",e[e.WorkflowStatus=28]="WorkflowStatus",e[e.AllDayEvent=29]="AllDayEvent",e[e.WorkflowEventType=30]="WorkflowEventType"}(mn||(mn={})),function(e){e[e.DateOnly=0]="DateOnly",e[e.DateTime=1]="DateTime"}(vn||(vn={})),function(e){e[e.Unspecified=0]="Unspecified",e[e.Disabled=1]="Disabled",e[e.Relative=2]="Relative"}(bn||(bn={})),function(e){e[e.DefaultValue=0]="DefaultValue",e[e.AddToDefaultContentType=1]="AddToDefaultContentType",e[e.AddToNoContentType=2]="AddToNoContentType",e[e.AddToAllContentTypes=4]="AddToAllContentTypes",e[e.AddFieldInternalNameHint=8]="AddFieldInternalNameHint",e[e.AddFieldToDefaultView=16]="AddFieldToDefaultView",e[e.AddFieldCheckDisplayName=32]="AddFieldCheckDisplayName"}(Sn||(Sn={})),function(e){e[e.Gregorian=1]="Gregorian",e[e.Japan=3]="Japan",e[e.Taiwan=4]="Taiwan",e[e.Korea=5]="Korea",e[e.Hijri=6]="Hijri",e[e.Thai=7]="Thai",e[e.Hebrew=8]="Hebrew",e[e.GregorianMEFrench=9]="GregorianMEFrench",e[e.GregorianArabic=10]="GregorianArabic",e[e.GregorianXLITEnglish=11]="GregorianXLITEnglish",e[e.GregorianXLITFrench=12]="GregorianXLITFrench",e[e.KoreaJapanLunar=14]="KoreaJapanLunar",e[e.ChineseLunar=15]="ChineseLunar",e[e.SakaEra=16]="SakaEra",e[e.UmAlQura=23]="UmAlQura"}(Pn||(Pn={})),function(e){e[e.Hyperlink=0]="Hyperlink",e[e.Image=1]="Image"}(In||(In={})),function(e){e[e.PeopleAndGroups=1]="PeopleAndGroups",e[e.PeopleOnly=0]="PeopleOnly"}(Tn||(Tn={})),function(e){e[e.Dropdown=0]="Dropdown",e[e.RadioButtons=1]="RadioButtons"}(wn||(wn={})),X(ft,"fields",gn),X(ft,"availablefields",gn,"availablefields"),X(Pt,"fields",gn),X(Zr,"files",fr),X(Ut,"file",vr,"file"),X(Ut,"folder",en,"folder"),X(Pt,"rootFolder",en,"rootFolder"),X(ft,"folders",Yr),X(ft,"rootFolder",en,"rootFolder"),ft.prototype.getFolderByServerRelativeUrl=function(e){return en(this,`getFolderByServerRelativeUrl('${dt(e)}')`)},ft.prototype.getFolderByServerRelativePath=function(e){return en(this,`getFolderByServerRelativePath(decodedUrl='${dt(e)}')`)},ft.prototype.getFolderById=function(e){return en(this,`getFolderById('${e}')`)};let Cn=class extends Qe{getById(e){return Be.configure(Un(this).concat(`('${e}')`),"fos.getById")}};Cn=$([tt("forms")],Cn);const xn=Ge(Cn),Un=Ge(class extends Je{});X(Pt,"forms",xn,"forms");let Rn=class extends Qe{getById(e){return Be.configure(Ln(this,`GetById?hubSiteId='${e}'`),"hss.getById")}};Rn=$([tt("_api/hubsites")],Rn);const Dn=Ge(Rn);class Fn extends Je{getSite(){return A(this,void 0,void 0,(function*(){const e=yield this.select("SiteUrl")();return pt(e.SiteUrl)}))}}$([Be("hs.getSite")],Fn.prototype,"getSite",null);const Ln=Ge(Fn);ht.prototype.joinHubSite=function(e){return A(this,void 0,void 0,(function*(){yield qe(this.clone(pt,`joinHubSite('${e}')`))}))},ht.prototype.registerHubSite=function(){return A(this,void 0,void 0,(function*(){yield qe(this.clone(pt,"registerHubSite"))}))},ht.prototype.unRegisterHubSite=function(){return A(this,void 0,void 0,(function*(){yield qe(this.clone(pt,"unRegisterHubSite"))}))},ft.prototype.hubSiteData=function(e=!1){return A(this,void 0,void 0,(function*(){const t=yield this.clone(mt,`hubSiteData(${e})`)();return"string"==typeof t?JSON.parse(t):t}))},ft.prototype.syncHubSiteTheme=function(){return qe(this.clone(mt,"syncHubSiteTheme"))},Reflect.defineProperty(ut.prototype,"hubSites",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>Dn(t).configure(e).setRuntime(r)))}});class Bn extends Qe{getById(e){return Be.configure(kn(this).concat(`(${e})`),"nns.getById")}add(e,t,r=!0){return A(this,void 0,void 0,(function*(){const n=Re(v(Fe("SP.NavigationNode"),{IsVisible:r,Title:e,Url:t})),i=yield qe(this.clone($n,null),n);return{data:i,node:this.getById(i.Id)}}))}moveAfter(e,t){const r=Re({nodeId:e,previousNodeId:t});return qe(this.clone($n,"MoveAfter"),r)}}$([Be("nns.add")],Bn.prototype,"add",null),$([Be("nns.moveAfter")],Bn.prototype,"moveAfter",null);const $n=Ge(Bn);class An extends Je{constructor(){super(...arguments),this.delete=Ze("nn")}get children(){return Be.configure($n(this,"children"),"nn.children")}update(e){return A(this,void 0,void 0,(function*(){const t=Re(v(Fe("SP.NavigationNode"),e),De({"X-HTTP-Method":"MERGE"}));return{data:yield qe(this,t),node:this}}))}}$([Be("nn.update")],An.prototype,"update",null);const kn=Ge(An);let _n=class extends ze{get quicklaunch(){return Be.configure($n(this,"quicklaunch"),"n.quicklaunch")}get topNavigationBar(){return Be.configure($n(this,"topnavigationbar"),"n.topnavigationbar")}};_n=$([tt("navigation")],_n);const On=Ge(_n);class En extends ze{constructor(e=null){super("_api/navigation",e)}getMenuState(e=null,t=10,r=null,n=null){return qe(Nn("MenuState"),Re({customProperties:n,depth:t,mapProviderName:r,menuNodeKey:e}))}getMenuNodeKey(e,t=null){return qe(Nn("MenuNodeKey"),Re({currentUrl:e,mapProviderName:t}))}}$([Be("ns.getMenuState")],En.prototype,"getMenuState",null),$([Be("ns.getMenuNodeKey")],En.prototype,"getMenuNodeKey",null);const Nn=e=>new En(e);X(ft,"navigation",On),Reflect.defineProperty(ut.prototype,"navigation",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>Nn(t).configure(e).setRuntime(r)))}});class Mn extends Je{constructor(e,t="_api/sp.userprofiles.peoplemanager"){super(e,t),this.clientPeoplePickerQuery=new Hn(e).configureFrom(this),this.profileLoader=new jn(e).configureFrom(this)}get editProfileLink(){return this.clone(qn,"EditProfileLink").get()}get isMyPeopleListPublic(){return this.clone(qn,"IsMyPeopleListPublic").get()}amIFollowedBy(e){const t=this.clone(qn,"amifollowedby(@v)");return t.query.set("@v",`'${encodeURIComponent(e)}'`),t.get()}amIFollowing(e){const t=this.clone(qn,"amifollowing(@v)");return t.query.set("@v",`'${encodeURIComponent(e)}'`),t.get()}getFollowedTags(e=20){return this.clone(qn,`getfollowedtags(${e})`).get()}getFollowersFor(e){const t=this.clone(qn,"getfollowersfor(@v)");return t.query.set("@v",`'${encodeURIComponent(e)}'`),t.get()}get myFollowers(){return Xe(this,"getmyfollowers")}get myProperties(){return new Mn(this,"getmyproperties")}getPeopleFollowedBy(e){const t=this.clone(qn,"getpeoplefollowedby(@v)");return t.query.set("@v",`'${encodeURIComponent(e)}'`),t.get()}getPropertiesFor(e){const t=this.clone(qn,"getpropertiesfor(@v)");return t.query.set("@v",`'${encodeURIComponent(e)}'`),t.get()}get trendingTags(){const e=this.clone(qn,null);return e.concat(".gettrendingtags"),e.get()}getUserProfilePropertyFor(e,t){const r=this.clone(qn,`getuserprofilepropertyfor(accountname=@v, propertyname='${t}')`);return r.query.set("@v",`'${encodeURIComponent(e)}'`),r.get()}hideSuggestion(e){const t=this.clone(qn,"hidesuggestion(@v)");return t.query.set("@v",`'${encodeURIComponent(e)}'`),qe(t)}isFollowing(e,t){const r=this.clone(qn,null);return r.concat(".isfollowing(possiblefolloweraccountname=@v, possiblefolloweeaccountname=@y)"),r.query.set("@v",`'${encodeURIComponent(e)}'`),r.query.set("@y",`'${encodeURIComponent(t)}'`),r.get()}setMyProfilePic(e){return new Promise(((t,r)=>{const n=new FileReader;n.onload=e=>A(this,void 0,void 0,(function*(){const n=e.target.result;try{yield qe(qn(this,"setmyprofilepicture"),{body:n}),t()}catch(e){r(e)}})),n.readAsArrayBuffer(e)}))}setSingleValueProfileProperty(e,t,r){return qe(this.clone(qn,"SetSingleValueProfileProperty"),Re({accountName:e,propertyName:t,propertyValue:r}))}setMultiValuedProfileProperty(e,t,r){return qe(this.clone(qn,"SetMultiValuedProfileProperty"),Re({accountName:e,propertyName:t,propertyValues:r}))}createPersonalSiteEnqueueBulk(...e){return this.profileLoader.createPersonalSiteEnqueueBulk(e)}get ownerUserProfile(){return this.profileLoader.ownerUserProfile}get userProfile(){return this.profileLoader.userProfile}createPersonalSite(e=!1){return this.profileLoader.createPersonalSite(e)}shareAllSocialData(e){return this.profileLoader.shareAllSocialData(e)}clientPeoplePickerResolveUser(e){return this.clientPeoplePickerQuery.clientPeoplePickerResolveUser(e)}clientPeoplePickerSearchUser(e){return this.clientPeoplePickerQuery.clientPeoplePickerSearchUser(e)}}const qn=Ge(Mn);let jn=class extends ze{createPersonalSiteEnqueueBulk(e){return qe(this.clone(Wn,"createpersonalsiteenqueuebulk",!1),Re({emailIDs:e}))}get ownerUserProfile(){let e=this.getParent(Wn,this.parentUrl,"_api/sp.userprofiles.profileloader.getowneruserprofile");return this.hasBatch&&(e=e.inBatch(this.batch)),qe(e)}get userProfile(){return qe(this.clone(Wn,"getuserprofile"))}createPersonalSite(e=!1){return qe(this.clone(Wn,`getuserprofile/createpersonalsiteenque(${e})`))}shareAllSocialData(e){return qe(this.clone(Wn,`getuserprofile/shareallsocialdata(${e})`))}};jn=$([tt("_api/sp.userprofiles.profileloader.getprofileloader")],jn);const Wn=(e,t)=>new jn(e,t);let Hn=class extends ze{clientPeoplePickerResolveUser(e){return A(this,void 0,void 0,(function*(){const t=this.clone(Vn,null);t.concat(".clientpeoplepickerresolveuser");const r=yield qe(t,this.getBodyFrom(e));return JSON.parse("object"==typeof r?r.ClientPeoplePickerResolveUser:r)}))}clientPeoplePickerSearchUser(e){return A(this,void 0,void 0,(function*(){const t=this.clone(Vn,null);t.concat(".clientpeoplepickersearchuser");const r=yield qe(t,this.getBodyFrom(e));return JSON.parse("object"==typeof r?r.ClientPeoplePickerSearchUser:r)}))}getBodyFrom(e){return Re({queryParams:v(Fe("SP.UI.ApplicationPages.ClientPeoplePickerQueryParameters"),e)})}};Hn=$([tt("_api/sp.ui.applicationpages.clientpeoplepickerwebserviceinterface")],Hn);const Vn=(e,t)=>new Hn(e,t);var Gn;!function(e){e[e.DefaultZone=0]="DefaultZone",e[e.Intranet=1]="Intranet",e[e.Internet=2]="Internet",e[e.Custom=3]="Custom",e[e.Extranet=4]="Extranet"}(Gn||(Gn={})),Reflect.defineProperty(ut.prototype,"profiles",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>qn(t).configure(e).setRuntime(r)))}});let zn=class extends Je{get installedLanguages(){return console.warn("Deprecated: RegionalSettings.installedLanguages is deprecated, please use RegionalSettings.getInstalledLanguages"),Be.configure(Xe(this,"installedlanguages"),"rs.installedLanguages")}get timeZone(){return Be.configure(Xn(this),"rs.tz")}get timeZones(){return Be.configure(Yn(this),"rs.tzs")}getInstalledLanguages(){return A(this,void 0,void 0,(function*(){return(yield Be.configure(Xe(this,"installedlanguages"),"rs.getInstalledLanguages")()).Items}))}};zn=$([tt("regionalsettings")],zn);const Kn=Ge(zn);let Qn=class extends Je{utcToLocalTime(e){return A(this,void 0,void 0,(function*(){let t;t="string"==typeof e?e:e.toISOString();const r=yield qe(this.clone(Xn,`utctolocaltime('${t}')`));return T(r,"UTCToLocalTime")?r.UTCToLocalTime:r}))}localTimeToUTC(e){return A(this,void 0,void 0,(function*(){let t;t="string"==typeof e?e:d(e,"minute",-1*e.getTimezoneOffset()).toISOString();const r=yield qe(this.clone(Xn,`localtimetoutc('${t}')`));return T(r,"LocalTimeToUTC")?r.LocalTimeToUTC:r}))}};$([Be("tz.utcToLocalTime")],Qn.prototype,"utcToLocalTime",null),$([Be("tz.localTimeToUTC")],Qn.prototype,"localTimeToUTC",null),Qn=$([tt("timezone")],Qn);const Xn=Ge(Qn);let Jn=class extends Qe{getById(e){return qe(this.clone(Yn,`GetById(${e})`).usingParser(st(Xn)))}};$([Be("tzs.getById")],Jn.prototype,"getById",null),Jn=$([tt("timezones")],Jn);const Yn=Ge(Jn);function Zn(e){return function(t){return qe(this.clone(Ke,`${e}/getValueForUICulture`),Re({cultureName:t}))}}X(ft,"regionalSettings",Kn),ft.prototype.titleResource=Zn("titleResource"),ft.prototype.descriptionResource=Zn("descriptionResource");let ei=class extends Qe{getById(e){return Be.configure(ni(this).concat(`('${e}')`),"ucas.getById")}add(e){return A(this,void 0,void 0,(function*(){const t=yield qe(this,Re(v(Fe("SP.UserCustomAction"),e)));return{action:this.getById(t.Id),data:t}}))}clear(){return qe(this.clone(ti,"clear"))}};$([Be("ucas.add")],ei.prototype,"add",null),$([Be("ucas.clear")],ei.prototype,"clear",null),ei=$([tt("usercustomactions")],ei);const ti=Ge(ei);class ri extends Je{constructor(){super(...arguments),this.delete=Ze("uca"),this.update=this._update("SP.UserCustomAction",(e=>({data:e,action:this})))}}const ni=Ge(ri);var ii,si;!function(e){e[e.None=0]="None",e[e.List=1]="List",e[e.ContentType=2]="ContentType",e[e.ProgId=3]="ProgId",e[e.FileType=4]="FileType"}(ii||(ii={})),function(e){e[e.Unknown=0]="Unknown",e[e.Site=2]="Site",e[e.Web=3]="Web",e[e.List=4]="List"}(si||(si={})),ri.prototype.titleResource=Zn("titleResource"),ri.prototype.descriptionResource=Zn("descriptionResource"),Pt.prototype.titleResource=Zn("titleResource"),Pt.prototype.descriptionResource=Zn("descriptionResource"),yn.prototype.titleResource=Zn("titleResource"),yn.prototype.descriptionResource=Zn("descriptionResource"),nn.prototype.titleResource=Zn("titleResource"),nn.prototype.descriptionResource=Zn("descriptionResource");let oi=class extends ze{getRelatedItems(e,t){const r=this.clone(ai,null);return r.concat(".GetRelatedItems"),qe(r,Re({SourceItemID:t,SourceListName:e}))}getPageOneRelatedItems(e,t){const r=this.clone(ai,null);return r.concat(".GetPageOneRelatedItems"),qe(r,Re({SourceItemID:t,SourceListName:e}))}addSingleLink(e,t,r,n,i,s,o=!1){const a=this.clone(ai,null);return a.concat(".AddSingleLink"),qe(a,Re({SourceItemID:t,SourceListName:e,SourceWebUrl:r,TargetItemID:i,TargetListName:n,TargetWebUrl:s,TryAddReverseLink:o}))}addSingleLinkToUrl(e,t,r,n=!1){const i=this.clone(ai,null);return i.concat(".AddSingleLinkToUrl"),qe(i,Re({SourceItemID:t,SourceListName:e,TargetItemUrl:r,TryAddReverseLink:n}))}addSingleLinkFromUrl(e,t,r,n=!1){const i=this.clone(ai,null);return i.concat(".AddSingleLinkFromUrl"),qe(i,Re({SourceItemUrl:e,TargetItemID:r,TargetListName:t,TryAddReverseLink:n}))}deleteSingleLink(e,t,r,n,i,s,o=!1){const a=this.clone(ai,null);return a.concat(".DeleteSingleLink"),qe(a,Re({SourceItemID:t,SourceListName:e,SourceWebUrl:r,TargetItemID:i,TargetListName:n,TargetWebUrl:s,TryDeleteReverseLink:o}))}};$([Be("rim.getRelatedItems")],oi.prototype,"getRelatedItems",null),$([Be("rim.getPageOneRelatedItems")],oi.prototype,"getPageOneRelatedItems",null),$([Be("rim.addSingleLink")],oi.prototype,"addSingleLink",null),$([Be("rim.ToUrl")],oi.prototype,"addSingleLinkToUrl",null),$([Be("rim.FromUrl")],oi.prototype,"addSingleLinkFromUrl",null),$([Be("rim.deleteSingleLink")],oi.prototype,"deleteSingleLink",null),oi=$([tt("_api/SP.RelatedItemManager")],oi);const ai=e=>new oi(Le("string"==typeof e?e:e.toUrl())),li=new Map([["text","Querytext"],["template","QueryTemplate"],["sourceId","SourceId"],["trimDuplicatesIncludeId",""],["startRow",""],["rowLimit",""],["rankingModelId",""],["rowsPerPage",""],["selectProperties",""],["culture",""],["timeZoneId",""],["refinementFilters",""],["refiners",""],["hiddenConstraints",""],["sortList",""],["timeout",""],["hithighlightedProperties",""],["clientType",""],["personalizationData",""],["resultsURL",""],["queryTag",""],["properties",""],["queryTemplatePropertiesUrl",""],["reorderingRules",""],["hitHighlightedMultivaluePropertyLimit",""],["collapseSpecification",""],["uiLanguage",""],["desiredSnippetLength",""],["maxSnippetLength",""],["summaryLength",""]]),ci=new Map([]);function ui(e){return e.replace(/^(.)/,(e=>e.toUpperCase()))}function di(e="",t={}){return new Proxy({query:Object.assign({Querytext:e},t)},{get(e,t,r){const n=t.toString();if("toSearchQuery"===n)return()=>e.query;if(li.has(n))return(...t)=>{const i=li.get(n);return e.query[i.length>0?i:ui(n)]=t.length>1?t:t[0],r};const i=ci.has(n)?ci.get(n):ui(n);return e.query[i]=!0,r}})}const hi=/_api\/search\/postquery$/i;let pi=class extends Je{execute(e){return A(this,void 0,void 0,(function*(){const t=this.parseQuery(e),r=Re({request:v(Fe("Microsoft.Office.Server.Search.REST.SearchRequest"),Object.assign({},t,{HitHighlightedProperties:this.fixArrProp(t.HitHighlightedProperties),Properties:this.fixArrProp(t.Properties),RefinementFilters:this.fixArrProp(t.RefinementFilters),ReorderingRules:this.fixArrProp(t.ReorderingRules),SelectProperties:this.fixArrProp(t.SelectProperties),SortList:this.fixArrProp(t.SortList)}))});if(this.data.useCaching){this._forceCaching=!0;const e=`PnPjs.SearchWithCaching(${w(r.body)})`;f(this.data.cachingOptions)?hi.test(this.data.cachingOptions.key)&&(this.data.cachingOptions.key=e):this.data.cachingOptions=new K(e)}const n=yield qe(this,r);return new yi(n,this.toUrl(),t)}))}fixArrProp(e){return void 0===e?{results:[]}:{results:m(e)?e:[e]}}parseQuery(e){let t;return t="string"==typeof e?{Querytext:e}:e.toSearchQuery?e.toSearchQuery():e,t}};$([Be("se.execute")],pi.prototype,"execute",null),pi=$([tt("_api/search/postquery")],pi);const gi=(e,t={},r=B)=>n=>new pi(e).configure(t).setRuntime(r).execute(n);class yi{constructor(e,t,r,n=null,i=null){this._url=t,this._query=r,this._raw=n,this._primary=i,this._url=this._url.replace(hi,""),this._raw=e.postquery?e.postquery:e}get ElapsedTime(){var e;return(null===(e=null==this?void 0:this.RawSearchResults)||void 0===e?void 0:e.ElapsedTime)||0}get RowCount(){var e,t,r;return(null===(r=null===(t=null===(e=null==this?void 0:this.RawSearchResults)||void 0===e?void 0:e.PrimaryQueryResult)||void 0===t?void 0:t.RelevantResults)||void 0===r?void 0:r.RowCount)||0}get TotalRows(){var e,t,r;return(null===(r=null===(t=null===(e=null==this?void 0:this.RawSearchResults)||void 0===e?void 0:e.PrimaryQueryResult)||void 0===t?void 0:t.RelevantResults)||void 0===r?void 0:r.TotalRows)||0}get TotalRowsIncludingDuplicates(){var e,t,r;return(null===(r=null===(t=null===(e=null==this?void 0:this.RawSearchResults)||void 0===e?void 0:e.PrimaryQueryResult)||void 0===t?void 0:t.RelevantResults)||void 0===r?void 0:r.TotalRowsIncludingDuplicates)||0}get RawSearchResults(){return this._raw}get PrimarySearchResults(){var e,t,r,n;return null===this._primary&&(this._primary=this.formatSearchResults((null===(n=null===(r=null===(t=null===(e=this._raw)||void 0===e?void 0:e.PrimaryQueryResult)||void 0===t?void 0:t.RelevantResults)||void 0===r?void 0:r.Table)||void 0===n?void 0:n.Rows)||null)),this._primary}getPage(e,t){if(this.TotalRows<this.RowCount)return Promise.resolve(null);const r=void 0!==t?t:T(this._query,"RowLimit")?this._query.RowLimit:10,n=v(this._query,{RowLimit:r,StartRow:r*(e-1)});return n.StartRow>this.TotalRows?Promise.resolve(null):gi(this._url)(n)}formatSearchResults(e){const t=new Array;if(void 0===e||null==e)return[];const r=e.results?e.results:e;for(const e of r){const r=e.Cells.results?e.Cells.results:e.Cells;t.push(r.reduce(((e,t)=>(Reflect.defineProperty(e,t.Key,{configurable:!1,enumerable:!0,value:t.Value,writable:!1}),e)),{}))}return t}}let fi=class extends Je{execute(e){return A(this,void 0,void 0,(function*(){this.mapQueryToQueryString(e);const t=yield this.get(),r=T(t,"suggest")?e=>t.suggest[e].results:e=>t[e];return{PeopleNames:r("PeopleNames"),PersonalResults:r("PersonalResults"),Queries:r("Queries")}}))}mapQueryToQueryString(e){this.query.set("querytext",`'${e.querytext}'`);const t=(e=>t=>r=>{T(e,t)&&this.query.set(r,e[t].toString())})(e);t("count")("inumberofquerysuggestions"),t("personalCount")("inumberofresultsuggestions"),t("preQuery")("fprequerysuggestions"),t("hitHighlighting")("fhithighlighting"),t("capitalize")("fcapitalizefirstletters"),t("culture")("culture"),t("stemming")("enablestemming"),t("includePeople")("showpeoplenamesuggestions"),t("queryRules")("enablequeryrules"),t("prefixMatch")("fprefixmatchallterms")}};$([Be("su.execute")],fi.prototype,"execute",null),fi=$([tt("_api/search/suggest")],fi);const mi=(e,t={},r=B)=>n=>new fi(e).configure(t).setRuntime(r).execute(n);var vi,bi,Si;!function(e){e[e.Ascending=0]="Ascending",e[e.Descending=1]="Descending",e[e.FQLFormula=2]="FQLFormula"}(vi||(vi={})),function(e){e[e.ResultContainsKeyword=0]="ResultContainsKeyword",e[e.TitleContainsKeyword=1]="TitleContainsKeyword",e[e.TitleMatchesKeyword=2]="TitleMatchesKeyword",e[e.UrlStartsWith=3]="UrlStartsWith",e[e.UrlExactlyMatches=4]="UrlExactlyMatches",e[e.ContentTypeIs=5]="ContentTypeIs",e[e.FileExtensionMatches=6]="FileExtensionMatches",e[e.ResultHasTag=7]="ResultHasTag",e[e.ManualCondition=8]="ManualCondition"}(bi||(bi={})),function(e){e[e.None=0]="None",e[e.StringType=1]="StringType",e[e.Int32Type=2]="Int32Type",e[e.BooleanType=3]="BooleanType",e[e.StringArrayType=4]="StringArrayType",e[e.UnSupportedType=5]="UnSupportedType"}(Si||(Si={}));class Pi{}Pi.Documents="e7ec8cee-ded8-43c9-beb5-436b54b31e84",Pi.ItemsMatchingContentType="5dc9f503-801e-4ced-8a2c-5d1237132419",Pi.ItemsMatchingTag="e1327b9c-2b8c-4b23-99c9-3730cb29c3f7",Pi.ItemsRelatedToCurrentUser="48fec42e-4a92-48ce-8363-c2703a40e67d",Pi.ItemsWithSameKeywordAsThisItem="5c069288-1d17-454a-8ac6-9c642a065f48",Pi.LocalPeopleResults="b09a7990-05ea-4af9-81ef-edfab16c4e31",Pi.LocalReportsAndDataResults="203fba36-2763-4060-9931-911ac8c0583b",Pi.LocalSharePointResults="8413cd39-2156-4e00-b54d-11efd9abdb89",Pi.LocalVideoResults="78b793ce-7956-4669-aa3b-451fc5defebf",Pi.Pages="5e34578e-4d08-4edc-8bf3-002acf3cdbcc",Pi.Pictures="38403c8c-3975-41a8-826e-717f2d41568a",Pi.Popular="97c71db1-58ce-4891-8b64-585bc2326c12",Pi.RecentlyChangedItems="ba63bbae-fa9c-42c0-b027-9a878f16557c",Pi.RecommendedItems="ec675252-14fa-4fbe-84dd-8d098ed74181",Pi.Wiki="9479bf85-e257-4318-b5a8-81a180f5faa1",ut.prototype.search=function(e){return this.childConfigHook((({options:t,baseUrl:r,runtime:n})=>gi(r,t,n)(e)))},ut.prototype.searchWithCaching=function(e,t){return this.childConfigHook((({options:r,baseUrl:n,runtime:i})=>new pi(n).configure(r).setRuntime(i).usingCaching(t).execute(e)))},ut.prototype.searchSuggest=function(e){return this.childConfigHook((({options:t,baseUrl:r,runtime:n})=>mi(r,t,n)("string"==typeof e?{querytext:e}:e)))};let Ii=class extends Qe{getById(e){return Be.configure(wi(this,`getById(${e})`),"sus.getById")}getByEmail(e){return Be.configure(wi(this,`getByEmail('${e}')`),"sus.getByEmail")}getByLoginName(e){return Be.configure(wi(this).concat(`('!@v::${encodeURIComponent(e)}')`),"sus.getByLoginName")}removeById(e){return qe(this.clone(Ti,`removeById(${e})`))}removeByLoginName(e){const t=this.clone(Ti,"removeByLoginName(@v)");return t.query.set("@v",`'${encodeURIComponent(e)}'`),qe(t)}add(e){return A(this,void 0,void 0,(function*(){return yield qe(this,Re(v(Fe("SP.User"),{LoginName:e}))),this.getByLoginName(e)}))}};$([Be("sus.remId")],Ii.prototype,"removeById",null),$([Be("sus.remLoginName")],Ii.prototype,"removeByLoginName",null),$([Be("sus.add")],Ii.prototype,"add",null),Ii=$([tt("siteusers")],Ii);const Ti=Ge(Ii),wi=Ge(class extends Je{constructor(){super(...arguments),this.delete=Ze("su"),this.update=this._update("SP.User",(e=>({data:e,user:this})))}get groups(){return Be.configure(xi(this,"groups"),"su.groups")}});let Ci=class extends Qe{getById(e){return Be.configure(Ri(this).concat(`(${e})`),"sgs.getById")}add(e){return A(this,void 0,void 0,(function*(){const t=Re(v(Fe("SP.Group"),e)),r=yield qe(Be.configure(this,"sgs.add"),t);return{data:r,group:this.getById(r.Id)}}))}getByName(e){return Be.configure(Ri(this,`getByName('${e}')`),"sgs.getByName")}removeById(e){return qe(this.clone(xi,`removeById('${e}')`))}removeByLoginName(e){return qe(this.clone(xi,`removeByLoginName('${e}')`))}};$([Be("sgs.removeById")],Ci.prototype,"removeById",null),$([Be("sgs.removeByLoginName")],Ci.prototype,"removeByLoginName",null),Ci=$([tt("sitegroups")],Ci);const xi=Ge(Ci);class Ui extends Je{constructor(){super(...arguments),this.update=this._update("SP.Group",((e,t)=>({data:e,group:T(t,"Title")?this.getParent(Ri,this.parentUrl,`getByName('${t.Title}')`):Ri(this)})))}get users(){return Be.configure(Ti(this,"users"),"sg.users")}setUserAsOwner(e){return qe(this.clone(Ri,`SetUserAsOwner(${e})`))}}$([Be("sg.setUserAsOwner")],Ui.prototype,"setUserAsOwner",null);const Ri=Ge(Ui);let Di=class extends Qe{getById(e){return Li(this).concat(`(${e})`)}add(e,t){return A(this,void 0,void 0,(function*(){yield qe(this.clone(Fi,`addroleassignment(principalid=${e}, roledefid=${t})`))}))}remove(e,t){return A(this,void 0,void 0,(function*(){yield qe(this.clone(Fi,`removeroleassignment(principalid=${e}, roledefid=${t})`))}))}};Di=$([tt("roleassignments")],Di);const Fi=Ge(Di),Li=Ge(class extends Je{constructor(){super(...arguments),this.delete=Ze("ra")}get groups(){return Be.configure(xi(this,"groups"),"ra.groups")}get bindings(){return Xe(this,"roledefinitionbindings")}});let Bi=class extends Qe{getById(e){return Ai(this,`getById(${e})`)}getByName(e){return Ai(this,`getbyname('${e}')`)}getByType(e){return Ai(this,`getbytype(${e})`)}add(e,t,r,n){return A(this,void 0,void 0,(function*(){const i=Re({BasePermissions:{High:n.High.toString(),Low:n.Low.toString()},Description:t,Name:e,Order:r,__metadata:{type:"SP.RoleDefinition"}}),s=yield qe(this,i);return{data:s,definition:this.getById(s.Id)}}))}};Bi=$([tt("roledefinitions")],Bi);const $i=Ge(Bi),Ai=Ge(class extends Je{constructor(){super(...arguments),this.delete=Ze("rd")}update(e){return A(this,void 0,void 0,(function*(){const t=["BasePermissions"];if(void 0!==T(e,t[0])){e[t[0]]=v(Fe(`SP.${t[0]}`),e[t[0]]);const r=e[t[0]];r.High=r.High.toString(),r.Low=r.Low.toString()}const r=Re(v(Fe("SP.RoleDefinition"),e),De({"X-HTTP-Method":"MERGE"})),n=yield qe(this,r);let i=this;return T(e,"Name")&&(i=this.getParent($i,this.parentUrl,"").getByName(e.Name)),{data:n,definition:i}}))}});var ki,_i,Oi,Ei,Ni,Mi,qi;function ji(e){return A(this,void 0,void 0,(function*(){const t=this.clone(Ye,"getUserEffectivePermissions(@user)");t.query.set("@user",`'${encodeURIComponent(e)}'`);const r=yield t.get();return T(r,"GetUserEffectivePermissions")?r.GetUserEffectivePermissions:r}))}function Wi(){return A(this,void 0,void 0,(function*(){return this.clone(Ke,"EffectiveBasePermissions").get().then((e=>T(e,"EffectiveBasePermissions")?e.EffectiveBasePermissions:e))}))}function Hi(e=!1,t=!1){return A(this,void 0,void 0,(function*(){yield qe(this.clone(Ke,`breakroleinheritance(copyroleassignments=${e}, clearsubscopes=${t})`))}))}function Vi(){return A(this,void 0,void 0,(function*(){yield qe(this.clone(Ke,"resetroleinheritance"))}))}function Gi(e,t){return A(this,void 0,void 0,(function*(){const r=yield ji.call(this,e);return this.hasPermissions(r,t)}))}function zi(e){return A(this,void 0,void 0,(function*(){const t=yield Wi.call(this);return this.hasPermissions(t,e)}))}function Ki(e,t){if(!t)return!0;if(t===ki.FullMask)return 32767==(32767&e.High)&&65535===e.Low;let r=1;return(t-=1)>=0&&t<32?(r<<=t,0!=(e.Low&r)):t>=32&&t<64&&(r<<=t-32,0!=(e.High&r))}function Qi(e,t,r=!1){return A(this,void 0,void 0,(function*(){if(r)return is(e,t);t=v(t,{group:null,includeAnonymousLinkInEmail:!1,propagateAcl:!1,useSimplifiedRoles:!0},!0);const n=yield function(e,t){return A(this,void 0,void 0,(function*(){if(null==t){const t=e===_i.Edit?qi.Contributor:qi.Reader,r=yield $i("_api/web").select("Id").top(1).filter(`RoleTypeKind eq ${t}`)();if(r.length<1)throw Error("Could not locate associated role definition for supplied role. Edit and View are supported");return`role: ${r[0].Id}`}switch(t){case qi.Contributor:return`group: ${(yield mt("_api/web","associatedmembergroup").select("Id")()).Id}`;case qi.Reader:case qi.Guest:return`group: ${(yield mt("_api/web","associatedvisitorgroup").select("Id")()).Id}`;default:throw Error("Could not determine role value for supplied value. Contributor, Reader, and Guest are supported")}}))}(t.role,t.group);Array.isArray(t.loginNames)||(t.loginNames=[t.loginNames]);let i={peoplePickerInput:I(t.loginNames.map((e=>({Key:e})))),roleValue:n,url:t.url};return void 0!==t.emailData&&null!==t.emailData&&(i=v(i,{emailBody:t.emailData.body,emailSubject:void 0!==t.emailData.subject?t.emailData.subject:"Shared with you.",sendEmail:!0})),is(e,i)}))}function Xi(e,t=null){const r=null!==t?t.toISOString():null,n=Be.configure(this.clone(Ye,"shareLink"),"sh.getShareLink");return qe(n,Re({request:{createLink:!0,emailData:null,settings:{expiration:r,linkKind:e}}}))}function Ji(e){const t=Be.configure(this.clone(Ye,"checkPermissions"),"sh.checkPermissions");return qe(t,Re({recipients:e}))}function Yi(e=null,t=[]){const r=Be.configure(this.clone(Ye,"getSharingInformation"),"sh.getSharingInformation");return qe(r.expand(...t),Re({request:e}))}function Zi(e=!0){const t=Be.configure(this.clone(Ye,"getObjectSharingSettings"),"sh.getObjectSharingSettings");return qe(t,Re({useSimplifiedRoles:e}))}function es(){return qe(Be.configure(this.clone(Ye,"unshareObject"),"sh.unshareObject"))}function ts(e){return qe(Be.configure(this.clone(Ye,"deleteLinkByKind"),"sh.deleteLinkByKind"),Re({linkKind:e}))}function rs(e,t=lt){return qe(Be.configure(this.clone(Ye,"unshareLink"),"sh.unshareLink"),Re({linkKind:e,shareId:t}))}function ns(e,t,r,n=!1,i=!1,s){return A(this,void 0,void 0,(function*(){Array.isArray(t)||(t=[t]);const o=I(t.map((e=>({Key:e})))),a=r===_i.Edit?qi.Contributor:qi.Reader,l=Xe("_api/web","roledefinitions"),c=yield l.select("Id").filter(`RoleTypeKind eq ${a}`).get();if(!Array.isArray(c)||c.length<1)throw Error(`Could not locate a role defintion with RoleTypeKind ${a}`);let u={includeAnonymousLinkInEmail:n,peoplePickerInput:o,propagateAcl:i,roleValue:`role:${c[0].Id}`,useSimplifiedRoles:!0};return void 0!==s&&(u=v(u,{emailBody:s.body,emailSubject:void 0!==s.subject?s.subject:"",sendEmail:!0})),qe(Be.configure(e.clone(Ye,"shareObject"),"sh.shareWith"),Re(u))}))}function is(e,t){const r=Be.configure(mt(Le(e.toUrl()),"/_api/SP.Web.ShareObject"),"sh.sendShareObjectRequest");return qe(r.expand("UsersWithAccessRequests","GroupsSharedWith"),Re(t))}!function(e){e[e.EmptyMask=0]="EmptyMask",e[e.ViewListItems=1]="ViewListItems",e[e.AddListItems=2]="AddListItems",e[e.EditListItems=3]="EditListItems",e[e.DeleteListItems=4]="DeleteListItems",e[e.ApproveItems=5]="ApproveItems",e[e.OpenItems=6]="OpenItems",e[e.ViewVersions=7]="ViewVersions",e[e.DeleteVersions=8]="DeleteVersions",e[e.CancelCheckout=9]="CancelCheckout",e[e.ManagePersonalViews=10]="ManagePersonalViews",e[e.ManageLists=12]="ManageLists",e[e.ViewFormPages=13]="ViewFormPages",e[e.AnonymousSearchAccessList=14]="AnonymousSearchAccessList",e[e.Open=17]="Open",e[e.ViewPages=18]="ViewPages",e[e.AddAndCustomizePages=19]="AddAndCustomizePages",e[e.ApplyThemeAndBorder=20]="ApplyThemeAndBorder",e[e.ApplyStyleSheets=21]="ApplyStyleSheets",e[e.ViewUsageData=22]="ViewUsageData",e[e.CreateSSCSite=23]="CreateSSCSite",e[e.ManageSubwebs=24]="ManageSubwebs",e[e.CreateGroups=25]="CreateGroups",e[e.ManagePermissions=26]="ManagePermissions",e[e.BrowseDirectories=27]="BrowseDirectories",e[e.BrowseUserInfo=28]="BrowseUserInfo",e[e.AddDelPrivateWebParts=29]="AddDelPrivateWebParts",e[e.UpdatePersonalWebParts=30]="UpdatePersonalWebParts",e[e.ManageWeb=31]="ManageWeb",e[e.AnonymousSearchAccessWebLists=32]="AnonymousSearchAccessWebLists",e[e.UseClientIntegration=37]="UseClientIntegration",e[e.UseRemoteAPIs=38]="UseRemoteAPIs",e[e.ManageAlerts=39]="ManageAlerts",e[e.CreateAlerts=40]="CreateAlerts",e[e.EditMyUserInfo=41]="EditMyUserInfo",e[e.EnumeratePermissions=63]="EnumeratePermissions",e[e.FullMask=65]="FullMask"}(ki||(ki={})),X(Ut,"roleAssignments",Fi),X(Ut,"firstUniqueAncestorSecurableObject",Ye),Ut.prototype.getUserEffectivePermissions=ji,Ut.prototype.getCurrentUserEffectivePermissions=Wi,Ut.prototype.breakRoleInheritance=Hi,Ut.prototype.resetRoleInheritance=Vi,Ut.prototype.userHasPermissions=Gi,Ut.prototype.currentUserHasPermissions=zi,Ut.prototype.hasPermissions=Ki,X(Pt,"roleAssignments",Fi),X(Pt,"firstUniqueAncestorSecurableObject",Ye),Pt.prototype.getUserEffectivePermissions=ji,Pt.prototype.getCurrentUserEffectivePermissions=Wi,Pt.prototype.breakRoleInheritance=Hi,Pt.prototype.resetRoleInheritance=Vi,Pt.prototype.userHasPermissions=Gi,Pt.prototype.currentUserHasPermissions=zi,Pt.prototype.hasPermissions=Ki,X(ft,"roleDefinitions",$i),X(ft,"roleAssignments",Fi),X(ft,"firstUniqueAncestorSecurableObject",Ye),ft.prototype.getUserEffectivePermissions=ji,ft.prototype.getCurrentUserEffectivePermissions=Wi,ft.prototype.breakRoleInheritance=Hi,ft.prototype.resetRoleInheritance=Vi,ft.prototype.userHasPermissions=Gi,ft.prototype.currentUserHasPermissions=zi,ft.prototype.hasPermissions=Ki,function(e){e[e.None=0]="None",e[e.View=1]="View",e[e.Edit=2]="Edit",e[e.Owner=3]="Owner"}(_i||(_i={})),function(e){e[e.Unknown=0]="Unknown",e[e.File=1]="File",e[e.Folder=2]="Folder",e[e.Item=3]="Item",e[e.List=4]="List",e[e.Web=5]="Web",e[e.Max=6]="Max"}(Oi||(Oi={})),function(e){e[e.None=0]="None",e[e.AllowList=1]="AllowList",e[e.BlockList=2]="BlockList"}(Ei||(Ei={})),function(e){e[e.CompletedSuccessfully=0]="CompletedSuccessfully",e[e.AccessRequestsQueued=1]="AccessRequestsQueued",e[e.NoResolvedUsers=-1]="NoResolvedUsers",e[e.AccessDenied=-2]="AccessDenied",e[e.CrossSiteRequestNotSupported=-3]="CrossSiteRequestNotSupported",e[e.UnknowError=-4]="UnknowError",e[e.EmailBodyTooLong=-5]="EmailBodyTooLong",e[e.ListUniqueScopesExceeded=-6]="ListUniqueScopesExceeded",e[e.CapabilityDisabled=-7]="CapabilityDisabled",e[e.ObjectNotSupported=-8]="ObjectNotSupported",e[e.NestedGroupsNotSupported=-9]="NestedGroupsNotSupported"}(Ni||(Ni={})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Direct=1]="Direct",e[e.OrganizationView=2]="OrganizationView",e[e.OrganizationEdit=3]="OrganizationEdit",e[e.AnonymousView=4]="AnonymousView",e[e.AnonymousEdit=5]="AnonymousEdit",e[e.Flexible=6]="Flexible"}(Mi||(Mi={})),function(e){e[e.None=0]="None",e[e.Guest=1]="Guest",e[e.Reader=2]="Reader",e[e.Contributor=3]="Contributor",e[e.WebDesigner=4]="WebDesigner",e[e.Administrator=5]="Administrator"}(qi||(qi={})),mr.prototype.shareWith=function(e,t=_i.View,r=!1,n){return ns(this,e,t,r,!1,n)},mr.prototype.getShareLink=Xi,mr.prototype.checkSharingPermissions=Ji,mr.prototype.getSharingInformation=Yi,mr.prototype.getObjectSharingSettings=Zi,mr.prototype.unshare=es,mr.prototype.deleteSharingLinkByKind=ts,mr.prototype.unshareLink=rs,Zr.prototype.shareWith=function(e,t=_i.View,r=!1,n=!1,i){return A(this,void 0,void 0,(function*(){const s=this.addBatchDependency(),o=yield this.getShareable();return s(),o.shareWith(e,t,r,n,i)}))},Zr.prototype.getShareLink=function(e,t=null){return A(this,void 0,void 0,(function*(){const r=this.addBatchDependency(),n=yield this.getShareable();return r(),n.getShareLink(e,t)}))},Zr.prototype.checkSharingPermissions=function(e){return A(this,void 0,void 0,(function*(){const t=this.addBatchDependency(),r=yield this.getShareable();return t(),r.checkSharingPermissions(e)}))},Zr.prototype.getSharingInformation=function(e,t){return A(this,void 0,void 0,(function*(){const r=this.addBatchDependency(),n=yield this.getShareable();return r(),n.getSharingInformation(e,t)}))},Zr.prototype.getObjectSharingSettings=function(e=!0){return A(this,void 0,void 0,(function*(){const t=this.addBatchDependency(),r=yield this.getShareable();return t(),r.getObjectSharingSettings(e)}))},Zr.prototype.unshare=function(){return A(this,void 0,void 0,(function*(){const e=this.addBatchDependency(),t=yield this.getShareable();return e(),t.unshare()}))},Zr.prototype.deleteSharingLinkByKind=function(e){return A(this,void 0,void 0,(function*(){const t=this.addBatchDependency(),r=yield this.getShareable();return t(),r.deleteSharingLinkByKind(e)}))},Zr.prototype.unshareLink=function(e,t){return A(this,void 0,void 0,(function*(){const r=this.addBatchDependency(),n=yield this.getShareable();return r(),n.unshareLink(e,t)}))},Ut.prototype.shareWith=function(e,t=_i.View,r=!1,n){return ns(this,e,t,r,!1,n)},Ut.prototype.getShareLink=Xi,Ut.prototype.checkSharingPermissions=Ji,Ut.prototype.getSharingInformation=Yi,Ut.prototype.getObjectSharingSettings=Zi,Ut.prototype.unshare=es,Ut.prototype.deleteSharingLinkByKind=ts,Ut.prototype.unshareLink=rs,ft.prototype.shareWith=function(e,t=_i.View,r){return A(this,void 0,void 0,(function*(){const n=this.addBatchDependency(),i=new Je(Le(this.toUrl()),"/_api/web/url"),s=yield i.get();return n(),this.shareObject(h(s,"/_layouts/15/aclinv.aspx?forSharing=1&mbypass=1"),e,t,r)}))},ft.prototype.shareObject=function(e,t,r,n,i,s=!1,o=!1,a=!0){return Qi(this,{emailData:n,group:i,includeAnonymousLinkInEmail:o,loginNames:t,propagateAcl:s,role:r,url:e,useSimplifiedRoles:a})},ft.prototype.shareObjectRaw=function(e){return Qi(this,e,!0)},ft.prototype.unshareObject=function(e){return qe(mt(this,"unshareObject"),Re({url:e}))};class ss extends ze{constructor(e,t=""){super(Le("string"==typeof e?e:e.toUrl()),`_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.${t}`)}execute(e){return qe(this,Re(e,De({"Content-Type":"application/json;charset=utf-8"})))}createSiteDesign(e){return this.clone(as,"CreateSiteDesign").execute({info:e})}applySiteDesign(e,t){return this.clone(as,"ApplySiteDesign").execute({siteDesignId:e,webUrl:t})}getSiteDesigns(){return this.clone(as,"GetSiteDesigns").execute({})}getSiteDesignMetadata(e){return this.clone(as,"GetSiteDesignMetadata").execute({id:e})}updateSiteDesign(e){return this.clone(as,"UpdateSiteDesign").execute({updateInfo:e})}deleteSiteDesign(e){return this.clone(as,"DeleteSiteDesign").execute({id:e})}getSiteDesignRights(e){return this.clone(as,"GetSiteDesignRights").execute({id:e})}grantSiteDesignRights(e,t,r=1){return this.clone(as,"GrantSiteDesignRights").execute({grantedRights:r.toString(),id:e,principalNames:t})}revokeSiteDesignRights(e,t){return this.clone(as,"RevokeSiteDesignRights").execute({id:e,principalNames:t})}addSiteDesignTask(e,t){return this.clone(as,"AddSiteDesignTask").execute({webUrl:e,siteDesignId:t})}addSiteDesignTaskToCurrentWeb(e){return this.clone(as,"AddSiteDesignTaskToCurrentWeb").execute({siteDesignId:e})}getSiteDesignTask(e){return A(this,void 0,void 0,(function*(){const t=yield this.clone(as,"GetSiteDesignTask").execute({taskId:e});return T(t,"ID")?t:null}))}getSiteDesignRun(e,t){return this.clone(as,"GetSiteDesignRun").execute({webUrl:e,siteDesignId:t})}getSiteDesignRunStatus(e,t){return this.clone(as,"GetSiteDesignRunStatus").execute({webUrl:e,runId:t})}}$([Be("sd.createSiteDesign")],ss.prototype,"createSiteDesign",null),$([Be("sd.applySiteDesign")],ss.prototype,"applySiteDesign",null),$([Be("sd.getSiteDesigns")],ss.prototype,"getSiteDesigns",null),$([Be("sd.getSiteDesignMetadata")],ss.prototype,"getSiteDesignMetadata",null),$([Be("sd.updateSiteDesign")],ss.prototype,"updateSiteDesign",null),$([Be("sd.deleteSiteDesign")],ss.prototype,"deleteSiteDesign",null),$([Be("sd.getSiteDesignRights")],ss.prototype,"getSiteDesignRights",null),$([Be("sd.grantSiteDesignRights")],ss.prototype,"grantSiteDesignRights",null),$([Be("sd.revokeSiteDesignRights")],ss.prototype,"revokeSiteDesignRights",null),$([Be("sd.addSiteDesignTask")],ss.prototype,"addSiteDesignTask",null),$([Be("sd.addSiteDesignTaskToCurrentWeb")],ss.prototype,"addSiteDesignTaskToCurrentWeb",null),$([Be("sd.getSiteDesignTask")],ss.prototype,"getSiteDesignTask",null),$([Be("sd.getSiteDesignRun")],ss.prototype,"getSiteDesignRun",null),$([Be("sd.getSiteDesignRunStatus")],ss.prototype,"getSiteDesignRunStatus",null);const os=(e,t)=>new ss(e,t),as=(e,t="")=>os(e,t);ft.prototype.getSiteDesignRuns=function(e){return os(this,"").getSiteDesignRun(void 0,e)},ft.prototype.addSiteDesignTask=function(e){return os(this,"").addSiteDesignTaskToCurrentWeb(e)},ft.prototype.getSiteDesignRunStatus=function(e){return os(this,"").getSiteDesignRunStatus(void 0,e)},Reflect.defineProperty(ut.prototype,"siteDesigns",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>os(t).configure(e).setRuntime(r)))}}),X(ft,"siteGroups",xi),X(ft,"associatedOwnerGroup",xi,"associatedownergroup"),X(ft,"associatedMemberGroup",xi,"associatedmembergroup"),X(ft,"associatedVisitorGroup",xi,"associatedvisitorgroup"),ft.prototype.createDefaultAssociatedGroups=function(e,t,r=!1,n=!0,i){return A(this,void 0,void 0,(function*(){yield this.breakRoleInheritance(r,n);const s=this.clone(mt,"createDefaultAssociatedGroups(userLogin=@u,userLogin2=@v,groupNameSeed=@s)");return s.query.set("@u",`'${dt(t||"")}'`),s.query.set("@v",`'${dt(i||"")}'`),s.query.set("@s",`'${dt(e||"")}'`),qe(s)}))};class ls extends ze{constructor(e,t=""){super(Le("string"==typeof e?e:e.toUrl()),`_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.${t}`)}execute(e){return qe(this,Re(e))}getSiteScripts(){return this.clone(us,"GetSiteScripts",!0).execute({})}createSiteScript(e,t,r){return this.clone(us,`CreateSiteScript(Title=@title,Description=@desc)?@title='${dt(e)}'&@desc='${dt(t)}'`).execute(r)}getSiteScriptMetadata(e){return this.clone(us,"GetSiteScriptMetadata").execute({id:e})}deleteSiteScript(e){return this.clone(us,"DeleteSiteScript").execute({id:e})}updateSiteScript(e,t){return t&&(e.Content=JSON.stringify(t)),this.clone(us,"UpdateSiteScript").execute({updateInfo:e})}getSiteScriptFromList(e){return this.clone(us,"GetSiteScriptFromList").execute({listUrl:e})}getSiteScriptFromWeb(e,t){return this.clone(us,"getSiteScriptFromWeb").execute({webUrl:e,info:t})}executeSiteScriptAction(e){return this.clone(us,"executeSiteScriptAction").execute({actionDefinition:e})}}$([Be("ss.getSiteScripts")],ls.prototype,"getSiteScripts",null),$([Be("ss.createSiteScript")],ls.prototype,"createSiteScript",null),$([Be("ss.getSiteScriptMetadata")],ls.prototype,"getSiteScriptMetadata",null),$([Be("ss.deleteSiteScript")],ls.prototype,"deleteSiteScript",null),$([Be("ss.updateSiteScript")],ls.prototype,"updateSiteScript",null),$([Be("ss.getSiteScriptFromList")],ls.prototype,"getSiteScriptFromList",null),$([Be("ss.getSiteScriptFromWeb")],ls.prototype,"getSiteScriptFromWeb",null),$([Be("ss.executeSiteScriptAction")],ls.prototype,"executeSiteScriptAction",null);const cs=(e,t)=>new ls(e,t),us=(e,t="")=>cs(e,t);var ds;!function(e){e[e.Success=0]="Success",e[e.Failure=1]="Failure",e[e.NoOp=2]="NoOp",e[e.SucceededWithException=3]="SucceededWithException"}(ds||(ds={})),ft.prototype.getSiteScript=function(e){return cs(this.toUrl(),"").getSiteScriptFromWeb(void 0,e)},Pt.prototype.getSiteScript=function(){return A(this,void 0,void 0,(function*(){const e=yield this.clone(It).rootFolder.get(),t=h((yield mt(Le(this.toUrl())).select("Url").get()).Url,"Lists",e.Name);return cs(this,"").getSiteScriptFromList(t)}))},Reflect.defineProperty(ut.prototype,"siteScripts",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>cs(t).configure(e).setRuntime(r)))}}),X(ft,"siteUsers",Ti),X(ft,"currentUser",wi,"currentuser"),ft.prototype.ensureUser=function(e){return A(this,void 0,void 0,(function*(){const t=yield qe(this.clone(mt,"ensureuser"),Re({logonName:e}));return{data:t,user:wi(rt(t))}}))},ft.prototype.getUserById=function(e){return wi(this,`getUserById(${e})`)};let hs=class extends Je{get my(){return fs(this)}getFollowedSitesUri(){return A(this,void 0,void 0,(function*(){const e=yield this.clone(gs,"FollowedSitesUri").get();return e.FollowedSitesUri||e}))}getFollowedDocumentsUri(){return A(this,void 0,void 0,(function*(){const e=yield this.clone(gs,"FollowedDocumentsUri").get();return e.FollowedDocumentsUri||e}))}follow(e){return A(this,void 0,void 0,(function*(){return yield qe(this.clone(gs,"follow"),this.createSocialActorInfoRequestBody(e))}))}isFollowed(e){return A(this,void 0,void 0,(function*(){return yield qe(this.clone(gs,"isfollowed"),this.createSocialActorInfoRequestBody(e))}))}stopFollowing(e){return A(this,void 0,void 0,(function*(){return yield qe(this.clone(gs,"stopfollowing"),this.createSocialActorInfoRequestBody(e))}))}createSocialActorInfoRequestBody(e){return Re({actor:Object.assign(Fe("SP.Social.SocialActorInfo"),{Id:null},e)})}};$([Be("soc.getFollowedSitesUri")],hs.prototype,"getFollowedSitesUri",null),$([Be("soc.getFollowedDocumentsUri")],hs.prototype,"getFollowedDocumentsUri",null),$([Be("soc.follow")],hs.prototype,"follow",null),$([Be("soc.isFollowed")],hs.prototype,"isFollowed",null),$([Be("soc.stopFollowing")],hs.prototype,"stopFollowing",null),hs=$([tt("_api/social.following")],hs);const ps=e=>new hs(e),gs=(e,t)=>new hs(e,t);let ys=class extends Je{followed(e){return A(this,void 0,void 0,(function*(){const t=yield this.clone(ms,`followed(types=${e})`)();return T(t,"Followed")?t.Followed.results:t}))}followedCount(e){return A(this,void 0,void 0,(function*(){const t=yield this.clone(ms,`followedcount(types=${e})`)();return t.FollowedCount||t}))}followers(){return A(this,void 0,void 0,(function*(){const e=yield this.clone(ms,"followers")();return T(e,"Followers")?e.Followers.results:e}))}suggestions(){return A(this,void 0,void 0,(function*(){const e=yield this.clone(ms,"suggestions")();return T(e,"Suggestions")?e.Suggestions.results:e}))}};$([Be("msoc.followed")],ys.prototype,"followed",null),$([Be("msoc.followedCount")],ys.prototype,"followedCount",null),$([Be("msoc.followers")],ys.prototype,"followers",null),$([Be("msoc.suggestions")],ys.prototype,"suggestions",null),ys=$([tt("my")],ys);const fs=Ge(ys),ms=(e,t)=>fs(e,t);var vs,bs,Ss,Ps;!function(e){e[e.User=0]="User",e[e.Document=1]="Document",e[e.Site=2]="Site",e[e.Tag=3]="Tag"}(vs||(vs={})),function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.Document=2]="Document",e[e.Site=4]="Site",e[e.Tag=8]="Tag",e[e.ExcludeContentWithoutFeeds=268435456]="ExcludeContentWithoutFeeds",e[e.IncludeGroupsSites=536870912]="IncludeGroupsSites",e[e.WithinLast24Hours=1073741824]="WithinLast24Hours"}(bs||(bs={})),function(e){e[e.Ok=0]="Ok",e[e.AlreadyFollowing=1]="AlreadyFollowing",e[e.LimitReached=2]="LimitReached",e[e.InternalError=3]="InternalError"}(Ss||(Ss={})),function(e){e[e.OK=0]="OK",e[e.InvalidRequest=1]="InvalidRequest",e[e.AccessDenied=2]="AccessDenied",e[e.ItemNotFound=3]="ItemNotFound",e[e.InvalidOperation=4]="InvalidOperation",e[e.ItemNotModified=5]="ItemNotModified",e[e.InternalError=6]="InternalError",e[e.CacheReadError=7]="CacheReadError",e[e.CacheUpdateError=8]="CacheUpdateError",e[e.PersonalSiteNotFound=9]="PersonalSiteNotFound",e[e.FailedToCreatePersonalSite=10]="FailedToCreatePersonalSite",e[e.NotAuthorizedToCreatePersonalSite=11]="NotAuthorizedToCreatePersonalSite",e[e.CannotCreatePersonalSite=12]="CannotCreatePersonalSite",e[e.LimitReached=13]="LimitReached",e[e.AttachmentError=14]="AttachmentError",e[e.PartialData=15]="PartialData",e[e.FeatureDisabled=16]="FeatureDisabled",e[e.StorageQuotaExceeded=17]="StorageQuotaExceeded",e[e.DatabaseError=18]="DatabaseError"}(Ps||(Ps={})),Reflect.defineProperty(ut.prototype,"social",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>ps(t).configure(e).setRuntime(r)))}});const Is=Ge(class extends ze{constructor(e,t){super(Le("string"==typeof e?e:e.toUrl()),`_api/SP.Utilities.Utility.${t}`)}excute(e){return qe(this,Re(e))}sendEmail(e){const t={properties:v(Fe("SP.Utilities.EmailProperties"),{Body:e.Body,From:e.From,Subject:e.Subject})};return e.To&&e.To.length>0&&(t.properties=v(t.properties,{To:{results:e.To}})),e.CC&&e.CC.length>0&&(t.properties=v(t.properties,{CC:{results:e.CC}})),e.BCC&&e.BCC.length>0&&(t.properties=v(t.properties,{BCC:{results:e.BCC}})),e.AdditionalHeaders&&(t.properties=v(t.properties,{AdditionalHeaders:Nt(e.AdditionalHeaders)})),Be.configure(this.clone(Ts,"SendEmail",!0),"u.sendEmail").excute(t)}getCurrentUserEmailAddresses(){return Be.configure(this.clone(Ts,"GetCurrentUserEmailAddresses",!0),"u.getCurrentUserEmailAddresses").excute({})}resolvePrincipal(e,t,r,n,i,s=!1){const o={addToUserInfoList:i,input:e,inputIsEmailOnly:n,matchUserInfoList:s,scopes:t,sources:r},a=this.clone(Ts,"ResolvePrincipalInCurrentContext",!0);return Be.configure(a,"u.ResolvePrincipalInCurrentContext").excute(o)}searchPrincipals(e,t,r,n,i){const s={groupName:n,input:e,maxCount:i,scopes:t,sources:r},o=this.clone(Ts,"SearchPrincipalsUsingContextWeb",!0);return Be.configure(o,"u.SearchPrincipalsUsingContextWeb").excute(s)}createEmailBodyForInvitation(e){const t={pageAddress:e},r=this.clone(Ts,"CreateEmailBodyForInvitation",!0);return Be.configure(r,"u.CreateEmailBodyForInvitation").excute(t)}expandGroupsToPrincipals(e,t=30){const r={inputs:e,maxCount:t},n=this.clone(Ts,"ExpandGroupsToPrincipals",!0);return Be.configure(n,"u.ExpandGroupsToPrincipals").excute(r)}createWikiPage(e){return A(this,void 0,void 0,(function*(){const t=this.clone(Ts,"CreateWikiPageInContextWeb",!0),r=yield Be.configure(t,"u.CreateWikiPageInContextWeb").excute({parameters:e});return{data:r,file:vr(rt(r))}}))}}),Ts=(e,t)=>Is(e,t);Reflect.defineProperty(ut.prototype,"utility",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>Is(t,"").configure(e).setRuntime(r)))}});let ws=class extends Qe{getById(e){return Be.configure(Us(this).concat(`('${e}')`),"subs.getById")}add(e,t,r){return A(this,void 0,void 0,(function*(){const n={expirationDateTime:t,notificationUrl:e,resource:this.toUrl()};r&&(n.clientState=r);const i=yield qe(this,Re(n,De({"Content-Type":"application/json"})));return{data:i,subscription:this.getById(i.id)}}))}};$([Be("subs.add")],ws.prototype,"add",null),ws=$([tt("subscriptions")],ws);const Cs=Ge(ws);class xs extends Je{update(e,t,r){return A(this,void 0,void 0,(function*(){const n={};return e&&(n.expirationDateTime=e),t&&(n.notificationUrl=t),r&&(n.clientState=r),{data:yield We(this,Re(n,De({"Content-Type":"application/json"}))),subscription:this}}))}delete(){return je(this)}}$([Be("sub.update")],xs.prototype,"update",null),$([Be("sub.delete")],xs.prototype,"delete",null);const Us=Ge(xs);X(Pt,"subscriptions",Cs);let Rs=class extends Je{get groups(){return Be.configure(Ls(this),"txts.groups")}get sets(){return Be.configure(As(this),"txts.sets")}};Rs=$([tt("_api/v2.1/termstore")],Rs);const Ds=Ge(Rs);let Fs=class extends Qe{getById(e){return Be.configure(Bs(this,e),"txtgs.getById")}};Fs=$([tt("groups")],Fs);const Ls=Ge(Fs),Bs=Ge(class extends Je{get sets(){return Be.configure(As(this,"sets"),"txtg.sets")}});let $s=class extends Qe{getById(e){return Be.configure(ks(this,e),"txts.getById")}};$s=$([tt("sets")],$s);const As=Ge($s),ks=Ge(class extends Je{get terms(){return Ns(this)}get parentGroup(){return Be.configure(Bs(this,"parentGroup"),"txts.parentGroup")}get children(){return Be.configure(Os(this),"txts.children")}get relations(){return Be.configure(js(this),"txts.relations")}getTermById(e){return Be.configure(this.clone(Ms,`terms/${e}`),"txts.getTermById")}getAllChildrenAsOrderedTree(){return A(this,void 0,void 0,(function*(){const e=yield this.select("*","customSortOrder")(),t=[],r=(t,r,n)=>{let i=null;if(null===r&&n.length>0)i=[...n];else{const t=r.findIndex((t=>t.setId===e.id));t>=0&&(i=[...r[t].order])}if(null!==i){const e=[];return i.forEach((r=>{const n=t.find((e=>r===e.id));n&&e.push(n)})),e}return t},n=(e,t)=>A(this,void 0,void 0,(function*(){const i=yield e.children.select("*","customSortOrder")();for(let e=0;e<i.length;e++){const s=i[e],o=Object.assign({children:[],defaultLabel:s.labels.find((e=>e.isDefault)).name},s);s.childrenCount>0&&(yield n(this.getTermById(i[e].id),o.children),o.children=r(o.children,s.customSortOrder)),t.push(o)}}));return yield n(this,t),r(t,null,e.customSortOrder)}))}});let _s=class extends Qe{};_s=$([tt("children")],_s);const Os=Ge(_s);let Es=class extends Qe{getById(e){return Ms(this,e)}};Es=$([tt("terms")],Es);const Ns=Ge(Es),Ms=Ge(class extends Je{get parent(){return Be.configure(Ms(this,"parent"),"txt.parent")}get children(){return Be.configure(Os(this),"txt.children")}get relations(){return Be.configure(js(this),"txt.relations")}get set(){return Be.configure(ks(this,"set"),"txt.set")}});let qs=class extends Qe{getById(e){return Be.configure(Ws(this,e),"txrs.getById")}};qs=$([tt("relations")],qs);const js=Ge(qs),Ws=Ge(class extends Je{get fromTerm(){return Be.configure(Ms(this,"fromTerm"),"txr.fromTerm")}get toTerm(){return Be.configure(Ms(this,"toTerm"),"txr.toTerm")}get set(){return Be.configure(ks(this,"set"),"txr.set")}});Reflect.defineProperty(ut.prototype,"termStore",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>Ds(t).configure(e).setRuntime(r)))}}),X(Pt,"userCustomActions",ti),X(ft,"userCustomActions",ti),X(ht,"userCustomActions",ti);let Hs=class extends Qe{add(e,t=!1,r={}){return A(this,void 0,void 0,(function*(){const n=Re(Object.assign(Fe("SP.View"),{PersonalView:t,Title:e},r)),i=yield qe(this.clone(Vs,null),n);return{data:i,view:this.getById(i.Id)}}))}getById(e){return zs(this).concat(`('${e}')`)}getByTitle(e){return zs(this,`getByTitle('${e}')`)}};$([Be("vs.add")],Hs.prototype,"add",null),Hs=$([tt("views")],Hs);const Vs=Ge(Hs);class Gs extends Je{constructor(){super(...arguments),this.delete=Ze("vw"),this.update=this._update("SP.View",(e=>({data:e,view:this})))}get fields(){return Qs(this)}renderAsHtml(){return this.clone(zs,"renderashtml")()}setViewXml(e){return qe(this.clone(zs,"SetViewXml"),Re({viewXml:e}))}}$([Be("v.renderAsHtml")],Gs.prototype,"renderAsHtml",null),$([Be("v.setViewXml")],Gs.prototype,"setViewXml",null);const zs=Ge(Gs);let Ks=class extends Qe{getSchemaXml(){return this.clone(Qs,"schemaxml")()}add(e){return qe(this.clone(Qs,`addviewfield('${e}')`))}move(e,t){return qe(this.clone(Qs,"moveviewfieldto"),Re({field:e,index:t}))}removeAll(){return qe(this.clone(Qs,"removeallviewfields"))}remove(e){return qe(this.clone(Qs,`removeviewfield('${e}')`))}};$([Be("vfs.getSchemaXml")],Ks.prototype,"getSchemaXml",null),$([Be("vfs.add")],Ks.prototype,"add",null),$([Be("vfs.move")],Ks.prototype,"move",null),$([Be("vfs.removeAll")],Ks.prototype,"removeAll",null),$([Be("vfs.remove")],Ks.prototype,"remove",null),Ks=$([tt("viewfields")],Ks);const Qs=Ge(Ks);var Xs;!function(e){e[e.DefaultValue=0]="DefaultValue",e[e.Recursive=1]="Recursive",e[e.RecursiveAll=2]="RecursiveAll",e[e.FilesOnly=3]="FilesOnly"}(Xs||(Xs={})),X(Pt,"views",Vs),X(Pt,"defaultView",zs,"DefaultView"),Pt.prototype.getView=function(e){return zs(this,`getView('${e}')`)};class Js extends ze{get scope(){return Be.configure(Ke(this,"Scope"),"f.scope")}get webparts(){return eo(this,"webparts")}export(e){return qe(this.clone(Zs,"ExportWebPart"),Re({webPartId:e}))}import(e){return qe(this.clone(Zs,"ImportWebPart"),Re({webPartXml:e}))}}const Ys=(e,t)=>new Js(e,t),Zs=(e,t)=>Ys(e,t),eo=Ge(class extends Qe{getById(e){return to(this,`getbyid('${e}')`)}getByControlId(e){return to(this,`getByControlId('${e}')`)}}),to=Ge(class extends Je{get webpart(){return Ye(this,"webpart")}saveChanges(){return qe(this.clone(to,"SaveWebPartChanges"))}moveTo(e,t){return qe(this.clone(to,`MoveWebPartTo(zoneID='${e}', zoneIndex=${t})`))}close(){return qe(this.clone(to,"CloseWebPart"))}open(){return qe(this.clone(to,"OpenWebPart"))}delete(){return qe(this.clone(to,"DeleteWebPart"))}});var ro;!function(e){e[e.User=0]="User",e[e.Shared=1]="Shared"}(ro||(ro={})),mr.prototype.getLimitedWebPartManager=function(e=ro.Shared){return Ys(this,`getLimitedWebPartManager(scope=${e})`)};const no=new ut;function io(e){return function(t){return class extends t{constructor(...t){super(t[0],t.length>1&&void 0!==t[1]?t[1]:e)}}}}function so(){return function(e){return class extends e{delete(){return ir(this)}}}}function oo(){return function(e){return class extends e{delete(e="*"){return ir(this,De({"If-Match":e}))}}}}function ao(){return function(e){return class extends e{update(e){return sr(this,Re(e))}}}}function lo(){return function(e){return class extends e{update(e,t="*"){return sr(this,Re(e,De({"If-Match":t})))}}}}function co(){return function(e){return class extends e{add(e){return nr(this,Re(e))}}}}function uo(e){return function(t){return class extends t{getById(t){return e(this,t)}}}}let ho=class extends pr{get threads(){return bo(this)}};ho=$([ao(),so()],ho);const po=ar(ho);let go=class extends ur{};go=$([io("conversations"),co(),uo(po)],go);const yo=ar(go);let fo=class extends pr{get posts(){return To(this)}reply(e){return nr(this.clone(mo,"reply"),Re(e))}};fo=$([so()],fo);const mo=ar(fo);let vo=class extends ur{};vo=$([io("threads"),co(),uo(mo)],vo);const bo=ar(vo);let So=class extends pr{forward(e){return nr(this.clone(Po,"forward"),Re(e))}reply(e){return nr(this.clone(Po,"reply"),Re(e))}};So=$([so()],So);const Po=ar(So);let Io=class extends ur{};Io=$([io("posts"),co(),uo(Po)],Io);const To=ar(Io),wo=ar(class extends ur{add(e){return nr(this.clone(wo,"$ref"),Re({"@odata.id":e}))}remove(e){const t=this.clone(wo,"$ref");return t.query.set("$id",e),ir(t)}}),Co=ar(class extends pr{});let xo=class extends ur{addFile(e,t){return nr(this,Re(("#microsoft.graph.fileAttachment",r={contentBytes:t,name:e},Object.assign({"@odata.type":"#microsoft.graph.fileAttachment"},r))));var r}};xo=$([io("attachments"),uo(Co)],xo);const Uo=ar(xo);X(So,"attachments",Uo);let Ro=class extends pr{getMemberObjects(e=!1){return nr(this.clone(Do,"getMemberObjects"),Re({securityEnabledOnly:e}))}getMemberGroups(e=!1){return nr(this.clone(Do,"getMemberGroups"),Re({securityEnabledOnly:e}))}checkMemberGroups(e){return nr(this.clone(Do,"checkMemberGroups"),Re({groupIds:e}))}};Ro=$([so()],Ro);const Do=ar(Ro);let Fo=class extends ur{getByIds(e,t=Bo.directoryObject){return nr(this.clone(Lo,"getByIds"),Re({ids:e,type:t}))}};Fo=$([io("directoryObjects"),uo(Do)],Fo);const Lo=ar(Fo);var Bo,$o;!function(e){e[e.directoryObject=0]="directoryObject",e[e.user=1]="user",e[e.group=2]="group",e[e.device=3]="device"}(Bo||(Bo={})),function(e){e[e.Office365=0]="Office365",e[e.Dynamic=1]="Dynamic",e[e.Security=2]="Security"}($o||($o={}));let Ao=class extends Ro{addFavorite(){return nr(this.clone(ko,"addFavorite"))}removeFavorite(){return nr(this.clone(ko,"removeFavorite"))}resetUnseenCount(){return nr(this.clone(ko,"resetUnseenCount"))}subscribeByMail(){return nr(this.clone(ko,"subscribeByMail"))}unsubscribeByMail(){return nr(this.clone(ko,"unsubscribeByMail"))}getCalendarView(e,t){const r=this.clone(ko,"calendarView");return r.query.set("startDateTime",e.toISOString()),r.query.set("endDateTime",t.toISOString()),r()}};Ao=$([so(),ao()],Ao);const ko=ar(Ao);let _o=class extends ur{add(e,t,r,n={}){return A(this,void 0,void 0,(function*(){let i=v({displayName:e,mailEnabled:r===$o.Office365,mailNickname:t,securityEnabled:r!==$o.Office365},n);r!==$o.Security&&(i=v(i,{groupTypes:r===$o.Office365?["Unified"]:["DynamicMembership"]}));const s=yield nr(this,Re(i));return{data:s,group:this.getById(s.id)}}))}};_o=$([io("groups"),uo(ko)],_o);const Oo=ar(_o);function Eo(e,t){const r=this.clone(dr,"calendarView");return r.query.set("startDateTime",encodeURIComponent(e)),r.query.set("endDateTime",encodeURIComponent(t)),r}const No=ar(class extends pr{constructor(){super(...arguments),this.calendarView=Eo}get events(){return Vo(this)}});let Mo=class extends ur{};Mo=$([io("calendars"),uo(No)],Mo);const qo=ar(Mo);let jo=class extends pr{};jo=$([so(),ao()],jo);const Wo=ar(jo);let Ho=class extends ur{add(e){return A(this,void 0,void 0,(function*(){const t=yield nr(this,Re(e));return{data:t,event:this.getById(t.id)}}))}};Ho=$([io("events"),uo(Wo)],Ho);const Vo=ar(Ho);X(Ao,"calendar",No,"calendar"),X(Ao,"events",Vo);let Go=class extends Ro{get memberOf(){return Lo(this,"memberOf")}get people(){return Jo(this)}};Go=$([ao(),so()],Go);const zo=ar(Go);let Ko=class extends ur{};Ko=$([io("users"),uo(zo)],Ko);const Qo=ar(Ko);let Xo=class extends ur{};Xo=$([io("people")],Xo);const Jo=ar(Xo);X(Go,"calendar",No,"calendar"),X(Go,"calendars",qo,"calendars"),X(Go,"events",Vo),Go.prototype.calendarView=Eo;let Yo=class extends pr{};Yo=$([ao(),so()],Yo);const Zo=ar(Yo);let ea=class extends ur{add(e,t,r,n,i={}){return A(this,void 0,void 0,(function*(){const s=v({businessPhones:n,emailAddresses:r,givenName:e,surName:t},i),o=yield nr(this,Re(s));return{contact:this.getById(o.id),data:o}}))}};ea=$([io("contacts"),uo(Zo)],ea);const ta=ar(ea);let ra=class extends pr{get contacts(){return ta(this)}get childFolders(){return sa(this,"childFolders")}};ra=$([so(),ao()],ra);const na=ar(ra);let ia=class extends ur{add(e,t){return A(this,void 0,void 0,(function*(){const r={displayName:e,parentFolderId:t},n=yield nr(this,Re(r));return{contactFolder:this.getById(n.id),data:n}}))}};ia=$([io("contactFolders"),uo(na)],ia);const sa=ar(ia);X(Go,"contacts",ta),X(Go,"contactFolders",sa),X(Ao,"conversations",yo),X(Ao,"acceptedSenders",wo,"acceptedsenders"),X(Ao,"rejectedSenders",wo,"rejectedsenders"),Reflect.defineProperty(Qt.prototype,"directoryObjects",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>Lo(t).configure(e).setRuntime(r)))}}),Reflect.defineProperty(Qt.prototype,"groups",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>Oo(t).configure(e).setRuntime(r)))}});let oa=class extends pr{get trending(){return ua(this)}get used(){return pa(this)}get shared(){return fa(this)}};oa=$([io("insights")],oa);const aa=ar(oa),la=ar(class extends pr{get resource(){return va(this)}});let ca=class extends ur{};ca=$([io("trending"),uo(la)],ca);const ua=ar(ca),da=ar(class extends pr{get resource(){return va(this)}});let ha=class extends ur{};ha=$([io("used"),uo(da)],ha);const pa=ar(ha),ga=ar(class extends pr{get resource(){return va(this)}});let ya=class extends ur{};ya=$([io("shared"),uo(ga)],ya);const fa=ar(ya);let ma=class extends pr{};ma=$([io("resource")],ma);const va=ar(ma);X(Go,"insights",aa);let ba=class extends ur{create(e,t,r={}){return A(this,void 0,void 0,(function*(){const n=v({inviteRedirectUrl:t,invitedUserEmailAddress:e},r);return{data:yield nr(this,Re(n))}}))}};ba=$([io("invitations")],ba);const Sa=ar(ba);Reflect.defineProperty(Qt.prototype,"invitations",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>Sa(t).configure(e).setRuntime(r)))}});const Pa=ar(class extends pr{remove(){return ir(this.clone(Pa,"$ref"))}});let Ia=class extends ur{add(e){return nr(this.clone(Ta,"$ref"),Re({"@odata.id":e}))}};Ia=$([io("members"),uo(Pa)],Ia);const Ta=ar(Ia);X(Ao,"owners",Ta,"owners"),X(Ao,"members",Ta);const wa=ar(class extends pr{});let Ca=class extends ur{};Ca=$([io("messages"),uo(wa),co()],Ca);const xa=ar(Ca),Ua=ar(class extends pr{});let Ra=class extends ur{};Ra=$([io("mailFolders"),uo(Ua),co()],Ra);const Da=ar(Ra);let Fa=class extends pr{};Fa=$([io("mailboxSettings"),ao()],Fa);const La=ar(Fa);X(Go,"messages",xa),X(Go,"mailboxSettings",La),X(Go,"mailFolders",Da),Go.prototype.sendMail=function(e){return nr(this.clone(zo,"sendMail"),Re(e))};let Ba=class extends pr{get root(){return Oa(this)}get list(){return this.clone(gr,"list")}get recent(){return qa(this,"recent")}get sharedWithMe(){return qa(this,"sharedWithMe")}getItemById(e){return Na(this,h("items",e))}};Ba=$([io("drive")],Ba);const $a=ar(Ba);let Aa=class extends ur{};Aa=$([io("drives"),uo($a)],Aa);const ka=ar(Aa);let _a=class extends pr{get children(){return qa(this,"children")}search(e){const t=this.clone(Oa);return t.query.set("search",`'${e}'`),t()}get thumbnails(){return this.clone(dr,"thumbnails")}};_a=$([io("root")],_a);const Oa=ar(_a);let Ea=class extends pr{get children(){return qa(this,"children")}get thumbnails(){return this.clone(dr,"thumbnails")}get versions(){return this.clone(dr,"versions")}move(e,t){return sr(this,Re(v(e,{name:t})))}getContent(){return A(this,void 0,void 0,(function*(){const e=yield this.get(),t=yield k.fetch(e["@microsoft.graph.downloadUrl"],{headers:{accept:"application/json"},method:"GET",responseType:"arraybuffer"});return(new pe).parse(t)}))}setContent(e){return or(this.clone(Na,"content"),{body:e})}};Ea=$([so(),ao()],Ea);const Na=ar(Ea);let Ma=class extends ur{};Ma=$([uo(Na)],Ma);const qa=ar(Ma);X(Go,"drive",$a),X(Go,"drives",ka);let ja=class extends pr{get notebooks(){return Ga(this)}get sections(){return Qa(this)}get pages(){return this.clone(dr,"pages")}};ja=$([io("onenote")],ja);const Wa=ar(ja),Ha=ar(class extends pr{get sections(){return Qa(this)}});let Va=class extends ur{add(e){return A(this,void 0,void 0,(function*(){const t=yield nr(this,Re({displayName:e}));return{data:t,notebook:this.getById(t.id)}}))}};Va=$([io("notebooks"),uo(Ha)],Va);const Ga=ar(Va),za=ar(class extends pr{});let Ka=class extends ur{add(e){return A(this,void 0,void 0,(function*(){const t=yield nr(this,Re({displayName:e}));return{data:t,section:this.getById(t.id)}}))}};Ka=$([io("sections"),uo(za)],Ka);const Qa=ar(Ka);X(Go,"onenote",Wa);let Xa=class extends pr{getBlob(){return this.clone(Ja,"$value",!1).usingParser(new pe)()}getBuffer(){return this.clone(Ja,"$value",!1).usingParser(new ye)()}setContent(e){return sr(this.clone(Ja,"$value",!1),{body:e})}};Xa=$([io("photo")],Xa);const Ja=ar(Xa);X(Ao,"photo",Ja),X(Go,"photo",Ja);let Ya=class extends pr{get plans(){return sl(this)}get tasks(){return dl(this)}get buckets(){return yl(this)}};Ya=$([io("planner")],Ya);const Za=ar(Ya);let el=class extends pr{};el=$([io("details"),lo()],el);const tl=ar(el);let rl=class extends pr{get tasks(){return dl(this)}get buckets(){return yl(this)}get details(){return tl(this)}};rl=$([lo(),oo()],rl);const nl=ar(rl);let il=class extends ur{add(e,t){return A(this,void 0,void 0,(function*(){const r=yield nr(this,Re({owner:e,title:t}));return{data:r,plan:this.getById(r.id)}}))}};il=$([io("plans"),uo(nl)],il);const sl=ar(il);let ol=class extends pr{};ol=$([io("details"),lo()],ol);const al=ar(ol);let ll=class extends pr{get details(){return al(this)}};ll=$([lo(),oo()],ll);const cl=ar(ll);let ul=class extends ur{add(e,t,r,n){return A(this,void 0,void 0,(function*(){let i=v({planId:e,title:t},r);n&&(i=v(i,{bucketId:n}));const s=yield nr(this,Re(i));return{data:s,task:this.getById(s.id)}}))}};ul=$([io("tasks"),uo(cl)],ul);const dl=ar(ul);let hl=class extends pr{get tasks(){return dl(this)}};hl=$([lo(),oo()],hl);const pl=ar(hl);let gl=class extends ur{add(e,t,r){return A(this,void 0,void 0,(function*(){const n={name:e,orderHint:r||"",planId:t},i=yield nr(this,Re(n));return{bucket:this.getById(i.id),data:i}}))}};gl=$([io("buckets"),uo(pl)],gl);const yl=ar(gl);X(Ao,"plans",sl,"planner/plans"),X(Go,"tasks",dl,"planner/tasks"),Reflect.defineProperty(Qt.prototype,"planner",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>Za(t).configure(e).setRuntime(r)))}});let fl=class extends pr{};fl=$([so(),ao()],fl);const ml=ar(fl);let vl=class extends ur{add(e,t,r,n,i={}){return A(this,void 0,void 0,(function*(){const s=v({changeType:e,expirationDateTime:n,notificationUrl:t,resource:r},i),o=yield nr(this,Re(s));return{data:o,subscription:this.getById(o.id)}}))}};vl=$([io("subscriptions"),uo(ml)],vl);const bl=ar(vl);Reflect.defineProperty(Qt.prototype,"subscriptions",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>bl(t).configure(e).setRuntime(r)))}});let Sl=class extends pr{get channels(){return xl(this)}archive(e=!1){return nr(this.clone(Pl,"archive"),Re({shouldSetSpoSiteReadOnlyForMembers:e}))}unarchive(){return nr(this.clone(Pl,"unarchive"))}cloneTeam(e,t="",r="apps,tabs,settings,channels,members",n="private"){return A(this,void 0,void 0,(function*(){const i={description:t||"",displayName:e,mailNickname:e,partsToClone:r,visibility:n},s=Pl(this,"clone").usingParser({parse:e=>Promise.resolve(e.headers)}),o=yield nr(s,Re(i)),a={teamId:"",operationId:""};if(o.has("location")){const e=o.get("location").split("/");3===e.length&&(a.teamId=e[1].substring(e[1].indexOf("'")+1,e[1].lastIndexOf("'")),a.operationId=e[2].substring(e[2].indexOf("'")+1,e[2].lastIndexOf("'")))}return a}))}getOperationById(e){return gr(this,`operations/${e}`)()}};Sl=$([io("team"),ao()],Sl);const Pl=ar(Sl);let Il=class extends ur{create(e){return A(this,void 0,void 0,(function*(){const t=Tl(this,null).usingParser({parse:e=>Promise.resolve(e.headers)}),r=yield nr(t,Re(e)),n={teamId:"",operationId:""};if(r.has("location")){const e=r.get("location").split("/");3===e.length&&(n.teamId=e[1].substring(e[1].indexOf("'")+1,e[1].lastIndexOf("'")),n.operationId=e[2].substring(e[2].indexOf("'")+1,e[2].lastIndexOf("'")))}return n}))}};Il=$([io("teams"),uo(Pl)],Il);const Tl=ar(Il),wl=ar(class extends pr{get tabs(){return Fl(this)}});let Cl=class extends ur{add(e,t=""){return A(this,void 0,void 0,(function*(){const r={description:t,displayName:e},n=yield nr(this,Re(r));return{channel:this.getById(n.id),data:n}}))}};Cl=$([io("channels"),uo(wl)],Cl);const xl=ar(Cl);let Ul=class extends pr{};Ul=$([io("tab"),ao(),so()],Ul);const Rl=ar(Ul);let Dl=class extends ur{add(e,t,r){return A(this,void 0,void 0,(function*(){const n=v({displayName:e,"teamsApp@odata.bind":t},r),i=yield nr(this,Re(n));return{data:i,tab:this.getById(i.id)}}))}};Dl=$([io("tabs"),uo(Rl)],Dl);const Fl=ar(Dl);X(Go,"joinedTeams",Tl,"joinedTeams"),X(Ao,"team",Pl),Ao.prototype.createTeam=function(e){return A(this,void 0,void 0,(function*(){return{data:yield or(this.clone(ko,"team"),Re(e)),team:this.team}}))},Reflect.defineProperty(Qt.prototype,"teams",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>Tl(t).configure(e).setRuntime(r)))}}),Reflect.defineProperty(Qt.prototype,"me",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>zo(t,"me").configure(e).setRuntime(r)))}}),Reflect.defineProperty(Qt.prototype,"users",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook((({options:e,baseUrl:t,runtime:r})=>Qo(t).configure(e).setRuntime(r)))}});const Ll={assign:v,combine:h,dateAdd:d,getCtxCallback:u,getGUID:g,getRandomString:p,isArray:m,isFunc:y,isUrlAbsolute:b,objectDefinedNotNull:f,sanitizeGuid:P,stringIsNullOrEmpty:S},Bl=Ht,$l=Xt,Al=new H,kl=new V,_l=o,Ol=function(e){B.assign(e)},El={config:kl,graph:$l,log:o,setup:Ol,sp:Bl,storage:Al,util:Ll}}},t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}return r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r(132)})()}));
//# sourceMappingURL=pnp.js.map