/*
Copyright (c) 2020 Daybrush
name: selecto
license: MIT
author: Daybrush
repository: git+https://github.com/daybrush/selecto.git
version: 1.6.2
*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).Selecto=e()}(this,function(){"use strict";var c=function(t,e){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var u=function(){return(u=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function a(t){return void 0===t}var t=function(){var t=function(){function t(){this._eventHandler={},this.options={}}var e=t.prototype;return e.trigger=function(t,e){void 0===e&&(e={});var n=this._eventHandler[t]||[];if(!(0<n.length))return!0;n=n.concat(),e.eventType=t;var r=!1,i=[e],o=0;e.stop=function(){r=!0},e.currentTarget=this;for(var s=arguments.length,a=new Array(2<s?s-2:0),c=2;c<s;c++)a[c-2]=arguments[c];for(1<=a.length&&(i=i.concat(a)),o=0;n[o];o++)n[o].apply(this,i);return!r},e.once=function(i,o){if("object"==typeof i&&a(o)){var t,e=i;for(t in e)this.once(t,e[t]);return this}if("string"==typeof i&&"function"==typeof o){var s=this;this.on(i,function t(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];o.apply(s,n),s.off(i,t)})}return this},e.hasOn=function(t){return!!this._eventHandler[t]},e.on=function(t,e){if("object"==typeof t&&a(e)){var n,r=t;for(n in r)this.on(n,r[n]);return this}if("string"==typeof t&&"function"==typeof e){var i=this._eventHandler[t];a(i)&&(this._eventHandler[t]=[],i=this._eventHandler[t]),i.push(e)}return this},e.off=function(t,e){if(a(t))return this._eventHandler={},this;if(a(e)){if("string"==typeof t)return this._eventHandler[t]=void 0,this;var n,r=t;for(n in r)this.off(n,r[n]);return this}var i,o,s=this._eventHandler[t];if(s)for(i=0;void 0!==(o=s[i]);i++)if(o===e){s=s.splice(i,1);break}return this},t}();return t.VERSION="2.1.2",t}(),h=['"',"'",'\\"',"\\'"];function f(t,e,n,r){for(var i=n;i<r;++i){var o=e[i].trim();if(o===t)return i;var s=i;if("("===o?s=f(")",e,i+1,r):-1<h.indexOf(o)&&(s=f(o,e,i+1,r)),-1===s)break;i=s}return-1}function s(t){return function(t,e){for(var n=new RegExp("(\\s*"+(e||",")+"\\s*|\\(|\\)|\"|'|\\\\\"|\\\\'|\\s+)","g"),r=t.split(n).filter(Boolean),i=r.length,o=[],s=[],a=0;a<i;++a){var c=r[a].trim(),l=a;if("("===c)l=f(")",r,a+1,i);else{if(")"===c)throw new Error("invalid format");if(-1<h.indexOf(c))l=f(c,r,a+1,i);else if(c===e){s.length&&(o.push(s.join("")),s=[]);continue}}-1===l&&(l=i-1),s.push(r.slice(a,l+1).join("")),a=l}return s.length&&o.push(s.join("")),o}(t,",")}function E(){return Date.now?Date.now():(new Date).getTime()}function D(t,e,n,r){t.addEventListener(e,n,r)}function w(t,e,n){t.removeEventListener(e,n)}var S=function(){return(S=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function d(t){return 180*(e=[t[0].clientX,t[0].clientY],n=[t[1].clientX,t[1].clientY],r=n[0]-e[0],i=n[1]-e[1],(0<=(o=Math.atan2(i,r))?o:o+2*Math.PI)/Math.PI);var e,n,r,i,o}function p(t,e,n,r){var i=m(t),o=m(e),s=m(r);return T(l(r[0],b(i,s)),l(r[0],b(o,s)),n[0])}function k(t){return t.touches?y(t.touches):[i(t)]}function T(t,e,n){var r=t.clientX,i=t.clientY;return{clientX:r,clientY:i,deltaX:r-e.clientX,deltaY:i-e.clientY,distX:r-n.clientX,distY:i-n.clientY}}function g(t){return Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2))}function v(t,n,r){return t.map(function(t,e){return T(t,n[e],r[e])})}function y(t){for(var e=Math.min(t.length,2),n=[],r=0;r<e;++r)n.push(i(t[r]));return n}function i(t){return{clientX:t.clientX,clientY:t.clientY}}function m(t){return 1===t.length?t[0]:{clientX:(t[0].clientX+t[1].clientX)/2,clientY:(t[0].clientY+t[1].clientY)/2}}function l(t,e){return{clientX:t.clientX+e.clientX,clientY:t.clientY+e.clientY}}function b(t,e){return{clientX:t.clientX-e.clientX,clientY:t.clientY-e.clientY}}var O=["textarea","input"],C=function(){function t(t,e){var C=this;void 0===e&&(e={}),this.options={},this.flag=!1,this.pinchFlag=!1,this.datas={},this.isDrag=!1,this.isPinch=!1,this.isMouse=!1,this.isTouch=!1,this.prevClients=[],this.startClients=[],this.movement=0,this.startPinchClients=[],this.startDistance=0,this.customDist=[0,0],this.targets=[],this.prevTime=0,this.isDouble=!1,this.startRotate=0,this.onDragStart=function(t,e){if(void 0===e&&(e=!0),C.flag||!1!==t.cancelable){var n=C.options,r=n.container,i=n.pinchOutside,o=n.dragstart,s=n.preventRightClick,a=n.preventDefault,c=n.checkInput,l=C.isTouch;if(!C.flag){var u=document.activeElement,h=t.target,f=h.tagName.toLowerCase(),d=-1<O.indexOf(f),p=h.isContentEditable;if(d||p){if(c||u===h)return!1;if(u&&p&&u.isContentEditable&&u.contains(h))return!1}else if((a||"touchstart"===t.type)&&u){var g=u.tagName;(u.isContentEditable||-1<O.indexOf(g))&&u.blur()}}var v,y=0;if(!C.flag&&l&&i&&(y=setTimeout(function(){D(r,"touchstart",C.onDragStart,{passive:!1})})),C.flag&&l&&i&&w(r,"touchstart",C.onDragStart),(v=t).touches&&2<=v.touches.length){if(clearTimeout(y),!C.flag&&t.touches.length!==t.changedTouches.length)return;C.pinchFlag||C.onPinchStart(t)}if(!C.flag){var m=C.startClients[0]?C.startClients:k(t);C.customDist=[0,0],C.flag=!0,C.isDrag=!1,C.startClients=m,C.prevClients=m,C.datas={};var b=T(m[C.movement=0],C.prevClients[0],C.startClients[0]);if(s&&(3===t.which||2===t.button))return clearTimeout(y),C.initDrag(),!1;!1===(o&&o(S({type:"dragstart",datas:C.datas,inputEvent:t,isTrusted:e},b)))&&(clearTimeout(y),C.initDrag()),C.isDouble=E()-C.prevTime<200,C.flag&&a&&t.preventDefault()}}},this.onDrag=function(t,e){if(C.flag){var n=k(t);C.pinchFlag&&C.onPinch(t,n);var r=C.move([0,0],t,n);if(r&&(r.deltaX||r.deltaY)){var i=C.options.drag;i&&i(S({},r,{isScroll:!!e,inputEvent:t}))}}},this.onDragEnd=function(t){if(C.flag){var e=C.options,n=e.dragend,r=e.pinchOutside,i=e.container;C.isTouch&&r&&w(i,"touchstart",C.onDragStart),C.pinchFlag&&C.onPinchEnd(t),C.flag=!1;var o=C.prevClients,s=C.startClients,a=C.pinchFlag?p(o,o,s,C.startPinchClients):T(o[0],o[0],s[0]),c=E(),l=!C.isDrag&&C.isDouble;C.prevTime=C.isDrag||l?0:c,C.startClients=[],C.prevClients=[],n&&n(S({type:"dragend",datas:C.datas,isDouble:l,isDrag:C.isDrag,inputEvent:t},a))}};var n=[].concat(t);this.options=S({checkInput:!1,container:1<n.length?window:n[0],preventRightClick:!0,preventDefault:!0,pinchThreshold:0,events:["touch","mouse"]},e);var r=this.options,i=r.container,o=r.events;if(this.isTouch=-1<o.indexOf("touch"),this.isMouse=-1<o.indexOf("mouse"),this.customDist=[0,0],this.targets=n,this.isMouse&&(n.forEach(function(t){D(t,"mousedown",C.onDragStart)}),D(i,"mousemove",this.onDrag),D(i,"mouseup",this.onDragEnd),D(i,"contextmenu",this.onDragEnd)),this.isTouch){var s={passive:!1};n.forEach(function(t){D(t,"touchstart",C.onDragStart,s)}),D(i,"touchmove",this.onDrag,s),D(i,"touchend",this.onDragEnd,s),D(i,"touchcancel",this.onDragEnd,s)}}var e=t.prototype;return e.isDragging=function(){return this.isDrag},e.isFlag=function(){return this.flag},e.isPinchFlag=function(){return this.pinchFlag},e.isPinching=function(){return this.isPinch},e.scrollBy=function(e,n,t,r){void 0===r&&(r=!0),this.flag&&(this.startClients.forEach(function(t){t.clientX-=e,t.clientY-=n}),this.prevClients.forEach(function(t){t.clientX-=e,t.clientY-=n}),r&&this.onDrag(t,!0))},e.move=function(t,e,n){var r=t[0],i=t[1];void 0===n&&(n=this.prevClients);var o=this.customDist,s=this.prevClients,a=this.startClients,c=this.pinchFlag?p(n,s,a,this.startPinchClients):T(n[0],s[0],a[0]);o[0]+=r,o[1]+=i,c.deltaX+=r,c.deltaY+=i;var l=c.deltaX,u=c.deltaY;return c.distX+=o[0],c.distY+=o[1],this.movement+=Math.sqrt(l*l+u*u),this.prevClients=n,this.isDrag=!0,S({type:"drag",datas:this.datas},c,{movement:this.movement,isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:e})},e.onPinchStart=function(t){var e,n,r=this.options,i=r.pinchstart,o=r.pinchThreshold;if(!(this.isDrag&&this.movement>o)){var s=y(t.changedTouches);if(this.pinchFlag=!0,(e=this.startClients).push.apply(e,s),(n=this.prevClients).push.apply(n,s),this.startDistance=g(this.prevClients),this.startPinchClients=this.prevClients.slice(),i){var a=this.prevClients,c=m(a),l=T(c,c,c);this.startRotate=d(a),i(S({type:"pinchstart",datas:this.datas,angle:this.startRotate,touches:v(a,a,a)},l,{inputEvent:t}))}}},e.onPinch=function(t,e){if(this.flag&&this.pinchFlag&&!(e.length<2)){this.isPinch=!0;var n=this.options.pinch;if(n){var r=this.prevClients,i=this.startClients,o=T(m(e),m(r),m(i)),s=d(e),a=g(e);n(S({type:"pinch",datas:this.datas,movement:this.movement,angle:s,rotation:s-this.startRotate,touches:v(e,r,i),scale:a/this.startDistance,distance:a},o,{inputEvent:t}))}}},e.onPinchEnd=function(t){if(this.flag&&this.pinchFlag){var e=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var n=this.options.pinchend;if(n){var r=this.prevClients,i=this.startClients,o=T(m(r),m(r),m(i));n(S({type:"pinchend",datas:this.datas,isPinch:e,touches:v(r,r,i)},o,{inputEvent:t})),this.isPinch=!1,this.pinchFlag=!1}}},e.triggerDragStart=function(t){this.onDragStart(t,!1)},e.unset=function(){var e=this,t=this.targets,n=this.options.container;this.isMouse&&(t.forEach(function(t){w(t,"mousedown",e.onDragStart)}),w(n,"mousemove",this.onDrag),w(n,"mouseup",this.onDragEnd),w(n,"contextmenu",this.onDragEnd)),this.isTouch&&(t.forEach(function(t){w(t,"touchstart",e.onDragStart)}),w(n,"touchstart",this.onDragStart),w(n,"touchmove",this.onDrag),w(n,"touchend",this.onDragEnd),w(n,"touchcancel",this.onDragEnd))},e.initDrag=function(){this.startClients=[],this.prevClients=[],this.flag=!1},t}();var _=function(){function t(){this.keys=[],this.values=[]}var e=t.prototype;return e.get=function(t){return this.values[this.keys.indexOf(t)]},e.set=function(t,e){var n=this.keys,r=this.values,i=n.indexOf(t),o=-1===i?n.length:i;n[o]=t,r[o]=e},t}(),x=function(){function t(){this.object={}}var e=t.prototype;return e.get=function(t){return this.object[t]},e.set=function(t,e){this.object[t]=e},t}(),P="function"==typeof Map,o=function(){function t(){}var e=t.prototype;return e.connect=function(t,e){this.prev=t,this.next=e,t&&(t.next=this),e&&(e.prev=this)},e.disconnect=function(){var t=this.prev,e=this.next;t&&(t.next=e),e&&(e.prev=t)},e.getIndex=function(){for(var t=this,e=-1;t;)t=t.prev,++e;return e},t}();var K=function(){function t(t,e,n,r,i,o,s,a){this.prevList=t,this.list=e,this.added=n,this.removed=r,this.changed=i,this.maintained=o,this.changedBeforeAdded=s,this.fixed=a}var e=t.prototype;return Object.defineProperty(e,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(e,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),e.caculateOrdered=function(){var t,n,a,c,e=(t=this.changedBeforeAdded,n=this.fixed,a=[],c=[],t.forEach(function(t){var e=t[0],n=t[1],r=new o;a[e]=r,c[n]=r}),a.forEach(function(t,e){t.connect(a[e-1])}),t.filter(function(t,e){return!n[e]}).map(function(t,e){var n=t[0],r=t[1];if(n===r)return[0,0];var i=a[n],o=c[r-1],s=i.getIndex();return i.disconnect(),o?i.connect(o,o.next):i.connect(void 0,a[0]),[s,i.getIndex()]})),l=this.changed,u=[];this.cacheOrdered=e.filter(function(t,e){var n=t[0],r=t[1],i=l[e],o=i[0],s=i[1];if(n!==r)return u.push([o,s]),!0}),this.cachePureChanged=u},t}();function r(t,e,n){var r=P?Map:n?x:_,i=n||function(t){return t},o=[],s=[],a=[],c=t.map(i),l=e.map(i),u=new r,h=new r,f=[],d=[],p={},g=[],v=0,y=0;return c.forEach(function(t,e){u.set(t,e)}),l.forEach(function(t,e){h.set(t,e)}),c.forEach(function(t,e){var n=h.get(t);void 0===n?(++y,s.push(e)):p[n]=y}),l.forEach(function(t,e){var n=u.get(t);void 0===n?(o.push(e),++v):(a.push([n,e]),y=p[e]||0,f.push([n-y,e-v]),d.push(e===n),n!==e&&g.push([n,e]))}),s.reverse(),new K(t,e,o,s,g,a,f,d)}var Y=function(t,e){return(Y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var e,j="function"==typeof Map?void 0:(e=0,function(t){return t.__DIFF_KEY__||(t.__DIFF_KEY__=++e)}),X=function(e){function t(){this.constructor=n}var n,r;function i(t){return void 0===t&&(t=[]),e.call(this,t,j)||this}return Y(n=i,r=e),n.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t),i}(function(){function t(t,e){void 0===t&&(t=[]),this.findKeyCallback=e,this.list=[].slice.call(t)}return t.prototype.update=function(t){var e=[].slice.call(t),n=r(this.list,e,this.findKeyCallback);return this.list=e,n},t}());function R(t,e){return r(t,e,j)}var M=function(t,e){return(M=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function A(t){var e=t.container;return[e.scrollLeft,e.scrollTop]}var N=function(e){function t(){this.constructor=n}var n,r;function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.startRect=null,t.startPos=[],t.prevTime=0,t.timer=0,t}M(n=i,r=e),n.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t);var o=i.prototype;return o.dragStart=function(t,e){var n=e.container.getBoundingClientRect(),r=n.top,i=n.left,o=n.width,s=n.height;this.startPos=[t.clientX,t.clientY],this.startRect={top:r,left:i,width:o,height:s}},o.drag=function(t,e){var n=this,r=t.clientX,i=t.clientY,o=e.container,s=e.threshold,a=void 0===s?0:s,c=e.throttleTime,l=void 0===c?0:c,u=e.getScrollPosition,h=void 0===u?A:u,f=this.startRect,d=this.startPos,p=E(),g=Math.max(l+this.prevTime-p,0),v=[0,0];if(f.top>i-a?(d[1]>f.top||i<d[1])&&(v[1]=-1):f.top+f.height<i+a&&(d[1]<f.top+f.height||i>d[1])&&(v[1]=1),f.left>r-a?(d[0]>f.left||r<d[0])&&(v[0]=-1):f.left+f.width<r+a&&(d[0]<f.left+f.width||r>d[0])&&(v[0]=1),clearTimeout(this.timer),!v[0]&&!v[1])return!1;if(0<g)return this.timer=window.setTimeout(function(){n.drag(t,e)},g),!1;this.prevTime=p;var y=h({container:o,direction:v});this.trigger("scroll",{container:o,direction:v,inputEvent:t});var m=h({container:o,direction:v}),b=m[0]-y[0],C=m[1]-y[1];return!(!b&&!C)&&(this.trigger("move",{offsetX:v[0]?b:0,offsetY:v[1]?C:0,inputEvent:t}),l&&(this.timer=window.setTimeout(function(){n.drag(t,e)},l)),!0)},o.dragEnd=function(){clearTimeout(this.timer)},i}(t),I=function(t,e){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var n,F=(function(t,e){function n(t){if(t&&"object"==typeof t){var e=t.which||t.keyCode||t.charCode;e&&(t=e)}if("number"==typeof t)return s[t];var n,r=String(t);return(n=i[r.toLowerCase()])?n:(n=o[r.toLowerCase()])||(1===r.length?r.charCodeAt(0):void 0)}n.isEventKey=function(t,e){if(t&&"object"==typeof t){var n=t.which||t.keyCode||t.charCode;if(null==n)return!1;if("string"==typeof e){var r;if(r=i[e.toLowerCase()])return r===n;if(r=o[e.toLowerCase()])return r===n}else if("number"==typeof e)return e===n;return!1}};var i=(e=t.exports=n).code=e.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},o=e.aliases={windows:91,"⇧":16,"⌥":18,"⌃":17,"⌘":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};for(r=97;r<123;r++)i[String.fromCharCode(r)]=r-32;for(var r=48;r<58;r++)i[r-48]=r;for(r=1;r<13;r++)i["f"+r]=r+111;for(r=0;r<10;r++)i["numpad "+r]=r+96;var s=e.names=e.title={};for(r in i)s[i[r]]=r;for(var a in o)i[a]=o[a]}(n={exports:{}},n.exports),n.exports),B=(F.code,F.codes,F.aliases,F.names);F.title;function L(t){return Array.isArray(t)}function H(t){return"string"==typeof t}function q(t,e,n,r){t.addEventListener(e,n,r)}function U(t,e,n){t.removeEventListener(e,n)}var z,V={"+":"plus","left command":"meta","right command":"meta"},G={shift:1,ctrl:2,alt:3,meta:4};function $(t){var e=B[t]||"";for(var n in V)e=e.replace(n,V[n]);return e.replace(/\s/g,"")}function J(t,e){void 0===e&&(e=$(t.keyCode));var n,r=[(n=t).shiftKey&&"shift",n.ctrlKey&&"ctrl",n.altKey&&"alt",n.metaKey&&"meta"].filter(Boolean);return-1===r.indexOf(e)&&r.push(e),r.filter(Boolean)}function Q(t){var e=t.slice();return e.sort(function(t,e){return(G[t]||5)-(G[e]||5)}),e}var W=function(n){function t(){this.constructor=e}var e,r;function i(t){void 0===t&&(t=window);var e=n.call(this)||this;return e.container=t,e.ctrlKey=!1,e.altKey=!1,e.shiftKey=!1,e.metaKey=!1,e.clear=function(){return e.ctrlKey=!1,e.altKey=!1,e.shiftKey=!1,e.metaKey=!1,e},e.keydownEvent=function(t){e.triggerEvent("keydown",t)},e.keyupEvent=function(t){e.triggerEvent("keyup",t)},e.blur=function(){e.clear(),e.trigger("blur")},q(t,"blur",e.blur),q(t,"keydown",e.keydownEvent),q(t,"keyup",e.keyupEvent),e}I(e=i,r=n),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t);var o=i.prototype;return Object.defineProperty(i,"global",{get:function(){return z=z||new i},enumerable:!1,configurable:!0}),i.setGlobal=function(){return this.global},o.destroy=function(){var t=this.container;this.clear(),this.off(),U(t,"blur",this.blur),U(t,"keydown",this.keydownEvent),U(t,"keyup",this.keyupEvent)},o.keydown=function(t,e){return this.addEvent("keydown",t,e)},o.offKeydown=function(t,e){return this.removeEvent("keydown",t,e)},o.offKeyup=function(t,e){return this.removeEvent("keyup",t,e)},o.keyup=function(t,e){return this.addEvent("keyup",t,e)},o.addEvent=function(t,e,n){return L(e)?this.on(t+"."+Q(e).join("."),n):H(e)?this.on(t+"."+e,n):this.on(t,e),this},o.removeEvent=function(t,e,n){return L(e)?this.off(t+"."+Q(e).join("."),n):H(e)?this.off(t+"."+e,n):this.off(t,e),this},o.triggerEvent=function(t,e){this.ctrlKey=e.ctrlKey,this.shiftKey=e.shiftKey,this.altKey=e.altKey,this.metaKey=e.metaKey;var n=$(e.keyCode),r={key:n,isToggle:"ctrl"===n||"shift"===n||"meta"===n||"alt"===n,inputEvent:e,keyCode:e.keyCode,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey};this.trigger(t,r),this.trigger(t+"."+n,r);var i=J(e,n);1<i.length&&this.trigger(t+"."+i.join("."),r)},i}(t);function Z(t,e,n){var r=t.tag,i=t.children,o=t.attributes,s=t.className,a=t.style,c=e||document.createElement(r);for(var l in o)c.setAttribute(l,o[l]);var u=c.children;if(i.forEach(function(t,e){Z(t,u[e],c)}),s&&s.split(" ").forEach(function(t){var e,n,r,i;i=t,((r=c).classList?r.classList.contains(i):r.className.match(new RegExp("(\\s|^)"+i+"(\\s|$)")))||(n=t,(e=c).classList?e.classList.add(n):e.className+=" "+n)}),a){var h=c.style;for(var l in a)h[l]=a[l]}return!e&&n&&n.appendChild(c),c}function tt(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=e||{},o=i.className,s=i.style;return{tag:t,className:void 0===o?"":o,style:void 0===s?{}:s,attributes:function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}(i,["className","style"]),children:n}}function et(t,e,n){t!==e&&n(t,e)}function nt(t,e){var n=t.distX,r=void 0===n?0:n,i=t.distY,o=void 0===i?0:i,s=t.datas,a=s.startX,c=s.startY;if(0<e){var l=Math.sqrt((r*r+o*o)/(1+e*e));r=(0<=r?1:-1)*(e*l),o=(0<=o?1:-1)*l}var u=Math.min(0,r),h=Math.min(0,o),f=Math.abs(r),d=Math.abs(o),p=a+u,g=c+h;return{left:p,top:g,right:p+f,bottom:g+d,width:f,height:d}}var rt,it,ot,st,at=(ot="rCS"+function(t){for(var e=5381,n=t.length;n;)e=33*e^t.charCodeAt(--n);return e>>>0}(rt="\n:host {\n    position: fixed;\n    display: none;\n    border: 1px solid #4af;\n    background: rgba(68, 170, 255, 0.5);\n    z-index: 100;\n}\n").toString(36),st=0,{className:ot,inject:function(t,e){void 0===e&&(e={});var n,r=function(t){if(t&&t.getRootNode){var e=t.getRootNode();if(11===e.nodeType)return e}}(t),i=0===st;return(r||i)&&(n=function(n,t,e,r){var i=document.createElement("style");i.setAttribute("type","text/css"),i.setAttribute("data-styled-id",n),e.nonce&&i.setAttribute("nonce",e.nonce);var o=t;return e.original||(o=t.replace(/([^}{]*){/gm,function(t,e){return s(e).map(function(t){return-1<t.indexOf(":global")?t.replace(/\:global/g,""):-1<t.indexOf(":host")?""+t.replace(/\:host/g,"."+n):"."+n+" "+t}).join(", ")+"{"})),i.innerHTML=o,(r||document.head||document.body).appendChild(i),i}(ot,rt,e,r)),i&&(it=n),r||++st,{destroy:function(){r?(t.removeChild(n),n=null):(0<st&&--st,0===st&&it&&(it.parentNode.removeChild(it),it=null))}}}}),ct="selecto-selection "+at.className,lt=["selectableTargets","selectByClick","selectFromInside","continueSelect","toggleContinueSelect","keyContainer","hitRate","scrollOptions","checkInput","preventDefault","ratio"],ut=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}(["dragContainer","cspNonce"],lt),ht={target:null,container:null,dragContainer:null,selectableTargets:Array,selectByClick:Boolean,selectFromInside:Boolean,continueSelect:Boolean,toggleContinueSelect:Array,keyContainer:null,hitRate:Number,scrollOptions:Object,checkInput:Boolean,preventDefault:Boolean,cspNonce:String,ratio:Number},ft=function(e){function t(){this.constructor=n}var n,r;function i(t){void 0===t&&(t={});var b=e.call(this)||this;return b.selectedTargets=[],b.differ=new X,b.dragScroll=new N,b.onDragStart=function(t,e){var n=t.datas,r=t.clientX,i=t.clientY,o=t.inputEvent,s=b.options,a=s.continueSelect,c=s.selectFromInside,l=s.selectByClick,u=b.getSelectableTargets(),h=u.map(function(t){var e=t.getBoundingClientRect(),n=e.left,r=e.top,i=e.width,o=e.height;return{left:n,top:r,right:n+i,bottom:r+o,width:i,height:o}});n.selectableTargets=u,n.selectableRects=h,n.startSelectedTargets=b.selectedTargets;var f={left:r,top:i,right:r,bottom:i,width:0,height:0},d=[];if(c||l){for(var p=e||document.elementFromPoint(r,i);p&&!(-1<u.indexOf(p));)p=p.parentElement;d=p?[p]:[]}var g=0<d.length,v=!c&&g;if(v&&!l)return!1;var y=o.type;if(!(!("mousedown"===y||"touchstart"===y)||b.trigger("dragStart",t)))return!1;if(a?d=b.passSelectedTargets(d):b.selectedTargets=[],b.select(d,f,o,!0),n.startX=r,n.startY=i,n.selectedTargets=d,b.target.style.cssText+="left:0px;top:0px;transform: translate("+r+"px, "+i+"px)",v&&l)return b.onDragEnd(t),o.preventDefault(),!1;"touchstart"===y&&o.preventDefault();var m=b.options.scrollOptions;return m&&m.container&&b.dragScroll.dragStart(t,m),!0},b.onDrag=function(t){var e=b.options.scrollOptions;e&&e.container&&b.dragScroll.drag(t,e)||b.check(t)},b.onDragEnd=function(t){var e=t.datas,n=nt(t,b.options.ratio);b.dragScroll.dragEnd(),b.target.style.cssText+="display: none;",b.trigger("dragEnd",u(u({},t),{rect:n})),b.selectEnd(e.startSelectedTargets,e.selectedTargets,n,t),b.selectedTargets=e.selectedTargets},b.onKeyDown=function(t){b.sameCombiKey(t)&&(b.continueSelect=!0,b.trigger("keydown",{}))},b.onKeyUp=function(t){b.sameCombiKey(t,!0)&&(b.continueSelect=!1,b.trigger("keyup",{}))},b.onBlur=function(){b.toggleContinueSelect&&b.continueSelect&&b.trigger("keyup",{})},b.onDocumentSelectStart=function(e){if(b.dragger.isFlag()){var t=b.dragContainer;t===window&&(t=document.documentElement);var n=t instanceof Element?[t]:[].slice.call(t),r=e.target;n.some(function(t){if(t===r||t.contains(r))return e.preventDefault(),!0})}},b.target=t.target,b.container=t.container,b.options=u({target:null,container:null,dragContainer:null,selectableTargets:[],selectByClick:!0,selectFromInside:!0,hitRate:100,continueSelect:!1,toggleContinueSelect:null,keyContainer:null,scrollOptions:void 0,checkInput:!1,preventDefault:!1,cspNonce:"",ratio:0},t),b.initElement(),b.initDragScroll(),b.setKeyController(),b}c(n=i,r=e),n.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t);var o,s,a=i.prototype;return a.setSelectedTargets=function(t){return this.selectedTargets=t,this.differ=new X(t),this},a.getSelectedTargets=function(){return this.selectedTargets},a.setKeyContainer=function(t){var e=this,n=this.options;et(n.keyContainer,t,function(){n.keyContainer=t,e.setKeyController()})},a.setToggleContinueSelect=function(t){var e=this,n=this.options;et(n.toggleContinueSelect,t,function(){n.toggleContinueSelect=t,e.setKeyEvent()})},a.setPreventDefault=function(t){this.dragger.options.preventDefault=t},a.setCheckInput=function(t){this.dragger.options.checkInput=t},a.triggerDragStart=function(t){return this.dragger.triggerDragStart(t),this},a.destroy=function(){this.off(),this.keycon&&this.keycon.destroy(),this.dragger.unset(),this.injectResult.destroy(),w(document,"selectstart",this.onDocumentSelectStart),this.keycon=null,this.dragger=null,this.injectResult=null,this.target=null,this.container=null,this.options=null},a.clickTarget=function(t,e){var n=function(t){if("touches"in t){var e=t.touches[0]||t.changedTouches[0];return{clientX:e.clientX,clientY:e.clientY}}return{clientX:t.clientX,clientY:t.clientY}}(t),r={datas:{},clientX:n.clientX,clientY:n.clientY,inputEvent:t};return this.onDragStart(r,e)&&this.onDragEnd(r),this},a.setKeyController=function(){var t=this.options,e=t.keyContainer,n=t.toggleContinueSelect;this.keycon&&(this.keycon.destroy(),this.keycon=null),n&&(this.keycon=new W(e||window),this.keycon.keydown(this.onKeyDown).keyup(this.onKeyUp).on("blur",this.onBlur))},a.setKeyEvent=function(){this.options.toggleContinueSelect&&!this.keycon&&this.setKeyController()},a.initElement=function(){this.target=Z(tt("div",{className:ct}),this.target,this.container);var t=this.target,e=this.options,n=e.dragContainer,r=e.checkInput,i=e.preventDefault;this.dragContainer="string"==typeof n?[].slice.call(document.querySelectorAll(n)):this.options.dragContainer||this.target.parentNode,this.dragger=new C(this.dragContainer,{container:window,checkInput:r,preventDefault:i,dragstart:this.onDragStart,drag:this.onDrag,dragend:this.onDragEnd}),D(document,"selectstart",this.onDocumentSelectStart),this.injectResult=at.inject(t,{nonce:this.options.cspNonce})},a.hitTest=function(t,p,g,e,v){var n=this.options,y=n.hitRate,m=n.selectByClick,b=t.left,C=t.top,E=t.right,D=t.bottom;return e.filter(function(t,e){var n=v[e],r=n.left,i=n.top,o=n.right,s=n.bottom,a=r<=p&&p<=o&&i<=g&&g<=s,c=(o-r)*(s-i),l=Math.max(r,b),u=Math.min(o,E),h=Math.max(i,C),f=Math.min(s,D);if(m&&a)return!0;if(u<l||f<h)return!1;var d=Math.round((u-l)*(f-h)/c*100);return y<=d})},a.initDragScroll=function(){var o=this;this.dragScroll.on("scroll",function(t){var e=t.container,n=t.direction;o.trigger("scroll",{container:e,direction:n})}).on("move",function(t){var e=t.offsetX,n=t.offsetY,r=t.inputEvent,i=r.datas;i.startX-=e,i.startY-=n,i.selectableRects.forEach(function(t){t.top-=n,t.bottom-=n,t.left-=e,t.right-=e}),o.dragger.scrollBy(e,n,r.inputEvent,!1),r.distX+=e,r.distY+=n,o.check(r)})},a.getSelectableTargets=function(){var n=[];return this.options.selectableTargets.forEach(function(t){var e;(e=t)&&"object"==typeof e?n.push(t):[].slice.call(document.querySelectorAll(t)).forEach(function(t){n.push(t)})}),n},a.passSelectedTargets=function(t){var e=R(this.selectedTargets,t),n=e.list,r=e.prevList,i=e.added,o=e.removed;return i.map(function(t){return n[t]}).concat(o.map(function(t){return r[t]}))},a.select=function(t,e,n,r){var i=this.differ.update(t),o=i.added,s=i.removed,a=i.prevList,c=i.list;r&&this.trigger("selectStart",{selected:t,added:o.map(function(t){return c[t]}),removed:s.map(function(t){return a[t]}),rect:e,inputEvent:n}),(o.length||s.length)&&this.trigger("select",{selected:t,added:o.map(function(t){return c[t]}),removed:s.map(function(t){return a[t]}),rect:e,inputEvent:n})},a.selectEnd=function(t,e,n,r){var i=r.inputEvent,o=r.isDouble,s=R(t,e),a=s.added,c=s.removed,l=s.prevList,u=s.list,h=R(this.selectedTargets,e),f=h.added,d=h.removed,p=h.prevList,g=h.list,v=i.type,y="mousedown"===v||"touchstart"===v;this.trigger("selectEnd",{selected:e,added:a.map(function(t){return u[t]}),removed:c.map(function(t){return l[t]}),afterAdded:f.map(function(t){return g[t]}),afterRemoved:d.map(function(t){return p[t]}),isDragStart:y,isDouble:!!o,rect:n,inputEvent:i})},a.check=function(t){var e=t.datas,n=t.inputEvent,r=nt(t,this.options.ratio),i=r.top,o=r.left,s=r.width,a=r.height;this.target.style.cssText+="display: block;left:0px;top:0px;transform: translate("+o+"px, "+i+"px);width:"+s+"px;height:"+a+"px;";var c=this.hitTest(r,e.startX,e.startY,e.selectableTargets,e.selectableRects),l=this.passSelectedTargets(c);this.trigger("drag",u(u({},t),{rect:r})),this.select(l,r,n),e.selectedTargets=l},a.sameCombiKey=function(t,e){var n,r=[].concat(this.options.toggleContinueSelect),i=J(t.inputEvent,t.key),o=(n=r[0],Array.isArray(n)?r:[r]);if(e){var s=t.key;return o.some(function(t){return t.some(function(t){return t===s})})}return o.some(function(t){return t.every(function(t){return-1<i.indexOf(t)})})},i=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;0<=a;a--)(i=t[a])&&(s=(o<3?i(s):3<o?i(e,n,s):i(e,n))||s);return 3<o&&s&&Object.defineProperty(e,n,s),s}([(o=lt,s=function(t,e){var n={enumerable:!0,configurable:!0,get:function(){return this.options[e]}},r=("set "+e).replace(/[\s-_]([a-z])/g,function(t,e){return e.toUpperCase()});t[r]?n.set=function(t){this[r](t)}:n.set=function(t){this.options[e]=t},Object.defineProperty(t,e,n)},function(t){var e=t.prototype;o.forEach(function(t){s(e,t)})})],i)}(t),dt={__proto__:null,default:ft,OPTIONS:ut,OPTION_TYPES:ht,PROPERTIES:lt,EVENTS:["dragStart","drag","dragEnd","selectStart","select","selectEnd","keydown","keyup","scroll"],METHODS:["clickTarget","setSelectedTargets","triggerDragStart"],CLASS_NAME:ct};for(var pt in dt)ft[pt]=dt[pt];return ft});
//# sourceMappingURL=selecto.min.js.map
