var htmlparser2Adapter=require("parse5-htmlparser2-tree-adapter"),serialize=require("dom-serializer").default,defaultOptions=require("./options").default,flattenOptions=require("./options").flatten,select=require("cheerio-select-tmp").select,parse5=require("parse5"),parse=require("./parse");function render(e,t,r){if(t)"string"==typeof t&&(t=select(t,e._root,r));else{if(!e._root||!e._root.children)return"";t=e._root.children}if(r.xmlMode||r._useHtmlParser2)return serialize(t,r);for(var o=("length"in t?t:[t]),n=0;n<o.length;n+=1)"root"===o[n].type&&o.splice.apply(o,[n,1].concat(o[n].children));return parse5.serialize({children:o},{treeAdapter:htmlparser2Adapter})}function isArrayLike(e){if(Array.isArray(e))return!0;if("object"!=typeof e||!Object.prototype.hasOwnProperty.call(e,"length")||"number"!=typeof e.length||e.length<0)return!1;for(var t=0;t<e.length;t++)if(!(t in e))return!1;return!0}exports.load=function(e,n,t){if(null==e)throw new Error("cheerio.load() expects a string");var i=require("./cheerio");n=Object.assign({},defaultOptions,flattenOptions(n)),void 0===t&&(t=!0);var s=parse(e,n,t),a=function(e,t,r,o){return this instanceof a?(o=Object.assign({},n,o),i.call(this,e,t,r||s,o)):new a(e,t,r,o)};return a.prototype=Object.create(i.prototype),(a.prototype.constructor=a).fn=a.prototype,a.prototype._originalRoot=s,Object.assign(a,exports),a._root=s,a._options=n,a},exports.html=function(e,t){return"[object Object]"!==Object.prototype.toString.call(e)||t||"length"in e||"type"in e||(t=e,e=void 0),render(this,e,t=Object.assign({},defaultOptions,this._options,flattenOptions(t||{})))},exports.xml=function(e){return render(this,e,Object.assign({},this._options,{xmlMode:!0}))},exports.text=function(e){for(var t,r="",o=(e=e||this.root()).length,n=0;n<o;n++)"text"===(t=e[n]).type?r+=t.data:t.children&&"comment"!==t.type&&"script"!==t.tagName&&"style"!==t.tagName&&(r+=exports.text(t.children));return r},exports.parseHTML=function(e,t,r){return e&&"string"==typeof e?("boolean"==typeof t&&(r=t),e=this.load(e,defaultOptions,!1),r||e("script").remove(),e.root()[0].children.slice()):null},exports.root=function(){return this(this._root)},exports.contains=function(e,t){if(t===e)return!1;for(;t&&t!==t.parent;)if((t=t.parent)===e)return!0;return!1},exports.merge=function(e,t){if(isArrayLike(e)&&isArrayLike(t)){for(var r=e.length+t.length,o=0;o<t.length;o++)e[o+e.length]=t[o];return e.length=r,e}};