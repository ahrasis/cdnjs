const dna={version:"[VERSION]",clone(e,a,t){const n={...{fade:!1,top:!1,container:null,empty:!1,clones:1,html:!1,transform:null,callback:null},...t},d=dna.store.getTemplate(e);d.nested&&!n.container&&dna.core.berserk("Container missing for nested template",e),n.empty&&dna.empty(e);const l=[].concat(...Array(n.clones).fill(a));let s=$();return l.forEach((e,a)=>s=s.add(dna.core.replicate(d,e,a,n))),dna.placeholder.setup(),dna.panels.initialize(s.first().closest(".dna-panels")),s.first().parents(".dna-hide").removeClass("dna-hide").addClass("dna-unhide"),s},cloneSub(e,a,t,n){const d=dna.compile.subTemplateName(e,a),l=".dna-contains-"+d,s={container:e.find(l).addBack(l)},o=dna.clone(d,t,{...s,...n});return dna.core.updateArray(o),o},createTemplate:(e,a,t)=>($(a).attr({id:e}).addClass("dna-template").appendTo(t),dna.store.getTemplate(e)),templateExists:e=>!!dna.store.templates[e]||$(".dna-template#"+e).length>0,getModel:(e,a)=>"string"==typeof e?(e=>{const a=[];return dna.getClones(e).each((e,t)=>a.push(dna.getModel($(t)))),a})(e):(e=>dna.getClone($(e),a).data("dnaModel"))(e),empty(e,a){const t={...{fade:!1,callback:null},...a},n=dna.store.getTemplate(e),d=n.container.children(".dna-clone");n.container.data().dnaCountsMap&&(n.container.data().dnaCountsMap[e]=0);return t.fade?(()=>dna.ui.slideFadeDelete(d,t.callback))():dna.core.remove(d,t.callback)},insert(e,a,t){const n=dna.getClones(e).first();return n.length?dna.refresh(n,{data:a,html:t&&t.html}):dna.clone(e,a,t)},refresh(e,a){const t={...{html:!1},...a},n=dna.getClone(e,a),d=t.data?t.data:dna.getModel(n);return dna.core.inject(n,d,n.data().dnaCount,t)},refreshAll:(e,a)=>dna.getClones(e).each((e,t)=>dna.refresh($(t),a)),updateField(e,a){const t=e.data()&&e.data().dnaField;return t&&(e.is("input:checkbox")?e.prop("checked",a):e.is("input:radio")?e.prop("checked",a):e.is("input, select, textarea")&&e.val(a),dna.getModel(e)[t]=a),e},recount:(e,a)=>((e=dna.getClone(e)).length&&(()=>{const t=e.data().dnaRules.template,n=e.parent(),d=n.children(".dna-clone."+t).each((e,t)=>{(t=$(t)).data().dnaCount=e+1,dna.refresh(t,a)});n.data().dnaCountsMap=n.data().dnaCountsMap||{},n.data().dnaCountsMap[t]=d.length})(),e),destroy(e,a){const t={...{fade:!1,callback:null},...a};e=dna.getClone(e,a);const n=dna.core.getArrayName(e);n&&dna.getModel(e.parent())[n].splice(dna.getIndex(e),1);return t.fade?(()=>dna.ui.slideFadeDelete(e,t.callback))():dna.core.remove(e,t.callback)},getClone(e,a){const t={...{main:!1},...a}.main?".dna-clone:not(.dna-sub-clone)":".dna-clone";return e instanceof $?e.closest(t):$()},getClones:e=>dna.store.getTemplate(e).container.children(".dna-clone."+e),getIndex(e,a){const t=dna.getClone(e,a);return t.parent().children(".dna-clone."+t.data().dnaRules.template).index(t)},up(e,a){return dna.ui.smoothMoveUp(dna.getClone(dna.ui.toElem(e,this)),a)},down(e,a){return dna.ui.smoothMoveDown(dna.getClone(dna.ui.toElem(e,this)),a)},bye(e,a){const t=dna.ui.toElem(e,this),n={fade:!0,callback:"function"==typeof a?a:null};return dna.destroy(t,n)},registerInitializer(e,a){const t={...{onDocumentLoad:!0},...a};t.onDocumentLoad&&dna.util.apply(e,[(e=>e?$(e).not(".dna-template "+e).addClass("dna-initialized"):$(window.document))(t.selector)].concat(t.params));const n={func:e,selector:t.selector,params:t.params};return dna.events.initializers.push(n),dna.events.initializers},clearInitializers(){dna.events.initializers=[]},registerContext:(e,a)=>(dna.events.context[e]=a,dna.events.context),info(){const e=Object.keys(dna.store.templates),a=$(".dna-menu.dna-panels-initialized");return{version:dna.version,templates:e.length,clones:$(".dna-clone:not(.dna-sub-clone)").length,subs:$(".dna-sub-clone").length,names:e,store:dna.store.templates,initializers:dna.events.initializers,panels:a.toArray().map(e=>$(e).attr("data-nav"))}}};dna.array={find:(e,a,t)=>{const n=t||"code",d=Array.isArray(e);let l=0;if(d)for(;l<e.length&&e[l][n]!==a;)l++;return d&&l<e.length?{item:e[l],index:l}:{item:void 0,index:-1}},last:e=>Array.isArray(e)&&e.length?e[e.length-1]:void 0,fromMap:(e,a)=>{const t={...{key:"code",kebabCodes:!1},...a},n=[],d=e=>e instanceof Object?e:{value:e};for(let a in e)n[n.push(d(e[a]))-1][t.key]=t.kebabCodes?dna.util.toKebab(a):a;return n},toMap:(e,a)=>{const t={...{key:"code",camelKeys:!1},...a},n={};return e.forEach(t.camelKeys?e=>n[dna.util.toCamel(e[t.key])]=e:e=>n[e[t.key]]=e),n},wrap:e=>e?e instanceof Array?e:[e]:[]},dna.browser={getUrlParams:()=>{const e={};return window.location.search.slice(1).split("&").forEach(a=>a&&(a=>e[a.split("=")[0]]=a.split("=")[1])(a)),e}},dna.pageToken={put:(e,a)=>(window.sessionStorage[e+window.location.pathname]=JSON.stringify(a),a),get:(e,a)=>{const t=window.sessionStorage[e+window.location.pathname];return void 0===t?a:JSON.parse(t)}},dna.ui={deleteElem:function(e,a){return a="function"==typeof a?a:null,dna.core.remove(dna.ui.toElem(e,this),a)},focus:e=>e.trigger("focus"),getAttrs:e=>e[0]?Object.values(e[0].attributes):[],getComponent:e=>e.closest("[data-component]"),pulse:(e,a)=>{const t={...{duration:400,interval:null,out:5e3},...a},n={opacity:0},d={opacity:1};return e.stop(!0).slideDown().css(n).animate(d,t.duration),t.interval&&e.animate(d,t.interval).animate(n,t.out),e},slideFade:(e,a,t)=>{const n={opacity:1,transition:"opacity 400ms"},d={transition:"opacity 0s"};return t&&window.setTimeout(()=>e.css(n),200)?e.css({opacity:0,transition:"opacity 0s"}).hide().delay(100).slideDown(a):e.css({opacity:0,transition:"opacity 400ms"}).delay(100).slideUp(a),e.delay(200).promise().then(()=>e.css(d)),e},slideFadeIn:(e,a)=>dna.ui.slideFade(e,a,!0),slideFadeOut:(e,a)=>dna.ui.slideFade(e,a,!1),slideFadeToggle:(e,a)=>dna.ui.slideFade(e,a,e.is(":hidden")),slideFadeDelete:(e,a)=>dna.ui.slideFadeOut(e,()=>dna.ui.deleteElem(e,a)),smoothHeightSetBaseline:e=>{dna.ui.$container=e=e||$("body");const a=e.outerHeight();return e.css({minHeight:a,maxHeight:a,overflow:"hidden"})},smoothHeightAnimate:(e,a)=>{a=a||dna.ui.$container;window.setTimeout(()=>{a.css({minHeight:0,maxHeight:"100vh"});window.setTimeout(()=>a.css({transition:"none",maxHeight:"none"}),1e3)},e||50);return window.setTimeout(()=>a.css({transition:"all 1s"}),10),a},smoothMove:(e,a,t)=>{t="function"==typeof t?t:null;const n=a?e.prev():e.next();return n.length?(()=>{const d=n.clone(!0);a?e.after(n.hide()).before(d):e.before(n.hide()).after(d);let l=0;const s=()=>l++&&t&&t(e);window.setTimeout(()=>{dna.ui.slideFadeIn(n,s),dna.ui.slideFadeDelete(d,s)})})():t&&t(e),e},smoothMoveUp:(e,a)=>dna.ui.smoothMove(e,!0,a),smoothMoveDown:(e,a)=>dna.ui.smoothMove(e,!1,a),toElem:(e,a)=>{const t=e instanceof $&&e,n=e&&e.target;return t||$(n||e||a)}},dna.util={apply:(e,a)=>{const t=void 0===a?[]:[].concat(a),n=t[0];let d;const l=(a,s)=>{!a||1===s.length&&"function"!=typeof a[s[0]]?dna.core.berserk("Callback function not found",e):1===s.length?d=a[s[0]].apply(n,t):l(a[s[0]],s.slice(1))};return n instanceof $&&0===n.length?d=n:"function"==typeof e?d=e.apply(n,t):n&&n[e]?d=n[e](t[1],t[2],t[3]):""===e||{number:!0,boolean:!0}[typeof e]?dna.core.berserk("Invalid callback function",e):"string"==typeof e&&e.length>0&&(e=>{n instanceof $&&t.push(dna.ui.getComponent(n));const a=e[0],d=eval;/^[_$a-zA-Z][_$a-zA-Z0-9]*$/.test(a)&&(e=>void 0===window[e]&&!dna.events.context[e])(a)&&(e=>["object","function"].includes(d("typeof "+e)))(a)&&dna.registerContext(a,d(a)),l(dna.events.context[a]?dna.events.context:window,e)})(e.split(".")),d},assign:(e,a,t)=>{const n="string"==typeof a?a.split("."):a,d=n[0],l=$.isPlainObject(e)?e:{};return 1===n.length?l[d]=t:dna.util.assign((()=>void 0===l[d]?l[d]={}:l[d])(),n.slice(1),t),l},printf:(e,...a)=>a.reduce((e,a)=>e.replace(/%s/,a),e),realTruth:e=>{return!!e&&(!(()=>e instanceof Array&&0===e.length)()&&!(()=>/^(f|false|n|no|0)$/i.test(e))())},toCamel:e=>{return(""+e).replace(/\-(.)/g,(e,a)=>a.toUpperCase())},toKebab:e=>{return(""+e).replace(/([A-Z]+)/g,e=>"-"+e.toLowerCase()).replace(/\s|^-/g,"")},value:(e,a)=>("string"==typeof a&&(a=a.split(".")),null==e||void 0===a?null:1===a.length?e[a[0]]:dna.util.value(e[a[0]],a.slice(1)))},dna.placeholder={setup:()=>{$("option.dna-template").closest("select").addClass("dna-hide");$("[data-placeholder]").each((e,a)=>{const t=$(a).stop(!0);return dna.getClones(t.data().placeholder).length?t.fadeOut():t.fadeIn()})}},dna.panels={display:(e,a,t)=>{const n=e.data().dnaPanels,d=e.data().nav,l=e.find(".menu-item"),s=(e=>Math.max(0,Math.min(e,l.length-1)))(void 0===a?dna.pageToken.get(d,0):a);e[0].selectedIndex=s,l.removeClass("selected").addClass("unselected"),l.eq(s).addClass("selected").removeClass("unselected"),n.hide().removeClass("displayed").addClass("hidden");const o=n.eq(s).fadeIn().addClass("displayed").removeClass("hidden"),r=o.data().hash;dna.pageToken.put(d,s),t&&r&&window.history.pushState(null,null,"#"+r),dna.util.apply(e.data().callback,[o,r])},clickRotate:e=>{const a=$(e.target).closest(".menu-item"),t=a.closest(".dna-menu");dna.panels.display(t,t.find(".menu-item").index(a),!0)},selectRotate:e=>{const a=$(e.target);dna.panels.display(a,a.find("option:selected").index(),!0)},nextNav:1,initialize:e=>{const a="dna-panels-initialized";!e.length||e.hasClass(a)||e.children().hasClass("dna-template")||(()=>{!e.data().nav&&/-panels$/.test(e.attr("id"))&&(a=>{e.attr("data-nav",a).addClass("dna-legacy-id"),$("#"+a+"-menu").attr("data-nav",a).addClass("dna-legacy-id"),e.data().nav=a})(e.attr("id").replace(/-panels$/,""));const t=e.data().nav||(()=>{const a="dna-panels-"+dna.panels.nextNav++;return e.attr("data-nav",a).prev(".dna-menu").attr("data-nav",a),a})(),n=$(".dna-menu[data-nav="+t+"]").addClass(a),d=e.addClass(a).children().addClass("panel"),l=window.location.hash.replace(/[^\w-]/g,""),s=l&&d.first().data().hash?(()=>d.filter("[data-hash="+l+"]").index())():(()=>dna.pageToken.get(t,0))();n.length||dna.core.berserk("Menu not found for panels",t),n.data().dnaPanels=d,n.find(".menu-item").length||n.children().addClass("menu-item"),dna.panels.display(n,s)})()},setup:()=>{$(".dna-panels").each((e,a)=>dna.panels.initialize($(a))),$(window.document).on({click:dna.panels.clickRotate},".dna-menu .menu-item"),$(window.document).on({change:dna.panels.selectRotate},".dna-menu")}},dna.compile={regexDnaField:/^[\s]*(~~|\{\{).*(~~|\}\})[\s]*$/,regexDnaBasePair:/~~|{{|}}/,regexDnaBasePairs:/~~|\{\{|\}\}/g,setupNucleotide:e=>(e.data().dnaRules||(e.data().dnaRules={}),e.addClass("dna-nucleotide")),isDnaField:(e,a)=>{const t=a.childNodes[0];return t&&t.nodeValue&&(()=>t.nodeValue.match(dna.compile.regexDnaField))()},addFieldClass:e=>{const a=e.data().dnaField;return a?e.addClass("dna-field-"+(()=>dna.util.toKebab(a).replace(/[\[\]]/g,"").replace(/[.]/g,"-"))()):e},field:(e,a)=>((a=dna.compile.setupNucleotide($(a))).data().dnaField=a.text().replace(dna.compile.regexDnaBasePairs,"").trim(),dna.compile.addFieldClass(a),a.is("textarea")?a.addClass("dna-update-model").data().dnaRules.val=!0:a.data().dnaRules.text=!0,a.empty()),propsAndAttrs:(e,a)=>{a=$(a);const t=[],n=[],d=[];return dna.ui.getAttrs(a).forEach(e=>{/^data-prop-/.test(e.name)?((e,n)=>{d.push(e),e=e.replace(/^data-prop-/,"").toLowerCase(),n=n.replace(dna.compile.regexDnaBasePairs,""),t.push(e,n),"checked"===e&&a.is("input")&&(a.addClass("dna-update-model").data().dnaField=n)})(e.name,e.value):3===e.value.split(dna.compile.regexDnaBasePair).length&&((e,t)=>{const l=t.split(dna.compile.regexDnaBasePair);"[count]"===l[1]?l[1]=1:"[value]"===l[1]&&(l[1]=2),n.push(e.replace(/^data-attr-/,""),l),d.push(e),(a.is("input:not(:checkbox, :radio)")&&"value"===e&&""===l[0]&&""===l[2]||a.is("select")&&"data-option"===e)&&(dna.compile.setupNucleotide(a).addClass("dna-update-model"),a.data().dnaField=l[1],a.data().dnaRules.val=!0)})(e.name,e.value)}),t.length>0&&(dna.compile.setupNucleotide(a).data().dnaRules.props=t),n.length>0&&(dna.compile.setupNucleotide(a).data().dnaRules.attrs=n),a.data().transform&&(dna.compile.setupNucleotide(a).data().dnaRules.transform=a.data().transform),a.data().callback&&(dna.compile.setupNucleotide(a).data().dnaRules.callback=a.data().callback),dna.compile.addFieldClass(a),a.removeAttr(d.join(" "))},getDataField:(e,a)=>e.data(a).replace(dna.compile.regexDnaBasePairs,"").trim(),subTemplateName:(e,a)=>{return(e instanceof $&&(()=>dna.getClone(e,{main:!0}))().data().dnaRules.template||e)+"-"+a+"-instance"},rules:(e,a,t)=>{return e.filter("[data-"+a+"]").each((e,n)=>{n=dna.compile.setupNucleotide($(n));const d=dna.compile.getDataField(n,a);n.data().dnaRules[a]=t?(()=>d.split(";").map(e=>e.split(",")))():d}).removeAttr("data-"+a)},separators:e=>{const a=(e,a)=>3===a.nodeType&&!/\S/.test(a.nodeValue),t=(e,t,n)=>{return t&&(e.contents().last().filter(a).remove(),void e.append($("<span>").addClass(n).html(t)))};e.find(".dna-template, .dna-sub-clone").addBack().each((e,a)=>{const n=$(a);t(n,n.data().separator,"dna-separator"),t(n,n.data().lastSeparator,"dna-last-separator")})},template:e=>{const a=$("#"+e);a.length||dna.core.berserk("Template not found",e);const t=(e,a)=>$(a).data().dnaRules.subs=[];a.find(".dna-template").addBack().each((e,a)=>$(a).data().dnaRules={template:$(a).attr("id"),subs:[]}).removeAttr("id").each(t);const n=a.find("*").addBack();n.filter(dna.compile.isDnaField).each(dna.compile.field).addClass("dna-field"),dna.compile.rules(n,"array").addClass("dna-sub-clone").each(t),dna.compile.rules(n,"class",!0),dna.compile.rules(n,"require"),dna.compile.rules(n,"missing"),dna.compile.rules(n,"true"),dna.compile.rules(n,"false"),n.each(dna.compile.propsAndAttrs),dna.compile.separators(a);return $("input[data-attr-type]").each((e,a)=>$(a).attr({type:$(a).data().attrType})),dna.store.stash(a)}},dna.store={templates:{},stash:e=>{const a=e.data().dnaRules.template,t=(e,a)=>{const t=(a=$(a)).data().dnaRules.template,n=a.parent(),d=1===n.children().length&&!n.hasClass("dna-container");d||n.data().dnaContents||(()=>{n.data().dnaContents=!0;n.data().dnaContents=n.children().toArray().map(e=>(e=$(e)).hasClass("dna-template")?(e=>e?dna.compile.template(e).name:t)(e.attr("id")):!!e.hasClass("dna-sub-clone")&&e.data().dnaRules.template)})();const l={name:t,elem:a,container:n.addClass("dna-container").addClass("dna-contains-"+t),nested:0!==n.closest(".dna-clone").length,separators:a.find(".dna-separator, .dna-last-separator").length,wrapped:d};dna.store.templates[t]=l,a.removeClass("dna-template").addClass("dna-clone").addClass(t).detach()};return e.find(".dna-template").addBack().each(t),e.find(".dna-sub-clone").each((e,t)=>{const n=$(t).data().dnaRules,d=dna.compile.setupNucleotide($(t).parent()).addClass("dna-array");n.template=dna.compile.subTemplateName(a,n.array),d.data().dnaRules.loop={name:n.template,field:n.array},d.closest(".dna-clone, .dna-sub-clone").data().dnaRules.subs.push(n.array)}).each(t),dna.store.templates[a]},getTemplate:e=>dna.store.templates[e]||dna.compile.template(e)},dna.events={context:{},initializers:[],runOnLoads:()=>{return $("[data-on-load]").not(".dna-loaded").each((e,a)=>dna.util.apply($(a).data().onLoad,$(a))).addClass("dna-loaded")},runInitializers:e=>{return dna.events.initializers.forEach(a=>{const t=[(a.selector?(()=>e.find(a.selector).addBack(a.selector))():e).addClass("dna-initialized")].concat(a.params);dna.util.apply(a.func,t)}),e},setup:()=>{const e=(a,t,n)=>{const d=a.closest("[data-"+t+"]"),l=d.data(t),s=d[0]&&"A"===d[0].nodeName;"click"===t&&s&&l&&l.match(/^dna[.]/)&&n.preventDefault();const o=d.parent().closest("[data-click]");return"click"===t&&o.length&&e(o,t,n),dna.util.apply(l,[d,n])},a=a=>{const t=$(a.target),n=(e,a)=>dna.util.assign(dna.getModel(e),e.data().dnaField,a(e)),d=e=>e.val(),l=e=>e.is(":checked"),s=(e,a)=>n($(a),l);return t.hasClass("dna-update-model")&&(()=>{const e=dna.getClone(t,{main:!0});0!==e.length&&(t.is("input:checkbox")?n(t,l):t.is("input:radio")?$("input:radio[name="+t.attr("name")+"]").each(s):t.data().dnaRules.val&&n(t,d),dna.refresh(e))})(),e(t,a.type.replace("key","key-"),a)},t=a=>{const t=$(a.target),n=t.data(),d=()=>{n.dnaLastUpdated=Date.now(),n.dnaLastValue=t.val(),n.dnaTimeoutId=null,e(t,"smart-update",a)},l=()=>{t.val()===n.dnaLastValue||n.dnaTimeoutId||(()=>{const e=n.smartThrottle?+n.smartThrottle:1e3;Date.now()<n.dnaLastUpdated+e?n.dnaTimeoutId=window.setTimeout(d,e):d()})()};n.smartUpdate&&("keydown"===a.type&&void 0===n.dnaLastValue&&(n.dnaLastValue=t.val()),window.setTimeout(l))},n=a=>t=>e($(t.target),a,t),d={click:a,change:a,keydown:a,keypress:a,keyup:a,input:a},l={keydown:t,keyup:t,change:t,cut:t,paste:t};$(window.document).on(d).on(l).on({keyup:a=>13===a.which&&e($(a.target),"enter-key",a)}).on({click:e=>{const a=$(e.target).closest("[data-href]"),t=/iPad|iPhone|iPod/.test(window.navigator.userAgent)&&/Apple/.test(window.navigator.vendor),n=a.closest(".external-site").length?"_blank":"_self";window.open(a.data().href,t?"_self":a.data().target||n)}},"[data-href]").on({focusin:n("focus-in")},"[data-focus-in]").on({focusout:n("focus-out")},"[data-focus-out]").on({mouseenter:n("hover-in")},"[data-hover-in]").on({mouseleave:n("hover-out")},"[data-hover-out]"),dna.events.runOnLoads()}},dna.core={inject:(e,a,t,n)=>{const d=e=>{const t=dna.util.value(a,e);return null!=t},l=(e,l)=>{const s=(l=$(l)).data().dnaRules;s.transform&&dna.util.apply(s.transform,a),s.loop&&((e,t)=>{const d=dna.util.value(a,t.field),l=e.children("."+t.name.replace(/[.]/g,"\\."));d?d.length===l.length?l.each((e,a)=>{(a=$(a)).is("option")||dna.core.inject(a,d[e],e+1,n)}):(l.remove(),dna.clone(t.name,d,{container:e,html:n.html})):a[t.field]=[]})(l,s.loop),s.text&&((e,d)=>{const l="[count]"===d?t:"[value]"===d?a:dna.util.value(a,d);({string:!0,number:!0,boolean:!0})[typeof l]&&(e=n.html?e.html(l):e.text(l))})(l,l.data().dnaField),s.val&&((e,n)=>{const d="[count]"===n?t:"[value]"===n?a:dna.util.value(a,n);null!==d&&d!==e.val()&&e.val(d)})(l,l.data().dnaField),s.props&&((e,t)=>{for(let n=0;n<t.length/2;n++)e.prop(t[2*n],dna.util.realTruth(dna.util.value(a,t[2*n+1])))})(l,s.props),s.attrs&&((e,n)=>{for(let d=0;d<n.length/2;d++){const l=n[2*d],s=n[2*d+1],o=s[1],r=1===o?t:2===o?a:dna.util.value(a,o),i=[s[0],r,s[2]].join("");e.attr(l,i),/^data-./.test(l)&&e.data(l.substring(5),i),"value"===l&&i!==e.val()&&e.val(i)}})(l,s.attrs),s.class&&((e,t)=>{t.forEach(t=>{const n=dna.util.value(a,t[0]),d=dna.util.realTruth(n);1===t.length?e.addClass(n):t.length>1&&(e.toggleClass(t[1],d),t[2]&&e.toggleClass(t[2],!d))})})(l,s.class),s.require&&l.toggle(d(s.require)),s.missing&&l.toggle(!d(s.missing)),s.true&&l.toggle(dna.util.realTruth(dna.util.value(a,s.true))),s.false&&l.toggle(!dna.util.realTruth(dna.util.value(a,s.false))),s.callback&&dna.util.apply(s.callback,l)},s=e=>{e.filter(".dna-nucleotide").each(l),e.length&&s(e.children().not(".dna-sub-clone"))};return n.transform&&n.transform(a),s(e),e.data().dnaModel=a,e.data().dnaCount=t,e},replicate:(e,a,t,n)=>{const d=".dna-contains-"+e.name.replace(/[.]/g,"\\."),l=n.container?n.container.find(d).addBack(d):e.container,s=e.elem.clone(!0,!0),o=s.data().dnaRules.template;l.data().dnaCountsMap||(l.data().dnaCountsMap={});const r=l.data().dnaCountsMap;r[o]=(r[o]||0)+1,dna.core.inject(s,a,r[o],n);return e.wrapped?n.top?l.prepend(s):l.append(s):(()=>{const a=l.children(".dna-clone"),t=a.filter("."+e.name);t.length?n.top?t.first().before(s):t.last().after(s):(()=>{const t=l.data().dnaContents,n=t.indexOf(e.name),d=l.children().eq(n+t.reduce((e,d)=>e+(d&&t.indexOf(d)<n?a.filter("."+d).length-1:0),0));d.length?d.before(s):l.append(s)})()})(),e.separators&&(()=>{const a=l.children("."+e.name);a.find(".dna-separator").show().end().last().find(".dna-separator").hide(),a.find(".dna-last-separator").hide().end().eq(-2).find(".dna-last-separator").show().closest(".dna-clone").find(".dna-separator").hide()})(),dna.events.runInitializers(s,a),n.callback&&n.callback(s,a),n.fade&&dna.ui.slideFadeIn(s),s},getArrayName:e=>e.hasClass("dna-sub-clone")?e.data().dnaRules.array:null,updateArrayByName:(e,a)=>{return a?(()=>{e=dna.getClone(e);const t=dna.compile.subTemplateName(e,a);return e.data().dnaRules.subs.includes(a)&&(dna.getModel(e)[a]=e.find("."+t).get().map(dna.getModel)),e})():e},updateArray:e=>(e=dna.getClone(e.first()),dna.core.updateArrayByName(e.parent(),dna.core.getArrayName(e)),e),remove:(e,a)=>{const t=e.parent();return e.detach(),dna.core.updateArrayByName(t,dna.core.getArrayName(e)),dna.placeholder.setup(),e.remove(),a&&a(e),e},berserk:(e,a)=>{throw Error("dna.js ~~ "+e+" ["+a+"]")},plugin:()=>{$.fn.dna=function(e){const a=[arguments[1],arguments[2],arguments[3]],t=dna[dna.util.toCamel(e)];t||dna.core.berserk("Unknown plugin action",e);return this.each((e,n)=>t($(n),a[0],a[1],a[2]))}},initModule:(e,a)=>(window=e,$=a,window.dna=dna,dna.core.setup(),dna),setup:()=>{dna.core.plugin(),$(dna.placeholder.setup),$(dna.panels.setup),$(dna.events.setup)}},"object"==typeof window&&(window.dna=dna),"object"==typeof module?module.exports=dna.core.initModule:dna.core.setup();