!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.piexifjs={})}(this,function(e){"use strict";const t={Byte:1,Ascii:2,Short:3,Long:4,Rational:5,Undefined:7,SLong:9,SRational:10},a={Image:{11:{name:"ProcessingSoftware",type:t.Ascii},254:{name:"NewSubfileType",type:t.Long},255:{name:"SubfileType",type:t.Short},256:{name:"ImageWidth",type:t.Long},257:{name:"ImageLength",type:t.Long},258:{name:"BitsPerSample",type:t.Short},259:{name:"Compression",type:t.Short},262:{name:"PhotometricInterpretation",type:t.Short},263:{name:"Threshholding",type:t.Short},264:{name:"CellWidth",type:t.Short},265:{name:"CellLength",type:t.Short},266:{name:"FillOrder",type:t.Short},269:{name:"DocumentName",type:t.Ascii},270:{name:"ImageDescription",type:t.Ascii},271:{name:"Make",type:t.Ascii},272:{name:"Model",type:t.Ascii},273:{name:"StripOffsets",type:t.Long},274:{name:"Orientation",type:t.Short},277:{name:"SamplesPerPixel",type:t.Short},278:{name:"RowsPerStrip",type:t.Long},279:{name:"StripByteCounts",type:t.Long},282:{name:"XResolution",type:t.Rational},283:{name:"YResolution",type:t.Rational},284:{name:"PlanarConfiguration",type:t.Short},290:{name:"GrayResponseUnit",type:t.Short},291:{name:"GrayResponseCurve",type:t.Short},292:{name:"T4Options",type:t.Long},293:{name:"T6Options",type:t.Long},296:{name:"ResolutionUnit",type:t.Short},301:{name:"TransferFunction",type:t.Short},305:{name:"Software",type:t.Ascii},306:{name:"DateTime",type:t.Ascii},315:{name:"Artist",type:t.Ascii},316:{name:"HostComputer",type:t.Ascii},317:{name:"Predictor",type:t.Short},318:{name:"WhitePoint",type:t.Rational},319:{name:"PrimaryChromaticities",type:t.Rational},320:{name:"ColorMap",type:t.Short},321:{name:"HalftoneHints",type:t.Short},322:{name:"TileWidth",type:t.Short},323:{name:"TileLength",type:t.Short},324:{name:"TileOffsets",type:t.Short},325:{name:"TileByteCounts",type:t.Short},330:{name:"SubIFDs",type:t.Long},332:{name:"InkSet",type:t.Short},333:{name:"InkNames",type:t.Ascii},334:{name:"NumberOfInks",type:t.Short},336:{name:"DotRange",type:t.Byte},337:{name:"TargetPrinter",type:t.Ascii},338:{name:"ExtraSamples",type:t.Short},339:{name:"SampleFormat",type:t.Short},340:{name:"SMinSampleValue",type:t.Short},341:{name:"SMaxSampleValue",type:t.Short},342:{name:"TransferRange",type:t.Short},343:{name:"ClipPath",type:t.Byte},344:{name:"XClipPathUnits",type:t.Long},345:{name:"YClipPathUnits",type:t.Long},346:{name:"Indexed",type:t.Short},347:{name:"JPEGTables",type:t.Undefined},351:{name:"OPIProxy",type:t.Short},512:{name:"JPEGProc",type:t.Long},513:{name:"JPEGInterchangeFormat",type:t.Long},514:{name:"JPEGInterchangeFormatLength",type:t.Long},515:{name:"JPEGRestartInterval",type:t.Short},517:{name:"JPEGLosslessPredictors",type:t.Short},518:{name:"JPEGPointTransforms",type:t.Short},519:{name:"JPEGQTables",type:t.Long},520:{name:"JPEGDCTables",type:t.Long},521:{name:"JPEGACTables",type:t.Long},529:{name:"YCbCrCoefficients",type:t.Rational},530:{name:"YCbCrSubSampling",type:t.Short},531:{name:"YCbCrPositioning",type:t.Short},532:{name:"ReferenceBlackWhite",type:t.Rational},700:{name:"XMLPacket",type:t.Byte},18246:{name:"Rating",type:t.Short},18249:{name:"RatingPercent",type:t.Short},32781:{name:"ImageID",type:t.Ascii},33421:{name:"CFARepeatPatternDim",type:t.Short},33422:{name:"CFAPattern",type:t.Byte},33423:{name:"BatteryLevel",type:t.Rational},33432:{name:"Copyright",type:t.Ascii},33434:{name:"ExposureTime",type:t.Rational},34377:{name:"ImageResources",type:t.Byte},34665:{name:"ExifTag",type:t.Long},34675:{name:"InterColorProfile",type:t.Undefined},34853:{name:"GPSTag",type:t.Long},34857:{name:"Interlace",type:t.Short},34858:{name:"TimeZoneOffset",type:t.Long},34859:{name:"SelfTimerMode",type:t.Short},37387:{name:"FlashEnergy",type:t.Rational},37388:{name:"SpatialFrequencyResponse",type:t.Undefined},37389:{name:"Noise",type:t.Undefined},37390:{name:"FocalPlaneXResolution",type:t.Rational},37391:{name:"FocalPlaneYResolution",type:t.Rational},37392:{name:"FocalPlaneResolutionUnit",type:t.Short},37393:{name:"ImageNumber",type:t.Long},37394:{name:"SecurityClassification",type:t.Ascii},37395:{name:"ImageHistory",type:t.Ascii},37397:{name:"ExposureIndex",type:t.Rational},37398:{name:"TIFFEPStandardID",type:t.Byte},37399:{name:"SensingMethod",type:t.Short},40091:{name:"XPTitle",type:t.Byte},40092:{name:"XPComment",type:t.Byte},40093:{name:"XPAuthor",type:t.Byte},40094:{name:"XPKeywords",type:t.Byte},40095:{name:"XPSubject",type:t.Byte},50341:{name:"PrintImageMatching",type:t.Undefined},50706:{name:"DNGVersion",type:t.Byte},50707:{name:"DNGBackwardVersion",type:t.Byte},50708:{name:"UniqueCameraModel",type:t.Ascii},50709:{name:"LocalizedCameraModel",type:t.Byte},50710:{name:"CFAPlaneColor",type:t.Byte},50711:{name:"CFALayout",type:t.Short},50712:{name:"LinearizationTable",type:t.Short},50713:{name:"BlackLevelRepeatDim",type:t.Short},50714:{name:"BlackLevel",type:t.Rational},50715:{name:"BlackLevelDeltaH",type:t.SRational},50716:{name:"BlackLevelDeltaV",type:t.SRational},50717:{name:"WhiteLevel",type:t.Short},50718:{name:"DefaultScale",type:t.Rational},50719:{name:"DefaultCropOrigin",type:t.Short},50720:{name:"DefaultCropSize",type:t.Short},50721:{name:"ColorMatrix1",type:t.SRational},50722:{name:"ColorMatrix2",type:t.SRational},50723:{name:"CameraCalibration1",type:t.SRational},50724:{name:"CameraCalibration2",type:t.SRational},50725:{name:"ReductionMatrix1",type:t.SRational},50726:{name:"ReductionMatrix2",type:t.SRational},50727:{name:"AnalogBalance",type:t.Rational},50728:{name:"AsShotNeutral",type:t.Short},50729:{name:"AsShotWhiteXY",type:t.Rational},50730:{name:"BaselineExposure",type:t.SRational},50731:{name:"BaselineNoise",type:t.Rational},50732:{name:"BaselineSharpness",type:t.Rational},50733:{name:"BayerGreenSplit",type:t.Long},50734:{name:"LinearResponseLimit",type:t.Rational},50735:{name:"CameraSerialNumber",type:t.Ascii},50736:{name:"LensInfo",type:t.Rational},50737:{name:"ChromaBlurRadius",type:t.Rational},50738:{name:"AntiAliasStrength",type:t.Rational},50739:{name:"ShadowScale",type:t.SRational},50740:{name:"DNGPrivateData",type:t.Byte},50741:{name:"MakerNoteSafety",type:t.Short},50778:{name:"CalibrationIlluminant1",type:t.Short},50779:{name:"CalibrationIlluminant2",type:t.Short},50780:{name:"BestQualityScale",type:t.Rational},50781:{name:"RawDataUniqueID",type:t.Byte},50827:{name:"OriginalRawFileName",type:t.Byte},50828:{name:"OriginalRawFileData",type:t.Undefined},50829:{name:"ActiveArea",type:t.Short},50830:{name:"MaskedAreas",type:t.Short},50831:{name:"AsShotICCProfile",type:t.Undefined},50832:{name:"AsShotPreProfileMatrix",type:t.SRational},50833:{name:"CurrentICCProfile",type:t.Undefined},50834:{name:"CurrentPreProfileMatrix",type:t.SRational},50879:{name:"ColorimetricReference",type:t.Short},50931:{name:"CameraCalibrationSignature",type:t.Byte},50932:{name:"ProfileCalibrationSignature",type:t.Byte},50934:{name:"AsShotProfileName",type:t.Byte},50935:{name:"NoiseReductionApplied",type:t.Rational},50936:{name:"ProfileName",type:t.Byte},50937:{name:"ProfileHueSatMapDims",type:t.Long},50941:{name:"ProfileEmbedPolicy",type:t.Long},50942:{name:"ProfileCopyright",type:t.Byte},50964:{name:"ForwardMatrix1",type:t.SRational},50965:{name:"ForwardMatrix2",type:t.SRational},50966:{name:"PreviewApplicationName",type:t.Byte},50967:{name:"PreviewApplicationVersion",type:t.Byte},50968:{name:"PreviewSettingsName",type:t.Byte},50969:{name:"PreviewSettingsDigest",type:t.Byte},50970:{name:"PreviewColorSpace",type:t.Long},50971:{name:"PreviewDateTime",type:t.Ascii},50972:{name:"RawImageDigest",type:t.Undefined},50973:{name:"OriginalRawFileDigest",type:t.Undefined},50974:{name:"SubTileBlockSize",type:t.Long},50975:{name:"RowInterleaveFactor",type:t.Long},50981:{name:"ProfileLookTableDims",type:t.Long},51008:{name:"OpcodeList1",type:t.Undefined},51009:{name:"OpcodeList2",type:t.Undefined},51022:{name:"OpcodeList3",type:t.Undefined}},Exif:{33434:{name:"ExposureTime",type:t.Rational},33437:{name:"FNumber",type:t.Rational},34850:{name:"ExposureProgram",type:t.Short},34852:{name:"SpectralSensitivity",type:t.Ascii},34855:{name:"ISOSpeedRatings",type:t.Short},34856:{name:"OECF",type:t.Undefined},34864:{name:"SensitivityType",type:t.Short},34865:{name:"StandardOutputSensitivity",type:t.Long},34866:{name:"RecommendedExposureIndex",type:t.Long},34867:{name:"ISOSpeed",type:t.Long},34868:{name:"ISOSpeedLatitudeyyy",type:t.Long},34869:{name:"ISOSpeedLatitudezzz",type:t.Long},36864:{name:"ExifVersion",type:t.Undefined},36867:{name:"DateTimeOriginal",type:t.Ascii},36868:{name:"DateTimeDigitized",type:t.Ascii},37121:{name:"ComponentsConfiguration",type:t.Undefined},37122:{name:"CompressedBitsPerPixel",type:t.Rational},37377:{name:"ShutterSpeedValue",type:t.SRational},37378:{name:"ApertureValue",type:t.Rational},37379:{name:"BrightnessValue",type:t.SRational},37380:{name:"ExposureBiasValue",type:t.SRational},37381:{name:"MaxApertureValue",type:t.Rational},37382:{name:"SubjectDistance",type:t.Rational},37383:{name:"MeteringMode",type:t.Short},37384:{name:"LightSource",type:t.Short},37385:{name:"Flash",type:t.Short},37386:{name:"FocalLength",type:t.Rational},37396:{name:"SubjectArea",type:t.Short},37500:{name:"MakerNote",type:t.Undefined},37510:{name:"UserComment",type:t.Ascii},37520:{name:"SubSecTime",type:t.Ascii},37521:{name:"SubSecTimeOriginal",type:t.Ascii},37522:{name:"SubSecTimeDigitized",type:t.Ascii},40960:{name:"FlashpixVersion",type:t.Undefined},40961:{name:"ColorSpace",type:t.Short},40962:{name:"PixelXDimension",type:t.Long},40963:{name:"PixelYDimension",type:t.Long},40964:{name:"RelatedSoundFile",type:t.Ascii},40965:{name:"InteroperabilityTag",type:t.Long},41483:{name:"FlashEnergy",type:t.Rational},41484:{name:"SpatialFrequencyResponse",type:t.Undefined},41486:{name:"FocalPlaneXResolution",type:t.Rational},41487:{name:"FocalPlaneYResolution",type:t.Rational},41488:{name:"FocalPlaneResolutionUnit",type:t.Short},41492:{name:"SubjectLocation",type:t.Short},41493:{name:"ExposureIndex",type:t.Rational},41495:{name:"SensingMethod",type:t.Short},41728:{name:"FileSource",type:t.Undefined},41729:{name:"SceneType",type:t.Undefined},41730:{name:"CFAPattern",type:t.Undefined},41985:{name:"CustomRendered",type:t.Short},41986:{name:"ExposureMode",type:t.Short},41987:{name:"WhiteBalance",type:t.Short},41988:{name:"DigitalZoomRatio",type:t.Rational},41989:{name:"FocalLengthIn35mmFilm",type:t.Short},41990:{name:"SceneCaptureType",type:t.Short},41991:{name:"GainControl",type:t.Short},41992:{name:"Contrast",type:t.Short},41993:{name:"Saturation",type:t.Short},41994:{name:"Sharpness",type:t.Short},41995:{name:"DeviceSettingDescription",type:t.Undefined},41996:{name:"SubjectDistanceRange",type:t.Short},42016:{name:"ImageUniqueID",type:t.Ascii},42032:{name:"CameraOwnerName",type:t.Ascii},42033:{name:"BodySerialNumber",type:t.Ascii},42034:{name:"LensSpecification",type:t.Rational},42035:{name:"LensMake",type:t.Ascii},42036:{name:"LensModel",type:t.Ascii},42037:{name:"LensSerialNumber",type:t.Ascii},42240:{name:"Gamma",type:t.Rational}},GPS:{0:{name:"GPSVersionID",type:t.Byte},1:{name:"GPSLatitudeRef",type:t.Ascii},2:{name:"GPSLatitude",type:t.Rational},3:{name:"GPSLongitudeRef",type:t.Ascii},4:{name:"GPSLongitude",type:t.Rational},5:{name:"GPSAltitudeRef",type:t.Byte},6:{name:"GPSAltitude",type:t.Rational},7:{name:"GPSTimeStamp",type:t.Rational},8:{name:"GPSSatellites",type:t.Ascii},9:{name:"GPSStatus",type:t.Ascii},10:{name:"GPSMeasureMode",type:t.Ascii},11:{name:"GPSDOP",type:t.Rational},12:{name:"GPSSpeedRef",type:t.Ascii},13:{name:"GPSSpeed",type:t.Rational},14:{name:"GPSTrackRef",type:t.Ascii},15:{name:"GPSTrack",type:t.Rational},16:{name:"GPSImgDirectionRef",type:t.Ascii},17:{name:"GPSImgDirection",type:t.Rational},18:{name:"GPSMapDatum",type:t.Ascii},19:{name:"GPSDestLatitudeRef",type:t.Ascii},20:{name:"GPSDestLatitude",type:t.Rational},21:{name:"GPSDestLongitudeRef",type:t.Ascii},22:{name:"GPSDestLongitude",type:t.Rational},23:{name:"GPSDestBearingRef",type:t.Ascii},24:{name:"GPSDestBearing",type:t.Rational},25:{name:"GPSDestDistanceRef",type:t.Ascii},26:{name:"GPSDestDistance",type:t.Rational},27:{name:"GPSProcessingMethod",type:t.Undefined},28:{name:"GPSAreaInformation",type:t.Undefined},29:{name:"GPSDateStamp",type:t.Ascii},30:{name:"GPSDifferential",type:t.Short},31:{name:"GPSHPositioningError",type:t.Rational}},Interop:{1:{name:"InteroperabilityIndex",type:t.Ascii}}};a["0th"]=a.Image,a["1st"]=a.Image;const n={ImageIFD:{ProcessingSoftware:11,NewSubfileType:254,SubfileType:255,ImageWidth:256,ImageLength:257,BitsPerSample:258,Compression:259,PhotometricInterpretation:262,Threshholding:263,CellWidth:264,CellLength:265,FillOrder:266,DocumentName:269,ImageDescription:270,Make:271,Model:272,StripOffsets:273,Orientation:274,SamplesPerPixel:277,RowsPerStrip:278,StripByteCounts:279,XResolution:282,YResolution:283,PlanarConfiguration:284,GrayResponseUnit:290,GrayResponseCurve:291,T4Options:292,T6Options:293,ResolutionUnit:296,TransferFunction:301,Software:305,DateTime:306,Artist:315,HostComputer:316,Predictor:317,WhitePoint:318,PrimaryChromaticities:319,ColorMap:320,HalftoneHints:321,TileWidth:322,TileLength:323,TileOffsets:324,TileByteCounts:325,SubIFDs:330,InkSet:332,InkNames:333,NumberOfInks:334,DotRange:336,TargetPrinter:337,ExtraSamples:338,SampleFormat:339,SMinSampleValue:340,SMaxSampleValue:341,TransferRange:342,ClipPath:343,XClipPathUnits:344,YClipPathUnits:345,Indexed:346,JPEGTables:347,OPIProxy:351,JPEGProc:512,JPEGInterchangeFormat:513,JPEGInterchangeFormatLength:514,JPEGRestartInterval:515,JPEGLosslessPredictors:517,JPEGPointTransforms:518,JPEGQTables:519,JPEGDCTables:520,JPEGACTables:521,YCbCrCoefficients:529,YCbCrSubSampling:530,YCbCrPositioning:531,ReferenceBlackWhite:532,XMLPacket:700,Rating:18246,RatingPercent:18249,ImageID:32781,CFARepeatPatternDim:33421,CFAPattern:33422,BatteryLevel:33423,Copyright:33432,ExposureTime:33434,ImageResources:34377,ExifTag:34665,InterColorProfile:34675,GPSTag:34853,Interlace:34857,TimeZoneOffset:34858,SelfTimerMode:34859,FlashEnergy:37387,SpatialFrequencyResponse:37388,Noise:37389,FocalPlaneXResolution:37390,FocalPlaneYResolution:37391,FocalPlaneResolutionUnit:37392,ImageNumber:37393,SecurityClassification:37394,ImageHistory:37395,ExposureIndex:37397,TIFFEPStandardID:37398,SensingMethod:37399,XPTitle:40091,XPComment:40092,XPAuthor:40093,XPKeywords:40094,XPSubject:40095,PrintImageMatching:50341,DNGVersion:50706,DNGBackwardVersion:50707,UniqueCameraModel:50708,LocalizedCameraModel:50709,CFAPlaneColor:50710,CFALayout:50711,LinearizationTable:50712,BlackLevelRepeatDim:50713,BlackLevel:50714,BlackLevelDeltaH:50715,BlackLevelDeltaV:50716,WhiteLevel:50717,DefaultScale:50718,DefaultCropOrigin:50719,DefaultCropSize:50720,ColorMatrix1:50721,ColorMatrix2:50722,CameraCalibration1:50723,CameraCalibration2:50724,ReductionMatrix1:50725,ReductionMatrix2:50726,AnalogBalance:50727,AsShotNeutral:50728,AsShotWhiteXY:50729,BaselineExposure:50730,BaselineNoise:50731,BaselineSharpness:50732,BayerGreenSplit:50733,LinearResponseLimit:50734,CameraSerialNumber:50735,LensInfo:50736,ChromaBlurRadius:50737,AntiAliasStrength:50738,ShadowScale:50739,DNGPrivateData:50740,MakerNoteSafety:50741,CalibrationIlluminant1:50778,CalibrationIlluminant2:50779,BestQualityScale:50780,RawDataUniqueID:50781,OriginalRawFileName:50827,OriginalRawFileData:50828,ActiveArea:50829,MaskedAreas:50830,AsShotICCProfile:50831,AsShotPreProfileMatrix:50832,CurrentICCProfile:50833,CurrentPreProfileMatrix:50834,ColorimetricReference:50879,CameraCalibrationSignature:50931,ProfileCalibrationSignature:50932,AsShotProfileName:50934,NoiseReductionApplied:50935,ProfileName:50936,ProfileHueSatMapDims:50937,ProfileHueSatMapData1:50938,ProfileHueSatMapData2:50939,ProfileToneCurve:50940,ProfileEmbedPolicy:50941,ProfileCopyright:50942,ForwardMatrix1:50964,ForwardMatrix2:50965,PreviewApplicationName:50966,PreviewApplicationVersion:50967,PreviewSettingsName:50968,PreviewSettingsDigest:50969,PreviewColorSpace:50970,PreviewDateTime:50971,RawImageDigest:50972,OriginalRawFileDigest:50973,SubTileBlockSize:50974,RowInterleaveFactor:50975,ProfileLookTableDims:50981,ProfileLookTableData:50982,OpcodeList1:51008,OpcodeList2:51009,OpcodeList3:51022,NoiseProfile:51041},ExifIFD:{ExposureTime:33434,FNumber:33437,ExposureProgram:34850,SpectralSensitivity:34852,ISOSpeedRatings:34855,OECF:34856,SensitivityType:34864,StandardOutputSensitivity:34865,RecommendedExposureIndex:34866,ISOSpeed:34867,ISOSpeedLatitudeyyy:34868,ISOSpeedLatitudezzz:34869,ExifVersion:36864,DateTimeOriginal:36867,DateTimeDigitized:36868,ComponentsConfiguration:37121,CompressedBitsPerPixel:37122,ShutterSpeedValue:37377,ApertureValue:37378,BrightnessValue:37379,ExposureBiasValue:37380,MaxApertureValue:37381,SubjectDistance:37382,MeteringMode:37383,LightSource:37384,Flash:37385,FocalLength:37386,SubjectArea:37396,MakerNote:37500,UserComment:37510,SubSecTime:37520,SubSecTimeOriginal:37521,SubSecTimeDigitized:37522,FlashpixVersion:40960,ColorSpace:40961,PixelXDimension:40962,PixelYDimension:40963,RelatedSoundFile:40964,InteroperabilityTag:40965,FlashEnergy:41483,SpatialFrequencyResponse:41484,FocalPlaneXResolution:41486,FocalPlaneYResolution:41487,FocalPlaneResolutionUnit:41488,SubjectLocation:41492,ExposureIndex:41493,SensingMethod:41495,FileSource:41728,SceneType:41729,CFAPattern:41730,CustomRendered:41985,ExposureMode:41986,WhiteBalance:41987,DigitalZoomRatio:41988,FocalLengthIn35mmFilm:41989,SceneCaptureType:41990,GainControl:41991,Contrast:41992,Saturation:41993,Sharpness:41994,DeviceSettingDescription:41995,SubjectDistanceRange:41996,ImageUniqueID:42016,CameraOwnerName:42032,BodySerialNumber:42033,LensSpecification:42034,LensMake:42035,LensModel:42036,LensSerialNumber:42037,Gamma:42240},GPSIFD:{GPSVersionID:0,GPSLatitudeRef:1,GPSLatitude:2,GPSLongitudeRef:3,GPSLongitude:4,GPSAltitudeRef:5,GPSAltitude:6,GPSTimeStamp:7,GPSSatellites:8,GPSStatus:9,GPSMeasureMode:10,GPSDOP:11,GPSSpeedRef:12,GPSSpeed:13,GPSTrackRef:14,GPSTrack:15,GPSImgDirectionRef:16,GPSImgDirection:17,GPSMapDatum:18,GPSDestLatitudeRef:19,GPSDestLatitude:20,GPSDestLongitudeRef:21,GPSDestLongitude:22,GPSDestBearingRef:23,GPSDestBearing:24,GPSDestDistanceRef:25,GPSDestDistance:26,GPSProcessingMethod:27,GPSAreaInformation:28,GPSDateStamp:29,GPSDifferential:30,GPSHPositioningError:31},InteropIFD:{InteroperabilityIndex:1}};var i=Object.freeze({Types:t,TypeNums:{1:"Byte",2:"Ascii",3:"Short",4:"Long",5:"Rational",7:"Undefined",9:"SLong",10:"SRational"},Tags:a,TagValues:n});class r extends Error{}var o=Object.freeze({ValueConvertError:r});const l=(e,t)=>{let a="";for(let n=0;n<t;n++)a+=e;return a},s=(e,t)=>{if(!(t instanceof Array))throw new Error("'pack' error. Got invalid type argument.");if(e.length-1!=t.length)throw new Error(`'pack' error. ${e.length-1} marks, ${t.length} elements.`);let a;if("<"==e[0])a=!0;else{if(">"!=e[0])throw new Error("Not match any endian.");a=!1}let n="",i=1,r=null,o=null,l=null;for(;o=e[i];){if("b"==o.toLowerCase()){if(r=t[i-1],"b"==o&&r<0&&(r+=256),r>255||r<0)throw new Error("'pack' error.");l=String.fromCharCode(r)}else if("H"==o){if((r=t[i-1])>65535||r<0)throw new Error("'pack' error.");l=String.fromCharCode(Math.floor(r%65536/256))+String.fromCharCode(r%256),a&&(l=l.split("").reverse().join(""))}else{if("l"!=o.toLowerCase())throw new Error("'pack' error.");if(r=t[i-1],"l"==o&&r<0&&(r+=4294967296),r>4294967295||r<0)throw new Error("'pack' error.");l=String.fromCharCode(Math.floor(r/16777216))+String.fromCharCode(Math.floor(r%16777216/65536))+String.fromCharCode(Math.floor(r%65536/256))+String.fromCharCode(r%256),a&&(l=l.split("").reverse().join(""))}n+=l,i+=1}return n},m=(e,t)=>{if("string"!=typeof t)throw new Error("'unpack' error. Got invalid type argument.");let a,n=0;for(let t=1;t<e.length;t++)if("b"==e[t].toLowerCase())n+=1;else if("h"==e[t].toLowerCase())n+=2;else{if("l"!=e[t].toLowerCase())throw new Error("'unpack' error. Got invalid mark.");n+=4}if(n!=t.length)throw new Error("'unpack' error. Mismatch between symbol and string length. "+n+":"+t.length);if("<"==e[0])a=!0;else{if(">"!=e[0])throw new Error("'unpack' error.");a=!1}let i=[],r=0,o=1,l=null,s=null,m=null,p="";for(;s=e[o];){if("b"==s.toLowerCase())m=1,l=(p=t.slice(r,r+m)).charCodeAt(0),"b"==s&&l>=128&&(l-=256);else if("H"==s)m=2,p=t.slice(r,r+m),a&&(p=p.split("").reverse().join("")),l=256*p.charCodeAt(0)+p.charCodeAt(1);else{if("l"!=s.toLowerCase())throw new Error("'unpack' error. "+s);m=4,p=t.slice(r,r+m),a&&(p=p.split("").reverse().join("")),l=16777216*p.charCodeAt(0)+65536*p.charCodeAt(1)+256*p.charCodeAt(2)+p.charCodeAt(3),"l"==s&&l>=2147483648&&(l-=4294967296)}i.push(l),r+=m,o+=1}return i},p=new Function("try {return this===window;}catch(e){ return false;}")(),y=p?window.atob:e=>{return Buffer.from(e,"base64")},c=p?window.btoa:e=>{return Buffer.from(e).toString("base64")},u=e=>s(">"+l("B",e.length),e),f=e=>s(">"+l("H",e.length),e),S=e=>s(">"+l("L",e.length),e),h=e=>{return Object.assign({},e),e},g=e=>{let t=w(e);for(;"ÿà"<=t[1].slice(0,2)&&t[1].slice(0,2)<="ÿï";)t=[t[0]].concat(t.slice(2));return t.join("")},d=(e,a,n)=>{let i;if(a==t.Byte)i=P(e,n);else if(a==t.Ascii)i=R(e,n);else if(a==t.Short)i=L(e,n);else if(a==t.Long)i=C(e,n);else if(a==t.Rational)i=A(e,n);else if(a==t.Undefined)i=b(e,n);else{if(a==t.SLong)throw new Error("Not implemented for SLong value");if(a!=t.SRational)throw new Error("Got unhandled exif value type.");i=I(e,n)}return i},P=(e,t)=>{if("number"==typeof e)e=[e];else if(!Array.isArray(e)||"number"!=typeof e[0]){const t=Array.isArray(e)?"Array":typeof e;throw new r('Value must be "number" or "Array<number>".\n'+`Value: ${e}\n`+`Type: ${t}`)}const a=e.length;let n={value:"",lengthBinary:"",fourBytesOver:""};return a<=4?n.value=u(e)+l("\0",4-a):(n.value=s(">L",[t]),n.fourBytesOver=u(e)),n.lengthBinary=s(">L",[a]),n},R=(e,t)=>{if("string"!=typeof e){const t=Array.isArray(e)?"Array":typeof e;throw new r(`Value must be "string". Got "${t}".`)}const a=e+"\0",n=a.length;let i={value:"",lengthBinary:"",fourBytesOver:""};return n>4?(i.value=s(">L",[t]),i.fourBytesOver=a):i.value=a+l("\0",4-n),i.lengthBinary=s(">L",[n]),i},L=(e,t)=>{if("number"==typeof e)e=[e];else if(!Array.isArray(e)||"number"!=typeof e[0]){const t=Array.isArray(e)?"Array":typeof e;throw new r('Value must be "number" or "Array<number>".\n'+`Value: ${e}\n`+`Type: ${t}`)}const a=e.length;let n={value:"",lengthBinary:"",fourBytesOver:""};return a<=2?n.value=f(e)+l("\0\0",2-a):(n.value=s(">L",[t]),n.fourBytesOver=f(e)),n.lengthBinary=s(">L",[a]),n},C=(e,t)=>{if("number"==typeof e)e=[e];else if(!Array.isArray(e)||"number"!=typeof e[0]){const t=Array.isArray(e)?"Array":typeof e;throw new r('Value must be "number" or "Array<number>".\n'+`Value: ${e}\n`+`Type: ${t}`)}const a=e.length;let n={value:"",lengthBinary:"",fourBytesOver:""};return a<=1?n.value=S(e):(n.value=s(">L",[t]),n.fourBytesOver=S(e)),n.lengthBinary=s(">L",[a]),n},A=(e,t)=>{if(Array.isArray(e)&&"number"==typeof e[0]&&2===e.length)e=[e];else if(!Array.isArray(e)||!Array.isArray(e[0])||"number"!=typeof e[0][0]){let t=Array.isArray(e)?"Array":typeof e;throw t="Array"==t?`Array<${typeof e[0]}>`:t,new r(`Value must be "Array<number>" or "Array<Array<number>>". Got "${t}".`)}let a={value:"",lengthBinary:"",fourBytesOver:""};const n=e.length;let i="";for(let t=0;t<n;t++){const a=e[t][0],n=e[t][1];i+=s(">L",[a])+s(">L",[n])}return a.lengthBinary=s(">L",[n]),a.value=s(">L",[t]),a.fourBytesOver=i,a},b=(e,t)=>{if("string"!=typeof e){const t=Array.isArray(e)?"Array":typeof e;throw new r(`Value must be "string". Got "${t}".`)}const a=e.length;let n={value:"",lengthBinary:"",fourBytesOver:""};return a>4?(n.value=s(">L",[t]),n.fourBytesOver=e):n.value=e+l("\0",4-a),n.lengthBinary=s(">L",[a]),n},I=(e,t)=>{if(Array.isArray(e)&&"number"==typeof e[0]&&2===e.length)e=[e];else if(!Array.isArray(e)||!Array.isArray(e[0])||"number"!=typeof e[0][0]){let t=Array.isArray(e)?"Array":typeof e;throw t="Array"==t?`Array<${typeof e[0]}>`:t,new r(`Value must be "Array<number>" or "Array<Array<number>>". Got "${t}".`)}let a={value:"",lengthBinary:"",fourBytesOver:""};const n=e.length;let i="";for(let t=0;t<n;t++){const a=e[t][0],n=e[t][1];i+=s(">l",[a])+s(">l",[n])}return a.lengthBinary=s(">L",[n]),a.value=s(">L",[t]),a.fourBytesOver=i,a},G=(e,t,n)=>{const i=Object.keys(e).length,o=s(">H",[i]);let l;l=["0th","1st"].indexOf(t)>-1?2+12*i+4:2+12*i;let m,p="",y="";for(m in e){if("string"==typeof m&&(m=parseInt(m)),"0th"==t&&[34665,34853].indexOf(m)>-1)continue;if("Exif"==t&&40965==m)continue;if("1st"==t&&[513,514].indexOf(m)>-1)continue;let i=e[m];const o=s(">H",[m]),c=a[t][m].type,u=s(">H",[c]),f=8+l+n+y.length;let S;try{S=d(i,c,f)}catch(e){if(e instanceof r){const n=["0th","1st"].includes(t)?"Image":t,i=`Can't convert ${a[n][m].name} in ${t} IFD.\r`;e.message=i+e.message}throw e}p+=o+u+S.lengthBinary+S.value,y+=S.fourBytesOver}return[o+p,y]};class D{constructor(e){let t,n;if(this.getIfd=((e,t)=>{const n=m(this.endianMark+"H",this.tiftag.slice(e,e+2))[0];if(0==n)return null;let i={};const r=e+2;let o;o=["0th","1st"].indexOf(t)>-1?"Image":t;for(let t=0;t<n;t++){e=r+12*t;const n=m(this.endianMark+"H",this.tiftag.slice(e,e+2))[0],l=[m(this.endianMark+"H",this.tiftag.slice(e+2,e+4))[0],m(this.endianMark+"L",this.tiftag.slice(e+4,e+8))[0],this.tiftag.slice(e+8,e+12)];n in a[o]&&(i[n]=this.convertValue(l))}return"0th"==t&&(e=r+12*n,i.first_ifd_pointer=this.tiftag.slice(e,e+4)),i}),this.convertValue=(e=>{let t=null;const a=e[0],n=e[1],i=e[2];let r;if(1==a)n>4?(r=m(this.endianMark+"L",i)[0],t=m(this.endianMark+l("B",n),this.tiftag.slice(r,r+n))):t=m(this.endianMark+l("B",n),i.slice(0,n));else if(2==a)n>4?(r=m(this.endianMark+"L",i)[0],t=this.tiftag.slice(r,r+n-1)):t=i.slice(0,n-1);else if(3==a)n>2?(r=m(this.endianMark+"L",i)[0],t=m(this.endianMark+l("H",n),this.tiftag.slice(r,r+2*n))):t=m(this.endianMark+l("H",n),i.slice(0,2*n));else if(4==a)n>1?(r=m(this.endianMark+"L",i)[0],t=m(this.endianMark+l("L",n),this.tiftag.slice(r,r+4*n))):t=m(this.endianMark+l("L",n),i);else if(5==a)if(r=m(this.endianMark+"L",i)[0],n>1){t=[];for(let e=0;e<n;e++)t.push([m(this.endianMark+"L",this.tiftag.slice(r+8*e,r+4+8*e))[0],m(this.endianMark+"L",this.tiftag.slice(r+4+8*e,r+8+8*e))[0]])}else t=[m(this.endianMark+"L",this.tiftag.slice(r,r+4))[0],m(this.endianMark+"L",this.tiftag.slice(r+4,r+8))[0]];else if(7==a)n>4?(r=m(this.endianMark+"L",i)[0],t=this.tiftag.slice(r,r+n)):t=i.slice(0,n);else{if(10!=a)throw new Error("Exif might be wrong. Got incorrect value type to decode. type:"+a);if(r=m(this.endianMark+"L",i)[0],n>1){t=[];for(let e=0;e<n;e++)t.push([m(this.endianMark+"l",this.tiftag.slice(r+8*e,r+4+8*e))[0],m(this.endianMark+"l",this.tiftag.slice(r+4+8*e,r+8+8*e))[0]])}else t=[m(this.endianMark+"l",this.tiftag.slice(r,r+4))[0],m(this.endianMark+"l",this.tiftag.slice(r+4,r+8))[0]]}return t instanceof Array&&1==t.length?t[0]:t}),"ÿØ"==e.slice(0,2))t=w(e),n=B(t),this.tiftag=n?n.slice(10):null;else if(["II","MM"].indexOf(e.slice(0,2))>-1)this.tiftag=e;else{if("Exif"!=e.slice(0,4))throw new Error("Given file is neither JPEG nor TIFF.");this.tiftag=e.slice(6)}}}const w=e=>{if("ÿØ"!=e.slice(0,2))throw new Error("Given data isn't JPEG.");let t=2,a=["ÿØ"];for(;;){if("ÿÚ"==e.slice(t,t+2)){a.push(e.slice(t));break}{const n=t+m(">H",e.slice(t+2,t+4))[0]+2;a.push(e.slice(t,n)),t=n}if(t>=e.length)throw new Error("Wrong JPEG data.")}return a},B=e=>{let t;for(let a=0;a<e.length;a++)if("ÿá"==(t=e[a]).slice(0,2)&&"Exif\0\0"==t.slice(4,10))return t;return null},M=(e,t)=>{let a=!1,n=[];return e.forEach(function(i,r){"ÿá"==i.slice(0,2)&&"Exif\0\0"==i.slice(4,10)&&(a?n.unshift(r):(e[r]=t,a=!0))}),n.forEach(function(t){e.splice(t,1)}),!a&&t&&(e=[e[0],t].concat(e.slice(1))),e.join("")};const E={degToDmsRational:e=>{var t=Math.abs(e),a=t%1*60,n=a%1*60;return[[Math.floor(t),1],[Math.floor(a),1],[Math.round(100*n),100]]},dmsRationalToDeg:(e,t)=>{if("S"!==t&&"W"!==t&&"N"!==t&&"E"!==t)throw new Error('"dmsRationalToDeg", 2nd argument must be "N", "S", "E" or "W"');return("S"===t||"W"===t?-1:1)*(e[0][0]/e[0][1]+e[1][0]/(60*e[1][1])+e[2][0]/(3600*e[2][1]))}};const v=Object.freeze({_nLoopStr:l,pack:s,unpack:m,_isBrowser:p,atob:y,btoa:c,_packByte:u,_packShort:f,_packLong:S,copy:h,getThumbnail:g,_valueToBytes:d,_toByte:P,_toAscii:R,_toShort:L,_toLong:C,_toRational:A,_toUndefined:b,_toSRational:I,dictToBytes:G,ExifReader:D,splitIntoSegments:w,mergeSegments:M}),T=Object.freeze({GPSHelper:E}),x=i,k=o,F=a,O=n;e.version="2.0.0b",e._=v,e.helper=T,e.constants=x,e.exceptions=k,e.Tags=F,e.TagValues=O,e.remove=(e=>{let t=!1;if("ÿØ"==e.slice(0,2));else{if("data:image/jpeg;base64,"!=e.slice(0,23)&&"data:image/jpg;base64,"!=e.slice(0,22))throw new Error("Given data is not jpeg.");e=y(e.split(",")[1]),t=!0}let a=w(e).filter(function(e){return!("ÿá"==e.slice(0,2)&&"Exif\0\0"==e.slice(4,10))}).join("");return t&&(a="data:image/jpeg;base64,"+c(a)),a}),e.insert=((e,t)=>{let a=!1;if("Exif\0\0"!=e.slice(0,6))throw new Error("Given data is not exif.");if("ÿØ"==t.slice(0,2));else{if("data:image/jpeg;base64,"!=t.slice(0,23)&&"data:image/jpg;base64,"!=t.slice(0,22))throw new Error("Given data is not jpeg.");t=y(t.split(",")[1]),a=!0}const n="ÿá"+s(">H",[e.length+2])+e,i=w(t);let r=M(i,n);return a&&(r="data:image/jpeg;base64,"+c(r)),r}),e.load=(e=>{let t;if("string"!=typeof e)throw new Error("'load' gots invalid type argument.");if("ÿØ"==e.slice(0,2))t=e;else if("data:image/jpeg;base64,"==e.slice(0,23)||"data:image/jpg;base64,"==e.slice(0,22))t=y(e.split(",")[1]);else{if("Exif"!=e.slice(0,4))throw new Error("'load' gots invalid file data.");t=e.slice(6)}let a={},n=new D(t);if(null===n.tiftag)return a;"II"==n.tiftag.slice(0,2)?n.endianMark="<":n.endianMark=">";let i=null,r=null,o=null,l=null,s=null,p=null,c=m(n.endianMark+"L",n.tiftag.slice(4,8))[0];const u=(i=n.getIfd(c,"0th")).first_ifd_pointer;if(delete i.first_ifd_pointer,null!==i&&34665 in i){const e=i[34665];o=n.getIfd(e,"Exif")}if(null!==i&&34853 in i){const e=i[34853];s=n.getIfd(e,"GPS")}if(null!==o&&40965 in o){const e=o[40965];l=n.getIfd(e,"Interop")}if("\0\0\0\0"!=u){const e=m(n.endianMark+"L",u)[0];if(null!==(r=n.getIfd(e,"1st"))&&513 in r&&514 in r){const e=r[513]+r[514];p=n.tiftag.slice(r[513],e)}}return null!==i&&(a["0th"]=i),null!==r&&(a["1st"]=r),null!==o&&(a.Exif=o),null!==s&&(a.GPS=s),null!==l&&(a.Interop=l),null!==p&&(a.thumbnail=p),a}),e.dump=(e=>{let a=h(e);let i,r,o,l,m,p=!1,y=!1,c=!1,u=!1;i="0th"in a?a["0th"]:{},"Exif"in a&&Object.keys(a.Exif).length||"Interop"in a&&Object.keys(a.Interop).length?(i[34665]=1,p=!0,r=a.Exif,"Interop"in a&&Object.keys(a.Interop).length?(r[40965]=1,c=!0,o=a.Interop):Object.keys(r).indexOf(n.ExifIFD.InteroperabilityTag.toString())>-1&&delete r[40965]):Object.keys(i).indexOf(n.ImageIFD.ExifTag.toString())>-1&&delete i[34665],"GPS"in a&&Object.keys(a.GPS).length?(i[n.ImageIFD.GPSTag]=1,y=!0,l=a.GPS):Object.keys(i).indexOf(n.ImageIFD.GPSTag.toString())>-1&&delete i[n.ImageIFD.GPSTag],"1st"in a&&"thumbnail"in a&&null!=a.thumbnail&&(u=!0,a["1st"][513]=1,a["1st"][514]=1,m=a["1st"]);let f=G(i,"0th",0);const S=f[0].length+12*Number(p)+12*Number(y)+4+f[1].length;let d,P,R,L,C,A="",b=0,I="",D=0,w="",B=0,M="";p&&(b=(d=G(r,"Exif",S))[0].length+12*Number(c)+d[1].length),y&&(D=(I=(P=G(l,"GPS",S+b)).join("")).length),c&&(B=(w=(R=G(o,"Interop",S+b+D)).join("")).length);if(u&&(L=G(m,"1st",S+b+D+B),(C=g(a.thumbnail)).length>64e3))throw new Error("Given thumbnail is too large. max 64kB");let E="",v="",T="",x="\0\0\0\0";if(p){const e=s(">L",[8+S]);E=s(">H",[34665])+s(">H",[t.Long])+s(">L",[1])+e}if(y){const e=s(">L",[8+S+b]);v=s(">H",[34853])+s(">H",[t.Long])+s(">L",[1])+e}if(c){const e=s(">L",[8+S+b+D]);T=s(">H",[40965])+s(">H",[t.Long])+s(">L",[1])+e}if(u){const e=8+S+b+D+B;x=s(">L",[e]);const t=e+L[0].length+24+4+L[1].length,a="\0\0\0\0"+s(">L",[t]),n="\0\0\0\0"+s(">L",[C.length]);M=L[0]+a+n+"\0\0\0\0"+L[1]+C}const k=f[0]+E+v+x+f[1];return p&&(A=d[0]+T+d[1]),"Exif\0\0MM\0*\0\0\0\b"+k+A+I+w+M}),Object.defineProperty(e,"__esModule",{value:!0})});